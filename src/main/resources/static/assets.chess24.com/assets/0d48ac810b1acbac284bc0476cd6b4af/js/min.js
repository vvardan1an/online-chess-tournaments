function inheritable(){throw new Error("inheritable can't be instantiated")}function buildTree(e,t){function n(){var i={};t.fen&&(i.fen=e.toString()),t.move&&e.getCurrentPosition()!==e.getStartPosition()&&(i.move=e.getCurrentPosition().getCan()),t.id&&(i.id=e.getCurrentPosition().knotId),t.comment&&void 0!==e.getCurrentPosition().comment&&(i.comment=e.getCurrentPosition().comment),t.question&&void 0!==e.getCurrentPosition().question&&(i.question={question:e.getCurrentPosition().question.question,answers:e.getCurrentPosition().question.getAnswer()}),i.children=[];for(var r=0;r<e.countChildrenMoves();r++)e.gotoChildrenPositionById(r),i.children[r]=n(o),e.gotoParentPosition();return i}var i=e.getCurrentPosition(),o={};return e.gotoStart(o),o=n(),e.setCurrentPosition(i),o}function Linkified(e,t){this._defaults=defaults,this.element=e,this.setOptions(t),this.init()}function popupList(e,t){for(var n=jQuery("<div/>").addClass("chess-choice-bg"),i=jQuery("<ul/>").addClass("chess-choice"),o=this,r=0;r<e.length;r++)i.append(jQuery("<li/>").html(e[r].text).on("click",function(e){return function(){"function"==typeof t&&t(e),o.remove()}}(e[r].id)).on("mouseover",function(){jQuery(this).hasClass("highlighted")||(i.find(".highlighted").removeClass("highlighted"),jQuery(this).addClass("highlighted"))}));i.find("li:first").addClass("first"),i.find("li:last").addClass("last"),i.appendTo("body").css({left:jQuery(window).width()/2-i.width()/2+"px",top:jQuery(window).height()/2-i.height()/2+"px"}),n.insertBefore(i).css({left:parseInt(i.css("left"))-10+"px",top:parseInt(i.css("top"))-10+"px",width:i.width()+20+"px",height:i.height()+20+"px"});var a=0;return this.down=function(){return a=Math.min(a+1,i.find("li").length-1),this.highlight(),this},this.up=function(){return a=Math.max(a-1,0),this.highlight(),this},this.value=function(){return e[a].id},this.highlight=function(){return i.find(".highlighted").removeClass("highlighted"),i.find("li:eq("+a+")").addClass("highlighted"),this},this.remove=function(){return n.remove(),i.remove(),this},this.select=function(){return i.find("li.highlighted").trigger("click"),this},this.highlight(),this}function achievementsManager(){function e(){n.initEveryTime(),jQuery(document).on("click",".missionIconBtn",function(){n.handleMissionIconClick(this)}),jQuery(document).on("click",".closeMissionBadgesPanel",function(){n.hideMissionBadges(this.getAttribute("data-firstmission"))}),jQuery(document).on("click",".seeAllItems",function(){n.showAllItems(this)}),jQuery(document).on("click",".closeAllItems",function(){n.closeAllItems(this)}),t=jQuery("<div>",{id:"achievementsBubble"}).append(jQuery("<h3>",{id:"bubbleTitle"}).html("&nbsp;")).append(jQuery("<p>",{id:"bubbleDescription"}).html("&nbsp;")),jQuery("body").append(t),t.bubble({side:"bottom",point:"precise",flexible:!0,noanimation:!0})}var t,n=this;return achievementsManager.instance?(achievementsManager.instance.initEveryTime(),achievementsManager.instance):(achievementsManager.instance=n,n.initEveryTime=function(){jQuery(".userProfileTabs ul.tabNav > li > a").on("click",function(e){return n.handleMenuTabClick(this,e)}),jQuery("#finishedAchievementsBtn").on("click",function(){jQuery("#openAchievements").hide(),n.showAchievementsTab()}),jQuery("#openAchievementsBtn").on("click",function(){jQuery("#finishedAchievements").hide(),n.showAchievementsTab()}),n.openFirstSubtab(),jQuery(".withBubble").on("mouseover",function(){n.showBubble(this)}),jQuery(".withBubble").on("mouseout",function(){t.bubble("hide")})},n.openFirstSubtab=function(){jQuery("#finishedAchievementsBtn").trigger("click"),jQuery(".tabContentWrap").css("height","auto"),jQuery("#finishedAchievementsBtn").parent("li").addClass("current"),setTimeout(function(){jQuery("#openAchievementsBtn").parent("li").hasClass("current")||jQuery("#finishedAchievementsBtn").parent("li").addClass("current"),jQuery(".tabContentWrap").css("height","auto")},100)},n.handleMenuTabClick=function(e,t){if("tabAchievements"==e.getAttribute("data-tab-content-id")){if(jQuery(e).parent("li").hasClass("withSubTabs")){try{t.stopPropagation()}catch(i){t.cancelBubble=!0}return!1}n.openFirstSubtab()}else n.hideAchievementsTab()},n.showAchievementsTab=function(){jQuery("#tabAchievements").addClass("forceTabVisibility")},n.hideAchievementsTab=function(){jQuery("#tabAchievements").removeClass("forceTabVisibility")},n.handleMissionIconClick=function(e){var t=e.getAttribute("data-mission"),i=jQuery("#missionBadgesItem"+t);"block"==i.css("display")?n.hideMissionBadges(t):n.showMissionBadges(t)},n.showMissionBadges=function(e){var t=jQuery("#missionBadgesItem"+e),n=t.parents(".achievementsBadgeDetails");n.find(".missionBadgesItem").hide(),t.show(),n.show();var i=jQuery("#missionIcon"+e);i.parent("ul").find(".missionIcon").removeClass("current"),i.addClass("current")},n.hideMissionBadges=function(e){var t=jQuery("#missionBadgesItem"+e),n=t.parents(".achievementsBadgeDetails");n.find(".missionBadgesItem").hide(),n.hide();var i=jQuery("#missionIcon"+e);i.parent("ul").find(".missionIcon").removeClass("current")},n.showAllItems=function(e){var t=e.getAttribute("data-allitems");jQuery(e).hide(),jQuery("#closeAllItemsBtn"+t).show(),jQuery("#allItemsWrapper"+t).slideDown()},n.closeAllItems=function(e){var t=e.getAttribute("data-allitems");jQuery(e).hide(),jQuery("#seeAllItemsBtn"+t).show(),jQuery("#allItemsWrapper"+t).slideUp()},n.showBubble=function(e){var n=jQuery(e);t.bubble("hide"),setTimeout(function(){var i=n.find(".bubbleInfoBadgeTitle").html(),o=n.find(".bubbleInfoBadgeDescription").html();t.find("#bubbleTitle").html(i),t.find("#bubbleDescription").html(o),t.show().bubble("realign",e).bubble("show")},1)},e(),n)}function reviewEmailSettings(){if(!config.level().isGuest&&!(settings.getBoolean("notification-news")&&settings.getBoolean("welcome-emails")||settings.getBoolean("no-thanks"))){var e=window.settings.getString("lastEmailSettingsReview");(null===e||e.length<=0)&&(settings.clearLocalStorage(),e=0),new Date-new Date(e)<EMAIL_SETTINGS_REVIEW_CYCLE||$(".dataConsentModal:visible").length||Dialog.reviewEmailSettings()}}function loadAdvertisement(){if(!config.level().isPremium){var e=$(window).width();if(1720>e&&$("#leftSidebar").find(".banner").remove(),1240>e&&($(".sidebarContentContainer").find(".banner").remove(),$(".banner-970x250").remove()),($("#googleAd").length||$("#snigelAd").length)&&$(".banner").css("display","block"),snhb.queue=snhb.queue||[],!snigelLoaded&&$("#snigelAd").length){snigelLoaded=!0,snhb.options={autoStartAuction:!1,consent:{disableConsent:!0}};var t=document.createElement("script");t.type="text/javascript",t.async=!0,t.src=$("body").data("snigelurl");var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(t,n);var i=config.consent().hasMarketingConsent?0:1;googletag.cmd.push(function(){googletag.pubads().setRequestNonPersonalizedAds(i),adsbygoogle=window.adsbygoogle||[],adsbygoogle.requestNonPersonalizedAds=i})}var o=[];$(".bannerSnigel div:has(.default-ad)").each(function(e,t){var n=$(t).data("snigel-name");0>$.inArray(n,snigelAuctionRequested)&&(snigelAuctionRequested.push(n),o.push(n))}),window.snigelPubConf={adengine:{activeAdUnits:snigelAuctionRequested}},window.adngin&&window.adngin.adnginLoaderReady&&adngin.queue.push(function(){adngin.cmd.startAuction(snigelAuctionRequested)})}}function loadComments(){var e=jQuery(".commentsContainer");if(!e.length)return void jQuery(".globalSharing").removeClass("withComments");var t=jQuery(".comment-count");jQuery(".globalSharing").toggleClass("withComments",e.is(":visible")).find(".commentsCount").html(t.html()).addClass(t.attr("class").replace(/.*(comment-count-[\w-]+).*/,"$1"));var n=jQuery((new Handler.Template).render("commonLoader")),i="/api/web/CommentAPI/comments?lang="+config.language()+"&"+e.data("name")+"="+e.data("reference"),o=e.find(".commentList"),r=!1;o.lazyload({url:i,selector:".commentItem",onload:function(t){n.detach();var i=jQuery(t.data.html);e.find(".commentItemAdd .commentUserName").replaceWith(i.find(".commentItemAdd .commentUserName"));var a=window.location.hash.replace("#","");if(a&&"comments"!=a&&!r){var s=i.find('a[name="'+a+'"]');s.length&&(setTimeout(function(){jQuery("html,body").animate({scrollTop:s.offset().top-100},200)}),r=!0)}o.append(i.find(".commentItem").add(i.filter(".commentItem"))),jQuery(document).trigger("newhtml"),o.find(".commentItem").length?o.find(".noComments").hide():o.find(".noComments").show(),jQuery(document).trigger("onCommentsLoaded")},onstart:function(){e.append(n)}});var a=e.find(".commentItemAddCount");e.on("change",".commentItemAdd .editor",function(t,n){if(!n){var i=jQuery(this),o=i.editor("text").trim();if(o.length){var r=(new Handler.Template,a.data("template"));a.find("p").html(Handler.Template.renderString(r,{characters:i.editor("configuration").maxLength-o.length})),a.show(),e.find(".commentItemAddEmpty, .commentItemAddWait").hide()}else a.hide()}}),e.off("click").on("click",".commentButtonComplain",function(){var e=jQuery(this),t=e.parents("li"),n=t.data("comment-uuid"),i={commentUUID:n,csrf:config.csrf()};return jQuery.post("/api/web/commentAPI/complain",i,function(t){0===t.status&&(0===t.data.btn_state?e.addClass("cBtnInactive"):e.removeClass("cBtnInactive"))}),!1}),e.on("click",".commentButtonReply",function(){var e=jQuery(this).closest(".commentItem").find(".commentContent .couch-content").clone();e.find("div, script, blockquote").remove();var t=e.find("p").filter(function(){return"p"==this.tagName.toLowerCase()&&(this.childNodes.length>1||1==this.childNodes.length&&(3==this.childNodes[0].nodeType||"br"!=this.childNodes[0].tagName.toLowerCase()))}),n=jQuery("<blockquote/>").append(t).attr("contenteditable",!1);jQuery(".commentItemAdd .editor").html("<p><br/></p>").focus().prepend(n.get(0).outerHTML)}),e.on("click",".commentOrder .cTooltipBoxContainer span",function(){var e=jQuery(this),t=jQuery(".commentOrder .selected");return t.data("value")!==e.data("value")&&jQuery.post("/api/web/commentAPI/order",{csrf:config.csrf(),value:e.data("value")},function(e){0===e.status&&(t.text(e.data.name).data("value",e.data.value),jQuery(".commentList").find(".commentItem").remove().end().lazyload("refresh"))}),!1}),e.on("click",".commentButtonDelete",function(){var e=jQuery(this),t=e.parents("li"),n=t.data("comment-uuid"),i={commentUUID:n,csrf:config.csrf()};return jQuery.post("/api/web/commentAPI/delete",i,function(n){if(0==n.status){var i=e.closest(".commentsContainer").data("reference");t.remove(),jQuery(".comment-count-"+i).text(n.data.count)}}),!1});var s;jQuery("#comment-add-new").off("click").on("click",function(){var t=jQuery(this),n=jQuery("form.comment-form .editor").editor("html");if(0==jQuery("<div/>").html(n).text().trim().length)return jQuery(".commentItemAddEmpty").show(),jQuery("form.comment-form .editor").one("change",function(){jQuery(".commentItemAddEmpty").hide()}),!1;var i={csrf:config.csrf(),comment:n,referenceUUID:jQuery("form.comment-form input[name=referenceUUID]").val()},o=jQuery(this).closest(".commentItemAdd").data("url");return jQuery.post(o,i,function(n){if(0==n.status){var i=t.closest(".commentsContainer"),o=i.data("reference");jQuery("ul.comments-list").find(".noComments").remove(),jQuery("ul.comments-list").prepend(n.data.html),jQuery(".comment-count-"+o).text(n.data.count),jQuery("form.comment-form .editor").editor("reset"),jQuery.renderContentChessGame(i),jQuery(document).trigger("newhtml"),e.find("input.optInOut").prop("checked",n.data.subscribed),Handler.tracking("comment",t.closest(".commentsContainer").data("name"))}}).fail(function(e){var n=jQuery.parseJSON(e.responseText),i=t.closest("form").find(".commentEditorContainer .field-errors");if(i.length||(i=jQuery("<span/>").addClass("field-errors").appendTo(t.closest("form").find(".commentEditorContainer"))),i.html("").hide(),n.errors)for(var o in n.errors)if("spam-filter"==o){a.hide();var r=jQuery(".commentItemAddWait").show().find(".commentItemAddWaitTime");clearTimeout(s),function l(e){r.html(e),e>1?s=setTimeout(function(){l(e-1)},1e3):jQuery(".commentItemAddWait").hide()}(n.data.seconds)}else i.append(n.errors[o].join("<br/>")+"<br/>").show();t.closest("form").find(".editor").one("change click focus",function(){i.hide()})}),!1}),e.on("click",".commentButtonEdit",function(){if(config.level().isAdmin){var e=jQuery(this),t=e.closest(".commentItem");if(t.length){var n=t.data("comment-uuid");jQuery.getJSON("/api/web/commentAPI/getComment?uuid="+n).then(function(i){function o(){l.remove(),s.show(),r.hide(),a.hide(),e.show()}var r=e.siblings(".commentButtonEditCancel"),a=e.siblings(".commentButtonEditSave"),s=t.find(".commentContent").hide(),l=jQuery('<div class="commentEditor"/>').insertAfter(s).html(i.data.comment);$.renderEditorContent(l),e.hide(),r.show().off("click").on("click",o),a.show().off("click").on("click",function(){var e=l.find(".editor").editor("html"),t={csrf:config.csrf(),content:e,uuid:n};jQuery.post("/api/web/commentAPI/saveComment",t,function(e){0==e.status&&(s.html(e.data.html).show(),jQuery.renderContentChessGame(s),l.remove(),jQuery(document).trigger("newhtml"))}).fail(function(e){var t=jQuery.parseJSON(e.responseText),n=l.find(".field-errors");if(n.length||(n=jQuery("<span/>").addClass("field-errors").appendTo(l)),n.html("").hide(),t.errors)for(var i in t.errors)n.append(t.errors[i].join("<br/>")+"<br/>").show();l.find(".editor").one("change click focus",function(){n.hide()})}).always(o)})})}}}),e.find("input.optInOut").on("change",function(){var t=jQuery(this),n={uuid:e.data("reference"),type:e.data("name"),csrf:config.csrf()};jQuery.post("/api/web/commentAPI/toggleOptIn",n,function(e){t.prop("checked",!!e.data.result)})})}function initLikes(){var e="active",t=jQuery(".likeContainer");if(t.length){var n="/api/web/likeAPI/",i={csrf:config.csrf()};t.each(function(){var o=jQuery(this),r=o.find(".like"),a=o.find(".unlike");config.level().isGuest||r.add(a).off("click.like").on("click.like",function(){var r=jQuery(this),s=o.data("uuid"),l=r.is("."+e)?"revoke":"add",c=r.is(".like")?1:-1,d=Object.merge(i,{uuid:s,type:o.data("type"),value:c});jQuery.post(n+l,d,function(n){t.filter('[data-uuid="'+s+'"]').find(".like").toggleClass(e,1==n.data.summary.user).find("span").html(n.data.summary.likes),a.length&&t.filter('[data-uuid="'+s+'"]').find(".unlike").toggleClass(e,-1==n.data.summary.user).find("span").html(n.data.summary.unlikes)})})})}}function loadTopTournamentPage(){function e(){function e(){function e(e){e.preventDefault(),jQuery.post("/api/web/NewsletterAPI/subscribe",{email:$(this).find("#email").val(),channel:$(this).data("channel"),csrf:config.csrf()}).success(function(){n.hide();var e=n.find("#email").prop("disabled");e&&o(e),$(".newsletter .message").html(t(a.message)).addClass("success").show(),setTimeout(function(){n.parent().fadeOut()},5e3),$.cookie(a.cookieKey,JSON.stringify("success"),{expires:30,path:"/"}),mixpanel.track("Newsletter Subscribe",{Type:a.type,Registered:e?"yes":"no"}),Handler.tracking("newsletter","subscribe",a.type)}).error(function(e){var t=JSON.parse(e.responseText),n=t.errors.error[0];$(".newsletter .message").html(n).addClass("success").show()})}if($("#newsLetterTopTournamentId").length>0){var n=$('form[name="newsletterSubscription"]'),i=(new Date).getDate();$("dl[data-day="+i+"]").addClass("active"),n.on("submit",e)}}e(),mixpanel.track("Visit",{Type:a.type}),jQuery(function(){var e=(new Date).getDate();$("dl[data-day="+e+"]").addClass("active"),a.addPlayerScores&&i(),a.activityStream&&new View.ActivityStream(".communityStream","community",a.activityStream).link(notificationHandler),a.sidebarAdd&&new View.SidebarAdvertisementRotation(".sidebarAdd",a.sidebarAdd),a.trackConfirmation&&o(!1)})}function n(){function e(e,t){return"undefined"!=typeof e?e:t}var t=r.attr("data");t=JSON.parse(t)||{};var n={message:t.pageTitle?"Successfully signed up for the "+t.pageTitle+" Newsletter":"Successfully signed up for the Newsletter",type:e(t.type,"TopTournament"),cookieKey:t.type?"topTournament_newsletter_"+t.type:"topTournament_newsletter",addPlayerScores:e(t.addPlayerScores,!1),activityStream:e(t.activityStream,!1),trackConfirmation:e(t.trackConfirmation,!1),sidebarAdd:e(t.sidebarAdd,!1)};return n}function i(){var e=a.addPlayerScores,t=new Controller.BroadcastTournament;t.on("tournamentAdded",function(n,i){if(i.id==e.tournamentId){var o=t.getPlayerResults(e.tournamentId,e.player1Id,e.roundId),r=t.getPlayerResults(e.tournamentId,e.player2Id,e.roundId);$(".tournamentScore .playerLeft dt.normal").html(o.p),$(".tournamentScore .playerRight dt.normal").html(r.p)}})}function o(e){Handler.tracking("newsletter","confirm",a.type),mixpanel.track("Newsletter Confirm",{Type:a.type,Registered:e?"yes":"no"})}var r=$("#topTournamentPageId");if(!(r.length<=0)){var a=n();e()}}function goToNewHousePlay(){window.location=getTargetURL(config.newHouse().playUrl)}function goToNewHouseProfile(){window.location=getTargetURL(config.newHouse().profileUrl)}function goToNewHouseChallenge(e){window.location=getTargetURL(config.newHouse().playUrl,{player:e,timeBase:3,timeIncrease:2})}function goToNewHouseFollow(e){window.location=getTargetURL(config.newHouse().followUrl+"/"+e)}function goToNewHousePool(e){const t=JSON.parse(e);switch(poolName="",t.clock){case 60:poolName="bullet";break;case 180:switch(t.increment){case 0:poolName="three";break;case 2:poolName="threePlusTwo"}break;case 300:poolName="blitz";break;case 600:poolName="ten";break;case 900:poolName="fifteen"}return""===poolName?void goToNewHousePlay():void(window.location=getTargetURL(config.newHouse().gameUrl,{poolId:poolName}))}function getTargetURL(e,t){var n=new URL(e);return"undefined"==typeof t&&(t={}),Object.keys(t).forEach(function(e){n.searchParams.append(e,t[e])}),n}function formatTime(e){var t=Math.floor(e/1e3%60),n=Math.floor(e/6e4%60),i=Math.floor(e/36e5%24);return i=10>i?"0"+i:i,n=10>n?"0"+n:n,t=10>t?"0"+t:t,"00"===i?i="":i+=":",i+n+":"+t}function hmsToSecondsOnly(e){for(var t=e.split(":"),n=0,i=1;t.length>0;)n+=i*parseInt(t.pop(),10),i*=60;return n}function chesspairs(){function e(){if(i(),C.show(),w.html(t("{{n}} seconds",{"{{n}}":0})),v.show(),u=0,h=0,0==k){k=!0,n(),F.sort(r);for(var e=0;17>e;e++)$(".card:first-child").clone().appendTo("#cards");v.children().each(function(e){$(this).css({left:($(this).width()+15)*(e%6),top:($(this).height()+15)*Math.floor(e/6)});var t=F.pop();$(this).find(".back").addClass(t),$(this).attr("data-pattern",t),$(this).click(a)}),o()}}function n(){F=[].concat(x,x)}function i(){v.html('<div class="card"><div class="face front"></div><div class="face back"></div></div>')}function o(){if(k){var e=Date.now();p=setInterval(function(){var n=Date.now()-e;w.html(t("{{n}} seconds",{"{{n}}":Math.round(n/1e3)}))},1e3)}}function r(){return.5-Math.random()}function a(){$(".card-flipped").length>1||($(this).addClass("card-flipped"),2==$(".card-flipped").length&&setTimeout(s,700))}function s(){l()?($(".card-flipped").removeClass("card-flipped").addClass("card-removed"),c()):$(".card-flipped").removeClass("card-flipped")}function l(){var e=$(".card-flipped"),t=$(e[0]).data("pattern"),n=$(e[1]).data("pattern");return t==n}function c(){8>h?(h++,$(".card-removed").remove()):($(".card-removed").remove(),g.hide(),m.show(),clearTimeout(p))}function d(){k=!1,i(),clearTimeout(p),n(),e()}var u,h,p,f=$("#intro"),g=$("#game"),m=$("#complete"),v=$("#cards"),y=$(".reset"),w=$(".score"),b=$("#play"),C=$("#timer"),k=!1,F=[],x=["bishop-mad-black","king-happy-black","pawn-annoyed-black","queen-surprised-black","rook-heart-black","bishop-heart-white","bishop-mad-white","king-happy-white","pawn-idea-white"];b.on("click",function(t){t.preventDefault(),f.hide(),y.show(),g.show(),e()}),y.on("click",function(e){e.preventDefault(),m.hide(),g.show(),d()})}if(function(){var e=window.location.pathname.match(/site\/browser/);if(!e){var t=window.navigator.userAgent,n=!0;try{for(var i=[{regexp:/; MSIE ([\d\.]+);/i,version:9,index:1},{regexp:/Firefox\/([\d\.]+)/i,version:3,index:1},{regexp:/^(opera|opr)\/([\d\.]+)/i,version:14,index:2}],o=0;o<i.length;o++){var r=t.match(i[o].regexp);if(r&&r[i[o].index]<=i[o].version){n=!1;break}}}catch(a){n=!1}if(!n)throw window.location="/site/browser",new Error("Unsupported browser")}window.isActive=function(){for(var e=["hidden","webkitHidden","mozHidden","msHidden"],t=0;t<e.length;t++)if(void 0!==document[e[t]])return!document[e[t]]}}(),function(e){e=e||{};var t=Object.prototype.hasOwnProperty;return e.every=e.every||function(e,n,i){if("function"!=typeof n)throw new TypeError;for(var o in e)if(t.call(e,o)&&!n.call(i,e[o],o,e))return!1;return!0},e.extend=e.extend||function(e){for(var n=1,i=arguments.length;i>n;n++)for(var o in arguments[n])t.call(arguments[n],o)&&(e[o]=arguments[n][o]);return e},e.filter=e.filter||function(e,n,i){if("function"!=typeof n)throw new TypeError;var o={};for(var r in e)t.call(e,r)&&n.call(i,e[r],r,e)&&(o[r]=e[r]);return o},e.find=e.find||function(e,n,i){for(var o in e)if(t.call(e,o)&&n.call(i,e[o],o,e))return e[o]},e.findKey=e.findKey||function(e,n,i){for(var o in e)if(t.call(e,o)&&n.call(i,e[o],o,e))return o},e.forEach=e.forEach||function(e,n){if("function"!=typeof n)throw new TypeError;for(var i in e)t.call(e,i)&&n(e[i],i)},e.getLength=e.getLength||function(e){return Object.keys(e).length},e.has=e.has||function(e){for(var n=1,i=arguments.length;i>n;n++)if(!t.call(e,arguments[n]))return!1;return!0},e.isEmpty=e.isEmpty||function(e,n){for(var i in e)if(n||t.call(e,i))return!1;return!0},e.keyOf=e.keyOf||function(e,n){for(var i in e)if(t.call(e,i)&&n===e[i])return i},e.map=e.map||function(e,n,i){if("function"!=typeof n)throw new TypeError;var o={};for(var r in e)t.call(e,r)&&(o[r]=n.call(i,e[r],r,e));return o},e.merge=e.merge||function(){return Array.prototype.unshift.call(arguments,{}),e.extend.apply(this,arguments)},e.copy=e.copy||function(e){return void 0===e?void 0:JSON.parse(JSON.stringify(e))},e.reduce=e.reduce||function(e,n,i){if(null===e||void 0===e)throw new TypeError("Object.reduce called on null or undefined");if("function"!=typeof n)throw new TypeError(n+" is not a function");var o=arguments.length<3;for(var r in e)if(t.call(e,r)){var a=!0;if(void 0===i&&o){i=e[r];continue}i=n(i,e[r],r,e)}if(o&&!a)throw new TypeError("neither initial value nor object properties to iterate");return i},e.some=e.some||function(e,n,i){if("function"!=typeof n)throw new TypeError;for(var o in e)if(t.call(e,o)&&n.call(i,e[o],o,e))return!0;return!1},e.subset=e.subset||function(e,n){arguments.length>2&&(n=Array.prototype.slice.call(arguments,1));for(var i={},o=0,r=n.length;r>o;o++){var a=n[o];t.call(e,a)&&(i[a]=e[a])}return i},e.values=e.values||function(e){for(var t=Object.keys(e),n=[],i=0,o=t.length;o>i;i++)n.push(e[t[i]]);return n},e.without=e.without||function(e,n){var i={};for(var o in e)t.call(e,o)&&-1===n.indexOf(o)&&(i[o]=e[o]);return i},e}(Object),"function"!=typeof Math.randomBetween&&(Math.randomBetween=function(e,t){return Math.floor(Math.random()*(t-e+1)+e)}),"function"!=typeof Math.ChiSquare&&!function(){function e(e){if(0>e)return Number("0/0");for(var t=r[0],n=r.length-1;n>0;--n)t+=r[n]/(e+n);var i=e+o+.5;return.5*Math.log(2*Math.PI)+(e+.5)*Math.log(i)-i+Math.log(t)-Math.log(e)}function t(o){if(.5>o)return Math.PI/(Math.sin(Math.PI*o)*t(1-o));if(o>100)return Math.exp(e(o));o-=1;for(var r=i[0],a=1;n+2>a;a++)r+=i[a]/(o+a);var s=o+n+.5;return Math.sqrt(2*Math.PI)*Math.pow(s,o+.5)*Math.exp(-s)*r}Math.ChiSquare=function(e,n){if(0>e)return 0;var i=n/2;return 1/(Math.pow(2,i)*t(i))*Math.pow(e,i-1)*Math.exp(-e/2)};var n=7,i=[.9999999999998099,676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9984369578019572e-21,1.5056327351493116e-7],o=607/128,r=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22]}(),"function"!=typeof Math.between&&(Math.between=function(e,t,n){return isNaN(e)||isNaN(t)||isNaN(n)?NaN:e>=Math.min(t,n)&&e<=Math.max(t,n)}),"function"!=typeof Math.Gaussian&&(Math.Gaussian=function(e,t){if(0>=t)throw new Error("Variance must be > 0 (but was "+t+")");var n=Math.sqrt(t),i=1/t,o=i*e,r=function(e){var t=Math.abs(e),n=1/(1+t/2),i=n*Math.exp(-t*t-1.26551223+n*(1.00002368+n*(.37409196+n*(.09678418+n*(-.18628806+n*(.27886807+n*(-1.13520398+n*(1.48851587+n*(-.82215223+.17087277*n)))))))));return e>=0?i:2-i},a=function(e){if(e>=2)return-100;if(0>=e)return 100;for(var t=1>e?e:2-e,n=Math.sqrt(-2*Math.log(t/2)),i=-.70711*((2.30753+.27061*n)/(1+n*(.99229+.04481*n))-n),o=0;2>o;o++){var a=r(i)-t;i+=a/(1.1283791670955126*Math.exp(-(i*i))-i*a)}return 1>e?i:-i},s=function(e,t){var n=t/e,i=1/e;return Math.Gaussian(n,i)};return{mean:e,variance:t,standardDeviation:n,precision:i,precisionmean:o,pdf:function(i){var o=n*Math.sqrt(2*Math.PI),r=Math.exp(-Math.pow(i-e,2)/(2*t));return r/o},cdf:function(t){return.5*r(-(t-e)/(n*Math.sqrt(2)))},ppf:function(t){return e-n*Math.sqrt(2)*a(2*t)},mul:function(e){return s(i+e.precision,o+e.precisionmean)},div:function(e){return s(i-e.precision,o-e.precisionmean)}}}),"function"!=typeof Math.getPercentages&&(Math.getPercentages=function(e){e=e.map(function(e){return parseInt(e,10)||0});for(var t=e.reduce(function(e,t){return e+t}),n=[],i=[],o=0;o<e.length;o++){var r=100*e[o]/t,a=Math.floor(r);n.push(a),i.push(r-a)}for(;n.reduce(function(e,t){return e+t})<100;){for(var s,o=0;o<i.length;o++){var l=i[o];(void 0===s||l>i[s])&&(s=o)}n[s]++,i[s]=0}return n}),"function"!=typeof Math.sgn&&(Math.sgn=function(e){return e?0>e?-1:1:0}),dummy=function(){},isValidUUID=function(e){var t=/^[0-9a-zA-Z_-]{22}$/;return void 0!==e&&null!==e.match(t)},uuid=function(){function e(e){var t=(Math.random().toString(16)+"000000000").substr(2,8);return e?"-"+t.substr(0,4)+"-"+t.substr(4,4):t}return e()+e(!0)+e(!0)+e()},jsonToParams=function(e){var t=[];for(var n in e)if("object"==typeof e[n])for(var i=0;i<e[n].length;i++)t.push(n+"="+e[n][i]);else t.push(n+"="+e[n]);return t.join("&")},Array.prototype.random||Object.defineProperty(Array.prototype,"random",{enumerable:!1,configurable:!0,writable:!0,value:function(){return this.length?this[Math.randomBetween(0,this.length-1)]:void 0}}),Array.prototype.compare||Object.defineProperty(Array.prototype,"compare",{enumerable:!1,configurable:!0,writable:!0,value:function(e){if(!e)return!1;if(this.length!==e.length)return!1;for(var t=0;t<this.length;t++)if(Array.isArray(this[t])&&Array.isArray(e[t])){if(!this[t].compare(e[t]))return!1}else if(this[t]!==e[t])return!1;return!0}}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{enumerable:!1,configurable:!0,writable:!0,value:function(e){if(null==this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var t,n=Object(this),i=n.length>>>0,o=arguments[1],r=0;i>r;r++)if(r in n&&(t=n[r],e.call(o,t,r,n)))return t;return void 0}}),Array.prototype.findIndex||Object.defineProperty(Array.prototype,"findIndex",{enumerable:!1,configurable:!0,writable:!0,value:function(e){if(null==this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var t,n=Object(this),i=n.length>>>0,o=arguments[1],r=0;i>r;r++)if(r in n&&(t=n[r],e.call(o,t,r,n)))return r;return-1}}),Array.prototype.last||Object.defineProperty(Array.prototype,"last",{enumerable:!1,configurable:!0,writable:!0,value:function(){return this[this.length-1]}}),Array.prototype.pushArray||Object.defineProperty(Array.prototype,"pushArray",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return this.push.apply(this,e)}}),Array.prototype.move||Object.defineProperty(Array.prototype,"move",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){return this.splice(t,0,this.splice(e,1)[0]),this}}),Array.prototype.remove||Object.defineProperty(Array.prototype,"remove",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){var n=this.slice((t||e)+1||this.length);return this.length=0>e?this.length+e:e,this.push.apply(this,n)}}),Array.prototype.removeByValue||Object.defineProperty(Array.prototype,"removeByValue",{enumerable:!1,configurable:!0,writable:!0,value:function(){for(var e,t,n=arguments,i=n.length;i&&this.length;)for(e=n[--i];-1!==(t=this.indexOf(e));)this.splice(t,1);return this}}),"function"!=typeof Array.convert&&(Array.convert=function(e){return Array.prototype.slice.call(e)}),Array.prototype.contains||Object.defineProperty(Array.prototype,"contains",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return-1!==this.indexOf(e)}}),Array.prototype.unique||Object.defineProperty(Array.prototype,"unique",{enumerable:!1,configurable:!0,writable:!0,value:function(){for(var e=this.concat(),t=0;t<e.length;++t)for(var n=t+1;n<e.length;++n)e[t]===e[n]&&e.splice(n--,1);return e}}),Number.addThousandSeparators||!function(){var e;Number.addThousandSeparators=function(t,n){return e||(e=",",window&&window.config&&window.config.language&&["de","es"].contains(window.config.language())&&(e=".")),t.toString().replace(/(\d)(?=(\d\d\d)+([^\d]|$))/g,"$1"+(n||e))}}(),void 0===Date.getSplitedTime&&(Date.getSplitedTime=function(e){return{days:Math.floor(e/864e5),hours:Math.floor(e/36e5)%24,minutes:Math.floor(e/6e4)%60,seconds:Math.floor(e/1e3)%60,milliseconds:e%1e3}}),String.prototype.lpad||Object.defineProperty(String.prototype,"lpad",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){for(var n=this;n.length<t;)n=e+n;return n}}),String.prototype.contains||Object.defineProperty(String.prototype,"contains",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return-1!==this.indexOf(e)}}),String.prototype.rpad||Object.defineProperty(String.prototype,"rpad",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){for(var n=this;n.length<t;)n+=e;return n}}),String.prototype.toCamelCase||Object.defineProperty(String.prototype,"toCamelCase",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=e?/((\-|^)[a-z])/g:/(\-[a-z])/g;return this.replace(t,function(e){return e.toUpperCase().replace("-","")})}}),String.prototype.permalink||Object.defineProperty(String.prototype,"permalink",{enumerable:!1,configurable:!0,writable:!0,value:function(){var e=[["а","А"],["б","Б"],["в","В"],["г","Г"],["д","Д"],["е","Е"],["ё","Ё"],["ж","Ж"],["з","З"],["и","И"],["й","Й"],["к","К"],["л","Л"],["м","М"],["н","Н"],["о","О"],["п","П"],["р","Р"],["с","С"],["т","Т"],["у","У"],["ф","Ф"],["х","Х"],["ц","Ц"],["ч","Ч"],["ш","Ш"],["щ","Щ"],["ъ","Ъ"],["ы","Ы"],["ь","Ь"],["э","Э"],["ю","Ю"],["я","Я"],["ä","Ä"],["ö","Ö"],["ß","ß"],["ü","Ü"],["ñ","Ñ"],["ó","Ó"],["í","Í"],["á","Á"],["é","É"],["ú","Ú"],["ø","Ø"]],t=["a","b","v","g","d","e","e","zh","z","i","y","k","l","m","n","o","p","r","s","t","u","f","h","c","ch","sh","sch","j","y","","e","yu","ya","ae","oe","ss","ue","n","o","i","a","e","u","o"];return function(){for(var n=""+this,i=0;i<e.length;i++)n=n.replace(new RegExp("["+e[i].join("")+"]","g"),t[i]);return n=n.toLowerCase().replace(/\W/g,"-").replace(/-+/g,"-"),"-"===n[0]&&(n=n.substr(1)),"-"===n[n.length-1]&&(n=n.substr(0,n.length-1)),n}}()}),String.prototype.capitalize||Object.defineProperty(String.prototype,"capitalize",{enumerable:!1,configurable:!0,writable:!0,value:function(){return this[0].toUpperCase()+this.slice(1)}}),String.prototype.ellipsis||Object.defineProperty(String.prototype,"ellipsis",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=""+this;if("object"!=typeof e&&(e={length:20}),e.length||e.pixels||(e={length:20}),e.length&&t.length>e.length)return t.substr(0,e.length-3).trim()+"...";if(e.pixels&&"undefined"!=typeof jQuery){e.append=e.append||"";var n=jQuery("<div/>").css({
position:"absolute",opacity:0,left:0,top:0,"white-space":"nowrap"}).appendTo("body").html(t+e.append),i=!1;for(e.css&&n.css(e.css);n.width()>e.pixels;)i=!0,t=t.substr(0,t.length-1).trim(),n.html(t+"..."+e.append);t+=i?"...":"",n.remove()}return t}}),String.prototype.sanitize||Object.defineProperty(String.prototype,"sanitize",{enumerable:!1,configurable:!0,writable:!0,value:function(){return this.replace(/<[^>]+>/g,"")}}),JSON.betterParse||(JSON.betterParse=function(e){return"undefined"===e?void 0:JSON.parse(e)}),Object.removeUndefined||(Object.removeUndefined=function(e){for(var t in e)e.hasOwnProperty(t)&&void 0===e[t]&&delete e[t];return e}),Object.getAndRemove||(Object.getAndRemove=function(e,t){var n=e[t];return n&&delete e[t],n}),JSON.betterParse||(JSON.betterParse=function(e){return"undefined"===e?void 0:JSON.parse(e)}),Object.diff||(Object.diff=function(e,t){if(Array.isArray(t))var n=[];else n={};void 0===e&&(e={}),void 0===t&&(t={});for(var i in t)if(t.hasOwnProperty(i))if(Array.isArray(t[i]))JSON.stringify(e[i])!==JSON.stringify(t[i])&&(n[i]=t[i]);else if("object"==typeof t[i]){var o=Object.diff(e[i],t[i]);(Object.keys(o).length||"object"!=typeof e[i])&&(n[i]=o)}else e[i]!==t[i]&&(n[i]=t[i]);for(var i in e)e.hasOwnProperty(i)&&void 0===t[i]&&void 0!==e[i]&&(n[i]=null);return n}),Object.patch||(Object.patch=function(e,t){for(var n in t)t.hasOwnProperty(n)&&(null===t[n]?delete e[n]:"object"!=typeof t[n]||Array.isArray(t[n])?e[n]=t[n]:("object"!=typeof e[n]&&(e[n]={}),Object.patch(e[n],t[n])));if(Array.isArray(e))for(;e.length&&void 0===e[e.length-1];)e.pop();return e}),Object.getByPath||(Object.getByPath=function(e,t,n){n=n||".",t=t.split(n);var i=t.shift();return i&&e&&e[i]?0===t.length?e[i]:Object.getByPath(e[i],t.join(n)):void 0}),Object.setByPath||(Object.setByPath=function(e,t,n,i){i=i||".";for(var o=t.split(i),r=0;r<o.length-1;r++){var a=o[r];e.hasOwnProperty(a)||(e[a]={}),e=e[a]}e[o[o.length-1]]=n}),window.defaultSettings={version:"dev.2022-09-05-155754",language:"en","message-enter-to-send":"1","comment-order":"desc","challenges-accept":"everyone","game-autopromote-queen":"0","game-coordinates-on-board":"0","game-board-speed":4,"game-board-theme":"chess24","game-piece-theme":"chess24","game-sounds-theme":"fusion","game-sound-category-playzone":"1","game-sound-category-tactic":"1","game-sound-category-broadcast":"0","game-broadcast-engine":"1","game-broadcast-engine-local":"1","game-recommendation-playzone":"1","game-recommendation-broadcast":"1","game-highlight-check":"1","game-highlight-last-move":"1","game-highlight-possible-square":"1","game-premove":"1","game-sounds":"1","game-sounds-volume":"100","game-table-pieces-as-symbol":"1","game-table-short-algebraic":"1","game-table-show-comments":"0","game-table-show-sidelines":"1","game-chat":"1","game-tournament-immediate":"1","game-confirm-move":"0","game-blindfold":"none","game-clock":300,"game-increment":0,"notification-friendship-request":"0","notification-new-comments":"0","notification-news":"0","welcome-emails":"0","notification-spacial-offers":"0","privacy-birthdate":"everyone","privacy-email":"hidden","privacy-federation":"everyone","privacy-friendslist":"friends","privacy-online":"everyone","privacy-realname":"everyone","tactics-length":"1","tactics-stop":"always","tactics-timeline":"1","blocked-users":"#","play-elo-range-min":-500,"play-elo-range-max":500,"broadcast-chat-selected":"1","game-made-own-move":"0","engine-lines-collapsed":"0","pair-registered-only":"0","live-video-languages":"en,de,es,fr,no,pt,ru,tr,zh,it,pl","play-board-xl":"0","analysis-list-mode":"0","auto-commentator":"0",hasNecessaryConsent:"1",hasSettingsConsent:"0",hasPerformanceConsent:"0",hasSocialMediaConsent:"0",hasMarketingConsent:"0",lastConsentReview:"",lastEmailSettingsReview:"","no-thanks":"0",chokerEnabled:"0",forceReLogin:"0",tags:"",showReminderUpgrade:"",lastReminderUpgrade:""},function(){var e="/api/web/UserAPI/getUserData",t="/api/web/UserAPI/getUserThemes",n="/api/web/UserAPI/authConfig",i="user_data",o="consent",r="register",a={},s=768;$redesign=$(".liveTournament_redesign")[0],$redesignSuffix=$(".liveTournament_redesign")[0]?"Redesign":"",$embedCCT=$('.liveTournament_embedCustom [data-customer="cct"]')[0],$embedCCTSuffix=$('.liveTournament_embedCustom [data-customer="cct"]')[0]?"EmbedCCT":"",$suffix="",$redesign?$suffix=$redesignSuffix:$embedCCT&&($suffix=$embedCCTSuffix),$mainBroadcast=$(".liveTournament_index")[0],window.config={level:function(e){if("undefined"==typeof e&&(e=!1),a.level&&!e)return a.level;a.level={isGuest:!0,isRegistered:!1,isPremium:!1,isModerator:!1,isAdmin:!1,isFraudAgent:!1,isTournamentOrganiser:!1,isEditor:!1,isTester:!1,isLabTester:!1,isArbiter:!1,isPlayzone2:!1};var t=jQuery.cookie(i);if(t)try{a.level=Object.merge(a.level,JSON.betterParse(t).level)}catch(n){errorHandler.error(n,{json:t})}return a.level.toString=function(){return a.level.isPremium?"premium":a.level.isGuest?"guest":"registered"},a.level},user:function(t){if(t="undefined"!=typeof t?t:!1,a.user)return a.user;var n=jQuery.cookie(i);if(n)try{a.user=JSON.betterParse(n).user}catch(o){errorHandler.error(o,{json:n})}return(!a.user||t||a.user&&!a.user.name)&&jQuery.ajax({url:e,cache:!1,async:!1,dataType:"json",type:"GET"}).done(function(e){if(e.data&&e.data.userData){var t=e.data.userData;$.cookie(t.name,t.value,{path:"/",expires:t.ttl});var n={permalink:null,elo:{bullet:1500,blitz:1500,classical:1500,trainerClassic:1500,trainerSpeed:1500},country:null,name:null,url:"",image:"26x26_profile_default.png",countryIso3:null};a.user=Object.merge(n,JSON.parse(t.value).user),config.level()}}).fail(function(e,t,n){errorHandler.error(n)}),a.user?a.user:{}},themes:function(){return a.themes?a.themes:(jQuery.ajax({url:t,cache:!1,async:!1,dataType:"json",type:"GET"}).done(function(e){e.data&&e.data.themes||errorHandler.error(new Error("invalid response",{response:e})),a.themes=e.data.themes}).fail(function(e,t,n){errorHandler.error(n)}),a.themes?a.themes:{})},csrf:function(){return a.csrf=a.csrf||jQuery.cookie("csrf")},version:function(){return a.version||(a.version=jQuery("meta#version").attr("content"))},language:function(){return a.language||(a.language=jQuery("html").attr("lang"))},assetDir:function(){return a.assetDir||(a.assetDir=jQuery("link[rel=media-url]").attr("href"))},consent:function(e){if("undefined"==typeof e&&(e=!0),a.consent&&!e)return a.consent;if(a.consent={hasNecessaryConsent:!0,hasSettingsConsent:!1,hasSocialMediaConsent:!1,hasPerformanceConsent:!1,hasMarketingConsent:!1,lastConsentReview:null},config.level().isGuest){var t=$.cookie(o);if(t)try{a.consent=JSON.betterParse(t)}catch(n){}return a.consent}return a.consent={hasNecessaryConsent:!0,hasSettingsConsent:!0,hasSocialMediaConsent:window.settings.getBoolean("hasSocialMediaConsent"),hasPerformanceConsent:window.settings.getBoolean("hasPerformanceConsent"),hasMarketingConsent:window.settings.getBoolean("hasMarketingConsent"),lastConsentReview:window.settings.getString("lastConsentReview")},a.consent},registerReminder:function(e){if("undefined"==typeof e&&(e=!0),a.register&&!e)return a.register;if(a.register={showReminder:null,lastReminder:null},config.level().isGuest){var t=$.cookie(r);if(t)try{a.register=JSON.betterParse(t)}catch(n){}return a.register}},upgradeReminder:function(e){if("undefined"==typeof e&&(e=!0),a.upgrade&&!e)return a.upgrade;var t=window.settings.getString("showReminderUpgrade");switch(t){case"true":t=!0;break;case"false":t=!1}return a.upgrade={showReminder:t,lastReminder:window.settings.getString("lastReminderUpgrade")},a.upgrade},isMobileView:function(){return $(window).width()<=s},newHouse:function(){if(a.newHouse)return a.newHouse;var e=jQuery("body").data("newhouse-baseurl");return a.newHouse={playUrl:e+"/play",profileUrl:e+"/player/"+config.user().uuid,followUrl:e+"/follow",gameUrl:e+"/game"},a.newHouse},auth:function(){return a.auth?a.auth:(a.auth=jQuery.getJSON(n).then(function(e){return e.data.config})["catch"](function(e){return{loginFormUrl:""}}),a.auth)},redirectToLogin:function(e,t){e.preventDefault(),config.auth().done(function(e){var n=new URL(e.loginFormUrl);t&&n.searchParams.append("kc_idp_hint","facebook"),window.location=n})},attachLoginLink:function(){jQuery(".login-link").on("click",function(e){config.redirectToLogin(e)})}}}(),function(){var e={},t=function(t,n,i,o){function r(e){return void 0===e?v:void 0===v[e]?[]:v[e]}function a(e,n,i,o){var r=function(){n.apply(this,arguments),u(e,r,o)};return w.push({wrapper:r,original:n,alias:o}),l(e,r,i,o),t}function s(e){return Array.isArray(e)||("string"!=typeof e&&(e=e.toString()),e=e.split(" ")),e}function l(e,n,i,o){"function"!=typeof n&&errorHandler.msg("error",new Error("no callback given during on-registration"),!0),e=s(e);for(var r=0;r<e.length;r++){var a=e[r];void 0===v[a]&&(v[a]=[]),v[a].push({callback:n,sync:o,alias:i})}return t}function c(t){if(e[t])return e[t];var n=t.split("."),i=[],o=n[0];i.push(o);for(var r=1;r<n.length;r++)o=o+"."+n[r],i.push(o);return e[t]=d(i),e[t]}function d(e){for(var t=[e[0]],n=0;n<e.length;n++)for(var i=e[n].split("."),o=i.length-1,r=i.splice(o,1)[0],a=i.length,s=Math.pow(2,a),l=0;s>l;l++){for(var c=[],d=l.toString(2).lpad("0",a),u=d.split(""),h=0;h<u.length;h++)c.push("0"===u[h]?"*":i[h]);a>0&&c.push(r),t.push(c.join("."))}return t}function u(e,n){if(void 0===e)return v={},t;var i="function"==typeof n,o="string"==typeof n;if(i)for(var r=0;r<w.length;r++)if(w[r].original===n){n=w[r].wrapper,w.splice(r,1);break}e=s(e);for(var a=0;a<e.length;a++){var l=e[a];if(void 0!==v[l])if(void 0!==n){for(var c=v[l].length-1;c>=0;c--)(i&&v[l][c].callback===n||o&&v[l][c].alias===n)&&v[l].splice(c,1);0===v[l].length&&delete v[l]}else delete v[l]}return t}function h(e){if(e)var t=[e];else{t=[];for(var n in y)t.push(n)}for(var i=0;i<t.length;i++){n=t[i];for(var o=0;o<y[n].length;o++)clearTimeout(y[n][o]);delete y[n]}}function p(e,t,n){try{i?t(e,n):t(n)}catch(r){errorHandler.msg("warning",new Error("registered subscriber ended with following error"),!1,{eventObject:e,additionalData:n}),errorHandler.msg("error",r,!o,{eventObject:e,additionalData:n})}}function f(e,t,n){return m(e,t,n,!0)}function g(e,t,n){return m(e,t,n,!1)}function m(e,n,i,o){"string"!=typeof e&&(e=e.toString());for(var r=e.split(" "),a=o,s=0;s<r.length;s++)for(var l=r[s],d=c(l),u=0;u<d.length;u++){var h=d[u],f={publisher:t,currentChannel:h,channel:l};if(void 0!==v[h])for(var g=0;void 0!==v[h]&&g<v[h].length;g++){var m=v[h][g].callback,w=o;void 0===w&&(w=v[h][g].sync),void 0===w&&(w=!0),w?p(f,m,n):(a=!1,void 0===y[h]&&(y[h]=[]),y[h].push(setTimeout(function(){p(f,m,n)},0)))}}return"function"==typeof i&&(a===!1?setTimeout(function(){i(t,n)},0):i(t,n)),t}void 0===o&&(o=!0),void 0===n&&(n={}),void 0===i&&(i=!0),n.on=n.on||"on",n.once=n.once||"once",n.off=n.off||"off",n.cancelEmit=n.cancelEmit||"cancelEmit",n.emit=n.emit||"emit",n.emitSync=n.emitSync||"emitSync",n.emitAsync=n.emitAsync||"emitAsync",n.get=n.get||"getSubscribers";var v={},y={},w=[];for(var b in n)void 0!==t[n[b]]&&errorHandler.msg("error",new Error("can not make this to a publisher, because a needed function is blocked"),!0,{blockedFunction:b});return t[n.on]=l,t[n.once]=a,t[n.off]=u,t[n.cancelEmit]=h,t[n.emit]=m,t[n.emitSync]=f,t[n.emitAsync]=g,t[n.get]=r,t};"undefined"!=typeof exports?module.exports=t:("undefined"==typeof Extend&&(Extend={}),Extend.Publisher=t)}(),function(e,t){function n(){function e(e){"undefined"!=typeof exports&&require("./view/"+e)}function r(t){(void 0===a.View||void 0===a.View[t])&&e(t.toLowerCase()+".js");var n=function(){},i=errorHandler.View[t];if(n.prototype=i.prototype,void 0===i)throw new Error("the requested View for the errorHandler doesn't exist");var o=new n;Array.prototype.shift.call(arguments),i.apply(o,arguments),o.link(a)}if(n.instance)return n.instance;var a=this,s=[],l={0:0,3:3,6:6,8:8,10:10,debug:0,notice:3,warning:6,error:8,critical:10};t&&(window.onerror=function(e,t,n,i,o){return o&&o._reported||a.notice(o||"Uncaught Exception",{msg:e,url:t,line:n,column:i},!1),!1},a.hasErrors=function(){return s.length>0},a.getErrors=function(){return s},a.clearErrors=function(){s.length=0}),Extend.Publisher(a);var c;return a.setAdditionalData=function(e){return c=e,a},a.debug=function(e,t,n){n!==!0&&(n=!1),a.msg("debug",e,n,t)},a.notice=function(e,t,n){n!==!0&&(n=!1),a.msg("notice",e,n,t)},a.warning=function(e,t,n){n!==!0&&(n=!1),a.msg("warning",e,n,t)},a.error=function(e,t,n){void 0===n&&(n=!0),a.msg("error",e,n,t)},a.critical=function(e,t,n){void 0===n&&(n=!0),a.msg("critical",e,n,t)},a.msg=function(e,n,r,d){if(r=r||!1,!r||n instanceof Error)u="string"==typeof n?{name:n}:n;else var u=new Error(n);if(void 0===l[e])throw new Error("errorLevel ("+e+") is not valid");var h=(new Helper.UUID).getShort();u.message=u.message||u.name||"noMessage",u.name=u.name||"noName",d=d||{},r&&(d.throwException=r);var p=d.pulse;delete d.pulse;try{var f=JSON.stringify(d)}catch(g){f="Failed to stringify context: "+g.message}f.length>o&&(d={shortened:f.substring(0,o)});var m=l[e],v={errorId:h,levelNumber:m,stack:u.stack,pulse:p,message:u.message,name:u.name,timeStamp:Date.now(),context:d,additional:c};if(t&&s.push(v)>i&&s.shift(),a.emit(m,v),r)throw u._reported=!0,u;return a},a.addView=function(e){Array.isArray(e)||(e=[e]);var t=e;Array.prototype.shift.call(arguments);for(var n=0;n<t.length;n++){var i=[t[n]];i.pushArray(arguments),r.apply(this,i)}return a},n.instance=a,a}var i=20,o=2e4;t||(require("../model/extend.js"),require("../model/helper/uuid.js")),e.errorHandler=e.errorHandler||new n}("undefined"==typeof exports?window:global,"undefined"==typeof exports),"undefined"==typeof Chess&&(Chess={}),function(){function e(e){return e&&e.evaluations&&e.evaluations[0]?Object.removeUndefined({score:e.evaluations[0].score,mate:e.evaluations[0].mate}):void 0}function t(e){return"0000"===e?e:(/^[a-h][1-8][a-h][1-8][rnbq]?/.test(e)||"O-O"!==e&&"O-O-O"!==e&&errorHandler.error(new Error("invalid can format"),{canBeforeTransformation:e}),e.substr(0,1)+(9-e.substr(1,1))+e.substr(2,1)+(9-e.substr(3,1))+e.substr(4))}function n(e,t){e[1]=t,e[0]=e[0].split("/").reverse().join("/");for(var n=["r","n","b","q","k","p"],i=0;i<n.length;i++)e[0]=e[0].replace(new RegExp(n[i].toUpperCase(),"g"),"z").replace(new RegExp(n[i],"g"),n[i].toUpperCase()).replace(/z/g,n[i]);return"-"!==e[2]&&(e[2]=Helper.Chess960.getOppositeColorCastlingRights(e[2])),"-"!==e[3]&&(e[3]=e[3].substr(0,1)+("b"===t?3:6)),e}function i(e){var t=e.split(" ");return t.pop(),"b"===t[1]&&(t=n(t,"w")),parseInt(t.last(),10)<=20&&(t[t.length-1]=0),t.join("_")}function o(e,t){var i=e.split("_");return i.push("1"),t&&(i=n(i,"b")),i.join(" ")}function r(e){return"-"===e?-1:e.charCodeAt(0)-97}function a(e){return String.fromCharCode(e+97)}function s(e){return e.replace(/8/g,"--------").replace(/7/g,"-------").replace(/6/g,"------").replace(/5/g,"-----").replace(/4/g,"----").replace(/3/g,"---").replace(/2/g,"--").replace(/1/g,"-")}function l(e){return e.replace(/--------/g,"8").replace(/-------/g,"7").replace(/------/g,"6").replace(/-----/g,"5").replace(/----/g,"4").replace(/---/g,"3").replace(/--/g,"2").replace(/-/g,"1")}function c(e,t){if("string"!=typeof e&&errorHandler.msg("error",new Error("Cant decode CAN - No String"),!0,{can:e}),"O-O-O"===e)return Helper.Chess960.getMoveWithCastleInfo(t,!1,!0);if("O-O"===e)return Helper.Chess960.getMoveWithCastleInfo(t,!0,!0);(e.length<4||e.length>5)&&errorHandler.msg("error",new Error("Cant decode CAN - Wrong Length: "+e),!0,{can:e});var n,i=r(e.substr(0,1)),o=parseInt(e.substr(1,1),10)-1,a=r(e.substr(2,1)),s=parseInt(e.substr(3,1),10)-1;return 5===e.length&&(n=e.substr(4,1).toLowerCase()),Chess.getMove(o,i,s,a,n)}function d(e,t){return"string"!=typeof e&&errorHandler.msg("error",new Error("Cant decode LAN - No String"),!0,{lan:e}),"--"===e?h(0):(e=e.replace(/-/g,"").replace(/0/g,"O").replace("x","").replace("+","").replace("=","").replace("#",""),"OO"===e?c("w"===t.moveRight?"e1g1":"e8g8"):"OOO"===e?c("w"===t.moveRight?"e1c1":"e8c8"):(e.substr(0,1)===e.substr(0,1).toUpperCase()&&(e=e.substr(1)),c(e)))}function u(e,t){if("string"!=typeof e&&errorHandler.error(new Error("Cant decode SAN - No String"),{san:e}),"--"===e)return Chess.getNullMove();var n="w"===t.moveRight,i=e.replace(/[-x+=#]/g,"").replace(/0/g,"O").replace("ep","");if("OO"===i)return Helper.Chess960.getMoveWithCastleInfo(t,!0,!0);if("OOO"===i)return Helper.Chess960.getMoveWithCastleInfo(t,!1,!0);if(/^[RNBQK]/.test(i)){var o=n?i.substr(0,1):i.substr(0,1).toLowerCase();i=i.substr(1)}else if(o=n?"P":"p",/[rnbq]$/i.test(i)){var a=i.substr(-1).toLowerCase();i=i.substr(0,i.length-1)}var s=i.substr(-1)-1,l=r(i.substr(-2,1));if(3===i.length){var c=i.substr(0,1);if(/[a-h]/.test(c))var d=r(c);else var u=c-1}else 4===i.length&&(d=r(i.substr(0,1)),u=i.substr(1,1)-1);return t.findPotentialStartSquares(o,u,d,s,l,a)}function h(e,t){isNaN(e)&&errorHandler.msg("error",new Error("Cant decode SEP - No Numeric value"),!0,{sep:e}),(0>e||e>16383)&&errorHandler.msg("error",new Error("SEP out of range"),!0,{sep:e});var n,i=Math.floor(e%8),o=Math.floor(e/8%8),r=Math.floor(e/64%8),a=Math.floor(e/512%8),s=Math.floor(e/4096);switch(s){case 0:(0===o&&1===a||7===o&&6===a)&&t&&"P"===t.getPiece(a,r).toUpperCase()&&(n="r");break;case 1:n="n";break;case 2:n="b";break;case 3:n="q"}return Helper.Chess960.isMoveValidCastle(t,Chess.getSquare(a,r),Chess.getSquare(o,i),!0)?Helper.Chess960.getMoveWithCastleInfo(t,!0,!0):Helper.Chess960.isMoveValidCastle(t,Chess.getSquare(a,r),Chess.getSquare(o,i),!1)?Helper.Chess960.getMoveWithCastleInfo(t,!1,!0):Chess.getMove(a,r,o,i,n)}function p(e){var t=e.split("|");return"undefined"===t[4]&&(t[4]=void 0),Chess.getMove(t[0],t[1],t[2],t[3],t[4])}function f(e){return 0===e.y1&&0===e.x1&&0===e.y2&&0===e.x2?"0000":a(e.x1)+(e.y1+1)+a(e.x2)+(e.y2+1)+(void 0===e.promotion?"":e.promotion)}function g(e,t,n,i,o){return 0===e&&0===t&&0===n&&0===i?"0000":a(t)+(e+1)+a(i)+(n+1)+(void 0===o?"":o)}function m(e,t,n,i,o){if(0===e.y1&&0===e.x1&&0===e.y2&&0===e.x2)return"--";var r=t.toUpperCase();if(n)var s="x";else s="-";"P"===r&&(r="");var l;return e.castleInfo.isCastle&&(t="",l=e.castleInfo.isKingCastle?"O-O":"O-O-O"),void 0===l&&(l=r+a(e.x1)+(e.y1+1)+s+a(e.x2)+(e.y2+1)+(void 0===e.promotion?"":e.promotion.toUpperCase())),i?l+="#":o&&(l+="+"),l}function v(e,t,n,i,o,r){function s(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.x1===e.x1&&i.y1===e.y1&&i.x2===e.x2&&i.y2===e.y2&&i.castleInfo.isCastle&&(e.castleInfo=JSON.parse(JSON.stringify(i.castleInfo)))}}var l,c,d,u=t.toUpperCase();if(s(e,n),e.castleInfo.isCastle&&(t="",d=e.castleInfo.isKingCastle?"O-O":"O-O-O"),!d){for(var h=[],p=0;p<n.length;p++)n[p].y1===e.y1&&n[p].x1===e.x1||n[p].y2!==e.y2||n[p].x2!==e.x2||n[p].promotion!==e.promotion||h.push(n[p]);var f=!0,g=!0;if(h.length){for(p=h.length-1;p>=0;p--)if(e.y1===h[p].y1){f=!1;break}for(p=h.length-1;p>=0;p--)if(e.x1===h[p].x1){g=!1;break}f||g?g?l=!0:c=!0:(l=!0,c=!0)}l=l||i&&"P"===u,d=(l?a(e.x1):"")+(c?e.y1+1:"")+(i?"x":"")+a(e.x2)+(e.y2+1)+(void 0===e.promotion?"":"="+e.promotion.toUpperCase())}return o?d+="#":r&&(d+="+"),[t,d]}function y(e,t,n,i,o,r){if(e.isNullMove())return"--";var a=v(e,t,n,i,o,r);return a[0]=a[0].toUpperCase(),"P"===a[0]?a[1]:a[0]+a[1]}function w(e,t,n,i,o,r){var a={K:"&#9812;",Q:"&#9813;",R:"&#9814;",B:"&#9815;",N:"&#9816;",P:"",k:"&#9818;",q:"&#9819;",r:"&#9820;",b:"&#9821;",n:"&#9822;",p:""},s=v.apply(null,arguments),l=a[s[0]]||"";return l+s[1]}function b(e){var t;switch(e.promotion){case"n":t=1;break;case"b":t=2;break;case"q":t=3;break;default:t=0}return 4096*t+512*e.y1+64*e.x1+8*e.y2+e.x2}function C(e){var t=parseInt(e.substr(1,1),10)-1,n=r(e.substr(0,1));return Chess.getSquare(t,n)}Chess.translate={coordinatesToCan:g,decodeHumanCordX:r,encodeHumanCordX:a,detailedToReducedEngine:e,longFenToEngineFen:i,engineFenToLongFen:o,shortToLongPositionGroup:s,longToShortPositionGroup:l,canToMove:c,lanToMove:d,sanToMove:u,sepToMove:h,moveStringToMove:p,moveToCan:f,moveToLan:m,moveToSan:y,moveToFan:w,moveToSep:b,squareStringToSquare:C,whiteToBlackMove:t}}(),"undefined"==typeof Handler&&(Handler={}),Handler.engine=function(){function e(e,t,n){return a[e]=a[e]||{},a[e][t]&&a[e][t].source&&y[a[e][t].source]>(y[n.source]||0)?void 0:(a[e][t]=n,!0)}function t(e,t){if(a[e]){var n=p[t],i=n.find(function(t){return a[e][t]});return i?{type:i,value:a[e][i]}:void 0}}function n(e){m[e]||errorHandler.error(new Error("Invalid engineType during set"),{validEngineType:m,typeToBeChecked:e})}function i(e,n,i){var o=n===u;if("string"==typeof e)if(e.indexOf(" ")>-1)var a=Chess.translate.longFenToEngineFen(e);else a=e;else{if(e.isNullMove())return;a=e.getEngineFen()}var l=t(a,n);if(l)return o&&l.type===h?Chess.translate.detailedToReducedEngine(l.value):l.value;if(f[n].every(function(e){return s[e]?s[e](a):!0}),i){for(var p,g=[];!p&&g.length<=c&&e&&e.parentMove;)p=t(e.parentMove.getEngineFen(),h),g.unshift(e.getCan()),e=e.parentMove;if(void 0===p)return;p=p.value,e.nextMoveIsBlack()&&(g=g.map(function(e){return Chess.translate.whiteToBlackMove(e)}));e:for(var m=0;m<p.evaluations.length;m++){for(var v=p.evaluations[m],y=0;y<g.length;y++)if(!v.moves||g[y]!==v.moves[y])continue e;var w=Object.subset(v,d);if(void 0!==w.mate){var b=w.mate<0,C=Math.abs(w.mate)-Math.floor(g.length/2);b&&(C=-1*C),w.mate=C}return o||(w={depth:p.depth-g.length,source:p.source,evaluations:[w]},w.evaluations[0].moves=v.moves.slice(g.length)),g.length%2?r.invert(w):w}}}function o(e,t,n){return b[t]&&b[t](e,n)}var r=Extend.Publisher({}),a={},s={},l=40,c=30,d=["score","mate"],u=r.NUMERICAL_ENGINE_TYPE="numerical",h=r.DETAILED_ENGINE_TYPE="detailed",p={};p[u]=[u,h],p[h]=[h];var f={};f[u]=[u,h],f[h]=[h];var g={};g[u]=[u],g[h]=[u,h];var m={};m[u]=!0,m[h]=!0;var v={local:"Local",cloud:"Cloud"},y={Local:0,Cloud:1},w={};w[u]={score:0};var b={};return b[u]=function(e,t){return null===t||"object"!=typeof t?(errorHandler.warning(new Error(h+" engineData is not an object"),{engineData:t,engineFen:e}),!1):void 0===t.score&&void 0===t.mate?(errorHandler.warning(new Error(u+" engineData does not have required property"),{engineData:t,engineFen:e}),!1):!0},b[h]=function(e,t){return void 0===t?(errorHandler.warning(new Error(h+" engineData is not an object"),{engineData:t,engineFen:e}),!1):void 0===t.depth?(errorHandler.warning(new Error(h+" engineData requires depth value"),{engineData:t,engineFen:e}),!1):Array.isArray(t.evaluations)?!0:(errorHandler.warning(new Error(h+" engineData requires evaluations"),{engineData:t,engineFen:e}),!1)},r.setDataGetter=function(e,t){return s[e]=t,r},r.shouldInvert=function(e,t){return t&&0===t.mate&&e.nextMoveIsWhite()||t&&0!==t.mate&&e.nextMoveIsBlack()?!0:!1},r.invertData=function(e,t){return this.shouldInvert(e,t)?this.invert(t):t},r.invert=function(e){if(void 0===e)return e;if(e._inverse)return e._inverse;var t=["score","mate"];if(e.evaluations)var n={_inverse:e,depth:e.depth,source:e.source,engineName:e.engineName,evaluations:e.evaluations.map(function(e){var n={};return e.moves&&(n.moves=e.moves.map(function(e){return Chess.translate.whiteToBlackMove(e)})),t.forEach(function(t){void 0!==e[t]&&(n[t]=-1*e[t])}),n})};else n={},t.forEach(function(t){void 0!==e[t]&&("mate"===t&&0===e[t]?n[t]="-0":n[t]=-1*e[t])}),e.approximated&&(n.approximated=e.approximated);return e._inverse=JSON.parse(JSON.stringify(n))},r.get=function(e,t,o,r){n(t);var a=0;do var s=i(e,t,o);while(r&&!s&&e instanceof Chess.Position&&(e=e.parentMove)&&++a<=l);if(r){a%2&&s&&(s=Handler.engine.invert(s));var c=Object.merge(s||w[t]);return a&&(c.approximated=!0),c}return s},r.set=function(t,i,a){return n(i),o(t,i,a)?void(e(t,i,a)&&g[i].forEach(function(e){var n=a;i===h&&e===u&&(n=Chess.translate.detailedToReducedEngine(a)),a.source&&(e+="."+a.source),r.emit(t+":"+e,n)})):r},r.formatEngine=function(e,t){return void 0!==e?(e/100).toFixed(2):void 0!==t?"#"+t:""},r.isLocalEvaluation=function(e){return e&&e.source===v.local},r.isCloudEvaluation=function(e){return e&&e.source===v.cloud},r}(),errorHandler.View=errorHandler.View||{},"undefined"!=typeof exports,errorHandler.View.Client=function(e,t,n,i){function o(e,t){return s("log",t),c}function r(e,t){return s("warn",t),c}function a(e,t){return s("error",t),c}function s(e,t){if(void 0!==t.context&&void 0!==t.context.__clientId){var n=t.context.__clientId;Array.isArray(n)||(n=[n]);for(var i=0;i<n.length;i++)l(n[i],e,t)}return c}function l(t,n,i){if(u>d){d++;var o=e(t);if(void 0!==o&&"function"==typeof o.emit){var r={cat:n,errorId:i.errorId};o.emit("serverError",r)}}}e=e||dummy;var c=this,d=0,u=5,h={};void 0===h.log&&(h.log=0),void 0===h.warn&&(h.warn=4),void 0===h.error&&(h.error=8),void 0===t&&(t=h.log),void 0===n&&(n=h.log),void 0===i&&(i=h.log);for(var p={callbacks:{}},f=t;n>f;f++)p.callbacks[f]=o;for(f=n;i>f;f++)p.callbacks[f]=r;for(f=i;11>f;f++)p.callbacks[f]=a;if(Extend.Subscriber(c,p.callbacks),"undefined"==typeof exports)throw new Error("errorRabbitView will not work, because here im running in a fucking browser");return c},errorHandler.View=errorHandler.View||{},errorHandler.View.Console=function(e,t,n){function i(e,t){try{l.log(a(t.stack,t.message,t.name,t.timeStamp)),s(t.context)}catch(n){}return d}function o(e,t){try{l.warn(a(t.stack,t.message,t.name,t.timeStamp)),s(t.context)}catch(n){}return d}function r(e,t){try{l.error(a(t.stack,t.message,t.name,t.timeStamp)),s(t.context)}catch(n){}return d}function a(e,t,n,i){return"("+i+") "+n+(n!==t?"\n"+t:"")+(e?"\n"+e:"")}function s(e){return 0===Object.keys(e).length?d:(c?l.log(c.inspect(e,!1,3,!0)):l.dir(e),d)}if("undefined"==typeof exports)var l=window.console;else{var c=require("util");l=console}var d=this,u={};"undefined"!=typeof Config&&Config.base&&Config.base.errorHandler&&Config.base.errorHandler.console&&(u=Config.base.errorHandler.console),void 0===u.log&&(u.log=2),void 0===u.warn&&(u.warn=4),void 0===u.error&&(u.error=8),void 0===e&&(e=u.log),void 0===t&&(t=u.warn),void 0===n&&(n=u.error);for(var h={callbacks:{}},p=e;t>p;p++)h.callbacks[p]=i;for(p=t;n>p;p++)h.callbacks[p]=o;for(p=n;11>p;p++)h.callbacks[p]=r;return Extend.Subscriber(d,h.callbacks),"undefined"==typeof l?errorHandler.msg("notice",new Error("errorConsoleView will not work, because here is no console")):void 0===l.log?errorHandler.msg("notice",new Error("errorConsoleView will not work, because here is no console.log")):(l.warn||(l.warn=l.log),l.dir||(l.dir=l.log),l.error||(l.error=l.log)),d},errorHandler.View=errorHandler.View||{},"undefined"!=typeof exports)var fs=require("fs");errorHandler.View.File=function(e,t){function n(e,t){return i(t.stack,t.message,t.name,t.timeStamp,a.logFile,t.levelNumber,t.context,t.additional),r}function i(e,t,n,i,a,l,c,d){return s?r:(fs.appendFile(a,o(e,t,n,i,l,c),function(o){o&&(s=!0,errorHandler.msg("notice",o,!1,{stack:e,message:t,name:n,timeStamp:i,rawLevel:l,context:c,additional:d}))}),r)}function o(e,t,n,i,o,r){var a={stack:e,message:t,name:n,timeStamp:i,rawLevel:o,context:r};try{return JSON.stringify(a)+"\n"}catch(s){a.context={renderError:s};try{return JSON.stringify(a)+"\n"}catch(s){return JSON.stringify("Cant Render error Line")+"\n"}}}var r=this,a={},s=!1;"undefined"!=typeof Config&&Config.base&&Config.base.errorHandler&&Config.base.errorHandler.file&&(a=Config.base.errorHandler.file),void 0===a.log&&(a.log=2),a.logFile=a.logFile||t||"log.log",void 0===e&&(e=a.log);for(var l={callbacks:{}},c=e;11>c;c++)l.callbacks[c]=n;return Extend.Subscriber(r,l.callbacks),r},errorHandler.View=errorHandler.View||{},errorHandler.View.Notification=function(e){function t(e,t){if(o>2)return n;o++;try{Object.extend(t.context,{url:window.location.href,userUuid:config.user().uuid,version:config.version(),userLevel:config.level().toString()}),a.emit("clientEvent",t)}catch(i){}return n}var n=this,i={},o=0;"undefined"!=typeof Config&&Config.base&&Config.base.errorHandler&&Config.base.errorHandler.notification&&(i=Config.base.errorHandler.notification),void 0===i.log&&(i.log=6),void 0===e&&(e=i.log);for(var r={callbacks:{}},a=Handler.socket.getSocket(Handler.socket.types.NOTIFICATION),s=e;11>s;s++)r.callbacks[s]=t;return Extend.Subscriber(n,r.callbacks),n},function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e("object"==typeof exports?require("jquery"):jQuery)}(function(e){function t(e){return s.raw?e:encodeURIComponent(e)}function n(e){return s.raw?e:decodeURIComponent(e)}function i(e){return t(s.json?JSON.stringify(e):String(e))}function o(e){0===e.indexOf('"')&&(e=e.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return e=decodeURIComponent(e.replace(a," ")),s.json?JSON.parse(e):e}catch(t){}}function r(t,n){var i=s.raw?t:o(t);return e.isFunction(n)?n(i):i}var a=/\+/g,s=e.cookie=function(o,a,l){if(void 0!==a&&!e.isFunction(a)){if(l=e.extend({},s.defaults,l),"number"==typeof l.expires){var c=l.expires,d=l.expires=new Date;d.setTime(+d+864e5*c)}return document.cookie=[t(o),"=",i(a),l.expires?"; expires="+l.expires.toUTCString():"",l.path?"; path="+l.path:"",l.domain?"; domain="+l.domain:"",l.secure?"; secure":""].join("")}for(var u=o?void 0:{},h=document.cookie?document.cookie.split("; "):[],p=0,f=h.length;f>p;p++){var g=h[p].split("="),m=n(g.shift()),v=g.join("=");if(o&&o===m){u=r(v,a);break}o||void 0===(v=r(v))||(u[m]=v)}return u};s.defaults={},e.removeCookie=function(t,n){return void 0===e.cookie(t)?!1:(e.cookie(t,"",e.extend({},n,{expires:-1})),!e.cookie(t))},e.staticTrackingCookie=function(t){var n="page_tracking",i=e.cookie(n);return i=i?JSON.parse(i):[],i.push({value:t,time:(new Date).toJSON()}),e.cookie(n,JSON.stringify(i),{expires:30,path:"/"})}}),function(e){function t(t){var n,i,o,r=arguments.length,a=window[t],s=arguments,l=s[1];if(2>r)throw new Error("Minimum 2 arguments must be given");if(e.isArray(l)){i={};for(var c in l){n=l[c];try{i[n]=JSON.parse(a.getItem(n))}catch(d){i[n]=a.getItem(n)}}return i}if(2!=r){try{i=JSON.parse(a.getItem(l))}catch(d){throw new ReferenceError(l+" is not defined in this storage")}for(var c=2;r-1>c;c++)if(i=i[s[c]],void 0===i)throw new ReferenceError([].slice.call(s,1,c+1).join(".")+" is not defined in this storage");if(e.isArray(s[c])){o=i,i={};for(var u in s[c])i[s[c][u]]=o[s[c][u]];return i}return i[s[c]]}try{return JSON.parse(a.getItem(l))}catch(d){return a.getItem(l)}}function n(t){var n,i,o=arguments.length,r=window[t],a=arguments,s=a[1],l=a[2],c={};if(2>o||!e.isPlainObject(s)&&3>o)throw new Error("Minimum 3 arguments must be given or second parameter must be an object");if(e.isPlainObject(s)){for(var d in s)n=s[d],e.isPlainObject(n)?r.setItem(d,JSON.stringify(n)):r.setItem(d,n);return s}if(3==o)return"object"==typeof l?r.setItem(s,JSON.stringify(l)):r.setItem(s,l),l;try{i=r.getItem(s),null!=i&&(c=JSON.parse(i))}catch(u){}i=c;for(var d=2;o-2>d;d++)n=a[d],i[n]&&e.isPlainObject(i[n])||(i[n]={}),i=i[n];return i[a[d]]=a[d+1],r.setItem(s,JSON.stringify(c)),c}function i(t){var n,i,o=arguments.length,r=window[t],a=arguments,s=a[1];if(2>o)throw new Error("Minimum 2 arguments must be given");if(e.isArray(s)){for(var l in s)r.removeItem(s[l]);return!0}if(2==o)return r.removeItem(s),!0;try{n=i=JSON.parse(r.getItem(s))}catch(c){throw new ReferenceError(s+" is not defined in this storage")}for(var l=2;o-1>l;l++)if(i=i[a[l]],void 0===i)throw new ReferenceError([].slice.call(a,1,l).join(".")+" is not defined in this storage");if(e.isArray(a[l]))for(var d in a[l])delete i[a[l][d]];else delete i[a[l]];return r.setItem(s,JSON.stringify(n)),!0}function o(t,n){var o=s(t);for(var r in o)i(t,o[r]);if(n)for(var r in e.namespaceStorages)l(r)}function r(n){var i=arguments.length,o=arguments,a=(window[n],o[1]);if(1==i)return 0==s(n).length;if(e.isArray(a)){for(var l=0;l<a.length;l++)if(!r(n,a[l]))return!1;return!0}try{var c=t.apply(this,arguments);e.isArray(o[i-1])||(c={totest:c});for(var l in c)if(!(e.isPlainObject(c[l])&&e.isEmptyObject(c[l])||e.isArray(c[l])&&!c[l].length)&&c[l])return!1;return!0}catch(d){return!0}}function a(n){var i=arguments.length,o=arguments,r=(window[n],
o[1]);if(2>i)throw new Error("Minimum 2 arguments must be given");if(e.isArray(r)){for(var s=0;s<r.length;s++)if(!a(n,r[s]))return!1;return!0}try{var l=t.apply(this,arguments);e.isArray(o[i-1])||(l={totest:l});for(var s in l)if(void 0===l[s]||null===l[s])return!1;return!0}catch(c){return!1}}function s(n){var i=arguments.length,o=window[n],r=arguments,a=(r[1],[]),s={};if(s=i>1?t.apply(this,r):o,s._cookie)for(var l in e.cookie())""!=l&&a.push(l.replace(s._prefix,""));else for(var c in s)a.push(c);return a}function l(t){if(!t||"string"!=typeof t)throw new Error("First parameter must be a string");h?(window.localStorage.getItem(t)||window.localStorage.setItem(t,"{}"),window.sessionStorage.getItem(t)||window.sessionStorage.setItem(t,"{}")):(window.localCookieStorage.getItem(t)||window.localCookieStorage.setItem(t,"{}"),window.sessionCookieStorage.getItem(t)||window.sessionCookieStorage.setItem(t,"{}"));var n={localStorage:e.extend({},e.localStorage,{_ns:t}),sessionStorage:e.extend({},e.sessionStorage,{_ns:t})};return e.cookie&&(window.cookieStorage.getItem(t)||window.cookieStorage.setItem(t,"{}"),n.cookieStorage=e.extend({},e.cookieStorage,{_ns:t})),e.namespaceStorages[t]=n,n}function c(e){if(!window[e])return!1;var t="jsapi";try{return window[e].setItem(t,t),window[e].removeItem(t),!0}catch(n){return!1}}var d="ls_",u="ss_",h=c("localStorage"),p={_type:"",_ns:"",_callMethod:function(e,t){var n=[this._type],t=Array.prototype.slice.call(t),i=t[0];return this._ns&&n.push(this._ns),"string"==typeof i&&-1!==i.indexOf(".")&&(t.shift(),[].unshift.apply(t,i.split("."))),[].push.apply(n,t),e.apply(this,n)},get:function(){return this._callMethod(t,arguments)},set:function(){var t=arguments.length,i=arguments,o=i[0];if(1>t||!e.isPlainObject(o)&&2>t)throw new Error("Minimum 2 arguments must be given or first parameter must be an object");if(e.isPlainObject(o)&&this._ns){for(var r in o)n(this._type,this._ns,r,o[r]);return o}var a=this._callMethod(n,i);return this._ns?a[o.split(".")[0]]:a},remove:function(){if(arguments.length<1)throw new Error("Minimum 1 argument must be given");return this._callMethod(i,arguments)},removeAll:function(e){return this._ns?(n(this._type,this._ns,{}),!0):o(this._type,e)},isEmpty:function(){return this._callMethod(r,arguments)},isSet:function(){if(arguments.length<1)throw new Error("Minimum 1 argument must be given");return this._callMethod(a,arguments)},keys:function(){return this._callMethod(s,arguments)}};if(e.cookie){window.name||(window.name=Math.floor(1e8*Math.random()));var f={_cookie:!0,_prefix:"",_expires:null,_path:null,_domain:null,setItem:function(t,n){e.cookie(this._prefix+t,n,{expires:this._expires,path:this._path,domain:this._domain})},getItem:function(t){return e.cookie(this._prefix+t)},removeItem:function(t){return e.removeCookie(this._prefix+t)},clear:function(){for(var t in e.cookie())""!=t&&(!this._prefix&&-1===t.indexOf(d)&&-1===t.indexOf(u)||this._prefix&&0===t.indexOf(this._prefix))&&e.removeCookie(t)},setExpires:function(e){return this._expires=e,this},setPath:function(e){return this._path=e,this},setDomain:function(e){return this._domain=e,this},setConf:function(e){return e.path&&(this._path=e.path),e.domain&&(this._domain=e.domain),e.expires&&(this._expires=e.expires),this},setDefaultConf:function(){this._path=this._domain=this._expires=null}};h||(window.localCookieStorage=e.extend({},f,{_prefix:d,_expires:3650}),window.sessionCookieStorage=e.extend({},f,{_prefix:u+window.name+"_"})),window.cookieStorage=e.extend({},f),e.cookieStorage=e.extend({},p,{_type:"cookieStorage",setExpires:function(e){return window.cookieStorage.setExpires(e),this},setPath:function(e){return window.cookieStorage.setPath(e),this},setDomain:function(e){return window.cookieStorage.setDomain(e),this},setConf:function(e){return window.cookieStorage.setConf(e),this},setDefaultConf:function(){return window.cookieStorage.setDefaultConf(),this}})}e.initNamespaceStorage=function(e){return l(e)},h?(e.localStorage=e.extend({},p,{_type:"localStorage"}),e.sessionStorage=e.extend({},p,{_type:"sessionStorage"})):(e.localStorage=e.extend({},p,{_type:"localCookieStorage"}),e.sessionStorage=e.extend({},p,{_type:"sessionCookieStorage"})),e.namespaceStorages={},e.removeAllStorages=function(t){e.localStorage.removeAll(t),e.sessionStorage.removeAll(t),e.cookieStorage&&e.cookieStorage.removeAll(t),t||(e.namespaceStorages={})}}(jQuery),function(e){var t=function(e){var t,n=[];return e.length?"span"===e[0].tagName.toLowerCase()?(e.find(":checked").each(function(){n.push(this.value)}),n.join(",")):(t=e.attr("type"),"checkbox"===t||"radio"===t?e.filter(":checked").val():e.val()):void 0};e.fn.yiiactiveform=function(n){return this.each(function(){var i=e.extend({},e.fn.yiiactiveform.defaults,n||{}),o=e(this);void 0===i.validationUrl&&(i.validationUrl=o.attr("action")),e.each(i.attributes,function(n){this.value=t(o.find("#"+this.inputID)),i.attributes[n]=e.extend({},{validationDelay:i.validationDelay,validateOnChange:i.validateOnChange,validateOnType:i.validateOnType,hideErrorMessage:i.hideErrorMessage,inputContainer:i.inputContainer,errorCssClass:i.errorCssClass,successCssClass:i.successCssClass,beforeValidateAttribute:i.beforeValidateAttribute,afterValidateAttribute:i.afterValidateAttribute,validatingCssClass:i.validatingCssClass,errorCallback:i.errorCallback},this)}),o.data("settings",i),i.submitting=!1;var r=function(n,r){r&&(n.status=2),e.each(i.attributes,function(){this.value!==t(o.find("#"+this.inputID))&&(this.status=2,r=!0)}),r&&(void 0!==i.timer&&clearTimeout(i.timer),i.timer=setTimeout(function(){i.submitting||o.is(":hidden")||(void 0===n.beforeValidateAttribute||n.beforeValidateAttribute(o,n))&&(e.each(i.attributes,function(){2===this.status&&(this.status=3,e.fn.yiiactiveform.getInputContainer(this,o).addClass(this.validatingCssClass))}),e.fn.yiiactiveform.validate(o,function(t){var r=!1;e.each(i.attributes,function(){(2===this.status||3===this.status)&&(r=e.fn.yiiactiveform.updateInput(this,t,o)||r)}),void 0!==n.afterValidateAttribute&&n.afterValidateAttribute(o,n,t,r)},i.errorCallback))},n.validationDelay))};if(e.each(i.attributes,function(n,i){this.validateOnChange&&o.find("#"+this.inputID).change(function(){r(i,!1)}).blur(function(){2!==i.status&&3!==i.status&&r(i,!i.status)}),this.validateOnType&&o.find("#"+this.inputID).keyup(function(){i.value!==t(e(this))&&r(i,!1)})}),i.validateOnSubmit){o.on("mouseup keyup",":submit",function(){o.data("submitObject",e(this))});var a=!1;o.submit(function(){return a?(a=!1,!0):(void 0!==i.timer&&clearTimeout(i.timer),i.submitting=!0,void 0===i.beforeValidate||i.beforeValidate(o)?e.fn.yiiactiveform.validate(o,function(t){var n=!1;if(e.each(i.attributes,function(){n=e.fn.yiiactiveform.updateInput(this,t,o)||n}),e.fn.yiiactiveform.updateSummary(o,t),(void 0===i.afterValidate||i.afterValidate(o,t,n))&&!n){a=!0;var r=o.data("submitObject")||o.find(":submit:first");return void(r.length?r.click():o.submit())}i.submitting=!1},i.errorCallback):i.submitting=!1,!1)})}o.bind("reset",function(){setTimeout(function(){e.each(i.attributes,function(){this.status=0;var n=o.find("#"+this.errorID),i=e.fn.yiiactiveform.getInputContainer(this,o);i.removeClass(this.validatingCssClass+" "+this.errorCssClass+" "+this.successCssClass),n.html("").hide(),this.value=t(o.find("#"+this.inputID))}),o.find("label, :input").each(function(){e(this).removeClass(i.errorCss)}),e("#"+i.summaryID).hide().find("ul").html(""),void 0===i.focus||window.location.hash||o.find(i.focus).focus()},1)}),void 0===i.focus||window.location.hash||o.find(i.focus).focus()})},e.fn.yiiactiveform.getInputContainer=function(e,t){return void 0===e.inputContainer?t.find("#"+e.inputID).closest("div"):t.find(e.inputContainer).filter(':has("#'+e.inputID+'")')},e.fn.yiiactiveform.updateInput=function(n,i,o){n.status=1;var r,a,s=!1,l=o.find("#"+n.inputID),c=o.data("settings").errorCss;return l.length&&(s=null!==i&&e.isArray(i[n.id])&&i[n.id].length>0,r=o.find("#"+n.errorID),a=e.fn.yiiactiveform.getInputContainer(n,o),a.removeClass(n.validatingCssClass+" "+n.errorCssClass+" "+n.successCssClass),a.find("label, :input").each(function(){e(this).removeClass(c)}),s?(r.html(i[n.id][0]),a.addClass(n.errorCssClass)):(n.enableAjaxValidation||n.clientValidation)&&a.addClass(n.successCssClass),n.hideErrorMessage||r.toggle(s),n.value=t(l)),s},e.fn.yiiactiveform.updateSummary=function(t,n){var i=e(t).data("settings"),o="";if(void 0!==i.summaryID){if(n){var r=[];for(var a in i.attributes)i.attributes[a].summary&&r.push(i.attributes[a].id);e.each(i.attributes,function(){-1!==e.inArray(this.id,r)&&e.isArray(n[this.id])&&e.each(n[this.id],function(e,t){o=o+"<li>"+t+"</li>"})})}e("#"+i.summaryID).toggle(""!==o).find("ul").html(o)}},e.fn.yiiactiveform.validate=function(n,i,o){var r=e(n),a=r.data("settings"),s=!1,l={};if(e.each(a.attributes,function(){var e,n=[];void 0===this.clientValidation||!a.submitting&&2!==this.status&&3!==this.status||(e=t(r.find("#"+this.inputID)),this.clientValidation(e,n,this),n.length&&(l[this.id]=n)),!this.enableAjaxValidation||n.length||!a.submitting&&2!==this.status&&3!==this.status||(s=!0)}),!s||a.submitting&&!e.isEmptyObject(l))return void(a.submitting?setTimeout(function(){i(l)},200):i(l));var c=r.data("submitObject"),d="&"+a.ajaxVar+"="+r.attr("id");c&&c.length&&(d+="&"+c.attr("name")+"="+c.attr("value")),e.ajax({url:a.validationUrl,type:r.attr("method"),data:r.serialize()+d,dataType:"json",success:function(t){null!==t&&"object"==typeof t?(e.each(a.attributes,function(){this.enableAjaxValidation||delete t[this.id]}),i(e.extend({},l,t))):i(l)},error:function(){void 0!==o&&o()}})},e.fn.yiiactiveform.getSettings=function(t){return e(t).data("settings")},e.fn.yiiactiveform.defaults={ajaxVar:"ajax",validationUrl:void 0,validationDelay:200,validateOnSubmit:!1,validateOnChange:!0,validateOnType:!1,hideErrorMessage:!1,inputContainer:void 0,errorCss:"error",errorCssClass:"error",successCssClass:"success",validatingCssClass:"validating",summaryID:void 0,timer:void 0,beforeValidateAttribute:void 0,afterValidateAttribute:void 0,beforeValidate:void 0,afterValidate:void 0,focus:void 0,attributes:[],errorCallback:void 0}}(jQuery),window.settings=function(){function e(){if(config.level().isGuest&&!config.consent().hasSettingsConsent&&!$embedCCT)return v=window.defaultSettings,void setTimeout(function(){T.emit("loaded")},200);var e=t()||{};Object.keys(e).length?(v=e,setTimeout(function(){T.emit("loaded")},500)):o(function(t){v=Object.merge(v,t,e),n(v)})}function t(){return JSON.parse(C.getItem(k))}function n(e){return C.setItem(k,JSON.stringify(e))}function i(){n({})}function o(e){F||(F=!0,jQuery.ajax({url:"/api/web/SettingAPI/getSettings?uuid="+config.user().uuid,dataType:"json",type:"GET"}).done(function(t){F=!1,setTimeout(function(){T.emit("loaded")},500),e(t.data.settings)}).fail(function(){F=!1,e({})}))}function r(e,i){if(config.level().isGuest&&!config.consent().hasSettingsConsent&&!$embedCCT)return void jQuery(document).trigger("missingSettingsConsent",[e,i]);if(Object.forEach(e,function(t,n){("game-piece-theme"===n||"game-board-theme"===n)&&(config.themes()[t]||delete e[n])}),0!==Object.keys(e).length){if(n(Object.merge(v,t(),e)),config.level().isGuest)return void i(!0);var o={csrf:config.csrf()};for(var r in e)e.hasOwnProperty(r)&&(o["settings["+r+"]"]=e[r]);jQuery.ajax({url:y,dataType:"json",data:o,type:w}).done(function(e){"function"==typeof i&&i(!0,e.data.report),T.emit("success.save",e.success)}).fail(function(t){var n={};try{var o=jQuery.parseJSON(t.responseText);errorHandler.msg("warning",new Error("Error saving a setting"),!1,{url:y,setting:e,errors:o.errors}),n=o.errors}catch(r){errorHandler.msg("warning",new Error("Error saving a setting"),!1,{url:y,setting:e})}T.emit("error.save",n),"function"==typeof i&&i(!1,n)})}}function a(e){var t=e.data("linked-settings"),n={};return t&&(t=t.split(","),t.forEach(function(e){var t=jQuery('[data-setting="'+e+'"]');if(t.length){if(t.is(":radio")){t=t.filter(":checked");var i=t.val()}else i=t.is(":checkbox")?t.is(":checked")?1:0:t.val();n[e]=i}})),n}function s(e,t){var n=("0"===t?1:!t)?"off":"on";T.emit("settings."+e+"."+n,{name:e,value:t})}function l(t){return void 0!==x[t]?x[t]:(void 0===v[t]&&e(),v[t])}function c(e,t,n){if(!e)return T;if(e instanceof Object)var i=e;else i={},i[e]=t;i=Object.filter(i,function(e,t){return!h(t)});var o=!!n;return Object.forEach(i,function(e,t){o=o||T.get(t)!=e}),o?(r(i,function(e,t){if(e)for(var n in i){var o=n,r=i[n];if(t&&!!t[n]==!1)return;v[o]=r,s(o,r),jQuery('[data-setting="'+o+'"]').each(function(){var e=jQuery(this);e.is(":checkbox")?this.checked=!!r:e.is(":radio")?this.checked=this.value==r:e.is("select")?e.find('option[value="'+r+'"]').attr("selected","selected"):e.val(r)})}}),T):T}function d(e,t){return x[e]=t,s(e,t),T}function u(e){delete x[e];var t=T.get(e);return s(e,t),T}function h(e){return Object.has(x,e)}function p(e,t){t=!!t;var n=jQuery(e);return n.each(function(){var e=jQuery(this),n=t?{}:void 0,i=e.find("input,select,textarea").add(e.filter("input,select,textarea"));i.each(function(){var o=jQuery(this),s=o.data("setting");if((o.is("input[type=text]")||o.is("select"))&&o.attr("name",s).addClass("validatable[safe]").validatable(),s){var l=T.get(s);o.is(":checkbox")?o.get(0).checked=1==l:o.is(":radio")?o.get(0).checked=l==o.val():o.is("select")?o.find('option[value="'+l+'"]').attr("selected","selected"):o.val(l);var c=h(s);c&&o.prop("disabled",c);var d=t?e.find("[data-settings-save]").addClass("cBtnInactive"):void 0;o.on("change",function(){setTimeout(function(){var e=o.val();if(o.is(":checkbox"))e=o.is(":checked")?1:0;else if(o.is(":radio")&&!o.is(":checked"))return;if(t)n[s]=e,Object.extend(n,a(o)),d.removeClass("cBtnInactive").off("click").on("click",function(){d.addClass("cBtnIcon cIconFileUploading"),r(n,function(t,o){if(d.removeClass("cBtnIcon cIconFileUploading"),t){for(var r in n)if(n.hasOwnProperty(r)){v[r]=n[r],T.emit("change."+r,{name:r,value:n[r]});var a=0===parseInt(e,10)?"off":"on";T.emit("settings."+s+"."+a,{value:n[r]})}d.addClass("cBtnInactive").off("click"),n={}}else{var l;for(var c in o)if(o.hasOwnProperty(c)){l=c;break}i.filter('[data-setting="'+l+'"]').trigger("validatable:error",{name:l,errors:o[l]})}})});else{var l=a(o)||{};l[s]=e,T.set(l)}})})}})}),T}function f(e){return parseFloat(T.get(e),10)}function g(e){var t=T.get(e);return"0"===t?!1:!!t}function m(e){return""+T.get(e)}var v={},y="/api/web/SettingAPI/setSettings",w="POST",b=config.user(),C=window.localStorage,k="localSettings";config.level().isGuest||(k+="_"+b.uuid);var F=!1,x={},T={get:l,set:c,setOverride:d,removeOverride:u,attach:p,getNumber:f,getBoolean:g,getString:m,clearLocalStorage:i,save:r};return T=Extend.Publisher(T),e(),T}(),!function(e){function t(t,n,i){i=i||"transparent";var o="obj"+(""+Math.random()).slice(2,15),r='<object class="fp-engine" id="'+o+'" name="'+o+'" ';r+=e.browser.msie?'classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000">':' data="'+t+'" type="application/x-shockwave-flash">';var a={width:"100%",height:"100%",allowscriptaccess:"always",wmode:i,quality:"high",flashvars:"",movie:t+(e.browser.msie?"?"+o:""),name:o};return e.each(n,function(e,t){a.flashvars+=e+"="+t+"&"}),e.each(a,function(e,t){r+='<param name="'+e+'" value="'+t+'"/>'}),r+="</object>",e(r)}function n(e,t){return t=t||100,Math.round(e*t)/t}function i(e){return/mpegurl/i.test(e)?"application/x-mpegurl":"video/"+e}function o(e){return/^(video|application)/i.test(e)||(e=i(e)),!!w.canPlayType(e).replace("no","")}function r(t,n){var i=e.grep(t,function(e){return e.type===n});return i.length?i[0]:null}function a(e){var t=e.attr("src"),n=e.attr("type")||"",i=t.split(k)[1];return n=/mpegurl/i.test(n)?"mpegurl":n.replace("video/",""),{src:t,suffix:i||n,type:n||i}}function s(t){var n=this,i=[];e("source",t).each(function(){i.push(a(e(this)))}),i.length||i.push(a(t)),n.initialSources=i,n.resolve=function(t){return t?(e.isArray(t)?t={sources:e.map(t,function(t){var n,i=e.extend({},t);return e.each(t,function(e,t){n=e}),i.type=n,i.src=t[n],delete i[n],i})}:"string"==typeof t&&(t={src:t,sources:[]},e.each(i,function(e,n){"flash"!=n.type&&t.sources.push({type:n.type,src:t.src.replace(k,"."+n.suffix+"$2")})})),t):{sources:i}}}function l(e){return e=parseInt(e,10),e>=10?e:"0"+e}function c(e){e=e||0;var t=Math.floor(e/3600),n=Math.floor(e/60);return e-=60*n,t>=1?(n-=60*t,t+":"+l(n)+":"+l(e)):l(n)+":"+l(e)}!function(e){if(!e.browser){var t=e.browser={},n=navigator.userAgent.toLowerCase(),i=/(chrome)[ \/]([\w.]+)/.exec(n)||/(safari)[ \/]([\w.]+)/.exec(n)||/(webkit)[ \/]([\w.]+)/.exec(n)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(n)||/(msie) ([\w.]+)/.exec(n)||n.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(n)||[];i[1]&&(t[i[1]]=!0,t.version=i[2]||"0")}}(jQuery),e(function(){"function"==typeof e.fn.flowplayer&&e("video").parent(".flowplayer").flowplayer()});var d=[],u=[],h=window.navigator.userAgent;window.flowplayer=function(t){return e.isFunction(t)?u.push(t):"number"==typeof t||void 0===t?d[t||0]:e(t).data("flowplayer")},e(window).on("beforeunload",function(){e.each(d,function(t,n){n.conf.splash?n.unload():n.bind("error",function(){e(".flowplayer.is-error .fp-message").remove()})})});var p=!1;if(config.consent().hasSettingsConsent)try{"object"==typeof window.localStorage&&(window.localStorage.flowplayerTestStorage="test",p=!0)}catch(f){}var g=/Safari/.exec(navigator.userAgent)&&!/Chrome/.exec(navigator.userAgent);m=/(\d+\.\d+) Safari/.exec(navigator.userAgent),safariVersion=m?Number(m[1]):100,e.extend(flowplayer,{version:"5.5.2",engine:{},conf:{},support:{},defaults:{debug:!1,disabled:!1,engine:"html5",fullscreen:window==window.top,keyboard:!0,ratio:9/16,adaptiveRatio:!1,flashfit:!1,rtmp:0,splash:!1,live:!1,swf:"//releases.flowplayer.org/5.5.2/commercial/flowplayer.swf",speeds:[.25,.5,1,1.5,2],tooltip:!0,volume:p?"true"==localStorage.muted?0:isNaN(localStorage.volume)?1:localStorage.volume||1:1,errors:["","Video loading aborted","Network error","Video not properly encoded","Video file not found","Unsupported video","Skin not found","SWF file not found","Subtitles not found","Invalid RTMP URL","Unsupported video format. Try installing Adobe Flash."],errorUrls:["","","","","","","","","","","http://get.adobe.com/flashplayer/"],playlist:[],hlsFix:g&&safariVersion<8}});var v=1;e.fn.flowplayer=function(t,n){return"string"==typeof t&&(t={swf:t}),e.isFunction(t)&&(n=t,t={}),!t&&this.data("flowplayer")||this.each(function(){var i,o,r=e(this).addClass("is-loading"),a=e.extend({},flowplayer.defaults,flowplayer.conf,t,r.data()),l=e("video",r).addClass("fp-engine").removeAttr("controls"),c=l.length?new s(l):null,h={};if(a.playlist.length){var f,g=a.preload||l.attr("preload");l.length&&l.replaceWith(f=e("<p />")),l=e("<video />").addClass("fp-engine"),f?f.replaceWith(l):r.prepend(l),flowplayer.support.video&&l.attr("preload",g),"string"==typeof a.playlist[0]?l.attr("src",a.playlist[0]):e.each(a.playlist[0],function(t,n){for(var i in n)n.hasOwnProperty(i)&&l.append(e("<source />").attr({type:"video/"+i,src:n[i]}))}),c=new s(l)}var m=r.data("flowplayer");m&&m.unload(),r.data("fp-player_id",r.data("fp-player_id")||v++);try{h=p?window.localStorage:h}catch(y){}var w=this.currentStyle&&"rtl"===this.currentStyle.direction||window.getComputedStyle&&"rtl"===window.getComputedStyle(this,null).getPropertyValue("direction");w&&r.addClass("is-rtl");var b=m||{conf:a,currentSpeed:1,volumeLevel:"undefined"==typeof a.volume?1*h.volume:a.volume,video:{},disabled:!1,finished:!1,loading:!1,muted:"true"==h.muted||a.muted,paused:!1,playing:!1,ready:!1,splash:!1,rtl:w,load:function(t,n){if(!(b.error||b.loading||b.disabled)){if(t=c.resolve(t),e.extend(t,o.pick(t.sources)),t.src){var i=e.Event("load");r.trigger(i,[b,t,o]),i.isDefaultPrevented()?b.loading=!1:(o.load(t),e.isFunction(t)&&(n=t),n&&r.one("ready",n))}return b}},pause:function(e){return!b.ready||b.seeking||b.disabled||b.loading||(o.pause(),b.one("pause",e)),b},resume:function(){return b.ready&&b.paused&&!b.disabled&&(o.resume(),b.finished&&(b.trigger("resume",[b]),b.finished=!1)),b},toggle:function(){return b.ready?b.paused?b.resume():b.pause():b.load()},seek:function(t,n){if(b.ready&&!b.live){if("boolean"==typeof t){var a=.1*b.video.duration;t=b.video.time+(t?a:-a)}t=i=Math.min(Math.max(t,0),b.video.duration).toFixed(1);var s=e.Event("beforeseek");r.trigger(s,[b,t]),s.isDefaultPrevented()?(b.seeking=!1,r.toggleClass("is-seeking",b.seeking)):(o.seek(t),e.isFunction(n)&&r.one("seek",n))}return b},seekTo:function(e,t){var n=void 0===e?i:.1*b.video.duration*e;return b.seek(n,t)},mute:function(e){return void 0===e&&(e=!b.muted),h.muted=b.muted=e,h.volume=isNaN(h.volume)?a.volume:h.volume,b.volume(e?0:h.volume,!0),b.trigger("mute",e),b},volume:function(e,t){return b.ready&&(e=Math.min(Math.max(e,0),1),t||(h.volume=e),o.volume(e)),b},speed:function(t,n){return b.ready&&("boolean"==typeof t&&(t=a.speeds[e.inArray(b.currentSpeed,a.speeds)+(t?1:-1)]||b.currentSpeed),o.speed(t),n&&r.one("speed",n)),b},stop:function(){return b.ready&&(b.pause(),b.seek(0,function(){r.trigger("stop")})),b},unload:function(){return r.hasClass("is-embedding")||(a.splash?(b.trigger("unload"),o.unload()):b.stop()),b},disable:function(e){return void 0===e&&(e=!b.disabled),e!=b.disabled&&(b.disabled=e,b.trigger("disable",e)),b}};b.conf=e.extend(b.conf,a),e.each(["bind","one","unbind"],function(e,t){b[t]=function(e,n){return r[t](e,n),b}}),b.trigger=function(e,t){return r.trigger(e,[b,t]),b},r.data("flowplayer")||r.bind("boot",function(){return e.each(["autoplay","loop","preload","poster"],function(e,t){var n=l.attr(t);void 0!==n&&(a[t]=n?n:!0)}),(a.splash||r.hasClass("is-splash")||!flowplayer.support.firstframe)&&(b.forcedSplash=!a.splash&&!r.hasClass("is-splash"),b.splash=a.splash=a.autoplay=!0,r.addClass("is-splash"),flowplayer.support.video&&l.attr("preload","none")),(a.live||r.hasClass("is-live"))&&(b.live=a.live=!0,r.addClass("is-live")),e.each(u,function(e){this(b,r)}),o=flowplayer.engine[a.engine],o&&(o=o(b,r)),o.pick(c.initialSources)?b.engine=a.engine:e.each(flowplayer.engine,function(e,t){return e!=a.engine&&(o=this(b,r),o.pick(c.initialSources))?(b.engine=e,!1):void 0}),d.push(b),b.engine?(a.splash?b.unload():b.load(),a.disabled&&b.disable(),o.volume(b.volumeLevel),void r.one("ready",n)):b.trigger("error",{code:flowplayer.support.flashVideo?5:10})}).bind("load",function(t,n,i){a.splash&&e(".flowplayer").filter(".is-ready, .is-loading").not(r).each(function(){var t=e(this).data("flowplayer");t.conf.splash&&t.unload()}),r.addClass("is-loading"),n.loading=!0}).bind("ready",function(e,t,n){function i(){r.removeClass("is-loading"),t.loading=!1}n.time=0,t.video=n,a.splash?r.one("progress",i):i(),t.muted?t.mute(!0):t.volume(t.volumeLevel);var o=t.conf.hlsFix&&/mpegurl/i.exec(n.type);r.toggleClass("hls-fix",!!o)}).bind("unload",function(e){a.splash&&l.remove(),r.removeClass("is-loading"),b.loading=!1}).bind("ready unload",function(e){var t="ready"==e.type;r.toggleClass("is-splash",!t).toggleClass("is-ready",t),b.ready=t,b.splash=!t}).bind("progress",function(e,t,n){t.video.time=n}).bind("speed",function(e,t,n){t.currentSpeed=n}).bind("volume",function(e,t,n){t.volumeLevel=Math.round(100*n)/100,t.muted?n&&t.mute(!1):h.volume=n}).bind("beforeseek seek",function(e){b.seeking="beforeseek"==e.type,r.toggleClass("is-seeking",b.seeking)}).bind("ready pause resume unload finish stop",function(e,t,n){b.paused=/pause|finish|unload|stop/.test(e.type),"ready"==e.type&&(b.paused="none"==a.preload,n&&(b.paused=!n.duration||!a.autoplay&&"none"!=a.preload)),b.playing=!b.paused,r.toggleClass("is-paused",b.paused).toggleClass("is-playing",b.playing),b.load.ed||b.pause()}).bind("finish",function(e){b.finished=!0}).bind("error",function(){l.remove()}),r.trigger("boot",[b,r]).data("flowplayer",b)})},!function(){var t=function(e){var t=/Version\/(\d\.\d)/.exec(e);return t&&t.length>1?parseFloat(t[1],10):0},n=flowplayer.support,i=e.browser,o=e("<video loop autoplay preload/>")[0],r=navigator.userAgent,a=i.msie||/Trident\/7/.test(r),s=/iPad|MeeGo/.test(r)&&!/CriOS/.test(r),l=/iPad/.test(r)&&/CriOS/.test(r),c=/iP(hone|od)/i.test(r)&&!/iPad/.test(r),d=/Android/.test(r)&&!/Firefox/.test(r),u=/Android/.test(r)&&/Firefox/.test(r),h=/Silk/.test(r),p=/IEMobile/.test(r),f=p?parseFloat(/Windows\ Phone\ (\d+\.\d+)/.exec(r)[1],10):0,g=p?parseFloat(/IEMobile\/(\d+\.\d+)/.exec(r)[1],10):0,m=(s?t(r):0,d?parseFloat(/Android\ (\d+(\.\d+)?)/.exec(r)[1],10):0);e.extend(n,{subtitles:!!o.addTextTrack,fullscreen:"function"==typeof document.webkitCancelFullScreen&&!/Mac OS X 10_5.+Version\/5\.0\.\d Safari/.test(r)||document.mozFullScreenEnabled||"function"==typeof document.exitFullscreen||"function"==typeof document.msExitFullscreen,inlineBlock:!(a&&i.version<8),touch:"ontouchstart"in window,dataload:!s&&!c&&!p,zeropreload:!a&&!d,volume:!(s||d||c||h||l),cachedVideoTag:!(s||c||l||p),firstframe:!(c||s||d||h||l||p||u),inlineVideo:!c&&(!p||f>=8.1&&g>=11)&&(!d||m>=3),hlsDuration:!d&&(!i.safari||s||c||l),seekable:!s&&!l});try{var v=navigator.plugins["Shockwave Flash"],y=a?new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version"):v.description;a||v[0].enabledPlugin?(y=y.split(/\D+/),y.length&&!y[0]&&(y=y.slice(1)),n.flashVideo=y[0]>9||9==y[0]&&y[3]>=115):n.flashVideo=!1}catch(w){}try{n.video=!!o.canPlayType,n.video&&o.canPlayType("video/mp4")}catch(b){n.video=!1}n.animation=function(){for(var t=["","Webkit","Moz","O","ms","Khtml"],n=e("<p/>")[0],i=0;i<t.length;i++)if("undefined"!==n.style[t[i]+"AnimationName"])return!0}()}(),window.attachEvent&&window.attachEvent("onbeforeunload",function(){__flash_savedUnloadHandler=__flash_unloadHandler=function(){}}),flowplayer.engine.flash=function(n,i){var o,r,a,s=n.conf,l=(n.video,e(window)),c=function(){if("webkit"==E||O){var t=e("object param[name='flashvars']",i),o=(t.attr("value")||"").split("&");e.each(o,function(e,i){return i=i.split("="),"url"==i[0]&&i[1]!=n.video.url?(o[e]="url="+n.video.url,t.attr({value:o.join("&")}),!1):void 0})}},d=function(t){var o=i.height(),r=i.width();if(n.conf.flashfit||/full/.test(t.type)){var a,s,c=n.isFullscreen,d=c&&I,u=!flowplayer.support.inlineBlock,h=c?d?screen.width:l.width():r,p=c?d?screen.height:l.height():o,f=0,g=0,m=u?r:"",v=u?o:"";(n.conf.flashfit||"fullscreen"===t.type)&&(a=n.video.width/n.video.height,s=n.video.height/n.video.width,v=Math.max(s*h),m=Math.max(a*p),v=v>p?m*s:v,v=Math.min(Math.round(v),p),m=m>h?v*a:m,m=Math.min(Math.round(m),h),g=Math.max(Math.round((p+g-v)/2),0),f=Math.max(Math.round((h+f-m)/2),0)),e("object",i).css({width:m,height:v,marginTop:g,marginLeft:f})}},u={pick:function(t){if(flowplayer.support.flashVideo){var n=e.grep(t,function(e){return"flash"==e.type})[0];if(n)return n;for(var i,o=0;o<t.length;o++)if(i=t[o],/mp4|flv/i.test(i.type))return i}},load:function(l){function u(e){return e.replace(/&amp;/g,"%26").replace(/&/g,"%26").replace(/=/g,"%3D")}var h=e("video",i),p=u(l.src);is_absolute=/^https?:/.test(p);var f=function(){h.remove()},g=function(t){return e.grep(t,function(e){return!!h[0].canPlayType("video/"+e.type)}).length>0};if(flowplayer.support.video&&h.prop("autoplay")&&g(l.sources)?h.one("timeupdate",f):f(),is_absolute||s.rtmp||(p=e("<img/>").attr("src",p)[0].src),a)a.__play(p);else{n.bind("ready",c).bind("ready fullscreen fullscreen-exit",d),o="fp"+(""+Math.random()).slice(3,15);var m={hostname:s.embedded?s.hostname:location.hostname,url:p,callback:"jQuery."+o};i.data("origin")&&(m.origin=i.data("origin")),is_absolute&&delete s.rtmp,e.each(["key","autoplay","preload","rtmp","subscribe","live","loop","debug","splash","poster","rtmpt"],function(e,t){s.hasOwnProperty(t)&&(m[t]=s[t])}),void 0!==s.bufferTime&&(m.bufferTime=s.bufferTime),m.rtmp&&(m.rtmp=u(m.rtmp)),m.initialVolume=n.volumeLevel,r=t(s.swf,m,s.wmode),r.prependTo(i),a=r[0],setTimeout(function(){try{if(!a.PercentLoaded())return i.trigger("error",[n,{code:7,url:s.swf}])}catch(e){}},5e3),setTimeout(function(){"undefined"==typeof a.PercentLoaded&&i.trigger("flashdisabled",[n])},1e3),a.pollInterval=setInterval(function(){if(a){var e=a.__status?a.__status():null;e&&(n.trigger("progress",e.time),l.buffer=e.buffer/l.bytes*l.duration,n.trigger("buffer",l.buffer),!l.buffered&&e.time>0&&(l.buffered=!0,n.trigger("buffered")))}},250),e[o]=function(t,i){s.debug&&console.log("--",t,i);var o=e.Event(t);switch(t){case"ready":i=e.extend(l,i);break;case"click":o.flash=!0;break;case"keydown":o.which=i;break;case"seek":l.time=i}"buffered"!=t&&setTimeout(function(){n.trigger(o,i)},1)}}},speed:e.noop,unload:function(){a&&a.__unload&&a.__unload(),delete e[o],e("object",i).remove(),a=0,n.unbind("ready",c).unbind("ready fullscreen fullscreen-exit",d),clearInterval(a.pollInterval)}};return e.each("pause,resume,seek,volume".split(","),function(e,t){u[t]=function(e){try{n.ready&&("seek"==t&&n.video.time&&!n.paused&&n.trigger("beforeseek"),void 0===e?a["__"+t]():a["__"+t](e))}catch(o){if("undefined"==typeof a["__"+t])return i.trigger("flashdisabled",[n]);throw o}}}),u};var y,w=e("<video/>")[0],b={ended:"finish",pause:"pause",play:"resume",progress:"buffer",timeupdate:"progress",volumechange:"volume",ratechange:"speed",seeked:"seek",loadeddata:"ready",canplaythrough:"init",error:"error",dataunavailable:"error"},C=function(t){return y?y.attr({type:i(t.type),src:t.src}):y=e("<video/>",{src:t.src,type:i(t.type),"class":"fp-engine",autoplay:"autoplay",preload:"none","x-webkit-airplay":"allow"})};flowplayer.engine.html5=function(t,i){function a(r,a,s){r.listeners&&r.listeners.hasOwnProperty(i.data("fp-player_id"))||((r.listeners||(r.listeners={}))[i.data("fp-player_id")]=!0,a.bind("error",function(n){try{if(n.originalEvent&&e(n.originalEvent.originalTarget).is("img"))return n.preventDefault();o(e(n.target).attr("type"))&&t.trigger("error",{code:4})}catch(i){}}),e.each(b,function(o,a){r.addEventListener(o,function(c){if("progress"==a&&c.srcElement&&0===c.srcElement.readyState&&setTimeout(function(){t.video.duration||t.conf.live&&("mpegurl"!==t.video.type||!h.hlsDuration)||(a="error",t.trigger(a,{code:4}))},1e4),p.debug&&!/progress/.test(a)&&console.log(o,"->",a,c),(t.ready||/ready|error/.test(a))&&a&&e("video",i).length){var d,u=e.Event(a);switch(a){case"ready":d=e.extend(s,{duration:r.duration,width:r.videoWidth,height:r.videoHeight,url:r.currentSrc,src:r.currentSrc});try{d.seekable=!p.live&&/mpegurl/i.test(s?s.type||"":"")&&r.duration||r.seekable&&r.seekable.end(null)}catch(f){}if(l=l||setInterval(function(){try{d.buffer=r.buffered.end(null)}catch(e){}d.buffer&&(n(d.buffer,1e3)<n(d.duration,1e3)&&!d.buffered?t.trigger("buffer",c):d.buffered||(d.buffered=!0,t.trigger("buffer",c).trigger("buffered",c),clearInterval(l),l=0))},250),!p.live&&!d.duration&&!h.hlsDuration&&"loadeddata"===o){var g=function(){d.duration=r.duration;try{d.seekable=r.seekable&&r.seekable.end(null)}catch(e){}t.trigger(u,d),r.removeEventListener("durationchange",g)};return void r.addEventListener("durationchange",g)}break;case"progress":case"seek":t.video.duration;if(r.currentTime>0||t.live){d=Math.max(r.currentTime,0);break}if("progress"==a)return;case"speed":d=n(r.playbackRate);break;case"volume":d=n(r.volume);break;case"error":try{d=(c.srcElement||c.originalTarget).error}catch(m){return}}t.trigger(u,d)}},!1)}))}var s,l,c,d,u=e("video",i),h=flowplayer.support,p=(e("track",u),t.conf);return s={pick:function(e){if(h.video){if(p.videoTypePreference){var t=r(e,p.videoTypePreference);if(t)return t}for(var n=0;n<e.length;n++)if(o(e[n].type))return e[n]}},load:function(n){if(p.splash&&!c)u=C(n).prependTo(i),h.inlineVideo||u.css({position:"absolute",top:"-9999em"}),p.loop&&u.attr("loop","loop"),c=u[0],"undefined"!=typeof d&&(c.volume=d);else{c=u[0];var o=u.find("source");!c.src&&o.length&&(c.src=n.src,o.remove()),t.video.src&&n.src!=t.video.src?(u.attr("autoplay","autoplay"),c.src=n.src):"none"!=p.preload&&h.dataload||(h.zeropreload?t.trigger("ready",n).trigger("pause").one("ready",function(){
i.trigger("resume",[t])}):t.one("ready",function(){i.trigger("pause",[t])}))}a(c,e("source",u).add(u),n),("none"!=p.preload&&"mpegurl"!=n.type||!h.zeropreload||!h.dataload)&&c.load(),p.splash&&c.load()},pause:function(){c.pause()},resume:function(){c.play()},speed:function(e){c.playbackRate=e},seek:function(e){try{var n=t.paused;c.currentTime=e,n&&c.pause()}catch(i){}},volume:function(e){d=e,c&&(c.volume=e)},unload:function(){e("video.fp-engine",i).remove(),h.cachedVideoTag||(y=null),l=clearInterval(l),c=0}}};var k=/\.(\w{3,4})(\?.*)?$/i;e.throttle=function(e,t){var n;return function(){n||(e.apply(this,arguments),n=1,setTimeout(function(){n=0},t))}},e.fn.slider2=function(t){var n=/iPad/.test(navigator.userAgent)&&!/CriOS/.test(navigator.userAgent);return this.each(function(){var i,o,r,a,s,l,c,d,u=e(this),h=e(document),p=u.children(":last"),f=!1,g=function(){o=u.offset(),r=u.width(),a=u.height(),l=s?a:r,d=w(c)},m=function(e){i||e==b.value||c&&!(c>e)||(u.trigger("slide",[e]),b.value=e)},v=function(e){var n=e.pageX;!n&&e.originalEvent&&e.originalEvent.touches&&e.originalEvent.touches.length&&(n=e.originalEvent.touches[0].pageX);var i=s?e.pageY-o.top:n-o.left;i=Math.max(0,Math.min(d||l,i));var r=i/l;return s&&(r=1-r),t&&(r=1-r),y(r,0,!0)},y=function(e,t){void 0===t&&(t=0),e>1&&(e=1);var i=Math.round(1e3*e)/10+"%";return(!c||c>=e)&&(n||f||p.stop(),f?p.css("width",i):p.animate(s?{height:i}:{width:i},t,"linear")),e},w=function(e){return Math.max(0,Math.min(l,s?(1-e)*a:e*r))},b={max:function(e){c=e},disable:function(e){i=e},slide:function(e,t,n){g(),n&&m(e),y(e,t)},disableAnimation:function(e,t){f=e!==!1,u.toggleClass("no-animation",!!t)}};g(),u.data("api",b).bind("mousedown.sld touchstart",function(t){if(t.preventDefault(),!i){var n=e.throttle(m,100);g(),b.dragging=!0,u.addClass("is-dragging"),m(v(t)),h.bind("mousemove.sld touchmove",function(e){e.preventDefault(),n(v(e))}).one("mouseup touchend",function(){b.dragging=!1,u.removeClass("is-dragging"),h.unbind("mousemove.sld touchmove")})}})})},flowplayer(function(t,n){function i(t){return e(".fp-"+t,n)}function o(t){("0px"===n.css("width")||"0px"===n.css("height")||t!==flowplayer.defaults.ratio)&&(parseInt(y,10)||g.css("paddingTop",100*t+"%")),l.inlineBlock||e("object",n).height(n.height())}function r(e){n.toggleClass("is-mouseover",e).toggleClass("is-mouseout",!e)}var a,s=t.conf,l=flowplayer.support;n.find(".fp-ratio,.fp-ui").remove(),n.addClass("flowplayer").append('      <div class="ratio"/>      <div class="ui">         <div class="waiting"><em/><em/><em/></div>         <a class="fullscreen"/>         <a class="unload"/>         <p class="speed"/>         <div class="controls">            <a class="play"></a>            <div class="timeline">               <div class="buffer"/>               <div class="progress"/>            </div>            <div class="volume">               <a class="mute"></a>               <div class="volumeslider">                  <div class="volumelevel"/>               </div>            </div>         </div>         <div class="time">            <em class="elapsed">00:00</em>            <em class="remaining"/>            <em class="duration">00:00</em>         </div>         <div class="message"><h2/><p/></div>      </div>'.replace(/class="/g,'class="fp-'));var d=i("progress"),u=i("buffer"),h=i("elapsed"),p=i("remaining"),f=i("waiting"),g=i("ratio"),m=i("speed"),v=i("duration"),y=g.css("paddingTop"),w=i("timeline").slider2(t.rtl),b=w.data("api"),C=(i("volume"),i("fullscreen")),k=i("volumeslider").slider2(t.rtl),F=k.data("api"),x=n.is(".fixed-controls, .no-toggle");b.disableAnimation(n.hasClass("is-touch")),l.animation||f.html("<p>loading &hellip;</p>"),o(s.ratio);try{s.fullscreen||C.remove()}catch(T){C.remove()}t.bind("ready",function(){var e=t.video.duration;b.disable(t.disabled||!e),s.adaptiveRatio&&o(t.video.height/t.video.width),v.add(p).html(c(e)),e>=3600&&n.addClass("is-long")||n.removeClass("is-long"),F.slide(t.volumeLevel),"flash"===t.engine&&b.disableAnimation(!0,!0)}).bind("unload",function(){y||g.css("paddingTop","")}).bind("buffer",function(){var e=t.video,n=e.buffer/e.duration;!e.seekable&&l.seekable&&b.max(n),1>n?u.css("width",100*n+"%"):u.css({width:"100%"})}).bind("speed",function(e,t,n){m.text(n+"x").addClass("fp-hilite"),setTimeout(function(){m.removeClass("fp-hilite")},1e3)}).bind("buffered",function(){u.css({width:"100%"}),b.max(1)}).bind("progress",function(){var e=t.video.time,n=t.video.duration;b.dragging||b.slide(e/n,t.seeking?0:250),h.html(c(e)),p.html("-"+c(n-e))}).bind("finish resume seek",function(e){n.toggleClass("is-finished","finish"==e.type)}).bind("stop",function(){h.html(c(0)),b.slide(0,100)}).bind("finish",function(){h.html(c(t.video.duration)),b.slide(1,100),n.removeClass("is-seeking")}).bind("beforeseek",function(){d.stop()}).bind("volume",function(){F.slide(t.volumeLevel)}).bind("disable",function(){var e=t.disabled;b.disable(e),F.disable(e),n.toggleClass("is-disabled",t.disabled)}).bind("mute",function(e,t,i){n.toggleClass("is-muted",i)}).bind("error",function(t,i,o){if(n.removeClass("is-loading").addClass("is-error"),o){o.message=s.errors[o.code],i.error=!0;var r=e(".fp-message",n);e("h2",r).text((i.engine||"html5")+": "+o.message),e("p",r).text(o.url||i.video.url||i.video.src||s.errorUrls[o.code]),n.unbind("mouseenter click").removeClass("is-mouseover")}}).bind("mouseenter mouseleave",function(e){if(!x){var t,i="mouseenter"==e.type;r(i),i?(n.bind("pause.x mousemove.x volume.x",function(){r(!0),t=new Date}),a=setInterval(function(){new Date-t>5e3&&(r(!1),t=new Date)},100)):(n.unbind(".x"),clearInterval(a))}}).bind("mouseleave",function(){(b.dragging||F.dragging)&&n.addClass("is-mouseover").removeClass("is-mouseout")}).bind("click.player",function(n){return e(n.target).is(".fp-ui, .fp-engine")||n.flash?(n.preventDefault(),t.toggle()):void 0}).bind("contextmenu",function(t){t.preventDefault();var i=n.offset(),o=e(window),r=t.clientX-i.left,a=t.clientY-i.top+o.scrollTop(),s=n.find(".fp-context-menu").css({left:r+"px",top:a+"px",display:"block"}).on("click",function(e){e.stopPropagation()});e("html").on("click.outsidemenu",function(t){s.hide(),e("html").off("click.outsidemenu")})}).bind("flashdisabled",function(){n.addClass("is-flash-disabled").one("ready",function(){n.removeClass("is-flash-disabled").find(".fp-flash-disabled").remove()}).append('<div class="fp-flash-disabled">Adobe Flash is disabled for this page, click player area to enable.</div>')}),s.poster&&n.css("backgroundImage","url("+s.poster+")");var _=n.css("backgroundColor"),E="none"!=n.css("backgroundImage")||_&&"rgba(0, 0, 0, 0)"!=_&&"transparent"!=_;!E||s.splash||s.autoplay||t.bind("ready stop",function(){n.addClass("is-poster").one("progress",function(){n.removeClass("is-poster")})}),!E&&t.forcedSplash&&n.css("backgroundColor","#555"),e(".fp-toggle, .fp-play",n).click(t.toggle),e.each(["mute","fullscreen","unload"],function(e,n){i(n).click(function(){t[n]()})}),w.bind("slide",function(e,n){t.seeking=!0,t.seek(n*t.video.duration)}),k.bind("slide",function(e,n){t.volume(n)}),i("time").click(function(t){e(this).toggleClass("is-inverted")}),r(x)});var F,x,T="is-help";e(document).bind("keydown.fp",function(t){var n=F,i=t.ctrlKey||t.metaKey||t.altKey,o=t.which,r=n&&n.conf;if(n&&r.keyboard&&!n.disabled){if(-1!=e.inArray(o,[63,187,191]))return x.toggleClass(T),!1;if(27==o&&x.hasClass(T))return x.toggleClass(T),!1;if(!i&&n.ready){if(t.preventDefault(),t.shiftKey)return void(39==o?n.speed(!0):37==o&&n.speed(!1));if(58>o&&o>47)return n.seekTo(o-48);switch(o){case 38:case 75:n.volume(n.volumeLevel+.15);break;case 40:case 74:n.volume(n.volumeLevel-.15);break;case 39:case 76:n.seeking=!0,n.seek(!0);break;case 37:case 72:n.seeking=!0,n.seek(!1);break;case 190:n.seekTo();break;case 32:n.toggle();break;case 70:r.fullscreen&&n.fullscreen();break;case 77:n.mute();break;case 81:n.unload()}}}}),flowplayer(function(t,n){if(t.conf.keyboard){n.bind("mouseenter mouseleave",function(e){F=t.disabled||"mouseenter"!=e.type?0:t,F&&(x=n)});var i=flowplayer.support.video&&"flash"!==t.conf.engine&&e("<video/>")[0].playbackRate?"<p><em>shift</em> + <em>&#8592;</em><em>&#8594;</em>slower / faster</p>":"";n.append('	      <div class="fp-help">	         <a class="fp-close"></a>	         <div class="fp-help-section fp-help-basics">	            <p><em>space</em>play / pause</p>	            <p><em>q</em>unload | stop</p>	            <p><em>f</em>fullscreen</p>'+i+'	         </div>	         <div class="fp-help-section">	            <p><em>&#8593;</em><em>&#8595;</em>volume</p>	            <p><em>m</em>mute</p>	         </div>	         <div class="fp-help-section">	            <p><em>&#8592;</em><em>&#8594;</em>seek</p>	            <p><em>&nbsp;. </em>seek to previous	            </p><p><em>1</em><em>2</em>&hellip; <em>6</em> seek to 10%, 20% &hellip; 60% </p>	         </div>	      </div>	      <div class="open-help cIcon cIconQuestionWhite" style="display:none"></div>	   '),t.conf.tooltip&&(n.on("mouseenter",function(t){n.hasClass(T)||e(".open-help").show()}),n.on("mouseout",function(t){e(".open-help").hide()}),e(".open-help").on("mouseenter",function(e){n.addClass("is-help")}),e(".fp-ui",n).attr("title","Hit ? for help").on("mouseout.tip",function(){e(this).removeAttr("title").off("mouseout.tip")})),e(".fp-close",n).click(function(){n.toggleClass(T)})}});var _,E=e.browser.mozilla?"moz":"webkit",S="fullscreen",j="fullscreen-exit",I=flowplayer.support.fullscreen,A=("function"==typeof document.exitFullscreen,navigator.userAgent.toLowerCase()),O=/(safari)[ \/]([\w.]+)/.exec(A)&&!/(chrome)[ \/]([\w.]+)/.exec(A);e(document).bind("fullscreenchange webkitfullscreenchange mozfullscreenchange MSFullscreenChange",function(t){var n=e(document.webkitCurrentFullScreenElement||document.mozFullScreenElement||document.fullscreenElement||document.msFullscreenElement||t.target);n.length&&!_?_=n.trigger(S,[n]):(_.trigger(j,[_]),_=null)}),flowplayer(function(t,n){if(t.conf.fullscreen){var i,o=e(window),r={apply:!1,pos:0,play:!1};t.isFullscreen=!1,t.fullscreen=function(a){if(!t.disabled){if(void 0===a&&(a=!t.isFullscreen),a&&(i=o.scrollTop()),"webkit"!=E&&!O||"flash"!=t.engine||(r={apply:!0,pos:t.video.time,play:t.playing}),I)if(a){var s=n[0];e.each(["requestFullScreen","webkitRequestFullScreen","mozRequestFullScreen","msRequestFullscreen"],function(e,t){return"function"==typeof s[t]?(s[t](Element.ALLOW_KEYBOARD_INPUT),!O||document.webkitCurrentFullScreenElement||document.mozFullScreenElement||s[t](),!1):void 0})}else e.each(["exitFullscreen","webkitCancelFullScreen","mozCancelFullScreen","msExitFullscreen"],function(e,t){return"function"==typeof document[t]?(document[t](),!1):void 0});else t.trigger(a?S:j,[t]);return t}};var a;n.bind("mousedown.fs",function(){+new Date-a<150&&t.ready&&t.fullscreen(),a=+new Date}),t.bind(S,function(e){n.addClass("is-fullscreen"),t.isFullscreen=!0}).bind(j,function(e){var r;I||"html5"!==t.engine||(r=n.css("opacity")||"",n.css("opacity",0)),n.removeClass("is-fullscreen"),I||"html5"!==t.engine||setTimeout(function(){n.css("opacity",r)}),t.isFullscreen=!1,o.scrollTop(i)}).bind("ready",function(){if(r.apply){var n=function(){r.play||t.conf.live?t.resume():t.pause(),e.extend(r,{pos:0,play:!1})};t.conf.live?n():t.conf.rtmp&&r.pos&&!isNaN(r.pos)?(t.resume(),t.seek(r.pos,n)):n()}})}}),flowplayer(function(t,n){function i(){return e(r.query,n)}function o(){return e(r.query+"."+a,n)}var r=e.extend({active:"is-active",advance:!0,query:".fp-playlist a"},t.conf),a=r.active;t.play=function(n){return void 0===n?t.resume():"number"!=typeof n||t.conf.playlist[n]?("number"!=typeof n&&t.load.apply(null,arguments),t.unbind("resume.fromfirst"),t.video.index=n,t.load("string"==typeof t.conf.playlist[n]?t.conf.playlist[n].toString():e.map(t.conf.playlist[n],function(t){return e.extend({},t)})),t):t},t.next=function(e){e&&e.preventDefault();var n=t.video.index;return-1!=n&&(n=n===t.conf.playlist.length-1?0:n+1,t.play(n)),t},t.prev=function(e){e&&e.preventDefault();var n=t.video.index;return-1!=n&&(n=0===n?t.conf.playlist.length-1:n-1,t.play(n)),t},e(".fp-next",n).click(t.next),e(".fp-prev",n).click(t.prev),r.advance&&n.unbind("finish.pl").bind("finish.pl",function(e,t){var i=t.video.index>=0?t.video.index+1:void 0;i<t.conf.playlist.length||r.loop?(i=i===t.conf.playlist.length?0:i,n.removeClass("is-finished"),setTimeout(function(){t.play(i)})):(n.addClass("is-playing"),t.conf.playlist.length>1&&t.one("resume.fromfirst",function(){return t.play(0),!1}))});var s=!1;if(t.conf.playlist.length){s=!0;var l=n.find(".fp-playlist");if(!l.length){l=e('<div class="fp-playlist"></div>');var c=e(".fp-next,.fp-prev",n);c.length?c.eq(0).before(l):e("video",n).after(l)}l.empty(),e.each(t.conf.playlist,function(t,n){var i;if("string"==typeof n)i=n;else for(var o in n[0])if(n[0].hasOwnProperty(o)){i=n[0][o];break}l.append(e("<a />").attr({href:i,"data-index":t}))})}if(i().length){s||(t.conf.playlist=[],i().each(function(){var n=e(this).attr("href");e(this).attr("data-index",t.conf.playlist.length),t.conf.playlist.push(n)})),n.on("click",r.query,function(n){n.preventDefault();var i=e(n.target).closest(r.query),o=Number(i.attr("data-index"));-1!=o&&t.play(o)});var d=i().filter("[data-cuepoints]").length;t.bind("load",function(i,r,s){var l=o().removeClass(a),c=l.attr("data-index"),u=s.index=t.video.index||0,h=e('a[data-index="'+u+'"]',n).addClass(a),p=u==t.conf.playlist.length-1;n.removeClass("video"+c).addClass("video"+u).toggleClass("last-video",p),s.index=r.video.index=u,s.is_last=r.video.is_last=p,d&&(t.cuepoints=h.data("cuepoints"))}).bind("unload.pl",function(){o().toggleClass(a)})}t.conf.playlist.length&&(t.conf.loop=!1)});var M=/ ?cue\d+ ?/;flowplayer(function(t,n){function i(e){n[0].className=n[0].className.replace(M," "),e>=0&&n.addClass("cue"+e)}var o=0;t.cuepoints=t.conf.cuepoints||[],t.bind("progress",function(e,r,a){if(o&&.015>a-o)return o=a;o=a;for(var s,l=t.cuepoints||[],c=0;c<l.length;c++)s=l[c],isNaN(s)||(s={time:s}),s.time<0&&(s.time=t.video.duration+s.time),s.index=c,Math.abs(s.time-a)<.125*t.currentSpeed&&(i(c),n.trigger("cuepoint",[t,s]))}).bind("unload seek",i),t.conf.generate_cuepoints&&t.bind("load",function(){e(".fp-cuepoint",n).remove()}).bind("ready",function(){var i=t.cuepoints||[],o=t.video.duration,r=e(".fp-timeline",n).css("overflow","visible");e.each(i,function(n,i){var a=i.time||i;0>a&&(a=o+i);var s=e("<a/>").addClass("fp-cuepoint fp-cuepoint"+n).css("left",a/o*100+"%");s.appendTo(r).mousedown(function(){return t.seek(a),!1})})})}),flowplayer(function(t,n,i){function o(e){var t=e.split(":");return 2==t.length&&t.unshift(0),60*t[0]*60+60*t[1]+parseFloat(t[2].replace(",","."))}var r=e("track",n),a=t.conf;if(flowplayer.support.subtitles&&(t.subtitles=r.length&&r[0].track,a.nativesubtitles&&"html5"==a.engine)){if(!t.subtitles)return;var s=function(t){var i=e("video",n)[0].textTracks;i.length&&(i[0].mode=t)};return s("disabled"),void t.one("ready",function(){t.conf.splash&&e("video.fp-engine",n).append(e("<track />").attr({kind:"subtitles",srclang:t.subtitles.language||"en",label:t.subtitles.language||"en",src:r.attr("src"),"default":"default"})),s("disabled"),s("showing")})}r.remove();var l=/^(([0-9]{2}:){1,2}[0-9]{2}[,.][0-9]{3}) --\> (([0-9]{2}:){1,2}[0-9]{2}[,.][0-9]{3})(.*)/;t.subtitles=[];var c=r.attr("src");if(c){setTimeout(function(){e.get(c,function(n){for(var i,r,a,s,c=0,d=n.split("\n"),u=d.length,h={};u>c;c++)if(r=l.exec(d[c])){for(i=d[c-1],a="<p>"+d[++c]+"</p><br/>";e.trim(d[++c])&&c<d.length;)a+="<p>"+d[c]+"</p><br/>";h={title:i,startTime:o(r[1]),endTime:o(r[3]),text:a},s={time:h.startTime,subtitle:h},t.subtitles.push(h),t.cuepoints.push(s),t.cuepoints.push({time:h.endTime,subtitleEnd:i}),0===h.startTime&&t.trigger("cuepoint",s)}}).fail(function(){return t.trigger("error",{code:8,url:c}),!1})});var d,u=e("<div class='fp-subtitle'/>").appendTo(n);t.bind("cuepoint",function(e,t,n){n.subtitle?(d=n.index,u.html(n.subtitle.text).addClass("fp-active")):n.subtitleEnd&&(u.removeClass("fp-active"),d=n.index)}).bind("seek",function(n,i,o){d&&t.cuepoints[d]&&t.cuepoints[d].time>o&&(u.removeClass("fp-active"),d=null),e.each(t.cuepoints||[],function(e,n){var i=n.subtitle;i&&d!=n.index?o>=n.time&&(!i.endTime||o<=i.endTime)&&t.trigger("cuepoint",n):n.subtitleEnd&&o>=n.time&&n.index==d+1&&t.trigger("cuepoint",n)})})}}),flowplayer(function(t,n){function i(e){if(r&&"undefined"!=typeof _gat){var i=_gat._getTracker(o),a=t.video;i._setAllowLinker(!0),i._trackEvent("Video / Seconds played",t.engine+"/"+a.type,n.attr("title")||a.src.split("/").slice(-1)[0].replace(k,""),Math.round(r/1e3)),r=0}}var o=t.conf.analytics,r=0,a=0;o&&("undefined"==typeof _gat&&e.getScript("//google-analytics.com/ga.js"),t.bind("load unload",i).bind("progress",function(){t.seeking||(r+=a?+new Date-a:0,a=+new Date)}).bind("pause",function(){a=0}),e(window).on("unload",i))});var P=/IEMobile/.test(h);(flowplayer.support.touch||P)&&flowplayer(function(t,n){var i=/Android/.test(h)&&!/Firefox/.test(h)&&!/Opera/.test(h),o=/Silk/.test(h),r=i?parseFloat(/Android\ (\d\.\d)/.exec(h)[1],10):0;if(i){if(!/Chrome/.test(h)&&4>r){var a=t.load;t.load=function(e,n){var i=a.apply(t,arguments);return t.trigger("ready",[t,t.video]),i}}var s,l=0,d=function(e){s=setInterval(function(){e.video.time=++l,e.trigger("progress",l)},1e3)};t.bind("ready pause unload",function(){s&&(clearInterval(s),s=null)}),t.bind("ready",function(){l=0}),t.bind("resume",function(e,n){return n.live?l?d(n):void t.one("progress",function(e,t,n){0===n&&d(t)}):void 0})}flowplayer.support.volume||n.addClass("no-volume no-mute"),n.addClass("is-touch"),n.find(".fp-timeline").data("api").disableAnimation(),(!flowplayer.support.inlineVideo||t.conf.native_fullscreen)&&(t.conf.nativesubtitles=!0);var u=!1;n.bind("touchmove",function(){u=!0}).bind("touchend click",function(i){return u?void(u=!1):t.playing&&!n.hasClass("is-mouseover")?(n.addClass("is-mouseover").removeClass("is-mouseout"),!1):(t.paused&&n.hasClass("is-mouseout")&&!t.splash&&t.toggle(),void(t.paused&&P&&e("video.fp-engine",n)[0].play()))}),t.conf.native_fullscreen&&"function"==typeof e("<video />")[0].webkitEnterFullScreen&&(t.fullscreen=function(){var t=e("video.fp-engine",n);t[0].webkitEnterFullScreen(),t.one("webkitendfullscreen",function(){t.prop("controls",!0).prop("controls",!1)})}),(i||o)&&t.bind("ready",function(){var i=e("video.fp-engine",n);i.one("canplay",function(){i[0].play()}),i[0].play(),t.bind("progress.dur",function(){var o=i[0].duration;1!==o&&(t.video.duration=o,e(".fp-duration",n).html(c(o)),t.unbind("progress.dur"))})})}),flowplayer(function(t,n){if(t.conf.embed!==!1){var i=t.conf,o=e(".fp-ui",n),r=e("<a/>",{"class":"fp-embed",title:"Copy to your site"}).appendTo(o),a=e("<div/>",{"class":"fp-embed-code"}).append("<label>Paste this HTML code on your site to embed.</label><textarea/>").appendTo(o),s=e("textarea",a);t.embedCode=function(){var o=t.video,r=o.width||n.width(),a=o.height||n.height(),s=e("<div/>",{"class":"flowplayer",css:{width:r,height:a}}),l=e("<video/>").appendTo(s);e.each(["origin","analytics","key","rtmp","subscribe","bufferTime"],function(e,t){i.hasOwnProperty(t)&&s.attr("data-"+t,i[t])}),i.logo&&s.attr("data-logo",e("<img />").attr("src",i.logo)[0].src),e.each(o.sources,function(t,n){var o=n.src;(!/^https?:/.test(n.src)&&"flash"!==n.type||!i.rtmp)&&(o=e("<img/>").attr("src",n.src)[0].src),l.append(e("<source/>",{type:"mpegurl"!=n.type?"video/"+n.type:"application/x-mpegurl",src:o}))});var c={src:"//embed.flowplayer.org/5.5.2/embed.min.js"};e.isPlainObject(i.embed)&&(c["data-swf"]=i.embed.swf,c["data-library"]=i.embed.library,c.src=i.embed.script||c.src,i.embed.skin&&(c["data-skin"]=i.embed.skin));var d=e("<foo/>",c).append(s);return e("<p/>").append(d).html().replace(/<(\/?)foo/g,"<$1script")},n.fptip(".fp-embed","is-embedding"),s.click(function(){this.select()}),r.click(function(){s.text(t.embedCode()),s[0].focus(),s[0].select()})}}),e.fn.fptip=function(t,n){return this.each(function(){function i(){o.removeClass(n),e(document).unbind(".st")}var o=e(this);e(t||"a",this).click(function(t){t.preventDefault(),o.toggleClass(n),o.hasClass(n)&&e(document).bind("keydown.st",function(e){27==e.which&&i()}).bind("click.st",function(t){e(t.target).parents("."+n).length||i()})})})}}(jQuery),flowplayer(function(e,t){function n(e){var t=r("<a/>")[0];return t.href=e,t.hostname}function i(e){var t="ab.ca,ac.ac,ac.at,ac.be,ac.cn,ac.il,ac.in,ac.jp,ac.kr,ac.sg,ac.th,ac.uk,adm.br,adv.br,ah.cn,am.br,arq.br,art.br,arts.ro,asn.au,asso.fr,asso.mc,bc.ca,bio.br,biz.pl,biz.tr,bj.cn,br.com,cn.com,cng.br,cnt.br,co.ac,co.at,co.de,co.gl,co.hk,co.id,co.il,co.in,co.jp,co.kr,co.mg,co.ms,co.nz,co.th,co.uk,co.ve,co.vi,co.za,com.ag,com.ai,com.ar,com.au,com.br,com.cn,com.co,com.cy,com.de,com.do,com.ec,com.es,com.fj,com.fr,com.gl,com.gt,com.hk,com.hr,com.hu,com.kg,com.ki,com.lc,com.mg,com.mm,com.ms,com.mt,com.mu,com.mx,com.my,com.na,com.nf,com.ng,com.ni,com.pa,com.ph,com.pl,com.pt,com.qa,com.ro,com.ru,com.sb,com.sc,com.sg,com.sv,com.tr,com.tw,com.ua,com.uy,com.ve,com.vn,cq.cn,de.com,de.org,ecn.br,edu.au,edu.cn,edu.hk,edu.mm,edu.my,edu.pl,edu.pt,edu.qa,edu.sg,edu.tr,eng.br,ernet.in,esp.br,etc.br,eti.br,eu.com,eu.int,eu.lv,firm.in,firm.ro,fm.br,fot.br,fst.br,g12.br,gb.com,gb.net,gd.cn,gen.in,go.jp,go.kr,go.th,gov.au,gov.az,gov.br,gov.cn,gov.il,gov.in,gov.mm,gov.my,gov.qa,gov.sg,gov.tr,gov.tw,gov.uk,gs.cn,gv.ac,gv.at,gx.cn,gz.cn,he.cn,hi.cn,hk.cn,hl.cn,hu.com,id.au,idv.tw,in.ua,ind.br,ind.in,inf.br,info.pl,info.ro,info.tr,info.ve,iwi.nz,jl.cn,jor.br,js.cn,k12.il,k12.tr,kr.com,lel.br,ln.cn,ltd.uk,maori.nz,mb.ca,me.uk,med.br,mi.th,mil.br,mil.uk,mo.cn,mod.uk,muni.il,nb.ca,ne.jp,ne.kr,net.ag,net.ai,net.au,net.br,net.cn,net.do,net.gl,net.hk,net.il,net.in,net.kg,net.ki,net.lc,net.mg,net.mm,net.mu,net.ni,net.nz,net.pl,net.ru,net.sb,net.sc,net.sg,net.th,net.tr,net.tw,net.uk,net.ve,nf.ca,nhs.uk,nm.cn,nm.kr,no.com,nom.br,nom.ni,nom.ro,ns.ca,nt.ca,nt.ro,ntr.br,nx.cn,odo.br,off.ai,on.ca,or.ac,or.at,or.jp,or.kr,or.th,org.ag,org.ai,org.au,org.br,org.cn,org.do,org.es,org.gl,org.hk,org.in,org.kg,org.ki,org.lc,org.mg,org.mm,org.ms,org.nf,org.ni,org.nz,org.pl,org.ro,org.ru,org.sb,org.sc,org.sg,org.tr,org.tw,org.uk,org.ve,pe.ca,plc.uk,police.uk,ppg.br,presse.fr,pro.br,psc.br,psi.br,qc.ca,qc.com,qh.cn,rec.br,rec.ro,res.in,sa.com,sc.cn,sch.uk,se.com,se.net,sh.cn,sk.ca,slg.br,sn.cn,store.ro,tj.cn,tm.fr,tm.mc,tm.ro,tmp.br,tur.br,tv.br,tv.tr,tw.cn,uk.com,uk.net,us.com,uy.com,vet.br,waw.pl,web.ve,www.ro,xj.cn,xz.cn,yk.ca,yn.cn,zj.cn,zlg.br".split(",");e=e.toLowerCase();var n=e.split("."),i=n.length;if(2>i||/^\d+$/.test(n[i-1]))return e;var o=n.slice(-2).join(".");return i>=3&&r.inArray(o,t)>=0?n.slice(-3).join("."):o}function o(e,t){t=i(t);for(var n=0,o=t.length-1;o>=0;o--)n+=2983723987*t.charCodeAt(o);for(n=(""+n).substring(0,7),o=0;e.length>o;o++)if(n===e[o].substring(1,8))return 1}var r=jQuery,a=e.conf,s=a.swf.indexOf("flowplayer.org")&&a.e&&t.data("origin"),l=s?n(s):location.hostname,c=a.key;if("file:"==location.protocol&&(l="localhost"),e.load.ed=1,a.hostname=l,a.origin=s||location.href,s&&t.addClass("is-embedded"),"string"==typeof c&&(c=c.split(/,\s*/)),c&&"function"==typeof o&&o(c,l))a.logo&&t.append(r("<a>",{"class":"fp-logo",href:s}).append(r("<img/>",{src:a.logo})));else{var d=r("<a/>").attr("href","http://flowplayer.org").appendTo(t);r(".fp-controls",t);var u=r('<div class="fp-context-menu"><ul><li class="copyright">&copy; 2014</li><li><a href="http://flowplayer.org">About Flowplayer</a></li><li><a href="http://flowplayer.org/license">GPL based license</a></li></ul></div>').appendTo(t);e.bind("pause resume finish unload",function(e,n){var i=-1;n.video.src&&r.each([["org","flowplayer","drive"],["org","flowplayer","my"]],function(e,t){return i=n.video.src.indexOf("://"+t.reverse().join(".")),-1===i}),/pause|resume/.test(e.type)&&"flash"!=n.engine&&4!=i&&5!=i?(d.show().css({position:"absolute",left:16,bottom:36,zIndex:99999,width:100,height:20,backgroundImage:"url("+[".png","logo","/",".net",".cloudfront","d32wqyuo10o653","//"].reverse().join("")+")"}),n.load.ed=d.is(":visible")&&r.contains(t[0],u[0]),n.load.ed||n.pause()):d.hide()})}}),"undefined"==typeof Handler&&(Handler={}),Handler.tracking=Extend.Publisher(function(){return Handler.tracking.emit("event",arguments)}),Handler.tracking.ga=function(e,t,n){"function"!=typeof ga&&errorHandler.error("Google Analytics not defined"),ga("create",e,t),ga("set","dimension2",config.level().toString()),ga("require","linkid","linkid.js"),n&&ga("require",n),ga("send","pageview"),window.flowplayer&&window.flowplayer.conf&&(flowplayer.conf.analytics=e),Handler.tracking.on("event",function(e,t){var n=["send","event"];n.pushArray(t),ga.apply(ga,n)})},Handler.tracking.fb=function(e,t){function n(e){var t=e[0],n=e[1];return"playzone"==t&&"gameStart"==n?["track","Lead"]:"view"==t&&"premium"==n?["track","AddToCart"]:"single-purchase"==t&&"open-dialog"==n?["track","AddToCart"]:[]}config.consent().hasPerformanceConsent&&("function"!=typeof fbq&&errorHandler.error("Facebook tracking not defined"),fbq("init",e),fbq("track","PageView"),Handler.tracking.on("event",function(e,t){var i=n(t);0<i.length&&fbq.apply(fbq,i)}))},Handler.tracking.fullstory=function(){function e(e){var t=e[0],n=e[1],i=t+" "+n;return 2===e.length?[i,{}]:[i,{value_str:e[2]}]}"function"!=typeof FS&&errorHandler.error("Fullstory tracking not defined"),FS.setUserVars({user_type_str:config.level().toString()}),Handler.tracking.on("event",function(t,n){var i=e(n);0<i.length&&FS.event(i[0],i[1])})},function(e,t,n,i,o,r,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,r=t.createElement(n),a=t.getElementsByTagName(n)[0],r.async=1,r.src=i,a.parentNode.insertBefore(r,a)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),Handler.tracking.ga("UA-49208411-1","chess24.com","GTM-M4F2FCV"),config.consent().hasPerformanceConsent&&!function(e,t,n,i,o,r,a){e.fbq||(o=e.fbq=function(){o.callMethod?o.callMethod.apply(o,arguments):o.queue.push(arguments)},e._fbq||(e._fbq=o,o.push=o,o.loaded=!0,o.version="2.0"),o.queue=[],r=t.createElement(n),r.async=!0,r.src=i,a=t.getElementsByTagName(n)[0],a.parentNode.insertBefore(r,a))}(window,document,"script","https://connect.facebook.net/en_US/fbevents.js"),Handler.tracking.fb("221096998503494","chess24.com"),window._fs_debug=!1,window._fs_host="fullstory.com",window._fs_script="edge.fullstory.com/s/fs.js",window._fs_org="1025YR",window._fs_namespace="FS",function(e,t,n,i,o,r,a,s){return n in e?void(e.console&&e.console.log&&e.console.log('FullStory namespace conflict. Please set window["_fs_namespace"].')):(a=e[n]=function(e,t,n){a.q?a.q.push([e,t,n]):a._api(e,t,n)},a.q=[],r=t.createElement(i),r.async=1,r.crossOrigin="anonymous",r.src="https://"+_fs_script,s=t.getElementsByTagName(i)[0],s.parentNode.insertBefore(r,s),a.identify=function(e,t,n){a(o,{uid:e},n),t&&a(o,t,n)},a.setUserVars=function(e,t){a(o,e,t)},a.event=function(e,t,n){a("event",{n:e,p:t},n)},a.anonymize=function(){a.identify(!1)},a.shutdown=function(){a("rec",!1)},a.restart=function(){a("rec",!0)},a.log=function(e,t){a("log",[e,t])},a.consent=function(e){a("consent",!arguments.length||e)},a.identifyAccount=function(e,t){r="account",t=t||{},t.acctId=e,a(r,t)},a.clearUserCookie=function(){},a.setVars=function(e,t){a("setVars",[e,t])},a._w={},s="XMLHttpRequest",a._w[s]=e[s],s="fetch",a._w[s]=e[s],e[s]&&(e[s]=function(){return a._w[s].apply(this,arguments)}),void(a._v="1.3.0"))}(window,document,window._fs_namespace,"script","user"),Handler.tracking.fullstory(),"undefined"==typeof Handler&&(Handler={}),$(function(){window.config&&(window.chatHandler=new Handler.ChatHandler)}),Handler.ChatHandler=function(){function e(e,t,n){notificationHandler.sendMessage("chat."+e,t,n)}function t(){function e(e,t){Object.forEach(o,function(n){"function"==typeof n[e]&&n[e](t)})}function t(e,t,n){var i=o[t];i&&"function"==typeof i[e]&&i[e](n)}var n=this,i=0,o={};n.addView=function(e,t){o[e]=t,i++},n.removeView=function(e){void 0!==o[e]&&(o[e].clear(),delete o[e],i--)},n.hasView=function(e){return void 0!==o[e]},n.hasViews=function(){return i>0},n.handleInitData=function(e){t("handleInitData",e.viewId,e)},n.handleEnterRoom=function(e){t("enterChatRoom",e.viewId,e)},n.handleEnterRoomFailed=function(e){t("enterChatRoomFailed",e.data.viewId,e)},n.handleMessage=function(t){e("addNewMessage",t.message)},n.handleMemberCounts=function(t){e("updateCounts",t.counts)},n.handleRoomMetadata=function(t){e("updateMetadata",t)},n.handleGetMessages=function(e){t("addPreviousMessages",e.data.viewId,e.messages)},n.handleMessageDeleted=function(t){e("deleteMessage",t.id)},n.handleMessagesDeleted=function(t){e("deleteMessages",t.userId)},n.handleUserBlocked=function(e){t("handleUserBlocked",e.clientInfo.viewId,e)},n.handleUserBanned=function(e){t("handleUserBanned",e.clientInfo.viewId,e)},n.handleUserUnbanned=function(e){t("handleUserUnbanned",e.clientInfo.viewId,e)}}function n(e){var t=e.content,n=t.action,i=t.data;switch(n){case"enterRoom":var o=i.roomId;void 0!==u[o]&&u[o].handleEnterRoomFailed(i);break;default:errorHandler.warning(n+" failed",e.content.data)}}function i(e){var t,n=e.content,i=n.data;switch(i.code){case s:t=i.clientInfo.roomId,void 0!==u[t]&&u[t].handleUserBlocked(i);break;case l:t=i.clientInfo.roomId,void 0!==u[t]&&u[t].handleUserBanned(i);break;case c:t=i.clientInfo.roomId,void 0!==u[t]&&u[t].handleUserUnbanned(i)}}function o(e,t){if(void 0!==t.content.type){var o,r,a=t.content.type;switch(a){case"roomMetadata":case"message":case"getMessages":case"memberCounts":case"messageDeleted":case"messagesDeleted":case"enterRoom":o=t.content.data.roomId,void 0!==u[o]&&(r="handle"+a.charAt(0).toUpperCase()+a.slice(1),u[o][r](t.content.data));break;case"initData":for(o in t.content.data.rooms)break;u[o].handleInitData(t.content.data);break;case"error":n(t);break;case"info":i(t)}}}function r(){h||(notificationHandler.on("chat",o),h=!0)}var a="default",s=201,l=202,c=203,d=this,u={},h=!1,p=20;return d.addChat=function(e,n,i){h||r(),i=i||{},i.getMessagesLimit=i.getMessagesLimit||p;var o=i.viewId||a+(new Helper.UUID).getShort();Array.isArray(n)||(n=[n]);var s=new View.Chat.ChatHandler(e,n,o,i);return n.forEach(function(e){void 0===u[e]&&(u[e]=new t(e)),u[e].hasView(o)||u[e].addView(o,s)}),s},d.removeChat=function(t,n,i){if(void 0===u[t])return d;var o=u[t];return n=n||a,o.removeView(n),o.hasViews()?"function"==typeof i&&i():(delete u[t],e("leaveChatRoom",t,i)),d},d.getInitData=function(t,n){e("getInitData",{rooms:t,viewId:n})},d.enterChatRoom=function(t,n,i){t&&(i=i||p,e("enterChatRoom",{roomId:t,viewId:n,messages:i,blockedUsers:blockedUserHandler.getBlockedUsers()}))},d.leaveChatRoom=function(t){e("leaveChatRoom",t)},d.sendMessage=function(t,n,i,o){return e("sendMessage",{roomId:t,message:n,type:i},o),Handler.tracking("message","chat",t),d},d.getPreviousMessages=function(t,n,i,o,r){return r=r||p,e("getMessages",{roomId:t,viewId:n,limit:r,refMessageId:i,refMessageTimestamp:o,blockedUsers:blockedUserHandler.getBlockedUsers()}),d},d.moderator={deleteMessage:function(t,n,i){e("deleteMessage",{roomId:t,id:n,timestamp:i})},getModeratorLog:function(t,n,i){e("getModeratorLog",{offset:t,limit:n},i)},getBannedUsers:function(t,n,i){e("getBannedUsers",{offset:t,limit:n},i)},user:{block:function(t,n,i,o){e("blockUser",{uuid:t,timeout:n,clientInfo:{roomId:i,viewId:o}})},ban:function(t,n,i){e("banUser",{uuid:t,clientInfo:{roomId:n,viewId:i}})},unban:function(t,n,i){e("unbanUser",{uuid:t,clientInfo:{roomId:n,viewId:i}})},deleteMessages:function(t,n){e("deleteMessagesFromUser",{roomId:n,userId:t})}}},d},Handler.ChatHandler.COOLDOWN_DEFAULTVALUE=30,function(){function e(){function e(e,s){void 0===s||isNaN(s)||(n=Date.now()-s,t.set("serverUserTimeOffset",n),r.resolve(n)),e.on("*",function(t){a.contains(t.id)||(i.emit(t.event||t.channel,t),a.push(t.id)),t.channel&&t.channel.substr(0,o.length)===o&&e.emit("messageRecieved",t.id);
})}var t=jQuery.localStorage,n=t.get("serverUserTimeOffset"),i=Extend.Publisher(this),o="channel:private:",r=new Helper.Deferred,a=[],s=Handler.socket.getSocket(Handler.socket.types.NOTIFICATION);return s.deferred.promise.done(e).fail(function(e){errorHandler.warning("no notification service available",{err:e})}),i.subscribe=function(e){return s.subscribe(e),i},i.unsubscribe=function(e){return s.unsubscribe(e),i},i.subscribeRequest=function(e){return s.subscribeRequest(e),i},i.getTimeOffset=function(){return null==n?r.promise:n},i.sendMessage=function(e,t,n){switch(e){case"chat.enterChatRoom":var i="chat:"+t.roomId,o=s.getChannels();o.contains(i)||o.push(i);break;case"chat.leaveChatRoom":i="chat:"+t,o=s.getChannels(),o.contains(i)&&o.removeByValue(i)}var r=[e,t];n&&r.push(n),s.emit.apply(s,r)},i.triggerNotificationDeleted=function(e,t){i.emit("deleteNotification",{notificationType:e,referenceId:t})},i}jQuery(function(){window.config&&(window.notificationHandler=new e)})}(),"undefined"==typeof Handler&&(Handler={}),$(function(){window.config&&(window.blockedUserHandler=new Handler.BlockedUserHandler)}),Handler.BlockedUserHandler=function(){function e(e,t){return 0==e.length?this:(o[e]="1",i.emit("user.blocked",e),t===!0&&n(),this)}function t(e){return delete o[e],i.emit("user.unblocked",e),n(),this}function n(){window.settings.set("blocked-users",Object.keys(o).join(","))}var i=Extend.Publisher(this),o={};return i.isBlocked=function(e){return!!o[e]},i.getBlockedUsers=function(){var e=[];for(var t in o)o.hasOwnProperty(t)&&e.push(t);return o},i.init=function(){var t=window.settings.getString("blocked-users");"#"!==t&&t.split(",").forEach(e)},function(){notificationHandler.on("blockedUserUpdate",function(n,i){i=i.content,i.state?e(i.userUuid,!0):t(i.userUuid)}),window.settings.on("loaded",function(){i.init()}),i.init()}(),i},"undefined"==typeof Handler&&(Handler={}),Handler.ConversationListHandler=function(e){function t(e){return!blockedUserHandler.isBlocked(e.uuid)}function n(e){switch(e.type){case 1:return Array.isArray(e.users)&&e.users.some(t)||Array.isArray(e.deletedFrom)&&e.deletedFrom.some(t);default:return!1}}function i(e){r=[],e.forEach(function(e){n(e)&&r.push(e)}),o(),a.emit("conversationListChanged",r)}function o(){s={};for(var e=r.length,t=0;e>t;t++)s[r[t].id]=t}var r,a=Extend.Publisher(this),s={};return e.on("newMessage",function(t,n){if(!blockedUserHandler.isBlocked(n.message.user.uuid)){var i=n.roomId,l=s[i];if(void 0!==l){if(l>0){var c=r[l];r.splice(l,1),r.unshift(c),o(),a.emit("movedItemToStart",l)}a.emit("updateConversation",{isOwnMessage:config.user().uuid===n.message.user.uuid,index:0,message:n.message.content,timestamp:n.message.timestamp})}else l=0,e.getConversation(i,function(e){r.unshift(e),o(),a.emit("newItem",{index:0,converesation:e})})}}),e.on("user-left",function(e,t){var n=t.room,i=s[n],l=t.user;config.user().uuid==l?(r.splice(i,1),a.emit("removedItem",{index:i}),o()):a.emit("user-left."+n,l)}),a.getConversations=function(){return r},e.getConversations(i),a},"undefined"==typeof Handler&&(Handler={}),$(function(){window.config&&(window.conversationHandler=new Handler.ConversationHandler)}),Handler.ConversationHandler=function(){function e(e,t,n){notificationHandler.sendMessage("conversation."+e,t,n)}var t,n=20,i=Extend.Publisher(this),o={};return notificationHandler.on("conversation",function(e,t){var n=t.content.data;switch(t.content.type){case"userLeft":i.emit("user-left",n);break;case"message":n.context&&n.context.gameUuid&&i.emit("inGame."+n.context.gameUuid,n),i.emit("newMessage."+n.roomId,n)}}),i.sendPrivateMessage=function(t,n,i){e("sendPrivateMessage",{receiver:t,message:n},i)},i.sendPrivateMessageInGame=function(t,n,i,o){e("sendPrivateMessage",{receiver:t,context:n,message:i},o)},i.sendMessage=function(t,n,o,r){return e("sendMessage",{conversationId:t,message:n,type:o},r),Handler.tracking("message","conversation",t),i},i.getConversations=function(t){return e("getConversations",{blockedUsers:blockedUserHandler.getBlockedUsers()},t),i},i.getConversation=function(t,n){return e("getConversation",{conversationId:t},n),i},i.getConversationInGame=function(t,n,o){return e("getConversationInGame",{users:[config.user().uuid,t],gameUuid:n},o),i},i.enterConversation=function(t,o){return e("enterConversation",{conversationId:t,messages:n,blockedUsers:blockedUserHandler.getBlockedUsers()},o),i},i.getPreviousMessages=function(t,o,r,a,s){return s=s||n,e("getMessages",{conversationId:t,limit:s,refMessageId:o,refMessageTimestamp:r,blockedUsers:blockedUserHandler.getBlockedUsers()},a),i},i.setLastReadMessageTimestamp=function(t,n){return e("setLastReadMessageTimestamp",{conversationId:t,lastReadMessageTimestamp:n}),i},i.blockMessagesNotificationsForConversation=function(e){o[e]?o[e]++:o[e]=1},i.unblockMessagesNotificationsForConversation=function(e){o[e]&&(1===o[e]?delete o[e]:o[e]--)},i.blockInGameMessageNotificationsFrom=function(e){t=e},i.isConversationsDisplayed=function(e,n){var i=!!o[e],r=window.settings.getBoolean("game-chat")&&t==n;return i||r},i.deleteConversation=function(t,n){e("deleteConversation",{conversationId:t},n)},i.deleteMessage=function(t,n,i,o){e("deleteMessage",{conversationId:t,id:n,timestamp:i},o)},i.conversationListHandler=new Handler.ConversationListHandler(i),i},"undefined"==typeof Chess&&(Chess={}),Chess.defaultFen="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w HAha - 0 1",Chess.colors={white:{metaData:"White",full:"white",letter:"w"},black:{metaData:"Black",full:"black",letter:"b"}},Chess.colors.both={metaData:[Chess.colors.white.metaData,Chess.colors.black.metaData],full:[Chess.colors.white.full,Chess.colors.black.full],letter:[Chess.colors.white.letter,Chess.colors.black.letter]},function(){var e={};Object.keys(Chess.colors.white).forEach(function(t){e[Chess.colors.white[t]]=Chess.colors.black[t],e[Chess.colors.black[t]]=Chess.colors.white[t]}),Chess.colors.invert=function(t){return e[t]}}(),Chess.colors.letter2full=function(e){switch(e){case Chess.colors.white.letter:return Chess.colors.white.full;case Chess.colors.black.letter:return Chess.colors.black.full}},Chess.roles={SPECTATOR:10,SPECTATOR_INVISIBLE:20,BLACK:30,WHITE:40,AUTO:50},Chess.roles.const2role=function(e){switch(parseInt(e,10)){case Chess.roles.WHITE:return"w";case Chess.roles.BLACK:return"b";case Chess.roles.SPECTATOR:return"s"}},Chess.roles.role2const=function(e){switch(e){case"w":return Chess.roles.WHITE;case"b":return Chess.roles.BLACK;case"s":return Chess.roles.SPECTATOR}},Chess.roles.roleToMeta=function(e){switch(parseInt(e,10)){case Chess.roles.WHITE:return Chess.colors.white.metaData;case Chess.roles.BLACK:return Chess.colors.black.metaData;case Chess.roles.SPECTATOR:return"Spectator"}},Chess.roles.random=function(){return Math.random()<.5?Chess.roles.WHITE:Chess.roles.BLACK},Chess.roles.inverse=function(e){return parseInt(e,10)===Chess.roles.WHITE?Chess.roles.BLACK:parseInt(e,10)===Chess.roles.BLACK?Chess.roles.WHITE:void 0},Chess.roles.isPlayer=function(e){return[Chess.roles.WHITE,Chess.roles.BLACK].contains(parseInt(e,10))},Chess.roles.isSpectator=function(e){return[Chess.roles.SPECTATOR].contains(parseInt(e,10))},Chess.elo={},Chess.elo.types={BULLET:1,BLITZ:2,CLASSICAL:3},Chess.elo.getType=function(e){var t=e.base+40*e.increment;return 180>t?Chess.elo.types.BULLET:900>t?Chess.elo.types.BLITZ:Chess.elo.types.CLASSICAL},"undefined"==typeof Chess&&(Chess={}),Chess.couchToGame=function(e){function t(t){return e.moves[t]}function n(e,t){if(t.timeUsage=e.timeUsage||0,t.timeUsageClient=e.timeUsageClient||0,void 0!==e.comment&&a.setComment(e.comment,t),void 0!==e.highlights)for(var n=0;n<e.highlights.length;n++){var i=e.highlights[n];i.square?a.addHighlight({color:i.color,square:Chess.translate.squareStringToSquare(i.square)}):i.frame?a.addHighlight({color:i.color,frame:Chess.translate.squareStringToSquare(i.frame)}):i.line?a.addHighlight({color:i.color,line:Chess.translate.canToMove(i.line)}):errorHandler.warning("unsopported highlight type during couch decoding",{highlight:i})}if(void 0!==e.glyphes&&a.setGlyphes(e.glyphes,t),void 0!==e.question&&(a.setQuestion(e.question.question,t),e.question.answers&&!Array.isArray(e.question.answers)))for(n in e.question.answers){var o=e.question.answers[n];a.getQuestion(t).addAnswer(Chess.translate.canToMove(n),o.feedback,o.correctAnswer,o.points)}}function i(){if(void 0!==r.children)for(var e=0;e<r.children.length;e++){try{var s=t(r.children[e]);a.move(s.move,void 0,!0,s.knotId);var l=a.getPositionByKnotId(s.knotId);n(s,l);var c=r;o=r.children[e],r=t(o),i(),r=c}catch(d){errorHandler.msg("critical",d,!0,{move:r.children[e]})}a.gotoParentPosition()}}var o=0,r=e.moves[o],a=new Chess.Game({ruleSet:e.ruleSet,fen:r.fen,noTimeout:!0,initialClocks:e.initialClocks,meta:e.meta}).setCheckForGameEnd(!1).setMoveMode({duringGame:{mainline:!0,sideline:!0},afterGame:{mainline:!0,sideline:!0}}).setCalcTimeSpendInThisMove(!1);return n(r,a.getStartPosition()),void 0!==e.gameStartedAt?a.gameStartedAt=e.gameStartedAt:delete a.gameStartedAt,void 0!==e.clockStartMove&&a.setClockStartMove(e.clockStartMove),i(),void 0!==e.timeGoneSinceLastMove&&(a.getEndOfMainlinePosition().moveMadeAt=Date.now()-e.timeGoneSinceLastMove),void 0!==e.endOfMainlineMoveMadeAt&&(a.getEndOfMainlinePosition().moveMadeAt=e.endOfMainlineMoveMadeAt),e.gameStatus.endedBy&&e.gameStatus.result&&a.setGameEndByPoints(e.gameStatus.result.white,e.gameStatus.result.black,e.gameStatus.endedBy),a.gotoEndOfMainline(),a},"undefined"==typeof Chess&&(Chess={}),Chess.Game=Chess.Game||function(e){var t=this;e=e||{};var n=0;Extend.Publisher(t);var i=!0,o=3,r=!0,a=e.meta||{};a.White=a.White||{},a.Black=a.Black||{};var s,l=e.noTimeout||!1,c={duringGame:{mainline:!0,sideline:!0},afterGame:{mainline:!1,sideline:!0}},d={duringGame:{mainline:!1,sideline:!0},afterGame:{mainline:!1,sideline:!0}},u=new Chess.GameStatus;t.setNoTimeout=function(e){return"boolean"!=typeof e?t:(l=e,l?clearTimeout(h):t.getClockInformation(),t)},t.getMeta=function(){return a},t.isTournamentGame=function(){var e=t.getMeta();return!!e.TournamentUUID},t.destroy=function(){t.setNoTimeout(!0).off();var e=t.getAllPositions();for(var n in e)e[n].destroy(),delete e[n];p=void 0;for(var i in t)delete t[i];t.toString=function(){return"destroyed ChessGame"}},t.setClockStartMove=function(e){return isNaN(e)||(o=parseInt(e,10)),t.getClockInformation(void 0,!0),t},t.getClockStartMove=function(){return o},t.setCalcTimeSpendInThisMove=function(e){if("boolean"==typeof e){var n=r!==e;n&&(r=e,t.getClockInformation(void 0,!0))}return t},t.getCalcTimeSpendInThisMove=function(){return r},t.getDeleteMode=function(e,n){return void 0===e&&(e=void 0===u.endedBy),void 0===n&&(n=t.isEndOfMainline()),e?n?d.duringGame.mainline:d.duringGame.sideline:n?d.afterGame.mainline:d.afterGame.sideline},t.getMoveMode=function(e,n){return void 0===e&&(e=void 0===u.endedBy),void 0===n&&(n=t.isEndOfMainline()),e?n?c.duringGame.mainline:c.duringGame.sideline:n?c.afterGame.mainline:c.afterGame.sideline},t.setMoveMode=function(e){return Object.patch(c,e),t.emit("permission.move",c),t},t.setDeleteMode=function(e){return Object.patch(d,e),t.emit("permission.delete",c),t},t.getGameStatus=function(){if(t.isOver())var e="finished";else e=0===t.getStartPosition().countChildrenMoves()?"upcoming":"running";return{result:u.result,endedBy:u.endedBy,status:e}},t.getGameStatusAsString=function(){return u.toString()},t.getListOfGameResults=function(){return u.listOfGameResults},t.getListOfGameEnds=function(){return u.listOfGameEnds},t.setGameStatus=function(e,n,i){return u.setGameEnd(e,n,i),u.result!==u.listOfGameResults.OPEN?t.setMeta("Result",u.toString()):t.setMeta("Result"),t.emit("gameStatusChanged",t.getGameStatus()),t};var h;t.checkGameHasEnded=function(e){if(t.isOver()||!e&&(!t.getCheckForGameEnd()||!t.isEndOfMainline()))return t;var n=t.getEndOfMainlinePosition();return n.isCheckMate()?"w"===n.moveRight?t.setGameStatus("BLACK_WON","CHECKMATE"):t.setGameStatus("WHITE_WON","CHECKMATE"):n.isStaleMate()?t.setGameStatus("DRAW","STALEMATE"):n.isInsufficentMaterial()?t.setGameStatus("DRAW","INSUFFICENT_MATERIAL"):n.isPositionRepetition()?t.setGameStatus("DRAW","REPETITION"):n.isActionCounterOverLimit()?t.setGameStatus("DRAW","NO_ACTION"):s.white.flagDown?n.isInsufficentMaterial("b")?t.setGameStatus("DRAW","CLOCKFLAG_VS_INSUFFICENT_MATERIAL"):t.setGameStatus("BLACK_WON","CLOCKFLAG"):s.black.flagDown?n.isInsufficentMaterial("w")?t.setGameStatus("DRAW","CLOCKFLAG_VS_INSUFFICENT_MATERIAL"):t.setGameStatus("WHITE_WON","CLOCKFLAG"):t},t.setClockInformation=function(e){return s=e,s||(s={}),s.white||(s.white={}),s.black||(s.black={}),s.white.base=parseInt(s.white.base,10)||parseInt(s.base,10)||0,s.white.incrementPerMove=parseInt(s.white.incrementPerMove,10)||parseInt(s.incrementPerMove,10)||0,s.white.flagDown=!!s.white.flagDown||!1,s.black.base=parseInt(s.black.base,10)||parseInt(s.base,10)||0,s.black.incrementPerMove=parseInt(s.black.incrementPerMove,10)||parseInt(s.incrementPerMove,10)||0,s.black.flagDown=!!s.black.flagDown||!1,t.getClockInformation(),t},t.getClockInformation=function(e,n){clearTimeout(h);var i=t.isOver();if(!n&&i)return(u.lostOnTime("white")||"CLOCKFLAG_VS_INSUFFICENT_MATERIAL"===u.endedBy&&p.endOfMainline.nextMoveIsWhite())&&(s.white.flagDown=!0,s.white.timeLeft=0),(u.lostOnTime("black")||"CLOCKFLAG_VS_INSUFFICENT_MATERIAL"===u.endedBy&&p.endOfMainline.nextMoveIsBlack())&&(s.black.flagDown=!0,s.black.timeLeft=0),t.emit("clock",s),s;if(s.white.incrementInSum=0,s.black.incrementInSum=0,s.white.usage=0,s.black.usage=0,s.runningUp=0===s.white.base&&0===s.black.base&&0===s.white.incrementPerMove&&0===s.black.incrementPerMove,t.getDepth()<o)return s.white.timeLeft=s.white.base,s.black.timeLeft=s.black.base,s;for(var a=t.getStartPosition(),c=1;o>c;c++)a=a.getChildrenMoveById(0);for(;a.childrenMoves.length;)a=a.getChildrenMoveById(0),a.isNullMove()||("b"===a.moveRight?(s.white.usage+=a.timeUsage,s.white.incrementInSum+=s.white.incrementPerMove):(s.black.usage+=a.timeUsage,s.black.incrementInSum+=s.black.incrementPerMove));if(r&&!i){for(;a.parentMove&&a.isNullMove();)a=a.parentMove;s.timeSpendInThisMove=Date.now()-a.moveMadeAt,"w"===a.moveRight?s.white.usage+=s.timeSpendInThisMove:s.black.usage+=s.timeSpendInThisMove}if(s.white.timeLeft=s.white.base+s.white.incrementInSum-s.white.usage,s.black.timeLeft=s.black.base+s.black.incrementInSum-s.black.usage,s.runningUp){if("w"===a.moveRight)var d=s.white.timeLeft;else d=s.black.timeLeft;var f=100;-21e3>d&&(f=1e3),l||(h=setTimeout(t.getClockInformation,f))}else{if("b"===a.moveRight)var g=s.white.incrementPerMove,m=0;else g=0,m=s.black.incrementPerMove;if(s.white.timeLeft<=g&&(s.white.flagDown=!0,s.white.timeLeft=0),s.black.timeLeft<=m&&(s.black.flagDown=!0,s.black.timeLeft=0),e||!s.white.flagDown&&!s.black.flagDown||t.checkGameHasEnded(),"w"===a.moveRight)var v=s.white.timeLeft;else v=s.black.timeLeft;if(v>0||void 0!==t.getMeta().Round){var f=100;v>21e3&&(f=1e3),l||(h=setTimeout(t.getClockInformation,Math.min(f,v+10)))}}return t.emit("clock",s),s},t.getNextFreeKnotId=function(){return n++},t.updateNextFreeKnotId=function(e){return n=Math.max(n,e),t},t.getAllPositions=function(){return p.all},t.getPositionByKnotId=function(e){return p.all[e]},t.move=function(e,i,o,r,a,s){t.getClockInformation();var l=t.getEndOfMainlinePosition(),d=t.getCurrentPosition();i=t.getPosition(i),"string"==typeof e&&(e=Chess.translate.canToMove(e,i)),Chess.isMove(e)||errorHandler.critical(new Error("invalid move provided to move method"),{move:e.toString(),positionToAddMove:i&&i.toString(),moveCurrentPointer:o,assignKnotId:r}),void 0===o&&(o=d===i&&i.isEndOfLine());var u=!t.isOver(),h=i===l;if("remote"!==a){if(h&&(u&&!c.duringGame.mainline||!u&&!c.afterGame.mainline)){var f=Chess.getNullMove();if(u&&!c.duringGame.sideline||!i.isLegalMove(f)||!u&&!c.afterGame.sideline)return t;var g=i.move({move:f,knotId:t.getNextFreeKnotId()});p.all[g.knotId]=g,t.setLastAddedPosition(g),t.setEndOfMainlinePosition(g),h=!1}if(!t.getMoveMode(u,h))return t}if(void 0!==r){var m=!0;if(r in p.all){var v=t.getPositionByKnotId(r);(v.parentMove!==i||v.moveCoords.can!==e.can)&&errorHandler.error(new Error("the move cannot be added, because the knotId is in use"),{move:e,positionToAddMove:i,moveCurrentPointer:o,assignKnotId:r})}n=Math.max(n,r+1)}else r=t.getNextFreeKnotId();Helper.Chess960.isMoveValidCastle(i,e.startSquare,e.endSquare,!0)?e=Helper.Chess960.getMoveWithCastleInfo(i,!0,!0):Helper.Chess960.isMoveValidCastle(i,e.startSquare,e.endSquare,!1)&&(e=Helper.Chess960.getMoveWithCastleInfo(i,!1,!0));for(var y=t.getRules(),w=0;w<y.length;w++)if(y[w].move){var b=y[w].move.call(t,e,i,r);if(void 0!==b)break}var C=b instanceof Chess.Position;if(C){p.all[r]=b,t.setLastAddedPosition(b);var k=a&&"."+a||"";h?(t.emit("move.mainline.add"+k,b),t.setEndOfMainlinePosition(b)):(g&&t.emit("move.mainline.add"+k,g),t.emit("move.sideline.add"+k,b))}else if(b=i.getChildrenMoveById(b),t.setLastAddedPosition(b),m&&r!==b.knotId){var F=b.knotId;b.knotId=r,p.all[r]=p.all[F],delete p.all[F],t.emit("position.knotId",{position:b,key:"knotId",old:F,value:r})}return a&&t.setSource(a,b),o&&t.setCurrentPosition(b),C&&!s&&(t.getClockInformation(!0),t.checkGameHasEnded()),t},t.getCurrentPosition=function(){return p.current},t.setCurrentPosition=function(e){if(e!==p.current){var n;n=e.parentMove===p.current?"next":e===p.current.parentMove?"previous":e===p.start?"start":e.isEndOfLine()?"endOfLine":"jump",p.current=e,t.emit("movedPositionPointer.current."+n,e)}return t},t.getEndOfMainlinePosition=function(e){var t=p.endOfMainline;if(e)for(;t.parentMove&&t.isNullMove();)t=t.parentMove;return t},t.getLastAddedPosition=function(){return p.lastAdded},t.setEndOfMainlinePosition=function(e){return p.endOfMainline!==e&&(p.endOfMainline=e,t.emit("movedPositionPointer.endOfMainline",e)),t},t.setLastAddedPosition=function(e){return p.lastAdded=e,t},t.getStartPosition=function(){return p.start},t.setStartPosition=function(e){p.start=e,e.reRoot(),e.knotId=0,n=1,a.FEN=e.toString();var i=t.getCurrentPosition();t.emit("movedPositionPointer.start",e);do{if(i===p.start)return t;i=i.parentMove}while(void 0!==i);return t.rebuildPositionsAll(),t.setCurrentPosition(p.start),t.setEndOfMainlinePosition(p.start.getEndOfLine()),t},t.setCheckForGameEnd=function(e){return"boolean"==typeof e&&(i=e),t},t.getCheckForGameEnd=function(){return i},t.isOver=function(){return void 0!==u.endedBy},t.hasEndedWithMove=function(){return u.hasEndedWithMove()},t.getGameEndDescription=function(){return u.getGameEndDescription()},t.getGameEndDescription=function(){return u.getGameEndDescription()},e.knotId=t.getNextFreeKnotId(),Extend.Decoratable(t,{play:[Chess.Game.decorators.standardRules],analyse:[Chess.Game.decorators.nullMove,Chess.Game.decorators.standardRules],build:[Chess.Game.decorators.freeMove]},{clear:"clearRules",add:"addRule",remove:"removeRule",get:"getRules",set:"setRules",getCurrentSetName:"getCurrentRuleSet"}),t.setRules(e.ruleSet||"play"),e.validators=t.getRules();var p={start:new Chess.Position(e),all:{}};return p.all[p.start.knotId]=p.start,p.lastAdded=p.start,p.current=p.start,p.endOfMainline=p.start,e.fen&&(a.FEN=p.start.toString()),t.gameStartedAt=Date.now(),t.setClockInformation(e.initialClocks),t},Chess.Game.prototype.getPosition=function(e){return void 0===e?e=this.getCurrentPosition():"number"==typeof e&&(e=this.getPositionByKnotId(e)),e},Chess.Game.prototype.moveLan=function(e,t,n,i,o,r){return t=this.getPosition(t),this.move(Chess.translate.lanToMove(e,t),t,n,i,o,r)},Chess.Game.prototype.moveSep=function(e,t,n,i,o,r){return t=this.getPosition(t),this.move(Chess.translate.sepToMove(e,t),t,n,i,o,r)},Chess.Game.prototype.moveSan=function(e,t,n,i,o,r){return t=this.getPosition(t),this.move(Chess.translate.sanToMove(e,t),t,n,i,o,r)},Chess.Game.prototype.moveAtEndOfMainline=function(e,t,n,i,o){return this.move(e,this.getEndOfMainlinePosition(),t,n,i,o),this},Chess.Game.prototype.getDepth=function(){return this.getStartPosition().getDepth()},Chess.Game.prototype.abortOrResign=function(e){return"w"!==e&&"b"!==e&&errorHandler.error(new Error('this method only accepts "w" or "b"')),this.getDepth()<this.getClockStartMove()?(this.setGameStatus("OPEN","ABORTED"),this):(this.setGameStatus("w"===e?"BLACK_WON":"WHITE_WON","RESIGN"),this)},Chess.Game.prototype.gotoEndOfMainline=function(){return this.setCurrentPosition(this.getEndOfMainlinePosition()),this},Chess.Game.prototype.gotoLastAddedPosition=function(){return this.setCurrentPosition(this.getLastAddedPosition()),this},Chess.Game.prototype.link=function(e,t){return e.addGame(t,this),this},Chess.Game.prototype.getGlyphes=function(e){return this.getPosition(e).getGlyphes()},Chess.Game.prototype.hasGlyph=function(e,t){return this.getGlyphes(t).contains(e)},Chess.Game.prototype.toggleGlyph=function(e,t){return this[(this.hasGlyph(e,t)?"remove":"add")+"Glyph"](e,t)},Chess.Game.prototype.addGlyph=function(e,t){return t=this.getPosition(t),t.addGlyph(e),this.emit("position.glyph"+(t===this.getCurrentPosition()?".current":""),{key:"glyphes",position:t,value:t.getGlyphes()}),this},Chess.Game.prototype.setGlyphes=function(e,t){return t=this.getPosition(t),t.setGlyphes(e),this.emit("position.glyph"+(t===this.getCurrentPosition()?".current":""),{key:"glyphes",position:t,value:t.getGlyphes()}),this},Chess.Game.prototype.removeGlyph=function(e,t){return t=this.getPosition(t),t.removeGlyph(e),this.emit("position.glyph"+(t===this.getCurrentPosition()?".current":""),{key:"glyphes",position:t,value:t.getGlyphes()}),this},Chess.Game.prototype.getChat=function(e){return this.getPosition(e).getChat()},Chess.Game.prototype.addChat=function(e,t,n,i){void 0===i&&(i=this.getEndOfMainlinePosition(!0)),i=this.getPosition(i)||this.getEndOfMainlinePosition(!0);var o=i.addChat(e,t,n);return o&&this.emit("position.chat"+(i===this.getCurrentPosition()?".current":""),{key:"chat",position:i,value:o}),o},Chess.Game.prototype.setTimeUsage=function(e,t){return t=this.getPosition(t),t.timeUsage=e,this.emit("position.timeUsage",{key:"timeUsage",position:t,value:e}),this.getClockInformation(void 0,!0),this},Chess.Game.prototype.getTimeUsage=function(e){return e=this.getPosition(e),e.timeUsage},Chess.Game.prototype.setSource=function(e,t){return t=this.getPosition(t),t.setSource(e)&&this.emit("position.source"+(t===this.getCurrentPosition()?".current":""),{key:"source",position:t,value:e}),this},Chess.Game.prototype.getEngine=function(e,t,n,i){return e=this.getPosition(e),e.getEngine(t,n,i)},Chess.Game.prototype.setComment=function(e,t){return t=this.getPosition(t),e?t.comment=e:delete t.comment,this.emit("position.comment"+(t===this.getCurrentPosition()?".current":""),{key:"comment",position:t,value:e}),this},Chess.Game.prototype.getComment=function(e){return e=this.getPosition(e),e.comment},Chess.Game.prototype.gotoStart=function(){return this.setCurrentPosition(this.getStartPosition()),this},Chess.Game.prototype.isEndOfLine=function(){return this.getCurrentPosition().isEndOfLine()},Chess.Game.prototype.isEndOfMainline=function(){return this.getCurrentPosition()===this.getEndOfMainlinePosition()},Chess.Game.prototype.gotoEndOfLine=function(e){var t=this.getCurrentPosition().getEndOfLine();if(e)for(;t.parentMove&&t.isNullMove();)t=t.parentMove;return this.setCurrentPosition(t),this},Chess.Game.prototype.getTitle=function(){var e=this.getMeta()||{Title:""};return e.Title.replace(/\{([^}]+)\}/g,function(t){return e[t.replace(/[\{\}]/g,"")]||"{"+t+"}"})},Chess.Game.prototype.getQuestion=function(e){return e=this.getPosition(e),e.getQuestion()},Chess.Game.prototype.setQuestion=function(e,t){return t=this.getPosition(t),t.setQuestion(e),this},Chess.Game.prototype.setHighlights=function(e,t,n){var i=this.getPosition(t);return i.setHighlights(e),n!==!0&&this.emit("position.highlights"+(i===this.getCurrentPosition()?".current":""),e),this},Chess.Game.prototype.getHighlights=function(e){var t=this.getPosition(e);return t.getHighlights()},Chess.Game.prototype.addHighlight=function(e,t,n){var i=this.getPosition(t);return i.addHighlight(e),n!==!0&&this.emit("position.highlights"+(i===this.getCurrentPosition()?".current":""),i.getHighlights()),this},Chess.Game.prototype.deleteHighlight=function(e,t,n){var i=this.getPosition(t);return i.deleteHighlight(e),n!==!0&&this.emit("position.highlights"+(i===this.getCurrentPosition()?".current":""),i.getHighlights()),this},Chess.Game.prototype.deleteHighlightsByType=function(e,t,n){var i=this.getPosition(t);return i.deleteHighlightsByType(e),n!==!0&&this.emit("position.highlights"+(i===this.getCurrentPosition()?".current":""),i.getHighlights()),this},Chess.Game.prototype.gotoId=function(e){var t=this.getPositionByKnotId(e);return t&&this.setCurrentPosition(t),this},Chess.Game.prototype.gotoChildrenPositionById=function(e){var t=this.getCurrentPosition().getChildrenMoveById(e);return t&&this.setCurrentPosition(t),this},Chess.Game.prototype.gotoNextPosition=function(e){for(var t=this.getCurrentPosition(),n=t.countChildrenMoves(),i=0;n>i;i++){for(var o=t.getChildrenMoveById(i);e&&o&&o.isNullMove();)o=o.getChildrenMoveById(0);if(o&&!o.isNullMove())break}return o?(this.setCurrentPosition(o),this):this},Chess.Game.prototype.countChildrenMoves=function(e){return this.getCurrentPosition().countChildrenMoves(e)},Chess.Game.prototype.gotoParentPosition=function(){var e=this.getCurrentPosition();return void 0!==e.parentMove&&this.setCurrentPosition(e.parentMove),this},Chess.Game.prototype.getMoveRight=function(){return this.getCurrentPosition().moveRight},Chess.Game.prototype.toString=function(e){return this.getCurrentPosition().toString(e)},Chess.Game.prototype.toAscii=function(){return this.getCurrentPosition().toAscii()},Chess.Game.prototype.setTimeUsageForLastAddedPosition=function(e){return this.setTimeUsage(e,this.getLastAddedPosition())},Chess.Game.prototype.disconnectTimeout=function(e,t){if("w"!==e&&"b"!==e&&errorHandler.error(new Error('this method only accepts "w" or "b"')),this.getDepth()>2){var n=Chess.colors.invert(e);if(n&&this.getEndOfMainlinePosition().isInsufficentMaterial(n))return this.setGameStatus("DRAW","DISCONNECT_VS_INSUFFICENT_MATERIAL"),this;var i="w"===e?"BLACK_WON":"WHITE_WON";return this.setGameStatus(i,"DISCONNECT_TIMEOUT"),this}return t?this:(this.setGameStatus("OPEN","ABORTED"),this)},Chess.Game.prototype.reOpen=function(){return this.setGameStatus(void 0,void 0,!0),this},Chess.Game.prototype.getType=function(){var e=this.getClockInformation(),t=Math.max(e.white.base,e.black.base)+40*Math.max(e.white.incrementPerMove,e.black.incrementPerMove);return 0===t?"Classical":18e4>t?"Bullet":9e5>t?"Blitz":"Classical"},Chess.Game.prototype.getTimeout=function(e){void 0===e&&(e=this.getDepth()<=2);var t=this.getClockInformation(),n=Math.max(t.white.base,t.black.base)+40*Math.max(t.white.incrementPerMove,t.black.incrementPerMove);return 1e3*Math.round(Math.min(12e4,Math.max(2e4,2200*Math.sqrt(n/1e3)))/1e3)},Chess.Game.prototype.rebuildPositionsAll=function(){var e=this.getStartPosition(),t=[e].concat(e.getAllChildrenInSubtree()),n=this.getAllPositions();for(var i in n)delete n[i];for(var o=0;o<t.length;o++){var r=t[o];n[r.knotId]=r}return this},Chess.Game.prototype.getSnapshot=function(e){e=e||4;for(var t=[],n=this.getEndOfMainlinePosition(),i=0;e>i&&void 0!==n;i++){var o=n.getCan();if(void 0===o)break;t.unshift(o),n=n.parentMove}var r=n&&n.toString()||this.getStartPosition().toString();return{moves:t,fen:r}},Chess.Game.prototype.setMeta=function(e,t){if("string"==typeof e){var n=e;e={},e[n]=t}var i=this.getMeta();return Object.patch(i,e),this.emit("meta",{meta:i,diff:e}),this},Chess.Game.prototype.setGameEndByPoints=function(e,t,n,i){var o=this.getListOfGameResults();if(e===o.DRAW.white&&t===o.DRAW.black)var r="DRAW";else r=e===o.WHITE_WON.white&&t===o.WHITE_WON.black?"WHITE_WON":e===o.BLACK_WON.white&&t===o.BLACK_WON.black?"BLACK_WON":"OPEN";return this.setGameStatus(r,n,i)},Chess.Game.prototype.promote=function(e){return e=this.getPosition(e),e.promote(),this.setEndOfMainlinePosition(this.getStartPosition().getEndOfLine()),this.emit("move.promote",e),this},Chess.Game.prototype.deleteMove=function(e,t){if(!t&&!this.getDeleteMode())return this;e=this.getPosition(e);var n=e.getAllChildrenInSubtree();n.push(e);var i=n.contains(this.getCurrentPosition()),o=n.contains(this.getLastAddedPosition()),r=e.isInMainline(),a=e.deleteMove();if(!a)return this;var s=e.parentMove.childrenMoves;if(1===s.length){var l=s[0];l.moveCoords.isNullMove()&&this.deleteMove(l,!0)}if(a===!1)return this;for(var c=0;c<n.length;c++)delete this.getAllPositions()[n[c].knotId];return i&&this.setCurrentPosition(a),r&&this.setEndOfMainlinePosition(this.getStartPosition().getEndOfLine()),o&&this.setLastAddedPosition(this.getEndOfMainlinePosition()),this.emit("move."+(r?"main":"side")+"line.delete",e),this},Chess.Game.prototype.getDistanceToStartPosition=function(e){e=this.getPosition(e);for(var t=this.getStartPosition(),n=0;e&&e!==t;)n++,e=e.parentMove;return n},Chess.Game.validators={nullMove:function(e){return e.isNullMove()||void 0},standardRules:function(e){return this.checkMove(e)||void 0},freeMove:function(){return!0}},Chess.Game.decorators={nullMove:{moveValidator:Chess.Game.validators.nullMove},standardRules:{moveValidator:Chess.Game.validators.standardRules,move:function(e,t,n){return t.move({move:e,knotId:n})}},freeMove:{moveValidator:Chess.Game.validators.freeMove,move:function(e,t){t.setPiece(e.y2,e.x2,t.getPiece(e.y1,e.x1)),t.setPiece(e.y1,e.x1,"-");var n=new Chess.Position({fen:t.toString(!0),validators:this.getRules()});return n.setHighlights(t.getHighlights()),this.setStartPosition(n),this.gotoStart(),n}}},"undefined"==typeof Chess&&(Chess={}),Chess.chessGameDiff=function(e,t){function n(e,t){function n(e,t,n){void 0===n&&(n=[]),n.push("comment","timeUsage","getGlyphes()","getHighlights()");for(var i={},r={},a={},s={},l=0;l<n.length;l++)if("getGlyphes()"===n[l]){var c=e.getGlyphes(),d=t.getGlyphes();c.compare(d)||(s.glyphes=d)}else if("getHighlights()"===n[l]){var c=e.getHighlights(),d=t.getHighlights(),u=Object.diff(c,d);u&&Object.getLength(u)&&(s.highlights=d)}else r[n[l]]=e[n[l]],a[n[l]]=t[n[l]];i=Object.diff(r,a);for(var h in s)i[h]=s[h];Object.keys(i).length&&(e.knotId!==t.knotId&&errorHandler.msg("error",new Error("knotIds for old and new positions are not the same"),!0,{oldPositionKnotId:e.knotId,newPositionKnotId:t.knotId,oldPositionMove:e.getCan(),newPositionMove:t.getCan()}),i.knotId=e.knotId,o.push({command:"updateMove",data:i}))}function i(e,t){var r=[];if(void 0!==e)for(var a=0;a+r.length<e.childrenMoves.length;a++){var s=e.childrenMoves[a+r.length];if(t)var l=t.childrenMoves[a];void 0===l||s.getCan()!==l.getCan()?(o.push({command:"removeMove",data:{knotId:s.knotId}}),r.push(a--)):n(s,l)}if(s=void 0,l=void 0,void 0!==t)for(var a=0;a<t.childrenMoves.length;a++){for(var c=0,d=0;d<r.length;d++)r[d]<=a&&c++;if(e)var s=e.childrenMoves[a+c];var l=t.childrenMoves[a];if(void 0===s){var u=l.getGlyphes(),h={command:"addMove",data:Object.removeUndefined({parentId:t.knotId,move:l.getCan(),knotId:l.knotId,comment:l.comment,glyphes:u.length?u:void 0,mainline:l.isInMainline()?!0:void 0,timeUsage:l.timeUsage})};o.push(h)}i(s,l)}}var o=[],r=e.getStartPosition(),a=t.getStartPosition();return n(r,a),i(r,a),o}function i(e){return{result:e.result,endedBy:e.endedBy}}function o(e,t){function n(e,t){t.knotId=e.knotId;for(var i=e.countChildrenMoves(),o=0;i>o;o++){var r=e.getChildrenMoveById(o),a=t.getChildrenMoveByMove(r.moveCoords);a!==!1&&n(r,a)}}var i=e.getStartPosition(),o=t.getStartPosition();n(i,o),t.rebuildPositionsAll()}function r(e,t){var n=Object.diff(e,t);return 1===Object.keys(n).length&&void 0!==n.Result?{}:n}var a=[];if(void 0===t)a.push({command:"removeGame"});else if(void 0===e)a.push({command:"addGame",data:Chess.gameToCouch(t,["timeGoneSinceLastMove","fen"])});else{o(e,t),e.getStartPosition().toString()!==t.getStartPosition().toString()&&(a.push({
command:"rebuildGame",data:t.getStartPosition().toString()}),e=new Chess.Game({fen:t.getStartPosition().toString()}));var s=r(e.getMeta(),t.getMeta());Object.keys(s).length&&a.push({command:"metaChanged",data:s});var l=Object.diff(i(e.getGameStatus()),i(t.getGameStatus()));Object.keys(l).length&&a.push({command:"resultChanged",data:l});var c=n(e,t);Object.keys(c).length&&a.pushArray(c)}return a},"undefined"==typeof Chess&&(Chess={}),Chess.GameHandler=function(){function e(e,t){var i=t.oldGame,o=t.newGame,r=n.getKeyForGame(i);if(r===n.currentKey)var a=!0;n.addGame(r,o),a&&n.setCurrentGame(r)}function t(e,t){n.emit(e.channel,t)}var n=this;return n.games={},n.currentKey,Extend.Publisher(n),n.getCurrentGame=function(){return void 0===n.currentKey&&0===Object.keys(n.games).length&&n.addGame(void 0,new Chess.Game),n.games[n.currentKey]},n.hasGame=function(e){return void 0!==n.games[e]&&n.games[e]instanceof Chess.Game},n.getGame=function(e){return n.games[e]},n.getGameKeys=function(){return Object.keys(n.games)},n.getCurrentGameKey=function(){return n.currentKey},n.addGame=function(t,i){return void 0===t?t="default":"number"==typeof t&&(t=t.toString()),t in n.games&&n.removeGame(t),n.games[t]=i,i.on("replaceChessGame",e),1===Object.keys(n.games).length&&n.setCurrentGame(t),n},n.removeGame=function(i){return i instanceof Chess.Game&&(i=n.getKeyForGame(i)),"number"==typeof i&&(i=i.toString()),"string"!=typeof i&&errorHandler.msg("warning",new Error("The chessGame you want to remove, can't be found"),!0,{removeGame:i}),void 0!==n.games[i]&&(n.games[i].off("*",t),n.games[i].off("replaceChessGame",e),delete n.games[i],i===n.currentKey&&(n.currentKey=void 0)),n},n.getKeyForGame=function(e){for(var t in n.games)if(n.games[t]===e)return t},n.setCurrentGame=function(e){return e instanceof Chess.Game&&(e=n.getKeyForGame(e)),"number"==typeof e&&(e=e.toString()),e===n.currentKey?n:(("string"!=typeof e||void 0===n.games[e])&&errorHandler.msg("warning",new Error("The chessGame you want to set current, can't be found"),!0,{oldKey:n.currentKey,newKey:e}),void 0!==n.games[n.currentKey]&&n.games[n.currentKey].off("*",t),n.currentKey=e.toString(),n.games[n.currentKey].on("*",t),n.emit("currentGameChanged",n.games[n.currentKey]),n)},n.initProxy=function(){for(var e=["abortOrResign","addGlyph","addChat","addHighlight","addRule","checkGameHasEnded","clearRules","countChildrenMoves","deleteHighlight","deleteHighlightsByType","deleteMove","disconnectTimeout","draw","getAllPositions","getCalcTimeSpendInThisMove","getCheckForGameEnd","getClockInformation","getClockStartMove","getChat","getComment","getCurrentPosition","getCurrentRuleSet","getDeleteMode","getDepth","getEndOfMainlinePosition","getEngine","getGameEndDescription","getGameStatus","getGameStatusAsString","getGlyphes","getHighlights","getLastAddedPosition","getListOfGameEnds","getListOfGameResults","getMeta","getMoveMode","getMoveRight","getNextFreeKnotId","getPositionByKnotId","getQuestion","getStartPosition","getRules","getTimeout","getTitle","getType","gotoChildrenPositionById","gotoEndOfLine","gotoEndOfMainline","gotoId","gotoLastAddedPosition","gotoNextPosition","gotoParentPosition","gotoStart","hasGlyph","isEndOfLine","isEndOfMainline","isOver","move","moveAtEndOfMainline","moveLan","moveSan","moveSep","promote","removeGlyph","reOpen","setCalcTimeSpendInThisMove","setCheckForGameEnd","setClockStartMove","setComment","setCurrentPosition","setGameEndByPoints","setGameStatus","setGlyphes","setHighlights","setMeta","removeRule","setDeleteMode","setMoveMode","setQuestion","setRules","setStartPosition","setTimeUsage","setTimeUsageForLastAddedPosition","toAscii","toggleGlyph","toString","updateNextFreeKnotId"],t=0;t<e.length;t++)!function(e){n[e]=function(){var t=n.getCurrentGame(),i=t[e].apply(t,arguments);return i===t?n:i}}(e[t])},n.initProxy(),n},"undefined"==typeof Chess&&(Chess={}),Chess.gamePatch=function(e,t){function n(t,n){switch(t){case"metaChanged":e.setMeta(n);break;case"resultChanged":var i=n.endedBy;null===i&&(i=void 0),e.setGameEndByPoints(n.result.white,n.result.black,i,!0);break;case"removeGame":break;case"addGame":break;case"addMove":e.move(n.move,n.parentId,void 0,n.knotId,"remote",!0),void 0!==n.timeUsage&&e.setTimeUsage(n.timeUsage,n.knotId),void 0!==n.comment&&e.setComment(n.comment,n.knotId),!e.getCalcTimeSpendInThisMove()&&e.getStartPosition().countChildrenMoves()>0&&e.setCalcTimeSpendInThisMove(!0).getClockInformation();for(var o=e.getLastAddedPosition();n.mainline&&!o.isInMainline();)e.promote(o);for(var r=o.parentMove.childrenMoves,a=r.length-1;a>=0;a--){var s=r[a];s.moveCoords.isNullMove()&&e.deleteMove(s,!0)}if(o.countChildrenMoves()>0){var l=e.getNextFreeKnotId();e.move(Chess.getMove(0,0,0,0),o,void 0,l,"remote",!0),e.promote(l)}break;case"rebuildGame":e.setStartPosition(new Chess.Position({fen:n}));break;case"updateMove":void 0!==n.glyphes&&e.setGlyphes(n.glyphes,n.knotId),void 0!==n.comment&&(null===n.comment?e.setComment(void 0,n.knotId):e.setComment(n.comment,n.knotId)),void 0!==n.highlights&&(n.highlights.forEach(function(e){e.frame&&(e.frame=Chess.getSquare(e.frame.y,e.frame.x)),e.square?e.square=Chess.getSquare(e.square.y,e.square.y):e.line&&(e.line=Chess.getMove(e.line.y1,e.line.x1,e.line.y2,e.line.x2))}),e.setHighlights(n.highlights,n.knotId)),void 0!==n.timeUsage&&e.setTimeUsage(n.timeUsage,n.knotId);break;case"removeMove":e.deleteMove(n.knotId,!0),0===e.getStartPosition().countChildrenMoves()&&e.setCalcTimeSpendInThisMove(!1)}}for(var i=0;i<t.length;i++){var o=t[i].command,r=t[i].data;n(o,r)}},"undefined"==typeof Chess&&(Chess={}),Chess.GameStatus=function(e,t){return this.setGameEnd(e,t,!0),this},Chess.GameStatus.prototype.setGameEnd=function(e,t,n){return(void 0!==t&&!this.listOfGameEnds.contains(t)||void 0!==e&&!Object.has(this.listOfGameResults,e))&&errorHandler.msg("critical",new Error("illegal game end"),!0,{triedGameEnd:t,result:e}),(n||!this.result||this.result===this.listOfGameResults.OPEN)&&(e?this.result=this.listOfGameResults[e]:this.result=this.listOfGameResults.OPEN),e&&!t&&(t=Chess.GameStatus.defaultEndedBy[e]),(n||!this.endedBy)&&(this.endedBy=t),this},Chess.GameStatus.prototype.toString=function(){return Chess.GameStatus.resultToString(this.result).replace("1/2-1/2","½-½")},Chess.GameStatus.prototype.lostOnTime=function(e){return this.listOfClockGameEnds.contains(this.endedBy)&&(0===this.result.black&&"black"===e||0===this.result.white&&"white"===e)?!0:!1},Chess.GameStatus.prototype.hasEndedWithMove=function(){return this.listOfEndedWithMoveGameEnds.contains(this.endedBy)},Chess.GameStatus.defaultEndedBy={WHITE_WON:"RESIGN",BLACK_WON:"RESIGN",DRAW:"DRAW_AGREED"},Chess.GameStatus.defaultEndedBy["1-0"]=Chess.GameStatus.defaultEndedBy.WHITE_WON,Chess.GameStatus.defaultEndedBy["1/2-1/2"]=Chess.GameStatus.defaultEndedBy.DRAW,Chess.GameStatus.defaultEndedBy["0-1"]=Chess.GameStatus.defaultEndedBy.BLACK_WON,Chess.GameStatus.listOfGameResults=Chess.GameStatus.prototype.listOfGameResults={WHITE_WON:{white:1,black:0},BLACK_WON:{white:0,black:1},DRAW:{white:.5,black:.5},OPEN:{white:void 0,black:void 0}},Chess.GameStatus.listOfGameResults["1-0"]=Chess.GameStatus.listOfGameResults.WHITE_WON,Chess.GameStatus.listOfGameResults["1/2-1/2"]=Chess.GameStatus.listOfGameResults.DRAW,Chess.GameStatus.listOfGameResults["0-1"]=Chess.GameStatus.listOfGameResults.BLACK_WON,Chess.GameStatus.listOfGameResults["*"]=Chess.GameStatus.listOfGameResults.OPEN,Chess.GameStatus.gameEndDescriptions={CHECKMATE:"Checkmate",RESIGN:"Ended by resign",CLOCKFLAG:"Clockflag",CLOCKFLAG_VS_INSUFFICENT_MATERIAL:"Clockflag vs. insufficent material",DRAW_AGREED:"Draw agreed",INSUFFICENT_MATERIAL:"Insufficent material",REPETITION:"Position repeated 3 times",NO_ACTION:"No pawn moves or no capture in 50 moves",STALEMATE:"Stalemate",BOTH_FLAGS_DOWN:"Clockflag for both players",ABORTED:"Game aborted",DISCONNECT_TIMEOUT:"One player failed to reconnect on time",TOURNAMENT_NO_SHOW:"Player failed to start on time",TOURNAMENT_WITHDRAW:"Player left the tournament",TOURNAMENT_BYE:"Player was given a bye"},Chess.GameStatus.prototype.getGameEndDescription=function(){return Chess.GameStatus.gameEndDescriptions[this.endedBy]},Chess.GameStatus.prototype.listOfClockGameEnds=["CLOCKFLAG","CLOCKFLAG_VS_INSUFFICENT_MATERIAL","BOTH_FLAGS_DOWN"],Chess.GameStatus.prototype.listOfEndedWithMoveGameEnds=["CHECKMATE","INSUFFICENT_MATERIAL","REPETITION","NO_ACTION","STALEMATE"],Chess.GameStatus.prototype.listOfGameEnds=["CHECKMATE","RESIGN","CLOCKFLAG","CLOCKFLAG_VS_INSUFFICENT_MATERIAL","DISCONNECT_VS_INSUFFICENT_MATERIAL","DRAW_AGREED","INSUFFICENT_MATERIAL","REPETITION","NO_ACTION","STALEMATE","BOTH_FLAGS_DOWN","ABORTED","DISCONNECT_TIMEOUT","TOURNAMENT_WITHDRAW","TOURNAMENT_NO_SHOW","TOURNAMENT_BYE"],Chess.GameStatus.resultToString=function(e){return!e||e.white===Chess.GameStatus.listOfGameResults.OPEN.white&&e.black===Chess.GameStatus.listOfGameResults.OPEN.black?"*":parseFloat(e.white)===Chess.GameStatus.listOfGameResults.DRAW.white&&parseFloat(e.black)===Chess.GameStatus.listOfGameResults.DRAW.black?"1/2-1/2":parseInt(e.white,10)===Chess.GameStatus.listOfGameResults.WHITE_WON.white&&parseInt(e.black,10)===Chess.GameStatus.listOfGameResults.WHITE_WON.black?"1-0":parseInt(e.white,10)===Chess.GameStatus.listOfGameResults.BLACK_WON.white&&parseInt(e.black,10)===Chess.GameStatus.listOfGameResults.BLACK_WON.black?"0-1":void 0},Chess.GameStatus.stringToResult=function(e){return Chess.GameStatus.listOfGameResults[e]},"undefined"==typeof Chess&&(Chess={}),Chess.gameToContent=function(e){function t(e){var t=e.getSan(),n=e.knotId,i=e.getGlyphes(),o=e.getDistanceToMainline(),r=e.comment||"";return r.length&&(r+=" "),0===i.length&&(i=[0]),"[["+n+"]["+t+"]["+i.join(" ")+"]["+o+"]] "+r}function n(r){var a="";e.setCurrentPosition(r);var s=e.countChildrenMoves();if(0===s)return a;var l="",c="";if("w"===r.moveRight?l=r.moveCounter+". ":c=r.moveCounter+"... ",o&&(a+=c),a+=l+t(r.getChildrenMoveById(0)),o=!1,s>1)for(var d=1;s>d;d++){var u=i.openSideline+c+l+t(r.getChildrenMoveById(d))+n(r.getChildrenMoveById(d));a=a.replace(/^ +/,"").replace(/ +$/,"")+u.replace(/^ +/,"").replace(/ +$/,"")+i.closeSideline+" ",o=!0}return a+n(r.getChildrenMoveById(0))}e instanceof Chess.Game||errorHandler.msg("critical",new Error('Chess.gameToCouch: required parameter "chessGame" is missing or not an object'),!0,{chessGame:e});var i={openSideline:"\n",closeSideline:"\n"},o=!0,r=e.getStartPosition().comment;return void 0===r?r="":r+=" ",(r+n(e.getStartPosition())).replace(/^ +/,"").replace(/ +$/,"")},"undefined"==typeof Chess&&(Chess={}),Chess.gameToCouch=function(e,t){function n(e){var t=a.indexOf(e);return a.contains(e)?t:a.push(e)-1}function i(a){var s={};n(a.knotId);var l=a.getCan();void 0!==l&&(t.contains("move")||(s.move=l),t.contains("timeUsage")||(s.timeUsage=a.timeUsage),t.contains("timeUsageClient")||(s.timeUsageClient=a.timeUsageClient)),(!t.contains("fen")||r===a&&a.toString()!==Chess.defaultFen)&&(s.fen=a.toString()),void 0===a.comment||t.contains("comment")||(s.comment=a.comment);var c=e.getHighlights(a);if(void 0!==c&&c.length&&!t.contains("highlights")){s.highlights=[];for(var d=0;d<c.length;d++){var u=c[d];u.temporary||(u.square?s.highlights.push({color:u.color,frame:u.square.toString()}):u.frame?s.highlights.push({color:u.color,frame:u.frame.toString()}):u.line?s.highlights.push({color:u.color,line:u.line.toString()}):errorHandler.warning("unsopported highlight type during couch encoding",{highlight:u}))}0==s.highlights.length&&delete s.highlights}if(!t.contains("glyphes")&&a.hasGlyphes()&&(s.glyphes=a.getGlyphes()),void 0===a.question||t.contains("question")||(s.question={question:a.question.question,answers:a.question.getAnswer()}),t.contains("knotId")||(s.knotId=a.knotId),o.moves.push(s),!t.contains("childrenMoves")&&a.childrenMoves.length){s.children=[];for(var d=0;d<a.childrenMoves.length;d++)s.children.push(n(a.childrenMoves[d].knotId)),i(a.childrenMoves[d])}return o}var o={};e instanceof Chess.Game||errorHandler.msg("critical",new Error('Chess.gameToCouch: required parameter "chessGame" is missing or not an object'),!0,{chessGame:e}),t||(t=[]);var r=e.getStartPosition(),a=[],s=e.getGameStatus();o.gameStatus=s,o.ruleSet=e.getCurrentRuleSet(),o.meta=e.getMeta(),o.clockStartMove=e.getClockStartMove(),t.contains("gameStartedAt")||(o.gameStartedAt=e.gameStartedAt),t.contains("endOfMainlineMoveMadeAt")||(o.endOfMainlineMoveMadeAt=e.getEndOfMainlinePosition().moveMadeAt),s.result!==e.getListOfGameResults().OPEN||t.contains("timeGoneSinceLastMove")||(o.timeGoneSinceLastMove=Date.now()-e.getEndOfMainlinePosition().moveMadeAt);var l=e.getClockInformation();return(l.white.base||l.white.incrementPerMove||l.black.base||l.black.incrementPerMove)&&(o.initialClocks={white:{base:l.white.base,incrementPerMove:l.white.incrementPerMove},black:{base:l.black.base,incrementPerMove:l.black.incrementPerMove}}),o.moves=[],i(r),Object.copy(o)},"undefined"==typeof Chess&&(Chess={}),function(){function e(e){for(var t,n=e.split(" "),i="",o="";t=n.shift();)i.length+t.length<=80?i+=(i.length?" ":"")+t:(o+=i+"\n",i=t);return o+i}Chess.gameToPgn=function(t,n,i){function o(e){for(var n=e,i=e.timeUsage||0,o=t.getClockInformation()["b"===e.moveRight?"white":"black"],r=o.incrementPerMove||0;(n=n.parentMove)&&(n=n.parentMove)&&t.getDistanceToStartPosition(n)>=h;)i+=n.timeUsage||0,r+=o.incrementPerMove;var a=o.base-i+r;if(a>=0){var s=Date.getSplitedTime(a);return"[%clk "+s.hours+":"+s.minutes.toString().lpad("0",2)+":"+s.seconds.toString().lpad("0",2)+"]"}return""}function r(e){for(var i=e.getSan(),r=e.getGlyphes(),a="",s=0;s<r.length;s++)a+="$"+r[s]+" ";if(void 0===e.comment)var l="";else l=e.comment;return n&&e.isInMainline()&&t.getDistanceToStartPosition(e)>=h&&(l+=o(e)),l.length&&(l="{"+l+"} "),i+" "+a+l}function a(e){var n="";t.setCurrentPosition(e);var i=t.countChildrenMoves();if(0===i)return n;var o="",s="";if("w"===e.moveRight?o=e.moveCounter+". ":s=e.moveCounter+"... ",c&&(n+=s),n+=o+r(e.getChildrenMoveById(0)),c=!1,i>1)for(var d=1;i>d;d++){var u=l.openSideline+s+o+r(e.getChildrenMoveById(d))+a(e.getChildrenMoveById(d));n=n.replace(/^ +/,"").replace(/ +$/,"")+" "+u.replace(/^ +/,"").replace(/ +$/,"")+l.closeSideline+" ",c=!0}return n+a(e.getChildrenMoveById(0))}function s(e){var t=e.toLowerCase(),n=e;return"fen"===t&&(n="FEN"),"FEN"===n&&f[e]===Chess.defaultFen?"":"["+n+' "'+f[e]+'"]\n'}t instanceof Chess.Game||errorHandler.msg("critical",new Error('Chess.gameToPgn: required parameter "chessGame" is missing or not an object'),!0,{chessGame:t});var l={openSideline:"(",closeSideline:")"};i=i||[];for(var c=!0,d="",u=t.getMeta(),h=t.getClockStartMove(),p=["White","Black"],f=Object.without(u,p),g=0;g<p.length;g++)for(var m in u[p[g]])"Name"===m?f[p[g]]=u[p[g]][m]:f[p[g]+m]=u[p[g]][m];var v=t.getGameStatusAsString().replace("½-½","1/2-1/2");f.Result=v;var y={Event:"?",Site:"?",Date:"????.??.??",Round:"?",White:"?",Black:"?"};for(var w in y)void 0===f[w]&&(f[w]=y[w]);for(var b=["Event","Site","Date","Round","White","Black","Result"],m=0;m<b.length;m++)w=b[m],void 0!==f[w]&&(d+=s(w),delete f[w]);for(w in f)f[w]&&!i.contains(w)&&(d+=s(w));d+="\n";var C=t.getStartPosition().comment;return C=void 0===C?"":"{"+C+"} ",d+C+e(a(t.getStartPosition())+v).replace(/^ +/,"").replace(/ +$/,"")}}(),"undefined"==typeof Chess&&(Chess={}),function(){function e(){return{move:{1:{symbol:"!",title:"good move"},3:{symbol:"!!",title:"very good move"},5:{symbol:"!?",title:"speculative move"},2:{symbol:"?",title:"poor move"},4:{symbol:"??",title:"very poor move"},6:{symbol:"?!",title:"questionable move"}},position:{14:{symbol:"⩲",title:"White has a slight advantage"},16:{symbol:"±",title:"White has a moderate advantage"},18:{symbol:"+-",title:"White has a decisive advantage"},15:{symbol:"⩱",title:"Black has a slight advantage"},17:{symbol:"∓",title:"Black has a moderate advantage"},19:{symbol:"-+",title:"Black has a decisive advantage"},11:{symbol:"=",title:"Equal position"},13:{symbol:"∞",title:"Unclear position"},44:{symbol:"=/∞",title:"With compensation"}},other:{146:{symbol:"N",title:"New Move"},138:{symbol:"⊕",title:"Time trouble"},36:{symbol:"↑",title:"Initiative"},40:{symbol:"→",title:"Attack"},32:{symbol:"↑↑",title:"Development advantage"},132:{symbol:"⇄",title:"Counterplay"},22:{symbol:"⊙",title:"Zugzwang"},8:{symbol:"□",title:"Singular move"}}}}function t(){return Object.merge.apply(void 0,Object.values(Chess.Glyphes.getByCategory()))}Chess.Glyphes={};var n,i,o={move:!0,position:!0,other:!1};Chess.Glyphes.getSymbolById=function(e){return i||(i=t()),i[e]&&i[e].symbol||""},Chess.Glyphes.getByCategory=function(){return n||(n=e())},Chess.Glyphes.isSinleItemCategory=function(e){return o[e]}}(),"undefined"==typeof Chess&&(Chess={}),function(){var e=/[1-8]{2}/,t=/^[prnbqkPRNBQK-]{8}$/,n=/^(w|b)$/,i=/^.{1,4}$/,o=/^(KQ?k?q?|Qk?q?|kq?|q|-)$/,r=/^(-|[a-h][36])$/;Chess.isFen=function(a){try{var s=a.split(" ");if(6!==s.length)throw new Error('Illegal FEN / Wrong count of FEN blocks "'+a+'"');if(e.test(s[0]))throw new Error('Illegal FEN / Two digits next to each other "'+a+'"');var l=Chess.translate.shortToLongPositionGroup(s[0]).split("/");if(8!==l.length)throw new Error('Illegal FEN / Wrong count of position blocks "'+a+'"');for(var c=0;c<l.length;c++){if(8!==l[c].length)throw new Error('Illegal FEN / block is numeric  "'+a+'"');if(!t.test(l[c]))throw new Error('Illegal FEN / illegal piece "'+l[c]+'" in "'+a+'"')}if(!n.test(s[1]))throw new Error('Illegal FEN / illegal MoveRight "'+s[1]+'" in "'+a+'"');if(!i.test(s[2]))throw new Error('Illegal FEN / illegal CastlingRights "'+s[2]+'" in "'+a+'"');if((s[2].toLowerCase().contains("k")||s[2].toLowerCase().contains("q"))&&!o.test(s[2]))throw new Error('Illegal legacy FEN / illegal CastlingRights "'+s[2]+'" in "'+a+'"');if(!r.test(s[3]))throw new Error('Illegal FEN / illegal EP Information "'+s[3]+'" in "'+a+'"');if(isNaN(s[4])||parseInt(s[4],10)<0)throw new Error('Illegal FEN / illegal ActionCounter "'+s[4]+'" in "'+a+'"');if(isNaN(s[5])||parseInt(s[5],10)<=0)throw new Error('Illegal FEN / illegal MoveCounter "'+s[5]+'" in "'+a+'"')}catch(d){return{valid:!1,error:d.message}}return{valid:!0}},Chess.isValidFen=function(e){return Chess.isFen(e).valid}}(),function(){function e(e,t,n,i,o,r){var a=this;return a.y1=parseInt(e,10),a.x1=parseInt(t,10),a.x2=parseInt(i,10),a.y2=parseInt(n,10),a.promotion=0===a.y1+a.x1+a.y2+a.x2?void 0:o,a.castleInfo={isCastle:!1},(isNaN(a.y1)||isNaN(a.x1)||isNaN(a.x2)||isNaN(a.y2))&&errorHandler.msg("critical",new Error("Illegal parameter in position Constructor"),!0,{y1:e,x1:t,y2:n,x2:i,promotion:o}),a.can=r,a}"undefined"==typeof Chess&&(Chess={});Chess.getNullMove=function(){return Chess.getMove(0,0,0,0)},Chess.getMove=function(t,n,i,o,r){r=r&&r.toLowerCase();var a=Chess.translate.coordinatesToCan(t,n,i,o,r);return new e(t,n,i,o,r,a)},Chess.isMove=function(t){return t instanceof e},e.prototype.isOnBoard=function(){return this.onBoard},Object.defineProperty(e.prototype,"onBoard",{get:function(){var e=this.y1>=0&&this.y1<=7&&this.x1>=0&&this.x1<=7&&this.y2>=0&&this.y2<=7&&this.x2>=0&&this.x2<=7;return Object.defineProperty(this,"onBoard",{value:e}),e}}),e.prototype.toString=function(){return this.can},Object.defineProperty(e.prototype,"endSquare",{get:function(){var e=Chess.getSquare(this.y2,this.x2);return Object.defineProperty(this,"endSquare",{value:e}),e}}),Object.defineProperty(e.prototype,"startSquare",{get:function(){var e=Chess.getSquare(this.y1,this.x1);return Object.defineProperty(this,"startSquare",{value:e}),e}}),e.prototype.changePromotion=function(e){return Chess.getMove(this.y1,this.x1,this.y2,this.x2,e)},e.prototype.isNullMove=function(){return 0===this.x1&&0===this.x2&&0===this.y1&&0===this.y2},e.prototype.isCastle=function(){return this.castleInfo.isCastle},e.prototype.setCastleInfo=function(e){this.castleInfo=e}}(),function(){function e(e){var t=e.split("."),n=t[0],i="??"===t[1]?1:t[1],o="??"===t[2]?1:t[2];return new Date(n,i-1,o).getTime()}function t(e){for(var t={White:{},Black:{}},n=e.split(d),i=0;i<n.length;i++)if("["===n[i].substring(0,1)&&'"]'===n[i].substring(n[i].length-2)){n[i]=n[i].substring(1,n[i].length-2);var o=n[i].split('"'),r=o[0].trim(),a=o[1].trim();if("fen"===r.toLowerCase()&&(r="FEN"),"Date"===r&&!T.test(a)){errorHandler.notice("skipped invalid meta date",{value:a});continue}if("White"===r){r="WhiteName";var s=a.match(p);a=a.replace(p,"").trim()}"Black"===r&&(r="BlackName",a=a.replace(p,"").trim());var l=r.substring(0,5),c="White"===l||"Black"===l;if(c){var u=r.substring(5);/^elo$/i.test(u)?(u="Elo",a=parseInt(a,10),isNaN(a)||(t[l][u]=a)):t[l][u]=a}else if("Round"===r)if(a.contains(".")){var h=parseInt(a.split(".")[0]),f=a.split(".")[1];isNaN(h)||(t.Round=h)}else isNaN(a)?x.test(a)&&(t.Round=parseInt(a.match(x)[0],10)):t.Round=parseInt(a,10);else"Board"===r?(a.contains(".")&&(a=a.split(".").last()),isNaN(a)||(t[r]=parseInt(a,10))):t[r]=a}return void 0===t.Board&&(s&&!isNaN(s)?t.Board=parseInt(s,10):f&&!isNaN(f)&&(t.Board=parseInt(f,10))),t}function n(e,t,n){for(var i=0,o=36e5;t.length;){var r=t.shift();i+=r*o,o/=60}e.setTimeUsageForLastAddedPosition(-1*i+n)}function i(e,t){for(var n=t.split(","),i=n.length,o=0;i>o;o++){var r=n[o],a=E[r[0]];if(a){var s=r.substr(1,2),l={color:a,frame:Chess.translate.squareStringToSquare(s)};e.addHighlight(l,void 0)}}}function o(e,t){for(var n=t.split(","),i=n.length,o=0;i>o;o++){var r=n[o],a=E[r[0]];if(a){var s=r.substr(1,4),l={color:a,line:Chess.translate.canToMove(s)};e.addHighlight(l,void 0)}}}function r(e,t){if(C.test(t)){var i="w"===e.getCurrentPosition().parentMove.moveRight?"white":"black";n(e,t.trim().replace(/\./g,":").split(":"),e.getClockInformation()[i].timeLeft)}}function a(e,t){if(k.test(t)){var n=t.split("."),i=1e3*parseInt(n[0],10)+(parseInt(n[1],10)||0);e.setTimeUsageForLastAddedPosition(i)}}function s(e,t){var n=e.getCurrentPosition();try{for(var i=t.split(","),o=0;o<i.length;)'"'===i[o].trim()[0]&&'"'!==i[o].trim()[i[o].trim().length-1]?(i[o]+=","+i[o+1],i.remove(o+1)):o++;var r=(i.length-3)/3;r!==Math.floor(r)&&errorHandler.msg("warning",new Error("wrong number of elements in quiz"),!0,{numberOfAnswers:r,quizInformation:i});var a=i[0].trim();'"'===a[0]&&'"'===a[a.length-1]?a=a.substr(1,a.length-2).trim():errorHandler.msg("warning",new Error("quiz questions isn't double quoted"),!0,{question:a}),e.setQuestion(a);for(var s=3;3+3*r>s;s+=3){var l=i[s].trim();try{e.moveSan(l,void 0,!0,void 0,void 0,!0).setTimeUsageForLastAddedPosition(0);var c=e.getCurrentPosition().moveCoords;e.gotoParentPosition()}catch(d){errorHandler.msg("warning",new Error("the move given in the quiz is not a valid move"),!0,{move:l,moveError:d.message})}var u=i[s+1].trim();'"'===u[0]&&'"'===u[u.length-1]?u=u.substr(1,u.length-2).trim():errorHandler.msg("warning",new Error("quiz feedback isn't double quoted"),!0,{feedback:u});var h=parseInt(i[s+2].trim(),10);if(isNaN(h)&&errorHandler.msg("warning",new Error("points in quit is not a number"),!0,{feedback:u,points:h}),e.getCurrentPosition().getChildrenMoveById(0).moveCoords===c)var p=!0;else p=!1;e.getQuestion().addAnswer(c,u,p,h)}}catch(d){}e.setCurrentPosition(n)}function l(e,t,l){for(var c,d,u,h,p,g=/\[%(.+?) (.+?)\]/g,m=t;c=g.exec(t);){p=!0,d=c[0],u=c[1],h=c[2];try{switch(u){case"clk":r(e,h),l=!0;break;case"emt":l||a(e,h),l=!1;break;case"tqu":s(e,h),l=!1;break;case"csl":i(e,h),l=!1;break;case"cal":o(e,h),l=!1;break;default:p=!1,errorHandler.notice("found unknown command during pgn parsing: "+d,{meta:e.getMeta(),comment:t,currentPosition:e.toString()})}}catch(v){}p&&(m=m.replace(d,""))}if(t=m,c=t.match(f)){d=c[0];var y="w"===e.getCurrentPosition().parentMove.moveRight?"white":"black";n(e,d.split(":"),e.getClockInformation()[y].timeLeft),t=t.replace(d,"")}return{comment:t,isPreviousCommandClk:l}}function c(e,t){for(var n=[],i="",o="",r=!1,a="",s=!1,c=0;c<t.length;c++)if(o=t[c],r){if("}"===o){if(a=l(e,i.trim(),s),i=a.comment.trim(),s=a.isPreviousCommandClk,i.length){var d=e.getComment();d?e.setComment(d+" "+i):e.setComment(i)}r=!1,i="";continue}i+=o}else if("{"!==o)if("("!==o)if(")"!==o)if(" "===o&&i.length>1){if(v.test(i)){i="";continue}if(y.test(i)){e.addGlyph(parseInt(i.substr(1),10)),i="";continue}try{e.moveSan(i,void 0,!0,void 0,void 0,!0).setTimeUsageForLastAddedPosition(0)}catch(u){errorHandler.warning(new Error("could not fully import pgn game, because of illegal move"),{meta:e.getMeta(),move:i,currentPosition:e.toString(),error:u});break}i=""}else" "!==o&&(i+=o);else g.test(i)?e.addGlyph(parseInt(i.substr(1),10)):m.test(i)||e.moveSan(i,void 0,!0,void 0,void 0,!0).setTimeUsageForLastAddedPosition(0),i="",e.setCurrentPosition(n.pop());else n.push(e.getCurrentPosition()),e.gotoParentPosition();else r=!0;return e.gotoStart()}var d=/\n/g,u=/\n+$/g,h=/\n\n/g,p=/^\d+ /,f=/^[0-9]{1,2}:[0-9]{2}:[0-9]{2}$/,g=/^\$[0-9]*\s*$/,m=/^([0-9]*\.+|0-1|1-0|1\/2-1\/2)?\s*$/,v=/^([0-9]*\.+|0-1|1-0|1\/2-1\/2)\s*$/,y=/^\$[0-9]*\s*$/,w=/[\r|\t]/g,b=/([0-9]+\.)([a-h]|Q|R|N|B|K|0-0|O-O)/g,C=/^[0-9|:|.]*/,k=/^[0-9|.]*/,F=/\* \{[0-9]{1,2}:[0-9]{2}:[0-9]{2}\}/,x=/[0-9]+/,T=/^[0-9]{4}.[0-9\?]{2}.[0-9\?]{2}$/,_=["*","1-0","0-1","1/2-1/2"],E={R:"red",Y:"yellow",G:"green"};Chess.pgnToGame=function(n,i,o){i=i=[],n=n.replace(w,"").replace(u,"");var r=n.split(h);if(2!==r.length)return errorHandler.warning("can't import chessGame because, the blocks are not well formatted"),!1;var a=r[1].replace(F,"*").replace(b,"$1 $2").replace(d," ").trim(),s=a.substr(a.lastIndexOf(" ")+1);if(!_.contains(s))return errorHandler.warning("can't import chessGame because, the move block has no terminator char (*, 1-0, 0-1, 1/2-1/2)",{lastPartofGameString:s,meta:r[0]}),!1;var l=t(r[0]),p={noTimeout:!0};l.FEN&&(p.fen=l.FEN);var f=new Chess.Game(p);l.Date&&(f.gameStartedAt=e(l.Date));var g={emit:f.emit};switch(f.emit=dummy,f.setCheckForGameEnd(!1).setClockStartMove(1).setCalcTimeSpendInThisMove(!1).setMoveMode({duringGame:{mainline:!0,sideline:!0},afterGame:{mainline:!0,sideline:!0}}),c(f,a),l.Result){case"1-0":case"0-1":case"1/2-1/2":f.setGameStatus(l.Result)}return o&&(l=Object.subset(l,o)),f.setMeta(l),i.contains("gameStartedAt")&&delete f.gameStartedAt,f.emit=g.emit,f}}(),function(){function e(){}function t(){var e=this;return e.type="r",e.moveDirections=[Chess.getSquare(0,1),Chess.getSquare(0,-1),Chess.getSquare(1,0),Chess.getSquare(-1,0)],e.maxMoveSquares=7,e.takeDirections=e.moveDirections,e.maxTakeSquares=e.maxMoveSquares,e}function n(){var e=this;return e.type="n",e.moveDirections=[Chess.getSquare(2,1),Chess.getSquare(2,-1),Chess.getSquare(1,2),Chess.getSquare(1,-2),Chess.getSquare(-1,2),Chess.getSquare(-1,-2),Chess.getSquare(-2,1),Chess.getSquare(-2,-1)],e.maxMoveSquares=1,e.takeDirections=e.moveDirections,e.maxTakeSquares=e.maxMoveSquares,e}function i(){var e=this;return e.type="b",e.moveDirections=[Chess.getSquare(1,1),Chess.getSquare(1,-1),Chess.getSquare(-1,1),Chess.getSquare(-1,-1)],e.maxMoveSquares=7,e.takeDirections=e.moveDirections,e.maxTakeSquares=e.maxMoveSquares,e}function o(){var e=this;return e.type="q",e.moveDirections=[Chess.getSquare(0,1),Chess.getSquare(0,-1),Chess.getSquare(1,0),Chess.getSquare(-1,0),Chess.getSquare(1,1),Chess.getSquare(1,-1),Chess.getSquare(-1,1),Chess.getSquare(-1,-1)],e.maxMoveSquares=7,e.takeDirections=e.moveDirections,e.maxTakeSquares=e.maxMoveSquares,e}function r(){var e=this;return e.type="k",e.moveDirections=[Chess.getSquare(0,1),Chess.getSquare(0,-1),Chess.getSquare(0,0),Chess.getSquare(1,0),Chess.getSquare(-1,0),Chess.getSquare(1,1),Chess.getSquare(1,-1),Chess.getSquare(-1,1),Chess.getSquare(-1,-1)],e.maxMoveSquares=1,e.takeDirections=e.moveDirections,e.maxTakeSquares=e.maxMoveSquares,e}function a(e,t){var n=this;return n.color=e,n.type="p","w"===e?(n.moveDirections=[Chess.getSquare(1,0)],n.takeDirections=[Chess.getSquare(1,1),Chess.getSquare(1,-1)]):(n.moveDirections=[Chess.getSquare(-1,0)],n.takeDirections=[Chess.getSquare(-1,1),Chess.getSquare(-1,-1)]),n.maxMoveSquares=t?2:1,n.maxTakeSquares=1,n}"undefined"==typeof Chess&&(Chess={});var s={pawn:{w:{},b:{}}};Chess.getPiece=function(e,l,c){switch(e.toLowerCase()){case"p":return c=c||!1,s.pawn[l][c]||(s.pawn[l][c]=new a(l,c));case"n":return s.knight||(s.knight=new n);case"b":return s.bishop||(s.bishop=new i);case"q":return s.queen||(s.queen=new o);case"r":return s.rook||(s.rook=new t);case"k":return s.king||(s.king=new r);default:return errorHandler.error(new Error("Illegal Piece in Constructor"),{piece:e})}},Chess.isPiece=function(t){return t instanceof e},e.prototype.getPossibleDistances=function(){for(var e={pieceHasSameMoveAndTakingBehavior:this.takeDirections===this.moveDirections,move:[],take:[]},t=0;t<this.moveDirections.length;t++){for(var n=[],i=1;i<=this.maxMoveSquares;i++)n.push(Chess.getSquare(this.moveDirections[t].y*i,this.moveDirections[t].x*i));e.move.unshift(n)}if(!e.pieceHasSameMoveAndTakingBehavior)for(t=0;t<this.takeDirections.length;t++){var n=[];for(i=1;i<=this.maxTakeSquares;i++)n.push(Chess.getSquare(this.takeDirections[t].y*i,this.takeDirections[t].x*i));e.take.unshift(n)}return this.getPossibleDistances=function(){return e},e},e.prototype.getPotentialSquares=function(){var e=this.getPossibleDistances(),t=[];return t=t.concat.apply(t,e.move.concat(e.take)),this.getPotentialSquares=function(){return t},t},t.prototype=n.prototype=i.prototype=r.prototype=o.prototype=a.prototype=e.prototype}(),function(){function e(e){for(var t={r:0,n:0,b:0,q:0,k:0,p:0,R:0,N:0,B:0,Q:0,K:0,P:0},n=0;64>n;n++)"-"!==e[n]&&t[e[n]]++;return t.white=t.K+t.Q+t.R+t.B+t.N+t.P,t.black=t.k+t.q+t.r+t.b+t.n+t.p,t.total=t.white+t.black,t}function t(e){Chess.isSquare(e.square)||Chess.isMove(e.line)||Chess.isSquare(e.frame)||errorHandler.error(new Error("highlightData does not have a proper highlight object"),{highlight:e})}function n(e){for(var t={squareBased:{},pieceBased:{},fullList:!1,piecePosition:{r:[],n:[],b:[],q:[],k:[],p:[]}},n=0;8>n;n++)for(var i=0;8>i;i++){if("w"===e.moveRight)var o=Chess.getSquare(n,i);else var o=Chess.getSquare(7-n,7-i);var r=e.getPiece(o);"-"===r||("w"!==e.moveRight||"P"!==r&&"R"!==r&&"N"!==r&&"B"!==r&&"Q"!==r&&"K"!==r)&&("b"!==e.moveRight||"p"!==r&&"r"!==r&&"n"!==r&&"b"!==r&&"q"!==r&&"k"!==r)||(t.piecePosition[r.toLowerCase()].push(o),t.squareBased[o]=o)}return t}"undefined"==typeof Chess&&(Chess={});var i,o={local:1,remote:2};!function r(){i={goesIntoIllegalPosition:{},checkMove:{},isMoveListEmpty:{},listOfLegalMoves:{},pieceCount:{}},setTimeout(r,"undefined"!=typeof Config&&Config.base&&Config.base.clearPositionCacheInterval||6e5)}(),Chess.Position=function(e){function t(){if(e.simpleMove&&(l.countPiecesOnBoard(),l.switchMoveRight(),l.kingPos[l.moveRight]&&l.isAttacked(l.kingPos[l.moveRight])&&(l.positionFlags.illegal=!0),l.switchMoveRight()),l.isMoveListEmpty())return void(l.kingPos[l.moveRight]&&l.isAttacked(l.kingPos[l.moveRight])?(l.positionFlags.check=!0,l.positionFlags.checkMate=!0):l.positionFlags.staleMate=!0);if(!e.dontCheckForInsufficentMaterial){var t=l.countPiecesOnBoard();if(t.white<3&&0===t.R&&0===t.Q&&0===t.P&&(l.positionFlags.insufficentMaterial.w=!0),t.black<3&&0===t.r&&0===t.q&&0===t.p&&(l.positionFlags.insufficentMaterial.b=!0),l.positionFlags.insufficentMaterial[l.moveRight])for(var n=l.getMoveList(),i=0;i<n.length;i++){var o=l.addChild({move:n[i],simpleMove:!0,dontCheckForInsufficentMaterial:!0}),r=o.isCheckMate();if(o.destroy(),r){l.positionFlags.insufficentMaterial[l.moveRight]=!1;break}}if(l.positionFlags.insufficentMaterial.w&&2===t.black&&2===t.white&&1===t.N&&1===t.p){var a=l.getPiece(),s=a.indexOf("p"),c=s/8,d=s%8;(0===d||7===d)&&3>c&&l.kingPos.b.x===d&&l.kingPos.b.y<c&&l.kingPos.w.y<2&&2===Math.abs(l.kingPos.b.x-l.kingPos.w.x)&&(l.positionFlags.insufficentMaterial.w=!1)}if(l.positionFlags.insufficentMaterial.b&&2===t.black&&2===t.white&&1===t.n&&1===t.P){var a=l.getPiece(),s=a.indexOf("P"),c=s/8,d=s%8;(0===d||7===d)&&c>4&&l.kingPos.w.x===d&&l.kingPos.w.y>c&&l.kingPos.b.y>5&&2===Math.abs(l.kingPos.b.x-l.kingPos.w.x)&&(l.positionFlags.insufficentMaterial.b=!1);
}}l.kingPos[l.moveRight]&&l.isAttacked(l.kingPos[l.moveRight])&&(l.positionFlags.check=!0)}function r(){l.moveFormats={},l.moveMadeAt=Date.now(),l.parentMove?l.timeUsage=l.moveMadeAt-l.parentMove.moveMadeAt:l.timeUsage=0,void 0!==e.knotId&&(l.knotId=parseInt(e.knotId,10)),l.reRoot=function(){return m=!0,delete l.parentMove,delete l.moveCoords,l},l.getHighlights=function(){return g||(g=[])},l.isRootPosition=function(){return m},l.getSource=function(){return f},l.setSource=function(e){return o[e]>(o[f]||0)?(f=e,!0):!1},l.getGlyphes=function(){return p||(p=[])},l.getChat=function(){return h||(h=[])},l.getValidators=function(){return u}}function a(e,t){function n(e,n){return"-"===e?o.push(n):o.unshift(n),t}t=t||!1;var i=l.getPiece(e);if(!i||"-"===i)return[];for(var o=[],r=i===i.toUpperCase()?"w":"b",a="P"===i&&1===e.y||"p"===i&&6===e.y,s="b"===r,c=Chess.getPiece(i,r,a),d=c.getPossibleDistances(),u=0;u<d.move.length;u++)for(var h=0;h<d.move[u].length;h++){var p=e.overlaySquare(d.move[u][h]);if(!p.onBoard)break;var f=l.getPiece(p);if(!("-"===f||d.pieceHasSameMoveAndTakingBehavior&&f===f.toLowerCase()!==s))break;if(7===p.y&&"P"===i||0===p.y&&"p"===i)for(var g=["q","r","b","n"],m=0;m<g.length;m++){var v=Chess.getMove(e.y,e.x,p.y,p.x,g[m]);if(l.goesIntoIllegalPosition(v))break;if(n(f,v))return o}else{if(v=Chess.getMove(e.y,e.x,p.y,p.x),!l.goesIntoIllegalPosition(v)&&n(f,v))return o;if("-"!==f)break}}if(!d.pieceHasSameMoveAndTakingBehavior)for(u=0;u<d.take.length;u++)for(h=0;h<d.take[u].length;h++){var p=e.overlaySquare(d.take[u][h]);if(!p.onBoard)break;if(f=l.getPiece(p),"-"!==f){var y="b";if(f===f.toUpperCase()&&(y="w"),y!==r)if(7===p.y&&"P"===i||0===p.y&&"p"===i)for(var g=["q","r","b","n"],m=0;m<g.length;m++){var v=Chess.getMove(e.y,e.x,p.y,p.x,g[m]);if(l.goesIntoIllegalPosition(v))break;if(n(f,v))return o}else if(v=Chess.getMove(e.y,e.x,p.y,p.x),!l.goesIntoIllegalPosition(v)&&n(f,v))return o;break}}if(-1!==l.ep&&"p"===c.type)for(var w=0;w<c.takeDirections.length;w++)for(h=1;h<=c.maxTakeSquares;h++){p=e.getNewSquare(h*c.takeDirections[w].y,h*c.takeDirections[w].x);var b;if(b="w"===r?5:2,p.y===b&&p.x===l.ep&&(v=Chess.getMove(e.y,e.x,e.y+h*c.takeDirections[w].y,e.x+h*c.takeDirections[w].x),!l.goesIntoIllegalPosition(v)&&n(l.getPiece(p),v)))return o}if("k"===c.type){if(""!==Helper.Chess960.getCastlingRight(l,!0,!s)){var C=Helper.Chess960.getMoveWithCastleInfo(l,!0,!0);Helper.Chess960.isMoveValidCastle(l,C.startSquare,C.endSquare,!0)&&n(l.getPiece(C.endSquare),C),C=Helper.Chess960.getMoveWithCastleInfo(l,!0,!1),Helper.Chess960.isMoveValidCastle(l,C.startSquare,C.endSquare,!0)&&n(l.getPiece(C.endSquare),C)}if(""!==Helper.Chess960.getCastlingRight(l,!1,!s)){var C=Helper.Chess960.getMoveWithCastleInfo(l,!1,!0);Helper.Chess960.isMoveValidCastle(l,C.startSquare,C.endSquare,!1)&&n(l.getPiece(C.endSquare),C),C=Helper.Chess960.getMoveWithCastleInfo(l,!1,!1),Helper.Chess960.isMoveValidCastle(l,C.startSquare,C.endSquare,!1)&&n(l.getPiece(C.endSquare),C)}}return o}function s(){if(c.fullList)return l;for(var e in c.squareBased)if(Chess.isSquare(c.squareBased[e])){var t=l.getPiece(c.squareBased[e]).toLowerCase(),n=a(c.squareBased[e]);c.squareBased[e]=n,c.pieceBased[t]=(c.pieceBased[t]||[]).concat(n)}return c.fullList=!0,l}var l=this;e=e||{};var c,d,u,h,p,f,g,m=!e.parentMove;return l.childrenMoves=[],e&&e.parentMove&&e.parentMove.castlingRights?l.castlingRights=JSON.parse(JSON.stringify(e.parentMove.castlingRights)):l.castlingRights=Helper.Chess960.getDefaultPosCastlingRights(),l.dontCheckForInsufficentMaterial=e.dontCheckForInsufficentMaterial,l.kingPos={},l.positionFlags={check:!1,checkMate:!1,staleMate:!1,illegal:!1,insufficentMaterial:{w:!1,b:!1},positionRepetition:!1},m||e.move||errorHandler.critical(new Error("Can't construct position. Wrong input parameter"),{move:e.move}),l.isMoveListEmpty=function(){if(void 0===c)return!1;var e=this.toString(),t=i.isMoveListEmpty[e];if(void 0!==t)return t;for(var n in c.squareBased){if(c.squareBased[n].length)return i.isMoveListEmpty[e]=!1;var o=a(c.squareBased[n],!0);if(o.length)return i.isMoveListEmpty[e]=!1;c.squareBased[n]=o}return i.isMoveListEmpty[e]=!0},l.getColor=function(){return"w"===l.moveRight},l.getPiece=function(e,t){return void 0===e?d:(void 0===t&&(t=e.x,e=e.y),d[8*e+t])},l.setPiece=function(e,t,n){void 0===n&&(n=t,t=e.x,e=e.y);var i=8*e+t;return d=d.substr(0,i)+n+d.substr(i+n.length),l},l.findPotentialStartSquares=function(e,t,n,i,o,r){function a(t,a){for(var d=g.pieceHasSameMoveAndTakingBehavior||"-"===c?g.move:g.take,h=0;h<d.length;h++)for(var p=0;p<d[h].length;p++){var m=s.overlaySquare(d[h][p]);if(!m.onBoard)break;var v=l.getPiece(m);if(v!==e){if("-"===v)continue;break}if(void 0===a||a===m[t]){var y=Chess.getMove(m.y,m.x,i,o,r);if(!l.goesIntoIllegalPosition(y))return y}}if(-1!==l.ep&&"p"===f.type&&void 0!==n&&(2===i&&"b"===u||5===i&&"w"===u)){var y=Chess.getMove("b"===u?3:4,n,i,o,r);if(!l.goesIntoIllegalPosition(y))return y}}var s=Chess.getSquare(i,o),c=l.getPiece(s),d=e.toLowerCase(),u=e===d?"b":"w";if("p"===d)var h="w"===u?"b":"w",p="P"===e&&3===i||4===i;var f=Chess.getPiece(e,h,p),g=f.getPossibleDistances();return void 0===t?void 0===n?a():a("x",n):void 0===n?a("y",t):Chess.getMove(t,n,i,o,r)},l.getMoveList=function(e,t){if(!c)return[];if("piece"===e){if(t){t=t.toLowerCase();var n;if(c.piecePosition[t]){for(;n=c.piecePosition[t].pop();)l.getMoveList("square",n);delete c.piecePosition[t]}return c.pieceBased[t]||[]}return s(),c.pieceBased}if("square"===e){if(t){if("currentState"===t)return c.squareBased;if(!c.squareBased[t])return[];if(Array.isArray(c.squareBased[t]))return c.squareBased[t];var i=l.getPiece(t).toLowerCase();if("-"===i)return[];var o=a(t);return c.pieceBased[i]=(c.pieceBased[i]||[]).concat(o),c.squareBased[t]=o}return s(),c.squareBased}if(!c.listBased){s(),c.listBased=[];for(var r in c.squareBased)c.listBased.pushArray(c.squareBased[r])}return c.listBased},m?(!function(e){var t=Chess.isFen(e);t.valid||errorHandler.msg("notice",new Error(t.error),!0,{fen:e});var n=e.split(" "),i=Chess.translate.shortToLongPositionGroup(n[0]).split("/");d="";for(var o=0;8>o;o++)for(var r=0;8>r;r++){var a=i[7-o][r];d+=a,"k"===a?l.kingPos.b=Chess.getSquare(o,r):"K"===a&&(l.kingPos.w=Chess.getSquare(o,r))}l.moveRight=n[1],Helper.Chess960.setCastlingRightsFromFenPart(l,n[2]),l.ep=Chess.translate.decodeHumanCordX(n[3][0]),l.actionCounter=parseInt(n[4],10),l.moveCounter=parseInt(n[5],10)}(e.fen||Chess.defaultFen),u=e.validators?e.validators:[{moveValidator:Chess.Game.validators.standardRules}]):(l.parentMove=e.parentMove,d=l.parentMove.getPiece(),l.moveRight=l.parentMove.moveRight,l.castlingRights=JSON.parse(JSON.stringify(l.parentMove.castlingRights)),l.actionCounter=l.parentMove.actionCounter,l.moveCounter=l.parentMove.moveCounter,l.kingPos.w=l.parentMove.kingPos.w,l.kingPos.b=l.parentMove.kingPos.b,l.moveCoords=e.move,e.move&&(Helper.Chess960.isMoveValidCastle(l,e.move.startSquare,e.move.endSquare,!0)?Helper.Chess960.setMoveCastleInfo(e.move,l.getColor(),!0):Helper.Chess960.isMoveValidCastle(l,e.move.startSquare,e.move.endSquare,!1)&&Helper.Chess960.setMoveCastleInfo(e.move,l.getColor(),!1)),l.adjustBoard(),e.simpleMove!==!0&&(u=e.parentMove.getValidators(),l.positionFlags.positionRepetition=l.countRepetition()>2)),(e.dontCheckForInsufficentMaterial||!e.simpleMove)&&(c=i.listOfLegalMoves[l.toString()]||(i.listOfLegalMoves[l.toString()]=n(l))),e.simpleMove||r(),t(),e.simpleMove&&delete l.parentMove,l},Chess.Position.prototype.getEngineFen=function(){return Chess.translate.longFenToEngineFen(this.toString())},Chess.Position.prototype.promote=function(){var e=this;if(!e.parentMove)return this;var t=e.parentMove.childrenMoves;if(!t||t.length<2)return e.parentMove.promote(),this;var n=t.indexOf(e);return 1>n?(e.parentMove.promote(),this):(e.parentMove.childrenMoves.splice(n,1),e.parentMove.childrenMoves.unshift(e),this)},Chess.Position.prototype.toAscii=function(){for(var e="-+--------+\n",t=0;8>t;t++){e+=7-t+1+"|";for(var n=0;8>n;n++)e+=this.getPiece(7-t,n).replace("-"," ");e+="|\n"}return e+="-+--------+\n"+this.moveRight+"|abcdefgh|"},Chess.Position.prototype.isAtLeastAwayFromRoot=function(e){for(var t=this;e--&&(t=t.parentMove););return!!t},Chess.Position.prototype.getDepth=function(e){var t=0;if(e=e||!1)var n=this.childrenMoves.length;else n=Math.min(this.childrenMoves.length,1);for(var i=0;n>i;i++){var o=this.childrenMoves[i].getDepth(e);o>t&&(t=o)}return 1+t},Chess.Position.prototype.countChildrenMoves=function(e){return e?this.childrenMoves.reduce(function(e,t){return t.isNullMove()||e++,e},0):this.childrenMoves.length},Chess.Position.prototype.isNullMove=function(){return void 0===this.moveCoords?!1:this.moveCoords.isNullMove()},Chess.Position.prototype.deleteMove=function(){if(!this.parentMove)return!1;var e=this.parentMove.childrenMoves.indexOf(this);return e>=0?(this.parentMove.childrenMoves.splice(e,1),this.parentMove):!1},Chess.Position.prototype.addChild=function(e){e.parentMove=this;var t=new Chess.Position(e);return e.simpleMove||this.childrenMoves.push(t),t},Chess.Position.prototype.getAllChildrenInSubtree=function(){var e=[];e.pushArray(this.childrenMoves);for(var t=0;t<this.childrenMoves.length;t++)e.pushArray(this.childrenMoves[t].getAllChildrenInSubtree());return e},Chess.Position.prototype.isInMainline=function(){for(var e=this;e.parentMove;){if(0!==e.parentMove.childrenMoves.indexOf(e))return!1;e=e.parentMove}return!0},Chess.Position.prototype.getEndOfLine=function(){for(var e=this;e.countChildrenMoves()>0;)e=e.getChildrenMoveById(0);return e},Chess.Position.prototype.isEndOfLine=function(){return 0===this.countChildrenMoves()},Chess.Position.prototype.getDistanceToMainline=function(){return this.isInMainline()?0:0===this.getPositionInChildrenArray()?this.parentMove.getDistanceToMainline():this.parentMove.getDistanceToMainline()+1},Chess.Position.prototype.getChildrenMoveById=function(e){return void 0===this.childrenMoves[e]?!1:this.childrenMoves[e]},Chess.Position.prototype.getChildrenMoveByMove=function(e){for(var t=0;t<this.childrenMoves.length;t++)if(this.childrenMoves[t].moveCoords.can===e.can)return this.childrenMoves[t];return!1},Chess.Position.prototype.getPositionInChildrenArray=function(){if(void 0===this.parentMove)return-1;var e=this.parentMove.childrenMoves;return e.indexOf(this)},Chess.Position.prototype.isLegalMoveIfItWouldBeAPromotion=function(e){return this.isLegalMove(Chess.getMove(e.y1,e.x1,e.y2,e.x2,"q"))},Chess.Position.prototype.isLegalMove=function(e){for(var t=this.getValidators(),n=0;n<t.length;n++){var i=t[n].moveValidator.call(this,e);if(void 0!==i)return i}return!1},Chess.Position.prototype.move=function(e){if(!e.simpleMove&&!this.isLegalMove(e.move))return errorHandler.error(new Error("Illegal Move"),{move:e.move,fen:this.toString()});for(var t=0;t<this.childrenMoves.length;t++)if(e.move.can===this.childrenMoves[t].moveCoords.can)return t;return void 0===e.dontCheckForInsufficentMaterial&&(e.dontCheckForInsufficentMaterial=this.dontCheckForInsufficentMaterial),this.addChild(e)},Chess.Position.prototype.clonePosition=function(){return new Chess.Position({fen:this.toString()})},Chess.Position.prototype.getFormatedGlyphes=function(){return this.getGlyphes().map(Chess.Glyphes.getSymbolById).join("")},Chess.Position.prototype.getMove=function(e,t){if(t)var n=this.getFormatedGlyphes();switch(e.toLowerCase()){case"san":var i=this.getSan();break;case"fan":i=this.getFan();break;case"lan":i=this.getLan();break;case"can":i=this.getCan();break;case"sep":i=this.getSep();break;default:errorHandler.warning(new Error("the selected move format is not avaible"),{format:e}),i=this.getSan()}return n?i+n:i},Chess.Position.prototype.isCheck=function(){return this.positionFlags.check},Chess.Position.prototype.isIllegal=function(){return this.positionFlags.illegal},Chess.Position.prototype.isCheckMate=function(){return this.positionFlags.checkMate},Chess.Position.prototype.isActionCounterOverLimit=function(){return this.actionCounter>=100},Chess.Position.prototype.isStaleMate=function(){return this.positionFlags.staleMate},Chess.Position.prototype.isInsufficentMaterial=function(e){var t=!1;return t=void 0===e?this.positionFlags.insufficentMaterial.w&&this.positionFlags.insufficentMaterial.b:"w"===e?this.positionFlags.insufficentMaterial.w:this.positionFlags.insufficentMaterial.b},Chess.Position.prototype.isPositionRepetition=function(){return this.positionFlags.positionRepetition},Chess.Position.prototype.isDraw=function(){return this.positionFlags.positionRepetition||this.positionFlags.staleMate||this.isActionCounterOverLimit()||this.positionFlags.insufficentMaterial.w&&this.positionFlags.insufficentMaterial.b},Chess.Position.prototype.isAttacked=function(e){var t=this,n=t.getPiece(e);if("-"===n)var i=t.moveRight;else i=n===n.toUpperCase()?"w":"b";var o=t.countPiecesOnBoard();if("w"===i){var r=["k"];o.p&&r.push("p"),o.n&&r.push("n"),o.r&&r.push("r"),o.b&&r.push("b"),o.q&&r.push("q")}else r=["K"],o.P&&r.push("P"),o.N&&r.push("N"),o.R&&r.push("R"),o.B&&r.push("B"),o.Q&&r.push("Q");if(t.ep===e.x)if("w"===i){if(3===e.y&&"P"===n&&"b"===t.moveRight){if("p"===t.getPiece(e.getNewSquare(0,1)))return!0;if("p"===t.getPiece(e.getNewSquare(0,-1)))return!0}}else if(4===e.y&&"p"===n&&"w"===t.moveRight){if("P"===t.getPiece(e.getNewSquare(0,1)))return!0;if("P"===t.getPiece(e.getNewSquare(0,-1)))return!0}for(var a=0;a<r.length;a++)for(var s=Chess.getPiece(r[a],i),l=0;l<s.takeDirections.length;l++)for(var c=1;c<=s.maxTakeSquares;c++){var d=e.getNewSquare(c*s.takeDirections[l].y,c*s.takeDirections[l].x);if(!d.onBoard)break;if(t.getPiece(d)===r[a])return!0;if("-"!==t.getPiece(d))break}return!1},Chess.Position.prototype.switchMoveRight=function(){return"w"===this.moveRight?this.moveRight="b":this.moveRight="w",this},Chess.Position.prototype.adjustBoard=function(){var e,t=this.moveCoords.y1,n=this.moveCoords.x1,i=this.moveCoords.y2,o=this.moveCoords.x2,r=this.moveCoords.endSquare,a=this.moveCoords.startSquare,s=this.moveCoords.promotion;if(0===t&&0===n&&0===i&&0===o)return"b"===this.moveRight&&this.moveCounter++,this.switchMoveRight(),this;this.pieceUsed=this.getPiece(a),"P"===this.pieceUsed||"p"===this.pieceUsed||"-"!==this.getPiece(r)?this.actionCounter=0:this.actionCounter++;var l=this.moveCoords.castleInfo;if("k"===this.pieceUsed||"K"===this.pieceUsed){var c="w"===this.moveRight;if(l.isCastle){if(Helper.Chess960.isMoveValidCastle(this,a,r,l.isKingCastle)){var d,u,h=c?"R":"r";d=Chess.translate.decodeHumanCordX(Helper.Chess960.getCastlingRight(this,l.isKingCastle,c).toLowerCase()),u=l.isKingCastle?Helper.Chess960.castlingEndLines.kingCastle.rook:Helper.Chess960.castlingEndLines.queenCastle.rook,this.setPiece(t,n,"-"),this.setPiece(t,d,"-");var p=l.isKingCastle?"kingCastle":"queenCastle";this.setPiece(i,Helper.Chess960.castlingEndLines[p].king,this.pieceUsed),this.additionalMoveInformation=this.additionalMoveInformation||{},this.additionalMoveInformation.additionalMove=Chess.getMove(t,d,t,u),this.setPiece(t,u,h),l.wasCastle=!0,this.moveCoords.x2=Helper.Chess960.castlingEndLines[p].king;var f=c?0:7;c?this.kingPos.w=Chess.getSquare(0,Helper.Chess960.castlingEndLines[p].king):this.kingPos.b=Chess.getSquare(7,Helper.Chess960.castlingEndLines[p].king),this.moveCoords.castleInfo.endSquare=Chess.getSquare(f,Helper.Chess960.castlingEndLines[p].king)}}else c?this.kingPos.w=r:this.kingPos.b=r;Helper.Chess960.setCastlingRight(this,!0,c,""),Helper.Chess960.setCastlingRight(this,!1,c,"")}else n===o||"P"!==this.pieceUsed&&"p"!==this.pieceUsed||"-"!==this.getPiece(r)||(this.setPiece(t,o,"-"),this.additionalMoveInformation=this.additionalMoveInformation||{},this.additionalMoveInformation.removePiece=Chess.getSquare(t,o),this.actionCounter=0,this.hasTakenPiece=!0);return"-"!==this.getPiece(r)&&(this.hasTakenPiece=!0),!s&&(7===r.y&&"P"===this.pieceUsed||0===r.y&&"p"===this.pieceUsed)&&(s="r"),e=s?"w"===this.moveRight?s.toUpperCase():s:this.pieceUsed,this.hasTakenPiece&&"r"===this.getPiece(r)&&7===i&&Helper.Chess960.setCastlingRightByFile(this,Chess.translate.encodeHumanCordX(o),""),this.hasTakenPiece&&"R"===this.getPiece(r)&&0===i&&Helper.Chess960.setCastlingRightByFile(this,Chess.translate.encodeHumanCordX(o).toUpperCase(),""),l.isCastle||l.wasCastle||(this.setPiece(i,o,e),this.setPiece(t,n,"-")),"r"===this.pieceUsed&&7==t&&Helper.Chess960.setCastlingRightByFile(this,Chess.translate.encodeHumanCordX(n),""),"R"===this.pieceUsed&&0==t&&Helper.Chess960.setCastlingRightByFile(this,Chess.translate.encodeHumanCordX(n).toUpperCase(),""),"b"===this.moveRight&&this.moveCounter++,this.switchMoveRight(),"P"!==this.getPiece(i,o)&&"p"!==this.getPiece(i,o)||2!==Math.abs(t-i)||("w"===this.moveRight?("P"===this.getPiece(i,o-1)||"P"===this.getPiece(i,o+1))&&(this.ep=n):("p"===this.getPiece(i,o-1)||"p"===this.getPiece(i,o+1))&&(this.ep=o)),this},Chess.Position.prototype.nextMoveIsBlack=function(){return"b"===this.moveRight},Chess.Position.prototype.nextMoveIsWhite=function(){return"w"===this.moveRight},Chess.Position.prototype.lastMoveWasBlack=function(){return"w"===this.moveRight},Chess.Position.prototype.lastMoveWasWhite=function(){return"b"===this.moveRight},Chess.Position.prototype.getMoveRight=function(){return this.moveRight},Chess.Position.prototype.getCan=function(){return this.isRootPosition()?void 0:(this.moveFormats.can||(this.moveFormats.can=this.moveCoords.toString()),this.moveFormats.can)},Chess.Position.prototype.getLan=function(){return this.isRootPosition()?void 0:(this.moveFormats.lan||(this.moveFormats.lan=Chess.translate.moveToLan(this.moveCoords,this.pieceUsed,this.hasTakenPiece,this.isCheckMate(),this.isCheck())),this.moveFormats.lan)},Chess.Position.prototype.getSan=function(){return this.isRootPosition()?void 0:(this.moveFormats.san||(this.moveFormats.san=Chess.translate.moveToSan(this.moveCoords,this.pieceUsed,this.parentMove.getMoveList("piece",this.pieceUsed),this.hasTakenPiece,this.isCheckMate(),this.isCheck())),this.moveFormats.san)},Chess.Position.prototype.getFan=function(){return this.isRootPosition()?void 0:(this.moveFormats.fan||(this.moveFormats.fan=Chess.translate.moveToFan(this.moveCoords,this.pieceUsed,this.parentMove.getMoveList("piece",this.pieceUsed),this.hasTakenPiece,this.isCheckMate(),this.isCheck())),this.moveFormats.fan)},Chess.Position.prototype.getSep=function(){return this.isRootPosition()?void 0:(this.moveFormats.sep||(this.moveFormats.sep=Chess.translate.moveToSep(this.moveCoords)),this.moveFormats.sep)},Chess.Position.prototype.setQuestion=function(e){return this.question=new Chess.Question(e),this},Chess.Position.prototype.getQuestion=function(){if(!this.question){this.question=new Chess.Question;for(var e=0;e<this.childrenMoves.length;e++)this.question.addAnswer(this.childrenMoves[e].moveCoords,this.childrenMoves[e].comment,0===e,0)}return this.question},Chess.Position.prototype.addChat=function(e,t,n){if(n=parseInt(n||Date.now(),10),"string"!=typeof t||!t.length||isNaN(n))return errorHandler.msg("notice",new Error("ignored invalid chat message"),!1,{id:e,message:t,timestamp:n}),!1;for(var i=this.getChat(),o={id:e,message:t,timestamp:n},r=i.length;r>0&&(i[r-1]&&!(i[r-1].timestamp<=n));r--);return i.splice(r,0,o),o},Chess.Position.prototype.addGlyph=function(e){var t=this.getGlyphes();return t.contains(e)||t.push(e),this},Chess.Position.prototype.removeGlyph=function(e){var t=this.getGlyphes();return void 0===e?t.splice(0,t.length):t.removeByValue(e),this},Chess.Position.prototype.setGlyphes=function(e){var t=this.getGlyphes();return t.splice(0,t.length),e.forEach(this.addGlyph,this),this},Chess.Position.prototype.countRepetition=function(){function e(e){return e.split(" ",4).join(" ")}for(var t=this,n=t,i=1,o=e(t.toString());n=n.parentMove;){var r=e(n.toString());if(r===o&&i++,0===n.actionCounter)break}return i},Chess.Position.prototype.getEngine=function(e,t,n){var i=Handler.engine.get(this,e,t,n);return i=Handler.engine.invertData(this,i)},Chess.Position.prototype.hasGlyphes=function(){return!!this.getGlyphes().length},Chess.Position.prototype.toString=function(){for(var e="",t=7;t>=0;t--){for(var n=0;8>n;n++)e+=this.getPiece(t,n);t>0&&(e+="/")}if(e=Chess.translate.longToShortPositionGroup(e)+" "+this.moveRight+" ",e+=Helper.Chess960.getCastlingRightsFenPart(this.castlingRights),-1!==this.ep){var i=Chess.translate.encodeHumanCordX(this.ep);i+="w"===this.moveRight?"6":"3"}else i="-";return e+=" "+i,e+=" "+this.actionCounter,e+=" "+this.moveCounter},Chess.Position.prototype.setHighlights=function(e){Array.isArray(e)||errorHandler.error(new Error("highlightsData is not an array"),{highlightsData:e});var n=this.getHighlights();n.length=0;for(var i=0;i<e.length;i++)t(e[i]),n.push(e[i]);return this},Chess.Position.prototype.goesIntoIllegalPosition=function(e){var t=this.toString(),n=i.goesIntoIllegalPosition[t]={},o=this.addChild({move:e,simpleMove:!0}),r=o.isIllegal();return o.destroy(),n[e.can]=r,r},Chess.Position.prototype.checkMove=function(e){var t=this.toString(),n=i.checkMove[t]={};if(void 0!==n[e.can])return n[e.can];var o=e.startSquare,r=e.endSquare,a=this.getPiece(e.startSquare),s=this.getPiece(e.endSquare);if("-"===a||!e.onBoard)return n[e.can]=!1;var l=a===a.toLowerCase()?"b":"w";if(l!==this.moveRight)return n[e.can]=!1;var c=Chess.getPiece(a,l,"P"===a&&1===o.y||"p"===a&&6===o.y);if("-"!==s&&(s===s.toLowerCase()?"b":"w")===this.moveRight&&!Helper.Chess960.isMoveValidCastle(this,o,r,!0)&&!Helper.Chess960.isMoveValidCastle(this,o,r,!1))return n[e.can]=!1;if("k"===c.type&&(Helper.Chess960.isMoveValidCastle(this,o,r,!0)||Helper.Chess960.isMoveValidCastle(this,o,r,!1)))return n[e.can]=!0;if(this.goesIntoIllegalPosition(e))return n[e.can]=!1;if("-"===s&&this.ep===r.x&&"p"===c.type&&1===Math.abs(o.x-r.x)&&("b"===l&&2===r.y&&3===o.y||"w"===l&&5===r.y&&4===o.y))return n[e.can]=!0;if(7===r.y&&"P"===a||0===r.y&&"p"===a){if(!/[rbnq]/i.test(e.promotion||""))return n[e.can]=!1}else if(e.promotion)return n[e.can]=!1;for(var d=c.getPossibleDistances(),u=d.pieceHasSameMoveAndTakingBehavior||"-"===s?d.move:d.take,h=0;h<u.length;h++)for(var p=0;p<u[h].length;p++){var f=o.overlaySquare(u[h][p]);if(!f.onBoard)break;if(r.x===f.x&&r.y===f.y)return n[e.can]=!0;var g=this.getPiece(f);if("-"!==g)break}return n[e.can]=!1},Chess.Position.prototype.addHighlight=function(e){t(e);var n=this.getHighlights(),i=!0;if(!e.temporary)for(var o=n.length-1;o>=0;o--){var r=n[o];(Chess.isSquare(e.square)&&e.square===r.square||Chess.isMove(e.line)&&Chess.isMove(r.line)&&e.line.can===r.line.can||Chess.isSquare(e.frame)&&e.frame===r.frame)&&(n.splice(o,1),e.color===r.color&&(i=!1))}return i&&n.push(e),this},Chess.Position.prototype.deleteHighlight=function(e){for(var t=this.getHighlights(),n=t.length-1;n>=0;n--){var i=t[n];(Chess.isSquare(e.square)&&e.square===i.square||Chess.isMove(e.line)&&Chess.isMove(i.line)&&e.line.can===i.line.can||Chess.isSquare(e.frame)&&e.frame===i.frame)&&e.temporary==i.temporary&&t.splice(n,1)}return this},Chess.Position.prototype.deleteHighlightsByType=function(e){for(var t=this.getHighlights(),n=t.length-1;n>=0;n--){var i=t[n];("square"===e&&Chess.isSquare(i.square)||"line"===e&&Chess.isMove(i.line)||"frame"===e&&Chess.isSquare(i.frame))&&t.splice(n,1)}},Chess.Position.prototype.countPiecesOnBoard=function(){var t=this.toString();return i.pieceCount[t]||(i.pieceCount[t]=e(this.getPiece()))},Chess.Position.prototype.ep=-1,Chess.Position.prototype.destroy=function(){delete this.parentMove,this.childrenMoves&&this.childrenMoves.splice(0,this.childrenMoves.length);for(var e in this)Object.has(this,e)&&delete this[e]},Chess.Position.prototype.isValid=function(e){for(var t=!1,n=!1,i={k:[1,1],q:[0,9],r:[0,10],n:[0,10],b:[0,10],p:[0,8],white:[1,16],black:[1,16]},o=this.countPiecesOnBoard(),r=["k","q","r","n","b","p","K","Q","R","N","B","P","white","black"],a=0;a<r.length;a++)(o[r[a]]<i[r[a].toLowerCase()][0]||o[r[a]]>i[r[a].toLowerCase()][1])&&(t=!0);o.k&&o.K&&(this.isAttacked(this.kingPos.b)&&this.isAttacked(this.kingPos.w)&&(n=!0),this.isAttacked(this.kingPos.b)&&"w"===this.moveRight&&(n=!0),this.isAttacked(this.kingPos.w)&&"b"===this.moveRight&&(n=!0));for(var a=0;8>a;a++)"p"===this.getPiece(0,a).toLowerCase()&&(t=!0);for(var a=0;8>a;a++)"p"===this.getPiece(7,a).toLowerCase()&&(t=!0);return(""!==this.castlingRights.white.kingSide&&!Helper.Chess960.areKingAndRookPlacedForCastle(this,!0,!0)||""!==this.castlingRights.white.queenSide&&!Helper.Chess960.areKingAndRookPlacedForCastle(this,!1,!0)||""!==this.castlingRights.black.kingSide&&!Helper.Chess960.areKingAndRookPlacedForCastle(this,!0,!1)||""!==this.castlingRights.black.queenSide&&!Helper.Chess960.areKingAndRookPlacedForCastle(this,!1,!1))&&(t=!0),!n&&(e||!t)}}(),"undefined"==typeof Chess&&(Chess={}),Chess.Question=function(e){var t=this,n={};void 0===e&&(t.autoGenerated=!0);var i="object"==typeof window&&"function"===window.t||function(e){return e};t.question=e||i("Try to guess the next move"),t.defaultWrongAnswer=i("This is not the best move. Try again!"),t.defaultCorrectAnswer=i("Correct!");var o=0;return t.addAnswer=function(e,i,r,a){return Chess.isMove(e)&&"boolean"==typeof r&&"number"==typeof a||errorHandler.msg("error",new Error("invalid argument"),!0,{move:e,feedback:i,correctAnswer:r,points:a}),n[e.toString()]={feedback:i||(r?t.defaultCorrectAnswer:t.defaultWrongAnswer),correctAnswer:r,points:a},a>o&&(o=a),t},t.checkAnswer=function(e){return e=e.toString(),void 0!==n[e]?{feedback:n[e].feedback,correctAnswer:n[e].correctAnswer,points:n[e].points,maximumPoints:o}:{feedback:t.defaultWrongAnswer,correctAnswer:!1,points:0,maximumPoints:o}},t.getAnswer=function(e){return void 0===e?n:n[e.toString()]},t.getMaximumPoints=function(){return o},t},function(){function e(e,t){var n=this;return n.y=parseInt(e,10),n.x=parseInt(t,10),(isNaN(n.y)||isNaN(n.x))&&errorHandler.error(new Error("Illegal parameter in square Constructor"),{x:t,y:e}),n.onBoard=this.y>=0&&this.y<=7&&this.x>=0&&this.x<=7,n.human=String.fromCharCode(this.x+97)+(this.y+1),n}"undefined"==typeof Chess&&(Chess={});var t=[];Chess.getSquare=function(n,i){return void 0===t[n]&&(t[n]=[]),t[n][i]||(t[n][i]=new e(n,i))},Chess.isSquare=function(t){return t instanceof e},e.prototype.getNewSquare=function(e,t){return isNaN(e)&&(e=0),isNaN(t)&&(t=0),Chess.getSquare(this.y+e,this.x+t)},e.prototype.overlaySquare=function(e){return this.getNewSquare(e.y,e.x)},e.prototype.isOnBoard=function(){return this.onBoard},e.prototype.toString=function(){return this.human}}(),function(){var e=function(e,t,n){function i(){return d.splice(0,d.length),e}function o(t,n){return"object"!=typeof t&&errorHandler.msg("error",new Error("given decorator is not a object"),!0,{decorator:t}),void 0!==n?0===n&&d.unshift(t):d.push(t),e}function r(t){return"number"==typeof t?(d.remove(t),e):("object"!=typeof t&&errorHandler.msg("error",new Error("given decorator is not a function"),!0,{decorator:t}),d.removeByValue(t),e)}function a(){return d}function s(){return c}function l(n){"string"==typeof n&&(c=n,n=t[n]),Array.isArray(n)||errorHandler.msg("error",new Error("given decoratorSet is not a array"),!0,{newDecoratorSet:n}),i();for(var r=0;r<n.length;r++)o(n[r]);return e}var c,d=[];void 0===n&&(n={}),n.clear=n.clear||"clearDecorators",n.add=n.add||"clearDecorator",n.remove=n.remove||"removeDecorator",n.get=n.get||"getDecorators",n.set=n.set||"setDecorators",n.getCurrentSetName=n.getCurrentSetName||"getCurrentSetName";for(var u in n)void 0!==e[n[u]]&&errorHandler.msg("error",new Error("can not make this decoratable, because a needed function is blocked"),!0,{method:n[u]});for(var h in n)void 0!==e[n[h]]&&errorHandler.msg("error",new Error("can not make this to a publisher, because a needed function is blocked"),!0,{blockedFunction:h});return e[n.clear]=i,e[n.add]=o,e[n.remove]=r,e[n.get]=a,e[n.set]=l,e[n.getCurrentSetName]=s,e};"undefined"!=typeof exports?module.exports=e:("undefined"==typeof Extend&&(Extend={}),Extend.Decoratable=e)}(),inheritable.simpleExtend=function(e,t){if("object"!=typeof e)return e;for(var n in t)"object"==typeof t[n]?e[n]=inheritable.simpleExtend({},t[n]):e[n]=t[n];return e},inheritable.extend=function(e){var t=this.prototype||Function.prototype,n={};for(var i in e)n[i]=e[i];for(var i in t)"function"==typeof t[i]?"undefined"==typeof n[i]&&(n[i]=t[i]):"object"==typeof t[i]?n[i]=inheritable.simpleExtend({},t[i]):n[i]=t[i];n._stack=(t._stack||[]).concat([t]);var o=function(){var e=this,i={};for(var o in t)i[o]=function(t){return function(){var i=n._stack.pop(),o=i[t].apply(e,arguments);return n._stack.push(i),o}}(o);return i},r=function(){return this.parent=o.call(this),e.__constructor?(n.constructor=e.__constructor,e.__constructor.apply(this,arguments)):this};return r.prototype=n,r.extend=this.extend,r},function(){function e(e,t){function n(){if(t.encoders){for(var n in t.encoders)c(n,t.encoders[n]);delete t.encoders}if(void 0!==t.config&&(i(t.config),delete t.config),void 0!==t.validators&&(o(t.validators),delete t.validators),void 0!==t.init&&"function"==typeof t.init&&(t.init(e),delete t.init),void 0!==t.attributes)for(var r in t.attributes){var a=t.attributes[r];e.set(r,a)}}function i(e){void 0!==e.publishDirectly&&(m.publishDirectly=!!e.publishDirectly)}function o(e){if("object"==typeof e)for(var t in e){var n=e[t];if(Array.isArray(n))for(var i=0;i<n.length;i++)d(t,n[i]);else d(t,n)}}function r(t,n,i,o){var r=!0;if(!o)if(n===p[t]||"number"==typeof n&&isNaN(n))r=!1;else if(!i&&"object"==typeof n){var a=p[t],s=n;if(void 0===a){if(void 0!==g[t])try{s=e.encode(t,s)}catch(l){}}else{if(void 0!==g[t])try{a=e.encode(t,a),s=e.encode(t,s)}catch(l){}try{a=JSON.stringify(a),s=JSON.stringify(s),a===s&&(r=!1)}catch(l){}}}if(r&&void 0!==p[t]&&!Array.isArray(n)&&"function"==typeof e.createPatch&&(o=e.createPatch(t,p[t],n),Array.isArray(o)&&0===o.length&&(r=!1)),i&&"function"==typeof e.afterRefetch&&p[t]){var c=e.afterRefetch(t,p[t],n);return p[t]=n,c}if(p[t]=n,r){var d={name:"set."+t,data:{key:t,value:n}};return o&&(d.data.diff=o),h(d),{diff:o,newData:r}}return{newData:r}}function a(e){return p[e]}function s(e){return void 0!==p[e]}function l(e){if(s(e)){var t={name:"unset."+e,data:{key:e,value:a(e)}};return delete p[e],h(t),!0}return!1}function c(e,t){"function"!=typeof t&&errorHandler.msg("error",new Error("Transformer is not a function"),!0,{key:e}),g[e]=t}function d(e,t){if(void 0===f[e]&&(f[e]=[]),Array.isArray(t))for(var n=0;n<t.length;n++)"function"==typeof t[n]&&f[e].push(t[n]);else f[e].push(t)}function u(e,t){if(void 0!==f[e]){for(var n=!1,i=0;i<f[e].length;i++){var o=f[e][i];o(t)!==!0&&(n=!0)}return!n}return!0}function h(t){m.publishDirectly===!0?e.emit(t.name,t.data):v.push(t)}Extend.Publisher(e),t=t||{};var p={},f={},g={},m={publishDirectly:!0},v=[];return e.set=function(t,n,i,o,a){function s(e,t){var n=r(e,t,o,a);l[e]=n.newData,void 0!==n.diff&&(c[e]=n.diff)}var l={};i=i||!1;var c={};if("object"==typeof t){var d=t,h=!1;for(var t in d)u(t,d[t])!==!0&&i!==!0&&(h=!0);if(h===!0)return!1;for(var t in d)s(t,d[t]);var p=d}else{if(u(t,n)!==!0&&i!==!0)return!1;s(t,n),p={},p[t]=n}return e.afterSet(p,c,l),!0},e.afterSet=function(){return e},e.validate=function(e,t){return u(e,t)},e.encode=function(e,t){return g[e]?g[e](t):t},e.get=function(e){if(Array.isArray(e)){for(var t=e,n={},e=0;e<t.length;e++)n[t[e]]=a(t[e]);return n}return a(e)},e.has=function(e){return s(e)},e.unset=function(e){if(Array.isArray(e)){for(var t=e,n=!1,e=0;e<t.length;e++)l(t[e])||(n=!0);return!n}return l(e)},e.save=function(){for(;v.length;){var t=v.pop();e.emit(t.name,t.data)}},e.addValidator=function(e,t){d(e,t)},e.getAttributes=function(){return Object.copy(p)},e.toJSON=function(){return JSON.stringify({attributes:p,validators:f,config:m})},e.remove=function(){var e={name:"remove"};h(e)},n(),e}"undefined"!=typeof exports?module.exports=e:("undefined"==typeof Extend&&(Extend={}),Extend.Model=e)}(),function(){var e=function(e,t,n,i,o){function r(e){a(e),o()}function a(t){for(var n in t)t[n]=e.encode(n,t[n]);
isNaN(t.__messageId)&&errorHandler.critical(new Error("initObject.__messageId is not a number"),{messageId:t.__messageId}),h.reset(parseInt(t.__messageId,10)+1),delete t.__messageId,d&&Object.extend(t,d),u.set(t,void 0,void 0,!0)}function s(t){for(var n in t.diffs)d&&Object.has(d,n)||u.set(n,e.patch(n,t.diffs[n]),void 0,void 0,t.diffs[n]);for(var n in t.attributes)d&&Object.has(d,n)||u.set(n,t.attributes[n]);return e}function l(i){return t.emit("get",n.rkey,i||a),e}function c(e){return d&&void 0!==d[e]?d[e]:u.get(e)}i=i||{},delete i.attributes,i.config=i.config||{},i.config.publishDirectly=!0,Extend.Model(e,i);var d,u={remove:e.remove,set:e.set,unset:e.unset,get:e.get},h=new Helper.MessageQueue(s,2e4,l);return t.subscribe(n.rkey),l(r),t.on(n.rkey,function(e){switch(e.action){case"unset":u.unset(e.key);break;case"set":h.addMessage(e.messageId,e);break;case"remove":t.emit("unsubscribe",n.rkey),u.remove();break;default:errorHandler.msg("error",new Error("the action is not defined in socketPR"),!0,{update:e})}}),e.getModelSpec=function(){return n},e.set=function(){return!1},e.get=function(e){return Array.isArray(e)?e.map(c):c(e)},e.setOverrides=function(t){return d=t,e},e.patch=function(t,n){var i=e.get(t);return"object"!=typeof i&&errorHandler.msg("critical",new Error("can only patch objects"),!0,{currentValue:i,key:t,diff:n}),Object.patch(Object.copy(i),n)},e.unsubscribe=function(){t.subscribe(n.rkey)},e};"undefined"!=typeof exports?module.exports=e:("undefined"==typeof Extend&&(Extend={}),Extend.SocketPR=e)}(),function(){var e=function(e,t,n,i){function o(e,i){i=i||"on",!Object.keys(t).length||"object"==typeof e&&"function"==typeof e[i]||errorHandler.msg("error",new Error("can not link this subscriber, because you want to link to something that is not a publisher"),!0,{publisher:e,subscriptions:t}),"function"==typeof n.beforeLink&&n.beforeLink({publisher:e});for(var o in t){if("function"==typeof t[o])var r,a=t[o];else if("object"==typeof t[o]&&"function"==typeof t[o].callback)var a=t[o].callback,r=t[o].sync;else errorHandler.msg("error",new Error("given callback is neither function nor object with callback and sync property"),!0,{publisher:e,subscriptions:t});e[i](o,a,void 0,r)}return"function"==typeof n.afterLink&&n.afterLink({publisher:e}),this}function r(e,i){i=i||"off",("object"!=typeof e||"function"!=typeof e[i])&&errorHandler.msg("error",new Error("can not unlink this subscriber, because you want to link to something that is not a publisher"),!0,{publisher:e,subscriptions:t}),"function"==typeof n.beforeUnlink&&n.beforeUnlink({publisher:e});for(var o in t){if("function"==typeof t[o])var r=t[o];else if("object"==typeof t[o]&&"function"==typeof t[o].callback)var r=t[o].callback;else errorHandler.msg("error",new Error("given callback is neither function nor object with callback and sync property"),!0,{publisher:e,subscriptions:t});e[i](o,r)}return"function"==typeof n.afterUnlink&&n.afterUnlink({publisher:e}),this}void 0===i&&(i={}),i.link=i.link||"link",i.unlink=i.unlink||"unlink","object"!=typeof t&&errorHandler.msg("error",new Error("can not link this subscriber, because no subscriptions are defined"),!0,{subscriber:e,subscriptions:t}),"object"!=typeof n&&(n={});for(var a in i)void 0!==e[i[a]]&&errorHandler.msg("error",new Error("can not make this to a subscriber, because the needed link function is blocked"),!0,{blockedFunction:i[a]});return e[i.link]=o,e[i.unlink]=r,e};"undefined"!=typeof exports?module.exports=e:("undefined"==typeof Extend&&(Extend={}),Extend.Subscriber=e)}(),function(){var e=function(e,t,n){function i(){return h?e:(h=!0,d&&d.call(e),e)}function o(){return h?(h=!1,u&&u.call(e,p),p=!1,e):e}function r(){return h}function a(t){return void 0!==t&&"function"!=typeof t&&errorHandler.error(new Error("callback must be a function"),{badCallback:t}),d=t,e}function s(t){return void 0!==t&&"function"!=typeof t&&errorHandler.error(new Error("callback must be a function"),{badCallback:t}),u=t,e}function l(t){if(!h)return e;var n=typeof t;return"undefined"===n?p=!0:"boolean"==n?p=t:"object"==n?(("object"!=typeof p||Array.isArray(p))&&(p={}),p=Object.merge(p,t)):Array.isArray(p)?p.push(t):p=[t],e}function c(t,n){return function(){return h?void(n||l()):t.apply(e,arguments)}}void 0===n&&(n={}),n.suspend=n.suspend||"suspend",n.resume=n.resume||"resume",n.outdate=n.outdate||"outdate",n.delegate=n.delegate||"delegate",n.isSuspended=n.isSuspended||"isSuspended",n.onSuspend=n.onSuspend||"onSuspend",n.onResume=n.onResume||"onResume";var d,u,h=!!t,p=!!t;for(var f in n)void 0!==e[n[f]]&&errorHandler.error(new Error("can not make this to a suspendable, because a needed function is blocked"),{blockedFunction:f});return e[n.suspend]=i,e[n.resume]=o,e[n.outdate]=l,e[n.delegate]=c,e[n.isSuspended]=r,e[n.onSuspend]=a,e[n.onResume]=s,e};"undefined"!=typeof exports?module.exports=e:("undefined"==typeof Extend&&(Extend={}),Extend.Suspendable=e)}(),"undefined"!=typeof exports&&(module.exports=buildTree),"undefined"==typeof Helper&&(Helper={}),Helper.Cache=function(e){var t=this,n={};return e=e||6e4,t.set=function(i,o,r){return n[i]={value:o,validUntil:Date.now()+(r||e)},t},t.get=function(e){return void 0!==n[e]&&n[e].validUntil>Date.now()?n[e].value:void 0},t.unset=function(e){return void 0!==n[e]&&delete n[e],t},t},"undefined"==typeof Helper&&(Helper={}),"undefined"==typeof Helper.Chess960&&(Helper.Chess960={}),function(){function e(e,t){return t?e.kingPos.w:e.kingPos.b}function t(e,t,n,i){var o=e.getPiece(t),r=e.getPiece(n);return i?"K"===o&&"R"===r:"k"===o&&"r"===r}function n(e,n,i,o){var r=e.getColor(),a=t(e,n,i,r);return a?Helper.Chess960.areKingAndRookPlacedForCastle(e,o,r):!1}function i(e){var t=e?"kingCastle":"queenCastle";return Helper.Chess960.castlingEndLines[t].king}Helper.Chess960.castlingRights={white:["K","Q","A","B","C","D","E","F","G","H"],black:["k","q","a","b","c","d","e","f","g","h"]},Helper.Chess960.getDefaultPosCastlingRights=function(){return JSON.parse(JSON.stringify({white:{kingSide:"",queenSide:""},black:{kingSide:"",queenSide:""}}))},Helper.Chess960.castlingKingEndSquares={kingCastle:{white:"g1",black:"g8"},queenCastle:{white:"c1",black:"c8"}},Helper.Chess960.castlingEndLines={kingCastle:{king:6,rook:5},queenCastle:{king:2,rook:3}},Helper.Chess960.setCastlingRightsFromFenPart=function(e,t){if("-"!==t)for(var n=0;n<t.length;n++){var i=t[n];switch(i){case"Q":i="A";break;case"q":i="a";break;case"K":i="H";break;case"k":i="h"}var o=i===i.toUpperCase(),r=o?e.kingPos.w:e.kingPos.b;if(r){var a=Chess.translate.decodeHumanCordX(i.toLowerCase()),s=r.x<a;Helper.Chess960.setCastlingRight(e,s,o,i)}else Helper.Chess960.setCastlingRight(e,!0,o,""),Helper.Chess960.setCastlingRight(e,!1,o,"")}},Helper.Chess960.getCastlingRightsFenPart=function(e){var t="";return t+=e.white.kingSide,t+=e.white.queenSide,t+=e.black.kingSide,t+=e.black.queenSide,""===t&&(t+="-"),t},Helper.Chess960.getOppositeColorCastlingRights=function(e){for(var t="",n=0;n<e.length;n++)e.charAt(n)===e.charAt(n).toLowerCase()&&(t+=e.charAt(n).toUpperCase());for(var i=0;i<e.length;i++)e.charAt(i)===e.charAt(i).toUpperCase()&&"-"!==e.charAt(i)&&(t+=e.charAt(i).toLowerCase());return t},Helper.Chess960.getCastlingRight=function(e,t,n){var i=n?"white":"black",o=t?"kingSide":"queenSide";return e.castlingRights[i][o]},Helper.Chess960.getKingFile=function(t,n){var i=e(t,n);return i.human.substring(0,1)},Helper.Chess960.areKingAndRookPlacedForCastle=function(e,n,i){var o=Helper.Chess960.getCastlingRight(e,n,i);if(""===o)return!1;var r=i?0:7,a=Chess.getSquare(r,Chess.translate.decodeHumanCordX(Helper.Chess960.getKingFile(e,i).toLowerCase())),s=Chess.getSquare(r,Chess.translate.decodeHumanCordX(o.toLowerCase()));return t(e,a,s,i)},Helper.Chess960.isMoveValidCastle=function(e,t,o,r){function a(e,t,n,i){var o=e.getPiece(t);return"-"===o||o===n||o===i}var s=e.getColor(),l=s?0:7;if(t.y!==l||o.y!==l)return!1;var c=e.getPiece(t.y,t.x),d=i(r),u=Chess.getSquare(o.y,o.x),h=Chess.getSquare(o.y,r?7:0);if(4===t.x&&d===o.x&&e.getPiece(h)===(s?"R":"r")&&(u=h),u.x!==Chess.translate.decodeHumanCordX(Helper.Chess960.getCastlingRight(e,r,e.getColor()).toLowerCase()))return!1;if(""===Helper.Chess960.getCastlingRight(e,r,s)||!n(e,t,u,r))return!1;var p,f=s?"R":"r";if(r)p=Math.min(Helper.Chess960.castlingEndLines.kingCastle.rook,t.x),d=Math.max(Helper.Chess960.castlingEndLines.kingCastle.king,u.x),d===Chess.translate.decodeHumanCordX(Helper.Chess960.getCastlingRight(e,!0,e.getColor()).toLowerCase())&&--d;else{var g=Chess.translate.decodeHumanCordX(Helper.Chess960.getCastlingRight(e,!1,e.getColor()).toLowerCase());p=Math.min(Helper.Chess960.castlingEndLines.queenCastle.king,g),d=Math.max(Helper.Chess960.castlingEndLines.queenCastle.rook,t.x),p===g&&++p}for(var m=p;d>=m;m++)if(!a(e,Chess.getSquare(l,m),c,f))return!1;p=Math.min(t.x,i(r)),d=Math.max(t.x,i(r));for(var m=p;d>=m;m++)if(e.isAttacked(Chess.getSquare(l,m)))return!1;return!0},Helper.Chess960.getMoveWithCastleInfo=function(e,t,n){n=void 0!==n?n:!0;var o=e.getColor()?0:7,r=o+1,a=Helper.Chess960.getKingFile(e,e.getColor()).toLowerCase(),s=n?Helper.Chess960.getCastlingRight(e,t,e.getColor()).toLowerCase():Chess.translate.encodeHumanCordX(i(t)),l=Chess.translate.canToMove(a+r+s+r);return Helper.Chess960.setMoveCastleInfo(l,e.getColor(),t),l},Helper.Chess960.setMoveCastleInfo=function(e,t,n){var o=t?0:7;e.setCastleInfo({isCastle:!0,isKingCastle:n,lineNum:o,humanLineNum:o+1,endSquare:Chess.getSquare(o,i(n))})},Helper.Chess960.setCastlingRight=function(e,t,n,i){var o=n?"white":"black",r=t?"kingSide":"queenSide";e.castlingRights[o][r]=i},Helper.Chess960.setCastlingRightByFile=function(e,t,n){Helper.Chess960.getCastlingRight(e,!0,!0)===t&&Helper.Chess960.setCastlingRight(e,!0,!0,n),Helper.Chess960.getCastlingRight(e,!1,!0)===t&&Helper.Chess960.setCastlingRight(e,!1,!0,n),Helper.Chess960.getCastlingRight(e,!0,!1)===t&&Helper.Chess960.setCastlingRight(e,!0,!1,n),Helper.Chess960.getCastlingRight(e,!1,!1)===t&&Helper.Chess960.setCastlingRight(e,!1,!1,n)},Helper.Chess960.translateFenToXFen=function(e){if(e.match(/_[kqKQ]+/)){var t=e.split("_");return t[2]=t[2].replace("q","a").replace("Q","A").replace("k","h").replace("K","H"),t.join("_")}return e},Helper.Chess960.translateXfenToFen=function(e){return e.match(/_[aAhH]+/)?e.replace("a","q").replace("A","Q").replace("h","k").replace("H","K"):e}}(),"undefined"==typeof Helper&&(Helper={}),Helper.Deferred=function(e,t){function n(){for(var e=arguments;s.length;)s.shift().apply(i,e);delete i.reject,delete i.resolve,r=void 0,a=void 0,s=void 0,i.promise.done=function(e){return o.success&&e.apply(i,o.data),i.promise},i.promise.fail=function(e){return o.success||e.apply(i,o.data),i.promise},i.promise.always=function(e){return void 0!==o.success&&e.apply(i,o.data),i.promise}}t=t!==!1;var i=this,o={success:void 0,data:void 0},r=[],a=[],s=[];return i.isOpen=function(){return void 0===o.success},i.resolve=function(){var e=arguments;for(o.success=!0,o.data=e;r.length;)r.shift().apply(i,e);return n.apply(i,e),i},i.reject=function(){var e=arguments;for(o.success=!1,o.data=e;a.length;)a.shift().apply(i,e);return n.apply(i,e),i},i.promise={},i.promise.done=function(e){return"function"!=typeof e?i.promise:void 0===o.success?(r.push(e),i.promise):(o.success===!0&&e.apply(i,o.data),i.promise)},i.promise.fail=function(e){return"function"!=typeof e?i.promise:void 0===o.success?(a.push(e),i.promise):(o.success===!1&&e.apply(i,o.data),i.promise)},i.promise.always=function(e){return"function"!=typeof e?i.promise:void 0===o.success?(s.push(e),i.promise):(void 0!==o.success&&e.apply(i,o.data),i.promise)},i},Helper.Deferred.prototype.resolve=Helper.Deferred.prototype.reject=function(){errorHandler.error("Deferred already complete")},"undefined"==typeof Helper&&(Helper={}),function(){function e(e,n,i,o){var r=t(e,n,i,o);if(r)return r-e}function t(e,t,o,r){if(e=parseInt(e,10),t=parseInt(t,10),e&&t){o=parseFloat(o),r=parseInt(r,10)||i(e);var a=n(e,t);return e+r*(o-a)}}function n(e,t){var n=t-e;return Math.abs(n)>400&&(n=n>0?400:-400),1/(1+Math.pow(10,n/400))}function i(e){return e>=2400?10:20}Helper.EloChangeFromChessGame=function(e,t,n){if(!e.isOver()||e.getDepth()<5)return{white:void 0,black:void 0};var i=e.getGameStatus().result;return Helper.EloChange(t.elo,n.elo,i.white,i.black,t.eloK,n.eloK)},Helper.EloChange=function(e,t,n,i,o,r){return Object.map(Helper.EloChangeHighPrecision(e,t,n,i,o,r),function(e){return isNaN(e)?e:Math.round(e)})},Helper.EloChangeHighPrecision=function(t,n,i,o,r,a){return{player:e(t,n,i,r),opponent:e(n,t,o,a)}}}(),"undefined"==typeof Helper&&(Helper={}),Helper.FixedSizeQueue=function(e,t){t=t||{};var n=this,i=[];return n.push=function(t){for(i=i.concat(t);i.length>e;)i.shift();return n},n.min=t.min||function(){return Math.min.apply(void 0,i)},n.max=t.max||function(){return Math.max.apply(void 0,i)},n.avg=t.avg||function(){return i.length?i.reduce(function(e,t){return e+t})/i.length:void 0},n.sum=t.sum||function(){return i.length?i.reduce(function(e,t){return e+t}):0},n.filter=t.filter||function(e){return i.filter(e)},n.find=t.find||function(e){return i.find(e)},n.remove=t.remove||function(e){return i=n.filter(function(){return!e.apply(this,arguments)}),n},n.getSize=t.getSize||function(){return i.length},n.getAll=function(){return Object.copy(i)},n.flush=function(){return i=[],n},n},Helper.formatTimeUsage=function(e,t){var n=Date.getSplitedTime(e);return n.hours>0?n.hours+"h"+n.minutes.toString().lpad("0",2)+"m":n.minutes>0?n.minutes+"m"+n.seconds.toString().lpad("0",2)+"s":n.seconds>9?n.seconds+"s":t&&n.seconds>0?n.seconds+"."+n.milliseconds.toString().lpad("0",3).substr(0,2)+"s":n.seconds>0?n.seconds+"s":t&&n.milliseconds>0?n.milliseconds+"ms":""},"undefined"==typeof Helper&&(Helper={}),Helper.MessageQueue=function(e,t,n){function i(){"function"==typeof n&&(r(),l=setTimeout(o,t))}function o(){s=void 0,n()}function r(){void 0!==l&&(clearTimeout(l),l=void 0)}function a(){for(var t=Object.keys(d).length;void 0!==d[s];){var n=d[s];delete d[s],t--,e(n),s++}t||r()}"function"!=typeof e&&errorHandler.error(new Error("need function to process messages"));var s,l,c=this;t=t||5e3;var d={};return c.addMessage=function(e,t){return d[e]=t,void 0===s?c:(e===s?a():void 0===l&&e>s&&i(),c)},c.reset=c.start=function(e){s=e;for(var t in d)if(parseInt(t,10)<s)delete d[t];else var n=!0;return n&&i(),a(),c},c},"undefined"==typeof Helper&&(Helper={}),function(){Helper.timer={},Helper.timer.Timeout=function(e,t){function n(){a||(a=!0,o=new Date,i=setTimeout(function(){a=!1,t=0,e()},t))}var i,o,r=this,a=!1;return r.pause=function(){a&&(a=!1,clearTimeout(i),t-=new Date-o)},r.resume=n,r.getTimeLeft=function(){return a&&(this.pause(),this.resume()),t},r.toString=function(){return JSON.stringify({id:i,running:a,started:o,timeLeft:this.getTimeLeft()})},n(),r},Helper.timer.Countdown=function(e,t,n,i){function o(e,t,n,i){n=n||dummy,i=i||dummy;var a=e%t!==0?e%t:t,s=e-a;r=setTimeout(function(){n(s),s>0?o(s,t,n,i):i()},a)}var r,a=this;return o(e,t,n,i),a.stop=function(){r&&clearTimeout(r)},a}}(),"undefined"==typeof Helper&&(Helper={}),Helper.UUID=function(e){function t(){function e(e){var t=(Math.random().toString(16)+"000000000").substr(2,8);return e?"-"+t.substr(0,4)+"-"+t.substr(4,4):t}return e()+e(!0)+e(!0)+e()}e=e||t();var n,i=this;i.getLong=function(){return e},i.getShort=function(){if(void 0!==n)return n;var t="0123456789abcdef",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_";if(e=e.replace(/[^0-9a-f]/gi,"").toLowerCase(),32!==e.length)return"";e=e.slice(6,8)+e.slice(4,6)+e.slice(2,4)+e.slice(0,2)+e.slice(10,12)+e.slice(8,10)+e.slice(14,16)+e.slice(12,14)+e.slice(16),e+="0";var o,r,a;n="";for(var s=0;33>s;)o=t.indexOf(e[s++])<<8|t.indexOf(e[s++])<<4|t.indexOf(e[s++]),r=o>>6,a=63&o,n+=i[r]+i[a];return n},i.isValid=function(){if(22===e.length)var t=/^[0-9a-zA-Z_-]{22}$/;else{if(36!==e.length)return!1;t=/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/}return void 0!==e&&null!==e.match(t)}},"undefined"==typeof Helper&&(Helper={}),Helper.WhiteOrBlackList=function(e){return this.list=e||[],this.isBlackList=!0,this},Helper.WhiteOrBlackList.prototype.add=function(e){return this.list.push(e),this},Helper.WhiteOrBlackList.prototype.remove=function(e){return this.list.removeByValue(e),this},Helper.WhiteOrBlackList.prototype.clear=function(){return this.list=[],this},Helper.WhiteOrBlackList.prototype.whiteList=function(){return this.isBlackList=!1,this},Helper.WhiteOrBlackList.prototype.blackList=function(){return this.isBlackList=!0,this},Helper.WhiteOrBlackList.prototype.check=function(e){if(-1===e)return!1;var t=this.list.contains(e);return this.isBlackList?!t:t},"undefined"!=typeof exports&&(module.exports=Helper.WhiteOrBlackList),"undefined"==typeof Record&&(Record={}),Record.ChessGameSocketPR=function(e,t,n,i){function o(e){return e.isOver()||0===i||isNaN(i)||(e.getEndOfMainlinePosition().moveMadeAt+=i),e}function r(e){if(e){var t=e.getAllPositions();for(var n in c){var i=t[n]&&t[n].getEngineFen();i&&(Handler.engine.set(i,"numerical",c[n]),delete c[n])}}}var a=a||{};a.encoders={chessGame:function(e){var t=o(Chess.couchToGame(e)).updateNextFreeKnotId(1e6).setDeleteMode({duringGame:{mainline:!1,sideline:!0},afterGame:{mainline:!1,sideline:!0}}).setMoveMode({duringGame:{mainline:!1,sideline:!0},afterGame:{mainline:!1,sideline:!0}}).setNoTimeout(!1).setClockStartMove(2).setRules("analyse");t.getStartPosition().countChildrenMoves()>0&&t.setCalcTimeSpendInThisMove(!0).setClockStartMove(1);var n=t.getAllPositions();for(var i in n)n[i].setSource("remote");return t}};var s=Extend.SocketPR(this,t,e,a,n),l={patch:s.patch,afterRefetch:s.afterRefetch};s.afterRefetch=function(e,t,n){return"chessGame"===e&&(t.emit("replaceChessGame",{oldGame:t,newGame:n}),t.setNoTimeout(!0).destroy()),{newData:!0}},s.patch=function(e,t){if("chessGame"===e){var n=s.get("chessGame");return Chess.gamePatch(n,t),0===n.getStartPosition().countChildrenMoves()?n.setClockStartMove(2).emit("movedPositionPointer.endOfMainline",n.getStartPosition()):n.setClockStartMove(1),n}return l.patch.apply(this,arguments)};var c={};return s.on("set.chessGame",function(e,t){r(t.value)}),s.on("set.engine",function(e,t){var n=t.diff||t.value;Object.forEach(n,function(e,n){c[n]=t.value[n]}),r(s.get("chessGame"))}),s},"undefined"==typeof Record&&(Record={}),Record.TournamentSocketPR=function(e,t,n){return Extend.SocketPR(this,t,e,{},n)},"undefined"==typeof Controller&&(Controller={}),function(){function e(e,t){return void 0===e?t:i.indexOf(e)}function t(e,t){var n={};"string"==typeof e&&(e=e.split(" "));for(var i in t){var o=e.indexOf(i);o>-1&&o<e.length-1&&(n[t[i]]=e[o+1])}return n}function n(e,t,n,i){void 0===i&&(i=function(e){return e});for(var o=0;o<n.length;o++){var r=e[n[o]];void 0!==r&&(t[n[o]]=i(r))}return t}var i=["starting","ready","idle","busy","error","terminated"],o={evaluationAntiHammer:[-1]};Controller.UCI=function(r,a){function s(e){return y("error"),k.emit("evaluation.finished",{error:e}),v(),w("quit"),k}function l(e){return F=e.replace(/^id name /,""),k}function c(e){e=e.replace(/^option name /,"");var t=e.split(" "),n=e.substr(0,e.indexOf("type")-1),i={type:t[t.indexOf("type")+1]};switch(i.type){case"spin":i.min=parseInt(t[t.indexOf("min")+1],10),i.max=parseInt(t[t.indexOf("max")+1],10),i["default"]=parseInt(t[t.indexOf("default")+1],10);break;case"check":i["default"]="true"===t[t.indexOf("default")+1];break;case"string":var o=t[t.indexOf("default")+1];"string"==typeof o&&(i["default"]=t[t.indexOf("default")+1].replace(/^<empty>$/,""));break;case"combo":i["default"]=t[t.indexOf("default")+1].replace(/^<empty>$/,""),i.values=[];for(var r=0;r<t.length;r++)"var"===t[r]&&i.values.push(t[r+1])}void 0!==i["default"]&&(E[n]&&(i.current=E[n].current),void 0===i.current&&(i.current=i["default"])),E[n]=i}function d(e){if(g("error"))return k;m("busy"),e=e.replace(/^bestmove /,"");var t=e.split(" ponder "),n=t[0],i=k.getEvaluation();if(i.evaluations||(i.evaluations=[]),i.evaluations[0]||(i.evaluations[0]={}),!(-1!==n.indexOf("none")||i.evaluations&&i.evaluations[0]&&i.evaluations[0].moves&&i.evaluations[0].moves[0])){errorHandler.warning(new Error("no moves stored in evaluation, so picking the bestmove now"),{bestMove:n,fen:k.getPosition()});var o=new Chess.Position({fen:k.getPosition()});o.isLegalMove(Chess.translate.canToMove(n))&&(i.evaluations[0].moves=[n])}i.evaluations&&i.evaluations[0]&&(i.evaluations[0].moves&&i.evaluations[0].moves[0]||0===i.evaluations[0].mate)?k.emit("evaluation.finished",i):(errorHandler.warning(new Error("binary finished task, but no valid move has been found"),{evaluation:i,fen:k.getPosition()}),k.emit("evaluation.finished",i));for(var r in S)k.setOption(r,S[r]),delete S[r];return A=100,y("idle"),k}function u(e){if(g("error"))return k;m("busy"),e.replace(/^info /,"");var n=t(e,{multipv:"multipv",cp:"score",mate:"mate"});if(n.multipv=parseInt(n.multipv-1,10),isNaN(n.multipv))return k;if(void 0===n.score&&void 0===n.mate)return errorHandler.error(new Error("There is an engine line with neither score nor mate information"),{line:e,score:n.score,mate:n.mate},!1);if(void 0!==n.mate&&(n.mate=parseInt(n.mate,10)),void 0!==n.score&&(n.score=parseInt(n.score,10)),0===n.mate)return k;e.indexOf(" pv ")>-1&&(n.moves=e.split(" pv ").pop().trim().split(" ",A));for(var i=0;i<T.evaluations.length;i++)if(n.moves&&T.evaluations[i]&&T.evaluations[i].moves&&T.evaluations[i].moves[0]===n.moves[0]){var o=n.multipv;n.multipv=i;break}void 0===T.evaluations[n.multipv]&&(T.evaluations[n.multipv]={});var r=T.evaluations[n.multipv];void 0!==n.score?(r.score=n.score*(T.nextMoveIsWhite?1:-1),delete r.mate):void 0!==n.mate&&(delete r.score,r.mate=n.mate*(T.nextMoveIsWhite?1:-1)),n.moves&&(r.moves=n.moves),void 0!==o&&T.evaluations.move(n.multipv,o);var a=Date.now();return x+h(I)<=a&&(I++,x=a,k.emit("evaluation",k.getEvaluation())),k}function h(e){return a.evaluationAntiHammer[Math.min(e,a.evaluationAntiHammer.length-1)]}function p(e){if(g("error"))return k;m("busy"),e.replace(/^info /,"");var i=t(e,{depth:"depth",seldepth:"selDepth",tbhits:"tbHits",time:"time",nodes:"nodes",nps:"nodesPerSecond"}),o=t(e,{cp:"score",mate:"mate"});return 0===parseInt(o.mate,10)&&(parseInt(i.depth,10)>0||e.contains("multipv"))?k:(n(i,T,["nodesPerSecond","tbHits","selDepth","depth","time","nodes"],function(e){return parseInt(e,10)}),Object.keys(o).length&&(_=o),0===parseInt(o.mate,10)&&k.stop(),k)}function f(t,n){var o=e(t,0),r=e(n,i.length-1);return(o>j||j>r)&&errorHandler.critical(new Error("engine is in wrong state"),{currentStatus:i[j],requiredLowStatus:t,requiredHighStatus:n}),k}function g(e){return i[j]===e}function m(e){g(e)||errorHandler.critical(new Error("engine is in wrong state"),{currentStatus:i[j],requiredStatus:e})}function v(){T={nextMoveIsWhite:!0,evaluations:[]},_=void 0}function y(e){var t=i.indexOf(e);return-1===t?errorHandler.critical(new Error("this engine state is not defined"),{possibleStatus:i,newStatus:e}):j!==t&&(j=t,k.emit("status."+i[j],i[j])),k}function w(e){r.write(e)}function b(e,t){for(var n=0;n<O.length;n++)if(O[n].regExp.test(t)&&(O[n].callback(t),O[n].stopParsing))return}function C(){j=0,E={},S={},a=a||{};for(var e in o)void 0===a[e]&&(a[e]=o[e]);v(),r.start(),w("uci")}var k=Extend.Publisher(this);a=a||{};var F,x,T,_,E,S,j=0,I=0,A=100,O=[{regExp:/^uciok$/,stopParsing:!0,callback:function(){w("isready")}},{regExp:/^readyok$/,stopParsing:!0,callback:function(){if(y("ready"),a.options)for(var e in a.options)k.getOption(e)&&k.setOption(e,a.options[e]);y("idle")}},{regExp:/^option name /,stopParsing:!0,callback:c},{regExp:/^id name /,stopParsing:!0,callback:l},{regExp:/^bestmove /,stopParsing:!0,callback:d},{regExp:/^info string/,stopParsing:!0,callback:dummy},{regExp:/^info /,callback:p},{regExp:/ multipv /,callback:u},{regExp:/^ERROR: /,stopParsing:!0,callback:s}];return k.getName=function(){return F},k.getEvaluation=function(){f("idle");var e=n(T,{engineName:k.getName()},["nodes","nodesPerSecond","depth","time","evaluations"]);return T.evaluations&&(e.evaluations=T.evaluations.slice().sort(function(e,t){var n=[],i=1e9;return[e,t].forEach(function(e){return void 0!==e.mate?e.mate<0?n.push(-i-e.mate):n.push(i-e.mate):n.push(e.score)}),n[1]-n[0]})),1===T.depth&&T.selDepth>T.depth&&T.tbHits&&(e.depth=T.selDepth),e.evaluations&&e.evaluations[0]||!_||0!==parseInt(_.mate,10)||(e.evaluations=[{mate:0,moves:[]}]),e},k.getOption=function(e){return f("ready"),void 0===e?E:E[e]},k.setOption=function(e,t){f("ready","busy");var n=E[e];if(!n)return errorHandler.warning("the engine does not offer this option",{optionName:e,newValue:t}),k;switch(n.type){case"spin":t=parseInt(t,10),isNaN(t)&&errorHandler.critical(new Error("value is not a number"),{currentOption:n,newValue:t}),(n.min>t||t>n.max)&&errorHandler.critical(new Error("value out of allowed range"),{currentOption:n,newValue:t});break;case"check":"boolean"!=typeof t&&errorHandler.critical(new Error("value is not a boolean"),{currentOption:n,newValue:t});break;case"combo":n.values.contains(t)||errorHandler.critical(new Error("value is not in the predefined combo list"),{values:n.values,newValue:t})}return w("setoption name "+e+("button"===n.type?"":" value "+t)),n.current=t,k},k.getStatus=function(){return i[j]},k.getPosition=function(){return f("idle"),T.fenPosition},k.getLatestInfo=function(){return T},k.setPosition=function(e,t){g("error")?y("idle"):m("idle");var n=new Chess.Position({dontCheckForInsufficentMaterial:!0,fen:e});if(t)for(var i=0;i<t.length;i++)n=n.move({move:Chess.translate.canToMove(t[i])});return v(),T.nextMoveIsWhite="w"===n.moveRight,T.fenPosition=n.toString(),w("position fen "+T.fenPosition),k},k.evaluate=function(e){f("ready","idle"),y("busy");var t=[];if("object"==typeof e){if("object"==typeof e.options)for(var n in e.options){var i=k.getOption(n);if(i){var o=i.current;S[n]=o,k.setOption(n,e.options[n])}}void 0!==e.lineLimit&&(A=parseInt(e.lineLimit,10)),void 0!==e.time&&t.push("movetime",e.time),void 0!==e.depth&&t.push("depth",e.depth),void 0!==e.nodes&&t.push("nodes",e.nodes),void 0!==e.mate&&t.push("mate",e.mate)}return 0===t.length&&t.push("infinite"),x=Date.now(),I=0,w("go "+t.join(" ")),k},k.newGame=function(){return w("ucinewgame"),k},k.stop=function(){f("busy","error"),w("stop")},k.restart=C,r.on("data",b),r.on("closed",function(){y("terminated"),C()}),C(),k}}(),function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery","jquery.ui.widget"],e):e(window.jQuery)}(function(e){"use strict";e.support.xhrFileUpload=!(!window.XMLHttpRequestUpload||!window.FileReader),e.support.xhrFormDataFileUpload=!!window.FormData,e.widget("blueimp.fileupload",{options:{namespace:void 0,dropZone:e(document),pasteZone:e(document),fileInput:void 0,replaceFileInput:!0,paramName:void 0,singleFileUploads:!0,limitMultiFileUploads:void 0,sequentialUploads:!1,limitConcurrentUploads:void 0,forceIframeTransport:!1,redirect:void 0,redirectParamName:void 0,postMessage:void 0,multipart:!0,maxChunkSize:void 0,uploadedBytes:void 0,recalculateProgress:!0,progressInterval:100,bitrateInterval:500,formData:function(e){return e.serializeArray()},add:function(e,t){t.submit()},processData:!1,contentType:!1,cache:!1},_refreshOptionsList:["namespace","fileInput","dropZone","pasteZone","multipart","forceIframeTransport"],_BitrateTimer:function(){this.timestamp=+new Date,this.loaded=0,this.bitrate=0,this.getBitrate=function(e,t,n){var i=e-this.timestamp;return(!this.bitrate||!n||i>n)&&(this.bitrate=(t-this.loaded)*(1e3/i)*8,this.loaded=t,this.timestamp=e),this.bitrate}},_isXHRUpload:function(t){return!t.forceIframeTransport&&(!t.multipart&&e.support.xhrFileUpload||e.support.xhrFormDataFileUpload)},_getFormData:function(t){var n;return"function"==typeof t.formData?t.formData(t.form):e.isArray(t.formData)?t.formData:t.formData?(n=[],e.each(t.formData,function(e,t){n.push({name:e,value:t})}),n):[]},_getTotal:function(t){var n=0;return e.each(t,function(e,t){n+=t.size||1}),n},_onProgress:function(e,t){if(e.lengthComputable){var n,i,o=+new Date;if(t._time&&t.progressInterval&&o-t._time<t.progressInterval&&e.loaded!==e.total)return;t._time=o,n=t.total||this._getTotal(t.files),i=parseInt(e.loaded/e.total*(t.chunkSize||n),10)+(t.uploadedBytes||0),this._loaded+=i-(t.loaded||t.uploadedBytes||0),t.lengthComputable=!0,t.loaded=i,t.total=n,t.bitrate=t._bitrateTimer.getBitrate(o,i,t.bitrateInterval),this._trigger("progress",e,t),this._trigger("progressall",e,{lengthComputable:!0,loaded:this._loaded,total:this._total,bitrate:this._bitrateTimer.getBitrate(o,this._loaded,t.bitrateInterval)})}},_initProgressListener:function(t){var n=this,i=t.xhr?t.xhr():e.ajaxSettings.xhr();i.upload&&(e(i.upload).bind("progress",function(e){var i=e.originalEvent;e.lengthComputable=i.lengthComputable,e.loaded=i.loaded,e.total=i.total,n._onProgress(e,t)}),t.xhr=function(){return i})},_initXHRData:function(t){var n,i=t.files[0],o=t.multipart||!e.support.xhrFileUpload,r=t.paramName[0];(!o||t.blob)&&(t.headers=e.extend(t.headers,{"X-File-Name":i.name,"X-File-Type":i.type,"X-File-Size":i.size}),t.blob?o||(t.contentType="application/octet-stream",t.data=t.blob):(t.contentType=i.type,t.data=i)),o&&e.support.xhrFormDataFileUpload&&(t.postMessage?(n=this._getFormData(t),t.blob?n.push({name:r,value:t.blob}):e.each(t.files,function(e,i){n.push({name:t.paramName[e]||r,value:i})})):(t.formData instanceof FormData?n=t.formData:(n=new FormData,e.each(this._getFormData(t),function(e,t){n.append(t.name,t.value)})),t.blob?n.append(r,t.blob,i.name):e.each(t.files,function(e,i){i instanceof Blob&&n.append(t.paramName[e]||r,i,i.name)})),t.data=n),t.blob=null},_initIframeSettings:function(t){t.dataType="iframe "+(t.dataType||""),t.formData=this._getFormData(t),t.redirect&&e("<a></a>").prop("href",t.url).prop("host")!==location.host&&t.formData.push({name:t.redirectParamName||"redirect",value:t.redirect})},_initDataSettings:function(e){this._isXHRUpload(e)?(this._chunkedUpload(e,!0)||(e.data||this._initXHRData(e),this._initProgressListener(e)),e.postMessage&&(e.dataType="postmessage "+(e.dataType||""))):this._initIframeSettings(e,"iframe")},_getParamName:function(t){var n=e(t.fileInput),i=t.paramName;return i?e.isArray(i)||(i=[i]):(i=[],n.each(function(){for(var t=e(this),n=t.prop("name")||"files[]",o=(t.prop("files")||[1]).length;o;)i.push(n),o-=1}),i.length||(i=[n.prop("name")||"files[]"])),i},_initFormSettings:function(t){t.form&&t.form.length||(t.form=e(t.fileInput.prop("form")),t.form.length||(t.form=e(this.options.fileInput.prop("form")))),t.paramName=this._getParamName(t),t.url||(t.url=t.form.prop("action")||location.href),t.type=(t.type||t.form.prop("method")||"").toUpperCase(),"POST"!==t.type&&"PUT"!==t.type&&(t.type="POST"),t.formAcceptCharset||(t.formAcceptCharset=t.form.attr("accept-charset"))},_getAJAXSettings:function(t){var n=e.extend({},this.options,t);return this._initFormSettings(n),this._initDataSettings(n),n},_enhancePromise:function(e){return e.success=e.done,e.error=e.fail,e.complete=e.always,e},_getXHRPromise:function(t,n,i){var o=e.Deferred(),r=o.promise();return n=n||this.options.context||r,t===!0?o.resolveWith(n,i):t===!1&&o.rejectWith(n,i),r.abort=o.promise,this._enhancePromise(r)},_chunkedUpload:function(t,n){var i,o,r,a,s=this,l=t.files[0],c=l.size,d=t.uploadedBytes=t.uploadedBytes||0,u=t.maxChunkSize||c,h=l.slice||l.webkitSlice||l.mozSlice;return this._isXHRUpload(t)&&h&&(d||c>u)&&!t.data?n?!0:d>=c?(l.error="Uploaded bytes exceed file size",this._getXHRPromise(!1,t.context,[null,"error",l.error])):(o=Math.ceil((c-d)/u),i=function(n){return n?i(n-=1).pipe(function(){var i=e.extend({},t);return i.blob=h.call(l,d+n*u,d+(n+1)*u),i.chunkIndex=n,i.chunksNumber=o,i.chunkSize=i.blob.size,s._initXHRData(i),s._initProgressListener(i),r=(e.ajax(i)||s._getXHRPromise(!1,i.context)).done(function(){i.loaded||s._onProgress(e.Event("progress",{lengthComputable:!0,loaded:i.chunkSize,total:i.chunkSize
}),i),t.uploadedBytes=i.uploadedBytes+=i.chunkSize})}):s._getXHRPromise(!0,t.context)},a=i(o),a.abort=function(){return r.abort()},this._enhancePromise(a)):!1},_beforeSend:function(e,t){0===this._active&&(this._trigger("start"),this._bitrateTimer=new this._BitrateTimer),this._active+=1,this._loaded+=t.uploadedBytes||0,this._total+=this._getTotal(t.files)},_onDone:function(t,n,i,o){this._isXHRUpload(o)||this._onProgress(e.Event("progress",{lengthComputable:!0,loaded:1,total:1}),o),o.result=t,o.textStatus=n,o.jqXHR=i,this._trigger("done",null,o)},_onFail:function(e,t,n,i){i.jqXHR=e,i.textStatus=t,i.errorThrown=n,this._trigger("fail",null,i),i.recalculateProgress&&(this._loaded-=i.loaded||i.uploadedBytes||0,this._total-=i.total||this._getTotal(i.files))},_onAlways:function(e,t,n,i){this._active-=1,i.textStatus=t,n&&n.always?(i.jqXHR=n,i.result=e):(i.jqXHR=e,i.errorThrown=n),this._trigger("always",null,i),0===this._active&&(this._trigger("stop"),this._loaded=this._total=0,this._bitrateTimer=null)},_onSend:function(t,n){var i,o,r,a=this,s=a._getAJAXSettings(n),l=function(n,o){return a._sending+=1,s._bitrateTimer=new a._BitrateTimer,i=i||(n!==!1&&a._trigger("send",t,s)!==!1&&(a._chunkedUpload(s)||e.ajax(s))||a._getXHRPromise(!1,s.context,o)).done(function(e,t,n){a._onDone(e,t,n,s)}).fail(function(e,t,n){a._onFail(e,t,n,s)}).always(function(e,t,n){if(a._sending-=1,a._onAlways(e,t,n,s),s.limitConcurrentUploads&&s.limitConcurrentUploads>a._sending)for(var i,o=a._slots.shift();o;){if(i=o.state?"pending"===o.state():!o.isRejected()){o.resolve();break}o=a._slots.shift()}})};return this._beforeSend(t,s),this.options.sequentialUploads||this.options.limitConcurrentUploads&&this.options.limitConcurrentUploads<=this._sending?(this.options.limitConcurrentUploads>1?(o=e.Deferred(),this._slots.push(o),r=o.pipe(l)):r=this._sequence=this._sequence.pipe(l,l),r.abort=function(){var e=[void 0,"abort","abort"];return i?i.abort():(o&&o.rejectWith(r,e),l(!1,e))},this._enhancePromise(r)):l()},_onAdd:function(t,n){var i,o,r,a,s=this,l=!0,c=e.extend({},this.options,n),d=c.limitMultiFileUploads,u=this._getParamName(c);if((c.singleFileUploads||d)&&this._isXHRUpload(c))if(!c.singleFileUploads&&d)for(r=[],i=[],a=0;a<n.files.length;a+=d)r.push(n.files.slice(a,a+d)),o=u.slice(a,a+d),o.length||(o=u),i.push(o);else i=u;else r=[n.files],i=[u];return n.originalFiles=n.files,e.each(r||n.files,function(o,a){var c=e.extend({},n);return c.files=r?a:[a],c.paramName=i[o],c.submit=function(){return c.jqXHR=this.jqXHR=s._trigger("submit",t,this)!==!1&&s._onSend(t,this),this.jqXHR},l=s._trigger("add",t,c)}),l},_replaceFileInput:function(t){var n=t.clone(!0);e("<form></form>").append(n)[0].reset(),t.after(n).detach(),e.cleanData(t.unbind("remove")),this.options.fileInput=this.options.fileInput.map(function(e,i){return i===t[0]?n[0]:i}),t[0]===this.element[0]&&(this.element=n)},_handleFileTreeEntry:function(t,n){var i,o=this,r=e.Deferred(),a=function(e){e&&!e.entry&&(e.entry=t),r.resolve([e])};return n=n||"",t.isFile?t._file?(t._file.relativePath=n,r.resolve(t._file)):t.file(function(e){e.relativePath=n,r.resolve(e)},a):t.isDirectory?(i=t.createReader(),i.readEntries(function(e){o._handleFileTreeEntries(e,n+t.name+"/").done(function(e){r.resolve(e)}).fail(a)},a)):r.resolve([]),r.promise()},_handleFileTreeEntries:function(t,n){var i=this;return e.when.apply(e,e.map(t,function(e){return i._handleFileTreeEntry(e,n)})).pipe(function(){return Array.prototype.concat.apply([],arguments)})},_getDroppedFiles:function(t){t=t||{};var n=t.items;return n&&n.length&&(n[0].webkitGetAsEntry||n[0].getAsEntry)?this._handleFileTreeEntries(e.map(n,function(e){var t;return e.webkitGetAsEntry?(t=e.webkitGetAsEntry(),t&&(t._file=e.getAsFile()),t):e.getAsEntry()})):e.Deferred().resolve(e.makeArray(t.files)).promise()},_getSingleFileInputFiles:function(t){t=e(t);var n,i,o=t.prop("webkitEntries")||t.prop("entries");if(o&&o.length)return this._handleFileTreeEntries(o);if(n=e.makeArray(t.prop("files")),!n.length){if(i=t.prop("value"),!i)return e.Deferred().resolve([]).promise();n=[{name:i.replace(/^.*\\/,"")}]}return e.Deferred().resolve(n).promise()},_getFileInputFiles:function(t){return t instanceof e&&1!==t.length?e.when.apply(e,e.map(t,this._getSingleFileInputFiles)).pipe(function(){return Array.prototype.concat.apply([],arguments)}):this._getSingleFileInputFiles(t)},_onChange:function(t){var n=t.data.fileupload,i={fileInput:e(t.target),form:e(t.target.form)};n._getFileInputFiles(i.fileInput).always(function(e){i.files=e,n.options.replaceFileInput&&n._replaceFileInput(i.fileInput),n._trigger("change",t,i)!==!1&&n._onAdd(t,i)})},_onPaste:function(t){var n=t.data.fileupload,i=t.originalEvent.clipboardData,o=i&&i.items||[],r={files:[]};return e.each(o,function(e,t){var n=t.getAsFile&&t.getAsFile();n&&r.files.push(n)}),n._trigger("paste",t,r)===!1||n._onAdd(t,r)===!1?!1:void 0},_onDrop:function(e){e.preventDefault();var t=e.data.fileupload,n=e.dataTransfer=e.originalEvent.dataTransfer,i={};t._getDroppedFiles(n).always(function(n){i.files=n,t._trigger("drop",e,i)!==!1&&t._onAdd(e,i)})},_onDragOver:function(e){var t=e.data.fileupload,n=e.dataTransfer=e.originalEvent.dataTransfer;return t._trigger("dragover",e)===!1?!1:(n&&(n.dropEffect="copy"),void e.preventDefault())},_initEventHandlers:function(){var e=this.options.namespace;this._isXHRUpload(this.options)&&(this.options.dropZone.bind("dragover."+e,{fileupload:this},this._onDragOver).bind("drop."+e,{fileupload:this},this._onDrop),this.options.pasteZone.bind("paste."+e,{fileupload:this},this._onPaste)),this.options.fileInput.bind("change."+e,{fileupload:this},this._onChange)},_destroyEventHandlers:function(){var e=this.options.namespace;this.options.dropZone.unbind("dragover."+e,this._onDragOver).unbind("drop."+e,this._onDrop),this.options.pasteZone.unbind("paste."+e,this._onPaste),this.options.fileInput.unbind("change."+e,this._onChange)},_setOption:function(t,n){var i=-1!==e.inArray(t,this._refreshOptionsList);i&&this._destroyEventHandlers(),e.Widget.prototype._setOption.call(this,t,n),i&&(this._initSpecialOptions(),this._initEventHandlers())},_initSpecialOptions:function(){var t=this.options;void 0===t.fileInput?t.fileInput=this.element.is('input[type="file"]')?this.element:this.element.find('input[type="file"]'):t.fileInput instanceof e||(t.fileInput=e(t.fileInput)),t.dropZone instanceof e||(t.dropZone=e(t.dropZone)),t.pasteZone instanceof e||(t.pasteZone=e(t.pasteZone))},_create:function(){var t=this.options;e.extend(t,e(this.element[0].cloneNode(!1)).data()),t.namespace=t.namespace||this.widgetName,this._initSpecialOptions(),this._slots=[],this._sequence=this._getXHRPromise(!0),this._sending=this._active=this._loaded=this._total=0,this._initEventHandlers()},destroy:function(){this._destroyEventHandlers(),e.Widget.prototype.destroy.call(this)},enable:function(){var t=!1;this.options.disabled&&(t=!0),e.Widget.prototype.enable.call(this),t&&this._initEventHandlers()},disable:function(){this.options.disabled||this._destroyEventHandlers(),e.Widget.prototype.disable.call(this)},add:function(t){var n=this;t&&!this.options.disabled&&(t.fileInput&&!t.files?this._getFileInputFiles(t.fileInput).always(function(e){t.files=e,n._onAdd(null,t)}):(t.files=e.makeArray(t.files),this._onAdd(null,t)))},send:function(t){if(t&&!this.options.disabled){if(t.fileInput&&!t.files){var n,i,o=this,r=e.Deferred(),a=r.promise();return a.abort=function(){return i=!0,n?n.abort():(r.reject(null,"abort","abort"),a)},this._getFileInputFiles(t.fileInput).always(function(e){i||(t.files=e,n=o._onSend(null,t).then(function(e,t,n){r.resolve(e,t,n)},function(e,t,n){r.reject(e,t,n)}))}),this._enhancePromise(a)}if(t.files=e.makeArray(t.files),t.files.length)return this._onSend(null,t)}return this._getXHRPromise(!1,t&&t.context)}})}),function(){var e={},n={INVALID:"Invalid value: {{value}}",OPTION_SELECTED:"Option must be selected",VALUE_REQUIRED:"Value is required",VALUE_DONT_MATCH:"Values don't match",VALUES_MATCH:"Values match",COMPARISION_FAILURE:"Comparison failure",INVALID_DATE:"Invalid date",INVALID_RANGE:"Invalid range",VALUE_NOT_IN_RANGE:"Value not in required range",INVALID_LENGTH:"Invalid length"},i=function(e){for(var t=1;t<arguments.length;t++)for(var n in arguments[t])arguments[t].hasOwnProperty(n)&&(e[n]=arguments[t][n]);return e};e.base=function(e){var t={errors:[],skipOnError:!1,before:function(e){return!this.skipOnError||!e.hasClass("error")},validateField:function(e){return this.validateValue(this.value(e))},validateValue:function(e){return!0},extend:function(e){var t=this;return function(n){return i({},t,e,n)}},value:function(e){return jQuery&&e instanceof jQuery?void 0===e.val()?e.get(0).getAttribute("value"):e.val():void 0===e.value?e.getAttribute("value"):e.value},empty:function(e){return""===e||null===e},assert:function(e,t){return this.errors=[],e||this.errors.push(t),e}};return"object"==typeof e&&(t=i(t,e)),t},e.ajax=e.base().extend({server:!0,allowEmpty:!0,url:"",method:"",rule:"",validateField:function(e){if(!jQuery)return!0;var t=this.value(e);if(this.allowEmpty&&this.empty(t))return!0;this.url||(this.url=e.closest("form").attr("action")),this.method||(this.method=e.closest("form").attr("method"));var n={csrf:e.closest("form").find("input[name=csrf]").val()||config.csrf(),"ajax-validation":this.rule},i=e.attr("name");n[i]=t;var o=this.request(n);if(this.assert(!0),"object"==typeof o)for(var r in o)r===i&&(this.errors=this.errors.concat(o[r]));return 0===this.errors.length},validateFieldDeferred:function(e){if(!jQuery)return!0;var t=this.value(e);if(this.allowEmpty&&this.empty(t))return!0;this.url||(this.url=e.closest("form").attr("action")),this.method||(this.method=e.closest("form").attr("method"));var n={csrf:e.closest("form").find("input[name=csrf]").val()||config.csrf(),"ajax-validation":"*"},i=e.attr("name");return n[i]=t,n},request:function(e){var t;return e=e||{},jQuery.ajax({type:this.method,url:this.url,dataType:"json",data:e,async:!1,success:function(e){t=e}}),t}}),e.match=e.base().extend({pattern:/^$/,allowEmpty:!0,not:!1,validateValue:function(e){e=this.prepare(e);var i=this.regexp();if(!(i instanceof RegExp))if("string"==typeof i){var o=i.match(/^\/(.+)\/([gim]*)/);i=o?new RegExp(o[1],o[2]):new RegExp(i)}else i=new RegExp(i);var r=this.allowEmpty&&this.empty(e)||e.match(i)&&this.also(e);return this.assert(this.not!=!!r,t(n.INVALID,{"{{value}}":e}))},regexp:function(){return this.pattern},prepare:function(e){return e},also:function(e){return!0}}),e["boolean"]=e.base().extend({trueValue:"1",falseValue:"0",allowEmpty:!0,validateValue:function(e){return this.assert(this.allowEmpty&&this.empty(e)||e==this.trueValue||e==this.falseValue,t(n.INVALID,{"{{value}}":e}))}}),e.required=e.base().extend({requiredValue:"",validateField:function(e){var i=this.value(e);return e.is("[type=checkbox],[type=radio]")?this.assert(e.is(":checked")&&(!this.requiredValue||i==this.requiredValue),t(n.OPTION_SELECTED)):this.assert(!(this.empty(i)||this.requiredValue&&i!=this.requiredValue),t(n.VALUE_REQUIRED))},validateValue:function(e){return this.assert(!(this.empty(e)||this.requiredValue&&e!=this.requiredValue),t(n.INVALID,{"{{value}}":e}))}}),e.captcha=e.ajax().extend({rule:"CaptchaValidator",allowEmpty:!1}),e.compare=e.base().extend({compareValue:"",compareAttribute:"",operator:"=",validateField:function(e){var i=this.value(e),o=this.compareValue;if(this.compareAttribute){var r=e.attr("name"),a="";if(!r)return this.assert(!0);a=r.match(/\[[^\]]+\]$/)?r.replace(/\[[^\]]+\]$/,"["+this.compareAttribute+"]"):this.compareAttribute;var s=jQuery('[name="'+a+'"]');if(!s.length)return this.assert(!0);o=this.value(s)}switch("="!=this.operator&&"!="!=this.operator&&(i=parseFloat(i),o=parseFloat(o)),this.operator){case"=":case"==":return this.assert(i==o,t(n.VALUE_DONT_MATCH));case"!=":return this.assert(i!=o,t(n.VALUES_MATCH));case"<":return this.assert(o>i,t(n.COMPARISION_FAILURE));case"<=":return this.assert(o>=i,t(n.COMPARISION_FAILURE));case">":return this.assert(i>o,t(n.COMPARISION_FAILURE));case">=":return this.assert(i>=o,t(n.COMPARISION_FAILURE))}return this.assert(!0)},validateValue:function(e){if(this.compareValue){if("="!==this.operator&&"!="!==this.operator)var i=parseFloat(e),o=parseFloat(this.compareValue);else i=e,o=this.compareValue;switch(this.operator){case"=":case"==":return this.assert(i==o,t(n.VALUE_DONT_MATCH));case"!=":return this.assert(i!=o,t(n.VALUES_MATCH));case"<":return this.assert(o>i,t(n.COMPARISION_FAILURE));case"<=":return this.assert(o>=i,t(n.COMPARISION_FAILURE));case">":return this.assert(i>o,t(n.COMPARISION_FAILURE));case">=":return this.assert(i>=o,t(n.COMPARISION_FAILURE))}}return this.assert(!0)}}),e.date=e.base().extend({format:"MM/dd/yyyy",allowEmpty:!0,validateValue:function(e){return this.allowEmpty&&this.empty(e)?this.assert(!0):this.assert(p.parse(e,this.format),t(n.INVALID_DATE))}}),e.email=e.match().extend({pattern:/^[a-zA-Z0-9!#$%&\'*+\\\/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&\'*+\\\/=?^_`{|}~-]+)*@(?:[a-zA-Z0-9](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?\.)+[a-zA-Z0-9](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?$/,fullPattern:/^[^@]*<[a-zA-Z0-9!#$%&\'*+\\\/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&\'*+\\\/=?^_`{|}~-]+)*@(?:[a-zA-Z0-9](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?\.)+[a-zA-Z0-9](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?>$/,allowName:!1,allowEmpty:!0,regexp:function(){return this.allowName?this.fullPattern:this.pattern},also:function(e){return e.length<254}}),e.exist=e.ajax().extend({rule:"exist"}),e.file=e.base,e.inline=e.ajax().extend({rule:"inline"}),e.numerical=e.match().extend({integerOnly:!1,allowEmpty:!0,max:null,min:null,integerPattern:/^\s*[+-]?\d+\s*$/,numberPattern:/^\s*[-+]?[0-9]*\.?[0-9]+([eE][-+]?[0-9]+)?\s*$/,regexp:function(){return this.integerOnly?this.integerPattern:this.numberPattern},also:function(e){return(this.empty(this.max)||parseFloat(this.max)>=parseFloat(e))&&(this.empty(this.min)||parseFloat(this.min)<=parseFloat(e))}}),e["in"]=e.base().extend({range:[],allowEmpty:!0,not:!1,validateValue:function(e){return this.allowEmpty&&this.empty(e)?this.assert(!0):Array.isArray(this.range)?this.assert(this.not!=this.range.contains(e),t("Value not in required range")):this.assert(!1,t(n.INVALID_RANGE))}}),e.safe=e.base,e.length=e.base().extend({allowEmpty:!0,max:null,min:null,is:null,validateValue:function(e){return this.allowEmpty&&this.empty(e)?!0:this.assert((!this.max||this.max>=e.length)&&(!this.min||this.min<=e.length)&&(!this.is||this.is==e.length),t(n.INVALID_LENGTH))}}),e.unique=e.ajax().extend({rule:"unique"}),e.unsafe=e.base,e.url=e.match().extend({pattern:/^({schemes}?\:\/\/[a-z][\w\.\-]+([\/\?].*)?)?(\#.*)?$/i,validSchemes:["http","https"],defaultScheme:null,allowEmpty:!0,prepare:function(e){!this.empty(e)&&this.defaultScheme&&-1==e.indexOf("://")&&(e=this.defaultScheme+"://"+e);var t=this.pattern.source;return-1!=t.indexOf("{schemes}")&&(this.pattern=new RegExp(t.replace("{schemes}","("+this.validSchemes.join("|")+")"),(this.pattern.ignoreCase?"i":"")+(this.pattern.global?"g":"")+(this.pattern.multiline?"m":""))),e}}),e.couchExists=e.ajax().extend({rule:"CouchExistsValidator"}),e.FEN=e.ajax().extend({rule:"FENValidator"}),e.html=e.ajax().extend({rule:"HtmlValidator"}),e.latitude=e.numerical().extend({integerOnly:!1,min:-90,max:90}),e.longitude=e.numerical().extend({integerOnly:!1,min:-180,max:180}),e.maxRows=e.ajax().extend({rule:"MaxRowsValidator"}),e.nick=e.ajax().extend({rule:"NickValidator"}),e.oneRequired=e.base().extend({}),e.permalink=e.match().extend({allowEmpty:!1,pattern:/^[a-z0-9-_]{3}[a-z0-9-_]*$/i}),e.UUID=e.match().extend({allowEmpty:!1,useShortVersion:!1,pattern:/^[0-9a-f]{8}(-[0-9a-f]{4}){3}-[0-9a-f]{12}$/,patternShort:/^[a-z0-9-_]{22}$/i,regexp:function(){return this.useShortVersion?this.patternShort:this.pattern}});var o=function(e,t){var n=e.attr("class");if(e.data("validatable-classes",n),!n)return[];for(var i=[],o=[],r="",a=0;a<n.length;a++)if("["===n.substr(a,1))for(var s=1;a<n.length&&(r+=n.substr(a,1),"]"!==n.substr(a,1)||(s--,0!==s));a++);else" "===n.substr(a,1)?(r.length&&o.push(r),r=""):r+=n.substr(a,1);r&&o.push(r),n=o;for(var a=0;a<n.length;a++){var l=n[a].match(/^validate\[(.*)\]$/);if(l){l=l[1];for(var c=[],d="",u={},h=0,p=!1,f=0;f<l.length;f++)if("["===l.substr(f,1)){var g="",m="",v=!1;for(f++;f<l.length;f++){if(!v||'"'!==l.substr(f,1)||m||p){if(v&&"["==l.substr(f,1)&&!m&&!p){m=[];var y="";for(f++;f<l.length;f++){if("]"===l.substr(f,1)){y&&m.push(y);break}","===l.substr(f,1)?(m.push(y),y=""):y+=l.substr(f,1)}continue}if("]"===l.substr(f,1)&&0===h&&!p){g&&("true"===m?m=!0:"false"===m&&(m=!1),u[g]=v?m:!0);break}","!==l.substr(f,1)||p?"="!==l.substr(f,1)||v?v?m+=l.substr(f,1):g+=l.substr(f,1):v=!0:(g&&("true"===m?m=!0:"false"===m&&(m=!1),u[g]=v?m:!0),v=!1,g="",m="")}else{for(f++;f<l.length&&'"'!==l.substr(f,1);f++)m+=l.substr(f,1);u[g]=m,y=""}"["!==l.substr(f,1)||p?"]"!==l.substr(f,1)||p||h--:h++,p="\\"===l.substr(f,1)}}else","===l.substr(f,1)?(d&&c.push([d,u]),d="",u={}):d+=l.substr(f,1);d&&c.push([d,u]);for(var f=0;f<c.length;f++)c[f][0]=c[f][0].replace(/^([A-Z])([^A-Z])/,function(e,t,n){return t.toLowerCase()+n}),c[f][0]=c[f][0].replace(/validator$/i,"");i=i.concat(c);var f}}return i},r=function(e){var t=e.data("field-errors");(!t||t&&t.length&&!t.closest("body").length)&&(t=e.siblings('.field-errors[data-field="'+e.attr("name")+'"]'),t.length||(t=e.closest("form").find('.field-errors[data-field="'+e.attr("name")+'"]')),!t.length&&e.attr("name")&&(t=jQuery('.field-errors[data-field="'+e.attr("name")+'"]')),t.length||(t=jQuery("<span/>").addClass("field-errors").attr("data-field",e.attr("name")).hide().insertAfter(e)),e.data("field-errors",t.appendTo(".pageContent").attr("x",e.attr("id"))));var n=e.closest(".modal, .bubble");n.length&&n.one("chess24:hide",function(){a(e)});var i=e.is(":visible")?e.offset():e.parent().offset(),o=e.is(":visible")?e.outerHeight():e.parent().outerHeight();return i&&t.css({left:i.left+"px",top:i.top+o+"px"}),t},a=function(e){if(e.is("form"))e.find("input,select,textarea").each(function(){a(jQuery(this))});else{var t=e.attr("class");if(!t)return;t=t.split(" ");for(var n=0;n<t.length;n++)"error"===t[n].substr(0,5)&&e.removeClass(t[n]);var i=r(e);i.hide().html(""),e.find(".form-errors, .field-errors").html("")}},s=function(t,n){a(t);for(var i=[],r=o(t,"skip"===n),s=!1,l=0;l<r.length;l++){var c=e[r[l][0]];if(c){if(c=c(r[l][1]),c.server){if("skip"===n)continue;if("return"===n){i.push(r[l]);continue}}c.before(t)&&!c.validateField(t)&&(t.trigger("validatable:error",{name:r[l][0],errors:c.errors}),s=!0)}}return s||t.trigger("validatable:ok"),"return"===n?i:void 0},l=function(t,n){a(t);var i=t.find("input,select,textarea"),o=!1,r=void 0;if(i.each(function(){var t=jQuery(this),i=s(t,n?"skip":"return");if(o=o||t.hasClass("error"),i)for(var a=0;a<i.length;a++){var l=e[i[a][0]];if(l){l=l(i[a][1]);var c=l.validateFieldDeferred(t);"object"==typeof c&&(r=jQuery.extend(r||{},c))}}}),r){var l=e.ajax();l.url=t.attr("action")||"",l.method=t.attr("method")||"post";var c=l.request(r);if("object"==typeof c){o=!0;for(var d in c)t.find('[name="'+d+'"]').trigger("validatable:error",{name:"",errors:c[d]})}}return t[o?"addClass":"removeClass"]("error"),!o},c=function(e,t){return"reset"===t?(a(e),void e.off("validatable:go").data("validatable",0)):"validate"===t?!e.trigger("validatable:go").hasClass("error"):"clientvalidate"===t?!e.trigger("validatable:go",!0).hasClass("error"):void 0},d=function(e,t){if(!e.data("validatable")){e.data("validatable",1),e.on("validatable:go",function(t,n){try{t.stopPropagation()}catch(i){t.cancelBubble=!0}s(e,n?"skip":void 0)}),e.on("validatable:error",function(t,n){var i=r(e);e.addClass("error error-"+n.name);var o=e.attr("data-error-"+n.name.toLowerCase())||e.attr("data-error-"+n.name.toLowerCase()+"validator")||e.attr("data-error")||n.errors.join("<br/>");o&&(i.html(o),i.show(),i.attr("data-success-class")&&i.removeClass(i.attr("data-success-class")),i.attr("data-error-class")&&i.addClass(i.attr("data-error-class")))}),e.on("validatable:ok",function(t){var n=r(e);n.length&&(n.attr("data-success-class")?n.addClass(n.attr("data-success-class")):n.hide(),n.attr("data-error-class")&&n.removeClass(n.attr("data-error-class")))});var n="change";e.is("input")&&"checkbox"!==e.attr("type")&&"radio"!==e.attr("type")&&"hidden"!==e.attr("type")&&(n="blur"),e.on(n,function(){a(e),e.closest("form").data("validatable")||e.trigger("validatable:go","clientvalidate"===t)}),e.on("focus click",function(){var t=r(e);t.hide()})}},u=function(e,t){return"validate"===t?!e.trigger("validatable:go").hasClass("error"):"clientvalidate"===t?!e.trigger("validatable:go",!0).hasClass("error"):"reset"===t?(a(e),e.find("input,select,textarea").each(function(){a(jQuery(this))}),void e.off("validatable:go").off("submit.validatable").data("validatable",0)):"clear"===t?void a(e):void 0},h=function(e,t){if(!e.data("validatable")){e.data("validatable",1);var n=e.find("input,select,textarea");n.each(function(){jQuery(this).validatable("reset")}),e.find('input[type="submit"]').on("click",function(t){t.preventDefault();const n=[];"clientvalidate"===e.data("validatemethod")&&n.push(!0),e.trigger("submit",n)}),e.on("submit.validatable validatable:go",function(t,n){if(l(e,n),e.hasClass("error")){for(var i=!1,o=e.parent();!o.is("body")&&o.length;){if("fixed"===o.css("position")){i=!0;break}o=o.parent()}if(!i){var r=e.find(".error:first").offset().top;(r<jQuery("body").prop("scrollTop")||r>jQuery("body").prop("scrollTop")+jQuery(window).height())&&jQuery("html,body").animate({scrollTop:r-100})}return t.stopPropagation(),t.preventDefault(),!1}})}};jQuery&&(jQuery.fn.validatable=function(e){var t=this;return this.each(function(){var n=jQuery(this);if(n.is("input,select,textarea")){var i=d(n,e);e&&(i=c(n,e)),t="validate"===e||"clientvalidate"===e?i:t}else if(n.is("form")){var i=h(n,e);e&&(i=u(n,e)),t="validate"===e||"clientvalidate"===e?i:t}}),t},jQuery.fn.validatable.validators=e);var p={parse:function(e,t,n){t=t||"MM/dd/yyyy",n=n||[];for(var i,o,r,a,s,l,c,d,u=this.tokenize(t),h=0,p=e.length,f=0;f<u.length;f++){var g=u[f];switch(g){case"yyyy":if((i=this.parseInteger(e,h,4,4))===!1)return!1;h+=4;break;case"yy":if((i=this.parseInteger(e,h,1,2))===!1)return!1;h+=i.length;break;case"MMMM":var m={monthName:""};if((o=this.parseMonth(e,h,"wide",m))===!1)return!1;h+=m.monthName.length;break;case"MMM":var m={monthName:""};if((o=this.parseMonth(e,h,"abbreviated",m))===!1)return!1;h+=m.monthName.length;break;case"MM":if((o=this.parseInteger(e,h,2,2))===!1)return!1;h+=2;break;case"M":if((o=this.parseInteger(e,h,1,2))===!1)return!1;h+=o.length;break;case"dd":if((r=this.parseInteger(e,h,2,2))===!1)return!1;h+=2;break;case"d":if((r=this.parseInteger(e,h,1,2))===!1)return!1;h+=r.length;break;case"h":case"H":if((a=this.parseInteger(e,h,1,2))===!1)return!1;h+=a.length;break;case"hh":case"HH":if((a=this.parseInteger(e,h,2,2))===!1)return!1;h+=2;break;case"m":if((s=this.parseInteger(e,h,1,2))===!1)return!1;h+=s.length;break;case"mm":if((s=this.parseInteger(e,h,2,2))===!1)return!1;h+=2;break;case"s":if((l=this.parseInteger(e,h,1,2))===!1)return!1;h+=l.length;break;case"ss":if((l=this.parseInteger(e,h,2,2))===!1)return!1;h+=2;break;case"a":if((c=this.parseAmPm(e,h))===!1)return!1;void 0!==a&&(12==a&&"am"===c?a=0:12>a&&"pm"===c&&(a+=12)),h+=2;break;default:if(d=g.length,h>=p||"?"!==g.substr(0,1)&&e.substr(h,d)!==g)return!1;h+=d}}if(p>h)return!1;void 0===i&&(i=(new Date).getFullYear()),void 0===o&&(o=(new Date).getMonth()+1),void 0===r&&(r=(new Date).getDate()),2===(""+i).length&&(i+=i>=70?1900:2e3),i=parseInt(i),o=parseInt(o),r=parseInt(r),void 0===a&&void 0===s&&void 0===l?(a=0,s=0,l=0):(void 0===a&&(a=(new Date).getHours()),void 0===s&&(s=(new Date).getMinutes()),void 0===l&&(l=(new Date).getSeconds()),a=parseInt(a),s=parseInt(s),l=parseInt(l));var v=new Date(i,o-1,r,a,s,l,0);return v.getFullYear()==i&&v.getMonth()+1==o&&v.getDate()==r&&v.getHours()==a&&v.getMinutes()==s&&v.getSeconds()==l?v.getTime():!1},tokenize:function(e){var t=e.length;if(!t)return[];for(var n=[],i=e[0],o=0,r=1;t>r;++r){var a=e[r];a!==i&&(n.push(e.substr(o,r-o)),i=a,o=r)}return n.push(e.substr(o,t-o)),n},parseInteger:function(e,t,n,i){for(var o=i;o>=n;--o){var r=e.substr(t,o);if(!isNaN(parseInt(r))&&parseInt(r)==r&&r>0&&r.length>=n)return r}return!1},parseAmPm:function(e,t){var n=e.substr(t,2).toLowerCase();return"am"===n||"pm"===n?n:!1},parseMonth:function(e,t,n,i){for(var o=e.length,r=1;o>=t+r;r++)if(i.monthName=e.substr(t,r),i.monthName.match(/^\p{L}+$/)){i.monthName=i.monthName.substr(0,-1);break}i.monthName=i.monthName.toLowerCase();var a=["jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"],s=["january","february","march","april","may","june","july","august","september","october","november","december"],l=a.indexOf(i.monthName),c=s.indexOf(i.monthName);return-1==l&&-1==c?!1:(-1!=l?l:c)+1}}}(),function(e,t){"object"==typeof exports&&exports?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.Mustache={})}(this,function(e){function t(e){return"function"==typeof e}function n(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function i(e,t){return f.call(e,t)}function o(e){return!i(g,e)}function r(e){return String(e).replace(/[&<>"'\/]/g,function(e){return m[e]})}function a(t,i){function r(){if(k&&!F)for(;m.length;)delete g[m.pop()];else m=[];k=!1,F=!1}function a(e){if("string"==typeof e&&(e=e.split(y,2)),!p(e)||2!==e.length)throw new Error("Invalid tags: "+e);d=new RegExp(n(e[0])+"\\s*"),u=new RegExp("\\s*"+n(e[1])),h=new RegExp("\\s*"+n("}"+e[1]))}if(!t)return[];var d,u,h,f=[],g=[],m=[],k=!1,F=!1;a(i||e.tags);for(var x,T,_,E,S,j,I=new c(t);!I.eos();){if(x=I.pos,_=I.scanUntil(d))for(var A=0,O=_.length;O>A;++A)E=_.charAt(A),o(E)?m.push(g.length):F=!0,g.push(["text",E,x,x+1]),x+=1,"\n"===E&&r();if(!I.scan(d))break;if(k=!0,T=I.scan(C)||"name",I.scan(v),"="===T?(_=I.scanUntil(w),I.scan(w),I.scanUntil(u)):"{"===T?(_=I.scanUntil(h),I.scan(b),I.scanUntil(u),T="&"):_=I.scanUntil(u),!I.scan(u))throw new Error("Unclosed tag at "+I.pos);if(S=[T,_,x,I.pos],g.push(S),"#"===T||"^"===T)f.push(S);else if("/"===T){if(j=f.pop(),!j)throw new Error('Unopened section "'+_+'" at '+x);if(j[1]!==_)throw new Error('Unclosed section "'+j[1]+'" at '+x)}else"name"===T||"{"===T||"&"===T?F=!0:"="===T&&a(_)}if(j=f.pop())throw new Error('Unclosed section "'+j[1]+'" at '+I.pos);return l(s(g))}function s(e){for(var t,n,i=[],o=0,r=e.length;r>o;++o)t=e[o],t&&("text"===t[0]&&n&&"text"===n[0]?(n[1]+=t[1],n[3]=t[3]):(i.push(t),n=t));return i}function l(e){for(var t,n,i=[],o=i,r=[],a=0,s=e.length;s>a;++a)switch(t=e[a],t[0]){case"#":case"^":o.push(t),r.push(t),o=t[4]=[];break;case"/":n=r.pop(),n[5]=t[2],o=r.length>0?r[r.length-1][4]:i;break;default:o.push(t)}return i}function c(e){this.string=e,this.tail=e,this.pos=0}function d(e,t){this.view=null==e?{}:e,this.cache={".":this.view},this.parent=t}function u(){this.cache={}}var h=Object.prototype.toString,p=Array.isArray||function(e){return"[object Array]"===h.call(e)},f=RegExp.prototype.test,g=/\S/,m={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"},v=/\s*/,y=/\s+/,w=/\s*=/,b=/\s*\}/,C=/#|\^|\/|>|\{|&|=|!/;c.prototype.eos=function(){return""===this.tail},c.prototype.scan=function(e){var t=this.tail.match(e);if(!t||0!==t.index)return"";var n=t[0];return this.tail=this.tail.substring(n.length),this.pos+=n.length,n},c.prototype.scanUntil=function(e){var t,n=this.tail.search(e);switch(n){case-1:t=this.tail,this.tail="";break;case 0:t="";break;default:t=this.tail.substring(0,n),this.tail=this.tail.substring(n)}return this.pos+=t.length,t},d.prototype.push=function(e){return new d(e,this)},d.prototype.lookup=function(e){var n,i=this.cache,o=this.subView||(this.subView={});if(e in i)n=i[e];else{for(var r,a,s,l=this;l;){if(e.indexOf(".")>0)for(n=l.view,r=e.split("."),a=0;null!=n&&a<r.length;)s=n,n=n[r[a++]],o[n]=s;else n=l.view[e];if(null!=n)break;l=l.parent}i[e]=n}return t(n)&&(n=n.call(o[n]||this.view)),n},u.prototype.clearCache=function(){this.cache={}},u.prototype.parse=function(e,t){var n=this.cache,i=n[e];return null==i&&(i=n[e]=a(e,t)),i},u.prototype.render=function(e,t,n){var i=this.parse(e),o=t instanceof d?t:new d(t);return this.renderTokens(i,o,n,e)},u.prototype.renderTokens=function(n,i,o,r){function a(e){return d.render(e,i,o)}for(var s,l,c="",d=this,u=0,h=n.length;h>u;++u)switch(s=n[u],s[0]){case"#":if(l=i.lookup(s[1]),!l)continue;if(p(l))for(var f=0,g=l.length;g>f;++f)c+=this.renderTokens(s[4],i.push(l[f]),o,r);else if("object"==typeof l||"string"==typeof l)c+=this.renderTokens(s[4],i.push(l),o,r);else if(t(l)){if("string"!=typeof r)throw new Error("Cannot use higher-order sections without the original template");l=l.call(i.view,r.slice(s[3],s[5]),a),null!=l&&(c+=l)}else c+=this.renderTokens(s[4],i,o,r);break;case"^":l=i.lookup(s[1]),(!l||p(l)&&0===l.length)&&(c+=this.renderTokens(s[4],i,o,r));break;case">":if(!o)continue;l=t(o)?o(s[1]):o[s[1]],null!=l&&(c+=this.renderTokens(this.parse(l),i,o,l));break;case"&":l=i.lookup(s[1]),null!=l&&(c+=l);break;case"name":l=i.lookup(s[1]),null!=l&&(c+=e.escape(l));break;case"text":c+=s[1]}return c},e.name="mustache.js",e.version="0.8.1",e.tags=["{{","}}"];var k=new u;e.clearCache=function(){return k.clearCache()},e.parse=function(e,t){return k.parse(e,t)},e.render=function(e,t,n){return k.render(e,t,n)},e.to_html=function(n,i,o,r){var a=e.render(n,i,o);return t(r)?void r(a):a},e.escape=r,e.Scanner=c,e.Context=d,e.Writer=u}),function(){"undefined"==typeof Handler&&(Handler={}),Handler.Adyen={createPaymentForm:function(e){var t=document.createElement("form");return t.action=e.action,t.method=e.method,jQuery.each(e.fields,function(e,n){var i=document.createElement("input");i.setAttribute("name",n.name),i.setAttribute("type",n.type),i.setAttribute("value",n.value),t.appendChild(i)}),t}}}(),"undefined"==typeof Handler&&(Handler={}),Handler.Highlight=function(e,t,n,i){function o(e){e.is(".highlight")||(e=e.siblings(".highlight"));var t=(e.attr("class")||"").replace(/^.*_(\d\d).*$/,"$1");return Chess.getSquare(parseInt(t.substr(0,1),10),parseInt(t.substr(1,1),10))}var r,a=this;e=jQuery(e),e.length||errorHandler.error("container not found in Handler.Highlight"),Extend.Subscriber(a,{},{afterLink:function(e){r=e.publisher}});var s,l={},c=!0,d=!1;return a.unHighlightAll=function(){return e.find(".highlight").attr("src",t.getHighlightUrl()),a},a.unHighlightCell=function(n){return e.find(".highlight_"+n).attr("src",t.getHighlightUrl()),a},a.highlightTargetSquares=function(e){if(!(c&&a.anyMovesAllowed&&e&&e.isOnBoard()))return a;for(var t=n("square",e),o=0;o<t.length;o++){var r,s=t[o].endSquare,l=i().getPiece(s);"-"!==l&&(r="take"),a.highlightCell(s.y.toString()+s.x.toString(),"green",r);var d=t[o].castleInfo;d.isCastle&&a.highlightCell(e.y.toString()+(d.isKingCastle?"6":"2"),"green",r)}return a},a.highlightCellSelect=function(e,t,n){return a.highlightCell(e,t,"select",n)},a.highlightCellEmpty=function(e,t,n){return a.highlightCell(e,t,void 0,n)},a.highlightCellTake=function(e,t,n){return a.highlightCell(e,t,"take",n)},a.highlightCell=function(n,i,o,r){return c?(e.find(".highlight_"+n).attr("src",t.getHighlightUrl(i,o)),r&&(clearTimeout(l[n]),l[n]=setTimeout(function(){e.find(".highlight_"+n).attr("src")===t.getHighlightUrl(i,o)&&e.find(".highlight_"+n).attr("src",t.getHighlightUrl())},500)),a):a},a.activate=function(){return c=!0,a},a.deactivate=function(){return c=!1,a.unHighlightAll(),a},a.startDrawing=function(t){if(!r)return a;a.stopDrawing(),d=!0,s=["red","blue","green","yellow"].contains(t)?t:"red";var n,i,l=!1;return e.find(".highlight, .piece").off("click.highlight").on("click.highlight",function(){return l?void(l=!1):void r.addHighlight({frame:o(jQuery(this)),color:s})}).draggable({helper:function(){return jQuery("<span/>")},start:function(){n=o(jQuery(this))},stop:function(){n=void 0}}),e.find(".cell").droppable({tolerance:"pointer",
drop:function(){n&&i&&(r.deleteHighlight(i),n.x!=i.line.x2||n.y!=i.line.y2?(delete i.temporary,r.addHighlight(i),l=!1):(r.addHighlight({frame:n,color:s}),l=!0),i=void 0,n=void 0)},over:function(){if(n){l=!0,i&&r.deleteHighlight(i);var e=o(jQuery(this).find(".highlight"));i={color:s,line:Chess.getMove(n.y,n.x,e.y,e.x),temporary:!0},(n.x!=e.x||n.y!=e.y)&&r.addHighlight(i)}}}),a},a.stopDrawing=function(){if(!d)return a;d=!1;var t=e.find(".highlight, .piece");return t.off("click.highlight"),t.filter(function(){return!!jQuery(this).data("ui-draggable")}).draggable("destroy"),e.find(".cell").filter(function(){return!!jQuery(this).data("ui-droppable")}).droppable("destroy"),a},a.isDrawing=function(){return d},a.startEraser=function(){return r?(a.stopEraser(),d=!0,e.find(".highlight, .piece").off("click.highlight").on("click.highlight",function(){var e=o(jQuery(this));r.getHighlights().filter(function(t){return t.line&&t.line.x1==e.x&&t.line.y1==e.y?!0:t.frame&&t.frame.x==e.x&&t.frame.y==e.y?!0:void 0}).forEach(function(e){r.deleteHighlight(e)})}),a):void 0},a.stopEraser=function(){return a.stopDrawing()},a},"undefined"==typeof Handler&&(Handler={}),Handler.KeyboardDispatcher=new function(){function e(e){e!==o&&(o&&t(o,!1),t(e,!0),o=e)}function t(e,t){s[e].setActive(t)}function n(e){var t=["setActive","getActive"],n=t.every(function(t){return"function"==typeof e[t]});return n}function i(e){var t=Object.findKey(s,function(t){return e===t});return t&&parseInt(t,10)}var o,r=0,a=this,s={},l={},c={};a.add=function(i,d){n(i)||errorHandler.error("Keyboard handler does not meet dispatcher's requirements",i),d||(d=jQuery(document));var u=++r;return s[u]=i,l[u]=d,o?t(u,!1):(o=u,t(u,!0)),d.on("mousedown.keyboardHandler-"+u,function(t){c[t]||(e(u),c[t]=!0,setTimeout(function(){delete c[t]},1e3))}),a},a.remove=function(e){var n=i(e);return void 0===n?a:(o===n&&(o=void 0),t(n,!1),l[n].off("mousedown.keyboardHandler-"+n),delete s[n],void delete l[n])},a.select=function(t){var n=i(t);n&&e(n)},a.copy=function(e){var t=document.createElement("textarea");t.value=e,document.body.appendChild(t),t.select(),document.execCommand("Copy"),t.remove()}},"undefined"==typeof Handler&&(Handler={}),Handler.Keyboard=function(){function e(e){function t(){for(var e,t=0;t<n.length;t++)if(n[t]instanceof Chess.Game||n[t]instanceof Chess.GameHandler){if(e)return!1;e=n[t]}if(!e)return!1;var i=e.getCurrentPosition();if(i.countChildrenMoves(!0)<2)return!1;if(r)r.select();else{for(var o=[],t=0;t<i.childrenMoves.length;t++){var s=i.childrenMoves[t].getSan();i.childrenMoves[t].isNullMove()||o.push({id:i.childrenMoves[t].knotId,text:("w"==i.moveRight?i.moveCounter+". ":i.moveCounter+"... ")+s})}r=new popupList(o,function(e){r.remove(),r=void 0,a("gotoId",e)})}return!0}function a(t,o){r&&(r.remove(),r=void 0);for(var a=0;a<n.length;a++)i&&"function"==typeof n[a][t]&&n[a][t](o);e.preventDefault()}if(!o&&i&&(o=!0,setTimeout(function(){o=!1},200),!jQuery(document.activeElement).attr("contenteditable"))){switch(document.activeElement.tagName.toLowerCase()){case"input":case"textarea":return}var s=Handler.Keyboard.keys;switch(e.keyCode){case s.VK_RIGHT:if(t())break;a("gotoNextPosition",!0);break;case s.VK_LEFT:a("gotoParentPosition");break;case s.VK_HOME:a("gotoStart");break;case s.VK_END:a("gotoEndOfLine",!0);break;case s.VK_UP:r?(r.up(),e.preventDefault()):a("showPrevGame");break;case s.VK_DOWN:r?(r.down(),e.preventDefault()):a("showNextGame")}}}if(Handler.Keyboard.instance)return Handler.Keyboard.instance;var t=this,n=[],i=!0,o=!1;Extend.Subscriber(t,{},{afterLink:function(e){n.contains(e.publisher)||n.push(e.publisher)},afterUnlink:function(e){n.removeByValue(e.publisher)}});var r;return t.setActive=function(e){i=e},t.getActive=function(){return i},jQuery(document).off("keydown.keyboardhandler").on("keydown.keyboardhandler",e),Handler.Keyboard.instance=t,t},Handler.Keyboard.keys={VK_TAB:9,VK_SHIFT:16,VK_CTRL:17,VK_ALT:18,VK_CAPS:20,VK_RETURN:13,VK_ESCAPE:27,VK_PAGE_UP:33,VK_PAGE_DOWN:34,VK_END:35,VK_HOME:36,VK_LEFT:37,VK_UP:38,VK_RIGHT:39,VK_DOWN:40,VK_DELETE:46,VK_F1:112,VK_F2:113,VK_F3:114,VK_F4:115,VK_F5:116,VK_F6:117,VK_F7:118,VK_F8:119,VK_F9:120,VK_F10:121,VK_F11:122,VK_F12:123,VK_COPY:67,VK_PASTE:86,VK_1:49,VK_2:50,VK_3:51,VK_4:52},function(){function e(){u&&n(u,!0)}function t(){l&&"busy"===l.getStatus()&&d.terminate(),r(),c=void 0}function n(e,t){if(u=e,c!==e&&window.Worker){l=l||a();var n=l.getStatus();("busy"!==n||e!==Chess.translate.longFenToEngineFen(l.getPosition()))&&(r(),window.settings.getBoolean("game-broadcast-engine")&&window.settings.getBoolean("game-broadcast-engine-local")&&(c=e,"undefined"!=typeof l?"idle"===n?i(t):"busy"===n&&l.stop():"idle"===n?i(t):"busy"===n&&(y.depth?l.stop():d.terminate())))}}function i(e){if(c){if(!e&&Handler.engine.get(c,h,!1,!1))return void(c=void 0);Handler.engine.once(c+":detailed."+f,o),l.setPosition(Chess.translate.engineFenToLongFen(c)).evaluate(y)}}function o(e,n){var i=c+":detailed."+f;e.channel===i&&n.depth>16&&t()}function r(){c&&Handler.engine.off(c+":detailed."+f,o)}function a(){var e="object"==typeof WebAssembly&&WebAssembly.validate(Uint8Array.of(0,97,115,109,1,0,0,0));d=new s(e?m:g);var t=new Controller.UCI(d,{evaluationAntiHammer:[1e3,2e3],options:w});return t.on("status.idle",function(){i()}),t.on("evaluation",function(e,n){n.source=p,Handler.engine.set(Chess.translate.longFenToEngineFen(t.getPosition()),h,n)}),t}function s(e){var t=Extend.Publisher(this);return t.start=function(){uci=new Worker(e),uci.addEventListener("message",function(e){t.emit("data",e.data)},!1)},t.terminate=function(){return uci&&uci.terminate(),t.emit("closed"),t},t.write=function(e){return uci.postMessage(e),t},t}var l,c,d,u,h="detailed",p="Local",f="Cloud",g="/engine/stockfish.js",m="/engine/stockfish.wasm.js",v=config.level().toString(),y={guest:{depth:8},registered:{depth:12},premium:{}}[v],w={MultiPV:3};Handler.localEngine={newTask:n,stop:t},window.settings.on("settings.game-broadcast-engine-local.on",e),window.settings.on("settings.game-broadcast-engine-local.off",t)}(),"undefined"==typeof Handler&&(Handler={}),Handler.Movement=function(e,t,n,i,o){function r(e,t){return(t||n.moveRight===e)&&E.contains(e)?!0:!1}function a(){var e;return A.draggable({helper:"clone",addClasses:!1,zIndex:100,start:function(n,i){e=jQuery(this),t.addClass("dragging"),e.stop(!0,!0).addClass("inDrag"),d(e.data("coordinates"),!0);var o=document.documentElement.scrollTop||document.body.scrollTop;jQuery(window).on("scroll",function(){$(window).scrollTop(o)})},stop:function(e,n){jQuery(this).css({left:"auto",top:"auto"}).removeClass("inDrag"),t.removeClass("dragging"),jQuery(window).off("scroll")}}).draggable("enable"),O.droppable({drop:function(t,n){var i=jQuery(this);if(i.removeClass("dropableSquareOver"),e){var o=i.offset(),r=e.offset();e.css({left:o.left-r.left+"px",top:o.top-r.top+"px"});var a=i.data("coordinates");d(a,!0),T.click&&e.data("coordinates")===a||f()}else{var s=n.draggable,l=s.data("new-piece");if(!l)return;p(i.data("coordinates"),l)}},over:function(e,t){jQuery(this).addClass("dropableSquareOver")},out:function(e,t){jQuery(this).removeClass("dropableSquareOver")}}),T.dragDrop=!0,x}function s(){return A.off("click.movementHandler").on("click.movementHandler",function(){x.emit("pieceSelected"),d(jQuery(this).data("coordinates"))}),T.click=!0,x}function l(){return M.off("click.movementHandler"),M.on("click.movementHandler",function(){d(jQuery(this).data("coordinates"))}),T.click=!0,x}function c(e){if(!F)return x;var t=e.startSquare,i=e.endSquare,o=n.getPiece(t);if("-"===o)return!1;var r=o===o.toUpperCase()?"w":"b",a=!1;("P"===o&&1===t.y||"p"===o&&6===t.y)&&(a=!0);for(var s=Chess.getPiece(o.toLowerCase(),r,a),l=i.getNewSquare(-t.y,-t.x),c=s.getPotentialSquares(),d=0;d<c.length;d++)if(c[d].y===l.y&&c[d].x===l.x)return!0;return"k"!==o.toLowerCase()||4!==t.x||2!==i.x&&6!==i.x||!("w"===r&&0===i.y||"b"===r&&7===i.y)?!1:!0}function d(e,t){if(!T.click&&!t)return x;var i=Chess.getSquare(parseInt(e.substr(0,1)),parseInt(e.substr(1,1))),a=n.getPiece(i);if(a=a||"-","-"===a)var s;else s=a.toLowerCase()===a?"b":"w";if(w){if(w===i)return t||f(),x;var l=n.getPiece(w);if("-"===l)var d;else d=l.toLowerCase()===l?"b":"w";var p=Chess.getMove(w.y,w.x,i.y,i.x);n.isLegalMove(p)?v(p):n.isLegalMoveIfItWouldBeAPromotion(p)?y(p,d):1===E.length&&!r(d)&&r(d,!0)&&c(p)?(g(p),f()):r(s,!0)?h(i):S&&void 0!==o&&u(a,i,"red",!0)}else r(s,!0)?h(i):(S&&void 0!==o&&u(a,i,"red",!0),g());return x}function u(e,t,n,i){"-"===e?o.highlightCellEmpty(t.y.toString()+t.x.toString(),n,i):o.highlightCellTake(t.y.toString()+t.x.toString(),n,i)}function h(e){return f(e),void 0!==o&&m(e,"select"),g(),x}function p(t,n){var i=Chess.getSquare(parseInt(t.substr(0,1)),parseInt(t.substr(1,1))),o=e.getCurrentPosition();o.setPiece(i,n),o=new Chess.Position({fen:o.toString(!0),validators:e.getCurrentGame().getRules()}),e.setCurrentPosition(o),e.gotoEndOfLine()}function f(e){return w=e,o&&!I&&o.unHighlightAll(),i.markKingInCheck(),x}function g(e){return F?(e?i.addArrow(e.x1,e.y1,e.x2,e.y2,!0):i.clearArrow(!0),b=e,x):x}function m(e,t){return S&&void 0!==o?(o.highlightCell(e.y.toString()+e.x.toString(),"green",t),window.settings.getBoolean("game-highlight-possible-square")&&o.highlightTargetSquares(e),x):x}function v(t){function n(){function n(){e.deleteMove(a.childrenMoves[0]),e.move(t),r(e,l),e.setCurrentPosition(a.childrenMoves[0]),f(),g()}function i(){e.move(t,void 0,!0,void 0,"local"),f(),g()}function o(e,t){return t.every(function(t){if(!e.isLegalMove(t.moveCoords))return!1;var n=e.move({move:t.moveCoords});return o(n,t.childrenMoves)})}function r(e,t){var n=e.getCurrentPosition();t.forEach(function(t){e.getCurrentPosition().isLegalMove(t.moveCoords)&&(e.move(t.moveCoords),r(e,t.childrenMoves))}),e.setCurrentPosition(n)}if(!j)return i();var a=e.getCurrentPosition();if(a.isEndOfLine())return i();var s=a.clonePosition().move({move:t}),l=a.childrenMoves[0].childrenMoves,c=o(s,l);c?n():Dialog.confirmation({content:window.t("Position conflict"),comment:window.t("Some positions further on in the game will not be possible if we make this move. Do you want to proceed and only keep the compatiple moves?")},n)}var i=k||k!==!1&&window.settings.getBoolean("game-confirm-move");if(i&&e.getMoveMode(void 0,!0)){var o=new Chess.Game({fen:e.getCurrentPosition().toString()});o.setRules(e.getRules()).move(t),Dialog.confirmMove(o,n,e.getCurrentPosition().nextMoveIsBlack())}else n()}function y(e,t){return(_=void 0!==C?C:window.settings.getBoolean("game-autopromote-queen"))?(v(e.changePromotion("w"===t?"Q":"q")),x):(i.showPromotionDialog(e,t,v,void 0===C),x)}var w,b,C,k,F,x=Extend.Publisher(this),T={click:!0,dragDrop:!0},_=window.settings.getBoolean("game-autopromote-queen"),E=["w","b"],S=!0,j=!1,I=!1;t=jQuery(t),t.length||errorHandler.error(new Error("container not found for Handler.Movement"));var A=t.find(".piece"),O=t.find(".cell"),M=t.find(".highlight");return x.setUserMoveRight=function(e){return"string"==typeof e&&(e=[e]),Array.isArray(e)||errorHandler.error(new Error("invalid argument while setting userMoveRight"),{newMoveRight:e}),E=e,x},x.setHighlighting=function(e){return e!==!0&&e!==!1?x:(e===!1&&void 0!==o&&o.unHighlightAll(),S=e,x)},x.setPremove=function(e){return e!==!0&&e!==!1&&(e=window.settings.getBoolean("game-premove")),t.off("contextmenu.cancelPremove"),e===!1?g():t.on("contextmenu.cancelPremove",function(e){e.preventDefault(),g()}),F=e,x},x.activate=function(e){return void 0===e?(T.click=!0,T.dragDrop=!0):("click"===e||"dragDrop"===e)&&(T[e]=!0),x.initEvents(),x},x.deactivate=function(e){A=t.find(".piece"),void 0===e?e=["click","dragDrop"]:Array.isArray(e)||(e=[e]),e.contains("dragDrop")&&T.dragDrop&&(A.draggable("destroy"),O.droppable("destroy")),e.contains("click")&&T.click&&(M.off("click"),A.off("click"));for(var n=0;n<e.length;n++)T[e[n]]=!1;return x},x.isActive=function(){return T.click||T.dragDrop},x.getSelectedPiece=function(){return w},x.cancelPremove=function(){return b=void 0,x},x.setCurrentPosition=function(t){n=t,b&&r(n.moveRight)&&(n.isLegalMove(b)?setTimeout(function(t){return function(){e.moveAtEndOfMainline(t,void 0,void 0,"local")}}(b)):n.isLegalMoveIfItWouldBeAPromotion(b)&&y(b,n.moveRight),g())},x.switchAutoQueen=function(e){C=void 0===e?void 0:!!e},x.switchMoveConfirm=function(e){k=void 0===e?void 0:!!e},x.switchPersistentHighlights=function(e){I=!!e},x.setReplaceMode=function(e){j=!!e},x.getReplaceMode=function(){return j},x.initEvents=function(){return A=t.find(" .piece"),M=t.find(" .highlight"),T.click&&l(),T.dragDrop&&a(),T.click&&s(),x},x.setPremove(),x.initEvents(),window.settings.on("settings.game-premove",function(){x.setPremove(window.settings.getBoolean("game-premove"))}),x},"undefined"==typeof Handler&&(Handler={}),function(){function e(e){void 0===e&&(e=c[o]||""),e=e+(e.length?h:"")+u;var t=l.attr("title")||r;s.length&&s.length<=t.length&&t.substr(0,s.length)===s&&(t=t.substr(s.length)),t&&(r=t),s=e,l.attr("title",e+t)}function t(e){clearTimeout(i),c=f?[]:e,o=0,n()}function n(){o++,o>=c.length&&(o=0),e(c[o]),c.length>1&&(i=setTimeout(n,d))}var i,o,r,a=0,s="",l=jQuery(document),c=[],d=500,u="",h=" | ",p=[],f=Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")>0;l.ready(function(){jQuery('head > link[rel="icon"]').each(function(){var e=new Favico({bgColor:"#c4662b",animation:"popFade",element:this});e.browser.supported&&p.push(e)})}),Handler.pageTitle={set:function(e){l.attr("title",e)},setTextWithAnimation:function(e){var n=["-","|"];e=e||"";for(var i=0;i<n.length;i++)n[i]=n[i]+" "+e;t(n)},setTextWithoutAnimation:function(e){t([e])},setNotification:function(t){return a=Math.max(parseInt(t,10),0),p.length?(p.forEach(function(e){e.badge(a)}),u=""):u=a?"("+t+") ":"",e(),this},updateNotification:function(e){return e=parseInt(e,10),isNaN(e)||this.setNotification(a+e),this},reset:function(){return clearTimeout(i),e(""),c=[],this}}}();var Handler=Handler||{};Handler.Pagination=function(e,t,n){function i(){function i(){var e=$(this),t=e.data("offset"),i=e.data("limit");n&&n(t,i)}var o=t.offset,r=t.limit,a=t.total,s=t.noOfPagesToShow,l=1,c=(o+r)/r,d=Math.max(l,Math.ceil(a/r));l>c?c=l:c>d&&(c=d),s=Math.min(t.noOfPagesToShow,d);var u=Math.floor(s/2),h=Math.max(c-u,l),p=Math.min(s+h-1,d);s+h-1>d&&(h=Math.max(p-s+1,l));for(var f=[],g=h;p>=g;g++)f.push(g);f.forEach(function(t){var n=$('<li><a data-page="'+t.toString()+'">'+t.toString()+"</a></li>");t===c&&n.addClass("active");var o=r*t-r;n.on("click",i).data("offset",o).data("limit",r),e.next.before(n)}),c===l?(e.first.addClass("inactive"),e.prev.addClass("inactive")):(e.first.on("click",i).data("offset",r*l-r).data("limit",r),e.prev.children("a").on("click",i).data("offset",o-r).data("limit",r)),c===d?(e.next.addClass("inactive"),e.last.addClass("inactive")):(e.next.children("a").on("click",i).data("offset",o+r).data("limit",r),e.last.on("click",i).data("offset",r*d-r).data("limit",r))}e=e||{},e.first=e.first||$(),e.prev=e.prev||$(),e.next=e.next||$(),e.last=e.last||$(),t=t||{},t.noOfPagesToShow=t.noOfPagesToShow||5,t.offset=t.offset||0,t.limit=t.limit||0,void 0===t.total&&(t.total=1/0);var o=this;return i(),o},"undefined"==typeof Handler&&(Handler={}),Handler.Pairing=function(){function e(){return c=Handler.socket.getSocket(Handler.socket.types.PAIRING),t(c),c.deferred.promise.done(n),d}function t(e){e.on("error",i),e.on("connect_failed",i)}function n(e){e.off("error",i).on("error",i),e.off("connect_failed",i).on("connect_failed",i),e.off("disconnect",o).on("disconnect",o),e.off("noMatch",r).on("noMatch",r),e.off("informNotAllowed",a).on("informNotAllowed",a),e.off("initGameSession",s).on("initGameSession",s),e.off("serverError",l).on("serverError",l)}function i(){d.emit("connectionError"),c.disconnect()}function o(){d.emit("connectionError"),c.disconnect()}function r(){d.emit("noMatch"),c.disconnect()}function a(e){d.emit("informNotAllowed",e),c.disconnect()}function s(e){e.authToken=config.user().authToken,d.emit("initGameSession",e),c.disconnect()}function l(e){d.emit("serverError",e)}if(Handler.Pairing.instance)return Handler.Pairing.instance;var c,d=this;return Extend.Publisher(d),d.play=function(t){return e(),t.increment=t.increment||0,t.authToken=config.user().authToken,c.emit("play",t),d},d.cancel=function(){e();var t={authToken:config.user().authToken};return c.emit("cancel",t),d},d.reMatch=function(t){return e(),c.emit("reMatch",t),d},Handler.Pairing.instance=d,d},"undefined"==typeof Handler&&(Handler={}),Handler.Playing=function(e,t,n){function i(){return p=Handler.socket.getSocket(Handler.socket.types.PLAYING,n),g}function o(e,t){p.on(e,t),o.cache=o.cache||{},o.cache[e]=t}function r(){if(o.cache)for(var e in o.cache)p.off(e,o.cache[e])}function a(n){function i(e){r(),o("startGameSession",a),o("spectatorJoin",s),o("spectatorLeave",l),o("receivedMove",c),o("receivedMoveACK",d),o("playerDisconnected",C),o("playerReconnected",k),o("gameSessionEnded",u),o("gameSessionResults",w),o("drawOffered",F),o("noReMatch",T),o("reMatchOffered",x),o("ping",function(t){e.emit("pingACK",t)}),o("gameSessionOver",function(e){g.emit("gameSessionOver",e)}),o("reconnect",function(){e.emit("joinGameSession",S)}),o("gameLoaded",function(){g.disconnected&&!E.isOver()&&(g.disconnected=!1,E.emit("selfReconnected"))}),o("close",b),o("disconnect",b),o("serverError",function(e){g.emit("playingError",e)})}function a(e){if(e=_(e),e!==!1){"undefined"==typeof e.game&&errorHandler.msg("critical",new Error("startGameSession: game invalid"),!0);try{e.game=Chess.couchToGame(e.game)}catch(t){errorHandler.msg("critical",t,!0,{data:e})}return void 0===typeof e.role&&errorHandler.msg("critical",new Error("startGameSession: color invalid"),!0),h=e.role,e.spectator&&g.emit("spectatorUpdate",e.spectator),g.emit("startGameSession",e),g}}function s(e){g.emit("spectatorJoin",e)}function l(e){g.emit("spectatorLeave",e)}function c(e){if(e=_(e),e===!1)return g;void 0===e.move&&errorHandler.msg("critical",new Error("receivedMove: data.move undefined"),!0),void 0===e.id&&errorHandler.msg("critical",new Error("receivedMove: data.id undefined"),!0);try{E.moveAtEndOfMainline(e.move,void 0,void 0,"remote"),y[e.id]=E.getLastAddedPosition(),E.setTimeUsage(e.timeUsage,y[e.id]),g.emit("receivedMove",e)}catch(t){errorHandler.msg("critical",t,!0,{currentPosition:E.toString(),data:e})}return g}function d(e){return e=_(e),e===!1?g:(E.setTimeUsage(e.timeUsage,y[e.id]),g)}function u(e){var t=E.getCurrentGame();if(e.gameDepth)for(;t.getDepth()>e.gameDepth;)t.deleteMove(t.getEndOfMainlinePosition(),!0);var n=e.gameStatus||e;t.setGameEndByPoints(n.result.white,n.result.black,n.endedBy),g.emit("gameSessionEnded",t)}function w(e){if(e=_(e),e===!1)return g;var t=E.getCurrentGame();t.additionalInformation||(t.additionalInformation={}),t.additionalInformation.scoreTotal=e.score,t.additionalInformation.eloNew=e.elo,t.additionalInformation.badges=e.badges,t.additionalInformation.lockedEngines=e.lockedEngines,t.additionalInformation.ratedEngines=e.ratedEngines,t.setMeta({White:{EloChange:t.additionalInformation.eloNew.whiteChange},Black:{EloChange:t.additionalInformation.eloNew.blackChange}}),g.emit("gameSessionResults",t)}function b(){if(!v&&!E.isOver()){g.disconnected=!0;var e=E.getDepth()>2,t=E.getTimeout(),n={timeout:t,win:e,itsMe:!0};E.emit("selfDisconnected",n)}}function C(e){return e=_(e),e===!1?g:(E.isOver()||E.emit("playerDisconnected",e),g)}function k(e){return e=_(e),e===!1?g:(E.isOver()||E.emit("playerReconnected"),g)}function F(e){return e=_(e),e===!1?g:(E.emit("drawOffered"),g)}function x(e){return e=_(e),e===!1?g:(g.emit("reMatchOffered"),g)}function T(e){return e=_(e),e===!1?g:(g.emit("noReMatch"),g)}function _(t){return void 0===t?(errorHandler.msg("warning",new Error("data is undefined"),!1,{data:t}),!1):void 0===t.gameSessionToken?(errorHandler.msg("warning",new Error("data does not contain gameSessionToken"),!1,{data:t}),!1):e!==t.gameSessionToken?(errorHandler.msg("warning",new Error("data does not contain the correct gameSessionToken"),!1,{data:t,expectedGameSessionToken:e}),!1):t}var E=n.publisher;(E instanceof Chess.GameHandler||E instanceof Chess.Game)&&(f=E),m&&(i(p),m=!1);var S={gameSessionToken:e,authToken:t};return p.emit("joinGameSession",S),g}function s(t,n){var i=n.parentMove.moveRight;if(i===h){var o=t.publisher.getCurrentGame().getMeta(),r=Chess.roles.roleToMeta(Chess.roles.role2const(h)),a=Chess.roles.roleToMeta(Chess.roles.inverse(Chess.roles.role2const(h))),s=n.getCan();y[Handler.Playing.moveId]=n;var l={event:"move",data:{gameSessionToken:e,id:Handler.Playing.moveId++,move:s,timeUsageClient:n.timeUsage,uuid:o[r].UUID,opponentUuid:o[a].UUID}};u(l)}return g}function l(){var t={event:"drawOffer",data:{gameSessionToken:e}};return u(t),g}function c(){var t={event:"acceptDraw",data:{gameSessionToken:e}};return u(t),g}function d(t,n){var i={event:"abortOrResign",data:{abort:n.abort&&n.abort===!0,gameSessionToken:e}};return u(i),g}function u(e){p.emit(e.event,e.data)}if(Handler.Playing.instance[e])return Handler.Playing.instance[e];var h,p,f,g=this,m=!0,v=!1;i();var y={};return Extend.Publisher(g),Extend.Subscriber(g,{"move.mainline.add.local":s,drawOffer:l,acceptDraw:c,abortOrResign:d},{afterLink:function(e){a(e)},afterUnlink:function(e){r(),m=!0}}),g.reMatch=function(e){return p.emit("reMatch",e),g},g.noReMatch=function(e){return p.emit("noReMatch",e),p.disconnect(),g},g.closeConnection=function(){return p.disconnect(),g},g.disconnect=function(){if(!("s"==h||f&&f.isOver()))return g;var t={event:"disconnectGameSession",data:{gameSessionToken:e}};return u(t),delete Handler.Playing.instance[e],p.disconnect(),g},Handler.Playing.instance[e]=g,g},Handler.Playing.moveId=1,Handler.Playing.instance={},"undefined"==typeof Handler&&(Handler={}),Handler.Position=function(e,t,n){function i(e){var n=t.getCurrentPosition().setPiece(u.y,u.x,e);t.setStartPosition(new Chess.Position({fen:n.toString(!0),validators:n.getValidators()})),t.setHighlights(n.getHighlights())}function o(){for(var e=t.getCurrentPosition(),n=e.getHighlights(),i=Chess.getSquare(u.y,u.x),o=[],r=0;r<n.length;r++){var a=n[r].square&&n[r].square===i||n[r].frame&&n[r].frame===i||n[r].line&&n[r].line.startSquare===i;a||o.push(n[r])}t.setHighlights(o)}function r(e,n){e?d.temporary=!0:delete d.temporary,n||t.deleteHighlight(d),t.addHighlight(d)}function a(e){e=e||w&&w.find("img"),e&&!e.closest(f).length&&f.html("").append(e.clone(!0))}var s=!0;n=n||{pieces:!0,highlights:!0,clear:!0,arrows:!0};var l=this;if(t||errorHandler.msg("error",new Error("publisher is required"),!0),t.setRules("build"),e=jQuery(e),e.addClass("chessBoardPositionBuilder"),!n.pieces&&n.arrows&&n.highlights)var c="onlyHighlights";else c=!n.pieces||n.arrows||n.highlights?"":"onlyPieces";var d,u,h=e.find(".cell"),p=jQuery("<div/>").addClass("positionHandler "+(c||"")).hide().appendTo("body"),f=jQuery('<div class="last"/>').appendTo(p),g=config.assetDir()+"/images";if(n.pieces){var m=jQuery('<div class="pieces"/>').appendTo(p),v=g+"/chess/themes/pieces/chess24/";m.append(jQuery("<img/>").attr("src",v+"white/p.png").data("piece","P")).append(jQuery("<img/>").attr("src",v+"white/r.png").data("piece","R")).append(jQuery("<img/>").attr("src",v+"white/n.png").data("piece","N")).append(jQuery("<img/>").attr("src",v+"white/b.png").data("piece","B")).append(jQuery("<img/>").attr("src",v+"white/q.png").data("piece","Q")).append(jQuery("<img/>").attr("src",v+"white/k.png").data("piece","K")).append("<br/>").append(jQuery("<img/>").attr("src",v+"black/p.png").data("piece","p")).append(jQuery("<img/>").attr("src",v+"black/r.png").data("piece","r")).append(jQuery("<img/>").attr("src",v+"black/n.png").data("piece","n")).append(jQuery("<img/>").attr("src",v+"black/b.png").data("piece","b")).append(jQuery("<img/>").attr("src",v+"black/q.png").data("piece","q")).append(jQuery("<img/>").attr("src",v+"black/k.png").data("piece","k"))}if(n.highlights){var y=jQuery('<div class="highlights"/>').appendTo(p);y.append(jQuery("<img/>").attr("src",g+"/chess/themes/pieces/blue/highlight/red-take.png").data("highlight","red")).append(jQuery("<img/>").attr("src",g+"/chess/themes/pieces/blue/highlight/blue-take.png").data("highlight","blue")).append(jQuery("<img/>").attr("src",g+"/chess/themes/pieces/blue/highlight/green-take.png").data("highlight","green")).append(jQuery("<img/>").attr("src",g+"/chess/themes/pieces/blue/highlight/yellow-take.png").data("highlight","yellow"))}if(n.clear){var w=jQuery('<div class="clearcell"/>').appendTo(p);w.append(jQuery("<img/>").attr("src",g+"/editor/widget-delete.png").data("clear",!0))}if(n.arrows){var b=jQuery('<div class="arrows"/>').appendTo(p);b.append(jQuery("<img/>").attr("src",g+"/editor/arrow-red.png").data("arrow","red")).append(jQuery("<img/>").attr("src",g+"/editor/arrow-blue.png").data("arrow","blue")).append(jQuery("<img/>").attr("src",g+"/editor/arrow-green.png").data("arrow","green")).append(jQuery("<img/>").attr("src",g+"/editor/arrow-yellow.png").data("arrow","yellow"))}return h.on("mouseover",function(){if(s){var e=jQuery(this),t=(e.attr("class")||"").replace(/^.*_(\d\d).*$/,"$1");d&&(d.line=Chess.getMove(d.line.y1,d.line.x1,parseInt(t.substr(0,1),10),parseInt(t.substr(1,1),10)),r(!0))}}),h.on("click",function(e){if(s){if(d)r(!1),d=void 0;else{var t=jQuery(this),n=(t.attr("class")||"").replace(/^.*_(\d\d).*$/,"$1"),i=n;i&&(u={x:parseInt(i.substr(1,1),10),y:parseInt(i.substr(0,1),10)});var o=t.offset();p.css({left:o.left+"px",top:o.top+"px"}).show(),e.stopPropagation(),jQuery(document).one("click",function(){p.hide()})}e.stopPropagation()}}),p.find("img").on("click",function(){var e=jQuery(this),s=e.data("piece"),l=e.data("highlight"),c=e.data("arrow"),h=e.data("clear");s?i(s):l?t.addHighlight({frame:Chess.getSquare(u.y,u.x),color:l}):c?(d={color:c,line:Chess.getMove(u.y,u.x,u.y,u.x)},r(!0,!0)):h&&(n.pieces&&i("-"),(n.highlights||n.arrows)&&o()),a(e)}),l.clear=function(){for(var e=t.getEndOfMainlinePosition(),n=0;8>n;n++)for(var i=0;8>i;i++)e.setPiece(i,n,"-");t.setStartPosition(new Chess.Position({fen:e.toString(!0),validators:e.getValidators()}))},l.activate=function(){s=!0},l.deactivate=function(){s=!1,d=void 0,p.is(":visible")&&p.hide()},a(),l},function(){"undefined"==typeof Handler&&(Handler={}),Handler.Razorpay={createPaymentForm:function(e){$(".razorpay-container").remove(),$("#razorpay-form").remove();var t=document.createElement("form");t.setAttribute("id","razorpay-form"),t.action=e.action,t.method=e.method;var n=document.createElement("input");n.type="hidden",n.name="csrf",n.value=config.csrf();var i=document.createElement("input");i.type="hidden",i.name="paymentReference",i.value=e.fields.paymentReference;var o=document.createElement("script");return o.src="https://checkout.razorpay.com/v1/checkout.js",jQuery(o).attr({"data-key":e.fields.key,"data-amount":e.fields.amount,"data-currency":e.fields.currency,"data-order_id":e.fields.orderId,"data-subscription_id":e.fields.subscriptionId,"data-prefill.name":window.config.user().name}),t.appendChild(o),t.appendChild(n),t.appendChild(i),t}}}(),jQuery(function(){function e(){o.keys().forEach(function(e){Date.now()-o.get(e)>i&&o.remove(e)})}function t(e,i,r){r||window.isActive()?o.get(e)||(o.set(e,Date.now()),i()):setTimeout(function(){t(e,i,!0)},n)}"undefined"==typeof Handler&&(Handler={});var n=1e3,i=n+2e4,o=jQuery.initNamespaceStorage("singletab").localStorage;e(),Handler.singleTab=function(e,n){"function"==typeof n&&t(e,n)}}),function(){function e(e){function n(){return i.deferred=new Helper.Deferred,i}var i=this,o=[],r={on:[],off:[],emit:[]};return i.subscribeRequest=function(e){return o.contains(e)?i.request(e):(o.push(e),i.emit("subscribeRequest",e))},i.subscribe=function(e){return o.contains(e)?i:(o.push(e),i.emit("subscribe",e))},i.unsubscribe=function(e){return o.contains(e)&&o.removeByValue(e),i.emit("unsubscribe",e)},i.request=function(e){return i.emit("request",e)},i.emit=function(){return i.socket?(i.socket.emit.apply(i.socket,arguments),i):(r.emit.push(arguments),i)},i.on=function(){var e=arguments;return i.socket?(i.socket.on.apply(i.socket,e),i):(r.on.push(e),i)},i.off=function(){var e=arguments;return i.socket?(i.socket.removeListener.apply(i.socket,e),i):(r.off.push(e),i)},i.connect=function(e,t,n){function o(){return!config.level().isGuest&&config.user(!1)&&config.user(!1).authToken?config.user().authToken:void 0}function a(e){var t={isGuest:config.level().isGuest,isPremium:config.level().isPremium,isAdmin:config.level().isAdmin,userName:config.user().name};return e&&(t.initialChannels=i.getChannels()),t}function s(){i.socket.emit("connect",o(),a(!0),void 0)}function l(e,t,n){return e&&t?(n=jQuery.extend(n||{},{"force new connection":!0,"max reconnection attempts":10,"reconnection limit":3e4,"reconnection delay":1e3,transports:["websocket"],secure:!0,port:t}),io.connect(e,n)):(errorHandler.error(new Error("please provide host and port to connect to")),!1)}i.socket=l(e,t,n);var c=setTimeout(function(){i.socket.socket.publish("connect_failed")},3e4);i.socket||errorHandler.error(new Error("invalid socket")),i.socket.on("reconnect",function(){try{s()}catch(e){setTimeout(function(){s()},5e3)}}),i.socket.emit("connect",o(),a(),function(){clearTimeout(c),Array.prototype.unshift.call(arguments,i),i.deferred.resolve.apply(this,arguments)});for(var d;d=r.emit.shift();)i.socket.emit.apply(i.socket,d);for(;d=r.on.shift();)i.socket.on.apply(i.socket,d);for(;d=r.off.shift();)i.socket.removeListener.apply(i.socket,d);return i},i.disconnect=function(){return i.socket.socket.connected&&(i.socket.removeAllListeners("disconnect"),i.socket.disconnect()),t[e]&&delete t[e],i},i.getChannels=function(){return o},n()}"undefined"==typeof Handler&&(Handler={});var t={},n={};Handler.socket={types:{NOTIFICATION:1,PAIRING:2,PLAYING:3},getSocket:function(i,o){var r,a=!0;switch(i){case Handler.socket.types.NOTIFICATION:r="/api/web/NodeServerAPI/getNotificationServer";break;case Handler.socket.types.PAIRING:r="/api/web/NodeServerAPI/getPairingServer";break;case Handler.socket.types.PLAYING:a=!1;break;default:errorHandler.error(new Error("no such socket type: ",i))}if(void 0!==t[i])return t[i];var s=new e(i);if(a&&(t[i]=s),o&&o.host&&o.port){var l=Object.getAndRemove(o,"host"),c=Object.getAndRemove(o,"port");return s.connect(l,c,o),s}if(n[i]){var l=n[i].host,c=n[i].port;return s.connect(l,c,o),s}return jQuery.get(r).done(function(e){var t=e.data.server.host,r=e.data.server.port;a&&(n[i]=e.data.server),s.connect(t,r,o)}).fail(function(e,t,n){s.deferred.reject(n)}),s}}}();var Handler=Handler||{};Handler.Sorting=function(e,t){function n(){r=e.find("th > a.sortCol"),r.on("click",i)}function i(){var e=$(this);if(e.hasClass("sortAsc"))var n=Handler.Sorting.SORT_ORDER_DESC;else n=e.hasClass("sortDesc")?Handler.Sorting.SORT_ORDER_ASC:Handler.Sorting.SORT_ORDER_ASC;var i=e.data("sort-key");t(i,n)}var o=this;e=$(e),t=t||dummy;var r;return n(),o},Handler.Sorting.SORT_ORDER_ASC=1,Handler.Sorting.SORT_ORDER_DESC=-1,"undefined"==typeof Handler&&(Handler={}),Handler.Stream=function(e,t){function n(){if(!t.eloType)return h[h.length-1];var e=h.reverse(),n=e.findIndex(function(e){return t.eloType&&e.data.player.white.eloType==t.eloType?!0:void 0});return-1!==n?e[n]:void 0}function i(e,t){h=h.filter(function(e){return e.gameSessionToken!==t.content.gameSessionToken})}function o(e,t){if(h.push(t.content),!l.isSuspended()){var i=n();i&&r(i,!0)}}function r(e,n){clearTimeout(s),s=setTimeout(function(){function n(){d.initGameSession(Object.merge(p,{gameSessionToken:e.gameSessionToken,authToken:config.user().authToken,role:i,mode:e.gameSessionToken?"human":"standby",chessGame:void 0,stream:t,analyze:!1,playingServer:{host:e.data.server.host,port:e.data.server.port}}))}e||(e={data:{server:{}},gameSessionToken:""});var i="s";if(p.nonExclusiveView||(e.data.player&&e.data.player.white.uuid===config.user().uuid?i="w":e.data.player&&e.data.player.black.uuid===config.user().uuid&&(i="b")),
"s"!==i)n();else{var o="/api/web/playzoneAPI/isAllowedToSpectate";$.get(o).done(function(e){e.data&&e.data.isAllowed&&n()}).fail(function(e,t,n){errorHandler.error(n)})}},n?0:c)}var a,s,l=this,c=3e3,d=Controller.getPlayZone(),u="channel:gameSession:remove",h=[];Array.isArray(e)||(e=[e]),t=t||{};var p={};return t.buffer&&Object.forEach(t.buffer,function(e){e&&h.push(e)}),Extend.Subscriber(l,{},{afterLink:function(t){a=t.publisher,e.forEach(function(e){a.subscribe(e).on(e,o)}),a.subscribe(u).on(u,i)}}),Extend.Suspendable(l,!1),l.onResume(function(){var e=n();e&&r(e)}),l.option=function(e,i){t[e]=i,r(n(),!0)},l.playzoneOption=function(e,t){"object"==typeof e?p=Object.merge(p,e):p[e]=t},l},"undefined"==typeof Handler&&(Handler={}),Handler.TableKeyboard=function(e){function t(){r=e.find("tbody tr"),r.length||(r=e.find("tr").filter(function(){return!jQuery(this).find("th").length})),r.off("click.tablekeyboardhandler").on("click.tablekeyboardhandler",function(){var e=jQuery(this).prevAll("tr").length;n(e)})}function n(e){if(e=Math.max(0,Math.min(r.length-1,e)),c!==e){i();var t=r.eq(e).addClass("selected");c=e;var n=t.offset().top,o=n+t.outerHeight(),a=jQuery(document).scrollTop(),s=jQuery(window).height(),l=a+s;o>l?jQuery("body").stop().animate({scrollTop:o+20-s}):a>n&&jQuery("body").stop().animate({scrollTop:n-20})}}function i(){-1!==c&&(r.eq(c).removeClass("selected"),c=-1)}function o(t){if(r.length){var i=c;switch(t.which){case Handler.Keyboard.keys.VK_UP:i=-1===c?r.length-1:c-1;break;case Handler.Keyboard.keys.VK_DOWN:i=-1===c?0:c+1;break;case Handler.Keyboard.keys.VK_PAGE_UP:i=-1===c?r.length-1:c-Handler.TableKeyboard.pageSize;break;case Handler.Keyboard.keys.VK_PAGE_DOWN:i=-1===c?0:c+Handler.TableKeyboard.pageSize;break;case Handler.Keyboard.keys.VK_RIGHT:case Handler.Keyboard.keys.VK_RETURN:-1!==c&&e.trigger("chess24:select",{index:c,element:r.eq(c)});break;case Handler.Keyboard.keys.VK_LEFT:d.forEach(function(e){e.gotoParentPosition()});break;default:return}return n(i),t.preventDefault(),!1}}var r,a=this,s=!1,l=(new Helper.UUID).getShort(),c=-1,d=[];return t(),a.setActive=function(e){s=e,jQuery(document).off("keydown.basekeyboardhandler."+l),e?jQuery(document).on("keydown.basekeyboardhandler."+l,o):i()},Extend.Subscriber(a,{},{afterLink:function(e){d.contains(e.publisher)||d.push(e.publisher)},afterUnlink:function(e){d.removeByValue(e.publisher)}}),a.getActive=function(){return s},a.selectDefault=function(){r&&r.length&&n(0)},a},Handler.TableKeyboard.pageSize=10,"undefined"==typeof Handler&&(Handler={}),function(){var e={};Handler.Template=function(t){if(t=t||"",e[t])return e[t];var n=e[t]=this;return n.render=function(e,n,i){return i=i||t,e=e.replace(/\./g,"_"),Handler.Template.templates&&Handler.Template.templates[t][e]?(n=n||{},Mustache.render(Handler.Template.templates[t][e],n,Handler.Template.templates[i])):""},n.append=function(e){return Handler.Template.templates[t]=Object.extend({},e.getTemplates(),Handler.Template.templates[t]),n},n.getTemplates=function(){return Handler.Template.templates[t]},n},Handler.Template.renderString=Mustache.render,Handler.Template.escape=Mustache.escape}(),"undefined"==typeof Handler&&(Handler={}),Handler.Theme=function(e,t,n){function i(e){return e===e.toUpperCase()?"white":"black"}function o(){return m=Math.round(e/(2*b+8))}function r(){return y={x:Math.round(b*m),y:Math.round(C*m)}}function a(){var e=g[t].minSquareSize||u,n=g[t].maxSquareSize||h;return v=e>=m?e:m>=n?n:Math.ceil(m/p)*p}function s(){return w={x:8*m+2*y.x,y:8*m+2*y.y}}function l(){o(),a(),r(),s()}var c=this,d=config.assetDir()+"/images/chess/themes",u=24,h=80,p=8,f="",g={debug:{boardMarginQuotientX:34/70,boardMarginQuotientY:34/70,arrowColorMove:"blue",arrowColorPremove:"red",whiteSquareColor:"dark"},chess24:{boardMarginQuotientX:.3375,boardMarginQuotientY:.3375,arrowColorMove:"blue",arrowColorPremove:"red",whiteSquareColor:"bright"},chess24new:{boardMarginQuotientX:.325,boardMarginQuotientY:.325,arrowColorMove:"blue",arrowColorPremove:"red",whiteSquareColor:"dark"},football:{boardMarginQuotientX:.325,boardMarginQuotientY:.325,arrowColorMove:"blue",arrowColorPremove:"red",whiteSquareColor:"bright"},blue:{boardMarginQuotientX:.325,boardMarginQuotientY:.325,arrowColorMove:"blue",arrowColorPremove:"red",whiteSquareColor:"dark"},fide:{boardMarginQuotientX:13/31.5,boardMarginQuotientY:13/31.5,arrowColorMove:"grey",arrowColorPremove:"grey",minSquareSize:32,maxSquareSize:32,whiteSquareColor:"dark"},lightwood:{boardMarginQuotientX:.3375,boardMarginQuotientY:.3375,arrowColorMove:"blue",arrowColorPremove:"red",whiteSquareColor:"dark"},paper:{boardMarginQuotientX:.3375,boardMarginQuotientY:.3375,arrowColorMove:"blue",arrowColorPremove:"red",whiteSquareColor:"dark"},classical_blue:{boardMarginQuotientX:.3375,boardMarginQuotientY:.3375,arrowColorMove:"blue",arrowColorPremove:"red",whiteSquareColor:"dark"},beas:{boardMarginQuotientX:.3375,boardMarginQuotientY:.3375,arrowColorMove:"blue",arrowColorPremove:"red",whiteSquareColor:"dark"},avantgarde:{boardMarginQuotientX:.3375,boardMarginQuotientY:.3375,arrowColorMove:"blue",arrowColorPremove:"red",whiteSquareColor:"dark"}};t=t||window.settings.get("game-board-theme")||"chess24",n=n||window.settings.get("game-piece-theme")||"chess24new",g[t]||(t="chess24");var m,v,y,w,b=g[t].boardMarginQuotientX||34/70,C=g[t].boardMarginQuotientY||34/70;return c.setBoardTheme=function(n){return config.themes()[n]?(t=n||t||"chess24",b=g[t].boardMarginQuotientX||34/70,C=g[t].boardMarginQuotientY||34/70,l(e),c):void 0},c.setPieceTheme=function(e){return config.themes()[e]?(n=e||n||"chess24new",c):void 0},c.setContainerWidth=function(t){return e=t,l(e),c},c.setSquareSize=function(t){return e=Math.round(t*b*2+8*t),l(e),c},c.getPieceUrl=function(e){var t=i(e);return e=e.toLowerCase(),d+"/pieces/"+n+"/"+t+"/"+e+".png"},c.appendPiece=function(e,t,n){return n=n||m,jQuery(e).append(jQuery(f).append(jQuery("<img />").attr("src",c.getPieceUrl(t)).attr("width",n).attr("height",n))),c},c.getBoardUrl=function(e){return e=e||"white",d+"/boards/"+t+"/"+e+".png"},c.getWhiteSquareColor=function(){return g[t].whiteSquareColor},c.getHighlightUrl=function(e,t){return e=e||"null",d+"/pieces/"+n+"/highlight/"+e+(t?"-"+t:"")+".png"},c.getArrowColor=function(e){return e?g[t].arrowColorPremove:g[t].arrowColorMove},c.setWrapper=function(e){return f=e,c},c.getSquareSize=function(){return m},c.getPieceImageSize=function(){return v},c.getBoardMargin=function(e){return y[e]},c.getBoardSize=function(e){return w[e]},l(e),c},"undefined"==typeof Handler&&(Handler={}),function(){function e(){l.val(0),c.val(0),r.val("")}function t(e){function t(t){t.preventDefault(),Handler.VoucherCode.applyVoucherCodeToPrice(e)}o.off("click").on("click",t),d.off("click").on("click",n),r.off("keydown").on("keydown",function(e){switch(e.keyCode){case 13:t(e)}})}function n(){r.val(""),i.removeClass("voucherCodeApplied"),s.hide(),a.hide(),p.hide(),h.hide(),u.prop("checked",!1)}Handler.VoucherCode={};var i,o,r,a,s,l,c,d,u,h,p;Handler.VoucherCode.init=function(f,g,m){var v=this,y=f.parent();i=y.closest("#content-buy-"+m),o=y.find("#btnRedeemVoucherId"),r=y.find("#inputVoucherValueId"),a=y.find("#infoWrongVoucherId"),s=y.find("#infoCorrectVoucherId"),l=y.find("#infoPriceId"),c=y.find("#infoReducedPriceId"),d=y.find("#removeVoucherCodeId"),u=y.find("#iHaveVoucherCode_"+m),h=y.find("#hintLinkId"),p=s.find(".addonInsider"),v.requestType=g,e(),t(f),n()},Handler.VoucherCode.applyVoucherCodeToPrice=function(e){function t(e){var t=e.data;l.html(t.price),c.html(t.reducedPrice),t.isValidProductCode?(a.hide(),h.show(),s.hide()):t.isValidAddon?(a.hide(),s.find(".toPayInsider").hide(),p.find(".addonDesc").html(t.addon),p.show(),s.show()):!t.isValidDiscountCode||Object.has(t,"errors")?(s.hide(),h.hide(),a.show()):(a.hide(),h.hide(),s.show(),i.addClass("voucherCodeApplied"))}var n="/api/web/shopAPI/getVoucherCodePrice",o=Handler.VoucherCode.prepareGetVoucherCodeValue(e);const r=o.find(function(e){return"voucherCodeName"===e.name});r&&r.value&&jQuery.get(n,o,t)},Handler.VoucherCode.prepareGetVoucherCodeValue=function(e){var t=this,n=e.serializeArray();return n.push({name:"voucherCodeName",value:Handler.VoucherCode.getVoucherCodeValue()}),n.push({name:"requestType",value:t.requestType}),n},Handler.VoucherCode.getVoucherCodeValue=function(){return r.val()}}(),jQuery(function(){function e(e){config.level().isAdmin&&!a.contains(e)&&(a.push(e),r.push(e),s||(s=setTimeout(t,n)))}function t(){clearTimeout(s),s=null,jQuery.post(o,{csrf:config.csrf(),lang:config.language(),phrases:r}).done(function(){r=[]})}var n=2e4;if("object"==typeof window.__dct){var i=window.__dct;delete window.__dct}else i={};var o="/api/web/i18nAPI/add",r=[],a=[],s=null;if(window.t=function(t,n){var o=i[t];void 0===o&&void 0!==t&&(e(t),o=t);for(var r in n)o=o.replace(r,n[r]);return o},String.prototype.translate||Object.defineProperty(String.prototype,"translate",{enumerable:!1,configurable:!0,writable:!0,value:function(){return window.t(this)}}),"object"!=typeof window.__dctCountry||Array.isArray(window.__dct))l={};else{var l=window.__dctCountry;delete window.__dctCountry}window.t.country=function(e){return l[e]||e}}),function(){var e=function(e){"use strict";function t(e){if(e.paused||e.ended||m)return!1;try{d.clearRect(0,0,l,s),d.drawImage(e,0,0,l,s)}catch(n){}w=setTimeout(t,A.duration,e),I.setIcon(c)}function n(e){var t=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;e=e.replace(t,function(e,t,n,i){return t+t+n+n+i+i});var n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return n?{r:parseInt(n[1],16),g:parseInt(n[2],16),b:parseInt(n[3],16)}:!1}function i(e,t){var n,i={};for(n in e)i[n]=e[n];for(n in t)i[n]=t[n];return i}function o(){return document.hidden||document.msHidden||document.webkitHidden||document.mozHidden}e=e?e:{};var r,a,s,l,c,d,u,h,p,f,g,m,v,y,w,b={bgColor:"#d00",textColor:"#fff",fontFamily:"sans-serif",fontStyle:"bold",type:"circle",position:"down",animation:"slide",elementId:!1};v={},v.ff="undefined"!=typeof InstallTrigger,v.chrome=!!window.chrome,v.opera=!!window.opera||navigator.userAgent.indexOf("Opera")>=0,v.ie=!1,v.safari=Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")>0,v.supported=v.chrome||v.ff||v.opera;var C=[];g=function(){},h=m=!1;var k=function(){r=i(b,e),r.bgColor=n(r.bgColor),r.textColor=n(r.textColor),r.position=r.position.toLowerCase(),r.animation=A.types[""+r.animation]?r.animation:b.animation;var t=r.position.indexOf("up")>-1,o=r.position.indexOf("left")>-1;if(t||o)for(var h=0;h<A.types[""+r.animation].length;h++){var p=A.types[""+r.animation][h];t&&(p.y<.6?p.y=p.y-.4:p.y=p.y-2*p.y+(1-p.w)),o&&(p.x<.6?p.x=p.x-.4:p.x=p.x-2*p.x+(1-p.h)),A.types[""+r.animation][h]=p}r.type=x[""+r.type]?r.type:b.type;try{a=I.getIcon(),c=document.createElement("canvas"),u=document.createElement("img"),a.hasAttribute("href")?(u.setAttribute("src",a.getAttribute("href")),u.onload=function(){s=u.height>0?u.height:32,l=u.width>0?u.width:32,c.height=s,c.width=l,d=c.getContext("2d"),F.ready()}):(u.setAttribute("src",""),s=32,l=32,u.height=s,u.width=l,c.height=s,c.width=l,d=c.getContext("2d"),F.ready())}catch(f){throw"Error initializing favico. Message: "+f.message}},F={};F.ready=function(){h=!0,F.reset(),g()},F.reset=function(){h&&(C=[],p=!1,d.clearRect(0,0,l,s),d.drawImage(u,0,0,l,s),I.setIcon(c),window.clearTimeout(y),window.clearTimeout(w))},F.start=function(){if(h&&!f){var e=function(){p=C[0],f=!1,C.length>0&&(C.shift(),F.start())};if(C.length>0){f=!0;var t=function(){["type","animation","bgColor","textColor","fontFamily","fontStyle"].forEach(function(e){e in C[0].options&&(r[e]=C[0].options[e])}),A.run(C[0].options,function(){e()},!1)};p?A.run(p.options,function(){t()},!0):t()}}};var x={},T=function(e){return e.n="number"==typeof e.n?Math.abs(0|e.n):e.n,e.x=l*e.x,e.y=s*e.y,e.w=l*e.w,e.h=s*e.h,e.len=(""+e.n).length,e};x.circle=function(e){e=T(e);var t=!1;2===e.len?(e.x=e.x-.4*e.w,e.w=1.4*e.w,t=!0):e.len>=3&&(e.x=e.x-.65*e.w,e.w=1.65*e.w,t=!0),d.clearRect(0,0,l,s),d.drawImage(u,0,0,l,s),d.beginPath(),d.font=r.fontStyle+" "+Math.floor(e.h*(e.n>99?.85:1))+"px "+r.fontFamily,d.textAlign="center",t?(d.moveTo(e.x+e.w/2,e.y),d.lineTo(e.x+e.w-e.h/2,e.y),d.quadraticCurveTo(e.x+e.w,e.y,e.x+e.w,e.y+e.h/2),d.lineTo(e.x+e.w,e.y+e.h-e.h/2),d.quadraticCurveTo(e.x+e.w,e.y+e.h,e.x+e.w-e.h/2,e.y+e.h),d.lineTo(e.x+e.h/2,e.y+e.h),d.quadraticCurveTo(e.x,e.y+e.h,e.x,e.y+e.h-e.h/2),d.lineTo(e.x,e.y+e.h/2),d.quadraticCurveTo(e.x,e.y,e.x+e.h/2,e.y)):d.arc(e.x+e.w/2,e.y+e.h/2,e.h/2,0,2*Math.PI),d.fillStyle="rgba("+r.bgColor.r+","+r.bgColor.g+","+r.bgColor.b+","+e.o+")",d.fill(),d.closePath(),d.beginPath(),d.stroke(),d.fillStyle="rgba("+r.textColor.r+","+r.textColor.g+","+r.textColor.b+","+e.o+")","number"==typeof e.n&&e.n>999?d.fillText((e.n>9999?9:Math.floor(e.n/1e3))+"k+",Math.floor(e.x+e.w/2),Math.floor(e.y+e.h-.2*e.h)):d.fillText(e.n,Math.floor(e.x+e.w/2),Math.floor(e.y+e.h-.15*e.h)),d.closePath()},x.rectangle=function(e){e=T(e);var t=!1;2===e.len?(e.x=e.x-.4*e.w,e.w=1.4*e.w,t=!0):e.len>=3&&(e.x=e.x-.65*e.w,e.w=1.65*e.w,t=!0),d.clearRect(0,0,l,s),d.drawImage(u,0,0,l,s),d.beginPath(),d.font=r.fontStyle+" "+Math.floor(e.h*(e.n>99?.9:1))+"px "+r.fontFamily,d.textAlign="center",d.fillStyle="rgba("+r.bgColor.r+","+r.bgColor.g+","+r.bgColor.b+","+e.o+")",d.fillRect(e.x,e.y,e.w,e.h),d.fillStyle="rgba("+r.textColor.r+","+r.textColor.g+","+r.textColor.b+","+e.o+")","number"==typeof e.n&&e.n>999?d.fillText((e.n>9999?9:Math.floor(e.n/1e3))+"k+",Math.floor(e.x+e.w/2),Math.floor(e.y+e.h-.2*e.h)):d.fillText(e.n,Math.floor(e.x+e.w/2),Math.floor(e.y+e.h-.15*e.h)),d.closePath()};var _=function(e,t){t=("string"==typeof t?{animation:t}:t)||{},g=function(){try{if("number"==typeof e?e>0:""!==e){var i={type:"badge",options:{n:e}};if("animation"in t&&A.types[""+t.animation]&&(i.options.animation=""+t.animation),"type"in t&&x[""+t.type]&&(i.options.type=""+t.type),["bgColor","textColor"].forEach(function(e){e in t&&(i.options[e]=n(t[e]))}),["fontStyle","fontFamily"].forEach(function(e){e in t&&(i.options[e]=t[e])}),C.push(i),C.length>100)throw"Too many badges requests in queue.";F.start()}else F.reset()}catch(o){throw"Error setting badge. Message: "+o.message}},h&&g()},E=function(e){g=function(){try{var t=e.width,n=e.height,i=document.createElement("img"),o=n/s>t/l?t/l:n/s;i.setAttribute("src",e.getAttribute("src")),i.height=n/o,i.width=t/o,d.clearRect(0,0,l,s),d.drawImage(i,0,0,l,s),I.setIcon(c)}catch(r){throw"Error setting image. Message: "+r.message}},h&&g()},S=function(e){g=function(){try{if("stop"===e)return m=!0,F.reset(),void(m=!1);e.addEventListener("play",function(){t(this)},!1)}catch(n){throw"Error setting video. Message: "+n.message}},h&&g()},j=function(e){if(window.URL&&window.URL.createObjectURL||(window.URL=window.URL||{},window.URL.createObjectURL=function(e){return e}),v.supported){var n=!1;navigator.getUserMedia=navigator.getUserMedia||navigator.oGetUserMedia||navigator.msGetUserMedia||navigator.mozGetUserMedia||navigator.webkitGetUserMedia,g=function(){try{if("stop"===e)return m=!0,F.reset(),void(m=!1);n=document.createElement("video"),n.width=l,n.height=s,navigator.getUserMedia({video:!0,audio:!1},function(e){n.src=URL.createObjectURL(e),n.play(),t(n)},function(){})}catch(i){throw"Error setting webcam. Message: "+i.message}},h&&g()}},I={};I.getIcon=function(){var e=!1,t="",n=function(){for(var e=document.getElementsByTagName("head")[0].getElementsByTagName("link"),t=e.length,n=t-1;n>=0;n--)if(/(^|\s)icon(\s|$)/i.test(e[n].getAttribute("rel")))return e[n];return!1};if(r.element?e=r.element:r.elementId?(e=document.getElementById(r.elementId),e.setAttribute("href",e.getAttribute("src"))):(e=n(),e===!1&&(e=document.createElement("link"),e.setAttribute("rel","icon"),document.getElementsByTagName("head")[0].appendChild(e))),t=r.elementId?e.src:e.href,"data:"!==t.substr(0,5)&&-1===t.indexOf(document.location.hostname))throw new Error("Error setting favicon. Favicon image is on different domain (Icon: "+t+", Domain: "+document.location.hostname+")");return e.setAttribute("type","image/png"),e},I.setIcon=function(e){var t=e.toDataURL("image/png");if(r.element&&r.element.setAttribute("src",t),r.elementId)document.getElementById(r.elementId).setAttribute("src",t);else if(v.ff||v.opera){var n=a;a=document.createElement("link"),v.opera&&a.setAttribute("rel","icon"),a.setAttribute("rel","icon"),a.setAttribute("type","image/png"),document.getElementsByTagName("head")[0].appendChild(a),a.setAttribute("href",t),n.parentNode&&n.parentNode.removeChild(n)}else a.setAttribute("href",t)};var A={};return A.duration=40,A.types={},A.types.fade=[{x:.4,y:.4,w:.6,h:.6,o:0},{x:.4,y:.4,w:.6,h:.6,o:.1},{x:.4,y:.4,w:.6,h:.6,o:.2},{x:.4,y:.4,w:.6,h:.6,o:.3},{x:.4,y:.4,w:.6,h:.6,o:.4},{x:.4,y:.4,w:.6,h:.6,o:.5},{x:.4,y:.4,w:.6,h:.6,o:.6},{x:.4,y:.4,w:.6,h:.6,o:.7},{x:.4,y:.4,w:.6,h:.6,o:.8},{x:.4,y:.4,w:.6,h:.6,o:.9},{x:.4,y:.4,w:.6,h:.6,o:1}],A.types.none=[{x:.4,y:.4,w:.6,h:.6,o:1}],A.types.pop=[{x:1,y:1,w:0,h:0,o:1},{x:.9,y:.9,w:.1,h:.1,o:1},{x:.8,y:.8,w:.2,h:.2,o:1},{x:.7,y:.7,w:.3,h:.3,o:1},{x:.6,y:.6,w:.4,h:.4,o:1},{x:.5,y:.5,w:.5,h:.5,o:1},{x:.4,y:.4,w:.6,h:.6,o:1}],A.types.popFade=[{x:.75,y:.75,w:0,h:0,o:0},{x:.65,y:.65,w:.1,h:.1,o:.2},{x:.6,y:.6,w:.2,h:.2,o:.4},{x:.55,y:.55,w:.3,h:.3,o:.6},{x:.5,y:.5,w:.4,h:.4,o:.8},{x:.45,y:.45,w:.5,h:.5,o:.9},{x:.4,y:.4,w:.6,h:.6,o:1}],A.types.slide=[{x:.4,y:1,w:.6,h:.6,o:1},{x:.4,y:.9,w:.6,h:.6,o:1},{x:.4,y:.9,w:.6,h:.6,o:1},{x:.4,y:.8,w:.6,h:.6,o:1},{x:.4,y:.7,w:.6,h:.6,o:1},{x:.4,y:.6,w:.6,h:.6,o:1},{x:.4,y:.5,w:.6,h:.6,o:1},{x:.4,y:.4,w:.6,h:.6,o:1}],A.run=function(e,t,n,a){var s=A.types[o()?"none":r.animation];return a=n===!0?"undefined"!=typeof a?a:s.length-1:"undefined"!=typeof a?a:0,t=t?t:function(){},a<s.length&&a>=0?(x[r.type](i(e,s[a])),y=setTimeout(function(){n?a-=1:a+=1,A.run(e,t,n,a)},A.duration),I.setIcon(c),void 0):void t()},k(),{badge:_,video:S,image:E,webcam:j,reset:F.reset,browser:{supported:v.supported}}};"undefined"!=typeof define&&define.amd?define([],function(){return e}):"undefined"!=typeof module&&module.exports?module.exports=e:this.Favico=e}(),function(e){function n(){var e=arguments[1],n=Emoticons.getDefsByKey()[e];return n?'<span class="emoticon emoji '+n.css+'" key="'+n.key+'" title="'+t(n.title)+'"/>':":"+e+":"}function i(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}var o,r;e.fn.expandEmoticons=function(){return this.each(function(){o||(o=i(Emoticons.getKeys().join("|"))),r||(r=[],Emoticons.getDefs().forEach(function(e){e.ascii&&r.push({regex:new RegExp("("+e.ascii.map(i).join("|")+"+)","g"),replace:n(void 0,e.key)})}));var t=new RegExp(":(["+o+"]+):","g"),a=e(this).html().replace(t,n);r.forEach(function(e){a=a.replace(e.regex,e.replace)}),e(this).html(a)})}}(jQuery),function($){if($.ui.timepicker=$.ui.timepicker||{},!$.ui.timepicker.version){$.extend($.ui,{timepicker:{version:"1.2.1"}});var Timepicker=function(){this.regional=[],this.regional[""]={currentText:"Now",closeText:"Done",amNames:["AM","A"],pmNames:["PM","P"],timeFormat:"HH:mm",timeSuffix:"",timeOnlyTitle:"Choose Time",timeText:"Time",hourText:"Hour",minuteText:"Minute",secondText:"Second",millisecText:"Millisecond",timezoneText:"Time Zone",isRTL:!1},this._defaults={showButtonPanel:!0,timeOnly:!1,showHour:!0,showMinute:!0,showSecond:!1,showMillisec:!1,showTimezone:!1,showTime:!0,stepHour:1,stepMinute:1,stepSecond:1,stepMillisec:1,hour:0,minute:0,second:0,millisec:0,timezone:null,useLocalTimezone:!1,defaultTimezone:"+0000",hourMin:0,minuteMin:0,secondMin:0,millisecMin:0,hourMax:23,minuteMax:59,secondMax:59,millisecMax:999,minDateTime:null,maxDateTime:null,onSelect:null,hourGrid:0,minuteGrid:0,secondGrid:0,millisecGrid:0,alwaysSetTime:!0,separator:" ",altFieldTimeOnly:!0,altTimeFormat:null,altSeparator:null,altTimeSuffix:null,pickerTimeFormat:null,pickerTimeSuffix:null,showTimepicker:!0,timezoneIso8601:!1,timezoneList:null,addSliderAccess:!1,sliderAccessArgs:null,controlType:"slider",defaultValue:null,parse:"strict"},$.extend(this._defaults,this.regional[""])};$.extend(Timepicker.prototype,{$input:null,$altInput:null,$timeObj:null,inst:null,hour_slider:null,minute_slider:null,second_slider:null,millisec_slider:null,timezone_select:null,hour:0,minute:0,second:0,millisec:0,timezone:null,defaultTimezone:"+0000",hourMinOriginal:null,minuteMinOriginal:null,secondMinOriginal:null,millisecMinOriginal:null,hourMaxOriginal:null,minuteMaxOriginal:null,secondMaxOriginal:null,millisecMaxOriginal:null,ampm:"",formattedDate:"",formattedTime:"",formattedDateTime:"",timezoneList:null,units:["hour","minute","second","millisec"],control:null,setDefaults:function(e){return extendRemove(this._defaults,e||{}),this},_newInst:function($input,o){var tp_inst=new Timepicker,inlineSettings={},fns={},overrides,i;for(var attrName in this._defaults)if(this._defaults.hasOwnProperty(attrName)){var attrValue=$input.attr("time:"+attrName);if(attrValue)try{inlineSettings[attrName]=eval(attrValue)}catch(err){inlineSettings[attrName]=attrValue}}overrides={beforeShow:function(e,t){return $.isFunction(tp_inst._defaults.evnts.beforeShow)?tp_inst._defaults.evnts.beforeShow.call($input[0],e,t,tp_inst):void 0},onChangeMonthYear:function(e,t,n){tp_inst._updateDateTime(n),$.isFunction(tp_inst._defaults.evnts.onChangeMonthYear)&&tp_inst._defaults.evnts.onChangeMonthYear.call($input[0],e,t,n,tp_inst)},onClose:function(e,t){tp_inst.timeDefined===!0&&""!==$input.val()&&tp_inst._updateDateTime(t),$.isFunction(tp_inst._defaults.evnts.onClose)&&tp_inst._defaults.evnts.onClose.call($input[0],e,t,tp_inst)}};for(i in overrides)overrides.hasOwnProperty(i)&&(fns[i]=o[i]||null);if(tp_inst._defaults=$.extend({},this._defaults,inlineSettings,o,overrides,{evnts:fns,timepicker:tp_inst}),tp_inst.amNames=$.map(tp_inst._defaults.amNames,function(e){return e.toUpperCase()}),tp_inst.pmNames=$.map(tp_inst._defaults.pmNames,function(e){return e.toUpperCase()}),"string"==typeof tp_inst._defaults.controlType?(void 0===$.fn[tp_inst._defaults.controlType]&&(tp_inst._defaults.controlType="select"),tp_inst.control=tp_inst._controls[tp_inst._defaults.controlType]):tp_inst.control=tp_inst._defaults.controlType,null===tp_inst._defaults.timezoneList){var timezoneList=["-1200","-1100","-1000","-0930","-0900","-0800","-0700","-0600","-0500","-0430","-0400","-0330","-0300","-0200","-0100","+0000","+0100","+0200","+0300","+0330","+0400","+0430","+0500","+0530","+0545","+0600","+0630","+0700","+0800","+0845","+0900","+0930","+1000","+1030","+1100","+1130","+1200","+1245","+1300","+1400"];tp_inst._defaults.timezoneIso8601&&(timezoneList=$.map(timezoneList,function(e){return"+0000"==e?"Z":e.substring(0,3)+":"+e.substring(3)})),tp_inst._defaults.timezoneList=timezoneList}return tp_inst.timezone=tp_inst._defaults.timezone,tp_inst.hour=tp_inst._defaults.hour<tp_inst._defaults.hourMin?tp_inst._defaults.hourMin:tp_inst._defaults.hour>tp_inst._defaults.hourMax?tp_inst._defaults.hourMax:tp_inst._defaults.hour,tp_inst.minute=tp_inst._defaults.minute<tp_inst._defaults.minuteMin?tp_inst._defaults.minuteMin:tp_inst._defaults.minute>tp_inst._defaults.minuteMax?tp_inst._defaults.minuteMax:tp_inst._defaults.minute,tp_inst.second=tp_inst._defaults.second<tp_inst._defaults.secondMin?tp_inst._defaults.secondMin:tp_inst._defaults.second>tp_inst._defaults.secondMax?tp_inst._defaults.secondMax:tp_inst._defaults.second,tp_inst.millisec=tp_inst._defaults.millisec<tp_inst._defaults.millisecMin?tp_inst._defaults.millisecMin:tp_inst._defaults.millisec>tp_inst._defaults.millisecMax?tp_inst._defaults.millisecMax:tp_inst._defaults.millisec,tp_inst.ampm="",tp_inst.$input=$input,o.altField&&(tp_inst.$altInput=$(o.altField).css({cursor:"pointer"}).focus(function(){$input.trigger("focus")})),(0===tp_inst._defaults.minDate||0===tp_inst._defaults.minDateTime)&&(tp_inst._defaults.minDate=new Date),(0===tp_inst._defaults.maxDate||0===tp_inst._defaults.maxDateTime)&&(tp_inst._defaults.maxDate=new Date),void 0!==tp_inst._defaults.minDate&&tp_inst._defaults.minDate instanceof Date&&(tp_inst._defaults.minDateTime=new Date(tp_inst._defaults.minDate.getTime())),void 0!==tp_inst._defaults.minDateTime&&tp_inst._defaults.minDateTime instanceof Date&&(tp_inst._defaults.minDate=new Date(tp_inst._defaults.minDateTime.getTime())),void 0!==tp_inst._defaults.maxDate&&tp_inst._defaults.maxDate instanceof Date&&(tp_inst._defaults.maxDateTime=new Date(tp_inst._defaults.maxDate.getTime())),void 0!==tp_inst._defaults.maxDateTime&&tp_inst._defaults.maxDateTime instanceof Date&&(tp_inst._defaults.maxDate=new Date(tp_inst._defaults.maxDateTime.getTime())),tp_inst.$input.bind("focus",function(){tp_inst._onFocus()}),tp_inst},_addTimePicker:function(e){var t=this.$altInput&&this._defaults.altFieldTimeOnly?this.$input.val()+" "+this.$altInput.val():this.$input.val();this.timeDefined=this._parseTime(t),this._limitMinMaxDateTime(e,!1),this._injectTimePicker()},_parseTime:function(e,t){if(this.inst||(this.inst=$.datepicker._getInst(this.$input[0])),t||!this._defaults.timeOnly){var n=$.datepicker._get(this.inst,"dateFormat");try{var i=parseDateTimeInternal(n,this._defaults.timeFormat,e,$.datepicker._getFormatConfig(this.inst),this._defaults);if(!i.timeObj)return!1;$.extend(this,i.timeObj)}catch(o){return $.timepicker.log("Error parsing the date/time string: "+o+"\ndate/time string = "+e+"\ntimeFormat = "+this._defaults.timeFormat+"\ndateFormat = "+n),!1}return!0}var r=$.datepicker.parseTime(this._defaults.timeFormat,e,this._defaults);return r?($.extend(this,r),!0):!1},_injectTimePicker:function(){var e=this.inst.dpDiv,t=this.inst.settings,n=this,i="",o="",r={},a={},s=null,l=0,c=0;if(0===e.find("div.ui-timepicker-div").length&&t.showTimepicker){var d=' style="display:none;"',u='<div class="ui-timepicker-div'+(t.isRTL?" ui-timepicker-rtl":"")+'"><dl><dt class="ui_tpicker_time_label"'+(t.showTime?"":d)+">"+t.timeText+'</dt><dd class="ui_tpicker_time"'+(t.showTime?"":d)+"></dd>";for(l=0,c=this.units.length;c>l;l++){if(i=this.units[l],o=i.substr(0,1).toUpperCase()+i.substr(1),r[i]=parseInt(t[i+"Max"]-(t[i+"Max"]-t[i+"Min"])%t["step"+o],10),a[i]=0,u+='<dt class="ui_tpicker_'+i+'_label"'+(t["show"+o]?"":d)+">"+t[i+"Text"]+'</dt><dd class="ui_tpicker_'+i+'"><div class="ui_tpicker_'+i+'_slider"'+(t["show"+o]?"":d)+"></div>",t["show"+o]&&t[i+"Grid"]>0){if(u+='<div style="padding-left: 1px"><table class="ui-tpicker-grid-label"><tr>',"hour"==i)for(var h=t[i+"Min"];h<=r[i];h+=parseInt(t[i+"Grid"],10)){a[i]++;var p=$.datepicker.formatTime(useAmpm(t.pickerTimeFormat||t.timeFormat)?"hht":"HH",{hour:h},t);u+='<td data-for="'+i+'">'+p+"</td>"}else for(var f=t[i+"Min"];f<=r[i];f+=parseInt(t[i+"Grid"],10))a[i]++,u+='<td data-for="'+i+'">'+(10>f?"0":"")+f+"</td>";u+="</tr></table></div>"}u+="</dd>"}u+='<dt class="ui_tpicker_timezone_label"'+(t.showTimezone?"":d)+">"+t.timezoneText+"</dt>",u+='<dd class="ui_tpicker_timezone" '+(t.showTimezone?"":d)+"></dd>",u+="</dl></div>";var g=$(u);for(t.timeOnly===!0&&(g.prepend('<div class="ui-widget-header ui-helper-clearfix ui-corner-all"><div class="ui-datepicker-title">'+t.timeOnlyTitle+"</div></div>"),e.find(".ui-datepicker-header, .ui-datepicker-calendar").hide()),l=0,c=n.units.length;c>l;l++)i=n.units[l],o=i.substr(0,1).toUpperCase()+i.substr(1),n[i+"_slider"]=n.control.create(n,g.find(".ui_tpicker_"+i+"_slider"),i,n[i],t[i+"Min"],r[i],t["step"+o]),t["show"+o]&&t[i+"Grid"]>0&&(s=100*a[i]*t[i+"Grid"]/(r[i]-t[i+"Min"]),g.find(".ui_tpicker_"+i+" table").css({width:s+"%",marginLeft:t.isRTL?"0":s/(-2*a[i])+"%",marginRight:t.isRTL?s/(-2*a[i])+"%":"0",borderCollapse:"collapse"}).find("td").click(function(e){var t=$(this),o=t.html(),r=parseInt(o.replace(/[^0-9]/g),10),a=o.replace(/[^apm]/gi),s=t.data("for");"hour"==s&&(-1!==a.indexOf("p")&&12>r?r+=12:-1!==a.indexOf("a")&&12===r&&(r=0)),n.control.value(n,n[s+"_slider"],i,r),n._onTimeChange(),n._onSelectHandler()}).css({cursor:"pointer",width:100/a[i]+"%",textAlign:"center",overflow:"hidden"}));if(this.timezone_select=g.find(".ui_tpicker_timezone").append("<select></select>").find("select"),$.fn.append.apply(this.timezone_select,$.map(t.timezoneList,function(e,t){return $("<option />").val("object"==typeof e?e.value:e).text("object"==typeof e?e.label:e)})),"undefined"!=typeof this.timezone&&null!==this.timezone&&""!==this.timezone){var m=new Date(this.inst.selectedYear,this.inst.selectedMonth,this.inst.selectedDay,12),v=$.timepicker.timeZoneOffsetString(m);v==this.timezone?selectLocalTimeZone(n):this.timezone_select.val(this.timezone)}else"undefined"!=typeof this.hour&&null!==this.hour&&""!==this.hour?this.timezone_select.val(t.defaultTimezone):selectLocalTimeZone(n);this.timezone_select.change(function(){n._defaults.useLocalTimezone=!1,n._onTimeChange(),n._onSelectHandler()});var y=e.find(".ui-datepicker-buttonpane");if(y.length?y.before(g):e.append(g),this.$timeObj=g.find(".ui_tpicker_time"),null!==this.inst){var w=this.timeDefined;this._onTimeChange(),this.timeDefined=w}if(this._defaults.addSliderAccess){var b=this._defaults.sliderAccessArgs,C=this._defaults.isRTL;b.isRTL=C,setTimeout(function(){if(0===g.find(".ui-slider-access").length){g.find(".ui-slider:visible").sliderAccess(b);var e=g.find(".ui-slider-access:eq(0)").outerWidth(!0);e&&g.find("table:visible").each(function(){var t=$(this),n=t.outerWidth(),i=t.css(C?"marginRight":"marginLeft").toString().replace("%",""),o=n-e,r=i*o/n+"%",a={width:o,marginRight:0,marginLeft:0};a[C?"marginRight":"marginLeft"]=r,t.css(a)})}},10)}}},_limitMinMaxDateTime:function(e,t){var n=this._defaults,i=new Date(e.selectedYear,e.selectedMonth,e.selectedDay);if(this._defaults.showTimepicker){if(null!==$.datepicker._get(e,"minDateTime")&&void 0!==$.datepicker._get(e,"minDateTime")&&i){var o=$.datepicker._get(e,"minDateTime"),r=new Date(o.getFullYear(),o.getMonth(),o.getDate(),0,0,0,0);(null===this.hourMinOriginal||null===this.minuteMinOriginal||null===this.secondMinOriginal||null===this.millisecMinOriginal)&&(this.hourMinOriginal=n.hourMin,this.minuteMinOriginal=n.minuteMin,this.secondMinOriginal=n.secondMin,this.millisecMinOriginal=n.millisecMin),e.settings.timeOnly||r.getTime()==i.getTime()?(this._defaults.hourMin=o.getHours(),this.hour<=this._defaults.hourMin?(this.hour=this._defaults.hourMin,this._defaults.minuteMin=o.getMinutes(),this.minute<=this._defaults.minuteMin?(this.minute=this._defaults.minuteMin,this._defaults.secondMin=o.getSeconds(),this.second<=this._defaults.secondMin?(this.second=this._defaults.secondMin,this._defaults.millisecMin=o.getMilliseconds()):(this.millisec<this._defaults.millisecMin&&(this.millisec=this._defaults.millisecMin),this._defaults.millisecMin=this.millisecMinOriginal)):(this._defaults.secondMin=this.secondMinOriginal,this._defaults.millisecMin=this.millisecMinOriginal)):(this._defaults.minuteMin=this.minuteMinOriginal,this._defaults.secondMin=this.secondMinOriginal,this._defaults.millisecMin=this.millisecMinOriginal)):(this._defaults.hourMin=this.hourMinOriginal,this._defaults.minuteMin=this.minuteMinOriginal,this._defaults.secondMin=this.secondMinOriginal,this._defaults.millisecMin=this.millisecMinOriginal)}if(null!==$.datepicker._get(e,"maxDateTime")&&void 0!==$.datepicker._get(e,"maxDateTime")&&i){var a=$.datepicker._get(e,"maxDateTime"),s=new Date(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0,0);(null===this.hourMaxOriginal||null===this.minuteMaxOriginal||null===this.secondMaxOriginal)&&(this.hourMaxOriginal=n.hourMax,this.minuteMaxOriginal=n.minuteMax,this.secondMaxOriginal=n.secondMax,this.millisecMaxOriginal=n.millisecMax),e.settings.timeOnly||s.getTime()==i.getTime()?(this._defaults.hourMax=a.getHours(),this.hour>=this._defaults.hourMax?(this.hour=this._defaults.hourMax,this._defaults.minuteMax=a.getMinutes(),this.minute>=this._defaults.minuteMax?(this.minute=this._defaults.minuteMax,this._defaults.secondMax=a.getSeconds(),this.second>=this._defaults.secondMax?(this.second=this._defaults.secondMax,this._defaults.millisecMax=a.getMilliseconds()):(this.millisec>this._defaults.millisecMax&&(this.millisec=this._defaults.millisecMax),
this._defaults.millisecMax=this.millisecMaxOriginal)):(this._defaults.secondMax=this.secondMaxOriginal,this._defaults.millisecMax=this.millisecMaxOriginal)):(this._defaults.minuteMax=this.minuteMaxOriginal,this._defaults.secondMax=this.secondMaxOriginal,this._defaults.millisecMax=this.millisecMaxOriginal)):(this._defaults.hourMax=this.hourMaxOriginal,this._defaults.minuteMax=this.minuteMaxOriginal,this._defaults.secondMax=this.secondMaxOriginal,this._defaults.millisecMax=this.millisecMaxOriginal)}if(void 0!==t&&t===!0){var l=parseInt(this._defaults.hourMax-(this._defaults.hourMax-this._defaults.hourMin)%this._defaults.stepHour,10),c=parseInt(this._defaults.minuteMax-(this._defaults.minuteMax-this._defaults.minuteMin)%this._defaults.stepMinute,10),d=parseInt(this._defaults.secondMax-(this._defaults.secondMax-this._defaults.secondMin)%this._defaults.stepSecond,10),u=parseInt(this._defaults.millisecMax-(this._defaults.millisecMax-this._defaults.millisecMin)%this._defaults.stepMillisec,10);this.hour_slider&&(this.control.options(this,this.hour_slider,"hour",{min:this._defaults.hourMin,max:l}),this.control.value(this,this.hour_slider,"hour",this.hour-this.hour%this._defaults.stepHour)),this.minute_slider&&(this.control.options(this,this.minute_slider,"minute",{min:this._defaults.minuteMin,max:c}),this.control.value(this,this.minute_slider,"minute",this.minute-this.minute%this._defaults.stepMinute)),this.second_slider&&(this.control.options(this,this.second_slider,"second",{min:this._defaults.secondMin,max:d}),this.control.value(this,this.second_slider,"second",this.second-this.second%this._defaults.stepSecond)),this.millisec_slider&&(this.control.options(this,this.millisec_slider,"millisec",{min:this._defaults.millisecMin,max:u}),this.control.value(this,this.millisec_slider,"millisec",this.millisec-this.millisec%this._defaults.stepMillisec))}}},_onTimeChange:function(){var e=this.hour_slider?this.control.value(this,this.hour_slider,"hour"):!1,t=this.minute_slider?this.control.value(this,this.minute_slider,"minute"):!1,n=this.second_slider?this.control.value(this,this.second_slider,"second"):!1,i=this.millisec_slider?this.control.value(this,this.millisec_slider,"millisec"):!1,o=this.timezone_select?this.timezone_select.val():!1,r=this._defaults,a=r.pickerTimeFormat||r.timeFormat,s=r.pickerTimeSuffix||r.timeSuffix;"object"==typeof e&&(e=!1),"object"==typeof t&&(t=!1),"object"==typeof n&&(n=!1),"object"==typeof i&&(i=!1),"object"==typeof o&&(o=!1),e!==!1&&(e=parseInt(e,10)),t!==!1&&(t=parseInt(t,10)),n!==!1&&(n=parseInt(n,10)),i!==!1&&(i=parseInt(i,10));var l=r[12>e?"amNames":"pmNames"][0],c=e!=this.hour||t!=this.minute||n!=this.second||i!=this.millisec||this.ampm.length>0&&12>e!=(-1!==$.inArray(this.ampm.toUpperCase(),this.amNames))||null===this.timezone&&o!=this.defaultTimezone||null!==this.timezone&&o!=this.timezone;c&&(e!==!1&&(this.hour=e),t!==!1&&(this.minute=t),n!==!1&&(this.second=n),i!==!1&&(this.millisec=i),o!==!1&&(this.timezone=o),this.inst||(this.inst=$.datepicker._getInst(this.$input[0])),this._limitMinMaxDateTime(this.inst,!0)),useAmpm(r.timeFormat)&&(this.ampm=l),this.formattedTime=$.datepicker.formatTime(r.timeFormat,this,r),this.$timeObj&&(a===r.timeFormat?this.$timeObj.text(this.formattedTime+s):this.$timeObj.text($.datepicker.formatTime(a,this,r)+s)),this.timeDefined=!0,c&&this._updateDateTime()},_onSelectHandler:function(){var e=this._defaults.onSelect||this.inst.settings.onSelect,t=this.$input?this.$input[0]:null;e&&t&&e.apply(t,[this.formattedDateTime,this])},_updateDateTime:function(e){e=this.inst||e;var t=$.datepicker._daylightSavingAdjust(new Date(e.selectedYear,e.selectedMonth,e.selectedDay)),n=$.datepicker._get(e,"dateFormat"),i=$.datepicker._getFormatConfig(e),o=null!==t&&this.timeDefined;this.formattedDate=$.datepicker.formatDate(n,null===t?new Date:t,i);var r=this.formattedDate;if(""===e.lastVal&&(e.currentYear=e.selectedYear,e.currentMonth=e.selectedMonth,e.currentDay=e.selectedDay),this._defaults.timeOnly===!0?r=this.formattedTime:this._defaults.timeOnly!==!0&&(this._defaults.alwaysSetTime||o)&&(r+=this._defaults.separator+this.formattedTime+this._defaults.timeSuffix),this.formattedDateTime=r,this._defaults.showTimepicker)if(this.$altInput&&this._defaults.altFieldTimeOnly===!0)this.$altInput.val(this.formattedTime),this.$input.val(this.formattedDate);else if(this.$altInput){this.$input.val(r);var a="",s=this._defaults.altSeparator?this._defaults.altSeparator:this._defaults.separator,l=this._defaults.altTimeSuffix?this._defaults.altTimeSuffix:this._defaults.timeSuffix;a=this._defaults.altFormat?$.datepicker.formatDate(this._defaults.altFormat,null===t?new Date:t,i):this.formattedDate,a&&(a+=s),a+=this._defaults.altTimeFormat?$.datepicker.formatTime(this._defaults.altTimeFormat,this,this._defaults)+l:this.formattedTime+l,this.$altInput.val(a)}else this.$input.val(r);else this.$input.val(this.formattedDate);this.$input.trigger("change")},_onFocus:function(){if(!this.$input.val()&&this._defaults.defaultValue){this.$input.val(this._defaults.defaultValue);var e=$.datepicker._getInst(this.$input.get(0)),t=$.datepicker._get(e,"timepicker");if(t&&t._defaults.timeOnly&&e.input.val()!=e.lastVal)try{$.datepicker._updateDatepicker(e)}catch(n){$.timepicker.log(n)}}},_controls:{slider:{create:function(e,t,n,i,o,r,a){var s=e._defaults.isRTL;return t.prop("slide",null).slider({orientation:"horizontal",value:s?-1*i:i,min:s?-1*r:o,max:s?-1*o:r,step:a,slide:function(t,i){e.control.value(e,$(this),n,s?-1*i.value:i.value),e._onTimeChange()},stop:function(t,n){e._onSelectHandler()}})},options:function(e,t,n,i,o){if(e._defaults.isRTL){if("string"==typeof i)return"min"==i||"max"==i?void 0!==o?t.slider(i,-1*o):Math.abs(t.slider(i)):t.slider(i);var r=i.min,a=i.max;return i.min=i.max=null,void 0!==r&&(i.max=-1*r),void 0!==a&&(i.min=-1*a),t.slider(i)}return"string"==typeof i&&void 0!==o?t.slider(i,o):t.slider(i)},value:function(e,t,n,i){return e._defaults.isRTL?void 0!==i?t.slider("value",-1*i):Math.abs(t.slider("value")):void 0!==i?t.slider("value",i):t.slider("value")}},select:{create:function(e,t,n,i,o,r,a){for(var s='<select class="ui-timepicker-select" data-unit="'+n+'" data-min="'+o+'" data-max="'+r+'" data-step="'+a+'">',l=e._defaults.pickerTimeFormat||e._defaults.timeFormat,c=o;r>=c;c+=a)s+='<option value="'+c+'"'+(c==i?" selected":"")+">",s+="hour"==n?$.datepicker.formatTime($.trim(l.replace(/[^ht ]/gi,"")),{hour:c},e._defaults):"millisec"==n||c>=10?c:"0"+c.toString(),s+="</option>";return s+="</select>",t.children("select").remove(),$(s).appendTo(t).change(function(t){e._onTimeChange(),e._onSelectHandler()}),t},options:function(e,t,n,i,o){var r={},a=t.children("select");if("string"==typeof i){if(void 0===o)return a.data(i);r[i]=o}else r=i;return e.control.create(e,t,a.data("unit"),a.val(),r.min||a.data("min"),r.max||a.data("max"),r.step||a.data("step"))},value:function(e,t,n,i){var o=t.children("select");return void 0!==i?o.val(i):o.val()}}}}),$.fn.extend({timepicker:function(e){e=e||{};var t=Array.prototype.slice.call(arguments);return"object"==typeof e&&(t[0]=$.extend(e,{timeOnly:!0})),$(this).each(function(){$.fn.datetimepicker.apply($(this),t)})},datetimepicker:function(e){e=e||{};var t=arguments;return"string"==typeof e?"getDate"==e?$.fn.datepicker.apply($(this[0]),t):this.each(function(){var e=$(this);e.datepicker.apply(e,t)}):this.each(function(){var t=$(this);t.datepicker($.timepicker._newInst(t,e)._defaults)})}}),$.datepicker.parseDateTime=function(e,t,n,i,o){var r=parseDateTimeInternal(e,t,n,i,o);if(r.timeObj){var a=r.timeObj;r.date.setHours(a.hour,a.minute,a.second,a.millisec)}return r.date},$.datepicker.parseTime=function(e,t,n){var i=extendRemove(extendRemove({},$.timepicker._defaults),n||{}),o=function(e,t,n){var i,o=function(e,t){var n=[];return e&&$.merge(n,e),t&&$.merge(n,t),n=$.map(n,function(e){return e.replace(/[.*+?|()\[\]{}\\]/g,"\\$&")}),"("+n.join("|")+")?"},r=function(e){var t=e.toLowerCase().match(/(h{1,2}|m{1,2}|s{1,2}|l{1}|t{1,2}|z|'.*?')/g),n={h:-1,m:-1,s:-1,l:-1,t:-1,z:-1};if(t)for(var i=0;i<t.length;i++)-1==n[t[i].toString().charAt(0)]&&(n[t[i].toString().charAt(0)]=i+1);return n},a="^"+e.toString().replace(/([hH]{1,2}|mm?|ss?|[tT]{1,2}|[lz]|'.*?')/g,function(e){var t=e.length;switch(e.charAt(0).toLowerCase()){case"h":return 1===t?"(\\d?\\d)":"(\\d{"+t+"})";case"m":return 1===t?"(\\d?\\d)":"(\\d{"+t+"})";case"s":return 1===t?"(\\d?\\d)":"(\\d{"+t+"})";case"l":return"(\\d?\\d?\\d)";case"z":return"(z|[-+]\\d\\d:?\\d\\d|\\S+)?";case"t":return o(n.amNames,n.pmNames);default:return"("+e.replace(/\'/g,"").replace(/(\.|\$|\^|\\|\/|\(|\)|\[|\]|\?|\+|\*)/g,function(e){return"\\"+e})+")?"}}).replace(/\s/g,"\\s?")+n.timeSuffix+"$",s=r(e),l="";i=t.match(new RegExp(a,"i"));var c={hour:0,minute:0,second:0,millisec:0};if(i){if(-1!==s.t&&(void 0===i[s.t]||0===i[s.t].length?(l="",c.ampm=""):(l=-1!==$.inArray(i[s.t].toUpperCase(),n.amNames)?"AM":"PM",c.ampm=n["AM"==l?"amNames":"pmNames"][0])),-1!==s.h&&("AM"==l&&"12"==i[s.h]?c.hour=0:"PM"==l&&"12"!=i[s.h]?c.hour=parseInt(i[s.h],10)+12:c.hour=Number(i[s.h])),-1!==s.m&&(c.minute=Number(i[s.m])),-1!==s.s&&(c.second=Number(i[s.s])),-1!==s.l&&(c.millisec=Number(i[s.l])),-1!==s.z&&void 0!==i[s.z]){var d=i[s.z].toUpperCase();switch(d.length){case 1:d=n.timezoneIso8601?"Z":"+0000";break;case 5:n.timezoneIso8601&&(d="0000"==d.substring(1)?"Z":d.substring(0,3)+":"+d.substring(3));break;case 6:n.timezoneIso8601?"00:00"==d.substring(1)&&(d="Z"):d="Z"==d||"00:00"==d.substring(1)?"+0000":d.replace(/:/,"")}c.timezone=d}return c}return!1},r=function(e,t,n){try{var i=new Date("2012-01-01 "+t);if(isNaN(i.getTime())&&(i=new Date("2012-01-01T"+t),isNaN(i.getTime())&&(i=new Date("01/01/2012 "+t),isNaN(i.getTime()))))throw"Unable to parse time with native Date: "+t;return{hour:i.getHours(),minute:i.getMinutes(),second:i.getSeconds(),millisec:i.getMilliseconds(),timezone:$.timepicker.timeZoneOffsetString(i)}}catch(r){try{return o(e,t,n)}catch(a){$.timepicker.log("Unable to parse \ntimeString: "+t+"\ntimeFormat: "+e)}}return!1};return"function"==typeof i.parse?i.parse(e,t,i):"loose"===i.parse?r(e,t,i):o(e,t,i)},$.datepicker.formatTime=function(e,t,n){n=n||{},n=$.extend({},$.timepicker._defaults,n),t=$.extend({hour:0,minute:0,second:0,millisec:0,timezone:"+0000"},t);var i=e,o=n.amNames[0],r=parseInt(t.hour,10);return r>11&&(o=n.pmNames[0]),i=i.replace(/(?:HH?|hh?|mm?|ss?|[tT]{1,2}|[lz]|('.*?'|".*?"))/g,function(e){switch(e){case"HH":return("0"+r).slice(-2);case"H":return r;case"hh":return("0"+convert24to12(r)).slice(-2);case"h":return convert24to12(r);case"mm":return("0"+t.minute).slice(-2);case"m":return t.minute;case"ss":return("0"+t.second).slice(-2);case"s":return t.second;case"l":return("00"+t.millisec).slice(-3);case"z":return null===t.timezone?n.defaultTimezone:t.timezone;case"T":return o.charAt(0).toUpperCase();case"TT":return o.toUpperCase();case"t":return o.charAt(0).toLowerCase();case"tt":return o.toLowerCase();default:return e.replace(/\'/g,"")||"'"}}),i=$.trim(i)},$.datepicker._base_selectDate=$.datepicker._selectDate,$.datepicker._selectDate=function(e,t){var n=this._getInst($(e)[0]),i=this._get(n,"timepicker");i?(i._limitMinMaxDateTime(n,!0),n.inline=n.stay_open=!0,this._base_selectDate(e,t),n.inline=n.stay_open=!1,this._notifyChange(n),this._updateDatepicker(n)):this._base_selectDate(e,t)},$.datepicker._base_updateDatepicker=$.datepicker._updateDatepicker,$.datepicker._updateDatepicker=function(e){var t=e.input[0];if(!($.datepicker._curInst&&$.datepicker._curInst!=e&&$.datepicker._datepickerShowing&&$.datepicker._lastInput!=t||"boolean"==typeof e.stay_open&&e.stay_open!==!1)){this._base_updateDatepicker(e);var n=this._get(e,"timepicker");n&&n._addTimePicker(e)}},$.datepicker._base_doKeyPress=$.datepicker._doKeyPress,$.datepicker._doKeyPress=function(e){var t=$.datepicker._getInst(e.target),n=$.datepicker._get(t,"timepicker");if(n&&$.datepicker._get(t,"constrainInput")){var i=useAmpm(n._defaults.timeFormat),o=$.datepicker._possibleChars($.datepicker._get(t,"dateFormat")),r=n._defaults.timeFormat.toString().replace(/[hms]/g,"").replace(/TT/g,i?"APM":"").replace(/Tt/g,i?"AaPpMm":"").replace(/tT/g,i?"AaPpMm":"").replace(/T/g,i?"AP":"").replace(/tt/g,i?"apm":"").replace(/t/g,i?"ap":"")+" "+n._defaults.separator+n._defaults.timeSuffix+(n._defaults.showTimezone?n._defaults.timezoneList.join(""):"")+n._defaults.amNames.join("")+n._defaults.pmNames.join("")+o,a=String.fromCharCode(void 0===e.charCode?e.keyCode:e.charCode);return e.ctrlKey||" ">a||!o||r.indexOf(a)>-1}return $.datepicker._base_doKeyPress(e)},$.datepicker._base_updateAlternate=$.datepicker._updateAlternate,$.datepicker._updateAlternate=function(e){var t=this._get(e,"timepicker");if(t){var n=t._defaults.altField;if(n){var i=(t._defaults.altFormat||t._defaults.dateFormat,this._getDate(e)),o=$.datepicker._getFormatConfig(e),r="",a=t._defaults.altSeparator?t._defaults.altSeparator:t._defaults.separator,s=t._defaults.altTimeSuffix?t._defaults.altTimeSuffix:t._defaults.timeSuffix,l=null!==t._defaults.altTimeFormat?t._defaults.altTimeFormat:t._defaults.timeFormat;r+=$.datepicker.formatTime(l,t,t._defaults)+s,t._defaults.timeOnly||t._defaults.altFieldTimeOnly||null===i||(r=t._defaults.altFormat?$.datepicker.formatDate(t._defaults.altFormat,i,o)+a+r:t.formattedDate+a+r),$(n).val(r)}}else $.datepicker._base_updateAlternate(e)},$.datepicker._base_doKeyUp=$.datepicker._doKeyUp,$.datepicker._doKeyUp=function(e){var t=$.datepicker._getInst(e.target),n=$.datepicker._get(t,"timepicker");if(n&&n._defaults.timeOnly&&t.input.val()!=t.lastVal)try{$.datepicker._updateDatepicker(t)}catch(i){$.timepicker.log(i)}return $.datepicker._base_doKeyUp(e)},$.datepicker._base_gotoToday=$.datepicker._gotoToday,$.datepicker._gotoToday=function(e){var t=this._getInst($(e)[0]),n=t.dpDiv;this._base_gotoToday(e);var i=this._get(t,"timepicker");selectLocalTimeZone(i);var o=new Date;this._setTime(t,o),$(".ui-datepicker-today",n).click()},$.datepicker._disableTimepickerDatepicker=function(e){var t=this._getInst(e);if(t){var n=this._get(t,"timepicker");$(e).datepicker("getDate"),n&&(n._defaults.showTimepicker=!1,n._updateDateTime(t))}},$.datepicker._enableTimepickerDatepicker=function(e){var t=this._getInst(e);if(t){var n=this._get(t,"timepicker");$(e).datepicker("getDate"),n&&(n._defaults.showTimepicker=!0,n._addTimePicker(t),n._updateDateTime(t))}},$.datepicker._setTime=function(e,t){var n=this._get(e,"timepicker");if(n){var i=n._defaults;n.hour=t?t.getHours():i.hour,n.minute=t?t.getMinutes():i.minute,n.second=t?t.getSeconds():i.second,n.millisec=t?t.getMilliseconds():i.millisec,n._limitMinMaxDateTime(e,!0),n._onTimeChange(),n._updateDateTime(e)}},$.datepicker._setTimeDatepicker=function(e,t,n){var i=this._getInst(e);if(i){var o=this._get(i,"timepicker");if(o){this._setDateFromField(i);var r;t&&("string"==typeof t?(o._parseTime(t,n),r=new Date,r.setHours(o.hour,o.minute,o.second,o.millisec)):r=new Date(t.getTime()),"Invalid Date"==r.toString()&&(r=void 0),this._setTime(i,r))}}},$.datepicker._base_setDateDatepicker=$.datepicker._setDateDatepicker,$.datepicker._setDateDatepicker=function(e,t){var n=this._getInst(e);if(n){var i=t instanceof Date?new Date(t.getTime()):t;this._updateDatepicker(n),this._base_setDateDatepicker.apply(this,arguments),this._setTimeDatepicker(e,i,!0)}},$.datepicker._base_getDateDatepicker=$.datepicker._getDateDatepicker,$.datepicker._getDateDatepicker=function(e,t){var n=this._getInst(e);if(n){var i=this._get(n,"timepicker");if(i){void 0===n.lastVal&&this._setDateFromField(n,t);var o=this._getDate(n);return o&&i._parseTime($(e).val(),i.timeOnly)&&o.setHours(i.hour,i.minute,i.second,i.millisec),o}return this._base_getDateDatepicker(e,t)}},$.datepicker._base_parseDate=$.datepicker.parseDate,$.datepicker.parseDate=function(e,t,n){var i;try{i=this._base_parseDate(e,t,n)}catch(o){if(!(o.indexOf(":")>=0))throw o;i=this._base_parseDate(e,t.substring(0,t.length-(o.length-o.indexOf(":")-2)),n),$.timepicker.log("Error parsing the date string: "+o+"\ndate string = "+t+"\ndate format = "+e)}return i},$.datepicker._base_formatDate=$.datepicker._formatDate,$.datepicker._formatDate=function(e,t,n,i){var o=this._get(e,"timepicker");return o?(o._updateDateTime(e),o.$input.val()):this._base_formatDate(e)},$.datepicker._base_optionDatepicker=$.datepicker._optionDatepicker,$.datepicker._optionDatepicker=function(e,t,n){var i,o=this._getInst(e);if(!o)return null;var r=this._get(o,"timepicker");if(r){var a,s=null,l=null,c=null,d=r._defaults.evnts,u={};if("string"==typeof t){if("minDate"===t||"minDateTime"===t)s=n;else if("maxDate"===t||"maxDateTime"===t)l=n;else if("onSelect"===t)c=n;else if(d.hasOwnProperty(t)){if("undefined"==typeof n)return d[t];u[t]=n,i={}}}else if("object"==typeof t){t.minDate?s=t.minDate:t.minDateTime?s=t.minDateTime:t.maxDate?l=t.maxDate:t.maxDateTime&&(l=t.maxDateTime);for(a in d)d.hasOwnProperty(a)&&t[a]&&(u[a]=t[a])}for(a in u)u.hasOwnProperty(a)&&(d[a]=u[a],i||(i=$.extend({},t)),delete i[a]);if(i&&isEmptyObject(i))return;s?(s=0===s?new Date:new Date(s),r._defaults.minDate=s,r._defaults.minDateTime=s):l?(l=0===l?new Date:new Date(l),r._defaults.maxDate=l,r._defaults.maxDateTime=l):c&&(r._defaults.onSelect=c)}return void 0===n?this._base_optionDatepicker.call($.datepicker,e,t):this._base_optionDatepicker.call($.datepicker,e,i||t,n)};var isEmptyObject=function(e){var t;for(t in e)if(e.hasOwnProperty(e))return!1;return!0},extendRemove=function(e,t){$.extend(e,t);for(var n in t)(null===t[n]||void 0===t[n])&&(e[n]=t[n]);return e},useAmpm=function(e){return(-1!==e.indexOf("t")||-1!==e.indexOf("T"))&&-1!==e.indexOf("h")},convert24to12=function(e){return e>12&&(e-=12),0===e&&(e=12),String(e)},splitDateTime=function(e,t,n,i){try{var o=i&&i.separator?i.separator:$.timepicker._defaults.separator,r=i&&i.timeFormat?i.timeFormat:$.timepicker._defaults.timeFormat,a=r.split(o),s=a.length,l=t.split(o),c=l.length;if(c>1)return[l.splice(0,c-s).join(o),l.splice(0,s).join(o)]}catch(d){if($.timepicker.log("Could not split the date from the time. Please check the following datetimepicker options\nthrown error: "+d+"\ndateTimeString"+t+"\ndateFormat = "+e+"\nseparator = "+i.separator+"\ntimeFormat = "+i.timeFormat),d.indexOf(":")>=0){var u=t.length-(d.length-d.indexOf(":")-2);t.substring(u);return[$.trim(t.substring(0,u)),$.trim(t.substring(u))]}throw d}return[t,""]},parseDateTimeInternal=function(e,t,n,i,o){var r,a=splitDateTime(e,n,i,o);if(r=$.datepicker._base_parseDate(e,a[0],i),""!==a[1]){var s=a[1],l=$.datepicker.parseTime(t,s,o);if(null===l)throw"Wrong time format";return{date:r,timeObj:l}}return{date:r}},selectLocalTimeZone=function(e,t){if(e&&e.timezone_select){e._defaults.useLocalTimezone=!0;var n="undefined"!=typeof t?t:new Date,i=$.timepicker.timeZoneOffsetString(n);e._defaults.timezoneIso8601&&(i=i.substring(0,3)+":"+i.substring(3)),e.timezone_select.val(i)}};$.timepicker=new Timepicker,$.timepicker.timeZoneOffsetString=function(e){var t=-1*e.getTimezoneOffset(),n=t%60,i=(t-n)/60;return(t>=0?"+":"-")+("0"+(101*i).toString()).slice(-2)+("0"+(101*n).toString()).slice(-2)},$.timepicker.timeRange=function(e,t,n){return $.timepicker.handleRange("timepicker",e,t,n)},$.timepicker.dateTimeRange=function(e,t,n){$.timepicker.dateRange(e,t,n,"datetimepicker")},$.timepicker.dateRange=function(e,t,n,i){i=i||"datepicker",$.timepicker.handleRange(i,e,t,n)},$.timepicker.handleRange=function(e,t,n,i){function o(e,i,o){i.val()&&new Date(t.val())>new Date(n.val())&&i.val(o)}function r(t,n,i){if($(t).val()){var o=$(t)[e].call($(t),"getDate");o.getTime&&$(n)[e].call($(n),"option",i,o)}}return $.fn[e].call(t,$.extend({onClose:function(e,t){o(this,n,e)},onSelect:function(e){r(this,n,"minDate")}},i,i.start)),$.fn[e].call(n,$.extend({onClose:function(e,n){o(this,t,e)},onSelect:function(e){r(this,t,"maxDate")}},i,i.end)),"timepicker"!=e&&i.reformat&&$([t,n]).each(function(){var t=$(this)[e].call($(this),"option","dateFormat"),n=new Date($(this).val());$(this).val()&&n&&$(this).val($.datepicker.formatDate(t,n))}),o(t,n,t.val()),r(t,n,"minDate"),r(n,t,"maxDate"),$([t.get(0),n.get(0)])},$.timepicker.log=function(e){},$.timepicker.version="1.2.1"}}(jQuery),function(){function e(e){return e&&e.country?Object.extend({countryName:window.t.country(e.country)},e):e}function t(e,t,n){return t.map(function(t){if(t.player.white==n)var i=Chess.colors.white.full,r=Chess.colors.black.full,a=!0;else i=Chess.colors.black.full,r=Chess.colors.white.full,a=!1;return t.opponent=o.getPlayer(e,t.player[r]),t.player=o.getPlayer(e,t.player[i]),t.playerWasWhite=a,t.player&&t.opponent&&t.gameStatus.result&&void 0!==t.gameStatus.result[i]?(t.score=Controller.Broadcast.scoreToString(t.gameStatus.result[i]),t.eloChange=Helper.EloChangeHighPrecision(t.player.elo,t.opponent.elo,t.gameStatus.result[i],t.gameStatus.result[r]).player||0):(t.score="*",t.eloChange=0),t.roundLabel&&(t.roundLabel[config.language()]&&(t.roundLabel=t.roundLabel[config.language()]),t.roundLabel.length>3&&delete t.roundLabel),t})}function n(){var e=$(this),t=new Controller.Broadcast;return t.showGame(e.data("tournamentid"),e.data("roundid"),e.data("matchid"),e.data("gameid")),!1}var i,o;jQuery.fn.addPlayerTournamentStatistics=function(r,a){function s(s,l){var c=a||s.data("playerId");if(c&&"unknown"!==c){var d=(o=o||new Controller.BroadcastTournament).getAllGamesForAPlayer(r,c);if(Array.isArray(d)){i=i||new Handler.Template("broadcast");var u=o.getPlayerResults(r,c,"live"),h=t(r,d,c),p=Math.round(h.reduce(function(e,t){return e+t.eloChange},0)),f={tournamentId:r,games:h,totalEloChange:p,player:e(o.getPlayer(r,c)),formatPoints:Controller.Broadcast.scoreToString(u.p),playerId:c,playerResults:u},g=$(i.render("statistics.miniprofile"+$redesignSuffix,f));g.find(".gameLink").on("click",n),l(g)}}}return this.each(function(){var e=jQuery(this);e.tooltip({},s)})}}(),jQuery.fn.ajaxTabs=function(){function e(e){function t(){e.find("li > a").click(function(){var e=jQuery(this);if(e.data("load-url")&&!e.closest("li").hasClass("current")){e.data("status")||e.data("status",a);var t=e.data("status"),n=e.data("tab-content-id");t==a||t==l&&e.data("load-multiple")?(i(n),e.data("status",s),jQuery.ajax({url:e.data("load-url"),dataType:"json",success:function(t){e.data("status",l),t&&0===t.status&&t.data&&t.data.html&&(jQuery("#"+n+" .tabContentInsider").html(t.data.html).trigger("chess24:loaded"),o(n),setTimeout(function(){jQuery(document).trigger("newhtml")},100))},error:function(t,n,i){e.data("status",a)}})):jQuery("#"+n+" .tabContentInsider").trigger("chess24:show")}return!0}),n()}function n(){var t=e.find("li.current");t.find("a").data("load-url")&&(t.removeClass("current"),t.find("a").trigger("click"),t.addClass("current"))}function i(e){var t=(new Handler.Template).render("commonLoader");jQuery("#"+e+" .tabContentInsider").html(t)}function o(e){jQuery("#"+e+" .tabContentInsider .commonLoader").remove()}var r=this,a=1,s=2,l=3;return e.data("ajaxTabsManager")?e.data("ajaxTabsManager"):(e.data("ajaxTabsManager",r),t(),r)}return new e(this),this},function(e,t){"$:nomunge";function n(e){return"string"==typeof e}function i(e){var t=k.call(arguments,1);return function(){return e.apply(this,t.concat(k.call(arguments)))}}function o(e){return e.replace(y,"$2")}function r(e){return e.replace(/(?:^[^?#]*\?([^#]*).*$)?.*/,"$1")}function a(t,i,o,r,a){var s,l,u,p,f;return r!==c?(u=o.match(t?y:/^([^#?]*)\??([^#]*)(#?.*)/),f=u[3]||"",2===a&&n(r)?l=r.replace(t?v:M,""):(p=h(u[2]),r=n(r)?h[t?j:S](r):r,l=2===a?r:1===a?e.extend({},r,p):e.extend({},p,r),l=d(l),t&&(l=l.replace(w,F))),s=u[1]+(t?C:l||!u[1]?"?":"")+l+f):s=i(o!==c?o:location.href),s}function s(e,t,i){return t===c||"boolean"==typeof t?(i=t,t=x[e?j:S]()):t=n(t)?t.replace(e?v:M,""):t,h(t,i)}function l(t,i,o,r){return n(o)||"object"==typeof o||(r=o,o=i,i=c),this.each(function(){var n=e(this),a=i||m()[(this.nodeName||"").toLowerCase()]||"",s=a&&n.attr(a)||"";n.attr(a,x[t](s,o,r))})}var c,d,u,h,p,f,g,m,v,y,w,b,C,k=Array.prototype.slice,F=decodeURIComponent,x=e.param,T=e.bbq=e.bbq||{},_=e.event.special,E="hashchange",S="querystring",j="fragment",I="elemUrlAttr",A="href",O="src",M=/^.*\?|#.*$/g,P={};x[S]=i(a,0,r),x[j]=u=i(a,1,o),x.sorted=d=function(t,n){var i=[],o={};return e.each(x(t,n).split("&"),function(e,t){var n=t.replace(/(?:%5B|=).*$/,""),r=o[n];r||(r=o[n]=[],i.push(n)),r.push(t)}),e.map(i.sort(),function(e){return o[e]}).join("&")},u.noEscape=function(t){t=t||"";var n=e.map(t.split(""),encodeURIComponent);w=new RegExp(n.join("|"),"g")},u.noEscape(",/"),u.ajaxCrawlable=function(e){return e!==c&&(e?(v=/^.*(?:#!|#)/,y=/^([^#]*)(?:#!|#)?(.*)$/,C="#!"):(v=/^.*#/,y=/^([^#]*)#?(.*)$/,C="#"),b=!!e),b},u.ajaxCrawlable(0),e.deparam=h=function(t,n){var i={},o={"true":!0,"false":!1,"null":null};return e.each(t.replace(/\+/g," ").split("&"),function(t,r){var a,s=r.split("="),l=F(s[0]),d=i,u=0,h=l.split("]["),p=h.length-1;if(/\[/.test(h[0])&&/\]$/.test(h[p])?(h[p]=h[p].replace(/\]$/,""),h=h.shift().split("[").concat(h),p=h.length-1):p=0,2===s.length)if(a=F(s[1]),n&&(a=a&&!isNaN(a)?+a:"undefined"===a?c:o[a]!==c?o[a]:a),p)for(;p>=u;u++)l=""===h[u]?d.length:h[u],d=d[l]=p>u?d[l]||(h[u+1]&&isNaN(h[u+1])?{}:[]):a;else e.isArray(i[l])?i[l].push(a):i[l]!==c?i[l]=[i[l],a]:i[l]=a;else l&&(i[l]=n?c:"")}),i},h[S]=i(s,0),h[j]=p=i(s,1),e[I]||(e[I]=function(t){return e.extend(P,t)})({a:A,base:A,iframe:O,img:O,input:O,form:"action",link:A,script:O}),m=e[I],e.fn[S]=i(l,S),e.fn[j]=i(l,j),T.pushState=f=function(e,t){n(e)&&/^#/.test(e)&&t===c&&(t=2);var i=e!==c,o=u(location.href,i?e:{},i?t:2);location.href=o},T.getState=g=function(e,t){return e===c||"boolean"==typeof e?p(e):p(t)[e]},T.removeState=function(t){var n={};t!==c&&(n=g(),e.each(e.isArray(t)?t:arguments,function(e,t){delete n[t]})),f(n,2)},_[E]=e.extend(_[E],{add:function(t){function n(e){var t=e[j]=u();e.getState=function(e,n){return e===c||"boolean"==typeof e?h(t,e):h(t,n)[e]},i.apply(this,arguments)}var i;return e.isFunction(t)?(i=t,n):(i=t.handler,void(t.handler=n))}})}(jQuery,this),function(e,t,n){"$:nomunge";function i(e){return e=e||location.href,"#"+e.replace(/^[^#]*#?(.*)$/,"$1")}var o,r="hashchange",a=document,s=e.event.special,l=a.documentMode,c="on"+r in t&&(l===n||l>7);e.fn[r]=function(e){return e?this.bind(r,e):this.trigger(r)},e.fn[r].delay=50,s[r]=e.extend(s[r],{setup:function(){return c?!1:void e(o.start)},teardown:function(){return c?!1:void e(o.stop)}}),o=function(){function o(){var n=i(),a=p(d);n!==d?(h(d=n,a),e(t).trigger(r)):a!==d&&(location.href=location.href.replace(/#.*/,"")+a),s=setTimeout(o,e.fn[r].delay)}var s,l={},d=i(),u=function(e){return e},h=u,p=u;return l.start=function(){s||o()},l.stop=function(){s&&clearTimeout(s),s=n},null!==navigator.userAgent.match(/MSIE/i)&&!c&&function(){var t,n;l.start=function(){t||(n=e.fn[r].src,n=n&&n+i(),t=e('<iframe tabindex="-1" title="empty"/>').hide().one("load",function(){n||h(i()),o()}).attr("src",n||"javascript:0").insertAfter("body")[0].contentWindow,a.onpropertychange=function(){try{"title"===event.propertyName&&(t.document.title=a.title)}catch(e){}})},l.stop=u,p=function(){return i(t.location.href)},h=function(n,i){var o=t.document,s=e.fn[r].domain;n!==i&&(o.title=a.title,o.open(),s&&o.write('<script>document.domain="'+s+'"</script>'),o.close(),t.location.hash=n)}}(),l}()}(jQuery,this),function(){var e={init:function(e){this.data=e,this.clear();var t=jQuery("<div/>").addClass("chartScroll").appendTo(this);this.chart=jQuery("<div/>").addClass("chart").appendTo(t);var n=jQuery("<div/>").addClass("labelsScroll").appendTo(this);this.xlabels=jQuery("<div/>").addClass("labels").appendTo(n),this.setup(),this.grid(),this.labels(),this.bars()},update:function(e){this.data=e,this.chart=this.find(".chart"),this.xlabels=this.find(".labels"),this.clear(),this.setup(),this.grid(),this.labels(),this.bars(),this.chart.css("left","-"+(this.data.length*this.dim.move-this.dim.width)+"px")},clear:function(){this.find(".gridLine, label, a, .bar").remove()},setup:function(){for(var e=this,t=0,n=0;n<this.data.length;n++)t=Math.max(t,Math.abs((""+this.data[n]).replace("#","")));t=Math.ceil(t),this.dim={width:parseInt(this.chart.parent().css("width"),10),height:parseInt(this.chart.parent().css("height"),10),left:parseInt(this.css("padding-left"),10),move:this.width()/60},this.measures={top:function(t){return"#"==(""+t).substr(0,1)?parseFloat((""+t).substr(1))<0?e.dim.height/2:0:t>0?e.dim.height/2-this.height(t):e.dim.height/2},height:function(n){return"#"==(""+n).substr(0,1)?e.dim.height/2:Math.abs(n)/t*(e.dim.height/2)},max:function(){return t}}},grid:function(){for(var e=Math.max(60,this.data.length),t=this.dim.move,n=this.measures.max(),i=-n+1;n>i;i++)jQuery("<div/>").addClass("gridLine").css({width:this.dim.width+"px",height:"1px",left:this.dim.left+"px",top:this.measures.top(i)+(0>i?this.measures.height(i):0)}).appendTo(this);for(var i=1;e>i;i++)jQuery("<div/>").addClass("gridLine"+(i%10===0?" special":"")).css({width:"1px",height:this.dim.height+"px",top:"0px",left:i*t+"px"}).appendTo(this.chart);jQuery("<div/>").addClass("gridLine middle").css({width:this.dim.width+"px",height:"2px",top:this.measures.top(0)-1+"px",left:this.dim.left+"px"}).appendTo(this)},labels:function(){for(var e=Math.max(2,this.measures.max()),t=this.dim.move,n=Math.max(30,this.data.length/2),i=5;n>i;i+=5){var o=jQuery("<label/>").addClass("x").html(i).appendTo(this.xlabels);o.css("left",t*i*2-o.width()/2+"px")}for(var i=-e+1;e>i;i++){var o=jQuery("<label/>").addClass("y").html(i).appendTo(this);o.css("top",this.measures.top(i)+-9+(0>i?this.measures.height(i):0)-o.height()/2+"px")}if(this.data.length>60){var r=this;jQuery("<a/>").addClass("scrollLeft").appendTo(this).on("click",function(){r.scroll(-1)}),jQuery("<a/>").addClass("scrollRight").appendTo(this).on("click",function(){r.scroll(1)});var a=this.data.length-60;r.scroll(1,!1,Math.floor(a/20)+1)}},bars:function(){for(var e=this.dim.move,t=this,n=0;n<this.data.length;n++)jQuery("<div/>").addClass("bar "+(parseFloat((""+this.data[n]).replace("#",""))>0?"positive":"negative")).css({left:e*n+1+"px",top:this.measures.top(this.data[n])+"px",width:e-1+"px",height:this.measures.height(this.data[n])+"px"}).appendTo(this.chart).on("mouseover",function(e){return function(){t.trigger("chartover",{index:e,value:t.data[e],bar:jQuery(this)})}}(n))},scroll:function(e,t,n){void 0===t&&(t=!0),n=n||1;var i=this.dim.move,o=this.data.length*i-this.dim.width,r=parseInt(this.chart.css("left"),10);if(t||(r=0),0>e){if(0===r)return;r+=200*n}else{if(!(e>0))return;r-=200*n}var a=-Math.max(0,Math.min(-r,o));t?(this.chart.animate({left:a+"px"},200),this.xlabels.animate({left:a+"px"},200)):(this.chart.css("left",a+"px"),this.xlabels.css("left",a+"px"))}};jQuery.fn.barChart=function(t){return this.each(function(){var n=jQuery(this);n.data("barchart")?t&&jQuery.extend(n,e).update(t):jQuery.extend(n,e).data("barchart",!0).init(t)})}}(),function(){var e=0,t=0,n=function(){var e=jQuery("<div/>").css({visibility:"hidden",position:"fixed",left:"20px",top:"20px"}).appendTo(".bodyContainer");setTimeout(function(){e.remove()},1)},i={getAlignParent:function(){var e=this.attr("x-bubble-align");return e?jQuery(".x-bubble-align-"+e):null},setAlignParent:function(e){var n=this.attr("x-bubble-align");n?jQuery(".x-bubble-align-"+n).removeClass("x-bubble-align-"+n):(n=t++,this.attr("x-bubble-align",n)),e.addClass("x-bubble-align-"+n).on("click",function(e){try{e.cancelBubble=!0,e.stopPropagation()}catch(t){}})},getIncludeParent:function(){var e=this.attr("x-bubble-include");return e?jQuery(".x-bubble-include-"+e):null},setIncludeParent:function(t){var n=e++;t.addClass("x-bubble-include-"+n).on("click",function(e){try{e.cancelBubble=!0,e.stopPropagation()}catch(t){}}),this.attr("x-bubble-include",n),this.addClass("bubble-included")},alignProxy:function(){return this.attr("x-bubble-align")?this.alignAligned():this.attr("x-bubble-include")?this.alignIncluded():this},alignAligned:function(e,t){
var n=e&&!this.settings.noanimation?function(e){this.animate(e,200)}:function(e){this.css(e)},i=this.find("> .bubble-handle:first"),o=this.getAlignParent();if(!o)return this.settings.detached?this:this.hide();this.appendTo(".bodyContainer");var r=t||this.settings.side;this.settings.forceside=t;var a=this.settings.offset_x||0,s=this.settings.offset_y||0;this.add(this.find(".bubble-contents")).css("height","auto").css("width","auto");var l=this.height(),c=this.width(),d=o.offset().left,u=o.offset().top,h=o.width()+parseInt(o.css("padding-left"))+parseInt(o.css("padding-right")),p=o.height()+parseInt(o.css("padding-top"))+parseInt(o.css("padding-bottom")),f="overlay"==this.settings.point?8:-i.height()+8;if("left"==r){if(!t&&this.settings.flexible&&!this.settings.x&&d+h+f+c>jQuery(document).width())return this.alignAligned(e,"right");n.call(this,{left:this.settings.x||d+h+f+a+"px",top:this.settings.y||u+p/2-l/2+s+"px"}),this.settings.y?i.css("top",u-this.settings.y+p/2-i.height()/2+"px"):i.css("top",l/2-i.height()/2+"px")}else if("right"==r){if(!t&&this.settings.flexible&&!this.settings.x&&d-c-f<jQuery(window).scrollLeft())return this.alignAligned(e,"left");n.call(this,{left:this.settings.x||d-c-f+a+"px",top:this.settings.y||u+p/2-l/2+s+"px"}),this.settings.y?i.css("top",u-this.settings.y+p/2-i.height()/2+"px"):i.css("top",l/2-i.height()/2+"px")}else if("top"==r)if(this.settings.detached)i.css({left:d+h/2-i.width()/2-this.offset().left+"px",top:u-this.offset().top+f}),i.offset().top>this.offset().top&&i.offset().top+i.height()<this.offset().top+this.height()?i.hide():i.show();else{if(!t&&this.settings.flexible&&!this.settings.y&&u+p+f+l>jQuery(window).height())return this.alignAligned(e,"bottom");n.call(this,{left:this.settings.x||d+h/2-c/2+a+"px",top:this.settings.y||u+p-f+s+"px"}),this.settings.x?i.css("left",d-this.settings.x+h/2-i.width()/2+"px"):i.css("left",c/2-i.width()/2+"px")}else if("bottom"==r)if(this.settings.detached)i.css({left:d+h/2-i.width()/2-this.offset().left+"px",top:u-this.offset().top+f}),i.offset().top>this.offset().top&&i.offset().top+i.height()<this.offset().top+this.height()?i.hide():i.show();else{if(!t&&this.settings.flexible&&!this.settings.y&&u-l+f<jQuery(window).scrollTop())return this.alignAligned(e,"top");n.call(this,{left:this.settings.x||d+h/2-c/2+a+"px",top:this.settings.y||u-l+f+s+"px"}),this.settings.x?i.css("left",d-this.settings.x+h/2-i.width()/2+"px"):i.css("left",c/2-i.width()/2+"px")}return this},alignIncluded:function(e){var t=this.find("> .bubble-handle:first"),n=this.getIncludeParent(),i=this.height(),o=this.width(),r=n.width()+parseInt(n.css("padding-left"))+parseInt(n.css("padding-right")),a=n.height()+parseInt(n.css("padding-top"))+parseInt(n.css("padding-bottom")),s="overlay"==this.settings.point?8:-t.height()+8;return"left"==this.settings.side?(this.css({left:r+s+"px",top:a/2-i/2+"px"}),t.css("top",i/2-t.height()/2+"px")):"right"==this.settings.side?(this.css({left:-o-s+"px",top:a/2-i/2+"px"}),t.css("top",i/2-t.height()/2+"px")):"top"==this.settings.side?(this.css({left:r/2-o/2+"px",top:a+s+"px"}),t.css("left",o/2-t.width()/2+"px")):"bottom"==this.settings.side&&(this.css({left:r/2-o/2+"px",top:-s-i+"px"}),t.css("left",o/2-t.width()/2+"px")),"function"==typeof e&&e(),this},show:function(e){var t=this.settings.noanimation?function(e,t,n){this.css(e),n&&n()}:function(e,t,n){this.animate(e,t,n)};if(this.settings.persistent)return void this.find(".bubble-handle").show();var i=this;if("block"==this.css("display"))return"function"==typeof e&&e(),this;this.alignProxy();var o=this.find(".bubble-contents");this.hide(),o.css("width","auto").css("height","auto");var r=this.height(),a=this.width(),s=parseInt(this.css("left")),l=parseInt(this.css("top")),c=this.settings.forceside||this.settings.side;switch(this.removeClass("bubble-left bubble-right bubble-top bubble-bottom").addClass("bubble-"+c),c){case"left":t.call(o.css("width","0px"),{width:a+"px"},200,function(){o.css("width","auto"),e&&e(),n()}),this.css("display","block");break;case"right":t.call(o.css("width","0px"),{width:a+"px"},200,function(){o.css("width","auto"),n()}),t.call(this.css("left",s+a+"px").css("display","block"),{left:s+"px"},200,e);break;case"top":t.call(o.css("height","0px"),{height:r+"px"},200,function(){o.css("height","auto"),e&&e(),n()}),this.css("display","block");break;case"bottom":t.call(o.css("height","0px"),{height:r+"px"},200,function(){o.css("height","auto"),n()}),t.call(this.css("top",l+r+"px").css("display","block"),{top:l+"px"},200,e)}if("top"==c||"bottom"==c){var d=Math.max(0,this.offset().left+this.width()-jQuery(window).width())||Math.min(0,this.offset().left);if(d){var u=this.find(".bubble-handle");this.css("left",parseInt(this.css("left"))-d+"px"),u.css("left",parseInt(u.css("left"))+d+"px")}}if(!this.settings.persistent){var h=function(e){"block"==i.css("display")&&3!=e.which&&(i.hide(),jQuery(document).off("click",h))};jQuery(document).on("click",h)}return this},hide:function(e){var t=this.settings.noanimation?function(e,t,n){this.css(e),n&&n()}:function(e,t,n){this.animate(e,t,n)};if(this.settings.persistent)return void this.find(".bubble-handle").hide();if("none"==this.css("display"))return"function"==typeof e&&e(),this;var n=this,i=this.find(".bubble-contents"),o=this.settings.forceside||this.settings.side;this.css("width","auto").css("height","auto");var r=this.height(),a=this.width(),s=parseInt(this.css("left")),l=parseInt(this.css("top"));switch(o){case"left":t.call(i,{width:"0px"},200,function(){e&&e(),n.css("display","none")});break;case"right":t.call(i,{width:"0px"},200),t.call(this,{left:s+a+"px"},200,function(){e&&e(),n.css("display","none").css("left",s+"px").css("width",a+"px")});break;case"top":t.call(i,{height:"0px"},200,function(){e&&e(),n.css("display","none")});break;case"bottom":t.call(i,{height:"0px"},200),t.call(this,{top:l+r+"px"},200,function(){e&&e(),n.css("display","none").css("top",l+"px").css("height",r+"px")})}return this},realign:function(e){return e?jQuery(e).length?(this.setAlignParent(jQuery(e)),this.find(".bubble-handle").show(),"none"==this.css("display")?this.show():this.alignAligned(!0),this):this:this.alignAligned()},collapseTitle:function(e){var t=this.find(".bubble-collapsed-text");t.length||(t=jQuery("<div/>").addClass("bubble-collapsed-text").appendTo(this)),"undefined"!=typeof e&&t.html(e)},collapse:function(e){var t=this;this.collapseTitle(e),this.hasClass("bubble-collapsed")||(this.data("expanded-height",this.height()),this.addClass("bubble-collapsed"),this.animate({height:"36px"},200,function(){t.find(".bubble-contents").hide(),t.trigger("collapse")}))},expand:function(){if(this.hasClass("bubble-collapsed")){var e=this;this.find(".bubble-contents").show(),this.animate({height:this.data("expanded-height")+"px"},200,function(){e.removeClass("bubble-collapsed"),e.trigger("expand")})}},detach:function(){return this.settings.detached?this:(this.settings.detached=!0,this.saveSettings(),this.alignProxy(),this)},attach:function(){return this.settings.detached?(this.settings.detached=!1,this.saveSettings(),this.alignProxy(),this):this},adjust:function(){var e=0,t=0;this.find("> *").each(function(){jQuery(this).hasClass("bubble-handle")||(t+=jQuery(this).innerHeight(),e=Math.max(e,jQuery(this).innerWidth()))});var n=e-this.innerWidth(),i=t-this.innerHeight(),o={};n&&(o.width=e+"px"),i&&(o.height=t+"px");var r=this.settings.forceside||this.settings.side;t&&"bottom"==r&&(o.top=(i>0?"-":"+")+"="+Math.abs(i)+"px"),e&&"right"==r&&(o.left=(n>0?"-":"+")+"="+Math.abs(n)+"px"),this.animate(o,200)},html:function(e){return jQuery(".bubble-handle",this).next().html(e),this},options:function(e){this.settings=jQuery.extend(this.settings,e),this.saveSettings()},saveSettings:function(){this.data("bubble-settings",this.settings)}};jQuery.fn.bubble=function(e){var t={};"object"==typeof e&&(t=jQuery.extend({},e,{align:e.align?jQuery(e.align):null,include:e.include&&!e.align?jQuery(e.include):null,side:!e.side||"left"!=e.side&&"right"!=e.side&&"top"!=e.side&&"bottom"!=e.side?"left":e.side,point:e.point||"overlay",mode:e.mode||"free",x:e.x,y:e.y}));var n;if(!this.length)return this;if(e||(e={}),"string"==typeof e){var o=this.hasClass("bubble")?this:this.closest(".bubble");if(!o.length)return;o.settings=jQuery.extend(o.data("bubble-settings")||{},t),n=jQuery.extend(o,i),"function"==typeof n[e]&&n[e].apply(n,[].slice.call(arguments,1))}else{var r=jQuery('<div class="bubble-handle"/>');if(n=jQuery('<div class="bubble"/>')[t.persistent?"show":"hide"]().append(r).append(jQuery('<div class="bubble-contents"/>').append(this)).css("width",t.width||"auto").appendTo(t.include||".bodyContainer").addClass("bubble-"+t.side),n=jQuery.extend(n,i),n.data("bubble-settings",t).settings=t,t.close)n.append(jQuery("<a/>").addClass("bubble-close").on("click",function(e){return n.bubble("hide"),!1}));else if(t.collapsable){var a,s;a=jQuery("<a/>").addClass("bubble-collapse").on("click",function(e){return n.bubble("collapse"),a.hide(),s.show(),!1}),s=jQuery("<a/>").addClass("bubble-expand").on("click",function(e){return n.bubble("expand"),s.hide(),a.show(),!1}).hide(),n.append(a).append(s)}t.align?n.setAlignParent(t.align):t.include&&n.setIncludeParent(t.include),jQuery(this).on("click",function(e){try{e.cancelBubble=!0,e.stopPropagation()}catch(t){}})}return n}}(),jQuery.fn.capturedPieces=function(e){function t(e,t){function n(){var e=new Handler.Template("plugin"),t=e.render("capturedPieces");s.html(t),u.capturedWhitePiecesRow=s.find(".capturedWhitePiecesHolder"),u.capturedBlackPiecesRow=s.find(".capturedBlackPiecesHolder"),u.capturedPiecesSwitch=s.find(".capturedPiecesSwitch"),u.materialBalanceSwitch=s.find(".materialBalanceSwitch"),l=new View.CapturedPieces(u.capturedWhitePiecesRow,["w"],!1).link(d),c=new View.CapturedPieces(u.capturedBlackPiecesRow,["b"],!1).link(d),u.capturedPiecesSwitch.on("click",i),u.materialBalanceSwitch.on("click",o)}function i(){return r(!1)}function o(){return r(!0)}function r(e){l.setDiff(e),c.setDiff(e),e?(u.materialBalanceSwitch.addClass("active"),u.capturedPiecesSwitch.removeClass("active")):(u.capturedPiecesSwitch.addClass("active"),u.materialBalanceSwitch.removeClass("active"))}var a=this,s=jQuery(e),l=null,c=null,d=t.chessGameHandler,u={capturedWhitePiecesRow:null,capturedBlackPiecesRow:null,capturedPiecesSwitch:null,materialBalanceSwitch:null};return n(),a}return this.each(function(){return jQuery(this).data("capturedPieces")||(e&&e.chessGameHandler||errorHandler.msg("error",new Error("No chessGameHandler given"),!0),jQuery(this).data("capturedPieces",new t(this,e))),this})},function(){var e={peritem:200,count:0,position:0,radius:0,itemwidth:100,ratio:1.58,init:function(e){if(this.closest("div.carousel").length)this.catchup();else{for(var t in e)("number"==typeof this[t]||"string"==typeof this[t])&&(this[t]=e[t]);var n=jQuery("<div/>").addClass("carousel preventSelection").insertBefore(this);this.controls={container:n,viewport:jQuery("<div/>").addClass("carousel-viewport").appendTo(n).append(this),next:jQuery("<a/>").addClass("carousel-next").appendTo(n),previous:jQuery("<a/>").addClass("carousel-previous").appendTo(n)}}this.find("li img").each(function(){var e=jQuery(this);e.attr("src")&&!e.data("src")&&e.data("src",e.attr("src")).attr("src","")}),this.find("li").each(function(){var e=jQuery(this);e.find("> div.title").length||jQuery("<div/>").addClass("title").html(e.attr("title")).appendTo(e),e.find("> div.image").length||jQuery("<div/>").addClass("image").append(e.find(">a,>img")).appendTo(e),e.find("> div.comment").length||jQuery("<div/>").addClass("comment").html(e.attr("comment")).appendTo(e),e.removeAttr("title comment")}),this.radius=this.controls.viewport.width()/2,this.count=this.find("li").length,this.position=this.entire()/2+(this.count%2===0?-this.peritem/2:0);var i=this.find("li.start");if(i.length){var o=i.prevAll("li").length;this.position=o*this.peritem}this.setupInteractions(),this.css("visibility","visible").adjust()},catchup:function(){var e=this.closest("div.carousel");this.controls={container:e,viewport:e.find(".carousel-viewport"),next:e.find(".carousel-next"),previous:e.find(".carousel-previous")}},setupInteractions:function(){var e=this,t=function(e){try{e.preventDefault(),e.stopPropagation()}catch(t){e.cancelBubble=!0,e.returnValue=!1}return!1};this.controls.next.on("click",function(n){return e.scrollTo(e.position+e.peritem,!0),t(n)}),this.controls.previous.on("click",function(n){return e.scrollTo(e.position-e.peritem,!0),t(n)});var n=!1;this.on("mousedown",function(t){n=!1;var i=t.pageX,o=e.position,r=function(){jQuery(document).off("mousemove",a)},a=function(t){n=!0,e.scrollTo(o-(t.pageX-i))};jQuery(document).on("mousemove",a).one("mouseup",r);try{t.stopPropagation(),t.preventDefault()}catch(s){t.cancelBubble=!0,t.returnValue=!1}}),this.find("li a").on("click",function(e){return n?t(e):void 0})},scrollTo:function(e,t){if(this.animation&&clearTimeout(this.animation),t){e=Math.max(0,Math.min(e,this.entire()));var n=this,i=function(e,t,n,i){return e/=i,e--,n*(e*e*e+1)+t},o=0,r=200,a=20,s=this.position,l=e-s;this.animation=setInterval(function(){o+=r/a,n.position=i(o,s,l,r),n.adjust(),o>=r&&clearTimeout(n.animation)},r/a)}else this.position=Math.max(0,Math.min(e,this.entire())),this.adjust()},load:function(){},entire:function(){return(this.count-1)*this.peritem},calculateItem:function(e){var t=this.position-this.radius*Math.PI/2,n=this.position+this.radius*Math.PI/2,i=this.controls.viewport.width(),o=e>=t-4*this.peritem&&e<=n+4*this.peritem;if(t>e)return{x:0,y:0,left:!0,stack:!0,preload:o};if(e>n)return{x:i,y:0,right:!0,stack:!0,preload:o};var r=2*Math.PI*this.radius,a=(e-this.position)/r*(2*Math.PI),s=this.radius*Math.sin(a),l=Math.cos(a);return{x:i/2+s,y:l,front:Math.abs(a)<Math.PI/8.6,left:Math.abs(a)>=Math.PI/8.6&&e<this.position,right:Math.abs(a)>=Math.PI/8.6&&e>this.position,preload:!0}},adjust:function(){var e=this,t=e.controls.viewport.height()/2,n=this.find("li");n.each(function(i){var o=jQuery(this),r=o.find("img"),a=i*e.peritem,s=e.calculateItem(a),l=1+2*Math.pow(s.y,4),c=e.itemwidth*l,d=e.itemwidth/e.ratio*l,u=0;s.front?(o.addClass("front"),u=parseInt(o.css("padding-top"),10)):o.removeClass("front"),o[s.front?"addClass":"removeClass"]("front"),o[s.left?"addClass":"removeClass"]("left"),o[s.right?"addClass":"removeClass"]("right"),o[s.stack&&(s.right&&i<n.length-1||s.left&&i>0)?"addClass":"removeClass"]("stack"),o.css({width:c+"px",height:d+"px",left:s.x-c/2+"px",top:t-d/2-u+"px","z-index":Math.ceil(10*s.y)+(s.stack?0:1)}),r.css({height:d+"px",width:c+"px"}),s.preload&&!r.attr("src")&&r.attr("src",r.data("src")).data("src","")}),n.filter(".stack.left:last, .stack.right:first").css("z-index",1)}};jQuery.fn.carousel=function(t){$(this).each(function(){var n=$(this);n.data("carousel")||(n.data("carousel",!0),jQuery.extend(n,e).init(t))})}}(),function(e){e.fn.centerScreen=function(t){var n=this;t?(n.stop(),n.animate({top:e(window).height()/2-this.height()/2,left:e(window).width()/2-this.width()/2},200,"linear")):(n.css("top",e(window).height()/2-this.height()/2),n.css("left",e(window).width()/2-this.width()/2),e(window).resize(function(){n.centerScreen(!t)}))}}(jQuery),function(e){function t(t){var n=t.data("class-setter-on-click"),i=n.classname,o=n.method;if(i&&o){var r=e(n.target);if(!n.target)var r=t;switch(o){case"add":r.addClass(i);break;case"remove":r.removeClass(i);break;case"toggle":r.toggleClass(i)}}}e.fn.classSetterOnClick=function(){this.on("click",function(){t(e(this))})}}(jQuery),function(e){var t=null;e.fn.clipboard=function(n){if("object"==typeof n&&!n.length||"undefined"==typeof n){var i=e.extend({path:"jquery.clipboard.swf",copy:null,beforeCopy:null,afterCopy:null,clickAfter:!0},n||{});return this.each(function(){var n=e(this);n.is(":visible")&&("string"==typeof i.copy||e.isFunction(i.copy))&&(e.isFunction(i.copy)&&n.bind("Clipboard_copy",i.copy),e.isFunction(i.beforeCopy)&&n.bind("Clipboard_beforeCopy",i.beforeCopy),e.isFunction(i.afterCopy)&&n.bind("Clipboard_afterCopy",i.afterCopy),null===t&&(ZeroClipboard.config({moviePath:i.path,trustedDomains:"*",hoverClass:"hover",activeClass:"active"}),t=new ZeroClipboard(null),t.on("load",function(t){t.on("mouseover",function(t){e(this).trigger("mouseenter")}),t.on("mouseout",function(t){e(this).trigger("mouseleave")}),t.on("mousedown",function(t){e(this).trigger("mousedown"),e.isFunction(i.copy)?t.setText(e(this).triggerHandler("Clipboard_copy")):t.setText(i.copy),e.isFunction(i.beforeCopy)&&e(this).trigger("Clipboard_beforeCopy")}),t.on("complete",function(t,n){e.isFunction(i.afterCopy)?e(this).trigger("Clipboard_afterCopy"):e(this).removeClass("hover"),i.clickAfter&&e(this).trigger("click")})})),t.clip([n[0]]))})}}}(jQuery),function(){"use strict";function e(e){return e.replace(/,/g,".").replace(/[^0-9\.]/g,"")}function t(t){return parseFloat(e(t))>=10}var n,i={bridge:null,version:"0.0.0",disabled:null,outdated:null,ready:null},o={},r=0,a={},s=0,l={},c=null,d=null,u=function(){var e,t,n,i,o="ZeroClipboard.swf";if(document.currentScript&&(i=document.currentScript.src));else{var r=document.getElementsByTagName("script");if("readyState"in r[0])for(e=r.length;e--&&("interactive"!==r[e].readyState||!(i=r[e].src)););else if("loading"===document.readyState)i=r[r.length-1].src;else{for(e=r.length;e--;){if(n=r[e].src,!n){t=null;break}if(n=n.split("#")[0].split("?")[0],n=n.slice(0,n.lastIndexOf("/")+1),null===t)t=n;else if(t!==n){t=null;break}}null!==t&&(i=t)}}return i&&(i=i.split("#")[0].split("?")[0],o=i.slice(0,i.lastIndexOf("/")+1)+o),o}(),h=function(){var e=/\-([a-z])/g,t=function(e,t){return t.toUpperCase()};return function(n){return n.replace(e,t)}}(),p=function(e,t){var n,i,o;return window.getComputedStyle?n=window.getComputedStyle(e,null).getPropertyValue(t):(i=h(t),n=e.currentStyle?e.currentStyle[i]:e.style[i]),"cursor"!==t||n&&"auto"!==n||(o=e.tagName.toLowerCase(),"a"!==o)?n:"pointer"},f=function(e){e||(e=window.event);var t;this!==window?t=this:e.target?t=e.target:e.srcElement&&(t=e.srcElement),P.activate(t)},g=function(e,t,n){e&&1===e.nodeType&&(e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent&&e.attachEvent("on"+t,n))},m=function(e,t,n){e&&1===e.nodeType&&(e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent&&e.detachEvent("on"+t,n))},v=function(e,t){if(!e||1!==e.nodeType)return e;if(e.classList)return e.classList.contains(t)||e.classList.add(t),e;if(t&&"string"==typeof t){var n=(t||"").split(/\s+/);if(1===e.nodeType)if(e.className){for(var i=" "+e.className+" ",o=e.className,r=0,a=n.length;a>r;r++)i.indexOf(" "+n[r]+" ")<0&&(o+=" "+n[r]);e.className=o.replace(/^\s+|\s+$/g,"")}else e.className=t}return e},y=function(e,t){if(!e||1!==e.nodeType)return e;if(e.classList)return e.classList.contains(t)&&e.classList.remove(t),e;if(t&&"string"==typeof t||void 0===t){var n=(t||"").split(/\s+/);if(1===e.nodeType&&e.className)if(t){for(var i=(" "+e.className+" ").replace(/[\n\t]/g," "),o=0,r=n.length;r>o;o++)i=i.replace(" "+n[o]+" "," ");e.className=i.replace(/^\s+|\s+$/g,"")}else e.className=""}return e},w=function(){var e,t,n,i=1;return"function"==typeof document.body.getBoundingClientRect&&(e=document.body.getBoundingClientRect(),t=e.right-e.left,n=document.body.offsetWidth,i=Math.round(t/n*100)/100),i},b=function(e,t){var n={left:0,top:0,width:0,height:0,zIndex:_(t)-1};if(e.getBoundingClientRect){var i,o,r,a=e.getBoundingClientRect();"pageXOffset"in window&&"pageYOffset"in window?(i=window.pageXOffset,o=window.pageYOffset):(r=w(),i=Math.round(document.documentElement.scrollLeft/r),o=Math.round(document.documentElement.scrollTop/r));var s=document.documentElement.clientLeft||0,l=document.documentElement.clientTop||0;n.left=a.left+i-s,n.top=a.top+o-l,n.width="width"in a?a.width:a.right-a.left,n.height="height"in a?a.height:a.bottom-a.top}return n},C=function(e,t){var n=null===t||t&&t.cacheBust===!0&&t.useNoCache===!0;return n?(-1===e.indexOf("?")?"?":"&")+"noCache="+(new Date).getTime():""},k=function(e){var t,n,i,o=[],r=[],a=[];if(e.trustedOrigins&&("string"==typeof e.trustedOrigins?r.push(e.trustedOrigins):"object"==typeof e.trustedOrigins&&"length"in e.trustedOrigins&&(r=r.concat(e.trustedOrigins))),e.trustedDomains&&("string"==typeof e.trustedDomains?r.push(e.trustedDomains):"object"==typeof e.trustedDomains&&"length"in e.trustedDomains&&(r=r.concat(e.trustedDomains))),r.length)for(t=0,n=r.length;n>t;t++)if(r.hasOwnProperty(t)&&r[t]&&"string"==typeof r[t]){if(i=j(r[t]),!i)continue;if("*"===i){a=[i];break}a.push.apply(a,[i,"//"+i,window.location.protocol+"//"+i])}return a.length&&o.push("trustedOrigins="+encodeURIComponent(a.join(","))),"string"==typeof e.jsModuleId&&e.jsModuleId&&o.push("jsModuleId="+encodeURIComponent(e.jsModuleId)),o.join("&")},F=function(e,t,n){if("function"==typeof t.indexOf)return t.indexOf(e,n);var i,o=t.length;for("undefined"==typeof n?n=0:0>n&&(n=o+n),i=n;o>i;i++)if(t.hasOwnProperty(i)&&t[i]===e)return i;return-1},x=function(e){if("string"==typeof e)throw new TypeError("ZeroClipboard doesn't accept query strings.");return e.length?e:[e]},T=function(e,t,n,i){i?window.setTimeout(function(){e.apply(t,n)},0):e.apply(t,n)},_=function(e){var t,n;return e&&("number"==typeof e&&e>0?t=e:"string"==typeof e&&(n=parseInt(e,10))&&!isNaN(n)&&n>0&&(t=n)),t||("number"==typeof L.zIndex&&L.zIndex>0?t=L.zIndex:"string"==typeof L.zIndex&&(n=parseInt(L.zIndex,10))&&!isNaN(n)&&n>0&&(t=n)),t||0},E=function(e,t){if(e&&t!==!1&&"undefined"!=typeof console&&console&&(console.warn||console.log)){var n="`"+e+"` is deprecated. See docs for more info:\n    https://github.com/zeroclipboard/zeroclipboard/blob/master/docs/instructions.md#deprecations";console.warn?console.warn(n):console.log(n)}},S=function(){var e,t,n,i,o,r,a=arguments[0]||{};for(e=1,t=arguments.length;t>e;e++)if(null!==(n=arguments[e]))for(i in n)if(n.hasOwnProperty(i)){if(o=a[i],r=n[i],a===r)continue;void 0!==r&&(a[i]=r)}return a},j=function(e){if(null===e||""===e)return null;if(e=e.replace(/^\s+|\s+$/g,""),""===e)return null;var t=e.indexOf("//");e=-1===t?e:e.slice(t+2);var n=e.indexOf("/");return e=-1===n?e:-1===t||0===n?null:e.slice(0,n),e&&".swf"===e.slice(-4).toLowerCase()?null:e||null},I=function(){var e=function(e,t){var n,i,o;if(null!==e&&"*"!==t[0]&&("string"==typeof e&&(e=[e]),"object"==typeof e&&"length"in e))for(n=0,i=e.length;i>n;n++)if(e.hasOwnProperty(n)&&(o=j(e[n]))){if("*"===o){t.length=0,t.push("*");break}-1===F(o,t)&&t.push(o)}},t={always:"always",samedomain:"sameDomain",never:"never"};return function(n,i){var o,r=i.allowScriptAccess;if("string"==typeof r&&(o=r.toLowerCase())&&/^always|samedomain|never$/.test(o))return t[o];var a=j(i.moviePath);null===a&&(a=n);var s=[];e(i.trustedOrigins,s),e(i.trustedDomains,s);var l=s.length;if(l>0){if(1===l&&"*"===s[0])return"always";if(-1!==F(n,s))return 1===l&&n===a?"sameDomain":"always"}return"never"}}(),A=function(e){if(null===e)return[];if(Object.keys)return Object.keys(e);var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t},O=function(e){if(e)for(var t in e)e.hasOwnProperty(t)&&delete e[t];return e},M=function(){var e=!1;if("boolean"==typeof i.disabled)e=i.disabled===!1;else{if("function"==typeof ActiveXObject)try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash")&&(e=!0)}catch(t){}!e&&navigator.mimeTypes["application/x-shockwave-flash"]&&(e=!0)}return e},P=function(e,t){return this instanceof P?(this.id=""+r++,a[this.id]={instance:this,elements:[],handlers:{}},e&&this.clip(e),"undefined"!=typeof t&&(E("new ZeroClipboard(elements, options)",L.debug),P.config(t)),this.options=P.config(),"boolean"!=typeof i.disabled&&(i.disabled=!M()),void(i.disabled===!1&&i.outdated!==!0&&null===i.bridge&&(i.outdated=!1,i.ready=!1,N()))):new P(e,t)};P.prototype.setText=function(e){return e&&""!==e&&(o["text/plain"]=e,i.ready===!0&&i.bridge&&i.bridge.setText(e)),this},P.prototype.setSize=function(e,t){return i.ready===!0&&i.bridge&&i.bridge.setSize(e,t),this};var B=function(e){i.ready===!0&&i.bridge&&i.bridge.setHandCursor(e)};P.prototype.destroy=function(){this.unclip(),this.off(),delete a[this.id]};var R=function(){var e,t,n,i=[],o=A(a);for(e=0,t=o.length;t>e;e++)n=a[o[e]].instance,n&&n instanceof P&&i.push(n);return i};P.version="1.3.2";var L={swfPath:u,trustedDomains:window.location.host?[window.location.host]:[],cacheBust:!0,forceHandCursor:!1,zIndex:999999999,debug:!0,title:null,autoActivate:!0};P.config=function(e){"object"==typeof e&&null!==e&&S(L,e);{if("string"!=typeof e||!e){var t={};for(var n in L)L.hasOwnProperty(n)&&("object"==typeof L[n]&&null!==L[n]?"length"in L[n]?t[n]=L[n].slice(0):t[n]=S({},L[n]):t[n]=L[n]);return t}if(L.hasOwnProperty(e))return L[e]}},P.destroy=function(){P.deactivate();for(var e in a)if(a.hasOwnProperty(e)&&a[e]){var t=a[e].instance;t&&"function"==typeof t.destroy&&t.destroy()}var n=D(i.bridge);n&&n.parentNode&&(n.parentNode.removeChild(n),i.ready=null,i.bridge=null)},P.activate=function(e){n&&(y(n,L.hoverClass),y(n,L.activeClass)),n=e,v(e,L.hoverClass),Q();var t=L.title||e.getAttribute("title");if(t){var o=D(i.bridge);o&&o.setAttribute("title",t)}var r=L.forceHandCursor===!0||"pointer"===p(e,"cursor");B(r)},P.deactivate=function(){var e=D(i.bridge);e&&(e.style.left="0px",e.style.top="-9999px",e.removeAttribute("title")),n&&(y(n,L.hoverClass),y(n,L.activeClass),n=null)};var N=function(){var e,t,n=document.getElementById("global-zeroclipboard-html-bridge");if(!n){var o=P.config();o.jsModuleId="string"==typeof c&&c||"string"==typeof d&&d||null;var r=I(window.location.host,L),a=k(o),s=L.moviePath+C(L.moviePath,L),l='      <object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" id="global-zeroclipboard-flash-bridge" width="100%" height="100%">         <param name="movie" value="'+s+'"/>         <param name="allowScriptAccess" value="'+r+'"/>         <param name="scale" value="exactfit"/>         <param name="loop" value="false"/>         <param name="menu" value="false"/>         <param name="quality" value="best" />         <param name="bgcolor" value="#ffffff"/>         <param name="wmode" value="transparent"/>         <param name="flashvars" value="'+a+'"/>         <embed src="'+s+'"           loop="false" menu="false"           quality="best" bgcolor="#ffffff"           width="100%" height="100%"           name="global-zeroclipboard-flash-bridge"           allowScriptAccess="'+r+'"           allowFullScreen="false"           type="application/x-shockwave-flash"           wmode="transparent"           pluginspage="http://www.macromedia.com/go/getflashplayer"           flashvars="'+a+'"           scale="exactfit">         </embed>       </object>';n=document.createElement("div"),n.id="global-zeroclipboard-html-bridge",n.setAttribute("class","global-zeroclipboard-container"),n.style.position="absolute",n.style.left="0px",n.style.top="-9999px",n.style.width="15px",n.style.height="15px",n.style.zIndex=""+_(L.zIndex),document.body.appendChild(n),n.innerHTML=l}e=document["global-zeroclipboard-flash-bridge"],e&&(t=e.length)&&(e=e[t-1]),i.bridge=e||n.children[0].lastElementChild},D=function(e){for(var t=/^OBJECT|EMBED$/,n=e&&e.parentNode;n&&t.test(n.nodeName)&&n.parentNode;)n=n.parentNode;return n||null},Q=function(){if(n){var e=b(n,L.zIndex),t=D(i.bridge);t&&(t.style.top=e.top+"px",t.style.left=e.left+"px",t.style.width=e.width+"px",t.style.height=e.height+"px",t.style.zIndex=e.zIndex+1),i.ready===!0&&i.bridge&&i.bridge.setSize(e.width,e.height)}return this};P.prototype.on=function(e,t){var n,o,r,s={},l=a[this.id]&&a[this.id].handlers;if("string"==typeof e&&e)r=e.toLowerCase().split(/\s+/);else if("object"==typeof e&&e&&"undefined"==typeof t)for(n in e)e.hasOwnProperty(n)&&"string"==typeof n&&n&&"function"==typeof e[n]&&this.on(n,e[n]);if(r&&r.length){for(n=0,o=r.length;o>n;n++)e=r[n].replace(/^on/,""),s[e]=!0,l[e]||(l[e]=[]),l[e].push(t);s.noflash&&i.disabled&&V.call(this,"noflash",{}),s.wrongflash&&i.outdated&&V.call(this,"wrongflash",{flashVersion:i.version}),s.load&&i.ready&&V.call(this,"load",{flashVersion:i.version})}return this},P.prototype.off=function(e,t){var n,i,o,r,s,l=a[this.id]&&a[this.id].handlers;if(0===arguments.length)r=A(l);else if("string"==typeof e&&e)r=e.split(/\s+/);else if("object"==typeof e&&e&&"undefined"==typeof t)for(n in e)e.hasOwnProperty(n)&&"string"==typeof n&&n&&"function"==typeof e[n]&&this.off(n,e[n]);if(r&&r.length)for(n=0,i=r.length;i>n;n++)if(e=r[n].toLowerCase().replace(/^on/,""),s=l[e],s&&s.length)if(t)for(o=F(t,s);-1!==o;)s.splice(o,1),o=F(t,s,o);else l[e].length=0;return this},P.prototype.handlers=function(e){var t,n=null,i=a[this.id]&&a[this.id].handlers;if(i){if("string"==typeof e&&e)return i[e]?i[e].slice(0):null;n={};for(t in i)i.hasOwnProperty(t)&&i[t]&&(n[t]=i[t].slice(0))}return n};var H=function(e,t,n,i){var o=a[this.id]&&a[this.id].handlers[e];if(o&&o.length){var r,s,l,c=t||this;for(r=0,s=o.length;s>r;r++)l=o[r],t=c,"string"==typeof l&&"function"==typeof window[l]&&(l=window[l]),"object"==typeof l&&l&&"function"==typeof l.handleEvent&&(t=l,l=l.handleEvent),"function"==typeof l&&T(l,t,n,i)}return this};P.prototype.clip=function(e){e=x(e);for(var t=0;t<e.length;t++)if(e.hasOwnProperty(t)&&e[t]&&1===e[t].nodeType){e[t].zcClippingId?-1===F(this.id,l[e[t].zcClippingId])&&l[e[t].zcClippingId].push(this.id):(e[t].zcClippingId="zcClippingId_"+s++,l[e[t].zcClippingId]=[this.id],L.autoActivate===!0&&g(e[t],"mouseover",f));var n=a[this.id].elements;-1===F(e[t],n)&&n.push(e[t])}return this},P.prototype.unclip=function(e){var t=a[this.id];if(t){var n,i=t.elements;e="undefined"==typeof e?i.slice(0):x(e);for(var o=e.length;o--;)if(e.hasOwnProperty(o)&&e[o]&&1===e[o].nodeType){for(n=0;-1!==(n=F(e[o],i,n));)i.splice(n,1);var r=l[e[o].zcClippingId];if(r){for(n=0;-1!==(n=F(this.id,r,n));)r.splice(n,1);0===r.length&&(L.autoActivate===!0&&m(e[o],"mouseover",f),delete e[o].zcClippingId)}}}return this},P.prototype.elements=function(){var e=a[this.id];return e&&e.elements?e.elements.slice(0):[]};var G=function(e){var t,n,i,o,r,s=[];if(e&&1===e.nodeType&&(t=e.zcClippingId)&&l.hasOwnProperty(t)&&(n=l[t],n&&n.length))for(i=0,o=n.length;o>i;i++)r=a[n[i]].instance,r&&r instanceof P&&s.push(r);return s};L.hoverClass="zeroclipboard-is-hover",L.activeClass="zeroclipboard-is-active",L.trustedOrigins=null,L.allowScriptAccess=null,L.useNoCache=!0,L.moviePath="ZeroClipboard.swf",P.detectFlashSupport=function(){return E("ZeroClipboard.detectFlashSupport",L.debug),M()},P.dispatch=function(e,t){if("string"==typeof e&&e){var i=e.toLowerCase().replace(/^on/,"");if(i)for(var o=n?G(n):R(),r=0,a=o.length;a>r;r++)V.call(o[r],i,t)}},P.prototype.setHandCursor=function(e){return E("ZeroClipboard.prototype.setHandCursor",L.debug),e="boolean"==typeof e?e:!!e,B(e),L.forceHandCursor=e,this},P.prototype.reposition=function(){return E("ZeroClipboard.prototype.reposition",L.debug),Q()},P.prototype.receiveEvent=function(e,t){if(E("ZeroClipboard.prototype.receiveEvent",L.debug),"string"==typeof e&&e){var n=e.toLowerCase().replace(/^on/,"");n&&V.call(this,n,t)}},P.prototype.setCurrent=function(e){return E("ZeroClipboard.prototype.setCurrent",L.debug),P.activate(e),this},P.prototype.resetBridge=function(){return E("ZeroClipboard.prototype.resetBridge",L.debug),P.deactivate(),this},P.prototype.setTitle=function(e){if(E("ZeroClipboard.prototype.setTitle",L.debug),e=e||L.title||n&&n.getAttribute("title")){var t=D(i.bridge);t&&t.setAttribute("title",e)}return this},P.setDefaults=function(e){E("ZeroClipboard.setDefaults",L.debug),P.config(e)},P.prototype.addEventListener=function(e,t){return E("ZeroClipboard.prototype.addEventListener",L.debug),this.on(e,t)},P.prototype.removeEventListener=function(e,t){return E("ZeroClipboard.prototype.removeEventListener",L.debug),this.off(e,t)},P.prototype.ready=function(){return E("ZeroClipboard.prototype.ready",L.debug),i.ready===!0};var V=function(r,a){r=r.toLowerCase().replace(/^on/,"");var s=a&&a.flashVersion&&e(a.flashVersion)||null,l=n,c=!0;
switch(r){case"load":if(s){if(!t(s))return void V.call(this,"onWrongFlash",{flashVersion:s});i.outdated=!1,i.ready=!0,i.version=s}break;case"wrongflash":s&&!t(s)&&(i.outdated=!0,i.ready=!1,i.version=s);break;case"mouseover":v(l,L.hoverClass);break;case"mouseout":L.autoActivate===!0&&P.deactivate();break;case"mousedown":v(l,L.activeClass);break;case"mouseup":y(l,L.activeClass);break;case"datarequested":var d=l.getAttribute("data-clipboard-target"),u=d?document.getElementById(d):null;if(u){var h=u.value||u.textContent||u.innerText;h&&this.setText(h)}else{var p=l.getAttribute("data-clipboard-text");p&&this.setText(p)}c=!1;break;case"complete":O(o)}var f=l,g=[this,a];return H.call(this,r,f,g,c)};"function"==typeof define&&define.amd?define(["require","exports","module"],function(e,t,n){return c=n&&n.id||null,P}):"object"==typeof module&&module&&"object"==typeof module.exports&&module.exports?(d=module.id||null,module.exports=P):window.ZeroClipboard=P}(),function(e,t){"use strict";function n(t){e.fn.cycle.debug&&i(t)}function i(){window.console&&console.log&&console.log("[cycle] "+Array.prototype.join.call(arguments," "))}function o(t,n,i){var o=e(t).data("cycle.opts");if(o){var r=!!t.cyclePause;r&&o.paused?o.paused(t,o,n,i):!r&&o.resumed&&o.resumed(t,o,n,i)}}function r(n,r,a){function l(t,n,o){if(!t&&n===!0){var r=e(o).data("cycle.opts");if(!r)return i("options not found, can not resume"),!1;o.cycleTimeout&&(clearTimeout(o.cycleTimeout),o.cycleTimeout=0),h(r.elements,r,1,!r.backwards)}}if(n.cycleStop===t&&(n.cycleStop=0),(r===t||null===r)&&(r={}),r.constructor==String){switch(r){case"destroy":case"stop":var c=e(n).data("cycle.opts");return c?(n.cycleStop++,n.cycleTimeout&&clearTimeout(n.cycleTimeout),n.cycleTimeout=0,c.elements&&e(c.elements).stop(),e(n).removeData("cycle.opts"),"destroy"==r&&s(n,c),!1):!1;case"toggle":return n.cyclePause=1===n.cyclePause?0:1,l(n.cyclePause,a,n),o(n),!1;case"pause":return n.cyclePause=1,o(n),!1;case"resume":return n.cyclePause=0,l(!1,a,n),o(n),!1;case"prev":case"next":return(c=e(n).data("cycle.opts"))?("string"==typeof a&&(c.oneTimeFx=a),e.fn.cycle[r](c),!1):(i('options not found, "prev/next" ignored'),!1);default:r={fx:r}}return r}if(r.constructor==Number){var d=r;return(r=e(n).data("cycle.opts"))?0>d||d>=r.elements.length?(i("invalid slide index: "+d),!1):(r.nextSlide=d,n.cycleTimeout&&(clearTimeout(n.cycleTimeout),n.cycleTimeout=0),"string"==typeof a&&(r.oneTimeFx=a),h(r.elements,r,1,d>=r.currSlide),!1):(i("options not found, can not advance slide"),!1)}return r}function a(t,n){if(!e.support.opacity&&n.cleartype&&t.style.filter)try{t.style.removeAttribute("filter")}catch(i){}}function s(t,n){n.next&&e(n.next).unbind(n.prevNextEvent),n.prev&&e(n.prev).unbind(n.prevNextEvent),(n.pager||n.pagerAnchorBuilder)&&e.each(n.pagerAnchors||[],function(){this.unbind().remove()}),n.pagerAnchors=null,e(t).unbind("mouseenter.cycle mouseleave.cycle"),n.destroy&&n.destroy(n)}function l(n,r,s,l,p){var v,y=e.extend({},e.fn.cycle.defaults,l||{},e.metadata?n.metadata():e.meta?n.data():{}),w=e.isFunction(n.data)?n.data(y.metaAttr):null;w&&(y=e.extend(y,w)),y.autostop&&(y.countdown=y.autostopCount||s.length);var b=n[0];if(n.data("cycle.opts",y),y.$cont=n,y.stopCount=b.cycleStop,y.elements=s,y.before=y.before?[y.before]:[],y.after=y.after?[y.after]:[],!e.support.opacity&&y.cleartype&&y.after.push(function(){a(this,y)}),y.continuous&&y.after.push(function(){h(s,y,0,!y.backwards)}),c(y),e.support.opacity||!y.cleartype||y.cleartypeNoBg||m(r),"static"==n.css("position")&&n.css("position","relative"),y.width&&n.width(y.width),y.height&&"auto"!=y.height&&n.height(y.height),y.startingSlide!==t?(y.startingSlide=parseInt(y.startingSlide,10),y.startingSlide>=s.length||y.startSlide<0?y.startingSlide=0:v=!0):y.backwards?y.startingSlide=s.length-1:y.startingSlide=0,y.random){y.randomMap=[];for(var C=0;C<s.length;C++)y.randomMap.push(C);if(y.randomMap.sort(function(e,t){return Math.random()-.5}),v)for(var k=0;k<s.length;k++)y.startingSlide==y.randomMap[k]&&(y.randomIndex=k);else y.randomIndex=1,y.startingSlide=y.randomMap[1]}else y.startingSlide>=s.length&&(y.startingSlide=0);y.currSlide=y.startingSlide||0;var F=y.startingSlide;r.css({position:"absolute",top:0,left:0}).hide().each(function(t){var n;n=y.backwards?F?F>=t?s.length+(t-F):F-t:s.length-t:F?t>=F?s.length-(t-F):F-t:s.length-t,e(this).css("z-index",n)}),e(s[F]).css("opacity",1).show(),a(s[F],y),y.fit&&(y.aspect?r.each(function(){var t=e(this),n=y.aspect===!0?t.width()/t.height():y.aspect;y.width&&t.width()!=y.width&&(t.width(y.width),t.height(y.width/n)),y.height&&t.height()<y.height&&(t.height(y.height),t.width(y.height*n))}):(y.width&&r.width(y.width),y.height&&"auto"!=y.height&&r.height(y.height))),!y.center||y.fit&&!y.aspect||r.each(function(){var t=e(this);t.css({"margin-left":y.width?(y.width-t.width())/2+"px":0,"margin-top":y.height?(y.height-t.height())/2+"px":0})}),!y.center||y.fit||y.slideResize||r.each(function(){var t=e(this);t.css({"margin-left":y.width?(y.width-t.width())/2+"px":0,"margin-top":y.height?(y.height-t.height())/2+"px":0})});var x=(y.containerResize||y.containerResizeHeight)&&n.innerHeight()<1;if(x){for(var T=0,_=0,E=0;E<s.length;E++){var S=e(s[E]),j=S[0],I=S.outerWidth(),A=S.outerHeight();I||(I=j.offsetWidth||j.width||S.attr("width")),A||(A=j.offsetHeight||j.height||S.attr("height")),T=I>T?I:T,_=A>_?A:_}y.containerResize&&T>0&&_>0&&n.css({width:T+"px",height:_+"px"}),y.containerResizeHeight&&_>0&&n.css({height:_+"px"})}var O=!1;if(y.pause&&n.bind("mouseenter.cycle",function(){O=!0,this.cyclePause++,o(b,!0)}).bind("mouseleave.cycle",function(){O&&this.cyclePause--,o(b,!0)}),d(y)===!1)return!1;var M=!1;if(l.requeueAttempts=l.requeueAttempts||0,r.each(function(){var t=e(this);if(this.cycleH=y.fit&&y.height?y.height:t.height()||this.offsetHeight||this.height||t.attr("height")||0,this.cycleW=y.fit&&y.width?y.width:t.width()||this.offsetWidth||this.width||t.attr("width")||0,t.is("img")){var n=0===this.cycleH&&0===this.cycleW&&!this.complete;if(n){if(p.s&&y.requeueOnImageNotLoaded&&++l.requeueAttempts<100)return i(l.requeueAttempts," - img slide not loaded, requeuing slideshow: ",this.src,this.cycleW,this.cycleH),setTimeout(function(){e(p.s,p.c).cycle(l)},y.requeueTimeout),M=!0,!1;i("could not determine size of image: "+this.src,this.cycleW,this.cycleH)}}return!0}),M)return!1;if(y.cssBefore=y.cssBefore||{},y.cssAfter=y.cssAfter||{},y.cssFirst=y.cssFirst||{},y.animIn=y.animIn||{},y.animOut=y.animOut||{},r.not(":eq("+F+")").css(y.cssBefore),e(r[F]).css(y.cssFirst),y.timeout){y.timeout=parseInt(y.timeout,10),y.speed.constructor==String&&(y.speed=e.fx.speeds[y.speed]||parseInt(y.speed,10)),y.sync||(y.speed=y.speed/2);for(var P="none"==y.fx?0:"shuffle"==y.fx?500:250;y.timeout-y.speed<P;)y.timeout+=y.speed}if(y.easing&&(y.easeIn=y.easeOut=y.easing),y.speedIn||(y.speedIn=y.speed),y.speedOut||(y.speedOut=y.speed),y.slideCount=s.length,y.currSlide=y.lastSlide=F,y.random?(++y.randomIndex==s.length&&(y.randomIndex=0),y.nextSlide=y.randomMap[y.randomIndex]):y.backwards?y.nextSlide=0===y.startingSlide?s.length-1:y.startingSlide-1:y.nextSlide=y.startingSlide>=s.length-1?0:y.startingSlide+1,!y.multiFx){var B=e.fn.cycle.transitions[y.fx];if(e.isFunction(B))B(n,r,y);else if("custom"!=y.fx&&!y.multiFx)return i("unknown transition: "+y.fx,"; slideshow terminating"),!1}var R=r[F];return y.skipInitializationCallbacks||(y.before.length&&y.before[0].apply(R,[R,R,y,!0]),y.after.length&&y.after[0].apply(R,[R,R,y,!0])),y.next&&e(y.next).bind(y.prevNextEvent,function(){return f(y,1)}),y.prev&&e(y.prev).bind(y.prevNextEvent,function(){return f(y,0)}),(y.pager||y.pagerAnchorBuilder)&&g(s,y),u(y,s),y}function c(t){t.original={before:[],after:[]},t.original.cssBefore=e.extend({},t.cssBefore),t.original.cssAfter=e.extend({},t.cssAfter),t.original.animIn=e.extend({},t.animIn),t.original.animOut=e.extend({},t.animOut),e.each(t.before,function(){t.original.before.push(this)}),e.each(t.after,function(){t.original.after.push(this)})}function d(t){var o,r,a=e.fn.cycle.transitions;if(t.fx.indexOf(",")>0){for(t.multiFx=!0,t.fxs=t.fx.replace(/\s*/g,"").split(","),o=0;o<t.fxs.length;o++){var s=t.fxs[o];r=a[s],r&&a.hasOwnProperty(s)&&e.isFunction(r)||(i("discarding unknown transition: ",s),t.fxs.splice(o,1),o--)}if(!t.fxs.length)return i("No valid transitions named; slideshow terminating."),!1}else if("all"==t.fx){t.multiFx=!0,t.fxs=[];for(var l in a)a.hasOwnProperty(l)&&(r=a[l],a.hasOwnProperty(l)&&e.isFunction(r)&&t.fxs.push(l))}if(t.multiFx&&t.randomizeEffects){var c=Math.floor(20*Math.random())+30;for(o=0;c>o;o++){var d=Math.floor(Math.random()*t.fxs.length);t.fxs.push(t.fxs.splice(d,1)[0])}n("randomized fx sequence: ",t.fxs)}return!0}function u(t,n){t.addSlide=function(i,o){var r=e(i),a=r[0];t.autostopCount||t.countdown++,n[o?"unshift":"push"](a),t.els&&t.els[o?"unshift":"push"](a),t.slideCount=n.length,t.random&&(t.randomMap.push(t.slideCount-1),t.randomMap.sort(function(e,t){return Math.random()-.5})),r.css("position","absolute"),r[o?"prependTo":"appendTo"](t.$cont),o&&(t.currSlide++,t.nextSlide++),e.support.opacity||!t.cleartype||t.cleartypeNoBg||m(r),t.fit&&t.width&&r.width(t.width),t.fit&&t.height&&"auto"!=t.height&&r.height(t.height),a.cycleH=t.fit&&t.height?t.height:r.height(),a.cycleW=t.fit&&t.width?t.width:r.width(),r.css(t.cssBefore),(t.pager||t.pagerAnchorBuilder)&&e.fn.cycle.createPagerAnchor(n.length-1,a,e(t.pager),n,t),e.isFunction(t.onAddSlide)?t.onAddSlide(r):r.hide()}}function h(i,o,r,a){function s(){var e=0;o.timeout;o.timeout&&!o.continuous?(e=p(i[o.currSlide],i[o.nextSlide],o,a),"shuffle"==o.fx&&(e-=o.speedOut)):o.continuous&&l.cyclePause&&(e=10),e>0&&(l.cycleTimeout=setTimeout(function(){h(i,o,0,!o.backwards)},e))}var l=o.$cont[0],c=i[o.currSlide],d=i[o.nextSlide];if(r&&o.busy&&o.manualTrump&&(n("manualTrump in go(), stopping active transition"),e(i).stop(!0,!0),o.busy=0,clearTimeout(l.cycleTimeout)),o.busy)return void n("transition active, ignoring new tx request");if(l.cycleStop==o.stopCount&&(0!==l.cycleTimeout||r)){if(!r&&!l.cyclePause&&!o.bounce&&(o.autostop&&--o.countdown<=0||o.nowrap&&!o.random&&o.nextSlide<o.currSlide))return void(o.end&&o.end(o));var u=!1;if(!r&&l.cyclePause||o.nextSlide==o.currSlide)s();else{u=!0;var f=o.fx;c.cycleH=c.cycleH||e(c).height(),c.cycleW=c.cycleW||e(c).width(),d.cycleH=d.cycleH||e(d).height(),d.cycleW=d.cycleW||e(d).width(),o.multiFx&&(a&&(o.lastFx===t||++o.lastFx>=o.fxs.length)?o.lastFx=0:!a&&(o.lastFx===t||--o.lastFx<0)&&(o.lastFx=o.fxs.length-1),f=o.fxs[o.lastFx]),o.oneTimeFx&&(f=o.oneTimeFx,o.oneTimeFx=null),e.fn.cycle.resetState(o,f),o.before.length&&e.each(o.before,function(e,t){l.cycleStop==o.stopCount&&t.apply(d,[c,d,o,a])});var g=function(){o.busy=0,e.each(o.after,function(e,t){l.cycleStop==o.stopCount&&t.apply(d,[c,d,o,a])}),l.cycleStop||s()};n("tx firing("+f+"); currSlide: "+o.currSlide+"; nextSlide: "+o.nextSlide),o.busy=1,o.fxFn?o.fxFn(c,d,o,g,a,r&&o.fastOnEvent):e.isFunction(e.fn.cycle[o.fx])?e.fn.cycle[o.fx](c,d,o,g,a,r&&o.fastOnEvent):e.fn.cycle.custom(c,d,o,g,a,r&&o.fastOnEvent)}if(u||o.nextSlide==o.currSlide){var m;o.lastSlide=o.currSlide,o.random?(o.currSlide=o.nextSlide,++o.randomIndex==i.length&&(o.randomIndex=0,o.randomMap.sort(function(e,t){return Math.random()-.5})),o.nextSlide=o.randomMap[o.randomIndex],o.nextSlide==o.currSlide&&(o.nextSlide=o.currSlide==o.slideCount-1?0:o.currSlide+1)):o.backwards?(m=o.nextSlide-1<0,m&&o.bounce?(o.backwards=!o.backwards,o.nextSlide=1,o.currSlide=0):(o.nextSlide=m?i.length-1:o.nextSlide-1,o.currSlide=m?0:o.nextSlide+1)):(m=o.nextSlide+1==i.length,m&&o.bounce?(o.backwards=!o.backwards,o.nextSlide=i.length-2,o.currSlide=i.length-1):(o.nextSlide=m?0:o.nextSlide+1,o.currSlide=m?i.length-1:o.nextSlide-1))}u&&o.pager&&o.updateActivePagerLink(o.pager,o.currSlide,o.activePagerClass)}}function p(e,t,i,o){if(i.timeoutFn){for(var r=i.timeoutFn.call(e,e,t,i,o);"none"!=i.fx&&r-i.speed<250;)r+=i.speed;if(n("calculated timeout: "+r+"; speed: "+i.speed),r!==!1)return r}return i.timeout}function f(t,n){var i=n?1:-1,o=t.elements,r=t.$cont[0],a=r.cycleTimeout;if(a&&(clearTimeout(a),r.cycleTimeout=0),t.random&&0>i)t.randomIndex--,-2==--t.randomIndex?t.randomIndex=o.length-2:-1==t.randomIndex&&(t.randomIndex=o.length-1),t.nextSlide=t.randomMap[t.randomIndex];else if(t.random)t.nextSlide=t.randomMap[t.randomIndex];else if(t.nextSlide=t.currSlide+i,t.nextSlide<0){if(t.nowrap)return!1;t.nextSlide=o.length-1}else if(t.nextSlide>=o.length){if(t.nowrap)return!1;t.nextSlide=0}var s=t.onPrevNextEvent||t.prevNextClick;return e.isFunction(s)&&s(i>0,t.nextSlide,o[t.nextSlide]),h(o,t,1,n),!1}function g(t,n){var i=e(n.pager);e.each(t,function(o,r){e.fn.cycle.createPagerAnchor(o,r,i,t,n)}),n.updateActivePagerLink(n.pager,n.startingSlide,n.activePagerClass)}function m(t){function i(e){return e=parseInt(e,10).toString(16),e.length<2?"0"+e:e}function o(t){for(;t&&"html"!=t.nodeName.toLowerCase();t=t.parentNode){var n=e.css(t,"background-color");if(n&&n.indexOf("rgb")>=0){var o=n.match(/\d+/g);return"#"+i(o[0])+i(o[1])+i(o[2])}if(n&&"transparent"!=n)return n}return"#ffffff"}n("applying clearType background-color hack"),t.each(function(){e(this).css("background-color",o(this))})}var v="3.0.2";e.expr[":"].paused=function(e){return e.cyclePause},e.fn.cycle=function(t,o){var a={s:this.selector,c:this.context};return 0===this.length&&"stop"!=t?!e.isReady&&a.s?(i("DOM not ready, queuing slideshow"),e(function(){e(a.s,a.c).cycle(t,o)}),this):(i("terminating; zero elements found by selector"+(e.isReady?"":" (DOM not ready)")),this):this.each(function(){var s=r(this,t,o);if(s!==!1){s.updateActivePagerLink=s.updateActivePagerLink||e.fn.cycle.updateActivePagerLink,this.cycleTimeout&&clearTimeout(this.cycleTimeout),this.cycleTimeout=this.cyclePause=0,this.cycleStop=0;var c=e(this),d=s.slideExpr?e(s.slideExpr,this):c.children(),u=d.get();if(u.length<2)return void i("terminating; too few slides: "+u.length);var f=l(c,d,u,s,a);if(f!==!1){var g=f.continuous?10:p(u[f.currSlide],u[f.nextSlide],f,!f.backwards);g&&(g+=f.delay||0,10>g&&(g=10),n("first timeout: "+g),this.cycleTimeout=setTimeout(function(){h(u,f,0,!s.backwards)},g))}}})},e.fn.cycle.resetState=function(t,n){n=n||t.fx,t.before=[],t.after=[],t.cssBefore=e.extend({},t.original.cssBefore),t.cssAfter=e.extend({},t.original.cssAfter),t.animIn=e.extend({},t.original.animIn),t.animOut=e.extend({},t.original.animOut),t.fxFn=null,e.each(t.original.before,function(){t.before.push(this)}),e.each(t.original.after,function(){t.after.push(this)});var i=e.fn.cycle.transitions[n];e.isFunction(i)&&i(t.$cont,e(t.elements),t)},e.fn.cycle.updateActivePagerLink=function(t,n,i){e(t).each(function(){e(this).children().removeClass(i).eq(n).addClass(i)})},e.fn.cycle.next=function(e){f(e,1)},e.fn.cycle.prev=function(e){f(e,0)},e.fn.cycle.createPagerAnchor=function(t,i,r,a,s){var l;if(e.isFunction(s.pagerAnchorBuilder)?(l=s.pagerAnchorBuilder(t,i),n("pagerAnchorBuilder("+t+", el) returned: "+l)):l='<a href="#">'+(t+1)+"</a>",l){var c=e(l);if(0===c.parents("body").length){var d=[];r.length>1?(r.each(function(){var t=c.clone(!0);e(this).append(t),d.push(t[0])}),c=e(d)):c.appendTo(r)}s.pagerAnchors=s.pagerAnchors||[],s.pagerAnchors.push(c);var u=function(n){n.preventDefault(),s.nextSlide=t;var i=s.$cont[0],o=i.cycleTimeout;o&&(clearTimeout(o),i.cycleTimeout=0);var r=s.onPagerEvent||s.pagerClick;e.isFunction(r)&&r(s.nextSlide,a[s.nextSlide])===!1||h(a,s,1,s.currSlide<t)};/mouseenter|mouseover/i.test(s.pagerEvent)?c.hover(u,function(){}):c.bind(s.pagerEvent,u),/^click/.test(s.pagerEvent)||s.allowPagerClickBubble||c.bind("click.cycle",function(){return!1});var p=s.$cont[0],f=!1;s.pauseOnPagerHover&&c.hover(function(){f=!0,p.cyclePause++,o(p,!0,!0)},function(){f&&p.cyclePause--,o(p,!0,!0)})}},e.fn.cycle.hopsFromLast=function(e,t){var n,i=e.lastSlide,o=e.currSlide;return n=t?o>i?o-i:e.slideCount-i:i>o?i-o:i+e.slideCount-o},e.fn.cycle.commonReset=function(t,n,i,o,r,a){e(i.elements).not(t).hide(),"undefined"==typeof i.cssBefore.opacity&&(i.cssBefore.opacity=1),i.cssBefore.display="block",i.slideResize&&o!==!1&&n.cycleW>0&&(i.cssBefore.width=n.cycleW),i.slideResize&&r!==!1&&n.cycleH>0&&(i.cssBefore.height=n.cycleH),i.cssAfter=i.cssAfter||{},i.cssAfter.display="none",e(t).css("zIndex",i.slideCount+(a===!0?1:0)),e(n).css("zIndex",i.slideCount+(a===!0?0:1))},e.fn.cycle.custom=function(t,n,i,o,r,a){var s=e(t),l=e(n),c=i.speedIn,d=i.speedOut,u=i.easeIn,h=i.easeOut;l.css(i.cssBefore),a&&(c=d="number"==typeof a?a:1,u=h=null);var p=function(){l.animate(i.animIn,c,u,function(){o()})};s.animate(i.animOut,d,h,function(){s.css(i.cssAfter),i.sync||p()}),i.sync&&p()},e.fn.cycle.transitions={fade:function(t,n,i){n.not(":eq("+i.currSlide+")").css("opacity",0),i.before.push(function(t,n,i){e.fn.cycle.commonReset(t,n,i),i.cssBefore.opacity=0}),i.animIn={opacity:1},i.animOut={opacity:0},i.cssBefore={top:0,left:0}}},e.fn.cycle.ver=function(){return v},e.fn.cycle.defaults={activePagerClass:"activeSlide",after:null,allowPagerClickBubble:!1,animIn:null,animOut:null,aspect:!1,autostop:0,autostopCount:0,backwards:!1,before:null,center:null,cleartype:!e.support.opacity,cleartypeNoBg:!1,containerResize:1,containerResizeHeight:0,continuous:0,cssAfter:null,cssBefore:null,delay:0,easeIn:null,easeOut:null,easing:null,end:null,fastOnEvent:0,fit:0,fx:"fade",fxFn:null,height:"auto",manualTrump:!0,metaAttr:"cycle",next:null,nowrap:0,onPagerEvent:null,onPrevNextEvent:null,pager:null,pagerAnchorBuilder:null,pagerEvent:"click.cycle",pause:0,pauseOnPagerHover:0,prev:null,prevNextEvent:"click.cycle",random:0,randomizeEffects:1,requeueOnImageNotLoaded:!0,requeueTimeout:250,rev:0,shuffle:null,skipInitializationCallbacks:!1,slideExpr:null,slideResize:1,speed:1e3,speedIn:null,speedOut:null,startingSlide:t,sync:1,timeout:4e3,timeoutFn:null,updateActivePagerLink:null,width:null}}(jQuery),function(e){"use strict";e.fn.cycle.transitions.none=function(t,n,i){i.fxFn=function(t,n,i,o){e(n).show(),e(t).hide(),o()}},e.fn.cycle.transitions.fadeout=function(t,n,i){n.not(":eq("+i.currSlide+")").css({display:"block",opacity:1}),i.before.push(function(t,n,i,o,r,a){e(t).css("zIndex",i.slideCount+(a!==!0?1:0)),e(n).css("zIndex",i.slideCount+(a!==!0?0:1))}),i.animIn.opacity=1,i.animOut.opacity=0,i.cssBefore.opacity=1,i.cssBefore.display="block",i.cssAfter.zIndex=0},e.fn.cycle.transitions.scrollUp=function(t,n,i){t.css("overflow","hidden"),i.before.push(e.fn.cycle.commonReset);var o=t.height();i.cssBefore.top=o,i.cssBefore.left=0,i.cssFirst.top=0,i.animIn.top=0,i.animOut.top=-o},e.fn.cycle.transitions.scrollDown=function(t,n,i){t.css("overflow","hidden"),i.before.push(e.fn.cycle.commonReset);var o=t.height();i.cssFirst.top=0,i.cssBefore.top=-o,i.cssBefore.left=0,i.animIn.top=0,i.animOut.top=o},e.fn.cycle.transitions.scrollLeft=function(t,n,i){t.css("overflow","hidden"),i.before.push(e.fn.cycle.commonReset);var o=t.width();i.cssFirst.left=0,i.cssBefore.left=o,i.cssBefore.top=0,i.animIn.left=0,i.animOut.left=0-o},e.fn.cycle.transitions.scrollRight=function(t,n,i){t.css("overflow","hidden"),i.before.push(e.fn.cycle.commonReset);var o=t.width();i.cssFirst.left=0,i.cssBefore.left=-o,i.cssBefore.top=0,i.animIn.left=0,i.animOut.left=o},e.fn.cycle.transitions.scrollHorz=function(t,n,i){t.css("overflow","hidden").width(),i.before.push(function(t,n,i,o){i.rev&&(o=!o),e.fn.cycle.commonReset(t,n,i),i.cssBefore.left=o?n.cycleW-1:1-n.cycleW,i.animOut.left=o?-t.cycleW:t.cycleW}),i.cssFirst.left=0,i.cssBefore.top=0,i.animIn.left=0,i.animOut.top=0},e.fn.cycle.transitions.scrollVert=function(t,n,i){t.css("overflow","hidden"),i.before.push(function(t,n,i,o){i.rev&&(o=!o),e.fn.cycle.commonReset(t,n,i),i.cssBefore.top=o?1-n.cycleH:n.cycleH-1,i.animOut.top=o?t.cycleH:-t.cycleH}),i.cssFirst.top=0,i.cssBefore.left=0,i.animIn.top=0,i.animOut.left=0},e.fn.cycle.transitions.slideX=function(t,n,i){i.before.push(function(t,n,i){e(i.elements).not(t).hide(),e.fn.cycle.commonReset(t,n,i,!1,!0),i.animIn.width=n.cycleW}),i.cssBefore.left=0,i.cssBefore.top=0,i.cssBefore.width=0,i.animIn.width="show",i.animOut.width=0},e.fn.cycle.transitions.slideY=function(t,n,i){i.before.push(function(t,n,i){e(i.elements).not(t).hide(),e.fn.cycle.commonReset(t,n,i,!0,!1),i.animIn.height=n.cycleH}),i.cssBefore.left=0,i.cssBefore.top=0,i.cssBefore.height=0,i.animIn.height="show",i.animOut.height=0},e.fn.cycle.transitions.shuffle=function(t,n,i){var o,r=t.css("overflow","visible").width();for(n.css({left:0,top:0}),i.before.push(function(t,n,i){e.fn.cycle.commonReset(t,n,i,!0,!0,!0)}),i.speedAdjusted||(i.speed=i.speed/2,i.speedAdjusted=!0),i.random=0,i.shuffle=i.shuffle||{left:-r,top:15},i.els=[],o=0;o<n.length;o++)i.els.push(n[o]);for(o=0;o<i.currSlide;o++)i.els.push(i.els.shift());i.fxFn=function(t,n,i,o,r){i.rev&&(r=!r);var a=e(r?t:n);e(n).css(i.cssBefore);var s=i.slideCount;a.animate(i.shuffle,i.speedIn,i.easeIn,function(){for(var n=e.fn.cycle.hopsFromLast(i,r),l=0;n>l;l++)r?i.els.push(i.els.shift()):i.els.unshift(i.els.pop());if(r)for(var c=0,d=i.els.length;d>c;c++)e(i.els[c]).css("z-index",d-c+s);else{var u=e(t).css("z-index");a.css("z-index",parseInt(u,10)+1+s)}a.animate({left:0,top:0},i.speedOut,i.easeOut,function(){e(r?this:t).hide(),o&&o()})})},e.extend(i.cssBefore,{display:"block",opacity:1,top:0,left:0})},e.fn.cycle.transitions.turnUp=function(t,n,i){i.before.push(function(t,n,i){e.fn.cycle.commonReset(t,n,i,!0,!1),i.cssBefore.top=n.cycleH,i.animIn.height=n.cycleH,i.animOut.width=n.cycleW}),i.cssFirst.top=0,i.cssBefore.left=0,i.cssBefore.height=0,i.animIn.top=0,i.animOut.height=0},e.fn.cycle.transitions.turnDown=function(t,n,i){i.before.push(function(t,n,i){e.fn.cycle.commonReset(t,n,i,!0,!1),i.animIn.height=n.cycleH,i.animOut.top=t.cycleH}),i.cssFirst.top=0,i.cssBefore.left=0,i.cssBefore.top=0,i.cssBefore.height=0,i.animOut.height=0},e.fn.cycle.transitions.turnLeft=function(t,n,i){i.before.push(function(t,n,i){e.fn.cycle.commonReset(t,n,i,!1,!0),i.cssBefore.left=n.cycleW,i.animIn.width=n.cycleW}),i.cssBefore.top=0,i.cssBefore.width=0,i.animIn.left=0,i.animOut.width=0},e.fn.cycle.transitions.turnRight=function(t,n,i){i.before.push(function(t,n,i){e.fn.cycle.commonReset(t,n,i,!1,!0),i.animIn.width=n.cycleW,i.animOut.left=t.cycleW}),e.extend(i.cssBefore,{top:0,left:0,width:0}),i.animIn.left=0,i.animOut.width=0},e.fn.cycle.transitions.zoom=function(t,n,i){i.before.push(function(t,n,i){e.fn.cycle.commonReset(t,n,i,!1,!1,!0),i.cssBefore.top=n.cycleH/2,i.cssBefore.left=n.cycleW/2,e.extend(i.animIn,{top:0,left:0,width:n.cycleW,height:n.cycleH}),e.extend(i.animOut,{width:0,height:0,top:t.cycleH/2,left:t.cycleW/2})}),i.cssFirst.top=0,i.cssFirst.left=0,i.cssBefore.width=0,i.cssBefore.height=0},e.fn.cycle.transitions.fadeZoom=function(t,n,i){i.before.push(function(t,n,i){e.fn.cycle.commonReset(t,n,i,!1,!1),i.cssBefore.left=n.cycleW/2,i.cssBefore.top=n.cycleH/2,e.extend(i.animIn,{top:0,left:0,width:n.cycleW,height:n.cycleH})}),i.cssBefore.width=0,i.cssBefore.height=0,i.animOut.opacity=0},e.fn.cycle.transitions.blindX=function(t,n,i){var o=t.css("overflow","hidden").width();i.before.push(function(t,n,i){e.fn.cycle.commonReset(t,n,i),i.animIn.width=n.cycleW,i.animOut.left=t.cycleW}),i.cssBefore.left=o,i.cssBefore.top=0,i.animIn.left=0,i.animOut.left=o},e.fn.cycle.transitions.blindY=function(t,n,i){var o=t.css("overflow","hidden").height();i.before.push(function(t,n,i){e.fn.cycle.commonReset(t,n,i),i.animIn.height=n.cycleH,i.animOut.top=t.cycleH}),i.cssBefore.top=o,i.cssBefore.left=0,i.animIn.top=0,i.animOut.top=o},e.fn.cycle.transitions.blindZ=function(t,n,i){var o=t.css("overflow","hidden").height(),r=t.width();i.before.push(function(t,n,i){e.fn.cycle.commonReset(t,n,i),i.animIn.height=n.cycleH,i.animOut.top=t.cycleH}),i.cssBefore.top=o,i.cssBefore.left=r,i.animIn.top=0,i.animIn.left=0,i.animOut.top=o,i.animOut.left=r},e.fn.cycle.transitions.growX=function(t,n,i){i.before.push(function(t,n,i){e.fn.cycle.commonReset(t,n,i,!1,!0),i.cssBefore.left=this.cycleW/2,i.animIn.left=0,i.animIn.width=this.cycleW,i.animOut.left=0}),i.cssBefore.top=0,i.cssBefore.width=0},e.fn.cycle.transitions.growY=function(t,n,i){i.before.push(function(t,n,i){e.fn.cycle.commonReset(t,n,i,!0,!1),i.cssBefore.top=this.cycleH/2,i.animIn.top=0,i.animIn.height=this.cycleH,i.animOut.top=0}),i.cssBefore.height=0,i.cssBefore.left=0},e.fn.cycle.transitions.curtainX=function(t,n,i){i.before.push(function(t,n,i){e.fn.cycle.commonReset(t,n,i,!1,!0,!0),i.cssBefore.left=n.cycleW/2,i.animIn.left=0,i.animIn.width=this.cycleW,i.animOut.left=t.cycleW/2,i.animOut.width=0}),i.cssBefore.top=0,i.cssBefore.width=0},e.fn.cycle.transitions.curtainY=function(t,n,i){i.before.push(function(t,n,i){e.fn.cycle.commonReset(t,n,i,!0,!1,!0),i.cssBefore.top=n.cycleH/2,i.animIn.top=0,i.animIn.height=n.cycleH,i.animOut.top=t.cycleH/2,i.animOut.height=0}),i.cssBefore.height=0,i.cssBefore.left=0},e.fn.cycle.transitions.cover=function(t,n,i){var o=i.direction||"left",r=t.css("overflow","hidden").width(),a=t.height();i.before.push(function(t,n,i){e.fn.cycle.commonReset(t,n,i),i.cssAfter.display="","right"==o?i.cssBefore.left=-r:"up"==o?i.cssBefore.top=a:"down"==o?i.cssBefore.top=-a:i.cssBefore.left=r}),i.animIn.left=0,i.animIn.top=0,i.cssBefore.top=0,i.cssBefore.left=0},e.fn.cycle.transitions.uncover=function(t,n,i){var o=i.direction||"left",r=t.css("overflow","hidden").width(),a=t.height();i.before.push(function(t,n,i){e.fn.cycle.commonReset(t,n,i,!0,!0,!0),"right"==o?i.animOut.left=r:"up"==o?i.animOut.top=-a:"down"==o?i.animOut.top=a:i.animOut.left=-r}),i.animIn.left=0,i.animIn.top=0,i.cssBefore.top=0,i.cssBefore.left=0},e.fn.cycle.transitions.toss=function(t,n,i){var o=t.css("overflow","visible").width(),r=t.height();i.before.push(function(t,n,i){e.fn.cycle.commonReset(t,n,i,!0,!0,!0),i.animOut.left||i.animOut.top?i.animOut.opacity=0:e.extend(i.animOut,{left:2*o,top:-r/2,opacity:0})}),i.cssBefore.left=0,i.cssBefore.top=0,i.animIn.left=0},e.fn.cycle.transitions.wipe=function(t,n,i){var o=t.css("overflow","hidden").width(),r=t.height();i.cssBefore=i.cssBefore||{};var a;if(i.clip)if(/l2r/.test(i.clip))a="rect(0px 0px "+r+"px 0px)";else if(/r2l/.test(i.clip))a="rect(0px "+o+"px "+r+"px "+o+"px)";else if(/t2b/.test(i.clip))a="rect(0px "+o+"px 0px 0px)";else if(/b2t/.test(i.clip))a="rect("+r+"px "+o+"px "+r+"px 0px)";else if(/zoom/.test(i.clip)){var s=parseInt(r/2,10),l=parseInt(o/2,10);a="rect("+s+"px "+l+"px "+s+"px "+l+"px)"}i.cssBefore.clip=i.cssBefore.clip||a||"rect(0px 0px 0px 0px)";var c=i.cssBefore.clip.match(/(\d+)/g),d=parseInt(c[0],10),u=parseInt(c[1],10),h=parseInt(c[2],10),p=parseInt(c[3],10);i.before.push(function(t,n,i){if(t!=n){var a=e(t),s=e(n);e.fn.cycle.commonReset(t,n,i,!0,!0,!1),i.cssAfter.display="block";var l=1,c=parseInt(i.speedIn/13,10)-1;!function f(){var e=d?d-parseInt(l*(d/c),10):0,t=p?p-parseInt(l*(p/c),10):0,n=r>h?h+parseInt(l*((r-h)/c||1),10):r,i=o>u?u+parseInt(l*((o-u)/c||1),10):o;s.css({clip:"rect("+e+"px "+i+"px "+n+"px "+t+"px)"}),l++<=c?setTimeout(f,13):a.css("display","none")}()}}),e.extend(i.cssBefore,{display:"block",opacity:1,top:0,left:0}),i.animIn={left:0},i.animOut={left:0}}}(jQuery),function(){jQuery.domCss=function(e){var t=document.createElement("style");t.appendChild(document.createTextNode("")),document.head.appendChild(t),t.sheet.insertRule(e,0)}}(),jQuery.fn.eventConditionSelector=function(){function e(e){function t(){n.reloadSelector()}var n=this,i=jQuery('link[rel="js-load-condition-selector"]').attr("href"),o=jQuery(e),r=o.find(".eventConditionUI"),a=o.find(".eventConditionSourceItems input.ecs_achievement_event_id"),s=o.find(".eventConditionSourceItems input.ecs_external_item_id"),l=o.find(".eventConditionSourceItems input.ecs_value_id"),c=null,d=null;return n.reloadSelector=function(){jQuery.ajax({url:i,data:{achievement_event_id:a.val(),external_item_id:s.val(),value_id:l.val(),event_group_id:r.find("select[name=event_group]").val()},dataType:"json",success:function(e){e&&0===e.status&&e.data&&(r.html(e.data.html),r.find("select").selectBox(),r.find("select[name=event_group]").on("change",function(){a.val(""),n.showLoader(jQuery(this)),n.reloadSelector()}),r.find("select[name=achievement_event]").on("change",function(){a.val(this.value),n.showLoader(jQuery(this)),n.reloadSelector()}),r.find("select[name=external_item]").on("change",function(){s.val(this.value)}),r.find("select[name=value]").on("change",function(){l.val(this.value)}),s.val(r.find("select[name=external_item]").val()),l.val(r.find("select[name=value]").val()))},error:function(e,t,i){n.hideLoader(),n.showError(window.t("Failed to update selector"))}})},n.showError=function(e){n.hideError(),d=jQuery('<div class="errorSummary">').html(e),r.prepend(d),setTimeout(function(){n.hideError()},5e3)},n.hideError=function(){d&&(d.remove(),d=null)},n.showLoader=function(e){n.hideLoader(),c=jQuery((new Handler.Template).render("commonLoader")),e.parent().append(c)},n.hideLoader=function(){c&&(c.remove(),c=null)},t(),n}return this.each(function(){return jQuery(this).data("conditionSelector")||jQuery(this).data("conditionSelector",new e(this)),this})},function(e){function t(e,t){for(var n=e,i=0;e=e[t];)n.tagName==e.tagName&&i++;return i}function n(e,n,i){var o,r=t(e,i);if("odd"==n||"even"==n)o=2,r-=!("odd"==n);else{var a=n.indexOf("n");a>-1?(o=parseInt(n,10)||parseInt(n.substring(0,a)+"1",10),r-=(parseInt(n.substring(a+1),10)||0)-1):(o=r+1,r-=parseInt(n,10)-1)}return(0>o?0>=r:r>=0)&&r%o==0}var i={"first-of-type":function(e){return 0==t(e,"previousSibling")},"last-of-type":function(e){return 0==t(e,"nextSibling")},"only-of-type":function(e){return i["first-of-type"](e)&&i["last-of-type"](e)},"nth-of-type":function(e,t,i){return n(e,i[3],"previousSibling")},"nth-last-of-type":function(e,t,i){return n(e,i[3],"nextSibling")}};e.extend(e.expr[":"],i)}(jQuery),function(){jQuery.fn.flowplayerErrorHandler=function(){var e=new Handler.Template("video").append(new Handler.Template);return this.each(function(){function t(t,i,o){return n.css("background-image",""),n.html(e.render("videoErrorPanel")),layout(n),errorHandler.msg("critical",new Error("Video returned an error"),!1,{videoError:o,containerCssClass:n.attr("class")}),t&&t.stopPropagation(),!1}var n=jQuery(this);return n.data("flowplayer")?n.data("flowplayerErrorHandlerInitialized")?this:(n.data("flowplayerErrorHandlerInitialized",!0),n.hasClass("is-error")&&t(null,null,"When error handler initialized, video already had an error"),n.data("flowplayer").bind("error",t),this):this})}}(),function(e,t){"use strict";"function"==typeof define&&define.amd?define(["jquery"],function(n){return t(n,e,e.document,e.Math)}):"object"==typeof exports&&exports?module.exports=t(require("jquery"),e,e.document,e.Math):t(jQuery,e,e.document,e.Math)}("undefined"!=typeof window?window:this,function(e,t,n,i,o){"use strict";var r="fullpage-wrapper",a="."+r,s="fp-scrollable",l="."+s,c="fp-responsive",d="fp-notransition",u="fp-destroyed",h="fp-enabled",p="fp-viewing",f="active",g="."+f,m="fp-completely",v="."+m,y=".section",w="fp-section",b="."+w,C=b+g,k=b+":first",F=b+":last",x="fp-tableCell",T="."+x,_="fp-auto-height",E="fp-normal-scroll",S="fp-nav",j="#"+S,I="fp-tooltip",A="."+I,O="fp-show-active",M=".slide",P="fp-slide",B="."+P,R=B+g,L="fp-slides",N="."+L,D="fp-slidesContainer",Q="."+D,H="fp-table",G="fp-slidesNav",V="."+G,U=V+" a",z="fp-controlArrow",W="."+z,$="fp-prev",q="."+$,K=z+" "+$,Y=W+q,J="fp-next",X="."+J,Z=z+" "+J,ee=W+X,te=e(t),ne=e(n),ie={scrollbars:!0,mouseWheel:!0,hideScrollbars:!1,fadeScrollbars:!1,disableMouse:!0,interactiveScrollbars:!0};e.fn.fullpage=function(s){function l(t,n){t||en(0),an("autoScrolling",t,n);var i=e(C);s.autoScrolling&&!s.scrollBar?(cn.css({overflow:"hidden",height:"100%"}),z(Pn.recordHistory,"internal"),wn.css({"-ms-touch-action":"none","touch-action":"none"}),i.length&&en(i.position().top)):(cn.css({overflow:"visible",height:"initial"}),z(!1,"internal"),wn.css({"-ms-touch-action":"","touch-action":""
}),i.length&&cn.scrollTop(i.position().top))}function z(e,t){an("recordHistory",e,t)}function q(e,t){an("scrollingSpeed",e,t)}function J(e,t){an("fitToSection",e,t)}function X(e){s.lockAnchors=e}function re(e){e?(Wt(),$t()):(zt(),qt())}function ae(t,n){"undefined"!=typeof n?(n=n.replace(/ /g,"").split(","),e.each(n,function(e,n){nn(t,n,"m")})):t?(re(!0),Kt()):(re(!1),Yt())}function se(t,n){"undefined"!=typeof n?(n=n.replace(/ /g,"").split(","),e.each(n,function(e,n){nn(t,n,"k")})):s.keyboardScrolling=t}function le(){var t=e(C).prev(b);t.length||!s.loopTop&&!s.continuousVertical||(t=e(b).last()),t.length&&$e(t,null,!0)}function ce(){var t=e(C).next(b);t.length||!s.loopBottom&&!s.continuousVertical||(t=e(b).first()),t.length&&$e(t,null,!1)}function de(e,t){q(0,"internal"),ue(e,t),q(Pn.scrollingSpeed,"internal")}function ue(e,t){var n=Bt(e);"undefined"!=typeof t?Lt(e,t):n.length>0&&$e(n)}function he(e){Ue("right",e)}function pe(e){Ue("left",e)}function fe(t){if(!wn.hasClass(u)){Cn=!0,bn=te.height(),e(b).each(function(){var t=e(this).find(N),n=e(this).find(B);s.verticalCentered&&e(this).find(T).css("height",Mt(e(this))+"px"),e(this).css("height",bn+"px"),s.scrollOverflow&&(n.length?n.each(function(){At(e(this))}):At(e(this))),n.length>1&&yt(t,t.find(R))});var n=e(C),i=n.index(b);i&&de(i+1),Cn=!1,e.isFunction(s.afterResize)&&t&&s.afterResize.call(wn),e.isFunction(s.afterReBuild)&&!t&&s.afterReBuild.call(wn)}}function ge(t){var n=dn.hasClass(c);t?n||(l(!1,"internal"),J(!1,"internal"),e(j).hide(),dn.addClass(c),e.isFunction(s.afterResponsive)&&s.afterResponsive.call(wn,t)):n&&(l(Pn.autoScrolling,"internal"),J(Pn.autoScrolling,"internal"),e(j).show(),dn.removeClass(c),e.isFunction(s.afterResponsive)&&s.afterResponsive.call(wn,t))}function me(){s.css3&&(s.css3=Ut()),s.scrollBar=s.scrollBar||s.hybrid,ye(),we(),ae(!0),l(s.autoScrolling,"internal"),Ft(),Vt(),"complete"===n.readyState&&rt(),te.on("load",rt)}function ve(){te.on("scroll",Oe).on("hashchange",at).blur(pt).resize(kt),ne.keydown(st).keyup(ct).on("click touchstart",j+" a",ft).on("click touchstart",U,gt).on("click",A,lt),e(b).on("click touchstart",W,ht),s.normalScrollElements&&(ne.on("mouseenter",s.normalScrollElements,function(){re(!1)}),ne.on("mouseleave",s.normalScrollElements,function(){re(!0)}))}function ye(){var t=wn.find(s.sectionSelector);s.anchors.length||(s.anchors=t.filter("[data-anchor]").map(function(){return e(this).data("anchor").toString()}).get()),s.navigationTooltips.length||(s.navigationTooltips=t.filter("[data-tooltip]").map(function(){return e(this).data("tooltip").toString()}).get())}function we(){wn.css({height:"100%",position:"relative"}),wn.addClass(r),e("html").addClass(h),bn=te.height(),wn.removeClass(u),Fe(),e(b).each(function(t){var n=e(this),i=n.find(B),o=i.length;Ce(n,t),ke(n,t),o>0?be(n,i,o):s.verticalCentered&&Ot(n)}),s.fixedElements&&s.css3&&e(s.fixedElements).appendTo(dn),s.navigation&&Te(),Ee(),s.scrollOverflow?("complete"===n.readyState&&_e(),te.on("load",_e)):Ie()}function be(t,n,i){var o=100*i,r=100/i;n.wrapAll('<div class="'+D+'" />'),n.parent().wrap('<div class="'+L+'" />'),t.find(Q).css("width",o+"%"),i>1&&(s.controlArrows&&xe(t),s.slidesNavigation&&Dt(t,i)),n.each(function(t){e(this).css("width",r+"%"),s.verticalCentered&&Ot(e(this))});var a=t.find(R);a.length&&(0!==e(C).index(b)||0===e(C).index(b)&&0!==a.index())?Zt(a,"internal"):n.eq(0).addClass(f)}function Ce(t,n){n||0!==e(C).length||t.addClass(f),gn=e(C),t.css("height",bn+"px"),s.paddingTop&&t.css("padding-top",s.paddingTop),s.paddingBottom&&t.css("padding-bottom",s.paddingBottom),"undefined"!=typeof s.sectionsColor[n]&&t.css("background-color",s.sectionsColor[n]),"undefined"!=typeof s.anchors[n]&&t.attr("data-anchor",s.anchors[n])}function ke(t,n){"undefined"!=typeof s.anchors[n]&&t.hasClass(f)&&St(s.anchors[n],n),s.menu&&s.css3&&e(s.menu).closest(a).length&&e(s.menu).appendTo(dn)}function Fe(){wn.find(s.sectionSelector).addClass(w),wn.find(s.slideSelector).addClass(P)}function xe(e){e.find(N).after('<div class="'+K+'"></div><div class="'+Z+'"></div>'),"#fff"!=s.controlArrowColor&&(e.find(ee).css("border-color","transparent transparent transparent "+s.controlArrowColor),e.find(Y).css("border-color","transparent "+s.controlArrowColor+" transparent transparent")),s.loopHorizontal||e.find(Y).hide()}function Te(){dn.append('<div id="'+S+'"><ul></ul></div>');var t=e(j);t.addClass(function(){return s.showActiveTooltip?O+" "+s.navigationPosition:s.navigationPosition});for(var n=0;n<e(b).length;n++){var i="";s.anchors.length&&(i=s.anchors[n]);var o='<li><a href="#'+i+'"><span></span></a>',r=s.navigationTooltips[n];"undefined"!=typeof r&&""!==r&&(o+='<div class="'+I+" "+s.navigationPosition+'">'+r+"</div>"),o+="</li>",t.find("ul").append(o)}e(j).css("margin-top","-"+e(j).height()/2+"px"),e(j).find("li").eq(e(C).index(b)).find("a").addClass(f)}function _e(){e(b).each(function(){var t=e(this).find(B);t.length?t.each(function(){At(e(this))}):At(e(this))}),Ie()}function Ee(){wn.find('iframe[src*="youtube.com/embed/"]').each(function(){Se(e(this),"enablejsapi=1")})}function Se(e,t){var n=e.attr("src");e.attr("src",n+je(n)+t)}function je(e){return/\?/.test(e)?"&":"?"}function Ie(){var t=e(C);t.addClass(m),s.scrollOverflowHandler.afterRender&&s.scrollOverflowHandler.afterRender(t),et(t),tt(t),s.scrollOverflowHandler.afterLoad(),Ae()&&e.isFunction(s.afterLoad)&&s.afterLoad.call(t,t.data("anchor"),t.index(b)+1),e.isFunction(s.afterRender)&&s.afterRender.call(wn)}function Ae(){var e=t.location.hash.replace("#","").split("/"),n=Bt(decodeURIComponent(e[0]));return!n.length||n.length&&n.index()===gn.index()}function Oe(){var t;if(!s.autoScrolling||s.scrollBar){var i=te.scrollTop(),o=Be(i),r=0,a=i+te.height()/2,l=dn.height()-te.height()===i,c=n.querySelectorAll(b);if(l)r=c.length-1;else if(i)for(var d=0;d<c.length;++d){var u=c[d];u.offsetTop<=a&&(r=d)}else r=0;if(Pe(o)&&(e(C).hasClass(m)||e(C).addClass(m).siblings().removeClass(m)),t=e(c).eq(r),!t.hasClass(f)){Bn=!0;var h,p,g=e(C),v=g.index(b)+1,y=jt(t),w=t.data("anchor"),k=t.index(b)+1,F=t.find(R);F.length&&(p=F.data("anchor"),h=F.index()),Fn&&(t.addClass(f).siblings().removeClass(f),e.isFunction(s.onLeave)&&s.onLeave.call(g,v,k,y),e.isFunction(s.afterLoad)&&s.afterLoad.call(t,w,k),it(g),et(t),tt(t),St(w,k-1),s.anchors.length&&(hn=w),Qt(h,p,w,k)),clearTimeout(jn),jn=setTimeout(function(){Bn=!1},100)}s.fitToSection&&(clearTimeout(In),In=setTimeout(function(){s.fitToSection&&Me()},s.fitToSectionDelay))}}function Me(){Fn&&(Cn=!0,$e(e(C)),Cn=!1)}function Pe(t){var n=e(C).position().top,i=n+te.height();return"up"==t?i>=te.scrollTop()+te.height():n<=te.scrollTop()}function Be(e){var t=e>Rn?"down":"up";return Rn=e,Gn=e,t}function Re(e,t){if(Tn.m[e]){var n="down"===e?"bottom":"top",i="down"===e?ce:le;if(t.length>0){if(!s.scrollOverflowHandler.isScrolled(n,t))return!0;i()}else i()}}function Le(e){var t=e.originalEvent;!De(e.target)&&s.autoScrolling&&Qe(t)&&e.preventDefault()}function Ne(t){var n=t.originalEvent,o=e(n.target).closest(b);if(!De(t.target)&&Qe(n)){s.autoScrolling&&t.preventDefault();var r=s.scrollOverflowHandler.scrollable(o),a=Xt(n);Dn=a.y,Qn=a.x,o.find(N).length&&i.abs(Nn-Qn)>i.abs(Ln-Dn)?!mn&&i.abs(Nn-Qn)>te.outerWidth()/100*s.touchSensitivity&&(Nn>Qn?Tn.m.right&&he(o):Tn.m.left&&pe(o)):s.autoScrolling&&Fn&&i.abs(Ln-Dn)>te.height()/100*s.touchSensitivity&&(Ln>Dn?Re("down",r):Dn>Ln&&Re("up",r))}}function De(t,n){n=n||0;var i=e(t).parent();return n<s.normalScrollElementTouchThreshold&&i.is(s.normalScrollElements)?!0:n==s.normalScrollElementTouchThreshold?!1:De(i,++n)}function Qe(e){return"undefined"==typeof e.pointerType||"mouse"!=e.pointerType}function He(e){var t=e.originalEvent;if(s.fitToSection&&cn.stop(),Qe(t)){var n=Xt(t);Ln=n.y,Nn=n.x}}function Ge(e,t){for(var n=0,o=e.slice(i.max(e.length-t,1)),r=0;r<o.length;r++)n+=o[r];return i.ceil(n/t)}function Ve(n){var o=(new Date).getTime(),r=e(v).hasClass(E);if(s.autoScrolling&&!fn&&!r){n=n||t.event;var a=n.wheelDelta||-n.deltaY||-n.detail,l=i.max(-1,i.min(1,a)),c="undefined"!=typeof n.wheelDeltaX||"undefined"!=typeof n.deltaX,d=i.abs(n.wheelDeltaX)<i.abs(n.wheelDelta)||i.abs(n.deltaX)<i.abs(n.deltaY)||!c;xn.length>149&&xn.shift(),xn.push(i.abs(a)),s.scrollBar&&(n.preventDefault?n.preventDefault():n.returnValue=!1);var u=e(C),h=s.scrollOverflowHandler.scrollable(u),p=o-Hn;if(Hn=o,p>200&&(xn=[]),Fn){var f=Ge(xn,10),g=Ge(xn,70),m=f>=g;m&&d&&(0>l?Re("down",h):Re("up",h))}return!1}s.fitToSection&&cn.stop()}function Ue(t,n){var i="undefined"==typeof n?e(C):n,o=i.find(N),r=o.find(B).length;if(!(!o.length||mn||2>r)){var a=o.find(R),l=null;if(l="left"===t?a.prev(B):a.next(B),!l.length){if(!s.loopHorizontal)return;l="left"===t?a.siblings(":last"):a.siblings(":first")}mn=!0,yt(o,l,t)}}function ze(){e(R).each(function(){Zt(e(this),"internal")})}function We(e){var t=e.position(),n=t.top,i=t.top>Gn,o=n-bn+e.outerHeight(),r=s.bigSectionsDestination;return e.outerHeight()>bn?(!i&&!r||"bottom"===r)&&(n=o):(i||Cn&&e.is(":last-child"))&&(n=o),Gn=n,n}function $e(t,n,i){if("undefined"!=typeof t){var o,r,a=We(t),l={element:t,callback:n,isMovementUp:i,dtop:a,yMovement:jt(t),anchorLink:t.data("anchor"),sectionIndex:t.index(b),activeSlide:t.find(R),activeSection:e(C),leavingSection:e(C).index(b)+1,localIsResizing:Cn};l.activeSection.is(t)&&!Cn||s.scrollBar&&te.scrollTop()===l.dtop&&!t.hasClass(_)||(l.activeSlide.length&&(o=l.activeSlide.data("anchor"),r=l.activeSlide.index()),s.autoScrolling&&s.continuousVertical&&"undefined"!=typeof l.isMovementUp&&(!l.isMovementUp&&"up"==l.yMovement||l.isMovementUp&&"down"==l.yMovement)&&(l=Ye(l)),(!e.isFunction(s.onLeave)||l.localIsResizing||s.onLeave.call(l.activeSection,l.leavingSection,l.sectionIndex+1,l.yMovement)!==!1)&&(l.localIsResizing||it(l.activeSection),s.scrollOverflowHandler.beforeLeave(),t.addClass(f).siblings().removeClass(f),et(t),s.scrollOverflowHandler.onLeave(),Fn=!1,Qt(r,o,l.anchorLink,l.sectionIndex),qe(l),hn=l.anchorLink,St(l.anchorLink,l.sectionIndex)))}}function qe(t){if(s.css3&&s.autoScrolling&&!s.scrollBar){var n="translate3d(0px, -"+i.round(t.dtop)+"px, 0px)";Pt(n,!0),s.scrollingSpeed?(clearTimeout(En),En=setTimeout(function(){Xe(t)},s.scrollingSpeed)):Xe(t)}else{var o=Ke(t);e(o.element).animate(o.options,s.scrollingSpeed,s.easing).promise().done(function(){s.scrollBar?setTimeout(function(){Xe(t)},30):Xe(t)})}}function Ke(e){var t={};return s.autoScrolling&&!s.scrollBar?(t.options={top:-e.dtop},t.element=a):(t.options={scrollTop:e.dtop},t.element="html, body"),t}function Ye(t){return t.isMovementUp?e(C).before(t.activeSection.nextAll(b)):e(C).after(t.activeSection.prevAll(b).get().reverse()),en(e(C).position().top),ze(),t.wrapAroundElements=t.activeSection,t.dtop=t.element.position().top,t.yMovement=jt(t.element),t}function Je(t){t.wrapAroundElements&&t.wrapAroundElements.length&&(t.isMovementUp?e(k).before(t.wrapAroundElements):e(F).after(t.wrapAroundElements),en(e(C).position().top),ze())}function Xe(t){Je(t),e.isFunction(s.afterLoad)&&!t.localIsResizing&&s.afterLoad.call(t.element,t.anchorLink,t.sectionIndex+1),s.scrollOverflowHandler.afterLoad(),t.localIsResizing||tt(t.element),t.element.addClass(m).siblings().removeClass(m),Fn=!0,e.isFunction(t.callback)&&t.callback.call(this)}function Ze(e,t){e.attr(t,e.data(t)).removeAttr("data-"+t)}function et(t){if(s.lazyLoading){var n,i=ot(t);i.find("img[data-src], img[data-srcset], source[data-src], audio[data-src], iframe[data-src]").each(function(){n=e(this),e.each(["src","srcset"],function(e,t){var i=n.attr("data-"+t);"undefined"!=typeof i&&i&&Ze(n,t)}),n.is("source")&&n.closest("video").get(0).load()})}}function tt(t){var n=ot(t);n.find("video, audio").each(function(){var t=e(this).get(0);t.hasAttribute("data-autoplay")&&"function"==typeof t.play&&t.play()}),n.find('iframe[src*="youtube.com/embed/"]').each(function(){var t=e(this).get(0);t.hasAttribute("data-autoplay")&&nt(t),t.onload=function(){t.hasAttribute("data-autoplay")&&nt(t)}})}function nt(e){e.contentWindow.postMessage('{"event":"command","func":"playVideo","args":""}',"*")}function it(t){var n=ot(t);n.find("video, audio").each(function(){var t=e(this).get(0);t.hasAttribute("data-keepplaying")||"function"!=typeof t.pause||t.pause()}),n.find('iframe[src*="youtube.com/embed/"]').each(function(){var t=e(this).get(0);/youtube\.com\/embed\//.test(e(this).attr("src"))&&!t.hasAttribute("data-keepplaying")&&e(this).get(0).contentWindow.postMessage('{"event":"command","func":"pauseVideo","args":""}',"*")})}function ot(t){var n=t.find(R);return n.length&&(t=e(n)),t}function rt(){var e=t.location.hash.replace("#","").split("/"),n=decodeURIComponent(e[0]),i=decodeURIComponent(e[1]);n&&(s.animateAnchor?Lt(n,i):de(n,i))}function at(){if(!Bn&&!s.lockAnchors){var e=t.location.hash.replace("#","").split("/"),n=decodeURIComponent(e[0]),i=decodeURIComponent(e[1]),o="undefined"==typeof hn,r="undefined"==typeof hn&&"undefined"==typeof i&&!mn;n.length&&(n&&n!==hn&&!o||r||!mn&&pn!=i)&&Lt(n,i)}}function st(t){clearTimeout(An);var n=e(":focus");if(!n.is("textarea")&&!n.is("input")&&!n.is("select")&&"true"!==n.attr("contentEditable")&&""!==n.attr("contentEditable")&&s.keyboardScrolling&&s.autoScrolling){var i=t.which,o=[40,38,32,33,34];e.inArray(i,o)>-1&&t.preventDefault(),fn=t.ctrlKey,An=setTimeout(function(){mt(t)},150)}}function lt(){e(this).prev().trigger("click")}function ct(e){kn&&(fn=e.ctrlKey)}function dt(e){2==e.which&&(Vn=e.pageY,wn.on("mousemove",vt))}function ut(e){2==e.which&&wn.off("mousemove")}function ht(){var t=e(this).closest(b);e(this).hasClass($)?Tn.m.left&&pe(t):Tn.m.right&&he(t)}function pt(){kn=!1,fn=!1}function ft(t){t.preventDefault();var n=e(this).parent().index();$e(e(b).eq(n))}function gt(t){t.preventDefault();var n=e(this).closest(b).find(N),i=n.find(B).eq(e(this).closest("li").index());yt(n,i)}function mt(t){var n=t.shiftKey;if(Fn||!([37,39].indexOf(t.which)<0))switch(t.which){case 38:case 33:Tn.k.up&&le();break;case 32:if(n&&Tn.k.up){le();break}case 40:case 34:Tn.k.down&&ce();break;case 36:Tn.k.up&&ue(1);break;case 35:Tn.k.down&&ue(e(b).length);break;case 37:Tn.k.left&&pe();break;case 39:Tn.k.right&&he();break;default:return}}function vt(e){Fn&&(e.pageY<Vn&&Tn.m.up?le():e.pageY>Vn&&Tn.m.down&&ce()),Vn=e.pageY}function yt(t,n,i){var o=t.closest(b),r={slides:t,destiny:n,direction:i,destinyPos:n.position(),slideIndex:n.index(),section:o,sectionIndex:o.index(b),anchorLink:o.data("anchor"),slidesNav:o.find(V),slideAnchor:Gt(n),prevSlide:o.find(R),prevSlideIndex:o.find(R).index(),localIsResizing:Cn};return r.xMovement=It(r.prevSlideIndex,r.slideIndex),r.localIsResizing||(Fn=!1),s.onSlideLeave&&!r.localIsResizing&&"none"!==r.xMovement&&e.isFunction(s.onSlideLeave)&&s.onSlideLeave.call(r.prevSlide,r.anchorLink,r.sectionIndex+1,r.prevSlideIndex,r.xMovement,r.slideIndex)===!1?void(mn=!1):(n.addClass(f).siblings().removeClass(f),r.localIsResizing||(it(r.prevSlide),et(n)),!s.loopHorizontal&&s.controlArrows&&(o.find(Y).toggle(0!==r.slideIndex),o.find(ee).toggle(!n.is(":last-child"))),o.hasClass(f)&&!r.localIsResizing&&Qt(r.slideIndex,r.slideAnchor,r.anchorLink,r.sectionIndex),void bt(t,r,!0))}function wt(t){Ct(t.slidesNav,t.slideIndex),t.localIsResizing||(e.isFunction(s.afterSlideLoad)&&s.afterSlideLoad.call(t.destiny,t.anchorLink,t.sectionIndex+1,t.slideAnchor,t.slideIndex),Fn=!0,tt(t.destiny)),mn=!1}function bt(e,t,n){var o=t.destinyPos;if(s.css3){var r="translate3d(-"+i.round(o.left)+"px, 0px, 0px)";xt(e.find(Q)).css(tn(r)),Sn=setTimeout(function(){n&&wt(t)},s.scrollingSpeed,s.easing)}else e.animate({scrollLeft:i.round(o.left)},s.scrollingSpeed,s.easing,function(){n&&wt(t)})}function Ct(e,t){e.find(g).removeClass(f),e.find("li").eq(t).find("a").addClass(f)}function kt(){if(Ft(),vn){var t=e(n.activeElement);if(!t.is("textarea")&&!t.is("input")&&!t.is("select")){var o=te.height();i.abs(o-Un)>20*i.max(Un,o)/100&&(fe(!0),Un=o)}}else clearTimeout(_n),_n=setTimeout(function(){fe(!0)},350)}function Ft(){var e=s.responsive||s.responsiveWidth,t=s.responsiveHeight,n=e&&te.outerWidth()<e,i=t&&te.height()<t;e&&t?ge(n||i):e?ge(n):t&&ge(i)}function xt(e){var t="all "+s.scrollingSpeed+"ms "+s.easingcss3;return e.removeClass(d),e.css({"-webkit-transition":t,transition:t})}function Tt(e){return e.addClass(d)}function _t(t,n){s.navigation&&(e(j).find(g).removeClass(f),t?e(j).find('a[href="#'+t+'"]').addClass(f):e(j).find("li").eq(n).find("a").addClass(f))}function Et(t){s.menu&&(e(s.menu).find(g).removeClass(f),e(s.menu).find('[data-menuanchor="'+t+'"]').addClass(f))}function St(e,t){Et(e),_t(e,t)}function jt(t){var n=e(C).index(b),i=t.index(b);return n==i?"none":n>i?"up":"down"}function It(e,t){return e==t?"none":e>t?"left":"right"}function At(e){if(!e.hasClass("fp-noscroll")){e.css("overflow","hidden");var t,n=s.scrollOverflowHandler,i=n.wrapContent(),o=e.closest(b),r=n.scrollable(e);r.length?t=n.scrollHeight(e):(t=e.get(0).scrollHeight,s.verticalCentered&&(t=e.find(T).get(0).scrollHeight));var a=bn-parseInt(o.css("padding-bottom"))-parseInt(o.css("padding-top"));t>a?r.length?n.update(e,a):(s.verticalCentered?e.find(T).wrapInner(i):e.wrapInner(i),n.create(e,a)):n.remove(e),e.css("overflow","")}}function Ot(e){e.hasClass(H)||e.addClass(H).wrapInner('<div class="'+x+'" style="height:'+Mt(e)+'px;" />')}function Mt(e){var t=bn;if(s.paddingTop||s.paddingBottom){var n=e;n.hasClass(w)||(n=e.closest(b));var i=parseInt(n.css("padding-top"))+parseInt(n.css("padding-bottom"));t=bn-i}return t}function Pt(e,t){t?xt(wn):Tt(wn),wn.css(tn(e)),setTimeout(function(){wn.removeClass(d)},10)}function Bt(t){if(!t)return[];var n=wn.find(b+'[data-anchor="'+t+'"]');return n.length||(n=e(b).eq(t-1)),n}function Rt(e,t){var n=t.find(N),i=n.find(B+'[data-anchor="'+e+'"]');return i.length||(i=n.find(B).eq(e)),i}function Lt(e,t){var n=Bt(e);n.length&&("undefined"==typeof t&&(t=0),e===hn||n.hasClass(f)?Nt(n,t):$e(n,function(){Nt(n,t)}))}function Nt(e,t){if("undefined"!=typeof t){var n=e.find(N),i=Rt(t,e);i.length&&yt(n,i)}}function Dt(e,t){e.append('<div class="'+G+'"><ul></ul></div>');var n=e.find(V);n.addClass(s.slidesNavPosition);for(var i=0;t>i;i++)n.find("ul").append('<li><a href="#"><span></span></a></li>');n.css("margin-left","-"+n.width()/2+"px"),n.find("li").first().find("a").addClass(f)}function Qt(e,t,n,i){var o="";s.anchors.length&&!s.lockAnchors&&(e?("undefined"!=typeof n&&(o=n),"undefined"==typeof t&&(t=e),pn=t,Ht(o+"/"+t)):"undefined"!=typeof e?(pn=t,Ht(n)):Ht(n)),Vt()}function Ht(e){if(s.recordHistory)location.hash=e;else if(vn||yn)t.history.replaceState(o,o,"#"+e);else{var n=t.location.href.split("#")[0];t.location.replace(n+"#"+e)}}function Gt(e){var t=e.data("anchor"),n=e.index();return"undefined"==typeof t&&(t=n),t}function Vt(){var t=e(C),n=t.find(R),i=Gt(t),o=Gt(n),r=String(i);n.length&&(r=r+"-"+o),r=r.replace("/","-").replace("#","");var a=new RegExp("\\b\\s?"+p+"-[^\\s]+\\b","g");dn[0].className=dn[0].className.replace(a,""),dn.addClass(p+"-"+r)}function Ut(){var e,i=n.createElement("p"),r={webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"};n.body.insertBefore(i,null);for(var a in r)i.style[a]!==o&&(i.style[a]="translate3d(1px,1px,1px)",e=t.getComputedStyle(i).getPropertyValue(r[a]));return n.body.removeChild(i),e!==o&&e.length>0&&"none"!==e}function zt(){n.addEventListener?(n.removeEventListener("mousewheel",Ve,!1),n.removeEventListener("wheel",Ve,!1),n.removeEventListener("MozMousePixelScroll",Ve,!1)):n.detachEvent("onmousewheel",Ve)}function Wt(){var e,i="";t.addEventListener?e="addEventListener":(e="attachEvent",i="on");var r="onwheel"in n.createElement("div")?"wheel":n.onmousewheel!==o?"mousewheel":"DOMMouseScroll";"DOMMouseScroll"==r?n[e](i+"MozMousePixelScroll",Ve,!1):n[e](i+r,Ve,!1)}function $t(){wn.on("mousedown",dt).on("mouseup",ut)}function qt(){wn.off("mousedown",dt).off("mouseup",ut)}function Kt(){(vn||yn)&&(s.autoScrolling&&dn.off(Mn.touchmove).on(Mn.touchmove,Le),e(a).off(Mn.touchstart).on(Mn.touchstart,He).off(Mn.touchmove).on(Mn.touchmove,Ne))}function Yt(){(vn||yn)&&e(a).off(Mn.touchstart).off(Mn.touchmove)}function Jt(){var e;return e=t.PointerEvent?{down:"pointerdown",move:"pointermove"}:{down:"MSPointerDown",move:"MSPointerMove"}}function Xt(e){var t=[];return t.y="undefined"!=typeof e.pageY&&(e.pageY||e.pageX)?e.pageY:e.touches[0].pageY,t.x="undefined"!=typeof e.pageX&&(e.pageY||e.pageX)?e.pageX:e.touches[0].pageX,yn&&Qe(e)&&s.scrollBar&&(t.y=e.touches[0].pageY,t.x=e.touches[0].pageX),t}function Zt(e,t){q(0,"internal"),"undefined"!=typeof t&&(Cn=!0),yt(e.closest(N),e),"undefined"!=typeof t&&(Cn=!1),q(Pn.scrollingSpeed,"internal")}function en(e){var t=i.round(e);if(s.css3&&s.autoScrolling&&!s.scrollBar){var n="translate3d(0px, -"+t+"px, 0px)";Pt(n,!1)}else s.autoScrolling&&!s.scrollBar?wn.css("top",-t):cn.scrollTop(t)}function tn(e){return{"-webkit-transform":e,"-moz-transform":e,"-ms-transform":e,transform:e}}function nn(e,t,n){switch(t){case"up":Tn[n].up=e;break;case"down":Tn[n].down=e;break;case"left":Tn[n].left=e;break;case"right":Tn[n].right=e;break;case"all":"m"==n?ae(e):se(e)}}function on(t){l(!1,"internal"),ae(!1),se(!1),wn.addClass(u),clearTimeout(Sn),clearTimeout(En),clearTimeout(_n),clearTimeout(jn),clearTimeout(In),te.off("scroll",Oe).off("hashchange",at).off("resize",kt),ne.off("click touchstart",j+" a").off("mouseenter",j+" li").off("mouseleave",j+" li").off("click touchstart",U).off("mouseover",s.normalScrollElements).off("mouseout",s.normalScrollElements),e(b).off("click touchstart",W),clearTimeout(Sn),clearTimeout(En),t&&rn()}function rn(){en(0),wn.find("img[data-src], source[data-src], audio[data-src], iframe[data-src]").each(function(){Ze(e(this),"src")}),wn.find("img[data-srcset]").each(function(){Ze(e(this),"srcset")}),e(j+", "+V+", "+W).remove(),e(b).css({height:"","background-color":"",padding:""}),e(B).css({width:""}),wn.css({height:"",position:"","-ms-touch-action":"","touch-action":""}),cn.css({overflow:"",height:""}),e("html").removeClass(h),dn.removeClass(c),e.each(dn.get(0).className.split(/\s+/),function(e,t){0===t.indexOf(p)&&dn.removeClass(t)}),e(b+", "+B).each(function(){s.scrollOverflowHandler.remove(e(this)),e(this).removeClass(H+" "+f)}),Tt(wn),wn.find(T+", "+Q+", "+N).each(function(){e(this).replaceWith(this.childNodes)}),wn.css({"-webkit-transition":"none",transition:"none"}),cn.scrollTop(0);var t=[w,P,D];e.each(t,function(t,n){e("."+n).removeClass(n)})}function an(e,t,n){s[e]=t,"internal"!==n&&(Pn[e]=t)}function sn(){var t=["fadingEffect","continuousHorizontal","scrollHorizontally","interlockedSlides","resetSliders","responsiveSlides","offsetSections","dragAndMove","scrollOverflowReset","parallax"];return e("html").hasClass(h)?void ln("error","Fullpage.js can only be initialized once and you are doing it multiple times!"):(s.continuousVertical&&(s.loopTop||s.loopBottom)&&(s.continuousVertical=!1,ln("warn","Option `loopTop/loopBottom` is mutually exclusive with `continuousVertical`; `continuousVertical` disabled")),s.scrollBar&&s.scrollOverflow&&ln("warn","Option `scrollBar` is mutually exclusive with `scrollOverflow`. Sections with scrollOverflow might not work well in Firefox"),!s.continuousVertical||!s.scrollBar&&s.autoScrolling||(s.continuousVertical=!1,ln("warn","Scroll bars (`scrollBar:true` or `autoScrolling:false`) are mutually exclusive with `continuousVertical`; `continuousVertical` disabled")),e.each(t,function(e,t){s[t]&&ln("warn","fullpage.js extensions require jquery.fullpage.extensions.min.js file instead of the usual jquery.fullpage.js. Requested: "+t)}),void e.each(s.anchors,function(t,n){var i=ne.find("[name]").filter(function(){return e(this).attr("name")&&e(this).attr("name").toLowerCase()==n.toLowerCase()}),o=ne.find("[id]").filter(function(){return e(this).attr("id")&&e(this).attr("id").toLowerCase()==n.toLowerCase()});(o.length||i.length)&&(ln("error","data-anchor tags can not have the same value as any `id` element on the site (or `name` element for IE)."),o.length&&ln("error",'"'+n+'" is is being used by another element `id` property'),i.length&&ln("error",'"'+n+'" is is being used by another element `name` property'))}))}function ln(e,t){console&&console[e]&&console[e]("fullPage: "+t)}if(e("html").hasClass(h))return void sn();var cn=e("html, body"),dn=e("body"),un=e.fn.fullpage;s=e.extend({menu:!1,anchors:[],lockAnchors:!1,navigation:!1,navigationPosition:"right",navigationTooltips:[],showActiveTooltip:!1,slidesNavigation:!1,slidesNavPosition:"bottom",scrollBar:!1,hybrid:!1,css3:!0,scrollingSpeed:700,autoScrolling:!0,fitToSection:!0,fitToSectionDelay:1e3,easing:"easeInOutCubic",easingcss3:"ease",loopBottom:!1,loopTop:!1,loopHorizontal:!0,continuousVertical:!1,continuousHorizontal:!1,scrollHorizontally:!1,interlockedSlides:!1,dragAndMove:!1,offsetSections:!1,resetSliders:!1,fadingEffect:!1,normalScrollElements:null,scrollOverflow:!1,scrollOverflowReset:!1,scrollOverflowHandler:oe,scrollOverflowOptions:null,touchSensitivity:5,normalScrollElementTouchThreshold:5,bigSectionsDestination:null,keyboardScrolling:!0,animateAnchor:!0,recordHistory:!0,controlArrows:!0,controlArrowColor:"#fff",verticalCentered:!0,sectionsColor:[],paddingTop:0,paddingBottom:0,fixedElements:null,responsive:0,responsiveWidth:0,responsiveHeight:0,responsiveSlides:!1,parallax:!1,parallaxOptions:{type:"reveal",percentage:62,property:"translate"},sectionSelector:y,slideSelector:M,afterLoad:null,onLeave:null,afterRender:null,afterResize:null,afterReBuild:null,afterSlideLoad:null,onSlideLeave:null,afterResponsive:null,lazyLoading:!0},s);var hn,pn,fn,gn,mn=!1,vn=navigator.userAgent.match(/(iPhone|iPod|iPad|Android|playbook|silk|BlackBerry|BB10|Windows Phone|Tizen|Bada|webOS|IEMobile|Opera Mini)/),yn="ontouchstart"in t||navigator.msMaxTouchPoints>0||navigator.maxTouchPoints,wn=e(this),bn=te.height(),Cn=!1,kn=!0,Fn=!0,xn=[],Tn={};Tn.m={up:!0,down:!0,left:!0,right:!0},Tn.k=e.extend(!0,{},Tn.m);var _n,En,Sn,jn,In,An,On=Jt(),Mn={touchmove:"ontouchmove"in t?"touchmove":On.move,touchstart:"ontouchstart"in t?"touchstart":On.down},Pn=e.extend(!0,{},s);sn(),ie.click=yn,ie=e.extend(ie,s.scrollOverflowOptions),e.extend(e.easing,{easeInOutCubic:function(e,t,n,i,o){return(t/=o/2)<1?i/2*t*t*t+n:i/2*((t-=2)*t*t+2)+n}}),e(this).length&&(un.setAutoScrolling=l,un.setRecordHistory=z,un.setScrollingSpeed=q,un.setFitToSection=J,un.setLockAnchors=X,un.setMouseWheelScrolling=re,un.setAllowScrolling=ae,un.setKeyboardScrolling=se,un.moveSectionUp=le,un.moveSectionDown=ce,un.silentMoveTo=de,un.moveTo=ue,un.moveSlideRight=he,un.moveSlideLeft=pe,un.fitToSection=Me,un.reBuild=fe,un.setResponsive=ge,un.destroy=on,me(),ve());var Bn=!1,Rn=0,Ln=0,Nn=0,Dn=0,Qn=0,Hn=(new Date).getTime(),Gn=0,Vn=0,Un=bn},"undefined"!=typeof IScroll&&(IScroll.prototype.wheelOn=function(){this.wrapper.addEventListener("wheel",this),this.wrapper.addEventListener("mousewheel",this),this.wrapper.addEventListener("DOMMouseScroll",this)},IScroll.prototype.wheelOff=function(){this.wrapper.removeEventListener("wheel",this),this.wrapper.removeEventListener("mousewheel",this),this.wrapper.removeEventListener("DOMMouseScroll",this)});var oe={refreshId:null,iScrollInstances:[],toggleWheel:function(t){var n=e(C).find(l);n.each(function(){var n=e(this).data("iscrollInstance");"undefined"!=typeof n&&n&&(t?n.wheelOn():n.wheelOff())})},onLeave:function(){oe.toggleWheel(!1)},beforeLeave:function(){oe.onLeave()},afterLoad:function(){oe.toggleWheel(!0)},create:function(t,n){var i=t.find(l);i.height(n),i.each(function(){var t=e(this),n=t.data("iscrollInstance");n&&e.each(oe.iScrollInstances,function(){e(this).destroy()}),n=new IScroll(t.get(0),ie),oe.iScrollInstances.push(n),n.wheelOff(),t.data("iscrollInstance",n)})},isScrolled:function(e,t){var n=t.data("iscrollInstance");return n?"top"===e?n.y>=0&&!t.scrollTop():"bottom"===e?0-n.y+t.scrollTop()+1+t.innerHeight()>=t[0].scrollHeight:void 0:!0},scrollable:function(e){return e.find(N).length?e.find(R).find(l):e.find(l)},scrollHeight:function(e){return e.find(l).children().first().get(0).scrollHeight},remove:function(e){var t=e.find(l);if(t.length){var n=t.data("iscrollInstance");n.destroy(),t.data("iscrollInstance",null)}e.find(l).children().first().children().first().unwrap().unwrap()},update:function(t,n){clearTimeout(oe.refreshId),oe.refreshId=setTimeout(function(){e.each(oe.iScrollInstances,function(){e(this).get(0).refresh()})},150),t.find(l).css("height",n+"px").parent().css("height",n+"px")},wrapContent:function(){return'<div class="'+s+'"><div class="fp-scroller"></div></div>'}}}),window.JSON||(window.JSON={}),function(){function f(e){return 10>e?"0"+e:e}function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var n,i,o,r,a,s=gap,l=t[e];switch(l&&"object"==typeof l&&"function"==typeof l.toJSON&&(l=l.toJSON(e)),"function"==typeof rep&&(l=rep.call(t,e,l)),typeof l){case"string":return quote(l);case"number":return isFinite(l)?String(l):"null";case"boolean":case"null":return String(l);case"object":if(!l)return"null";if(gap+=indent,a=[],"[object Array]"===Object.prototype.toString.apply(l)){for(r=l.length,n=0;r>n;n+=1)a[n]=str(n,l)||"null";return o=0===a.length?"[]":gap?"[\n"+gap+a.join(",\n"+gap)+"\n"+s+"]":"["+a.join(",")+"]",gap=s,o}if(rep&&"object"==typeof rep)for(r=rep.length,n=0;r>n;n+=1)i=rep[n],"string"==typeof i&&(o=str(i,l),o&&a.push(quote(i)+(gap?": ":":")+o));else for(i in l)Object.hasOwnProperty.call(l,i)&&(o=str(i,l),o&&a.push(quote(i)+(gap?": ":":")+o));return o=0===a.length?"{}":gap?"{\n"+gap+a.join(",\n"+gap)+"\n"+s+"}":"{"+a.join(",")+"}",gap=s,o}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(e){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(e){return this.valueOf()});var JSON=window.JSON,cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof JSON.stringify&&(JSON.stringify=function(e,t,n){var i;if(gap="",indent="","number"==typeof n)for(i=0;n>i;i+=1)indent+=" ";else"string"==typeof n&&(indent=n);if(rep=t,!t||"function"==typeof t||"object"==typeof t&&"number"==typeof t.length)return str("",{"":e});throw new Error("JSON.stringify")}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(e,t){var n,i,o=e[t];if(o&&"object"==typeof o)for(n in o)Object.hasOwnProperty.call(o,n)&&(i=walk(o,n),void 0!==i?o[n]=i:delete o[n]);return reviver.call(e,t,o)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),function(e,t){"use strict";var n=e.History=e.History||{},i=e.jQuery;"undefined"==typeof n.Adapter&&(n.Adapter={bind:function(e,t,n){i(e).bind(t,n)},trigger:function(e,t,n){i(e).trigger(t,n)},extractEventData:function(e,n,i){var o=n&&n.originalEvent&&n.originalEvent[e]||i&&i[e]||t;return o},onDomLoad:function(e){i(e)}},"undefined"!=typeof n.init&&n.init())}(window),function(e,t){"use strict";var n=e.document,i=e.setTimeout||i,o=e.clearTimeout||o,r=e.setInterval||r,a=e.History=e.History||{};
"undefined"==typeof a.initHtml4&&(a.initHtml4=function(){return"undefined"!=typeof a.initHtml4.initialized?!1:(a.initHtml4.initialized=!0,a.enabled=!0,a.savedHashes=[],a.isLastHash=function(e){var t,n=a.getHashByIndex();return t=e===n},a.saveHash=function(e){return a.isLastHash(e)?!1:(a.savedHashes.push(e),!0)},a.getHashByIndex=function(e){var t=null;return t="undefined"==typeof e?a.savedHashes[a.savedHashes.length-1]:0>e?a.savedHashes[a.savedHashes.length+e]:a.savedHashes[e]},a.discardedHashes={},a.discardedStates={},a.discardState=function(e,t,n){var i,o=a.getHashByState(e);return i={discardedState:e,backState:n,forwardState:t},a.discardedStates[o]=i,!0},a.discardHash=function(e,t,n){var i={discardedHash:e,backState:n,forwardState:t};return a.discardedHashes[e]=i,!0},a.discardedState=function(e){var t,n=a.getHashByState(e);return t=a.discardedStates[n]||!1},a.discardedHash=function(e){var t=a.discardedHashes[e]||!1;return t},a.recycleState=function(e){var t=a.getHashByState(e);return a.discardedState(e)&&delete a.discardedStates[t],!0},a.emulated.hashChange&&(a.hashChangeInit=function(){a.checkerFunction=null;var t,i,o,s,l="";return a.isInternetExplorer()?(t="historyjs-iframe",i=n.createElement("iframe"),i.setAttribute("id",t),i.style.display="none",n.body.appendChild(i),i.contentWindow.document.open(),i.contentWindow.document.close(),o="",s=!1,a.checkerFunction=function(){if(s)return!1;s=!0;var t=a.getHash()||"",n=a.unescapeHash(i.contentWindow.document.location.hash)||"";return t!==l?(l=t,n!==t&&(o=n=t,i.contentWindow.document.open(),i.contentWindow.document.close(),i.contentWindow.document.location.hash=a.escapeHash(t)),a.Adapter.trigger(e,"hashchange")):n!==o&&(o=n,a.setHash(n,!1)),s=!1,!0}):a.checkerFunction=function(){var t=a.getHash();return t!==l&&(l=t,a.Adapter.trigger(e,"hashchange")),!0},a.intervalList.push(r(a.checkerFunction,a.options.hashChangeInterval)),!0},a.Adapter.onDomLoad(a.hashChangeInit)),a.emulated.pushState&&(a.onHashChange=function(t){var i,o=t&&t.newURL||n.location.href,r=a.getHashByUrl(o),s=null,l=null;return a.isLastHash(r)?(a.busy(!1),!1):(a.doubleCheckComplete(),a.saveHash(r),r&&a.isTraditionalAnchor(r)?(a.Adapter.trigger(e,"anchorchange"),a.busy(!1),!1):(s=a.extractState(a.getFullUrl(r||n.location.href,!1),!0),a.isLastSavedState(s)?(a.busy(!1),!1):(l=a.getHashByState(s),i=a.discardedState(s),i?(a.getHashByIndex(-2)===a.getHashByState(i.forwardState)?a.back(!1):a.forward(!1),!1):(a.pushState(s.data,s.title,s.url,!1),!0))))},a.Adapter.bind(e,"hashchange",a.onHashChange),a.pushState=function(t,i,o,r){if(a.getHashByUrl(o))throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(r!==!1&&a.busy())return a.pushQueue({scope:a,callback:a.pushState,args:arguments,queue:r}),!1;a.busy(!0);var s=a.createStateObject(t,i,o),l=a.getHashByState(s),c=a.getState(!1),d=a.getHashByState(c),u=a.getHash();return a.storeState(s),a.expectedStateId=s.id,a.recycleState(s),a.setTitle(s),l===d?(a.busy(!1),!1):l!==u&&l!==a.getShortUrl(n.location.href)?(a.setHash(l,!1),!1):(a.saveState(s),a.Adapter.trigger(e,"statechange"),a.busy(!1),!0)},a.replaceState=function(e,t,n,i){if(a.getHashByUrl(n))throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(i!==!1&&a.busy())return a.pushQueue({scope:a,callback:a.replaceState,args:arguments,queue:i}),!1;a.busy(!0);var o=a.createStateObject(e,t,n),r=a.getState(!1),s=a.getStateByIndex(-2);return a.discardState(r,o,s),a.pushState(o.data,o.title,o.url,!1),!0}),a.emulated.pushState&&a.getHash()&&!a.emulated.hashChange&&a.Adapter.onDomLoad(function(){a.Adapter.trigger(e,"hashchange")}),void 0)},"undefined"!=typeof a.init&&a.init())}(window),function(e,t){"use strict";var n=e.console||t,i=e.document,o=e.navigator,r=e.sessionStorage||!1,a=e.setTimeout,s=e.clearTimeout,l=e.setInterval,c=e.clearInterval,d=e.JSON,u=e.alert,h=e.History=e.History||{},p=e.history;d.stringify=d.stringify||d.encode,d.parse=d.parse||d.decode,"undefined"==typeof h.init&&(h.init=function(){return"undefined"==typeof h.Adapter?!1:("undefined"!=typeof h.initCore&&h.initCore(),"undefined"!=typeof h.initHtml4&&h.initHtml4(),!0)},h.initCore=function(){if("undefined"!=typeof h.initCore.initialized)return!1;if(h.initCore.initialized=!0,h.options=h.options||{},h.options.hashChangeInterval=h.options.hashChangeInterval||100,h.options.safariPollInterval=h.options.safariPollInterval||500,h.options.doubleCheckInterval=h.options.doubleCheckInterval||500,h.options.storeInterval=h.options.storeInterval||1e3,h.options.busyDelay=h.options.busyDelay||250,h.options.debug=h.options.debug||!1,h.options.initialTitle=h.options.initialTitle||i.title,h.intervalList=[],h.clearAllIntervals=function(){var e,t=h.intervalList;if("undefined"!=typeof t&&null!==t){for(e=0;e<t.length;e++)c(t[e]);h.intervalList=null}},h.debug=function(){(h.options.debug||!1)&&h.log.apply(h,arguments)},h.log=function(){var e,t,o,r,a,s="undefined"!=typeof n&&"undefined"!=typeof n.log&&"undefined"!=typeof n.log.apply,l=i.getElementById("log");for(s?(r=Array.prototype.slice.call(arguments),e=r.shift(),"undefined"!=typeof n.debug?n.debug.apply(n,[e,r]):n.log.apply(n,[e,r])):e="\n"+arguments[0]+"\n",t=1,o=arguments.length;o>t;++t){if(a=arguments[t],"object"==typeof a&&"undefined"!=typeof d)try{a=d.stringify(a)}catch(c){}e+="\n"+a+"\n"}return l?(l.value+=e+"\n-----\n",l.scrollTop=l.scrollHeight-l.clientHeight):s||u(e),!0},h.getInternetExplorerMajorVersion=function(){var e=h.getInternetExplorerMajorVersion.cached="undefined"!=typeof h.getInternetExplorerMajorVersion.cached?h.getInternetExplorerMajorVersion.cached:function(){for(var e=3,t=i.createElement("div"),n=t.getElementsByTagName("i");(t.innerHTML="<!--[if gt IE "+ ++e+"]><i></i><![endif]-->")&&n[0];);return e>4?e:!1}();return e},h.isInternetExplorer=function(){var e=h.isInternetExplorer.cached="undefined"!=typeof h.isInternetExplorer.cached?h.isInternetExplorer.cached:Boolean(h.getInternetExplorerMajorVersion());return e},h.emulated={pushState:!Boolean(e.history&&e.history.pushState&&e.history.replaceState&&!/ Mobile\/([1-7][a-z]|(8([abcde]|f(1[0-8]))))/i.test(o.userAgent)&&!/AppleWebKit\/5([0-2]|3[0-2])/i.test(o.userAgent)),hashChange:Boolean(!("onhashchange"in e||"onhashchange"in i)||h.isInternetExplorer()&&h.getInternetExplorerMajorVersion()<8)},h.enabled=!h.emulated.pushState,h.bugs={setHash:Boolean(!h.emulated.pushState&&"Apple Computer, Inc."===o.vendor&&/AppleWebKit\/5([0-2]|3[0-3])/.test(o.userAgent)),safariPoll:Boolean(!h.emulated.pushState&&"Apple Computer, Inc."===o.vendor&&/AppleWebKit\/5([0-2]|3[0-3])/.test(o.userAgent)),ieDoubleCheck:Boolean(h.isInternetExplorer()&&h.getInternetExplorerMajorVersion()<8),hashEscape:Boolean(h.isInternetExplorer()&&h.getInternetExplorerMajorVersion()<7)},h.isEmptyObject=function(e){for(var t in e)return!1;return!0},h.cloneObject=function(e){var t,n;return e?(t=d.stringify(e),n=d.parse(t)):n={},n},h.getRootUrl=function(){var e=i.location.protocol+"//"+(i.location.hostname||i.location.host);return i.location.port&&(e+=":"+i.location.port),e+="/"},h.getBaseHref=function(){var e=i.getElementsByTagName("base"),t=null,n="";return 1===e.length&&(t=e[0],n=t.href.replace(/[^\/]+$/,"")),n=n.replace(/\/+$/,""),n&&(n+="/"),n},h.getBaseUrl=function(){var e=h.getBaseHref()||h.getBasePageUrl()||h.getRootUrl();return e},h.getPageUrl=function(){var e,t=h.getState(!1,!1),n=(t||{}).url||i.location.href;return e=n.replace(/\/+$/,"").replace(/[^\/]+$/,function(e,t,n){return/\./.test(e)?e:e+"/"})},h.getBasePageUrl=function(){var e=i.location.href.replace(/[#\?].*/,"").replace(/[^\/]+$/,function(e,t,n){return/[^\/]$/.test(e)?"":e}).replace(/\/+$/,"")+"/";return e},h.getFullUrl=function(e,t){var n=e,i=e.substring(0,1);return t="undefined"==typeof t?!0:t,/[a-z]+\:\/\//.test(e)||(n="/"===i?h.getRootUrl()+e.replace(/^\/+/,""):"#"===i?h.getPageUrl().replace(/#.*/,"")+e:"?"===i?h.getPageUrl().replace(/[\?#].*/,"")+e:t?h.getBaseUrl()+e.replace(/^(\.\/)+/,""):h.getBasePageUrl()+e.replace(/^(\.\/)+/,"")),n.replace(/\#$/,"")},h.getShortUrl=function(e){var t=e,n=h.getBaseUrl(),i=h.getRootUrl();return h.emulated.pushState&&(t=t.replace(n,"")),t=t.replace(i,"/"),h.isTraditionalAnchor(t)&&(t="./"+t),t=t.replace(/^(\.\/)+/g,"./").replace(/\#$/,"")},h.store={},h.idToState=h.idToState||{},h.stateToId=h.stateToId||{},h.urlToId=h.urlToId||{},h.storedStates=h.storedStates||[],h.savedStates=h.savedStates||[],h.normalizeStore=function(){h.store.idToState=h.store.idToState||{},h.store.urlToId=h.store.urlToId||{},h.store.stateToId=h.store.stateToId||{}},h.getState=function(e,t){"undefined"==typeof e&&(e=!0),"undefined"==typeof t&&(t=!0);var n=h.getLastSavedState();return!n&&t&&(n=h.createStateObject()),e&&(n=h.cloneObject(n),n.url=n.cleanUrl||n.url),n},h.getIdByState=function(e){var t,n=h.extractId(e.url);if(!n)if(t=h.getStateString(e),"undefined"!=typeof h.stateToId[t])n=h.stateToId[t];else if("undefined"!=typeof h.store.stateToId[t])n=h.store.stateToId[t];else{for(;n=(new Date).getTime()+String(Math.random()).replace(/\D/g,""),"undefined"!=typeof h.idToState[n]||"undefined"!=typeof h.store.idToState[n];);h.stateToId[t]=n,h.idToState[n]=e}return n},h.normalizeState=function(e){var t,n;return e&&"object"==typeof e||(e={}),"undefined"!=typeof e.normalized?e:(e.data&&"object"==typeof e.data||(e.data={}),t={},t.normalized=!0,t.title=e.title||"",t.url=h.getFullUrl(h.unescapeString(e.url||i.location.href)),t.hash=h.getShortUrl(t.url),t.data=h.cloneObject(e.data),t.id=h.getIdByState(t),t.cleanUrl=t.url.replace(/\??\&_suid.*/,""),t.url=t.cleanUrl,n=!h.isEmptyObject(t.data),(t.title||n)&&(t.hash=h.getShortUrl(t.url).replace(/\??\&_suid.*/,""),/\?/.test(t.hash)||(t.hash+="?"),t.hash+="&_suid="+t.id),t.hashedUrl=h.getFullUrl(t.hash),(h.emulated.pushState||h.bugs.safariPoll)&&h.hasUrlDuplicate(t)&&(t.url=t.hashedUrl),t)},h.createStateObject=function(e,t,n){var i={data:e,title:t,url:n};return i=h.normalizeState(i)},h.getStateById=function(e){e=String(e);var n=h.idToState[e]||h.store.idToState[e]||t;return n},h.getStateString=function(e){var t,n,i;return t=h.normalizeState(e),n={data:t.data,title:e.title,url:e.url},i=d.stringify(n)},h.getStateId=function(e){var t,n;return t=h.normalizeState(e),n=t.id},h.getHashByState=function(e){var t,n;return t=h.normalizeState(e),n=t.hash},h.extractId=function(e){var t,n,i;return n=/(.*)\&_suid=([0-9]+)$/.exec(e),i=n?n[1]||e:e,t=n?String(n[2]||""):"",t||!1},h.isTraditionalAnchor=function(e){var t=!/[\/\?\.]/.test(e);return t},h.extractState=function(e,t){var n,i,o=null;return t=t||!1,n=h.extractId(e),n&&(o=h.getStateById(n)),o||(i=h.getFullUrl(e),n=h.getIdByUrl(i)||!1,n&&(o=h.getStateById(n)),!o&&t&&!h.isTraditionalAnchor(e)&&(o=h.createStateObject(null,null,i))),o},h.getIdByUrl=function(e){var n=h.urlToId[e]||h.store.urlToId[e]||t;return n},h.getLastSavedState=function(){return h.savedStates[h.savedStates.length-1]||t},h.getLastStoredState=function(){return h.storedStates[h.storedStates.length-1]||t},h.hasUrlDuplicate=function(e){var t,n=!1;return t=h.extractState(e.url),n=t&&t.id!==e.id},h.storeState=function(e){return h.urlToId[e.url]=e.id,h.storedStates.push(h.cloneObject(e)),e},h.isLastSavedState=function(e){var t,n,i,o=!1;return h.savedStates.length&&(t=e.id,n=h.getLastSavedState(),i=n.id,o=t===i),o},h.saveState=function(e){return h.isLastSavedState(e)?!1:(h.savedStates.push(h.cloneObject(e)),!0)},h.getStateByIndex=function(e){var t=null;return t="undefined"==typeof e?h.savedStates[h.savedStates.length-1]:0>e?h.savedStates[h.savedStates.length+e]:h.savedStates[e]},h.getHash=function(){var e=h.unescapeHash(i.location.hash);return e},h.unescapeString=function(t){for(var n,i=t;n=e.unescape(i),n!==i;)i=n;return i},h.unescapeHash=function(e){var t=h.normalizeHash(e);return t=h.unescapeString(t)},h.normalizeHash=function(e){var t=e.replace(/[^#]*#/,"").replace(/#.*/,"");return t},h.setHash=function(e,t){var n,o,r;return t!==!1&&h.busy()?(h.pushQueue({scope:h,callback:h.setHash,args:arguments,queue:t}),!1):(n=h.escapeHash(e),h.busy(!0),o=h.extractState(e,!0),o&&!h.emulated.pushState?h.pushState(o.data,o.title,o.url,!1):i.location.hash!==n&&(h.bugs.setHash?(r=h.getPageUrl(),h.pushState(null,null,r+"#"+n,!1)):i.location.hash=n),h)},h.escapeHash=function(t){var n=h.normalizeHash(t);return n=e.escape(n),h.bugs.hashEscape||(n=n.replace(/\%21/g,"!").replace(/\%26/g,"&").replace(/\%3D/g,"=").replace(/\%3F/g,"?")),n},h.getHashByUrl=function(e){var t=String(e).replace(/([^#]*)#?([^#]*)#?(.*)/,"$2");return t=h.unescapeHash(t)},h.setTitle=function(e){var t,n=e.title;n||(t=h.getStateByIndex(0),t&&t.url===e.url&&(n=t.title||h.options.initialTitle));try{i.getElementsByTagName("title")[0].innerHTML=n.replace("<","&lt;").replace(">","&gt;").replace(" & "," &amp; ")}catch(o){}return i.title=n,h},h.queues=[],h.busy=function(e){if("undefined"!=typeof e?h.busy.flag=e:"undefined"==typeof h.busy.flag&&(h.busy.flag=!1),!h.busy.flag){s(h.busy.timeout);var t=function(){var e,n,i;if(!h.busy.flag)for(e=h.queues.length-1;e>=0;--e)n=h.queues[e],0!==n.length&&(i=n.shift(),h.fireQueueItem(i),h.busy.timeout=a(t,h.options.busyDelay))};h.busy.timeout=a(t,h.options.busyDelay)}return h.busy.flag},h.busy.flag=!1,h.fireQueueItem=function(e){return e.callback.apply(e.scope||h,e.args||[])},h.pushQueue=function(e){return h.queues[e.queue||0]=h.queues[e.queue||0]||[],h.queues[e.queue||0].push(e),h},h.queue=function(e,t){return"function"==typeof e&&(e={callback:e}),"undefined"!=typeof t&&(e.queue=t),h.busy()?h.pushQueue(e):h.fireQueueItem(e),h},h.clearQueue=function(){return h.busy.flag=!1,h.queues=[],h},h.stateChanged=!1,h.doubleChecker=!1,h.doubleCheckComplete=function(){return h.stateChanged=!0,h.doubleCheckClear(),h},h.doubleCheckClear=function(){return h.doubleChecker&&(s(h.doubleChecker),h.doubleChecker=!1),h},h.doubleCheck=function(e){return h.stateChanged=!1,h.doubleCheckClear(),h.bugs.ieDoubleCheck&&(h.doubleChecker=a(function(){return h.doubleCheckClear(),h.stateChanged||e(),!0},h.options.doubleCheckInterval)),h},h.safariStatePoll=function(){var t,n=h.extractState(i.location.href);if(!h.isLastSavedState(n))return t=n,t||(t=h.createStateObject()),h.Adapter.trigger(e,"popstate"),h},h.back=function(e){return e!==!1&&h.busy()?(h.pushQueue({scope:h,callback:h.back,args:arguments,queue:e}),!1):(h.busy(!0),h.doubleCheck(function(){h.back(!1)}),p.go(-1),!0)},h.forward=function(e){return e!==!1&&h.busy()?(h.pushQueue({scope:h,callback:h.forward,args:arguments,queue:e}),!1):(h.busy(!0),h.doubleCheck(function(){h.forward(!1)}),p.go(1),!0)},h.go=function(e,t){var n;if(e>0)for(n=1;e>=n;++n)h.forward(t);else{if(!(0>e))throw new Error("History.go: History.go requires a positive or negative integer passed.");for(n=-1;n>=e;--n)h.back(t)}return h},h.emulated.pushState){var f=function(){};h.pushState=h.pushState||f,h.replaceState=h.replaceState||f}else h.onPopState=function(t,n){var o,r,a=!1,s=!1;return h.doubleCheckComplete(),o=h.getHash(),o?(r=h.extractState(o||i.location.href,!0),r?h.replaceState(r.data,r.title,r.url,!1):(h.Adapter.trigger(e,"anchorchange"),h.busy(!1)),h.expectedStateId=!1,!1):(a=h.Adapter.extractEventData("state",t,n)||!1,s=a?h.getStateById(a):h.expectedStateId?h.getStateById(h.expectedStateId):h.extractState(i.location.href),s||(s=h.createStateObject(null,null,i.location.href)),h.expectedStateId=!1,h.isLastSavedState(s)?(h.busy(!1),!1):(h.storeState(s),h.saveState(s),h.setTitle(s),h.Adapter.trigger(e,"statechange"),h.busy(!1),!0))},h.Adapter.bind(e,"popstate",h.onPopState),h.pushState=function(t,n,i,o){if(h.getHashByUrl(i)&&h.emulated.pushState)throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(o!==!1&&h.busy())return h.pushQueue({scope:h,callback:h.pushState,args:arguments,queue:o}),!1;h.busy(!0);var r=h.createStateObject(t,n,i);return h.isLastSavedState(r)?h.busy(!1):(h.storeState(r),h.expectedStateId=r.id,p.pushState(r.id,r.title,r.url),h.Adapter.trigger(e,"popstate")),!0},h.replaceState=function(t,n,i,o){if(h.getHashByUrl(i)&&h.emulated.pushState)throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(o!==!1&&h.busy())return h.pushQueue({scope:h,callback:h.replaceState,args:arguments,queue:o}),!1;h.busy(!0);var r=h.createStateObject(t,n,i);return h.isLastSavedState(r)?h.busy(!1):(h.storeState(r),h.expectedStateId=r.id,p.replaceState(r.id,r.title,r.url),h.Adapter.trigger(e,"popstate")),!0};if(r){try{h.store=d.parse(r.getItem("History.store"))||{}}catch(g){h.store={}}h.normalizeStore()}else h.store={},h.normalizeStore();h.Adapter.bind(e,"beforeunload",h.clearAllIntervals),h.Adapter.bind(e,"unload",h.clearAllIntervals),h.saveState(h.storeState(h.extractState(i.location.href,!0))),r&&(h.onUnload=function(){var e,t;try{e=d.parse(r.getItem("History.store"))||{}}catch(n){e={}}e.idToState=e.idToState||{},e.urlToId=e.urlToId||{},e.stateToId=e.stateToId||{};for(t in h.idToState)h.idToState.hasOwnProperty(t)&&(e.idToState[t]=h.idToState[t]);for(t in h.urlToId)h.urlToId.hasOwnProperty(t)&&(e.urlToId[t]=h.urlToId[t]);for(t in h.stateToId)h.stateToId.hasOwnProperty(t)&&(e.stateToId[t]=h.stateToId[t]);h.store=e,h.normalizeStore(),r.setItem("History.store",d.stringify(e))},h.intervalList.push(l(h.onUnload,h.options.storeInterval)),h.Adapter.bind(e,"beforeunload",h.onUnload),h.Adapter.bind(e,"unload",h.onUnload)),h.emulated.pushState||(h.bugs.safariPoll&&h.intervalList.push(l(h.safariStatePoll,h.options.safariPollInterval)),("Apple Computer, Inc."===o.vendor||"Mozilla"===(o.appCodeName||""))&&(h.Adapter.bind(e,"hashchange",function(){h.Adapter.trigger(e,"popstate")}),h.getHash()&&h.Adapter.onDomLoad(function(){h.Adapter.trigger(e,"hashchange")})))},h.init())}(window),function(e){e.fn.hoverIntent=function(t,n,i){var o={interval:100,sensitivity:7,timeout:0};o="object"==typeof t?e.extend(o,t):e.isFunction(n)?e.extend(o,{over:t,out:n,selector:i}):e.extend(o,{over:t,out:t,selector:n});var r,a,s,l,c=function(e){r=e.pageX,a=e.pageY},d=function(t,n){return n.hoverIntent_t=clearTimeout(n.hoverIntent_t),Math.abs(s-r)+Math.abs(l-a)<o.sensitivity?(e(n).off("mousemove.hoverIntent",c),n.hoverIntent_s=1,o.over.apply(n,[t])):(s=r,l=a,n.hoverIntent_t=setTimeout(function(){d(t,n)},o.interval),void 0)},u=function(e,t){return t.hoverIntent_t=clearTimeout(t.hoverIntent_t),t.hoverIntent_s=0,o.out.apply(t,[e])},h=function(t){var n=jQuery.extend({},t),i=this;i.hoverIntent_t&&(i.hoverIntent_t=clearTimeout(i.hoverIntent_t)),"mouseenter"==t.type?(s=n.pageX,l=n.pageY,e(i).on("mousemove.hoverIntent",c),1!=i.hoverIntent_s&&(i.hoverIntent_t=setTimeout(function(){d(n,i)},o.interval))):(e(i).off("mousemove.hoverIntent",c),1==i.hoverIntent_s&&(i.hoverIntent_t=setTimeout(function(){u(n,i)},o.timeout)))};return this.on({"mouseenter.hoverIntent":h,"mouseleave.hoverIntent":h},o.selector)}}(jQuery),function(){var e=function(e){var t,n=!1,i=e.offset||0,o="offset",r=e.distance||50,a=!1,s=e.url||"";if(s){var l=s.match(/(\w+)=\{\{offset\}\}/);l&&(o=l[1]),s.replace(/([\?\&]\w+=\{\{offset\}\}$|\w+=\{\{offset\}\}&?)/,"")}var c;return{init:function(){for(var t=this,n=this;n.length;){if(n.is("body")){n=void 0;break}if(["scroll","auto"].contains(n.css("overflow"))||["scroll","auto"].contains(n.css("overflow-y"))){this.data("lazyload-scrollable",n);break}n=n.parent()}c=function(){setTimeout(function(){t.check()})},!i&&e.selector&&(i=t.find(e.selector).length),t.data("lazyload-config",e),(n||jQuery(window)).on("scroll.lazyload resize.lazyload",c),jQuery("body").on("chess24:show",c),t.on("chess24:lazyloaddone",c),t.check()},check:function(){if(this.is(":visible")){var e=this.data("lazyload-scrollable");if(e)if("absolute"===this.css("position"))var t=this.position().top+this.outerHeight(),n=e.outerHeight();else var t=this.outerHeight()-e.prop("scrollTop"),n=e.outerHeight();else var t=this.offset().top+this.height(),n=(jQuery("body").scrollTop()||document.documentElement.scrollTop)+window.innerHeight;r>=t-n?a||this.work():a&&(a=!1)}},work:function(){var r=this;if(!n){if(s&&(e.selector||e.array)){n=!0;var l=Object.extend(e.data||{});l[o]=i,r.data("xhr")&&r.data("xhr").abort(),t=jQuery.getJSON(s,l,function(t){if(e.array&&Array.isArray(t.data[e.array]))var o=t.data[e.array].length;else if(e.selector&&t.data.html){var s=jQuery(t.data.html);o=s.find(e.selector).add(s.filter(e.selector)).length}else o=0;o?i+=o:c&&r.reset(),n=!1,"function"==typeof e.onload&&e.onload.call(r,t),a=!1,r.trigger("chess24:lazyloaddone",t)}).fail(function(t){try{var n=jQuery.parseJSON(t.responseText)}catch(i){n={}}"function"==typeof e.onerror&&e.onerror.call(r,n),r.trigger("chess24:lazyloaderror")}),r.data("xhr",t),a=!0}else{a=!0;var d=function(e){a=!1,e?r.check():r.reset()}}"function"==typeof e.onstart&&e.onstart.call(r,d),this.trigger("chess24:lazyloadstart",d)}},reset:function(){this.data("xhr")&&this.data("xhr").abort();var e=this.data("lazyload-scrollable");return e?(e.off("scroll.lazyload resize.lazyload",c),e.off("chess24:show",c)):(jQuery(window).off("scroll.lazyload resize.lazyload",c),jQuery("body").off("chess24:show",c)),this.off("chess24:lazyloaddone",c),this}}};jQuery.fn.lazyload=function(t){return"string"==typeof t?["refresh","reset"].contains(t)&&this.each(function(){var n=jQuery(this),i=n.data("lazyload-config");if(i){var o=jQuery.extend(n,e(i));"refresh"==t?o.reset().init():"reset"==t&&o.reset()}}):(t=t||{},this.each(function(){jQuery.extend(jQuery(this),e(t)).init()})),this}}(),function(){var e={colorLine:"#a7cb45",colorGrid:"#eee",colorAxis:"#ccc",colorAxisNode:"#888",left:30,right:5,top:5,bottom:50,drawLabels:!0,drawAxes:!0,xLabelCount:15,xLabelCallback:void 0},n=function(e){e=jQuery(e).get(0);var t=e.getContext("2d");return t.lineWidth=1,{clear:function(){return e.width=e.width,this},path:function(e,n){if(0===e.length)return this;t.strokeStyle=n,t.beginPath(),t.moveTo(e[0][0],e[0][1]);for(var i=1;i<e.length;i++)t.lineTo(e[i][0],e[i][1]);return t.stroke(),this},circle:function(e,n,i){return t.fillStyle=i,t.beginPath(),t.arc(e[0],e[1],n,0,2*Math.PI),t.fill(),this}}},i={init:function(e){return this.html(""),this.canvas=jQuery("<canvas/>").attr("width",this.width()).attr("height",this.height()).appendTo(this),this.data("config",e),this.config=e,this.config.sets={},this.config.display={},this.config.colors={},this.config.width=this.width()-this.config.left-this.config.right,this.config.height=this.height()-this.config.top-this.config.bottom,this.config.yoffset=.05*this.config.height,this.graphics=n(this.canvas),this.hasdata()?(this.setup(),this.clear(),this.drawWires(),this.drawLabels(),this.drawGraph()):(this.clear(),this.empty()),this},catchup:function(){return this.config=this.data("config"),this.canvas=this.find("canvas"),this.graphics=n(this.canvas),this},clear:function(){return this.graphics.clear(),this.find("label,a").remove(),this},setup:function(){var e,t,n=this;for(var i in this.config.sets)if(this.config.display[i]){var o=this.config.sets[i];("undefined"==typeof e||"undefind"!=typeof o.start&&o.start<e)&&(e=o.start),("undefined"==typeof t||"undefined"!=typeof o.start&&o.start>t)&&(t=o.start);for(var r=0;r<o.length;r++)("undefined"==typeof e||e>parseFloat(o[r][0]))&&"undefined"!=typeof o[r][0]&&null!==o[r][0]&&(e=parseFloat(o[r][0])),("undefined"==typeof t||t<parseFloat(o[r][0]))&&"undefined"!=typeof o[r][0]&&null!==o[r][0]&&(t=parseFloat(o[r][0]))}var a,s,l=function(e){return!!(""+e).match(/^-?\d+$/)},c=function(e){for(var t=11;t>=2;t--)if(l(e/t))return e/t},d=!1;if(l(e)&&l(t))a=c(t-e),a?s=(t-e)/a:"undefined"==typeof a?(t++,a=c(t-e),s=(t-e)/a):(a=0,s=0);else{for(var u=t,h=e,p=0;!l(u)||!l(h);)u*=10,h*=10,p++;a=c(u-h),a?(a/=Math.pow(10,p),s=Math.round((t-e)/a)):"undefined"==typeof a?(u++,t+=1/Math.pow(10,p),a=c(u-h),s=Math.round((t-e)/a)):(a=0,s=0),d=!0}this.ylabels=[];for(var r=0;s>=r;r++)this.ylabels.push((e+r*a).toFixed(d?1:0));var f=this.count();this.xpoints=[];for(var a=Math.ceil(this.count()/this.config.xLabelCount),r=0;f>r;r+=a)this.xpoints.push(r);var g=t!==e?(this.config.height-2*this.config.yoffset)/(t-e):0,m=f>1?this.config.width/(f-1):this.config.width;return this.xcoord=function(e){return n.config.left+e*m},this.ycoord=function(i,o){return n.config.top+(n.config.height-n.config.yoffset)-g*(void 0!==o?(t-e)*o:parseFloat(i)-e)},this},createMarker:function(e,t){var n=this;if(null===this.config.sets[e][t][0]||"undefined"==typeof this.config.sets[e][t][0]||!this.config.display[e])return this;var i=this.xcoord(t),o=this.ycoord(this.config.sets[e][t][0]),r=jQuery("<a/>").addClass("marker").appendTo(this).css({left:i+"px",top:o+"px"}).on("mouseover",function(){n.trigger("chartover",{value:n.config.sets[e][t][0],label:n.config.sets[e][t][1],dot:r,setname:e})}).on("click",function(){n.trigger("chartclick",{value:n.config.sets[e][t][0],label:n.config.sets[e][t][1],dot:r,setname:e})});return this},drawWires:function(){var e=this.count();this.graphics.path([[this.config.left,this.config.top],[this.config.left+this.config.width,this.config.top],[this.config.left+this.config.width,this.config.top+this.config.height],[this.config.left,this.config.top+this.config.height],[this.config.left,this.config.top]],this.config.colorAxis);for(var t=0;t<this.ylabels.length;t++){var n=this.ycoord(this.ylabels[t]);this.graphics.path([[this.xcoord(0),n],[this.xcoord(e-1),n]],this.config.colorGrid),this.config.drawAxes&&this.graphics.circle([this.xcoord(0),n],2.5,this.config.colorAxisNode)}for(var t=0;t<this.xpoints.length;t++){var i=this.xcoord(this.xpoints[t]);this.graphics.path([[i,this.config.top],[i,this.config.top+this.config.height]],this.config.colorGrid),this.config.drawAxes&&this.graphics.circle([i,this.config.top+this.config.height],2.5,this.config.colorAxisNode)}return this},drawGraph:function(){var e=this.count();for(var t in this.config.sets)if(this.config.display[t]&&(this.config.sets[t].length||this.config.sets[t].start)){var n,i=this.config.sets[t];n=i.length&&i[0][0]?[[this.xcoord(0),this.ycoord(i[0][0])]]:[[this.xcoord(0),this.ycoord(i.start)]];for(var o=i[0]?i[0][0]||i.start:i.start,r=1;r<i.length;r++)i[r][0]&&(n.push([this.xcoord(r),this.ycoord(i[r][0])]),o=i[r][0]);n.push([this.xcoord(e>1?e-1:1),this.ycoord(o)]),this.graphics.path(n,this.config.colors[t]);for(var r=0;r<i.length;r++)this.graphics.circle([this.xcoord(r),this.ycoord(i[r][0])],3.5,this.config.colors[t]),this.createMarker(t,r)}return this},drawLabels:function(){if(!this.config.drawLabels)return this;var e=[];for(var t in this.config.sets)if(this.config.display[t]&&this.config.sets[t].length){for(var n=0;n<this.config.sets[t].length;n++)e.push(this.config.sets[t][n][1]);break}for(var n=0;n<this.xpoints.length;n++){var i=e[this.xpoints[n]];"function"==typeof this.config.xLabelCallback&&(i=this.config.xLabelCallback.call(null,i));var t=jQuery("<label/>").addClass("x").css({left:this.xcoord(this.xpoints[n])+7,top:this.config.top+this.config.height-3}).html(i).appendTo(this);t.css({transform:"translate(-"+t.width()+"px) rotate(-45deg)","-webkit-transform":"translate(-"+t.width()+"px) rotate(-45deg)"})}for(var n=0;n<this.ylabels.length;n++){var t=jQuery("<label/>").addClass("y").css("right",this.config.width+this.config.right+5+"px").html(this.ylabels[n]).appendTo(this);t.css("top",this.ycoord(this.ylabels[n])-t.height()/2+"px")}return this},empty:function(){var e=jQuery("<label/>").addClass("empty"+(this.config.loading?" loading":"")).html(this.config.loading?t("Loading data..."):t("No information to draw a graph")).appendTo(this);return e.css({width:(this.width()||parseInt(this.css("width"),10))+"px",height:(this.height()||parseInt(this.css("height"),10))-parseInt(e.css("padding-top"),10)-parseInt(e.css("padding-bottom"),10)+"px"}),this.config.loading=!1,this},hasdata:function(){var e=!0;for(var t in this.config.sets)if(this.config.display[t]&&(this.config.sets[t].length>0&&null!==this.config.sets[t][0][0]||this.config.sets[t].start)){e=!1;break}return!e},compatible:function(e,t){var n=[];for(var i in this.config.sets)if(i!=t)for(var o=this.config.sets[i],r=0;r<o.length;r++)n.contains(o[r][1])||n.push(o[r][1]);if(n.length)for(var r=0;r<e.length;r++)if(!n.contains(e[r][1]))return!1;return!0},count:function(){var e=[];for(var t in this.config.sets)if(this.config.display[t])for(var n=0;n<this.config.sets[t].length;n++)e.contains(this.config.sets[t][n][1])||e.push(this.config.sets[t][n][1]);return e.length}},o={redraw:function(){this.hasdata()?this.setup().clear().drawWires().drawLabels().drawGraph():this.clear().empty()},path:function(e,t,n,i){if("object"==typeof e&&"undefined"==typeof t&&(t=e,e="default"),"undefined"==typeof i&&(i=!0),!this.compatible(t,e))throw new Error("New path is not compatible with existing data");this.config.sets[e]=t,"undefined"==typeof this.config.display[e]&&(this.config.display[e]=!0),"undefined"==typeof this.config.colors[e]&&(this.config.colors[e]=n||this.config.colorLine),i&&this.redraw()},toggle:function(e,t){for(var n=e.split(" "),i=0;i<n.length;i++)this.config.sets[n[i]]&&(this.config.display[n[i]]="undefined"==typeof t?!this.config.display[n[i]]:t);this.redraw()},reset:function(){for(var e in this.config.sets)this.config.sets[e]=[]}};jQuery.fn.lineChart=function(){if("object"==typeof arguments[0]){var t=arguments[0];this.each(function(){var n=jQuery(this);n.data("graph")||(n.data("graph",!0),jQuery.extend(n,i).init(jQuery.extend({},e,t)))})}else if(arguments[0]){var n=arguments;this.each(function(){var e=jQuery(this);jQuery.extend(e,o),"function"==typeof e[n[0]]&&(jQuery.extend(e,i),e.catchup(),e[n[0]].apply(e,Array.convert(n).slice(1)))})}return this}}(),function(e){e.fn.expandLinks=function(){return this.each(function(){new Linkified(this,{domainWhitelist:["(.+\\.)?chess24.com","(.+\\.)?google\\.[^\\.]+","(.+\\.)?wikipedia\\.[^\\.]+"]})})}}(jQuery),function(){function e(e,t){t.myData.score&&(t.myData.score.me=parseFloat(t.myData.score.me,10),t.myData.score.him=parseFloat(t.myData.score.him,10),t.showScore=!(!t.myData.score.me&&!t.myData.score.him),t.myData.score.me=Controller.Broadcast.scoreToString(t.myData.score.me),t.myData.score.him=Controller.Broadcast.scoreToString(t.myData.score.him));var n=jQuery(r.render("wrapper",t));n.find("a").on("click",function(e){e.stopPropagation()}),n.on("click",function(e){e.preventDefault(),e.stopPropagation()});var i=n.find(".challenges");s?e.children("span.miniProfile").removeClass("online"):new View.Online(n,t.user.online,t.user.uuid).link(notificationHandler);var a=t.user.uuid===config.user().uuid;return a||s?i.remove():(new View.ChallengeButton(i,t.user.uuid,t).link(notificationHandler),i.on("click.closeMiniProfile",function(t){t.preventDefault(),t.stopPropagation(),i.hasClass("cBtnInactive")||e.tooltip("hide")})),a||(config.level().isGuest?(n.find(".sendUserMessage").remove(),n.find(".friendshipButtons").remove()):(n.find(".sendUserMessage").on("click",function(n){n.preventDefault(),n.stopPropagation(),e.tooltip("hide"),new Dialog.UserMessage(t.user.uuid)}),o(n.find(".userActionMenu"),t.user))),n}function n(e){return{user:e.user,myData:e.myData,me:e.user.uuid===config.user().uuid}}function i(e,t,n){errorHandler.warning(new Error("not able to load miniprofile data",n))}function o(e,n){function i(){var e=$(this),t=e.data("related-user"),n=e.data("relation"),i={csrf:config.csrf(),relationType:n,relatedUser:t};jQuery.post(p,i)}function o(e,t){"action_update_buttons"===t.content.sAction&&t.content.sShownUserUuid===n.uuid&&(f.empty(),blockedUserHandler.isBlocked(n.uuid)&&g.removeClass().addClass("cIcon cIconUserBlock"),t.content.aButtons.forEach(function(e,t){switch(e.sButtonRelation){case"Invite":f.append(a()),g.removeClass().addClass("cIcon cIconUser");break;case"Cancel":f.append(s()),g.removeClass().addClass("cIcon cIconUserRequest");break;case"Accept":f.append(l()),g.removeClass().addClass("cIcon cIconUserRequest");break;case"Delete":f.append(c()),g.removeClass().addClass("cIcon cIconUserAccepted");break;case"Block":f.prepend(d());break;case"Unblock":
f.prepend(d())}}))}function a(){return u("cIconUserAdd","Invite")}function s(){var e=jQuery(r.render("userActionMenu.actions.friendshipRequestOutgoing",{relatedUser:n.uuid,label:h("Request")}));return e.find("a").on("click",i),e}function l(){var e=jQuery(r.render("userActionMenu.actions.friendshipRequestIncoming",{relatedUser:n.uuid,label:h("Request")}));return e.find("a").on("click",i),e}function c(){return u("cIconUserDecline","Delete")}function d(){var e=blockedUserHandler.isBlocked(n.uuid)?"Unblock":"Block";return u("cIconUserBlock",e)}function u(e,t){var o=jQuery(r.render("userActionMenu.item",{className:e,relatedUser:n.uuid,relation:t,label:h(t)}));return o.children("a").on("click",i),o}function h(e){switch(e){case"Invite":return t("Add {{userName}} as friend",{"{{userName}}":n.name});case"Request":return t("Pending friendship request",{"{{userName}}":n.name});case"Delete":return t("Remove {{userName}} from friends",{"{{userName}}":n.name});case"Message":return t("Send message to {{userName}}",{"{{userName}}":n.name});case"Block":return t("Block {{userName}}",{"{{userName}}":n.name});case"Unblock":return t("Unblock {{userName}}",{"{{userName}}":n.name})}}var p="/api/web/UserFriendAPI/UpdateFriendshipRelation";notificationHandler.on("friendship",o),e.append(jQuery(r.render("userActionMenu.main")));var f=e.find("ul"),g=e.find(".icon");f.append(d()),blockedUserHandler.isBlocked(n.uuid)?g.removeClass().addClass("cIcon cIconUserBlock"):n.relation.isFriend?(f.append(c()),g.addClass("cIconUserAccepted")):n.relation.isPending&&n.relation.isOutgoing?(f.append(s()),g.addClass("cIconUserRequest")):n.relation.isPending&&!n.relation.isOutgoing?(f.append(l()),g.addClass("cIconUserRequest")):n.isFriend||(f.append(a()),g.addClass("cIconUser"))}var r,a,s,l="miniProfile",c="/api/web/UserAPI/getMiniprofile",d=400,u=/position-([^\s$]+)/;jQuery.fn.addMiniprofile=function(t){return s=s||jQuery("body").data("embed"),this.each(function(){function o(t,o){var s=t.data("uuid");if(!s)return void errorHandler.warning("missing uuid in miniprofile");a=a||new Helper.Cache(1e4),r=r||new Handler.Template(l).append(new Handler.Template);var d=a.get(s);return d&&!d.promise?o(e(t,d)):(d||(d=jQuery.getJSON(c,{userUUID:s,lang:config.language()}).fail(i),a.set(s,d)),void d.done(function(i){var r=n(i.data);a.set(s,r),o(e(t,r))}))}var s=jQuery(this);if(!s.data("initializedMiniprofile")||t){var h=(s.attr("class")||"").match(u);h=h?h[1]:"top",s.tooltip("reset").tooltip({showDelay:d,side:h},o),s.data("initializedMiniprofile",!0)}})}}(),function(){var e={showBg:function(){t++;var e=this,n=jQuery("body > .background");return n.length||(n=jQuery('<div class="background"/>').hide().appendTo("body").css({left:"0px",top:"0px",width:jQuery(window).innerWidth()+"px",height:jQuery(document).innerHeight()+"px"}),jQuery(window).on("resize",function(){n.css({width:jQuery(window).innerWidth()+"px",height:jQuery(document).innerHeight()+"px"})})),n.show(),this.data("modal-persistent")||n.one("click",function(){e.hide()}),this},setAlignX:function(e){return this.data("modal-align-x",jQuery(e).length?jQuery(e):null),this},setAlignY:function(e){return this.data("modal-align-y",jQuery(e).length?jQuery(e):null),this},setPersistent:function(){return this.data("modal-persistent",!0),this},hideBg:function(){return t--,1>t&&jQuery("body > .background").hide(),this},show:function(){var e=this;this.showBg(),this.css({display:"none",height:"auto"});var t,n,i=this.data("modal-align-x"),o=this.data("modal-align-y"),r=function(){t=i?i.offset().left+i.outerWidth()/2:jQuery(window).innerWidth()/2,n=o?o.offset().top-jQuery(document).scrollTop()+o.outerHeight()/2:jQuery(window).innerHeight()/2,e.css({left:t-e.width()/2+"px",top:n-e.height()/2+"px"}),e.trigger("afterReposition")},a=this.height();return r(),this.css({height:"0px",display:"block",overflow:"hidden"}),this.animate({height:a+"px"},51,function(){e.css({height:"auto",overflow:"visible"})}),this.trigger("chess24:show"),jQuery(window).on("resize",r),layout(e),e},hide:function(){var e=this,t=e.data("modal-config")||{};return this.trigger("chess24:hide"),this.animate({height:"0px"},51,function(){e.css({display:"none",height:"auto"}),e.hideBg(),t.destroyOnClose&&e.destroy()}),this},destroy:function(){return this.remove(),this},adjust:function(e){e="undefined"==typeof e?51:e===!1?0:parseInt(e)||51,this.css("height","auto");var t=0,n=0;this.find("> *").each(function(){"absolute"!=jQuery(this).css("position")&&(n+=jQuery(this).innerHeight(),t=Math.max(t,jQuery(this).innerWidth()))}),t=Math.max(t,this.innerWidth()),n=Math.max(n,this.innerHeight());var i=t-this.innerWidth(),o=n-this.innerHeight(),r={};i&&(r.width=t+"px"),o&&(r.height=n+"px");var a,s,l=this.data("modal-align-x"),c=this.data("modal-align-y");return a=l?l.offset().left+l.outerWidth()/2:jQuery(window).innerWidth()/2,s=c?c.offset().top+c.outerHeight()/2:jQuery(window).innerHeight()/2,r.left=a-t/2+"px",r.top=s-n/2+"px",e?this.animate(r,e):this.css(r),this},html:function(e){return jQuery(".bubble-contents",this).html(e),this}},t=0;jQuery.fn.modal=function(t){if(!this.length)return this;t||(t={});var n;if("string"==typeof t){var i=this.hasClass("modal")?this:this.closest(".modal");if(!i.length)return;n=jQuery.extend(i,e),"function"==typeof n[t]&&n[t].apply(n,[].slice.call(arguments,1))}else n=this.is(".modal")?this:this.closest(".modal"),n.length||(n=jQuery('<div class="bubble modal"/>').append(jQuery('<div class="bubble-contents"/>').append(this)).css("width",t.width||"auto").appendTo(".bodyContainer"),this.trigger("modalAttached"),t.classes&&n.find(".bubble-contents").addClass(t.classes),t.close&&n.append(jQuery("<div/>").addClass("btnCloseDialog").append(jQuery("<a/>").on("click",function(e){return n.modal("hide"),!1})))),n.data("modal-config",t),n=jQuery.extend(n,e),t.align&&(n.setAlignX(t.align),n.setAlignY(t.align)),t.alignX&&n.setAlignX(t.alignX),t.alignY&&n.setAlignY(t.alignY),t.persistent&&n.setPersistent(),n.css("display","none"),this.show(),jQuery(this).on("keyup",function(e){return 27==e.keyCode&&n.modal("hide"),!1}),jQuery(this).on("click",function(e){try{e.cancelBubble=!0,e.stopPropagation()}catch(t){}});return n}}(),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?module.exports=e:e(jQuery)}(function(e){function t(t){var r=t||window.event,a=s.call(arguments,1),l=0,c=0,d=0,u=0;return t=e.event.fix(r),t.type="mousewheel","detail"in r&&(d=-1*r.detail),"wheelDelta"in r&&(d=r.wheelDelta),"wheelDeltaY"in r&&(d=r.wheelDeltaY),"wheelDeltaX"in r&&(c=-1*r.wheelDeltaX),"axis"in r&&r.axis===r.HORIZONTAL_AXIS&&(c=-1*d,d=0),l=0===d?c:d,"deltaY"in r&&(d=-1*r.deltaY,l=d),"deltaX"in r&&(c=r.deltaX,0===d&&(l=-1*c)),0!==d||0!==c?(u=Math.max(Math.abs(d),Math.abs(c)),(!o||o>u)&&(o=u),l=Math[l>=1?"floor":"ceil"](l/o),c=Math[c>=1?"floor":"ceil"](c/o),d=Math[d>=1?"floor":"ceil"](d/o),t.deltaX=c,t.deltaY=d,t.deltaFactor=o,a.unshift(t,l,c,d),i&&clearTimeout(i),i=setTimeout(n,200),(e.event.dispatch||e.event.handle).apply(this,a)):void 0}function n(){o=null}var i,o,r=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],a="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],s=Array.prototype.slice;if(e.event.fixHooks)for(var l=r.length;l;)e.event.fixHooks[r[--l]]=e.event.mouseHooks;e.event.special.mousewheel={version:"3.1.6",setup:function(){if(this.addEventListener)for(var e=a.length;e;)this.addEventListener(a[--e],t,!1);else this.onmousewheel=t},teardown:function(){if(this.removeEventListener)for(var e=a.length;e;)this.removeEventListener(a[--e],t,!1);else this.onmousewheel=null}},e.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})}),jQuery(function(){function e(e,n,i){if(n.update)return void(n.update.live&&(e.find(".live").removeClass("live"),e.find('li a[data-value="'+n.update.live+'"]').parent().addClass("live")));if(!n.values&&n.count){n.values=[];for(var o=0;o<n.count;o++)n.values.push(o+1)}n.values||errorHandler.error("Not enough data to build the pager",{options:n},!0),!n.labels&&n.count&&(n.labels=n.values.map(function(e){return e+1})),void 0===n.current&&(n.current=n.values[0]);var r=n.values.findIndex(function(e){return e==n.current}),a=r-(n.margin||0),s=r+(n.margin||0);0>a&&(s-=a,a=0),s>=n.values.length&&(a-=s-n.values.length+1,s=n.values.length-1),0>a&&(a=0);for(var l=[],o=a;s>=o;o++)l.push({value:n.values[o],label:n.labels[o],current:n.values[o]==n.current,live:n.live&&n.values[o]==n.live});var c={leftEllipsis:a>0,rightEllipsis:s<n.values.length-1,leftArrows:r>0,rightArrows:r<n.values.length-1},d=jQuery(t.render("pager"+$suffix,{pages:l,meta:c}));"function"==typeof i&&d.find("a").on("click",function(e){var t=jQuery(this);if(t.is(".disabled"))return void e.stopPropagation();var o,a=t.parent();o=a.is(".goFirst")?n.values[0]:a.is(".goPrev")?n.values[r-1]:a.is(".goNext")?n.values[r+1]:a.is(".goLast")?n.values[n.values.length-1]:t.data("value"),o!==n.current&&i(o),e.stopPropagation()}),n.classes&&d.addClass(n.classes),e.empty().append(d)}var t=new Handler.Template("plugin");jQuery.fn.pager=function(t,n){return this.each(function(){e(jQuery(this),Object.copy(t),n)})}}),function(){function e(e,n){function i(e,t,n){n=n||0;var i=jQuery("<div/>").addClass("chartPieSlice").appendTo(o),r=jQuery("<div/>").addClass("pie"+(t?" "+t:"")).appendTo(i);a>0&&i.css({"-webkit-transform":"rotate("+(a-n)+"deg)","-moz-transform":"rotate("+(a-n)+"deg)",transform:"rotate("+(a-n)+"deg)"}),r.css({"-webkit-transform":"rotate(0deg)","-moz-transform":"rotate(0deg)",transform:"rotate(0deg)"}),setTimeout(function(){r.css({"-webkit-transform":"rotate("+(e+n)+"deg)","-moz-transform":"rotate("+(e+n)+"deg)",transform:"rotate("+(e+n)+"deg)"})}),a+=e}for(var o=jQuery("<div/>").addClass("chartPieContainer"+(n.className?" "+n.className:"")).appendTo(e),r=jQuery("<ul/>").addClass("chartPieLegend").appendTo(e),a=0,s=n.data,l=[],c=0,d=0;d<s.length;d++)l.push(s[d].value),c+=parseInt(s[d].value,10),100==s[d].value&&s[d].color&&o.addClass(s[d].color);if(c>0){l=Math.getPercentages(l);for(var d=0;d<s.length;d++)s[d].value=3.6*l[d]}for(var d=0;d<s.length;d++)s[d].value>120?(i(120,s[d].color),s[d].value>240?(i(120,s[d].color,t),i(s[d].value-240,s[d].color,t)):i(s[d].value-120,s[d].color,t)):i(s[d].value,s[d].color),r.append(jQuery("<li/>").addClass(s[d].color||"").html(s[d].label||s[d].value+"%"));0===a&&(i(120,n.defaultColor||""),i(120,n.defaultColor||"",t),i(120,n.defaultColor||"",t),o.addClass(n.defaultColor||""))}var t=6;jQuery.fn.pieChart=function(t){this.each(function(){e(jQuery(this).empty(),t)})}}(),function(){function e(e,t){function n(){var n=t.getStartPosition().moveRight,o="b"===n?"P":"p",r="b"===n?4:3,a=i(o,r),s=e.find(".enPasantSelect").empty().append(jQuery("<option>&dash;</option>"));a.forEach(function(e){var t=e.replace("4","3").replace("5","6");s.append(jQuery('<option value="'+t+'">'+e+"</option>"))}),s.selectBox("destroy").selectBox()}function i(e,n){for(var i=t.getCurrentPosition().toString(),o=i.split(" "),r=Chess.translate.shortToLongPositionGroup(o[0]).split("/")[n],a=[],s=0;s<r.length;s++)r.substring(s,s+1)===e&&a.push(Chess.getSquare(7-n,s).toString());return a}function o(){var t={K:!1,Q:!1,k:!1,q:!1};return e.find('input[type="checkbox"].castling').each(function(){var e=jQuery(this);e.prop("checked")&&(t[e.attr("name")]=!0)}),t=Object.filter(t,function(e){return e}),t=Object.keys(t),t=t.length?t.join(""):"-"}function r(e,n){var i=t.getCurrentPosition().toString(),o=i.split(" ");o[e]!==n.toString()&&(o[e]=n.toString(),i=o.join(" "),t.setStartPosition(new Chess.Position({fen:i})))}function a(e){var n=jQuery('input[type="checkbox"][name="K"].castling'),i=jQuery('input[type="checkbox"][name="Q"].castling'),o=jQuery('input[type="checkbox"][name="k"].castling'),r=jQuery('input[type="checkbox"][name="q"].castling'),a=t.getCurrentPosition();n.prop("checked",(e||!e&&n.prop("checked"))&&Helper.Chess960.getCastlingRight(a,!0,!0).length>0),i.prop("checked",(e||!e&&i.prop("checked"))&&Helper.Chess960.getCastlingRight(a,!1,!0).length>0),o.prop("checked",(e||!e&&o.prop("checked"))&&Helper.Chess960.getCastlingRight(a,!0,!1).length>0),r.prop("checked",(e||!e&&r.prop("checked"))&&Helper.Chess960.getCastlingRight(a,!1,!1).length>0)}var s=new Handler.Template("plugin");e.html(s.render("positionBuilder"));var l=e.find(".chessBoard");t=t||new Chess.Game,t.setRules("build");var c=new View.ChessBoard(l).link(t),d=new Handler.Position(l,t,{pieces:!0,clear:!0});c.movementHandler.switchMoveConfirm(!1),n(),t.on("movedPositionPointer.start",function(){setTimeout(function(){a(!1),n()})}),e.find('input[type="radio"][name="blackwhitemove"]').change(function(){var e=["w","b"].contains(jQuery(this).val())?jQuery(this).val():"w";r(1,e)}).prop("checked",!1).filter("[value="+t.getMoveRight()+"]").prop("checked",!0),e.find('input[type="checkbox"].castling').change(function(){var e=o();r(2,e)}),e.find(".enPasantSelect").change(function(){var e=jQuery(this).val();r(3,e)}),e.find("input.moveNumber").change(function(){var e=parseInt(jQuery(this).val(),10)||0;r(5,e)}),e.find("input.applyFEN").on("propertychange change click keyup input paste",function(){var t=e.find("a.btnFen");Chess.isValidFen(jQuery(this).val())?t.removeClass("disabled").addClass("enabled"):t.removeClass("enabled").addClass("disabled")}),e.find(".fenInput").on("click","a.btnFen.enabled",function(){var n=e.find("input.applyFEN").val(),i=n.split(" "),o=i[1];jQuery('input[type="radio"][name="blackwhitemove"][value="'+o+'"]').prop("checked",!0);var r=i[4];jQuery("input.moveNumber").val(r),t.setStartPosition(new Chess.Position({fen:n})),a(!0)}),e.find(".btnReset").on("click",function(){t.setStartPosition(new Chess.Position)}),e.find(".btnClear").on("click",function(){d.clear()})}jQuery.fn.positionBuilder=function(t){return this.each(function(){e(jQuery(this).empty(),t)})}}(),function(e){e.fn.puzzle=function(t){function n(){return e(this).is("img")&&(this.complete?i(e(this)):e(this).on("load",function(){i(e(this))})),this}function i(t){function n(){r.onStart&&r.onStart(u),f.show(),p.animate({opacity:r.help?.1:0},"fast");for(var t=0;t<r.rows;t++)for(var n=0;n<r.columns;n++){var a=o-l,g=d-c,m=e("<span></span>").addClass("puzzle-piece").attr("data-num",t+"_"+n).css({width:l+"px",height:c+"px",display:"block",left:Math.floor(Math.random()*(a+1))+"px",top:Math.floor(Math.random()*(g+1))+"px","z-index":Math.floor(10*Math.random()+1),"background-image":'url("'+s+'")',cursor:"move","background-position":-n*l+"px "+-t*c+"px",position:"absolute"}).draggable({start:function(t,n){if(e.data(this,"ok")&&r.fixed)return!1;var i=0;u.find(".puzzle-piece").each(function(){var t=parseInt(e(this).css("z-index"));i=Math.max(t,i)}),e(this).css("z-index",i+1)},revert:"invalid",containment:u}).appendTo(f);e.data(m[0],"ok",!1),e.data(m[0],"lastLocation",f);e("<span></span>").addClass("puzzle-location").attr("data-num",t+"_"+n).css({width:l+"px",height:c+"px",left:n*l+"px",top:t*c+"px",display:"block",position:"absolute"}).droppable({accept:function(t){return t.hasClass("puzzle-piece")&&e(this).is(":empty")&&e(this).parents(".puzzle-game")[0]==t.parents(".puzzle-game")[0]},addClasses:!1,hoverClass:"puzzle-location-hover",drop:function(t,n){var o=e(this);if(n.draggable.appendTo(o),e.data(n.draggable[0],"lastLocation",o),n.draggable.css({left:"0px",top:"0px"}),e.data(n.draggable[0],"ok",!1),o.attr("data-num")==n.draggable.attr("data-num")){e.data(n.draggable[0],"ok",!0),r.fixed&&(n.draggable.css("cursor","default"),e("<span></span>").css({position:"absolute",left:"0px",top:"0px",display:"block",width:"100%",height:"100%","background-color":"#ffffff"}).appendTo(n.draggable).fadeOut("slow",function(){e(this).remove()}));var a=0;u.find(".puzzle-piece").each(function(){return e.data(this,"ok")?void a++:!1}),a==r.rows*r.columns&&i()}}}).appendTo(h)}}function i(){f.hide(),u.find(".puzzle-piece,	.puzzle-location").remove(),p.css("opacity","1"),r.onEnd&&r.onEnd(u)}var o=t.width(),a=t.height(),s=t.attr("src"),l=o/r.columns,c=a/r.rows,d=c>a/2?c:a/2,u=e("<span></span>").css({width:o+"px",display:"inline-block",position:"relative"}).addClass("puzzle-game").insertAfter(t),h=e("<span></span>").css({width:o+"px",height:a+"px",display:"inline-block",position:"relative"}).addClass("puzzle-container").appendTo(u),p=e("<span></span>").css({width:o+"px",height:a+"px",opacity:.1,"background-image":'url("'+s+'")',display:"inline-block"}).addClass("puzzle-image").appendTo(h),f=e("<span></span>").css({width:o+"px",minHeight:d+"px",display:"inline-block",position:"relative"}).addClass("puzzle-box").droppable({accept:".puzzle-piece",addClasses:!1,drop:function(t,n){var i=n.draggable,o=e.data(i[0],"lastLocation");o[0]!=this&&(i.appendTo(e(this)),i.css({left:"+="+o.position().left,top:i.position().top+o.position().top-h.outerHeight()+"px"}),e.data(i[0],"lastLocation",e(this)))}}).hide().insertAfter(h);t.remove(),n()}var o={rows:3,columns:3,help:!0,fixed:!1,onStart:null,onEnd:null},r=e.extend(o,t);return r.rows=Math.max(1,r.rows),r.columns=Math.max(1,r.columns),this.each(n)}}(jQuery),function(e){function t(e){var t=e.__resizeTriggers__,n=t.firstElementChild,i=t.lastElementChild,o=n.firstElementChild;i.scrollLeft=i.scrollWidth,i.scrollTop=i.scrollHeight,o.style.width=n.offsetWidth+1+"px",o.style.height=n.offsetHeight+1+"px",n.scrollLeft=n.scrollWidth,n.scrollTop=n.scrollHeight}function n(e){return e.offsetWidth!=e.__resizeLast__.width||e.offsetHeight!=e.__resizeLast__.height}function i(e){var i=this;t(this),this.__resizeRAF__&&c(this.__resizeRAF__),this.__resizeRAF__=l(function(){n(i)&&(i.__resizeLast__.width=i.offsetWidth,i.__resizeLast__.height=i.offsetHeight,i.__resizeListeners__.forEach(function(t){t.call(i,e)}))})}function o(){if(!a){var e=(b?b:"")+".resize-triggers { "+(C?C:"")+'visibility: hidden; opacity: 0; } .resize-triggers, .resize-triggers > div, .contract-trigger:before { content: " "; display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; } .resize-triggers > div { background: #eee; overflow: auto; } .contract-trigger:before { width: 200%; height: 200%; }',t=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e)),t.appendChild(n),a=!0}}var r=document.attachEvent,a=!1,s=e.fn.resize;if(e.fn.resize=function(e){return this.each(function(){this==window?s.call(jQuery(this),e):addResizeListener(this,e)})},e.fn.removeResize=function(e){return this.each(function(){removeResizeListener(this,e)})},!r){var l=function(){var e=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||function(e){return window.setTimeout(e,20)};return function(t){return e(t)}}(),c=function(){var e=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.clearTimeout;return function(t){return e(t)}}(),d=!1,u="animation",h="",p="animationstart",f="Webkit Moz O ms".split(" "),g="webkitAnimationStart animationstart oAnimationStart MSAnimationStart".split(" "),m="",v=document.createElement("fakeelement");if(void 0!==v.style.animationName&&(d=!0),d===!1)for(var y=0;y<f.length;y++)if(void 0!==v.style[f[y]+"AnimationName"]){m=f[y],u=m+"Animation",h="-"+m.toLowerCase()+"-",p=g[y],d=!0;break}var w="resizeanim",b="@"+h+"keyframes "+w+" { from { opacity: 0; } to { opacity: 0; } } ",C=h+"animation: 1ms "+w+"; "}window.addResizeListener=function(e,n){r?e.attachEvent("onresize",n):(e.__resizeTriggers__||("static"==getComputedStyle(e).position&&(e.style.position="relative"),o(),e.__resizeLast__={},e.__resizeListeners__=[],(e.__resizeTriggers__=document.createElement("div")).className="resize-triggers",e.__resizeTriggers__.innerHTML='<div class="expand-trigger"><div></div></div><div class="contract-trigger"></div>',e.appendChild(e.__resizeTriggers__),t(e),e.addEventListener("scroll",i,!0),p&&e.__resizeTriggers__.addEventListener(p,function(n){n.animationName==w&&t(e)})),e.__resizeListeners__.push(n))},window.removeResizeListener=function(e,t){r?e.detachEvent("onresize",t):(e.__resizeListeners__.splice(e.__resizeListeners__.indexOf(t),1),e.__resizeListeners__.length||(e.removeEventListener("scroll",i),e.__resizeTriggers__=!e.removeChild(e.__resizeTriggers__)))}}(jQuery),function(e){var t=this.SelectBox=function(e,t){if(e instanceof jQuery){if(!(e.length>0))return;e=e[0]}return this.typeTimer=null,this.typeSearch="",this.isMac=navigator.platform.match(/mac/i),t="object"==typeof t?t:{},this.selectElement=e,!t.mobile&&navigator.userAgent.match(/iPad|iPhone|Android|IEMobile|BlackBerry/i)?!1:"select"!==e.tagName.toLowerCase()?!1:void this.init(t)};t.prototype.version="1.2.0",t.prototype.init=function(t){var n=e(this.selectElement);if(n.data("selectBox-control"))return!1;var i=e('<a class="selectBox" />'),o=n.attr("multiple")||parseInt(n.attr("size"))>1,r=t||{},a=parseInt(n.prop("tabindex"))||0,s=this;if(i.width(n.outerWidth()).addClass(n.attr("class")).attr("title",n.attr("title")||"").attr("tabindex",a).css("display","inline-block").bind("focus.selectBox",function(){this!==document.activeElement&&document.body!==document.activeElement&&e(document.activeElement).blur(),i.hasClass("selectBox-active")||(i.addClass("selectBox-active"),n.trigger("focus"))}).bind("blur.selectBox",function(){i.hasClass("selectBox-active")&&(i.removeClass("selectBox-active"),n.trigger("blur"))}),e(window).data("selectBox-bindings")||e(window).data("selectBox-bindings",!0).bind("scroll.selectBox",r.hideOnWindowScroll?this.hideMenus:e.noop).bind("resize.selectBox",this.hideMenus),n.attr("disabled")&&i.addClass("selectBox-disabled"),n.bind("click.selectBox",function(e){i.focus(),e.preventDefault()}),o){if(t=this.getOptions("inline"),i.append(t).data("selectBox-options",t).addClass("selectBox-inline selectBox-menuShowing").bind("keydown.selectBox",function(e){s.handleKeyDown(e)}).bind("keypress.selectBox",function(e){s.handleKeyPress(e)}).bind("mousedown.selectBox",function(t){1===t.which&&(e(t.target).is("A.selectBox-inline")&&t.preventDefault(),i.hasClass("selectBox-focus")||i.focus())}).insertAfter(n),!n[0].style.height){var l=n.attr("size")?parseInt(n.attr("size")):5,c=i.clone().removeAttr("id").css({position:"absolute",top:"-9999em"}).show().appendTo("body");c.find(".selectBox-options").html("<li><a> </a></li>");var d=parseInt(c.find(".selectBox-options A:first").html("&nbsp;").outerHeight());c.remove(),i.height(d*l)}this.disableSelection(i)}else{var u=e('<span class="selectBox-label" />'),h=e('<span class="selectBox-arrow" />');u.attr("class",this.getLabelClass()).text(this.getLabelText()),t=this.getOptions("dropdown"),t.appendTo("BODY"),i.data("selectBox-options",t).addClass("selectBox-dropdown").append(u).append(h).bind("mousedown.selectBox",function(e){1===e.which&&(i.hasClass("selectBox-menuShowing")?s.hideMenus():(e.stopPropagation(),t.data("selectBox-down-at-x",e.screenX).data("selectBox-down-at-y",e.screenY),s.showMenu()))}).bind("keydown.selectBox",function(e){s.handleKeyDown(e)}).bind("keypress.selectBox",function(e){s.handleKeyPress(e)}).bind("open.selectBox",function(e,t){t&&t._selectBox===!0||s.showMenu()}).bind("close.selectBox",function(e,t){t&&t._selectBox===!0||s.hideMenus()}).insertAfter(n);var p=i.width()-h.outerWidth()-(parseInt(u.css("paddingLeft"))||0)-(parseInt(u.css("paddingRight"))||0);u.width(p),this.disableSelection(i)}n.addClass("selectBox").data("selectBox-control",i).data("selectBox-settings",r).hide()},t.prototype.getOptions=function(t){var n,i=e(this.selectElement),o=this,r=function(t,n){return t.children("OPTION, OPTGROUP").each(function(){if(e(this).is("OPTION"))e(this).length>0?o.generateOptions(e(this),n):n.append("<li> </li>");else{var t=e('<li class="selectBox-optgroup" />');t.text(e(this).attr("label")),n.append(t),n=r(e(this),n)}}),n};switch(t){case"inline":return n=e('<ul class="selectBox-options" />'),n=r(i,n),n.find("A").bind("mouseover.selectBox",function(t){o.addHover(e(this).parent())}).bind("mouseout.selectBox",function(t){o.removeHover(e(this).parent())}).bind("mousedown.selectBox",function(e){1===e.which&&(e.preventDefault(),i.selectBox("control").hasClass("selectBox-active")||i.selectBox("control").focus())}).bind("mouseup.selectBox",function(t){1===t.which&&(o.hideMenus(),o.selectOption(e(this).parent(),t))}),this.disableSelection(n),n;case"dropdown":n=e('<ul class="selectBox-dropdown-menu selectBox-options" />'),n=r(i,n),n.data("selectBox-select",i).css("display","none").appendTo("BODY").find("A").bind("mousedown.selectBox",function(t){1===t.which&&(t.preventDefault(),t.screenX===n.data("selectBox-down-at-x")&&t.screenY===n.data("selectBox-down-at-y")&&(n.removeData("selectBox-down-at-x").removeData("selectBox-down-at-y"),/android/i.test(navigator.userAgent.toLowerCase())&&/chrome/i.test(navigator.userAgent.toLowerCase())&&o.selectOption(e(this).parent()),o.hideMenus()))}).bind("mouseup.selectBox",function(t){1===t.which&&(t.screenX!==n.data("selectBox-down-at-x")||t.screenY!==n.data("selectBox-down-at-y"))&&(n.removeData("selectBox-down-at-x").removeData("selectBox-down-at-y"),o.selectOption(e(this).parent()),o.hideMenus())}).bind("mouseover.selectBox",function(t){o.addHover(e(this).parent())}).bind("mouseout.selectBox",function(t){o.removeHover(e(this).parent())});var a=i.attr("class")||"";if(""!==a){a=a.split(" ");for(var s=0;s<a.length;s++)n.addClass(a[s]+"-selectBox-dropdown-menu")}return this.disableSelection(n),n}},t.prototype.getLabelClass=function(){var t=e(this.selectElement).find("OPTION:selected");return("selectBox-label "+(t.attr("class")||"")).replace(/\s+$/,"")},t.prototype.getLabelText=function(){var t=e(this.selectElement).find("OPTION:selected");return t.text()||" "},t.prototype.setLabel=function(){var t=e(this.selectElement),n=t.data("selectBox-control");n&&n.find(".selectBox-label").attr("class",this.getLabelClass()).text(this.getLabelText())},t.prototype.destroy=function(){var t=e(this.selectElement),n=t.data("selectBox-control");if(n){var i=n.data("selectBox-options");i.remove(),n.remove(),t.removeClass("selectBox").removeData("selectBox-control").data("selectBox-control",null).removeData("selectBox-settings").data("selectBox-settings",null).show()}},t.prototype.refresh=function(){var t,n=e(this.selectElement),i=n.data("selectBox-control"),o=i.hasClass("selectBox-dropdown")?"dropdown":"inline";switch(i.data("selectBox-options").remove(),t=this.getOptions(o),i.data("selectBox-options",t),o){case"inline":i.append(t);break;case"dropdown":this.setLabel(),e("BODY").append(t)}"dropdown"===o&&i.hasClass("selectBox-menuShowing")&&this.showMenu()},t.prototype.showMenu=function(){var t=this,n=e(this.selectElement),i=n.data("selectBox-control"),o=n.data("selectBox-settings"),r=i.data("selectBox-options");if(i.hasClass("selectBox-disabled"))return!1;this.hideMenus();var a=parseInt(i.css("borderBottomWidth"))||0,s=parseInt(i.css("borderTopWidth"))||0,l=i.offset(),c=o.topPositionCorrelation?o.topPositionCorrelation:0,d=o.bottomPositionCorrelation?o.bottomPositionCorrelation:0,u=r.outerHeight(),h=i.outerHeight(),p=parseInt(r.css("max-height")),f=e(window).scrollTop(),g=l.top-f,m=e(window).height()-(g+h),v=g>m&&(null==o.keepInViewport?!0:o.keepInViewport),y=v?l.top-u+s+c:l.top+h-a-d;if(p>g&&p>m)if(v){var w=p-(g-5);r.css({"max-height":p-w+"px"}),y+=w}else{var w=p-(m-5);r.css({"max-height":p-w+"px"})}if(r.data("posTop",v),r.width(i.innerWidth()).css({top:y,left:i.offset().left}).addClass("selectBox-options selectBox-options-"+(v?"top":"bottom")),n.triggerHandler("beforeopen"))return!1;var b=function(){n.triggerHandler("open",{_selectBox:!0})};switch(o.menuTransition){case"fade":r.fadeIn(o.menuSpeed,b);break;case"slide":r.slideDown(o.menuSpeed,b);break;default:r.show(o.menuSpeed,b)}o.menuSpeed||b();var C=r.find(".selectBox-selected:first");this.keepOptionInView(C,!0),this.addHover(C),i.addClass("selectBox-menuShowing selectBox-menuShowing-"+(v?"top":"bottom")),e(document).bind("mousedown.selectBox",function(n){if(1===n.which){if(e(n.target).parents().addBack().hasClass("selectBox-options"))return;t.hideMenus()}})},t.prototype.hideMenus=function(){0!==e(".selectBox-dropdown-menu:visible").length&&(e(document).unbind("mousedown.selectBox"),e(".selectBox-dropdown-menu").each(function(){var t=e(this),n=t.data("selectBox-select"),i=n.data("selectBox-control"),o=n.data("selectBox-settings"),r=t.data("posTop");if(n.triggerHandler("beforeclose"))return!1;var a=function(){n.triggerHandler("close",{_selectBox:!0})};if(o){switch(o.menuTransition){case"fade":t.fadeOut(o.menuSpeed,a);break;case"slide":t.slideUp(o.menuSpeed,a);break;default:t.hide(o.menuSpeed,a)}o.menuSpeed||a(),i.removeClass("selectBox-menuShowing selectBox-menuShowing-"+(r?"top":"bottom"))}else e(this).hide(),e(this).triggerHandler("close",{_selectBox:!0}),e(this).removeClass("selectBox-menuShowing selectBox-menuShowing-"+(r?"top":"bottom"));t.css("max-height",""),t.removeClass("selectBox-options-"+(r?"top":"bottom")),t.data("posTop",!1)}))},t.prototype.selectOption=function(t,n){var i=e(this.selectElement);t=e(t);var o=i.data("selectBox-control");i.data("selectBox-settings");if(o.hasClass("selectBox-disabled"))return!1;if(0===t.length||t.hasClass("selectBox-disabled"))return!1;if(i.attr("multiple"))if(n.shiftKey&&o.data("selectBox-last-selected")){t.toggleClass("selectBox-selected");var r;r=t.index()>o.data("selectBox-last-selected").index()?t.siblings().slice(o.data("selectBox-last-selected").index(),t.index()):t.siblings().slice(t.index(),o.data("selectBox-last-selected").index()),r=r.not(".selectBox-optgroup, .selectBox-disabled"),t.hasClass("selectBox-selected")?r.addClass("selectBox-selected"):r.removeClass("selectBox-selected")}else this.isMac&&n.metaKey||!this.isMac&&n.ctrlKey?t.toggleClass("selectBox-selected"):(t.siblings().removeClass("selectBox-selected"),t.addClass("selectBox-selected"));else t.siblings().removeClass("selectBox-selected"),t.addClass("selectBox-selected");o.hasClass("selectBox-dropdown")&&o.find(".selectBox-label").text(t.text());var a=0,s=[];return i.attr("multiple")?o.find(".selectBox-selected A").each(function(){s[a++]=e(this).attr("rel")}):s=t.find("A").attr("rel"),o.data("selectBox-last-selected",t),i.val()!==s&&(i.val(s),this.setLabel(),i.trigger("change")),!0},t.prototype.addHover=function(t){t=e(t);var n=e(this.selectElement),i=n.data("selectBox-control"),o=i.data("selectBox-options");o.find(".selectBox-hover").removeClass("selectBox-hover"),t.addClass("selectBox-hover")},t.prototype.getSelectElement=function(){return this.selectElement},t.prototype.removeHover=function(t){t=e(t);var n=e(this.selectElement),i=n.data("selectBox-control"),o=i.data("selectBox-options");o.find(".selectBox-hover").removeClass("selectBox-hover")},t.prototype.keepOptionInView=function(t,n){if(t&&0!==t.length){var i=e(this.selectElement),o=i.data("selectBox-control"),r=o.data("selectBox-options"),a=o.hasClass("selectBox-dropdown")?r:r.parent(),s=parseInt(t.offset().top-a.position().top),l=parseInt(s+t.outerHeight());n?a.scrollTop(t.offset().top-a.offset().top+a.scrollTop()-a.height()/2):(0>s&&a.scrollTop(t.offset().top-a.offset().top+a.scrollTop()),l>a.height()&&a.scrollTop(t.offset().top+t.outerHeight()-a.offset().top+a.scrollTop()-a.height()))}},t.prototype.handleKeyDown=function(t){var n=e(this.selectElement),i=n.data("selectBox-control"),o=i.data("selectBox-options"),r=n.data("selectBox-settings"),a=0,s=0;if(!i.hasClass("selectBox-disabled"))switch(t.keyCode){case 8:t.preventDefault(),this.typeSearch="";break;case 9:case 27:this.hideMenus(),this.removeHover();break;case 13:i.hasClass("selectBox-menuShowing")?(this.selectOption(o.find("LI.selectBox-hover:first"),t),i.hasClass("selectBox-dropdown")&&this.hideMenus()):this.showMenu();break;case 38:case 37:if(t.preventDefault(),
i.hasClass("selectBox-menuShowing")){var l=o.find(".selectBox-hover").prev("LI");for(a=o.find("LI:not(.selectBox-optgroup)").length,s=0;(0===l.length||l.hasClass("selectBox-disabled")||l.hasClass("selectBox-optgroup"))&&(l=l.prev("LI"),0===l.length&&(l=r.loopOptions?o.find("LI:last"):o.find("LI:first")),!(++s>=a)););this.addHover(l),this.selectOption(l,t),this.keepOptionInView(l)}else this.showMenu();break;case 40:case 39:if(t.preventDefault(),i.hasClass("selectBox-menuShowing")){var c=o.find(".selectBox-hover").next("LI");for(a=o.find("LI:not(.selectBox-optgroup)").length,s=0;(0===c.length||c.hasClass("selectBox-disabled")||c.hasClass("selectBox-optgroup"))&&(c=c.next("LI"),0===c.length&&(c=r.loopOptions?o.find("LI:first"):o.find("LI:last")),!(++s>=a)););this.addHover(c),this.selectOption(c,t),this.keepOptionInView(c)}else this.showMenu()}},t.prototype.handleKeyPress=function(t){var n=e(this.selectElement),i=n.data("selectBox-control"),o=i.data("selectBox-options"),r=this;if(!i.hasClass("selectBox-disabled"))switch(t.keyCode){case 9:case 27:case 13:case 38:case 37:case 40:case 39:break;default:i.hasClass("selectBox-menuShowing")||this.showMenu(),t.preventDefault(),clearTimeout(this.typeTimer),this.typeSearch+=String.fromCharCode(t.charCode||t.keyCode),o.find("A").each(function(){return e(this).text().substr(0,r.typeSearch.length).toLowerCase()===r.typeSearch.toLowerCase()?(r.addHover(e(this).parent()),r.selectOption(e(this).parent(),t),r.keepOptionInView(e(this).parent()),!1):void 0}),this.typeTimer=setTimeout(function(){r.typeSearch=""},1e3)}},t.prototype.enable=function(){var t=e(this.selectElement);t.prop("disabled",!1);var n=t.data("selectBox-control");n&&n.removeClass("selectBox-disabled")},t.prototype.disable=function(){var t=e(this.selectElement);t.prop("disabled",!0);var n=t.data("selectBox-control");n&&n.addClass("selectBox-disabled")},t.prototype.setValue=function(t){var n=e(this.selectElement);n.val(t),t=n.val(),null===t&&(t=n.children().first().val(),n.val(t));var i=n.data("selectBox-control");if(i){var o=n.data("selectBox-settings"),r=i.data("selectBox-options");this.setLabel(),r.find(".selectBox-selected").removeClass("selectBox-selected"),r.find("A").each(function(){if("object"==typeof t)for(var n=0;n<t.length;n++)e(this).attr("rel")==t[n]&&e(this).parent().addClass("selectBox-selected");else e(this).attr("rel")==t&&e(this).parent().addClass("selectBox-selected")}),o.change&&o.change.call(n)}},t.prototype.disableSelection=function(t){e(t).css("MozUserSelect","none").bind("selectstart",function(e){e.preventDefault()})},t.prototype.generateOptions=function(t,n){var i=e("<li />"),o=e("<a />");i.addClass(t.attr("class")),i.data(t.data()),o.attr("rel",t.val()).text(t.text()),i.append(o),t.attr("disabled")&&i.addClass("selectBox-disabled"),t.attr("selected")&&i.addClass("selectBox-selected"),n.append(i)},e.extend(e.fn,{setOptions:function(t){var n=e(this),i=n.data("selectBox-control");switch(typeof t){case"string":n.html(t);break;case"object":n.html("");for(var o in t)if(null!==t[o])if("object"==typeof t[o]){var r=e('<optgroup label="'+o+'" />');for(var a in t[o])r.append('<option value="'+a+'">'+t[o][a]+"</option>");n.append(r)}else{var s=e('<option value="'+o+'">'+t[o]+"</option>");n.append(s)}}i&&e(this).selectBox("refresh")},selectBox:function(n,i){var o;switch(n){case"control":return e(this).data("selectBox-control");case"settings":if(!i)return e(this).data("selectBox-settings");e(this).each(function(){e(this).data("selectBox-settings",e.extend(!0,e(this).data("selectBox-settings"),i))});break;case"options":if(void 0===i)return e(this).data("selectBox-control").data("selectBox-options");e(this).each(function(){e(this).setOptions(i)});break;case"value":if(void 0===i)return e(this).val();e(this).each(function(){(o=e(this).data("selectBox"))&&o.setValue(i)});break;case"refresh":e(this).each(function(){(o=e(this).data("selectBox"))&&o.refresh()});break;case"enable":e(this).each(function(){(o=e(this).data("selectBox"))&&o.enable(this)});break;case"disable":e(this).each(function(){(o=e(this).data("selectBox"))&&o.disable()});break;case"destroy":e(this).each(function(){(o=e(this).data("selectBox"))&&(o.destroy(),e(this).data("selectBox",null))});break;case"instance":return e(this).data("selectBox");default:e(this).each(function(i,o){e(o).data("selectBox")||e(o).data("selectBox",new t(o,n))})}return e(this)}})}(jQuery),function(){var e={facebook:!0,twitter:!0,google:!1,mail:!1,embed:!0},t=function(e){e()};jQuery.fn.shareButtons=function(n,i){function o(){var e=n.url||window.location.href;return e.match(/^https?\:\/\//)||(e=window.location.protocol+"//"+window.location.host+e),e}if("string"!=typeof n)n=jQuery.extend({},e,n),this.each(function(){var e=jQuery(this);if(!e.data("share-buttons")){if(e.data("share-buttons",!0),n.plain)i=e;else{e.addClass("cTooltipBox position-top"),n.noIcon||e.append('<a class="cIcon cIconSocial">'+(n.noLabel?"":window.t("Share"))+"</a>");var i=jQuery('<span class="cTooltipBoxContainer bubbleSocialIcons"/>').appendTo(e)}if(n.facebook){var r=e.find(".facebook");r.length||(r=jQuery('<a title="Facebook" class="cIcon cIconFacebookLarge"></a>').appendTo(i)),r.on("click",function(){t(function(){window.open("https://www.facebook.com/sharer/sharer.php?u="+encodeURIComponent(o()),"facebook","width=400,height=300")})});e.find(".facebookCount")}if(n.twitter!==!1){var a=e.find(".twitter");a.length||(a=jQuery('<a title="Twitter" class="cIcon cIconTwitterLarge"></a>').appendTo(i)),a.on("click",function(){t(function(){window.open("http://twitter.com/home?status="+encodeURIComponent((n.twitter===!0?"":n.twitter+" ")+o()),"twitter","width=400,height=300")})});e.find(".twitterCount")}if(n.google){var s=e.find(".google");s.length||(s=jQuery('<a title="Google+" class="cIcon cIconGoogleLarge"></a>').appendTo(i)),s.on("click",function(){t(function(){window.open("https://plus.google.com/share?url="+encodeURIComponent(o()),"googleplus","width=400,height=300")})});e.find(".googleCount")}if(n.mail){var l=e.find(".mail");l.length||(l=jQuery('<a title="Email" class="cIcon cIconMailLarge"></a>').appendTo(i))}if(n.embed){var c=e.find(".embed");c.length||(c=jQuery('<a title="Embed" class="cIcon cIconEmbedLarge"></a>').appendTo(i)),c.on("click",function(){var t=e.data("embed-data");if(t){var n=jQuery(t.html).modal({close:!0});t.events&&Object.forEach(t.events,function(e,t){Object.forEach(e,function(e,i){var o="*"==i?n:n.find(i);o.on(t,function(){e.apply(this,arguments)})})}),n.modal("show")}else{var i=e.data("embed-url");i||(i=jQuery("head > link[rel=embed-url]").attr("href")),/^http/.test(i)||(i="https://chess24.com"+i);var o='<iframe src="'+i+'" width="980" height="1500" frameborder="0" style="margin:0; padding:0;"></iframe>',n=jQuery("<div/>").addClass("popupInsider socialDialogEmbed").append(jQuery("<div/>").addClass("dialogContent").html('<textarea class="cPattern">'+o+'</textarea><br class="clear"/>')).append(jQuery("<div/>").addClass("dialogFooter"));n.modal({classes:"defaultPopup",close:!0,destroyOnClose:!0}).modal("show"),n.find("textarea").select()}})}}});else switch(n){case"filter":"function"==typeof i&&(t=i)}}}(),function(e){function n(){a=new Date,a.setTime(a.getTime()-36e5*a.getHours()-6e4*a.getMinutes()-1e3*a.getSeconds()-a.getTime()%1e3),s=new Date(a),s.setDate(s.getDate()-1),r=new Date(a),r.setDate(r.getDate()+1),o=new Date(a),o.setDate(o.getDate()+2)}function i(e,n,i,o,r){for(var a=Math.floor((n-i-o.getTime())/1e3),s=new Date(n-1e3*a),u=r?d:c,h=0;h<u.length;h++)if(a<u[h].lessThan&&(!u[h].condition||u[h].condition(s))){var p=o.getHours(),f=o.getMinutes();return 10>p&&(p="0"+p),10>f&&(f="0"+f),e.html(t(u[h].phrase,{"{{n}}":Math.floor(a/u[h].devider),"{{hour}}":p,"{{minute}}":f,"{{day}}":o.getDate(),"{{month}}":o.getMonth()+1,"{{monthENG}}":l[o.getMonth()],"{{year}}":o.getFullYear()})),Math.abs(u[h].devider-a%u[h].devider)}}var o,r,a,s,l=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];e.fn.showAge=function(t,o){return(void 0===a||void 0===s)&&n(),this.each(function(){function n(){var e=Date.now(),t=notificationHandler.getTimeOffset();if(isNaN(t))return void t.done(n);if(r.closest(document.documentElement).length){var s=1e3*i(r,e,t,a,o);1/0>s&&r.data("showAgeTimeout",setTimeout(n,s))}}var r=e(this),a=void 0===t?r.data("created"):t;a instanceof Date||(a=new Date(a));var s=r.data("showAge");if(!s||s.getTime()!==a.getTime()){if(s){var l=r.data("showAgeTimeout");l&&clearTimeout(l)}r.data("showAge",a),n()}})},e.fn.showDateTime=function(t){return this.each(function(){var n=e(this);if(n.data("showDateTime"))return!0;var i=void 0===t?n.data("created"):t;n.html(Helper.getFormatedLocalDateTime(i)),n.data("showDateTime",!0)})},Helper.getFormatedLocalDateTime=function(e,n){e instanceof Date||(e=new Date(e));var i=e.getHours(),o=e.getMinutes(),r=e.getSeconds();return 10>i&&(i="0"+i),10>o&&(o="0"+o),10>r&&(r="0"+r),t(n||Helper.getFormatedLocalDateTimeSeperated.phrases.dateTime,{"{{hour}}":i,"{{minute}}":o,"{{seconds}}":r,"{{day}}":e.getDate(),"{{month}}":e.getMonth()+1,"{{monthENG}}":l[e.getMonth()],"{{year}}":e.getFullYear()})},Helper.getFormatedLocalDateTimeSeperated=function(e){e instanceof Date||(e=new Date(e));var n=e.getHours(),i=e.getMinutes();return 10>n&&(n="0"+n),10>i&&(i="0"+i),{date:t(Helper.getFormatedLocalDateTimeSeperated.phrases.date,{"{{day}}":e.getDate(),"{{month}}":e.getMonth()+1,"{{monthENG}}":l[e.getMonth()],"{{year}}":e.getFullYear()}),time:t(Helper.getFormatedLocalDateTimeSeperated.phrases.time,{"{{hour}}":n,"{{minute}}":i})}},Helper.getFormatedLocalDateTimeSeperated.phrases={date:"{{monthENG}} {{day}}, {{year}}",time:"{{hour}}:{{minute}}",dateTime:"{{monthENG}} {{day}}, {{year}} | {{hour}}:{{minute}}",dateTimeSeconds:"{{monthENG}} {{day}}, {{year}} | {{hour}}:{{minute}}:{{seconds}}"};var c=[{lessThan:-3600,devider:-3600,condition:function(e){return e>=r&&o>e},phrase:"tomorrow at {{hour}}:{{minute}}"},{lessThan:-3600,devider:-3600,condition:function(e){return e>=a&&r>e},phrase:"today at {{hour}}:{{minute}}"},{lessThan:-86400,devider:-3600,phrase:Helper.getFormatedLocalDateTimeSeperated.phrases.dateTime},{lessThan:-120,devider:-60,phrase:"in {{n}} minutes"},{lessThan:-60,devider:-60,phrase:"in {{n}} minute"},{lessThan:0,devider:60,phrase:"in a few seconds"},{lessThan:60,devider:60,phrase:"a few seconds ago"},{lessThan:120,devider:60,phrase:"{{n}} minute ago"},{lessThan:3600,devider:60,phrase:"{{n}} minutes ago"},{lessThan:7200,devider:3600,phrase:"{{n}} hour ago"},{lessThan:86400,devider:3600,phrase:"{{n}} hours ago"},{lessThan:172800,condition:function(e){return e>=s&&a>e},phrase:"yesterday at {{hour}}:{{minute}}"},{lessThan:1/0,devider:1/0,phrase:Helper.getFormatedLocalDateTimeSeperated.phrases.dateTime}],d=[{lessThan:60,devider:60,phrase:"&lt; 1 min"},{lessThan:3600,devider:60,phrase:"{{n}} min"},{lessThan:86400,devider:3600,phrase:"{{n}} h"},{lessThan:1/0,devider:1/0,phrase:"{{monthENG}} {{day}}"}]}(jQuery),function(e){e.fn.shuffle=function(){var t=this.get(),n=function(e){return Math.floor(Math.random()*e)},i=e.map(t,function(){var i=n(t.length),o=e(t[i]).clone(!0)[0];return t.splice(i,1),o});return this.each(function(t){e(this).replaceWith(e(i[t]))}),e(i)}}(jQuery),jQuery.fn.simpleSlideshow=function(e){return this.each(function(){var t=jQuery(this);if(!t.data("simpleslideshow")){t.find("li").each(function(){for(;this.nextSibling&&1!=this.nextSibling.nodeType;)this.parentNode.removeChild(this.nextSibling)}),e=e||{};var n=!1,i=e.width||t.parent().width(),o=function(e){if(!n){n=!0;var o=parseInt(t.css("left"),10),a=o-e*r.outerWidth();if(a>0){var s=Math.ceil(t.outerWidth()/r.outerWidth())*r.outerWidth(),l=o-s+parseInt(r.css("padding-left"),10)+parseInt(r.css("padding-right"),10),c=t.clone(!0).css("left",l+"px").insertBefore(t);t.animate({left:a+"px"},200),c.animate({left:l+i+"px"},200,function(){t.remove(),t=c,n=!1})}else if(-a>=t.outerWidth()){var s=Math.ceil(t.outerWidth()/r.outerWidth())*r.outerWidth(),l=o+s-parseInt(r.css("padding-left"),10)-parseInt(r.css("padding-right"),10),c=t.clone(!0).css("left",l+"px").insertAfter(t);t.animate({left:a+"px"},200),c.animate({left:l-i+"px"},200,function(){t.remove(),t=c,n=!1})}else t.stop().animate({left:a+"px"},200,function(){n=!1})}},r=t.closest("div.simpleSlideshow");if(r.length)r.find(".previous").on("click",function(){o(-1)}),r.find(".next").on("click",function(){o(1)});else{var a=t.outerHeight()+parseInt(t.css("margin-top"),10)+parseInt(t.css("margin-bottom"),10);r=jQuery("<div/>").addClass("simpleSlideshow").css("width",i+"px").css("height",a+"px").insertBefore(t).append(t).append(jQuery("<a/>").addClass("previous").on("click",function(){o(-1)})).append(jQuery("<a/>").addClass("next").on("click",function(){o(1)})),t.is(".externalHandles")&&r.find(".previous,.next").insertBefore(r)}t.css({position:"absolute",left:"0px",top:"0px"}),t.outerWidth()<r.outerWidth()&&r.find(".previous, .next").remove(),t.find("img").each(function(){var e=jQuery(this),t=e.data("src");if(t){var n=new Image;n.src=t;var i=e.attr("src");e.on("mouseenter",function(){e.attr("src",t)}).on("mouseleave",function(){e.attr("src",i)})}});var s=Array.prototype.reduce.call(t.find("li"),function(e,t){var n=jQuery(t);return e+n.outerWidth()+(parseInt(n.css("margin-left"),10)||0)+(parseInt(n.css("margin-right"),10)||0)},0);t.css("width",s+"px"),t.data("scroll-to")&&t.data("scroll-to")>1&&o(t.data("scroll-to")-1),t.data("simpleslideshow",!0)}})},function(){var e={height:200,speed:500,step:500,caption:"off"},t={wrapper:null,controls:null,current:0,init:function(){var e=this,t=this.parent().width();return this.wrapper=this.closest("div.slideshow"),0==this.wrapper.length?this.wrapper=jQuery("<div/>").addClass("slideshow"):(this.insertAfter(this.wrapper),this.wrapper.html("")),this.before(this.wrapper),this.controls={left:jQuery("<div/>").addClass("slideshow-left").appendTo(this.wrapper),right:jQuery("<div/>").addClass("slideshow-right").appendTo(this.wrapper),viewport:jQuery("<div/>").addClass("slideshow-viewport").appendTo(this.wrapper).append(this),caption:"on"==this.config.caption&&"popup"!=this.config.stage?jQuery("<div/>").addClass("slideshow-caption").appendTo(this.wrapper):!1,stage:"off"==this.config.stage||"popup"==this.config.stage?!1:jQuery("<div/>").addClass("slideshow-stage").appendTo(this.wrapper),popup:jQuery("<div/>").addClass("slideshow-popup").appendTo("body").modal({classes:"slideshow-popup"}),current:jQuery("<div/>").addClass("slideshow-current").appendTo(this.wrapper).hide()},this.controls.stage&&(this.controls.stage.append('<div class="image"/>'),this.controls.stage.append('<div class="caption"/>')),this.setupInteractions(),this.adjust(t,this.config.height),this.data("slideshow",this.config),this.config.perpage&&(this.config.step=this.controls.viewport.width()),this.find("li").each(function(){jQuery(this).find("*").hide().end().find(">img,>a").show()}),"popup"!=this.config.stage&&this.find("li:first").trigger("click"),e.data("slideshow",this.config),e},catchup:function(){var e=this,t=e.data("slideshow");return t?(e.config=t,e.wrapper=e.closest(".slideshow"),e.controls={left:e.wrapper.find("> .slideshow-left"),right:e.wrapper.find("> .slideshow-right"),viewport:e.wrapper.find("> .slideshow-viewport"),caption:"on"==e.config.caption&&"popup"!=e.config.stage?e.wrapper.find("> .slideshow-caption"):!1,stage:"off"==e.config.stage||"popup"==e.config.stage?!1:e.wrapper.find("> .slideshow-stage"),popup:jQuery(".slideshow-popup"),current:e.wrapper.find(".slideshow-current")},e.controls.current.length||(e.controls.current=jQuery("<div/>").addClass("slideshow-current").appendTo(this.wrapper).hide()),this.setupInteractions(),this.adjust(this.parent().width(),this.config.height),this.find("li").each(function(){jQuery(this).find("*").hide().end().find(">img,>a").show()}),"popup"!=this.config.stage&&this.find("li:first").trigger("click"),e):e.init()},slideTo:function(e,t){var n=this;if(n.animating)return n;var i=n.width(),o=n.controls.viewport.width();return e=Math.min(0,Math.max(e,o-i)),t?n.css("left",e+"px"):(n.animating=!0,n.animate({left:e+"px"},n.config.speed,"easeOutCirc",function(){n.animating=!1})),n},slideBy:function(e){return e&&this.slideTo(parseInt(this.css("left"))+e),this},setupInteractions:function(){var e=this,t=!1;e.controls.right.off("click").on("click",function(){if(parseInt(e.config.stage))e.current+1<=e.find("li").length&&e.find("li:eq("+(e.current+1)+")").trigger("click");else if(e.config=e.data("slideshow"),1==e.config.perpage){var t=Math.round(-parseInt(e.css("left"))/e.controls.viewport.width());e.find("li:eq("+t+")").next().trigger("click")}else e.slideBy(-e.config.step)}),e.controls.left.off("click").on("click",function(){if(parseInt(e.config.stage))e.current>0&&e.find("li:eq("+(e.current-1)+")").trigger("click");else if(e.config=e.data("slideshow"),1==e.config.perpage){var t=Math.round(-parseInt(e.css("left"))/e.controls.viewport.width());e.find("li:eq("+t+")").prev().trigger("click")}else e.slideBy(+e.config.step)}),e.find("li").off("click").on("click",function(){if(t)return void(t=!1);var n=jQuery(this);e.config=e.data("slideshow");var i=e.controls.viewport.width();if(e.slideTo(-n.position().left+i/2-n.width()/2),e.current=n.prevAll("li").length,e.controls.left[0==e.current?"hide":"show"](),e.controls.right[e.current==e.find("li").length-1?"hide":"show"](),"popup"==e.config.stage)e.popup(e.current);else if(e.controls.stage){var o=e.controls.stage.find(".image"),r=e.controls.stage.find(".caption"),a=n.find("img").clone(),s=a.data("original-src");s&&a.attr("src",s).attr("data-original-src",""),e.controls.stage.find(".image").html("").append(a),a.css("height",e.controls.stage.height()+"px"),a.css("left",o.width()/2-a.width()/2+"px");var l=n.clone().find("> img, >a, .slideshow-current, input[type=hidden]").remove().end().find(":not(:visible)").show().end().contents();r.html("").append(l),o.find("img").on("load",function(){r.css("margin-left",o.width()+"px"),e.controls.current.css("left",n.width()/2-e.controls.current.width()/2),a.css("left",o.width()/2-a.width()/2+"px")}),o.append(jQuery("<a/>").addClass("open").on("click",function(){e.popup(n.prevAll("li").length)}))}e.controls.caption&&e.controls.caption.html(n.clone().find("img").remove().end().html().trim()).find("*").show(),e.controls.current.appendTo(n).css("left",n.width()/2-e.controls.current.width()/2).show()}),e.off("mousedown").on("mousedown",function(n){t=!1,moving=!1;var i=parseInt(e.css("left")),o=n.clientX,r=n.clientX,a=(new Date).getTime(),s=[],l=function(){for(var e=0,t=0,n=s.length-1;n>=0&&!(e+s[n][0]>500);n--)e+=s[n][0],t+=s[n][1];return e?t/e:0};jQuery(document).on("mousemove mouseup",function(n){var l=(new Date).getTime(),c=n.clientX-r;if(!moving&&Math.abs(c)>10&&(moving=!0),moving){e.slideTo(i+n.clientX-o,!0);var d=l-a;s.length>0&&s[s.length-1][1]*c<0?s=[[d,c]]:s.push([d,c]),r=n.clientX,a=l;try{n.preventDefault()}catch(u){n.returnValue=!1}"mousemove"==n.type&&(t=!0)}}).on("mouseup",function(){t||e.slideBy(100*l()),jQuery(document).off("mouseup mousemove")});try{n.preventDefault()}catch(c){n.returnValue=!1}}),e.config.reorder&&e.find(e.config.reorder).off("mousedown").on("mousedown",function(t){var n,i,o=jQuery(jQuery(this).closest("li")),r=jQuery("<div/>").addClass("slideshow-drag-marker").css({height:o.height()+"px",left:parseInt(o.css("left"))-2+"px"}).appendTo(e);return e.find("li").not(o).on("mousemove",function(t){var o=jQuery(this);t.pageX<o.offset().left+o.width()/2?(n=null,i=this,r.css("left",parseInt(o.css("left"))-2+"px")):(n=this,i=null,r.css("left",parseInt(o.css("left"))+o.width()-1+"px")),t.pageX>e.controls.viewport.offset().left+e.controls.viewport.width()-o.width()?e.slideBy(-o.width()):t.pageX<e.controls.viewport.offset().left+o.width()&&e.slideBy(o.width())}),jQuery(document).one("mouseup",function(t){return e.find("li").off("mousemove"),jQuery(document).off("mouseup"),r.remove(),n?o.insertAfter(n):i&&o.insertBefore(i),e.adjust(void 0,void 0,!0),"function"==typeof e.config.onreorder&&e.config.onreorder(),t.stopPropagation(),t.preventDefault(),!1}),t.stopPropagation(),t.preventDefault(),!1})},adjust:function(e,t,n){var i=this;e||(e=this.wrapper.width()),t||(t=this.config.height),this.wrapper.css({width:e+"px",height:t+"px"});var o=t;"off"==this.config.stage||"popup"==this.config.stage?(this.controls.caption&&(o-=this.controls.caption.height(),this.controls.caption.css("width",e+"px")),this.controls.left.css("height",o+"px"),this.controls.right.css("height",o+"px"),this.controls.viewport.css({height:o+"px",left:"0px",width:e+"px"})):parseInt(this.config.stage)&&(this.controls.stage.css({left:"0px",top:"0px",width:e+"px",height:this.config.stage+"px"}),this.controls.stage.find(".image").css({height:this.config.stage+"px",width:1.5*this.config.stage+"px"}),o-=this.config.stage,this.controls.caption&&(this.controls.caption.css({left:"0px",top:this.config.stage+"px",width:e+"px"}),o-=this.controls.caption.height()),this.controls.left.css({height:this.config.stage+"px",top:"0px"}),this.controls.right.css({height:this.config.stage+"px",top:"0px"}),this.controls.viewport.css({width:e+"px",height:o+"px",top:t-o+"px"}));var r=0;if(this.find("li").each(function(){var a=jQuery(this),s=a.outerWidth()-a.width(),l=a.outerHeight()-a.height();a.add(a.find("img")).css("height",o-l+"px").css("width","auto"),i.config.perpage&&(a.css({width:(i.controls.viewport.width()-s*i.config.perpage)/i.config.perpage+"px"}),a.find("img").width()>a.width()&&a.find("img").css({width:a.width()+"px",height:"auto"})),n?a.animate({left:r+"px"},200):a.css("left",r+"px"),r+=a.innerWidth(),0==a.find("img").width()&&a.find("img").one("load",function(){i.adjust(e,t)})}),this.css({height:o+"px",width:r+"px"}),this.width()>this.controls.viewport.width()&&parseInt(this.css("left"))>this.width()-this.controls.viewport.width()&&this.css("left",this.width()-this.controls.viewport.width()+"px"),this.config.perpage){var a=this.controls.viewport.width()/this.config.perpage,s=(this.config.perpage-this.find("li").length%this.config.perpage)%this.config.perpage;this.css("width",r+a*s+"px")}return i.setupInteractions(),i.controls.stage&&i.controls.stage.find("input[type=hidden]").remove(),i},popup:function(e,t){var n=this,i=n.controls.popup.find(".slideshow-left"),o=n.controls.popup.find(".slideshow-right"),r=n.controls.popup.find(".slideshow-viewport"),a=function(){n.controls.popup.modal("hide")},s=n.controls.popup.find(".bubble-contents");i.length||(i=jQuery("<div/>").addClass("slideshow-left").appendTo(s),o=jQuery("<div/>").addClass("slideshow-right").appendTo(s),r=jQuery("<div/>").addClass("slideshow-viewport").appendTo(s)),i.off("click").one("click",function(t){n.popup(e-1,!0);try{t.cancelBubble=!0,t.stopPropagation()}catch(i){}}),o.off("click").one("click",function(t){n.popup(e+1,!0);try{t.cancelBubble=!0,t.stopPropagation()}catch(i){}});var l=n.find("li:eq("+e+") img");if(!l.length)return t&&a(),n;var c=n.controls.popup.find("img");n.controls.popup.css({width:c.width()+"px",height:c.height()+"px",overflow:"hidden"}),l=l.clone().css("visibility","hidden").on("click",function(){n.popup(e+1,!0)});var d=l.data("original-src");d&&l.attr("src",d).attr("data-original-src",""),l.appendTo(r);var u=function(e){r.find("*").not(l).remove(),l.css({width:"auto",height:"auto"}),l.width()>jQuery(window).width()-200&&l.css("width",jQuery(window).width()-200+"px"),l.height()>jQuery(window).height()-100&&l.css({width:"auto",height:jQuery(window).height()-100+"px"}),i.css({left:"0px",top:"0px",height:r.height()+"px"}),o.css({right:"0px",top:"0px",height:r.height()+"px"}),e&&"load"==e.type&&l.css("visibility","visible");var t=l.width(),a=l.height(),s=jQuery(window).innerWidth()/2-t/2,c=jQuery(window).innerHeight()/2-a/2;l.css("opacity",0),r.css("background","url("+l.attr("src")+") center center"),n.controls.popup.stop().animate({width:t+"px",height:a+"px",left:s+"px",top:c+"px"},100,function(){r.css("background",""),l.css("opacity",1),n.controls.popup.css({width:"auto",height:"auto"})})};return n.controls.popup.modal("show"),u(),l.on("load",u),n}};jQuery.fn.slideshow=function(n){if(0==this.length)return this;var i=jQuery.extend(jQuery(this.get(0)),t);if("string"==typeof n){if(0==i.closest(".slideshow").length)return this;if(i.catchup(),"function"==typeof i[n])return i[n].apply(i,[].slice.call(arguments,1))}else{if(!i.is("ul"))return this;i.config=jQuery.extend({},e,n||{}),i.closest(".slideshow").length>0?i.catchup():i.init()}return this}}(),jQuery.fn.sortableTable=function(e){function t(e,t,n){e.removeClass("sortAsc sortDesc").data("sortable-sort",!1),t.addClass("sort"+n.substr(0,1).toUpperCase()+n.substr(1)).data("sortable-sort",n)}function n(e){var t=e.find("th a.sortCol");if(!t.length)do{var n=e.parent().closest("table");t=n.find("> thead th a.sortCol")}while(n.length&&!t.length);return t}var i="pattern-sortable",o="sortable-reverse",r="sortable-cells",a="desc",s="asc";if("getCurrentSort"===e){$handles=n(jQuery(this)).filter(".sortDesc, .sortAsc");var l={};return l[$handles.parent().index()]=$handles.hasClass("sortDesc")?"sortDesc":"sortAsc",l}return this.each(function(){function e(){var e=jQuery(this);e.data(r,e.find("td").map(function(e){var t=jQuery(this),n=t.data("sortable-value");return void 0===n&&(n=t.text().trim().toLowerCase()),h[e]&&(n=(""+n).replace(h[e],"$1")),d[e]=u[e]||d[e]&&(!isNaN(n)||!!n.match(/^\s*[-+]?[0-9]*\.?[0-9]+([eE][-+]?[0-9]+)?\s*$/)),n}))}function l(e,t,n){if(e.length){var i=e.sort(function(e,i){var o=jQuery(e).data(r)[t],a=jQuery(i).data(r)[t];return d[t]&&(o=parseInt(o,10),a=parseInt(a,10)),(n===s?1:-1)*(a>o?-1:o>a?1:0)}),o=c.find(i).eq(0);if(o.length)var a=jQuery("<tr/>").insertBefore(o);else a=jQuery("<tr/>").appendTo(c);i.detach(),a.after(i).remove(),e=i}}var c=jQuery(this);if(!c.data(i)){c.data(i,!0);var d=[],u=[],h=[],p=!!c.data(o),f=n(c);if(f.length){f.on("click",function(){var e=jQuery(this);if(p)var n=e.is(".sortDesc")?s:a;else n=e.is(".sortAsc")?a:s;var i=e.closest("th").prevAll("th").length;l(g,i,n),t(f,e,n)}).each(function(){var e=jQuery(this),t=e.closest("th").prevAll("th").length;d[t]=!0,u[t]=!!e.data("sortable-numeric");var n=e.data("sortable-pattern");h[t]=n?new RegExp(n):void 0});var g=c.find("tr").not(".sortIgnore").filter(function(){return 0===jQuery(this).find("th").length}).each(e);c.on("chess24:add",function(t,n){var i=jQuery(n);if(!i.is("tr"))throw new Exception("only <tr> elements can be inserted into a sortable table");e.call(i),g=g.add(i);var o=f.filter("a.sortCol.sortAsc, a.sortCol.sortDesc"),r=o.is(".sortAsc")?s:o.hasClass("sortDesc")?a:"";if([s,a].contains(r)){var d=o.closest("th").prevAll("th").length;l(g,d,r)}else p?c.prepend(i):c.append(i)}),c.on("chess24:remove",function(e,t){g=g.filter(function(){return!jQuery(this).is(t)}),jQuery(t).remove()});var m=f.filter(".sortDesc, .sortAsc").eq(0);if(m.length){var v=m.hasClass("sortAsc")?s:a;l(g,m.parent().index(),v),t(f,m,v)}}}})},function(){var e={url:"",autoPlay:!1,volume:100,loop:!1},t={init:function(t){this.html("").addClass("soundPlayer"),this.config=jQuery.extend({},e,t),this.controls=this.buildHtml(),this.setupControls(),this.load(!!this.config.autoPlay),this.volume(parseInt(this.config.volume)||100)},buildHtml:function(){var e={},t=jQuery("<ul/>").addClass("ulPlaySet preventSelection").appendTo(this),n=jQuery("<li/>").addClass("playpause").appendTo(t),i=jQuery("<li/>").addClass("progress").appendTo(t),o=jQuery("<li/>").addClass("time").appendTo(t),r=jQuery("<li/>").addClass("label").appendTo(t);e.playpause=jQuery("<a/>").addClass("fp-play gameVideoControlIcon iconPlay").html(window.t("Play/Resume")).appendTo(n);var a=jQuery("<div/>").addClass("timelineContainer").appendTo(i);e.progress=jQuery("<div/>").addClass("fp-timeline").appendTo(a),e.buffer=jQuery("<div/>").addClass("fp-buffer").appendTo(e.progress),e.progressPos=jQuery("<div/>").addClass("fp-progress").appendTo(e.progress);var s=jQuery("<div/>").addClass("fp-time").appendTo(o);e.timeElapsed=jQuery("<em/>").addClass("fp-elapsed").html("00:00").appendTo(s).after('<em class="fp-separator">/</em>'),e.timeRemaining=jQuery("<em/>").addClass("fp-remaining").html("00:00").appendTo(s),e.timeDuration=jQuery("<em/>").addClass("fp-duration").html("00:00").appendTo(s),e.label=jQuery("<span/>").appendTo(r);var l=jQuery("<li/>").addClass("mute").appendTo(t),c=jQuery("<li/>").addClass("volume").appendTo(t);return e.volume=jQuery("<div/>").addClass("fp-volumeslider").appendTo(c),e.volumePos=jQuery("<div/>").addClass("fp-volumelevel").appendTo(e.volume),e.mute=jQuery("<a/>").addClass("fp-mute gameVideoControlIcon iconUnmute").html(window.t("Mute")).appendTo(l),e},position:function(e,t){return this.sound?"undefined"==typeof e?this.sound.position:(this.controls.progressPos.css("width",e+"%"),this.controls.timeElapsed.html(this.format(this.sound.duration*(e/100))),t||this.sound.setPosition(this.sound.duration*(e/100)),void 0):void 0},format:function(e){e=Math.round(e/1e3);var t=Math.floor(e/60),n=e%60;return t+":"+(10>n?"0":"")+n},volume:function(e){return this.sound?"undefined"==typeof e?this.sound.volume:(this.controls.volumePos.css("width",e+"%"),void this.sound.setVolume(e)):void 0},updateTime:function(){return this.sound?void(this.overridePosition||this.position(this.sound.position/this.sound.duration*100,!0)):void 0},updateLabel:function(){if(!this.sound)return void 0;var e=this.sound.id3.artist||window.t("Unknown"),t=this.sound.id3.title||window.t("Untitled");this.controls.label.html(e+" - "+t)},load:function(e){var t=this;this.sound=soundManager.createSound({id:"mySound2",url:this.config.url}),this.position(0),this.controls.label.html("..."),this.sound.load({onid3:function(){t.updateLabel()},onload:function(){t.updateLabel(),t.position(0),t.readyToPlay=!0,e&&t.play()}})},play:function(){if(!this.sound)return void 0;var e=this;this.sound.play({whileplaying:function(){e.updateTime()},onid3:function(){e.updateLabel()},onload:function(){e.updateLabel(),e.position(0)},onfinish:function(){e.position(0),e.pause()}}),this.controls.playpause.removeClass("iconPlay").addClass("iconPause")},pause:function(){return this.sound?(this.controls.playpause.removeClass("iconPause").addClass("iconPlay"),void this.sound.pause()):void 0},mute:function(e){return this.sound?void this.sound[e?"mute":"unmute"]():void 0},loop:function(e){if(!this.sound)return void 0;var t=this;this.sound.onfinish(function(){e&&(t.sound.position=0,t.sound.play())})},setupControls:function(){var e=this;this.controls.playpause.on("click",function(){e.controls.playpause.hasClass("iconPause")?e.pause():e.play()}),this.controls.volume.on("mousedown",function(t){var n=jQuery(this),i=t.clientX-n.offset().left,o=i/n.width()*100;e.volume(o),jQuery(document).on("mousemove",function(t){var i,o=t.clientX-n.offset().left;i=0>o?0:o>n.width()?100:o/n.width()*100,e.volume(i)}),jQuery(document).one("mouseup",function(){jQuery(document).off("mousemove").off("mouseup")})}),this.controls.progress.on("mousedown",function(t){var n=jQuery(this),i=t.clientX-n.offset().left,o=i/n.width()*100;e.position(o),e.overridePosition=!0;var r=o;jQuery(document).on("mousemove",function(t){var i=t.clientX-n.offset().left;if(!(0>i||i>n.width())){var o=i/n.width()*100;e.position(o,!0),r=o}}),jQuery(document).on("mouseup",function(){e.position(r),jQuery(document).off("mousemove").off("mouseup"),e.overridePosition=void 0})})}};jQuery.fn.soundPlayer=function(e){var n=this;return"object"==typeof e&&(soundManager.setup({debugMode:!1,url:e.swf||e.assetDir()+"/images/swf/soundmanager2.swf"}),soundManager.onready(function(){n.each(function(){var n=jQuery.extend({},jQuery(this),t);n.init(e)})})),this}}(),function(){var e,t;e=this.jQuery||window.jQuery,t=e(window),e.fn.stick_in_parent=function(n){var i,o,r,a,s,l,c,d,u,h,p,f;for(null==n&&(n={}),f=n.sticky_class,l=n.inner_scrolling,p=n.recalc_every,h=n.parent,u=n.offset_top,d=n.spacer,r=n.bottoming,null==u&&(u=0),null==h&&(h=void 0),null==l&&(l=!0),null==f&&(f="is_stuck"),
i=e(document),null==r&&(r=!0),a=function(n,o,a,s,c,g,m,v){var y,w,b,C,k,F,x,T,_,E,S,j;if(!n.data("sticky_kit")){if(n.data("sticky_kit",!0),k=i.height(),x=n.parent(),null!=h&&(x=x.closest(h)),!x.length)throw"failed to find stick parent";if(b=!1,y=!1,S=null!=d?d&&n.closest(d):e("<div />"),T=function(){var e,t,r;if(!v)return k=i.height(),e=parseInt(x.css("border-top-width"),10),t=parseInt(x.css("padding-top"),10),o=parseInt(x.css("padding-bottom"),10),a=x.offset().top+e+t,s=x.height(),b&&(b=!1,y=!1,null==d&&(n.insertAfter(S),S.detach()),n.css({position:"",top:"",width:"",bottom:""}).removeClass(f),r=!0),c=n.offset().top-(parseInt(n.css("margin-top"),10)||0)-u,g=n.outerHeight(!0),m=n.css("float"),S&&S.css({width:n.outerWidth(!0),height:g,display:n.css("display"),"vertical-align":n.css("vertical-align"),"float":m}),r?j():void 0},T(),g!==s)return C=void 0,F=u,E=p,j=function(){var e,h,w,_,j,I;if(!v)return w=!1,null!=E&&(E-=1,0>=E&&(E=p,T(),w=!0)),w||i.height()===k||(T(),w=!0),_=t.scrollTop(),null!=C&&(h=_-C),C=_,b?(r&&(j=_+g+F>s+a,y&&!j&&(y=!1,n.css({position:"fixed",bottom:"",top:F}).trigger("sticky_kit:unbottom"))),c>_&&(b=!1,F=u,null==d&&(("left"===m||"right"===m)&&n.insertAfter(S),S.detach()),e={position:"",width:"",top:""},n.css(e).removeClass(f).trigger("sticky_kit:unstick")),l&&(I=t.height(),g+u>I&&(y||(F-=h,F=Math.max(I-g,F),F=Math.min(u,F),b&&n.css({top:F+"px"}))))):_>c&&(b=!0,e={position:"fixed",top:F},e.width="border-box"===n.css("box-sizing")?n.outerWidth()+"px":n.width()+"px",n.css(e).addClass(f),null==d&&(n.after(S),("left"===m||"right"===m)&&S.append(n)),n.trigger("sticky_kit:stick")),b&&r&&(null==j&&(j=_+g+F>s+a),!y&&j)?(y=!0,"static"===x.css("position")&&x.css({position:"relative"}),n.css({position:"absolute",bottom:o,top:"auto"}).trigger("sticky_kit:bottom")):void 0},_=function(){return T(),j()},w=function(){return v=!0,t.off("touchmove",j),t.off("scroll",j),t.off("resize",_),e(document.body).off("sticky_kit:recalc",_),n.off("sticky_kit:detach",w),n.removeData("sticky_kit"),n.css({position:"",bottom:"",top:"",width:""}),x.position("position",""),b?(null==d&&(("left"===m||"right"===m)&&n.insertAfter(S),S.remove()),n.removeClass(f)):void 0},t.on("touchmove",j),t.on("scroll",j),t.on("resize",_),e(document.body).on("sticky_kit:recalc",_),n.on("sticky_kit:detach",w),setTimeout(j,0)}},s=0,c=this.length;c>s;s++)o=this[s],a(e(o));return this}}.call(this),function(e){e.toJSON="object"==typeof JSON&&JSON.stringify?JSON.stringify:function(t){if(null===t)return"null";var n,i,o,r,a=e.type(t);if("undefined"===a)return void 0;if("number"===a||"boolean"===a)return String(t);if("string"===a)return e.quoteString(t);if("function"==typeof t.toJSON)return e.toJSON(t.toJSON());if("date"===a){var s=t.getUTCMonth()+1,l=t.getUTCDate(),c=t.getUTCFullYear(),d=t.getUTCHours(),u=t.getUTCMinutes(),h=t.getUTCSeconds(),p=t.getUTCMilliseconds();return 10>s&&(s="0"+s),10>l&&(l="0"+l),10>d&&(d="0"+d),10>u&&(u="0"+u),10>h&&(h="0"+h),100>p&&(p="0"+p),10>p&&(p="0"+p),'"'+c+"-"+s+"-"+l+"T"+d+":"+u+":"+h+"."+p+'Z"'}if(n=[],e.isArray(t)){for(i=0;i<t.length;i++)n.push(e.toJSON(t[i])||"null");return"["+n.join(",")+"]"}if("object"==typeof t){for(i in t)if(hasOwn.call(t,i)){if(a=typeof i,"number"===a)o='"'+i+'"';else{if("string"!==a)continue;o=e.quoteString(i)}a=typeof t[i],"function"!==a&&"undefined"!==a&&(r=e.toJSON(t[i]),n.push(o+":"+r))}return"{"+n.join(",")+"}"}}}(jQuery),function(e){e.fn.styleFileUpload=function(){e(this).each(function(){var t=e(this);if(!t.data("pattern-file")){t.data("pattern-file",!0);var n=t.closest(".inputFileUpload"),i=t.data("url"),o=!!i,r=t.data("filters")?t.data("filters").split(","):null,a=t.attr("multiple"),s=null,l=!1,c=n.find(".cBtnIconFileUpload");if(c.data("title",c.html()),o&&!a?n.addClass("uploadImmediate"):a&&n.addClass("uploadMultiple"),c.on("click",function(){if(!a&&l)l=!1,n.find(".fileUploadDetails, .fileUploadProgress, input[type=hidden]").remove(),n.removeClass("inputError fileUploadError uploadReady"),s=null,t.trigger("chess24:cancel");else{var i=e(this).closest(".inputFileUpload").find("input:file");a||i.attr("name")||i.attr("name",n.find("input[type=hidden]").attr("name")),i.click()}}),o){var d=[];if(d.proceed=function(){l=!1,this.length&&this.shift()()},!a){var u=e('<input type="hidden"/>').attr("name",t.attr("name")).val(t.get(0).getAttribute("value")).appendTo(n);t.attr("name","");for(var h=t.get(0).className.split(" "),p=0;p<h.length;p++)"validate["==h[p].substr(0,9)&&(u.addClass(h[p]),t.removeClass(h[p]))}t.fileupload({url:i,dataType:"iframejson",dropZone:e("nothing"),paramName:t.data("name"),converters:{"html iframejson":function(t){return e.parseJSON(e("<div/>").html(t.replace(/\r\n/g,"")).text())},"iframe iframejson":function(t){return e.parseJSON(t.find("body").text())}},add:function(i,u){if(n.removeClass("inputError uploadReady fileUploadError"),t=n.find("input:file"),t.trigger("chess24:add",u),o){if(r&&r.length){u.formData=u.formData||{};for(var h=0;h<r.length;h++){var p=e("#"+r[h]);p.length&&p.val()&&(u.formData[p.attr("name")]=p.val())}}u.formData=u.formData||{},u.formData.csrf||(u.formData.csrf=config.csrf())}if(a){var f,g=n.nextAll(".fileUploadProgress"),m=e("<div/>").addClass("fileUploadProgress").insertAfter(g.length?g.last():n).append(e("<div/>")).append(e("<label/>").html(u.files[0].name).prepend(e("<span>x</span>").on("click",function(){try{f.abort()}catch(e){}n.removeClass("inputError uploadReady fileUploadError"),m.remove()})));o&&(l?d.push(function(){return m.parent().length?(l=!0,s=m,void(f=u.submit())):void d.proceed()}):(l=!0,s=m,f=u.submit()))}else t.attr("name")||t.attr("name",n.find("input[type=hidden]").attr("name")),n.find(".fileUploadDetails, .fileUploadProgress, input[type=hidden]").remove(),u.originalFiles=u.originalFiles.slice(0,1),e('<div class="fileUploadDetails"/>').prependTo(n).append(e("<span>x</span>").on("click",function(){n.removeClass("inputError uploadReady fileUploadError"),n.find("input:file").attr("name")||n.find("input:file").attr("name",n.find("input[type=hidden]").attr("name")),n.find(".fileUploadDetails, .fileUploadProgress").remove(),n.find("input[type=hidden]").val(""),s=null,l=!1;try{f.abort()}catch(e){}c.html(c.data("title")),t.trigger("chess24:cancel")})).append("<label>"+u.files[0].name+"</label>"),o&&(s=e("<div/>").addClass("fileUploadProgress").prependTo(n).append(e("<div/>").addClass("showProgress").css({})),l=!0,u.submit()),c.html(window.t("Cancel"))},done:function(i,o){if(t=n.find("input:file"),!l)return void(s&&(s.remove(),s=null));var r=o.result;s&&s.addClass("uploadReady").find("div").css("width","100%"),n.addClass("uploadReady"),0==r.status&&(a?s.append(e('<input type="hidden"/>').attr("name",t.attr("name")+"[]").val(r.data.reference_id)):(n.append(e('<input type="hidden"/>').attr("name",t.attr("name")).val(r.data.reference_id)),t.attr("name",""),c.html(window.t("Change"))),t.trigger("chess24:done",o)),s=null,d.proceed()},error:function(e,i,o){(l||a)&&(n.addClass("uploadReady"),a||n.addClass("inputError"),s&&(s.find("div").css("width","100%"),s.addClass("fileUploadError uploadReady"),s=null),c.html(c.data("title")),t.trigger("chess24:error",e,i,o),d.proceed())},progressall:function(e,n){if(l){var i=Math.round(n.loaded/n.total*100);s&&s.find("div").css("width",i+"%"),t.trigger("chess24:progress",i)}}})}else t.on("change",function(){var i=e(this).val().split("\\").pop();n.find(".fileUploadDetails").remove(),i.length>0?(c.text(window.t("Change")),n.prepend(e('<div class="fileUploadDetails"/>').append("<span>x</span>").on("click",function(){t.val(""),n.find(".fileUploadDetails").remove(),c.text(c.data("title"))}).append("<label>"+i+"</label>"))):c.text(c.data("title"))})}})}}($),function(e){function t(e,t,n,o){var r=i[e]||i.linear;t.values.forEach(function(e,i){var a=e-n,s=o-n,l=a/s;t.values[i]=Math.round(n+s*r(l))})}function n(e,t,n,i){var r=o[e]||o.linear,a=t-n,s=i-n,l=a/s;return n+s*r(l)}e.fn.styleRangeSlider=function(){jQuery(this).each(function(){function e(e,n){if(p&&w.toggleClass(p,o(w)===u),f&&b.toggleClass(f,o(b)===h),n&&n.values){t(y,n,s,l);var r=n.values;i(w,r[0]==s?u||r[0]+c:r[0]),i(b,r[1]==l?h||r[1]+d:r[1])}}function i(e,t){C?e.find("input").val(t):e.html(t)}function o(e){return C?e.find("input").val():e.html()}var r=jQuery(this);if(!r.data("pattern-slider")){r.data("pattern-slider",!0);var a=r.children(".cPatternSlider"),s=a.data("min-value")||0,l=a.data("max-value")||100,c=a.data("min-append")||"",d=a.data("max-append")||"",u=a.data("min-replace-label"),h=a.data("max-replace-label"),p=a.data("min-replace-class"),f=a.data("max-replace-class"),g=a.data("initial-min-value")||0,m=a.data("initial-max-value")||100,v=parseFloat(a.data("step"))||1,y=a.data("shape")||"linear",w=r.find(".sliderValue-min"),b=r.find(".sliderValue-max"),C=w.find("input").length&&b.find("input").length;i(w,g==s&&(u||g+c)||g),i(b,m==l&&(h||m+d)||m);var k=!1;a.slider({range:!0,min:s,max:l,values:[g,m],step:v,slide:e,change:function(t,n){e(t,n),a.trigger("slidestop",n)},stop:function(e,n){t(y,n,s,l),a.trigger("afterstop",n)}}),C&&w.add(b).find("input").on("keyup",function(e){if(13===e.which){var t=jQuery(this),i=a.slider("values");t.parent().is(w)?i[0]=n(y,parseInt(t.val(),10)||s,s,l):i[1]=n(y,parseInt(t.val(),10)||l,s,l),k=!0,a.slider("values",i)}}),e()}})};var i={slowDown:function(e){return--e*e*e+1},linear:function(e){return e}},o={slowDown:function(e){return 1+Math.cbrt(e-1)},linear:function(e){return e}}}($),jQuery(function(){var e={init:function(){var e=this;this.controls={},this.controls.dropdown=jQuery("<div/>").addClass("suggestFieldDropdown").hide().appendTo("body"),this.config={url:this.data("url")||"",strict:"undefined"!=typeof this.data("strict"),multiple:"undefined"!=typeof this.data("multiple")};var t=this.data("filter");t&&(this.config.filters=(""+t).split(","));for(var n=this.attr("class").split(" "),i=0;i<n.length;i++)"validate["==n[i].substr(0,9)&&n.remove(i);n=n.join(" ");var o=this.prop("disabled");if(this.config.multiple){if(!this.is("div"))return;this.addClass("suggestField");var r=this.data("value");if(r&&r.length){for(var i=0;i<r.length;i++)this.append(this.item(r[i].value,r[i].name));this.trigger("chess24:select")}this.controls.input=this.find("input.suggestField"),this.controls.input.length||(this.controls.input=jQuery('<input type="text"/>').appendTo(this).addClass("suggestField").addClass(n).val(this.data("text-value")||"")),this.adjust()}else if(this.config.strict){if("hidden"!=this.attr("type"))return;this.controls.input=this.next("input.suggestField"),this.controls.input.length||(this.controls.input=this.next(".suggestField").find("input.suggestField")),this.controls.input.length||(this.controls.input=jQuery('<input type="text"/>').insertAfter(this).addClass("suggestField").addClass(n).val(this.data("text-value")||"")),this.updateValues=!0}else if("hidden"==this.attr("type")){var a=this.data("text-field");a&&(this.controls.input=jQuery("#"+a)),this.controls.input.length||(this.controls.input=this.next("input.suggestField")),this.controls.input.length||(this.controls.input=this.parent().next(".suggestField").find("input.suggestField")),this.controls.input.length||(this.controls.input=a?jQuery("#"+a):jQuery('<input type="text"/>').insertAfter(this).val(this.data("text-value")||"")),this.controls.input.addClass("suggestField").addClass("suggestField").addClass(n),this.updateValues=!0}else"text"==this.attr("type")&&(this.controls.input=this,this.updateValues=!1);this.controls.input.prop("disabled",o);var s;this.controls.input.on("keydown keypress keyup",function(t){9===t.keyCode&&t.preventDefault(),clearTimeout(s),s=setTimeout(function(){var n=e.controls.input.val().trim();return e.config.multiple&&""==n&&""==e.lastpattern&&8==t.keyCode&&"keydown"==t.type?void e.backspace():n&&(9==t.keyCode||13==t.keyCode)||","==n.substr(n.length-1)&&e.config.multiple?void e.force(n):void e.search(e.config.filter?e.config.filter(n):n)},20)}),this.controls.input.on("blur",function(){setTimeout(function(){e.cancel()},300)}),this.controls.dropdown.add(this.controls.input).on("click",function(e){try{e.stopPropagation()}catch(t){e.cancelBubble=!0}return!1}),this.data("config",this.config)},reinit:function(){return this.config=this.data("config"),this.controls={dropdown:jQuery(".suggestFieldDropdown"),input:this.find("input.suggestField")},this},setupUx:function(){var e=this;this.controls.dropdown.find("li").on("click",function(){jQuery(this).trigger(":select")}).removeClass("highlighted").first(),this.currentLi=-1;var t=function(){e.controls.dropdown.find("li").removeClass("highlighted"),e.currentLi>=0&&e.controls.dropdown.find("li:eq("+e.currentLi+")").addClass("highlighted")};this.keyhandler||(this.keyhandler=function(n){var i=e.controls.dropdown.find("li").length;switch(n.keyCode){case 38:e.currentLi>=0&&e.currentLi--,t();break;case 40:e.currentLi<i-1&&e.currentLi++,t();break;case 13:e.currentLi>=0&&e.controls.dropdown.find("li:eq("+e.currentLi+")").trigger(":select"),e.controls.input.off("keydown",e.keyhandler);break;case 27:e.cancel(),e.controls.input.off("keydown",e.keyhandler);break;case 9:return e.currentLi>=0&&e.controls.dropdown.find("li:eq("+e.currentLi+")").trigger(":select"),e.controls.input.off("keydown",e.keyhandler),!0;default:return!0}try{n.stopPropagation(),n.preventDefault()}catch(o){n.cancelBubble=!0,n.returnValue=!1}return!1}),this.controls.input.off("keydown",this.keyhandler).on("keydown",this.keyhandler),jQuery(document).one("click",function(){e.cancel()})},search:function(e){if("undefined"==typeof this.lastpattern||this.lastpattern!=e){this.trigger("chess24:change"),this.lastpattern=e;var t=this;this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(function(){t.filterDropdown(e),t.request(e)},100)}},request:function(e){if(this.config.url){var t=this;if(this.lastxhr&&(this.lastxhr.abort(),this.lastxhr=null),!e.trim().length)return this.cancel();var n={pattern:e,csrf:config.csrf()};if(this.config.filters)for(var i=0;i<this.config.filters.length;i++){var o=jQuery("#"+this.config.filters[i]);o.length&&(n[o.attr("name")]=o.val())}this.lastxhr=jQuery.post(this.config.url,n,function(e){if("string"==typeof e)try{e=jQuery.parseJSON(e)}catch(n){e={status:1}}if(0==e.status){if(e.data.events)for(var i=0;i<e.data.events.length;i++)t.trigger("chess24:"+e.data.events[i]);t.render(e.data.result,e.data.template),t.lastxhr=null}})}},render:function(e,t){var n=this,i=this.controls.dropdown.find("ul");if(i.length||(i=jQuery("<ul/>").appendTo(this.controls.dropdown)),i.find("li").remove(),!e||Array.isArray(e)&&!e.length||Array.isArray(e.value)&&!e.value.length){var o=this.data("empty");if(!o)return void this.cancel();i.append(jQuery("<li/>").html(o)).show(),this.controls.dropdown.show()}else{for(var r=0;r<e.length;r++){var a=e[r].name;if(t&&(a=t,a=a.replace("{{.}}",e[r].value),"object"==typeof e[r].data))for(var s in e[r].data)a=a.replace("{{"+s+"}}",e[r].data[s]);jQuery("<li/>").html(a).data("value",e[r].value).on(":select",function(e,t){return function(){n.select(e,t)}}(e[r].value,e[r].name)).appendTo(i);!this.config.multiple&&this.updateValues&&e[r].name.toLowerCase()==this.controls.input.val().toLowerCase()&&this.select(e[r].value,e[r].name,!0)}i.show()}this.setupUx(),this.controls.dropdown.css({left:this.controls.input.offset().left+"px",top:this.controls.input.offset().top+this.controls.input.outerHeight()+"px"}).show()},reset:function(){this.config.multiple&&(this.controls.input.val("").focus(),this.lastpattern="")},cancel:function(){this.controls.dropdown.find("ul li").remove(),this.controls.dropdown.hide()},force:function(e){this.config.multiple&&","==e.substr(e.length-1)&&(e=e.substr(0,e.length-1));var t="",n=e.toLowerCase(),i=!1;this.controls.dropdown.find("li").each(function(){if(!i){var o=jQuery(this);o.text().toLowerCase()==n&&(t=o.data("value"),e=o.text(),i=!0)}}),this.select(t,e),this.reset()},item:function(e,t){var n=this,i=jQuery("<span/>").html(t).append(jQuery("<a/>").html("x").on("click",function(){return i.remove(),n.trigger("chess24:select"),n.adjust(),!1}));return e?(i.append(jQuery('<input type="hidden"/>').attr("name",this.attr("name")+"[]").val(e)),i.append(jQuery('<input type="hidden"/>').attr("name",this.attr("name").replace(/(\[|$)/,"_meta$1")+"[]").val(1)),i.append(jQuery('<input type="hidden"/>').attr("name",this.attr("name").replace(/(\[|$)/,"_label$1")+"[]").val(t))):this.config.strict?i.addClass("invalid"):(i.append(jQuery('<input type="hidden"/>').attr("name",this.attr("name")+"[]").val(t)),i.append(jQuery('<input type="hidden"/>').attr("name",this.attr("name").replace(/(\[|$)/,"_meta$1")+"[]").val(0)),i.append(jQuery('<input type="hidden"/>').attr("name",this.attr("name").replace(/(\[|$)/,"_label$1")+"[]").val(t))),this.config.clickable&&i.on("click",this.config.clickable),i},select:function(e,t,n,i){if(this.config.multiple){if(this.config.filter&&(e=this.config.filter(e),t=this.config.filter(t)),t.trim()){var o=this.item(e,t);this.controls.input.before(o),this.adjust()}i||this.reset()}else this.updateValues&&this.val(e),this.controls.input.val(t);this.trigger("chess24:select"),this.lastpattern=t,n||this.cancel()},adjust:function(){this.controls.input.css("width","30px"),this.controls.input.css("width",this.innerWidth()-(this.controls.input.offset().left-this.offset().left)-30+"px")},backspace:function(){this.config.multiple&&(this.find("span:last").remove(),this.trigger("chess24:select"),this.adjust())},filterDropdown:function(e){var t=this,n=jQuery("nothing");this.updateValues&&this.val(""),this.controls.dropdown.find("ul li").each(function(){var i=jQuery(this);t.config.multiple||i.text().toLowerCase()!=e.toLowerCase()?i.text().toLowerCase().substr(0,e.length)!=e.toLowerCase()&&(n=n.add(this)):t.select(i.data("value"),i.text(),!t.config.multiple)}),n.remove(),this.currentLi=-1,0==this.controls.dropdown.find("ul li").length?this.controls.dropdown.hide():this.controls.dropdown.find("li").removeClass("highlighted")},add:function(e){e&&e.value&&e.name&&(this.select(e.value,e.name,!1,!0),this.adjust())},values:function(e){return this.config.multiple&&e?[].slice.apply(this.find('[name="'+this.attr("name")+'[]"]').map(function(){return this.value})):void 0},empty:function(){this.config.multiple&&this.find("span").remove()},clickable:function(e){var t=this;e===!1?(this.removeClass("clickable"),this.find("span").off("click"),this.config.clickable=void 0):"function"==typeof e&&(this.addClass("clickable"),this.config.clickable=function(){var n=jQuery(this),i=n.find('input[name="'+t.attr("name")+'[]"]').val(),o=n.find('input[name="'+t.attr("name")+'_label[]"]').val();e(i,o)},this.find("span").on("click",this.config.clickable))},filter:function(e){"function"==typeof e&&(this.config.filter=e)}};jQuery.fn.suggestField=function(t){if(t){if(!this.data("pattern-lookup"))return this;if("add"==t)jQuery.extend(this,e).reinit().add(arguments[1]);else if("adjust"==t)jQuery.extend(this,e).reinit().adjust();else{if("count"==t)return this.find("span").length;if("values"==t)return jQuery.extend(this,e).reinit().values(arguments[1]);"empty"==t?jQuery.extend(this,e).reinit().empty():"clickable"==t?jQuery.extend(this,e).reinit().clickable(arguments[1]):"filter"==t&&jQuery.extend(this,e).reinit().filter(arguments[1])}}else this.each(function(){var t=jQuery(this);return t.data("pattern-lookup")?this:(jQuery.extend(t,e).init(),void t.data("pattern-lookup",!0))});return this}}),jQuery.fn.suspendResume=function(e){Array.isArray(e)||(e=Array.convert(arguments)),e=e.filter(function(e){var t="object"==typeof e&&"function"==typeof e.resume&&"function"==typeof e.suspend;return t||errorHandler.warning("object is not a suspendable",{view:e}),t}),e.length&&(this.on("chess24:show",function(t){e.forEach(function(e){e.resume()}),t.stopPropagation()}),this.on("chess24:hide",function(t){e.forEach(function(e){e.suspend()}),t.stopPropagation()}),this.trigger(this.is("section.active,:not(section):visible")?"chess24:show":"chess24:hide"))},function(){var e=[{header:!0,cells:[{text:"",params:{bold:!0}},{text:"",params:{bold:!0}},{text:"",params:{bold:!0}}]},{header:!1,cells:[{text:"",params:{}},{text:"",params:{}},{text:"",params:{}}]},{header:!1,cells:[{text:"",params:{}},{text:"",params:{}},{text:"",params:{}}]}],t=[{name:"Rating table",data:[{header:!0,cells:[{text:"Rank",params:{width:8,center:!0,bold:!0}},{text:"Name",params:{width:65,bold:!0}},{text:"Rating",params:{width:9,center:!0,bold:!0}},{text:"Points",params:{width:9,center:!0,bold:!0}},{text:"Perf",params:{width:9,center:!0,bold:!0}}]},{header:!1,cells:[{text:"1",params:{center:!0}},{text:"",params:{}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}}]},{header:!1,cells:[{text:"2",params:{center:!0}},{text:"",params:{}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}}]},{header:!1,cells:[{text:"3",params:{center:!0}},{text:"",params:{}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}}]},{header:!1,cells:[{text:"4",params:{center:!0}},{text:"",params:{}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}}]},{header:!1,cells:[{text:"5",params:{center:!0}},{text:"",params:{}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}}]},{header:!1,cells:[{text:"6",params:{center:!0}},{text:"",params:{}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}}]},{header:!1,cells:[{text:"7",params:{center:!0}},{text:"",params:{}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}}]},{header:!1,cells:[{text:"8",params:{center:!0}},{text:"",params:{}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}}]},{header:!1,cells:[{text:"9",params:{center:!0}},{text:"",params:{}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}}]},{header:!1,cells:[{text:"10",params:{center:!0}},{text:"",params:{}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}}]}]},{name:"Tournament 4x4",data:[{header:!0,cells:[{text:"#",params:{width:7,bold:!0,center:!0}},{text:"Name",params:{width:40,bold:!0}},{text:"Rtg",params:{width:9,bold:!0,center:!0}},{text:"Perf",params:{width:9,bold:!0,center:!0}},{text:"1",params:{width:5.5,bold:!0,center:!0}},{text:"2",params:{width:5.5,bold:!0,center:!0}},{text:"3",params:{width:5.5,bold:!0,center:!0}},{text:"4",params:{width:5.5,bold:!0,center:!0}},{text:"Pts",params:{width:6.5,bold:!0,center:!0}},{text:"SB",params:{width:6.5,bold:!0,center:!0}}]},{header:!1,cells:[{text:"1",params:{center:!0}},{text:"",params:{}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0,empty:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}}]},{header:!1,cells:[{text:"2",params:{center:!0}},{text:"",params:{}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0,empty:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}}]},{header:!1,cells:[{text:"3",params:{center:!0}},{text:"",params:{}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0,empty:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}}]},{header:!1,cells:[{text:"4",params:{center:!0}},{text:"",params:{}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0,empty:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}}]}]},{name:"Tournament 6x6",data:[{header:!0,cells:[{text:"#",params:{width:5,bold:!0,empty:!1,center:!0}},{text:"Name",params:{width:34,bold:!0,center:!0}},{text:"Rtg",params:{width:7.5,bold:!0,center:!0}},{text:"Perf",params:{width:7.5,bold:!0,center:!0}},{text:"1",params:{width:5.5,bold:!0,center:!0}},{text:"2",params:{width:5.5,bold:!0,center:!0}},{text:"3",params:{width:5.5,bold:!0,center:!0}},{text:"4",params:{width:5.5,bold:!0,center:!0}},{text:"5",params:{width:5.5,bold:!0,center:!0}},{text:"6",params:{width:5.5,bold:!0,center:!0}},{text:"Pts",params:{width:6.5,bold:!0,center:!0}},{text:"SB",params:{width:6.5,bold:!0,center:!0}}]},{header:!1,cells:[{text:"1",params:{center:!0}},{text:"",params:{}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0,empty:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}}]},{header:!1,cells:[{text:"2",params:{center:!0}},{text:"",params:{}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0,empty:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}}]},{header:!1,cells:[{text:"3",params:{center:!0}},{text:"",params:{}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0,empty:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}}]},{header:!1,cells:[{text:"4",params:{center:!0}},{text:"",params:{}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0,empty:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}}]},{header:!1,cells:[{text:"5",params:{center:!0}},{text:"",params:{}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0,empty:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}}]},{header:!1,cells:[{text:"6",params:{center:!0}},{text:"",params:{}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0,empty:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}}]}]},{name:"Tournament 8x8",data:[{header:!0,cells:[{text:"#",params:{width:4.5,bold:!0,empty:!1,center:!0}},{text:"Name",params:{width:27,bold:!0,center:!0}},{text:"Rtg",params:{width:7.5,bold:!0,center:!0}},{text:"Perf",params:{width:7.5,bold:!0,center:!0}},{text:"1",params:{width:5,bold:!0,center:!0}},{text:"2",params:{width:5,bold:!0,center:!0}},{text:"3",params:{width:5,bold:!0,center:!0}},{text:"4",params:{width:5,bold:!0,center:!0}},{text:"5",params:{width:5,bold:!0,center:!0}},{text:"6",params:{width:5,bold:!0,center:!0}},{text:"7",params:{width:5,bold:!0,center:!0}},{text:"8",params:{width:5,bold:!0,center:!0}},{text:"Pts",params:{width:6.5,bold:!0,center:!0}},{text:"SB",params:{width:7,bold:!0,center:!0}}]},{header:!1,cells:[{text:"1",params:{center:!0}},{text:"",params:{}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0,empty:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}}]},{header:!1,cells:[{text:"2",params:{center:!0}},{text:"",params:{}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0,empty:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}}]},{header:!1,cells:[{text:"3",params:{center:!0}},{text:"",params:{}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0,empty:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}}]},{header:!1,cells:[{text:"4",params:{center:!0}},{text:"",params:{}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0,empty:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}}]},{header:!1,cells:[{text:"5",params:{center:!0}},{text:"",params:{}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0,empty:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}}]},{header:!1,cells:[{text:"6",params:{center:!0}},{text:"",params:{}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0,empty:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}}]},{header:!1,cells:[{text:"7",params:{center:!0}},{text:"",params:{}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0,empty:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}}]},{header:!1,cells:[{text:"8",params:{center:!0}},{text:"",params:{}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0,empty:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}}]}]},{name:"Tournament 10x10",data:[{header:!0,cells:[{text:"#",params:{width:4.5,bold:!0,center:!0}},{text:"Name",params:{width:27,bold:!0,center:!0}},{text:"Rtg",params:{width:8,bold:!0,center:!0}},{text:"Perf",params:{width:7.5,bold:!0,center:!0}},{text:"1",params:{width:4,bold:!0,center:!0}},{text:"2",params:{width:4,bold:!0,center:!0}},{text:"3",params:{width:4,bold:!0,center:!0}},{text:"4",params:{width:4,bold:!0,center:!0}},{text:"5",params:{width:4,bold:!0,center:!0}},{text:"6",params:{width:4,bold:!0,center:!0}},{text:"7",params:{width:4,bold:!0,center:!0}},{text:"8",params:{width:4,bold:!0,center:!0}},{text:"9",params:{width:4,bold:!0,center:!0}},{text:"0",params:{width:4,bold:!0,center:!0}},{text:"Pts",params:{width:6,bold:!0,center:!0}},{text:"SB",params:{width:7,bold:!0,center:!0}}]},{header:!1,cells:[{text:"1",params:{center:!0}},{text:"",params:{}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0,empty:!0}},{text:"",params:{center:!0,width:4}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",
params:{center:!0,width:4}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0,width:4}},{text:"",params:{center:!0}},{text:"",params:{center:!0}}]},{header:!1,cells:[{text:"2",params:{center:!0}},{text:"",params:{}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0,width:4,empty:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0,width:4}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0,width:4}},{text:"",params:{center:!0}},{text:"",params:{center:!0}}]},{header:!1,cells:[{text:"3",params:{center:!0}},{text:"",params:{}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0,width:4}},{text:"",params:{center:!0,empty:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0,width:4}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0,width:4}},{text:"",params:{center:!0}},{text:"",params:{center:!0}}]},{header:!1,cells:[{text:"4",params:{center:!0}},{text:"",params:{}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0,width:4}},{text:"",params:{center:!0}},{text:"",params:{center:!0,empty:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0,width:4}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0,width:4}},{text:"",params:{center:!0}},{text:"",params:{center:!0}}]},{header:!1,cells:[{text:"5",params:{center:!0}},{text:"",params:{}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0,width:4}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0,empty:!0}},{text:"",params:{center:!0,width:4}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0,width:4}},{text:"",params:{center:!0}},{text:"",params:{center:!0}}]},{header:!1,cells:[{text:"6",params:{center:!0}},{text:"",params:{}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0,width:4}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0,width:4,empty:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0,width:4}},{text:"",params:{center:!0}},{text:"",params:{center:!0}}]},{header:!1,cells:[{text:"7",params:{center:!0}},{text:"",params:{}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0,width:4}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0,width:4}},{text:"",params:{center:!0,empty:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0,width:4}},{text:"",params:{center:!0}},{text:"",params:{center:!0}}]},{header:!1,cells:[{text:"8",params:{center:!0}},{text:"",params:{}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0,width:4}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0,width:4}},{text:"",params:{center:!0}},{text:"",params:{center:!0,empty:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0,width:4}},{text:"",params:{center:!0}},{text:"",params:{center:!0}}]},{header:!1,cells:[{text:"9",params:{center:!0}},{text:"",params:{}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0,width:4}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0,width:4}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0,empty:!0}},{text:"",params:{center:!0,width:4}},{text:"",params:{center:!0}},{text:"",params:{center:!0}}]},{header:!1,cells:[{text:"10",params:{center:!0}},{text:"",params:{}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0,width:4}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0,width:4}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:" ",params:{center:!0}},{text:"",params:{center:!0,width:4,empty:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}}]}]},{name:"Tournament 12x12",data:[{header:!0,cells:[{text:"#",params:{width:4,bold:!0,center:!0}},{text:"Name",params:{width:22,bold:!0}},{text:"Rtg",params:{width:7.5,bold:!0,center:!0}},{text:"Perf",params:{width:6.5,bold:!0,center:!0}},{text:"1",params:{width:4,bold:!0,center:!0}},{text:"2",params:{width:4,bold:!0,center:!0}},{text:"3",params:{width:4,bold:!0,center:!0}},{text:"4",params:{width:4,bold:!0,center:!0}},{text:"5",params:{width:4,bold:!0,center:!0}},{text:"6",params:{width:4,bold:!0,center:!0}},{text:"7",params:{width:4,bold:!0,center:!0}},{text:"8",params:{width:4,bold:!0,center:!0}},{text:"9",params:{width:4,bold:!0,center:!0}},{text:"0",params:{width:4,bold:!0,center:!0}},{text:"1",params:{width:4,bold:!0,center:!0}},{text:"2",params:{width:4,bold:!0,center:!0}},{text:"Pts",params:{width:4.5,bold:!0}},{text:"SB",params:{width:7.5,bold:!0,center:!0}}]},{header:!1,cells:[{text:"1",params:{center:!0}},{text:"",params:{}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0,empty:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}}]},{header:!1,cells:[{text:"2",params:{center:!0}},{text:"",params:{}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0,empty:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}}]},{header:!1,cells:[{text:"3",params:{center:!0}},{text:"",params:{}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0,empty:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}}]},{header:!1,cells:[{text:"4",params:{center:!0}},{text:"",params:{}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0,empty:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}}]},{header:!1,cells:[{text:"5",params:{center:!0}},{text:"",params:{}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0,empty:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}}]},{header:!1,cells:[{text:"6",params:{center:!0}},{text:"",params:{}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0,empty:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}}]},{header:!1,cells:[{text:"7",params:{center:!0}},{text:"",params:{}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0,empty:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}}]},{header:!1,cells:[{text:"8",params:{center:!0}},{text:"",params:{}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0,empty:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}}]},{header:!1,cells:[{text:"9",params:{center:!0}},{text:"",params:{}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0,empty:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}}]},{header:!1,cells:[{text:"10",params:{center:!0}},{text:"",params:{}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0,empty:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}}]},{header:!1,cells:[{text:"11",params:{center:!0}},{text:"",params:{}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0,empty:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}}]},{header:!1,cells:[{text:"12",params:{center:!0}},{text:"",params:{}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0,empty:!0}},{text:"",params:{center:!0}},{text:"",params:{center:!0}}]}]}],n=function(e){var t;return{data:function(n){if("object"==typeof n)e.attr("data",jQuery.toJSON(n)),t=n;else{if(t)return t;n=e.attr("data"),n=n?jQuery.parseJSON(n):{}}return t=n,n},set:function(e,n){t=this.data(),t[e]=n,this.data(t)},get:function(e){return this.data()[e]},bold:function(t){return 0==arguments.length?!!this.get("bold"):(this.set("bold",!!t),void e.css("font-weight",t?"bold":""))},center:function(t){return 0==arguments.length?!!this.get("center"):(this.set("center",!!t),void e.css("text-align",t?"center":""))},empty:function(t){return 0==arguments.length?!!this.get("empty"):(this.set("empty",!!t),t&&e.html(""),e.css("background-color",t?"#999999":""),void 0)},width:function(e){return 0==arguments.length?this.get("width"):void this.set("width",e)},colspan:function(e){return 0==arguments.length?this.get("colspan")||1:void this.set("colspan",parseInt(e))},link:function(t){return 0==arguments.length?this.get("link"):void(t?(this.set("link",t),e.find("a,span").replaceWith(jQuery("<a/>").attr("href","javascript:void(0)").append(e.find("a,span").contents()))):(this.set("link",!1),e.find("a,span").replaceWith(jQuery("<span/>").append(e.find("a,span").contents()))))},flag:function(t){return 0==arguments.length?this.get("flag"):("undefined"==typeof t?e.find("span,a").removeClass():e.find("span,a").html("").addClass("icoFlag flag-"+(t||e.text())),void this.set("flag",t))},left:function(){var t=e.prevAll(".widget-table-cell:first");return t.length?t:null},right:function(){var t=e.nextAll(".widget-table-cell:first");return t.length?t:null},refresh:function(){this.link(this.link()),this.flag(this.flag()),this.center(this.center()),this.bold(this.bold()),this.empty(this.empty())}}},i={currentcell:[-1,-1,null],multiselect:[],editing:null,calculateCliche:function(){var e=this,t=this.tableWidth;e.cliche=[],e.find(".widget-table-row").each(function(){var i=0;jQuery(this).find(".widget-table-cell").each(function(){if(!e.cliche[i]){var o=n(jQuery(this));1==o.colspan()?(o.width()?e.cliche[i]=t*o.width()/100:e.cliche[i]=0,i++):i+=o.colspan()}})});for(var i=0,o=0;o<e.cliche.length;o++)e.cliche[o]?t-=e.cliche[o]:i++;for(var o=0;o<e.cliche.length;o++)e.cliche[o]||(e.cliche[o]=Math.round(t/i));return e},adjustCliche:function(){for(var e=0,t=0;t<this.cliche.length;t++)e+=this.cliche[t];for(var n=e/this.tableWidth,t=0;t<this.cliche.length;t++)this.cliche[t]=Math.round(this.cliche[t]/n);return this},alignCells:function(){var e=this,t=e.find(".widget-table-intercell:first").width()||3;e.adjustCliche();for(var i=[],o=0;o<this.cliche.length;o++)i.push(this.cliche[o]);for(var r=this.tableWidth-(i.length-1)*t,a=this.tableWidth/r,o=0;o<i.length;o++)i[o]=Math.floor(i[o]/a);var s=!0;e.find(".widget-table-row").each(function(){var e=jQuery(this),o=0;e.find(".widget-table-cell").each(function(){var e=jQuery(this),a=n(e);if(a.colspan()>1){for(var s=(a.colspan()-1)*t,l=0;l<a.colspan();l++)s+=i[o+l];e.css("width",s+"px"),o+=a.colspan()}else e.css("width",i[o]+"px"),a.width(i[o]/r*100),o++}),s=!s});var l=0,o=0;return e.find(".widget-table-removecolumn").each(function(e){jQuery(this).css("left",Math.round(l+i[o]/2-jQuery(this).width()/2)+"px"),l+=i[o]+t,o++}),e},setupDragging:function(){var e,t,i,o=this,r=function(n){if(t){var r=n.clientX-e;o.cliche[i]+r>10&&o.cliche[i+1]-r>10&&(o.cliche[i]+=r,o.cliche[i+1]-=r,o.adjustCliche(),o.alignCells(),e+=r)}},a=function(){e=void 0,t=void 0,o.off("dragmove").css("cursor",""),o.setupControls(),o.dump()};return o.find(".widget-table-intercell").attr("draggable",!0).off("mousedown").on("mousedown",function(s){t=jQuery(this),i=-1;for(var l=t.closest(".widget-table-row").find(".widget-table-cell"),c=0;c<l.length;c++){var d=jQuery(l.get(c)),u=n(d);if(i+=u.colspan(),d.next().is(t))break}e=s.clientX,o.off("mousemove").on("mousemove",r).css("cursor","w-resize"),jQuery(document).one("mouseup",a);try{s.preventDefault()}catch(h){s.returnValue=!1}return!1}),o},setupEditing:function(){var e=this;return e.find(".widget-table-cell").each(function(){var e=jQuery(this);if(!e.find("input").length&&!e.find("span,a").length){var t=n(e);t.link()?e.append(jQuery('<a href="javascript:void(0)"/>').html(e.contents())):e.append(jQuery("<span/>").html(e.contents())),void 0!==t.flag()&&t.flag(e.text()||t.flag())}}),e.find(".widget-table-cell").off("click").on("click",function(){var t=jQuery(this),i=0;t.prevAll(".widget-table-cell").each(function(){i+=n(jQuery(this)).colspan()});var o=t.closest(".widget-table-row").prevAll(".widget-table-row").length;e.selectCell(i,o),e.startEdit()}),e},setupControls:function(){var e=this,i=!0;e.find(".widget-table-row").each(function(){jQuery(this)[i?"addClass":"removeClass"]("odd")[i?"removeClass":"addClass"]("even"),i=!i});for(var o=e.find(".widget-table-intercell:first").width()||3,r=[],a=0;a<this.cliche.length;a++)r.push(this.cliche[a]);for(var s=this.tableWidth-(r.length-1)*o,l=this.tableWidth/s,a=0;a<r.length;a++)r[a]=Math.floor(r[a]/l);var c=function(t){var n=Widgets.Table().keys;if(jQuery(t.target).is("input")||jQuery(t.target).is(".paste-div"))return!0;if(!t.altKey&&t.keyCode!=n.VK_F1&&t.keyCode!=n.VK_F2&&t.keyCode!=n.VK_F3&&t.keyCode!=n.VK_F4&&t.keyCode!=n.VK_F5&&t.keyCode!=n.VK_F6&&t.keyCode!=n.VK_F7&&t.keyCode!=n.VK_F8&&t.keyCode!=n.VK_F9&&t.keyCode!=n.VK_F10&&t.keyCode!=n.VK_F11&&t.keyCode!=n.VK_F12){e.keypress(t.keyCode,t.charCode,t.shiftKey,t.ctrlKey);try{t.stopPropagation(),t.preventDefault()}catch(i){t.cancelBubble=!0,t.returnValue=!1}}};jQuery(document).off("keydown.tablebuilder").on("keydown.tablebuilder",c),jQuery(document).on("mousedown.tablebuilder",function(e){jQuery(e.target).is(".editor-dialog")||jQuery(e.target).closest(".editor-dialog").length>0||jQuery(document).off("keydown.tablebuilder",c)}),e.off("mousedown").on("mousedown.tablebuilder",function(e){jQuery(document).off("keydown.tablebuilder",c).on("keydown.tablebuilder",c);try{e.cancelBubble=!0,e.stopPropagation()}catch(t){}});var d=parseInt(e.css("padding-top"))||0;e.find(".widget-table-removerow, .widget-table-removecolumn, .widget-table-addrow, .widget-table-addcolumn, .widget-table-makeheader").remove();var u=0,h=e.find(".widget-table-row").length,p=e.find(".nativeScrollInsider");if(e.find(".widget-table-row").each(function(t){var i=jQuery(this);p.append(jQuery('<a class="widget-table-makeheader"/>').addClass(i.hasClass("widget-table-header")?"highlighted":"").on("click",function(){i.toggleClass("widget-table-header");var t=i.hasClass("widget-table-header");i.find(".widget-table-cell").each(function(){n(jQuery(this)).bold(!!t)}),jQuery(this).toggleClass("highlighted"),e.setupControls().dump()}).css("top",d+4+t*i.height()+"px")),h>1&&p.append(jQuery('<a class="widget-table-removerow"/>').on("click",function(){i.height();t==e.currentcell[1]&&(i.next(".widget-table-row").length?e.moveSelectCell(0,1):e.moveSelectCell(0,-1)),i.remove(),e.setupControls().dump()}).css("top",d+4+t*i.height()+"px"))}),e.cliche.length>1){u=0;for(var f=0;f<e.cliche.length;f++)e.append(jQuery('<a class="widget-table-removecolumn"/>').on("click",function(t){return function(){e.cliche.splice(t,1),e.find(".widget-table-row").each(function(){for(var i=-1,o=jQuery(this).find(".widget-table-cell"),r=0;r<o.length&&(i+=n(o.eq(r)).colspan(),!(i>=t));r++);var a=jQuery(this).find(".widget-table-cell:eq("+r+")"),s=n(a);return s.colspan()>1?void s.colspan(s.colspan()-1):(r==e.currentcell[0]&&(a.next(".widget-table-cell").length?e.moveSelectCell(1,0):e.moveSelectCell(-1,0)),a.next().hasClass("widget-table-intercell")?a.next().remove():a.prev().hasClass("widget-table-intercell")&&a.prev().remove(),void a.remove())}),e.adjustCliche().alignCells().setupDragging().setupEditing().setupControls().dump()}}(f)).css("left",u+r[f]/2-12.5+"px")),u+=r[f]+o}e.append(jQuery('<a class="widget-table-addcolumn"/>').on("click",function(){e.cliche.push(100),e.find(".widget-table-row").each(function(){var e=jQuery(this);e.append(jQuery('<div class="widget-table-intercell"/>')),e.append(jQuery('<div class="widget-table-cell"/>'))}),e.adjustCliche().alignCells().setupDragging().setupEditing().setupControls().dump()}).css("right",e.cliche[e.cliche.length-1]/2+60+"px")),e.append(jQuery('<a class="widget-table-addrow"/>').on("click",function(){var t=e.find(".widget-table-row:last");t.clone(!0).removeClass("widget-table-header").appendTo(e.find(".widget-table")).find(".widget-table-cell").html(""),t.find(".highlighted").length&&e.moveSelectCell(0,1),e.setupEditing().setupDragging().setupControls().dump().scrollTop(e.find(".widget-table").height()),jQuery(document).trigger("newhtml")}));var g;e.controlbar.find(".widget-table-paste").off("click").on("click",function(t){if(g&&g.closest(".bubble").is(":visible"))return void g.bubble("hide");g||(g=jQuery("<div/>").addClass("widget-table-paste").append(jQuery("<div/>").addClass("paste-div-comment").html(window.t("Paste the table here..."))).append(jQuery("<div/>").addClass("paste-div")).append(jQuery("<div/>").addClass("paste-div-checkbox").html('<input type="checkbox" name="onlydata"/> '+window.t("Only get data"))).append(jQuery("<div/>").addClass("paste-buttons").append(jQuery("<a/>").addClass("cBtn cBtnWhite").html(window.t("Cancel")).on("click",function(){g.bubble("hide")}))).bubble({align:this,side:"bottom",flexible:!0,point:"precise"}));var n=g.find(".paste-div");g.bubble("show",function(){n.html("").focus()}),e.hideProgress(),g.find(".paste-div-comment, .paste-div-checkbox").show().off("click").on("click",function(){n.html("").focus()}),jQuery(document).trigger("newhtml"),n.attr("contenteditable","true").html("").show(),n.off("paste").on("paste",function(){setTimeout(function(){n.hide(),g.find(".paste-div-comment, .paste-div-checkbox").hide();var t=g.find(".paste-div-checkbox input").is(":checked");t?e.loadTableData(n.html()):e.loadTable(n.html()),g.bubble("hide")},200)});try{t.stopPropagation()}catch(i){t.cancelBubble=!0}}).off("mousedown").on("mousedown",function(e){try{e.cancelBubble=!0,e.stopPropagation()}catch(t){}});var m;return e.controlbar.find(".widget-table-templates").off("click").on("click",function(n){if(m&&"block"==m.css("display"))return void m.bubble("hide",function(){m.closest(".bubble").remove().end().remove(),m=null});m=jQuery("<div/>").css("padding","10px");for(var i=0;i<t.length;i++)m.append(jQuery("<a/>").addClass("editor-dialog-widget").html(t[i].name).on("click",function(n){return function(i){e.loadJson(t[n].data),m.bubble("hide",function(){m.closest(".bubble").remove().end().remove(),m=null});try{i.cancelBubble=!0,i.stopPropagation()}catch(o){}}}(i)));m.bubble({align:jQuery(this),side:"bottom",point:"precise",flexible:!0}).bubble("show");try{n.stopPropagation()}catch(o){n.cancelBubble=!0}}),e},setupToolbar:function(){var e=this,t={bold:{name:window.t("bold"),icon:"bold.png",onclick:function(){var e=n(this);e.bold(!e.bold())},check:function(){return!!n(this).bold()}},link:{name:window.t("link"),icon:"link.png",onclick:function(){var t=n(this),i=this,o=jQuery("<div/>").css("padding","10px").on("mousedown click",function(e){try{e.cancelBubble=!0,e.stopPropagation()}catch(t){}});return o.append(jQuery('<input type="text"/>').val(t.link()||"http://").attr("size","30")),o.append(jQuery("<a/>").addClass("button-blue").html("Save").on("click",function(e){t.link(o.find("input").val()),o.bubble("hide"),i.trigger("click");try{e.cancelBubble=!0,e.stopPropagation()}catch(n){}})),o.append(jQuery("<a/>").addClass("button-blue").html("Delete").on("click",function(e){t.link(void 0),o.bubble("hide").remove(),i.trigger("click");try{e.cancelBubble=!0,e.stopPropagation()}catch(n){}})),e.one("mousedown",function(){o.bubble("hide").remove()}),o.bubble({align:this,side:"bottom",point:"precise"}).bubble("show"),o.find("input").focus(),!0},check:function(){return!!n(this).link()},available:function(){return 0==e.multiselect.length}},center:{name:window.t("center"),icon:"aligncenter.png",onclick:function(){var e=n(this);e.center(!e.center())},check:function(){return!!n(this).center()}},flag:{name:window.t("flag"),icon:"flag.png",onclick:function(){var e=n(this);e.flag(e.flag()?void 0:this.text()||"")},check:function(){return void 0!==n(this).flag()}},empty:{name:window.t("empty"),icon:"empty.png",onclick:function(){var t=n(this);t.empty(!t.empty()),t.empty()&&t.flag(void 0),e.setupEditing()},check:function(){return n(this).empty()}},spanleft:{name:"&larr;",icon:"spanleft.png",onclick:function(){var t=n(this);t.left()&&(t.colspan(t.colspan()+n(t.left()).colspan()),t.left().remove(),this.prev(".widget-table-intercell").remove(),e.currentcell[0]--,e.alignCells())},available:function(){return 0==e.multiselect.length&&!!n(this).left()}},spanright:{name:"&rarr;",icon:"spanright.png",onclick:function(){var t=n(this);t.right()&&(t.colspan(t.colspan()+n(t.right()).colspan()),t.right().remove(),this.next(".widget-table-intercell").remove(),e.alignCells())},available:function(){return 0==e.multiselect.length&&!!n(this).right()}},unspanleft:{name:"&rarr;",icon:"unspanleft.png",onclick:function(){var t=n(this);if(1!=t.colspan()){t.colspan(t.colspan()-1);var i=jQuery("<div/>").addClass("widget-table-cell"),o=jQuery("<div/>").addClass("widget-table-intercell");this.before(i).before(o),e.currentcell[0]++,e.alignCells().setupEditing().setupDragging()}},available:function(){return 0==e.multiselect.length&&n(this).colspan()>1}},unspanright:{name:"&larr;",icon:"unspanright.png",onclick:function(){var t=n(this);if(1!=t.colspan()){t.colspan(t.colspan()-1);var i=jQuery("<div/>").addClass("widget-table-cell"),o=jQuery("<div/>").addClass("widget-table-intercell");this.after(i).after(o),e.alignCells().setupEditing().setupDragging()}},available:function(){return 0==e.multiselect.length&&n(this).colspan()>1}}};e.find(".widget-table-toolbar").remove();var i=jQuery('<div class="widget-table-toolbar"/>').prependTo(e),o=!1;for(var r in t)jQuery("<a/>").html('<img src="'+config.assetDir()+"/images/editor/toolbar/"+t[r].icon+'"/>').on("mousedown",function(){o=!!e.editing}).on("click",function(n){return function(r){if(e.multiselect.length)for(var a=0;a<e.multiselect.length;a++)t[n].onclick.call(e.multiselect[a][2]);else{var s=t[n].onclick.call(e.currentcell[2]);!s&&o&&e.startEdit()}e.dump(),i.find("a").trigger("highlight");try{r.stopPropagation()}catch(l){r.cancelBubble=!0}return!1}}(r)).on("highlight",function(n){return function(){e.currentcell&&e.currentcell[2]&&(t[n].check&&jQuery(this)[t[n].check.call(e.currentcell[2])?"addClass":"removeClass"]("highlighted"),t[n].available&&jQuery(this)[t[n].available.call(e.currentcell[2])?"removeClass":"addClass"]("disabled"))}}(r)).appendTo(i);return e},updateToolbar:function(e){return this.find(".widget-table-toolbar a").trigger("highlight"),this},loadTable:function(e){var t=this,i=jQuery("<div/>").html(e).css({position:"absolute",left:"-10000px",top:"-10000px"}).appendTo("body"),o=t.find(".widget-table").hide(),r=i.find("table:first");if(!r.length)return t.showMessage(window.t("No table found, make sure you copied it.")),i.remove(),void o.show();t.find(".widget-table-row").remove();var a=r.width(),s=i.find("table:first tr"),l=s.length,c=0,d=function(e){var i=e.first(),r=jQuery("<div/>").addClass("widget-table-row").appendTo(o);i.find("td,th").each(function(){var e=jQuery(this),t=jQuery("<div/>").addClass("widget-table-cell").appendTo(r).html(e.html());e.next().is("td,th")&&jQuery("<div/>").addClass("widget-table-intercell").appendTo(r);var i,o=n(t);(i=parseInt(e.css("width")))&&o.width(i/a*100),(i=e.attr("width"))&&(i.match(/%$/)?o.width(parseInt(i)):o.width(parseInt(i)/a*100)),("center"==e.css("text-align")||e.find("center").length)&&o.center(!0),("bold"==e.css("font-weight")||e.find("b").length)&&o.bold(!0),(i=parseInt(e.attr("colspan")))&&o.colspan(i),(i=e.find("a"))&&(i=i.attr("href"))&&o.link(i),e.is("th")&&(o.bold(!0),r.addClass("widget-table-header"));var s=e.find("> div");if(s.length){var l=s.attr("class").match(/^tn_(\w\w\w)$/);l&&o.flag(l[1].toLowerCase())}t.find("*").each(function(){jQuery(this).is("a")||jQuery(this).replaceWith(jQuery(this).contents())})}),i.remove(),e=e.slice(1),e.length?setTimeout(function(){d(e)},10):u(),c++,t.showProgress(c/l*100)};d(s);var u=function(){i.remove(),o.show(),t.hideProgress(),t.calculateCliche().alignCells().setupDragging().setupEditing().setupControls().dump().selectCell(0,0),jQuery(document).trigger("newhtml")};return t},loadTableData:function(e){var t=this,i=jQuery("<div/>").html(e).css({position:"absolute",left:"-10000px",top:"-10000px"}).appendTo("body"),o=t.find(".widget-table").hide(),r=i.find("table:first");if(!r.length)return t.showMessage(window.t("No table found, make sure you copied it.")),i.remove(),void o.show();var a=i.find("table:first tr"),s=a.length,l=0,c=function(){i.remove(),o.show(),t.hideProgress(),t.setupEditing().dump().selectCell(0,0),jQuery(document).trigger("newhtml")},d=function(e){var i=e.first(),o=t.find(".widget-table-row:eq("+l+")");if(!o.length)return c();var r=0;i.find("td,th").each(function(){var e=jQuery(this),t=o.find(".widget-table-cell:eq("+r++ +")").html(e.html());if(!t.length)return c();var i,a=n(t);("center"==e.css("text-align")||e.find("center").length)&&a.center(!0),("bold"==e.css("font-weight")||e.find("b").length)&&a.bold(!0),(i=e.find("a"))&&(i=i.attr("href"))&&a.link(i),t.find("*").each(function(){jQuery(this).is("a")?a.link(jQuery(this).attr("href")):jQuery(this).replaceWith(jQuery(this).contents())})}),i.remove(),e=e.slice(1),e.length?setTimeout(function(){d(e)},10):c(),l++,t.showProgress(l/s*100)};return d(a),t},loadJson:function(e){var t=this,i=t.find(".widget-table").hide();t.find(".widget-table-row").remove();var o=e.length,r=0,a=function(e){var l=e[0],c=jQuery("<div/>").addClass("widget-table-row").appendTo(i);l.header&&c.addClass("widget-table-header");for(var d=0;d<l.cells.length;d++){var u=l.cells[d].params;l.cells[d].text=l.cells[d].text&&l.cells[d].text.replace(/%26/g,"&").replace(/%3E/g,">").replace(/%3C/g,"<"),u.link=u.link&&u.link.replace(/%26/g,"&").replace(/%3E/g,">").replace(/%3C/g,"<");var h=jQuery("<div/>").addClass("widget-table-cell").appendTo(c).text((l.cells[d].text||"").replace("&nbsp;","")),p=n(h);d<l.cells.length-1&&jQuery("<div/>").addClass("widget-table-intercell").appendTo(c),p.data(u),u.center&&p.center(!0),(u.bold||l.header)&&p.bold(!0),u.empty&&p.empty(!0)}e=e.slice(1),e.length?setTimeout(function(){a(e)},10):s(),r++,t.showProgress(r/o*100)};a(e);var s=function(){i.show(),t.hideProgress(),t.calculateCliche().alignCells().setupDragging().setupEditing().setupControls().dump().selectCell(0,0),jQuery(document).trigger("newhtml")};return t},fixTable:function(){},showMessage:function(e,t){var n=this;return e?(this.controlbar.find(".message").html(e).show(),t||setTimeout(function(){n.controlbar.find(".message").hide()},3e3),n):(this.controlbar.find(".message").hide(),this)},showProgress:function(e){return this.controlbar.find(".progress-bar").show().find("div").css({width:e+"%"}),this},hideProgress:function(){var e=this;return setTimeout(function(){e.controlbar.find(".progress-bar").hide()},20),this},dump:function(){var e=[],t=0;return this.find(".widget-table-row:first .widget-table-cell").each(function(){t+=jQuery(this).width()}),this.find(".widget-table-row").each(function(){var i={header:jQuery(this).hasClass("widget-table-header"),cells:[]};jQuery(this).find(".widget-table-cell").each(function(){var e=n(jQuery(this)).data();e.width=100*jQuery(this).width()/t,i.cells.push({text:jQuery(this).text(),params:e})}),e.push(i)}),this.target.val(jQuery.toJSON(e).replace(/\&/g,"%26").replace(/>/g,"%3E").replace(/</g,"%3C")),this},startEdit:function(e){var t=this;if(-1!=this.currentcell[0]&&-1!=this.currentcell[1]&&this.currentcell[2]&&this.currentcell[2].length){var i=this.currentcell[2];if(this.resetMultiselection(),this.updateToolbar(i),
!(this.editing&&i.find(this.editing).length>0)){this.editing&&this.endEdit();var o=n(i);if(!o.empty()){var r=o.flag()||i.text();this.editing=jQuery('<input type="text"/>').val(e||r).css({width:(i.find("span,a").width()||i.width()-10)+"px",height:i.find("span,a").height+"px","text-align":o.center()?"center":"","font-weight":o.bold()?"bold":""}).on("keydown",function(e){e.keyCode==Widgets.Table().keys.VK_RETURN?t.endEdit():e.keyCode==Widgets.Table().keys.VK_ESCAPE&&t.endEdit(r);try{e.cancelBubble=!0,e.stopPropagation()}catch(n){}}).on("blur",function(){t.endEdit()}),i.html("").append(this.editing);var a=this.editing.get(0);if("undefined"!=typeof a.selectionStart)a.selectionStart=a.value.length,a.selectionEnd=a.value.length;else if("function"==typeof a.createTextRange){var s=a.createTextRange();s.moveToElementText(a),s.collapse(!0)}return this.editing.focus(),t}}}},endEdit:function(e){var t=this;if(-1!=this.currentcell[0]&&-1!=this.currentcell[1]&&this.currentcell[2]&&this.currentcell[2].length){var i=this.currentcell[2],o=i.find("input");"undefined"==typeof e&&(e=o.val().replace(/</g,"&lt;").replace(/>/g,"&gt;"));var r=n(i);return void 0!==r.flag()&&r.flag(""==e?void 0:e),i.html(e),this.editing=null,this.setupEditing().dump(),t}},selectCell:function(e,t,i){if(!(0>e||0>t)){var o,r=-1,a=0;if(this.find(".widget-table-row:eq("+t+") .widget-table-cell").each(function(){r+=n(jQuery(this)).colspan(),!o&&r>=e&&(a=r-n(jQuery(this)).colspan()+1,o=jQuery(this))}),o){i?this.appendMultiselection([a,t,o]):(this.currentcell=[],this.resetMultiselection()),this.currentcell=[a,t,o],o.addClass("highlighted");var s=parseInt(this.css("padding-top")),l=s-this.find(".widget-table").position().top,c=o.position().top+s;c>this.outerHeight()-o.height()?this.scrollTop(l+(c-(this.outerHeight()-o.height()))):100>c&&this.scrollTop(Math.max(0,l-(100-c))),this.updateToolbar(o)}return this}},moveSelectCell:function(e,t,i){return-1==this.currentcell[0]||-1==this.currentcell[1]?this.selectCell(0,0):(e>0&&(e+=n(this.currentcell[2]).colspan()-1),this.selectCell(this.currentcell[0]+e,this.currentcell[1]+t,i)),this},appendMultiselection:function(e){var t=this;0==this.multiselect.length&&(this.msstart=this.currentcell),this.multiselect=[],this.find(".widget-table .highlighted").removeClass("highlighted");for(var i=Math.min(this.msstart[0],e[0]+n(e[2]).colspan()-1),o=Math.min(this.msstart[1],e[1]),r=Math.max(this.msstart[0],e[0]+n(e[2]).colspan()-1),a=Math.max(this.msstart[1],e[1]),s=o;a>=s;s++){var l=this.find(".widget-table-row:eq("+s+") .widget-table-cell"),c=0;l.each(function(){$this=jQuery(this),c>=i&&r>=c&&(t.multiselect.push([c,s,$this]),$this.addClass("highlighted")),c+=n($this).colspan()})}},resetMultiselection:function(){this.multiselect=[],this.find(".widget-table .highlighted").removeClass("highlighted"),this.currentcell[2]&&this.currentcell[2].addClass("highlighted")},keypress:function(e,t,i,o){var r=Widgets.Table().keys;switch(e){case r.VK_LEFT:this.moveSelectCell(-1,0,i);break;case r.VK_RIGHT:this.moveSelectCell(1,0,i);break;case r.VK_UP:this.moveSelectCell(0,-1,i);break;case r.VK_DOWN:this.moveSelectCell(0,1,i);break;case r.VK_DELETE:if(this.multiselect.length>0)for(var a=0;a<this.multiselect.length;a++){var s=n(this.multiselect[a][2]);s.flag()&&(s.flag(void 0),this.multiselect[a][2].find("span,a").removeClass()),this.multiselect[a][2].find("span,a").html("")}else if(this.currentcell[2]){var s=n(this.currentcell[2]);s.flag()&&(s.flag(void 0),this.currentcell[2].find("span,a").removeClass()),this.currentcell[2].find("span,a").html("")}this.dump();break;case r.VK_COPY:o&&(this.clipboard={data:n(this.currentcell[2]).data(),html:this.currentcell[2].html()});break;case r.VK_PASTE:o&&this.clipboard&&(this.currentcell[2].html(this.clipboard.html),n(this.currentcell[2]).data(this.clipboard.data),n(this.currentcell[2]).refresh(),this.updateToolbar(),this.dump());break;case r.VK_RETURN:this.startEdit()}return this}};jQuery.fn.tableBuilder=function(t,n,o){var r=this,a=jQuery.extend({},r,i);a.addClass("widget-table-builder"),a.after('<div class="clearfix"/>'),a.find(".widget-table").length||a.append(jQuery("<div/>").addClass("nativeScroll").append(jQuery("<div/>").addClass("nativeScrollInsider").append(jQuery("<div/>").addClass("widget-table")))),setTimeout(function(){jQuery(document).trigger("newhtml")},200),a.cliche=[],a.tableWidth=a.find(".nativeScrollInsider").width()-70,a.controlbar=a.next(".widget-table-controlbar"),a.controlbar.length||(a.controlbar=jQuery("<div/>").addClass("widget-table-controlbar").append(jQuery("<a/>").addClass("cBtn cBtnWhite widget-table-templates").html(window.t("Templates"))).append(jQuery("<a/>").addClass("cBtn cBtnWhite widget-table-paste").html(window.t("Paste"))).append(jQuery("<div/>").addClass("progress-bar").append(jQuery("<div/>"))).append(jQuery("<div/>").addClass("message")).insertBefore(a));var s=e;if(a.target=o||r.find("input[type=hidden]"),a.target.length){try{s=jQuery.parseJSON(a.target.val())}catch(l){}s||(s=e)}else a.target=jQuery("<input/>").attr("type","hidden").val(jQuery.toJSON(s)).appendTo(r);a.setupToolbar(),a.loadJson(s)}}(),function(){var e=0,t={width:150,height:140},n={init:function(){var e=this;if(this.container=jQuery("<div/>").addClass("thumbnail-builder").attr("id","builder-"+this.id).appendTo("body"),this.container.css({left:this.offset().left-jQuery(document).scrollLeft()+"px",top:this.offset().top-jQuery(document).scrollTop()+"px",width:this.width()+"px",height:this.height()+"px"}),this.covers={n:jQuery("<div/>").addClass("thumbnail-builder-cover").appendTo(this.container),e:jQuery("<div/>").addClass("thumbnail-builder-cover").appendTo(this.container),s:jQuery("<div/>").addClass("thumbnail-builder-cover").appendTo(this.container),w:jQuery("<div/>").addClass("thumbnail-builder-cover").appendTo(this.container)},this.container.closest(".bubble, .dialog").on("chess24:hide",function(t,n){n?e.container.remove():e.container.hide()}),this.body=jQuery("<div/>").addClass("thumbnail-builder-body").appendTo(this.container),this.drag=jQuery("<div/>").addClass("thumbnail-builder-move").appendTo(this.body).css({left:"10px",top:"10px"}),this.config.scale){this.scales={n:jQuery("<div/>").addClass("thumbnail-builder-scale scale-n").appendTo(this.body).data("side","n").css({left:"10px",top:"0px",height:"10px",cursor:"n-resize"}),nw:jQuery("<div/>").addClass("thumbnail-builder-scale scale-nw").appendTo(this.body).data("side","nw").css({left:"0px",top:"0px",width:"10px",height:"10px",cursor:"nw-resize"}),w:jQuery("<div/>").addClass("thumbnail-builder-scale scale-w").appendTo(this.body).data("side","w").css({left:"0px",top:"10px",width:"10px",cursor:"w-resize"}),sw:jQuery("<div/>").addClass("thumbnail-builder-scale scale-sw").appendTo(this.body).data("side","sw").css({left:"0px",bottom:"0px",width:"10px",height:"10px",cursor:"ne-resize"}),s:jQuery("<div/>").addClass("thumbnail-builder-scale scale-s").appendTo(this.body).data("side","s").css({left:"10px",bottom:"0px",height:"10px",cursor:"n-resize"}),se:jQuery("<div/>").addClass("thumbnail-builder-scale scale-se").appendTo(this.body).data("side","se").css({right:"0px",bottom:"0px",width:"10px",height:"10px",cursor:"nw-resize"}),e:jQuery("<div/>").addClass("thumbnail-builder-scale scale-e").appendTo(this.body).data("side","e").css({right:"0px",top:"10px",width:"10px",cursor:"w-resize"}),ne:jQuery("<div/>").addClass("thumbnail-builder-scale scale-ne").appendTo(this.body).data("side","ne").css({right:"0px",top:"0px",width:"10px",height:"10px",cursor:"ne-resize"})};for(var t in this.scales)this.scales[t].on("mousedown",function(t){e.startScale(t.clientX,t.clientY,jQuery(this).data("side"));try{t.cancelBubble=!0,t.stopPropagation()}catch(n){}}).on("dragstart",function(e){try{e.originalEvent.preventDefault(),e.originalEvent.stopPropagation()}catch(t){e.returnValue=!1,e.cancelBubble=!0}})}return this.drag.on("mousedown",function(t){e.startMove(t.clientX,t.clientY)}).on("dragstart",function(e){try{e.originalEvent.preventDefault(),e.originalEvent.stopPropagation()}catch(t){e.originalEvent.returnValue=!1,e.cancelBubble=!0}}),this.submit=jQuery("<a/>").addClass("thumbnail-builder-submit cBtnFlexi cBtnBlue").html("OK").appendTo(this.body).on("click",function(){e.submit.addClass("cBtnIcon cIconFileUploading disabled").off("click"),e.config.callback(e.config.left,e.config.top,e.config.width,e.config.height)}),this.config.left||(this.config.left=this.width()/2-this.config.width/2),this.config.top||(this.config.top=this.height()/2-this.config.height/2),this.update(),jQuery(window).on("resize",function(){e.container.css({left:e.offset().left-jQuery(document).scrollLeft()+"px",top:e.offset().top-jQuery(document).scrollTop()+"px"})}),e},update:function(){return this.body.css({left:this.config.left+"px",top:this.config.top+"px",width:this.config.width+"px",height:this.config.height+"px"}),this.covers.n.css({left:"0px",top:"0px",width:this.width()+"px",height:this.config.top+"px"}),this.covers.s.css({left:"0px",top:this.config.top+this.config.height+"px",width:this.width()+"px",height:this.height()-this.config.top-this.config.height+"px"}),this.covers.w.css({left:"0px",top:this.config.top+"px",width:this.config.left+"px",height:this.config.height+"px"}),this.covers.e.css({left:this.config.left+this.config.width+"px",top:this.config.top+"px",width:this.width()-this.config.left-this.config.width+"px",height:this.config.height+"px"}),this.submit.css({left:this.body.width()/2-this.submit.outerWidth()/2+"px",top:this.body.height()/2-this.submit.outerHeight()/2+"px"}),this.drag.css({width:this.config.width-20+"px",height:this.config.height-20+"px"}),this.config.scale&&(this.scales.n.css({width:this.config.width-20+"px"}),this.scales.s.css({width:this.config.width-20+"px"}),this.scales.e.css({height:this.config.height-20+"px"}),this.scales.w.css({height:this.config.height-20+"px"})),this},moveTo:function(e,t){this.config.left=Math.max(0,Math.min(this.container.width()-this.config.width,e)),this.config.top=Math.max(0,Math.min(this.container.height()-this.config.height,t)),this.update()},scaleTo:function(e,t,n,i){if("save-ratio"!=this.config.scale||!(50>e||50>t||e>=this.container.width()-this.config.left||t>=this.container.height()-this.config.top)){var o=Math.max(20,Math.min(this.container.width()-this.config.left,e)),r=Math.max(20,Math.min(this.container.height()-this.config.top,t)),a=o!=this.config.width,s=r!=this.config.height;this.config.width=o,this.config.height=r,this.moveTo(a&&n?n:this.config.left,s&&i?i:this.config.top)}},startMove:function(e,t){var n=this,i=this.config.left,o=this.config.top;return this.container.on("mousemove",function(r){var a=r.clientX-e,s=r.clientY-t;n.moveTo(i+a,o+s);try{r.stopPropagation(),r.preventDefault()}catch(l){r.cancelBubble=!0,r.returnValue=!1}return!1}),jQuery(document).one("mouseup",function(){n.endMove()}),this},endMove:function(){return this.container.off("mousemove"),this},startScale:function(e,t,n){var i=this,o=this.config.width,r=this.config.height,a=this.config.left,s=this.config.top,l="nw"==n||"w"==n||"sw"==n?-1:1,c="nw"==n||"n"==n||"ne"==n?-1:1;this.container.on("mousemove",function(d){var u="n"==n||"s"==n?0:d.clientX-e,h="w"==n||"e"==n?0:d.clientY-t,p=o+l*u,f=r+c*h;if("save-ratio"==i.config.scale){var g=i.config.width/i.config.height;Math.abs(u)>Math.abs(h)||"e"==n||"w"==n?f=p/g:p=f*g}var m=0>l?a-(p-o):void 0,v=0>c?s-(f-r):void 0;i.scaleTo(p,f,m,v);try{d.stopPropagation(),d.preventDefault()}catch(y){d.cancelBubble=!0,d.returnValue=!1}return!1}),jQuery(document).one("mouseup",function(){i.endScale()})},endScale:function(){this.container.off("mousemove")}};jQuery.fn.thumbnail=function(i){if(0==this.length)return this;if("hide"===i)return jQuery(".thumbnail-builder#builder-"+this.attr("builder-id")).remove(),this;var o=jQuery.extend({},this,n);return o.id=++e,o.config=jQuery.extend({},t,i),o.init(),this.attr("builder-id",o.id),this}}(),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(jQuery)}(function(e){function t(e){if(e.minTime&&(e.minTime=v(e.minTime)),e.maxTime&&(e.maxTime=v(e.maxTime)),e.durationTime&&"function"!=typeof e.durationTime&&(e.durationTime=v(e.durationTime)),e.disableTimeRanges.length>0){for(var t in e.disableTimeRanges)e.disableTimeRanges[t]=[v(e.disableTimeRanges[t][0]),v(e.disableTimeRanges[t][1])];e.disableTimeRanges=e.disableTimeRanges.sort(function(e,t){return e[0]-t[0]})}return e}function n(t){var n=t.data("timepicker-settings"),i=t.data("timepicker-list");i&&i.length&&(i.remove(),t.data("timepicker-list",!1)),i=e("<ul />",{"class":"ui-timepicker-list"});var o=e("<div />",{"class":"ui-timepicker-wrapper",tabindex:-1});o.css({display:"none",position:"absolute"}).append(i),n.className&&o.addClass(n.className),(null!==n.minTime||null!==n.durationTime)&&n.showDuration&&o.addClass("ui-timepicker-with-duration");var r=n.minTime;"function"==typeof n.durationTime?r=v(n.durationTime()):null!==n.durationTime&&(r=n.durationTime);var a=null!==n.minTime?n.minTime:0,l=null!==n.maxTime?n.maxTime:a+b-1;a>=l&&(l+=b);for(var c=n.disableTimeRanges,d=0,u=c.length,h=a;l>=h;h+=60*n.step){var p=h%b,y=e("<li />");if(y.data("time",p),y.text(m(p,n.timeFormat)),(null!==n.minTime||null!==n.durationTime)&&n.showDuration){var w=e("<span />");w.addClass("ui-timepicker-duration"),w.text(" ("+g(h-r)+")"),y.append(w)}u>d&&(p>=c[d][0]&&p<c[d][1]?y.addClass("ui-timepicker-disabled"):p>=c[d][1]&&(d+=1)),i.append(y)}o.data("timepicker-input",t),t.data("timepicker-list",o);var C=n.appendTo;"string"==typeof C?C=e(C):"function"==typeof C&&(C=C(t)),C.append(o),s(t,i),i.on("click","li",function(n){t.off("focus.timepicker"),t.on("focus.timepicker-ie-hack",function(){t.off("focus.timepicker-ie-hack"),t.on("focus.timepicker",F.show)}),t[0].focus(),i.find("li").removeClass("ui-timepicker-selected"),e(this).addClass("ui-timepicker-selected"),f(t)&&o.hide()})}function i(){return new Date(1970,1,1,0,0,0)}function o(t){"ontouchstart"in document?e("body").on("touchstart.ui-timepicker",r):(e("body").on("mousedown.ui-timepicker",r),t.closeOnWindowScroll&&e(window).on("scroll.ui-timepicker",r))}function r(t){var n=e(t.target),i=n.closest(".ui-timepicker-input");0===i.length&&0===n.closest(".ui-timepicker-wrapper").length&&(F.hide(),e("body").unbind(".ui-timepicker"),e(window).unbind(".ui-timepicker"))}function a(t,n,i){if(!i&&0!==i)return!1;var o=t.data("timepicker-settings"),r=!1,a=30*o.step;return n.find("li").each(function(t,n){var o=e(n),s=o.data("time")-i;return Math.abs(s)<a||s==a?(r=o,!1):void 0}),r}function s(e,t){t.find("li").removeClass("ui-timepicker-selected");var n=v(c(e));if(n){var i=a(e,t,n);if(i){var o=i.offset().top-t.offset().top;(o+i.outerHeight()>t.outerHeight()||0>o)&&t.scrollTop(t.scrollTop()+i.position().top-i.outerHeight()),i.addClass("ui-timepicker-selected")}}}function l(){if(""!==this.value){var t=e(this),n=v(this.value);if(null===n)return void t.trigger("timeFormatError");var i=t.data("timepicker-settings");if(null!==i.minTime&&n<i.minTime?t.trigger("timeRangeError"):null!==i.maxTime&&n>i.maxTime&&t.trigger("timeRangeError"),e.each(i.disableTimeRanges,function(){return n>=this[0]&&n<this[1]?(t.trigger("timeRangeError"),!1):void 0}),i.forceRoundTime){var o=n%(60*i.step);o>=30*i.step?n+=60*i.step-o:n-=o}var r=m(n,i.timeFormat);d(t,r)}}function c(e){return e.is("input")?e.val():e.data("ui-timepicker-value")}function d(e,t){e.is("input")?e.val(t):e.data("ui-timepicker-value",t)}function u(t){var n=e(this),i=n.data("timepicker-list");if(!i||!i.is(":visible")){if(40!=t.keyCode)return h(t,n);n.focus()}switch(t.keyCode){case 13:return f(n)&&F.hide.apply(this),t.preventDefault(),!1;case 38:var o=i.find(".ui-timepicker-selected");return o.length?o.is(":first-child")||(o.removeClass("ui-timepicker-selected"),o.prev().addClass("ui-timepicker-selected"),o.prev().position().top<o.outerHeight()&&i.scrollTop(i.scrollTop()-o.outerHeight())):(i.find("li").each(function(t,n){return e(n).position().top>0?(o=e(n),!1):void 0}),o.addClass("ui-timepicker-selected")),!1;case 40:return o=i.find(".ui-timepicker-selected"),0===o.length?(i.find("li").each(function(t,n){return e(n).position().top>0?(o=e(n),!1):void 0}),o.addClass("ui-timepicker-selected")):o.is(":last-child")||(o.removeClass("ui-timepicker-selected"),o.next().addClass("ui-timepicker-selected"),o.next().position().top+2*o.outerHeight()>i.outerHeight()&&i.scrollTop(i.scrollTop()+o.outerHeight())),!1;case 27:i.find("li").removeClass("ui-timepicker-selected"),i.hide();break;case 9:F.hide();break;default:return h(t,n)}}function h(e,t){return!t.data("timepicker-settings").disableTextInput||e.ctrlKey||e.altKey||e.metaKey||2!=e.keyCode&&(e.keyCode<46||e.keyCode>90)}function p(t){var n=e(this),i=n.data("timepicker-list");if(!i||!i.is(":visible"))return!0;switch(t.keyCode){case 96:case 97:case 98:case 99:case 100:case 101:case 102:case 103:case 104:case 105:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:case 65:case 77:case 80:case 186:case 8:case 46:s(n,i);break;default:return}}function f(e){var t=e.data("timepicker-settings"),n=e.data("timepicker-list"),i=null,o=n.find(".ui-timepicker-selected");if(o.hasClass("ui-timepicker-disabled"))return!1;if(o.length?i=o.data("time"):c(e)&&(i=v(c(e)),s(e,n)),null!==i){var r=m(i,t.timeFormat);d(e,r)}return e.trigger("change").trigger("changeTime"),!0}function g(e){var t,n=Math.round(e/60);if(Math.abs(n)<60)t=[n,k.mins];else if(60==n)t=["1",k.hr];else{var i=(n/60).toFixed(1);"."!=k.decimal&&(i=i.replace(".",k.decimal)),t=[i,k.hrs]}return t.join(" ")}function m(e,t){if(null!==e){for(var n,i,o=new Date(w.valueOf()+1e3*e),r="",a=0;a<t.length;a++)switch(i=t.charAt(a)){case"a":r+=o.getHours()>11?"pm":"am";break;case"A":r+=o.getHours()>11?"PM":"AM";break;case"g":n=o.getHours()%12,r+=0===n?"12":n;break;case"G":r+=o.getHours();break;case"h":n=o.getHours()%12,0!==n&&10>n&&(n="0"+n),r+=0===n?"12":n;break;case"H":n=o.getHours(),r+=n>9?n:"0"+n;break;case"i":var s=o.getMinutes();r+=s>9?s:"0"+s;break;case"s":e=o.getSeconds(),r+=e>9?e:"0"+e;break;default:r+=i}return r}}function v(e){if(""===e)return null;if(!e||e+0==e)return e;"object"==typeof e&&(e=e.getHours()+":"+y(e.getMinutes())+":"+y(e.getSeconds())),e=e.toLowerCase();var t;new Date(0);if(-1===e.indexOf(":")?(t=e.match(/^([0-9]):?([0-5][0-9])?:?([0-5][0-9])?\s*([pa]?)m?$/),t||(t=e.match(/^([0-2][0-9]):?([0-5][0-9])?:?([0-5][0-9])?\s*([pa]?)m?$/))):t=e.match(/^(\d{1,2})(?::([0-5][0-9]))?(?::([0-5][0-9]))?\s*([pa]?)m?$/),!t)return null;var n,i=parseInt(1*t[1],10);n=t[4]?12==i?"p"==t[4]?12:0:i+("p"==t[4]?12:0):i;var o=1*t[2]||0,r=1*t[3]||0;return 3600*n+60*o+r}function y(e){return("0"+e).slice(-2)}var w=i(),b=86400,C={className:null,minTime:null,maxTime:null,durationTime:null,step:30,showDuration:!1,timeFormat:"g:ia",scrollDefaultNow:!1,scrollDefaultTime:!1,selectOnBlur:!1,disableTouchKeyboard:!0,forceRoundTime:!1,appendTo:"body",disableTimeRanges:[],closeOnWindowScroll:!1,disableTextInput:!1},k={decimal:".",mins:"mins",hr:"hr",hrs:"hrs"},F={init:function(n){return this.each(function(){var i=e(this);if("SELECT"==i[0].tagName){for(var o={type:"text",value:i.val()},r=i[0].attributes,a=0;a<r.length;a++)o[r[a].nodeName]=r[a].nodeValue;var s=e("<input />",o);i.replaceWith(s),i=s}var c=e.extend({},C);n&&(c=e.extend(c,n)),c.lang&&(k=e.extend(k,c.lang)),c=t(c),i.data("timepicker-settings",c),i.prop("autocomplete","off"),i.on("click.timepicker focus.timepicker",F.show),i.on("blur.timepicker",l),i.on("keydown.timepicker",u),i.on("keyup.timepicker",p),i.addClass("ui-timepicker-input"),l.call(i.get(0))})},show:function(t){var i=e(this),r=i.data("timepicker-settings");"ontouchstart"in document&&r.disableTouchKeyboard&&i.blur();var s=i.data("timepicker-list");if(!i.prop("readonly")&&(s&&0!==s.length&&"function"!=typeof r.durationTime||(n(i),s=i.data("timepicker-list")),!s.is(":visible"))){F.hide(),s.show(),i.offset().top+i.outerHeight(!0)+s.outerHeight()>e(window).height()+e(window).scrollTop()?s.offset({left:i.offset().left+parseInt(s.css("marginLeft").replace("px",""),10),top:i.offset().top-s.outerHeight()+parseInt(s.css("marginTop").replace("px",""),10)}):s.offset({left:i.offset().left+parseInt(s.css("marginLeft").replace("px",""),10),top:i.offset().top+i.outerHeight()+parseInt(s.css("marginTop").replace("px",""),10)});var l=s.find(".ui-timepicker-selected");if(l.length||(c(i)?l=a(i,s,v(c(i))):r.scrollDefaultNow?l=a(i,s,v(new Date)):r.scrollDefaultTime!==!1&&(l=a(i,s,v(r.scrollDefaultTime)))),l&&l.length){var d=s.scrollTop()+l.position().top-l.outerHeight();s.scrollTop(d)}else s.scrollTop(0);o(r),i.trigger("showTimepicker")}},hide:function(t){e(".ui-timepicker-wrapper:visible").each(function(){var t=e(this),n=t.data("timepicker-input"),i=n.data("timepicker-settings");i&&i.selectOnBlur&&f(n),t.hide(),n.trigger("hideTimepicker")})},option:function(n,i){var o=this,r=o.data("timepicker-settings"),a=o.data("timepicker-list");if("object"==typeof n)r=e.extend(r,n);else if("string"==typeof n&&"undefined"!=typeof i)r[n]=i;else if("string"==typeof n)return r[n];return r=t(r),o.data("timepicker-settings",r),a&&(a.remove(),o.data("timepicker-list",!1)),o},getSecondsFromMidnight:function(){return v(c(this))},getTime:function(){var e=this,t=new Date;return t.setHours(0,0,0,0),new Date(t.valueOf()+1e3*v(c(e)))},setTime:function(e){var t=this,n=m(v(e),t.data("timepicker-settings").timeFormat);d(t,n)},remove:function(){var e=this;e.hasClass("ui-timepicker-input")&&(e.removeAttr("autocomplete","off"),e.removeClass("ui-timepicker-input"),e.removeData("timepicker-settings"),e.off(".timepicker"),e.data("timepicker-list")&&e.data("timepicker-list").remove(),e.removeData("timepicker-list"))}};e.fn.timepicker=function(t){return F[t]?F[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void e.error("Method "+t+" does not exist on jQuery.timepicker"):F.init.apply(this,arguments)}}),function(e){function t(t,n){function i(){return d.update(),r(),d}function o(){var e=w.toLowerCase();m.obj.css(y,b/f.ratio),p.obj.css(y,-b),k.start=m.obj.offset()[y],f.obj.css(e,g[n.axis]),g.obj.css(e,g[n.axis]),m.obj.css(e,m[n.axis])}function r(){F?h.obj[0].ontouchstart=function(e){1===e.touches.length&&(a(e.touches[0]),e.stopPropagation())}:(m.obj.bind("mousedown",a),g.obj.bind("mouseup",l)),n.scroll&&window.addEventListener?(u[0].addEventListener("DOMMouseScroll",s,!1),u[0].addEventListener("mousewheel",s,!1),u[0].addEventListener("MozMousePixelScroll",function(e){e.preventDefault()},!1)):n.scroll&&(u[0].onmousewheel=s)}function a(t){e("body").addClass("noSelect");var n=parseInt(m.obj.css(y),10);k.start=v?t.pageX:t.pageY,C.start="auto"==n?0:n,F?(document.ontouchmove=function(e){e.preventDefault(),l(e.touches[0])},document.ontouchend=c):(e(document).bind("mousemove",l),e(document).bind("mouseup",c),m.obj.bind("mouseup",c))}function s(i){if(p.ratio<1){var o=i||window.event,r=o.wheelDelta?o.wheelDelta/120:-o.detail/3;b-=r*n.wheel,b=Math.min(p[n.axis]-h[n.axis],Math.max(0,b)),m.obj.css(y,b/f.ratio),p.obj.css(y,-b),(n.lockscroll||b!==p[n.axis]-h[n.axis]&&0!==b)&&(o=e.event.fix(o),o.preventDefault())}t.trigger("scroll")}function l(e){p.ratio<1&&(n.invertscroll&&F?C.now=Math.min(g[n.axis]-m[n.axis],Math.max(0,C.start+(k.start-(v?e.pageX:e.pageY)))):C.now=Math.min(g[n.axis]-m[n.axis],Math.max(0,C.start+((v?e.pageX:e.pageY)-k.start))),b=C.now*f.ratio,p.obj.css(y,-b),m.obj.css(y,C.now)),t.trigger("scroll")}function c(){e("body").removeClass("noSelect"),e(document).unbind("mousemove",l),e(document).unbind("mouseup",c),m.obj.unbind("mouseup",c),document.ontouchmove=document.ontouchend=null,t.trigger("scroll")}var d=this,u=t,h={obj:e(".viewport",t)},p={obj:e(".overview",t)},f={obj:e(".scrollbar",t)},g={obj:e(".track",f.obj)},m={obj:e(".thumb",f.obj)},v="x"===n.axis,y=v?"left":"top",w=v?"Width":"Height",b=0,C={start:0,now:0},k={},F="ontouchstart"in document.documentElement;return this.update=function(e){h[n.axis]=h.obj[0]["offset"+w],p[n.axis]=p.obj[0]["scroll"+w],p.ratio=h[n.axis]/p[n.axis],f.obj.toggleClass("disable",p.ratio>=1),g[n.axis]="auto"===n.size?h[n.axis]-10:n.size,m[n.axis]=Math.min(g[n.axis],Math.max(0,"auto"===n.sizethumb?g[n.axis]*p.ratio:n.sizethumb)),f.ratio="auto"===n.sizethumb?p[n.axis]/g[n.axis]:(p[n.axis]-h[n.axis])/(g[n.axis]-m[n.axis]),b="relative"===e&&p.ratio<=1?Math.min(p[n.axis]-h[n.axis],Math.max(0,b)):0,b="bottom"===e&&p.ratio<=1?p[n.axis]-h[n.axis]:isNaN(parseInt(e,10))?b:parseInt(e,10),o()},i()}e.tiny=e.tiny||{},e.tiny.scrollbar={options:{axis:"y",wheel:40,scroll:!0,lockscroll:!0,size:"auto",sizethumb:"auto",invertscroll:!1}},e.fn.tinyscrollbar=function(n){var i=e.extend({},e.tiny.scrollbar.options,n);return this.each(function(){e(this).data("tsb",new t(e(this),i))}),this},e.fn.tinyscrollbar_update=function(t){var n=e(this).data("tsb");return n?e(this).data("tsb").update(t):e(this)}}(jQuery),function(){function e(e){return e.off("mouseenter.tooltip").off("mouseleave.tooltip")}function t(e,t,i){clearTimeout(s),l.is(e)||(l.trigger("chess24:tooltip:hide"),l=e),n(),t.removeClass("cTooltipBoxContainer position-left position-right position-top position-bottom").addClass("jTooltipBox").appendTo(".bodyContainer").css({display:"block"});var r=o(e,t,void 0,void 0,i);t.addClass("position-"+r.side),r.top<0&&(r.top=0),t.css({top:r.top,left:r.left}).stop().animate({opacity:1},d),c.push(t),e.trigger("chess24:tooltip:show")}function n(){c=c.filter(function(e){return r&&e.get(0)===r.get(0)?!0:(e.stop().animate({opacity:0},d,function(){jQuery(this).detach()}),!1)})}function i(e,t,i){!i&&(t.length&&t.is(":hover")||e.length&&e.is(":hover"))||t.data("hideInProgress",!0).stop().animate({opacity:0},d,function(){jQuery(this).removeData("hideInProgress").detach(),e.trigger("chess24:tooltip:hide")}),n()}function o(e,t,n,i,o){function r(){return m>f||v>f?a():y>g||w>g?s():l()}function a(e){function t(){var e,t;return e=m-f-i,t=y-g+Math.round(p/2)+Math.round(g/2),{left:e,top:t,side:"left"}}function n(){var e,t;return e=m+h+i,t=y-g+Math.round(p/2)+Math.round(g/2),{left:e,top:t,side:"right"}}if("left"===e)return t();if("right"===e)return n();if(m>v){if(m>f)return t()}else if(v>f)return n();return l()}function s(e){function t(){var e,t;return e=m-f+Math.round(h/2)+Math.round(f/2),t=y-g-i,{left:e,top:t,side:"top"}}function n(){var e,t;return e=m-f+Math.round(h/2)+Math.round(f/2),t=y+p+i,{left:e,top:t,side:"bottom"}}if("top"===e)return t();if("bottom"===e)return n();if(y>w){if(y>g)return t()}else if(w>g)return n();return l()}function l(){var e,t;return e=m-f+Math.round(h/2)+Math.round(f/2),t=y-g,{left:e,top:t}}n=n||jQuery(window);var c=$("body"),d=c.offset(),u=e.offset();i=void 0===i?10:i;var h=e.outerWidth(),p=e.outerHeight(),f=t.outerWidth(),g=t.outerHeight(),m=u.left-d.left,v=n.outerWidth()-(u.left+h),y=u.top,w=n.outerHeight()-(u.top+p);return["left","right","horizontal"].contains(o)?a(o):["top","bottom","vertical"].contains(o)?s(o):r()}var r,a,s,l=jQuery(),c=[],d=200,u=100;jQuery.fn.tooltip=function(n,o){function l(t){e(t).on("mouseenter.tooltip",d)}function c(t){e(t).on("mouseleave.tooltip",h)}function d(){function e(e){if(!s.data("tooltip-cancelled")){r=jQuery(e),s.data("tooltip-content",r);var o=Math.max(0,(n.showDelay||u)-Date.now()+d);r.data("hideInProgress")&&(r.stop(),o=0),a=setTimeout(function(){s.data("tooltip-cancelled")||s.data("tooltip-content")===r&&(t(s,r,n.side),function(e){r.off("mouseleave.tooltip").on("mouseleave.tooltip",function(){i(s,e)})}(r))},o)}}r=void 0;var s=jQuery(this);s.removeData("tooltip-cancelled");var l=s.data("tooltip-content"),d=Date.now();clearTimeout(a),c(s),!o||!n.invalidate&&l?e(l):o(s,e)}function h(){p(jQuery(this))}function p(e,t){return clearTimeout(a),l(e),r?void function(o){s=setTimeout(function(){i(e,o,t)},n.hideDelay||u)}(r):void e.data("tooltip-cancelled",!0)}var f=jQuery(this);return o?f.data("builder",o):o=f.data("builder"),"hide"===n?(p(f,!0),this):"reset"===n?(e(this),this.removeData("tooltip-content"),this):(l(this),this)}}(),function(e){function t(e){if(e in u.style)return e;var t=["Moz","Webkit","O","ms"],n=e.charAt(0).toUpperCase()+e.substr(1);if(e in u.style)return e;for(var i=0;i<t.length;++i){var o=t[i]+n;if(o in u.style)return o}}function n(){return u.style[h.transform]="",u.style[h.transform]="rotateY(90deg)",""!==u.style[h.transform]}function i(e){return"string"==typeof e&&this.parse(e),this}function o(e,t,n){t===!0?e.queue(n):t?e.queue(t,n):n()}function r(t){var n=[];return e.each(t,function(t){t=e.camelCase(t),t=e.transit.propertyMap[t]||e.cssProps[t]||t,t=l(t),-1===e.inArray(t,n)&&n.push(t)}),n}function a(t,n,i,o){var a=r(t);e.cssEase[i]&&(i=e.cssEase[i]);var s=""+d(n)+" "+i;parseInt(o,10)>0&&(s+=" "+d(o));var l=[];return e.each(a,function(e,t){l.push(t+" "+s)}),l.join(", ")}function s(t,n){n||(e.cssNumber[t]=!0),e.transit.propertyMap[t]=h.transform,e.cssHooks[t]={get:function(n){var i=e(n).css("transit:transform");return i.get(t)},set:function(n,i){var o=e(n).css("transit:transform");o.setFromString(t,i),e(n).css({"transit:transform":o})}}}function l(e){return e.replace(/([A-Z])/g,function(e){return"-"+e.toLowerCase()})}function c(e,t){return"string"!=typeof e||e.match(/^[\-0-9\.]+$/)?""+e+t:e}function d(t){var n=t;return e.fx.speeds[n]&&(n=e.fx.speeds[n]),c(n,"ms")}e.transit={version:"0.9.9",propertyMap:{marginLeft:"margin",marginRight:"margin",marginBottom:"margin",marginTop:"margin",paddingLeft:"padding",paddingRight:"padding",paddingBottom:"padding",paddingTop:"padding"},enabled:!0,useTransitionEnd:!1};var u=document.createElement("div"),h={},p=navigator.userAgent.toLowerCase().indexOf("chrome")>-1;h.transition=t("transition"),h.transitionDelay=t("transitionDelay"),h.transform=t("transform"),h.transformOrigin=t("transformOrigin"),h.transform3d=n();var f={transition:"transitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",WebkitTransition:"webkitTransitionEnd",msTransition:"MSTransitionEnd"},g=h.transitionEnd=f[h.transition]||null;for(var m in h)h.hasOwnProperty(m)&&"undefined"==typeof e.support[m]&&(e.support[m]=h[m]);u=null,e.cssEase={_default:"ease","in":"ease-in",out:"ease-out","in-out":"ease-in-out",snap:"cubic-bezier(0,1,.5,1)",easeOutCubic:"cubic-bezier(.215,.61,.355,1)",easeInOutCubic:"cubic-bezier(.645,.045,.355,1)",easeInCirc:"cubic-bezier(.6,.04,.98,.335)",easeOutCirc:"cubic-bezier(.075,.82,.165,1)",easeInOutCirc:"cubic-bezier(.785,.135,.15,.86)",easeInExpo:"cubic-bezier(.95,.05,.795,.035)",easeOutExpo:"cubic-bezier(.19,1,.22,1)",easeInOutExpo:"cubic-bezier(1,0,0,1)",easeInQuad:"cubic-bezier(.55,.085,.68,.53)",easeOutQuad:"cubic-bezier(.25,.46,.45,.94)",easeInOutQuad:"cubic-bezier(.455,.03,.515,.955)",easeInQuart:"cubic-bezier(.895,.03,.685,.22)",easeOutQuart:"cubic-bezier(.165,.84,.44,1)",easeInOutQuart:"cubic-bezier(.77,0,.175,1)",easeInQuint:"cubic-bezier(.755,.05,.855,.06)",easeOutQuint:"cubic-bezier(.23,1,.32,1)",easeInOutQuint:"cubic-bezier(.86,0,.07,1)",easeInSine:"cubic-bezier(.47,0,.745,.715)",easeOutSine:"cubic-bezier(.39,.575,.565,1)",easeInOutSine:"cubic-bezier(.445,.05,.55,.95)",easeInBack:"cubic-bezier(.6,-.28,.735,.045)",easeOutBack:"cubic-bezier(.175, .885,.32,1.275)",easeInOutBack:"cubic-bezier(.68,-.55,.265,1.55)"},e.cssHooks["transit:transform"]={get:function(t){return e(t).data("transform")||new i},set:function(t,n){var o=n;o instanceof i||(o=new i(o)),"WebkitTransform"!==h.transform||p?t.style[h.transform]=o.toString():t.style[h.transform]=o.toString(!0),e(t).data("transform",o)}},e.cssHooks.transform={set:e.cssHooks["transit:transform"].set},e.fn.jquery<"1.8"&&(e.cssHooks.transformOrigin={get:function(e){return e.style[h.transformOrigin]},set:function(e,t){e.style[h.transformOrigin]=t}},e.cssHooks.transition={get:function(e){return e.style[h.transition]},set:function(e,t){e.style[h.transition]=t}}),s("scale"),s("translate"),s("rotate"),s("rotateX"),s("rotateY"),s("rotate3d"),s("perspective"),s("skewX"),s("skewY"),s("x",!0),s("y",!0),i.prototype={setFromString:function(e,t){var n="string"==typeof t?t.split(","):t.constructor===Array?t:[t];
n.unshift(e),i.prototype.set.apply(this,n)},set:function(e){var t=Array.prototype.slice.apply(arguments,[1]);this.setter[e]?this.setter[e].apply(this,t):this[e]=t.join(",")},get:function(e){return this.getter[e]?this.getter[e].apply(this):this[e]||0},setter:{rotate:function(e){this.rotate=c(e,"deg")},rotateX:function(e){this.rotateX=c(e,"deg")},rotateY:function(e){this.rotateY=c(e,"deg")},scale:function(e,t){void 0===t&&(t=e),this.scale=e+","+t},skewX:function(e){this.skewX=c(e,"deg")},skewY:function(e){this.skewY=c(e,"deg")},perspective:function(e){this.perspective=c(e,"px")},x:function(e){this.set("translate",e,null)},y:function(e){this.set("translate",null,e)},translate:function(e,t){void 0===this._translateX&&(this._translateX=0),void 0===this._translateY&&(this._translateY=0),null!==e&&void 0!==e&&(this._translateX=c(e,"px")),null!==t&&void 0!==t&&(this._translateY=c(t,"px")),this.translate=this._translateX+","+this._translateY}},getter:{x:function(){return this._translateX||0},y:function(){return this._translateY||0},scale:function(){var e=(this.scale||"1,1").split(",");return e[0]&&(e[0]=parseFloat(e[0])),e[1]&&(e[1]=parseFloat(e[1])),e[0]===e[1]?e[0]:e},rotate3d:function(){for(var e=(this.rotate3d||"0,0,0,0deg").split(","),t=0;3>=t;++t)e[t]&&(e[t]=parseFloat(e[t]));return e[3]&&(e[3]=c(e[3],"deg")),e}},parse:function(e){var t=this;e.replace(/([a-zA-Z0-9]+)\((.*?)\)/g,function(e,n,i){t.setFromString(n,i)})},toString:function(e){var t=[];for(var n in this)if(this.hasOwnProperty(n)){if(!h.transform3d&&("rotateX"===n||"rotateY"===n||"perspective"===n||"transformOrigin"===n))continue;"_"!==n[0]&&(e&&"scale"===n?t.push(n+"3d("+this[n]+",1)"):e&&"translate"===n?t.push(n+"3d("+this[n]+",0)"):t.push(n+"("+this[n]+")"))}return t.join(" ")}},e.fn.transition=e.fn.transit=function(t,n,i,r){var s=this,l=0,c=!0;"function"==typeof n&&(r=n,n=void 0),"function"==typeof i&&(r=i,i=void 0),"undefined"!=typeof t.easing&&(i=t.easing,delete t.easing),"undefined"!=typeof t.duration&&(n=t.duration,delete t.duration),"undefined"!=typeof t.complete&&(r=t.complete,delete t.complete),"undefined"!=typeof t.queue&&(c=t.queue,delete t.queue),"undefined"!=typeof t.delay&&(l=t.delay,delete t.delay),"undefined"==typeof n&&(n=e.fx.speeds._default),"undefined"==typeof i&&(i=e.cssEase._default),n=d(n);var u=a(t,n,i,l),p=e.transit.enabled&&h.transition,f=p?parseInt(n,10)+parseInt(l,10):0;if(0===f){var m=function(e){s.css(t),r&&r.apply(s),e&&e()};return o(s,c,m),s}var v={},y=function(n){var i=!1,o=function(){i&&s.unbind(g,o),f>0&&s.each(function(){this.style[h.transition]=v[this]||null}),"function"==typeof r&&r.apply(s),"function"==typeof n&&n()};f>0&&g&&e.transit.useTransitionEnd?(i=!0,s.bind(g,o)):window.setTimeout(o,f),s.each(function(){f>0&&(this.style[h.transition]=u),e(this).css(t)})},w=function(e){this.offsetWidth,y(e)};return o(s,c,w),this},e.transit.getTransitionValue=a}(jQuery),jQuery.fn.translationTable=function(){function e(e){function t(){s.find(".translationCell").on("click",function(){o.showCurrentEditCell(this)}),jQuery(s).on("keyup",".cellEditField",function(e){o.handleEditFieldKeyup(e)}),jQuery(s).on("click",".translationCellSaveBtn",function(e){o.saveCurrentField()})}var n="idle",i="saving",o=this,r=jQuery('link[rel="js-save-translation"]').attr("href"),a=jQuery(e),s=a.find("table"),l=s.data("itemtype"),c=s.data("itemid"),d=null,u=null;return o.showCurrentEditCell=function(e){if(jQuery(e).data("isEdited"))return!0;if(u==i)return o.flashCurrentCell(),!1;o.cancelCurrentCell(),d=jQuery(e),d.data("isEdited",!0),d.addClass("isEdited"),u=n,o.getCurrentHeader().addClass("expandedColumn"),d.find(".viewPart").hide(),d.find(".editPart").show();var t=d.parent("tr");if("image"!==t.data("property")){var r=d.find(".viewPart").html();d.find(".cellEditField").val(r).focus()}},o.cancelCurrentCell=function(){return u==i?!1:null==d?!0:(o.getCurrentHeader().removeClass("expandedColumn"),d.find(".viewPart").show(),d.find(".editPart").hide(),d.data("isEdited",!1),d.removeClass("isEdited"),d.find(".translationCellSaveBtn").show(),void d.find(".translationCellLoader").hide())},o.getCurrentHeader=function(){if(null==d)return null;var e=d.index(),t=s.find("thead th").get(e);return jQuery(t)},o.handleEditFieldKeyup=function(e){27==e.keyCode?o.cancelCurrentCell():10!=e.keyCode&&13!=e.keyCode||!e.ctrlKey||o.saveCurrentField()},o.saveCurrentField=function(){if(u==i)return!1;u=i,d.find(".translationCellSaveBtn").hide(),d.find(".translationCellLoader").show();var e=d.parent("tr");if("image"==e.data("property"))var t=d.find('input[name="BadgeForm[image]"]').val();else var t=d.find(".cellEditField").val();jQuery.ajax({url:r,data:{itemType:l,itemId:c,property:e.data("property"),sourceId:e.data("sourceid"),lang:d.data("lang"),value:t},dataType:"json",success:function(t){if(t&&0===t.status&&t.data)if(e.data("sourceid",t.data.sourceId),"image"==e.data("property")){var i=d.find(".badgePreview").attr("src");d.find(".badgePreview").attr("src",t.data.fieldValue),t.data.isDefault&&e.find('.badgePreview[src="'+i+'"]').attr("src",t.data.fieldValue),d.find(".inputFileUpload input").val("")}else d.find(".viewPart").html(t.data.fieldValue);u=n,o.cancelCurrentCell()},error:function(e,t,i){u=n,o.cancelCurrentCell()}})},o.flashCurrentCell=function(e,t){d.stop(!0,!0);var n=e||"#FFFF9C",i=t||1500,o=d.css("backgroundColor");d.css("background-color",n).animate({backgroundColor:o},i,"swing",function(){jQuery(this).css("backgroundColor","")})},t(),o}return this.each(function(){return jQuery(this).data("translationTable")||jQuery(this).data("translationTable",new e(this)),this})},function(e){function t(e,t){if(!(e.originalEvent.touches.length>1)){e.preventDefault();var n=e.originalEvent.changedTouches[0],i=document.createEvent("MouseEvents");i.initMouseEvent(t,!0,!0,window,1,n.screenX,n.screenY,n.clientX,n.clientY,!1,!1,!1,!1,0,null),e.target.dispatchEvent(i)}}if(e.support.touch="ontouchend"in document,e.support.touch){var n,i=e.ui.mouse.prototype,o=i._mouseInit,r=i._mouseDestroy;i._touchStart=function(e){var i=this;!n&&i._mouseCapture(e.originalEvent.changedTouches[0])&&(n=!0,i._touchMoved=!1,t(e,"mouseover"),t(e,"mousemove"),t(e,"mousedown"))},i._touchMove=function(e){n&&(this._touchMoved=!0,t(e,"mousemove"))},i._touchEnd=function(e){n&&(t(e,"mouseup"),t(e,"mouseout"),this._touchMoved||t(e,"click"),n=!1)},i._mouseInit=function(){var t=this;t.element.bind({touchstart:e.proxy(t,"_touchStart"),touchmove:e.proxy(t,"_touchMove"),touchend:e.proxy(t,"_touchEnd")}),o.call(t)},i._mouseDestroy=function(){var t=this;t.element.unbind({touchstart:e.proxy(t,"_touchStart"),touchmove:e.proxy(t,"_touchMove"),touchend:e.proxy(t,"_touchEnd")}),r.call(t)}}}(jQuery),function(){jQuery.fn.videoDisplay=function(e,t,n,i){try{e=JSON.parse(e)}catch(o){errorHandler.error(o,e)}var r="/api/web/videoSeriesAPI/videoDescription",a=new Handler.Template("videoSeries");this.each(function(){var o=jQuery(this);jQuery.getJSON(r+"?id="+e.id+(e.series_id?"&series_id="+e.series_id:"")).fail(function(e,t,n){errorHandler.critical(new Error("unable to load json cuefile"),{textStatus:t})}).done(function(e){var r=a.render("videoContainer",{authorName:e.metadata.author,authorFideTitle:e.metadata.authorFideTitle,userCode:i,languages:[{lang:e.metadata.language}]});if(e.engineData)for(var s in e.engineData)Handler.engine.set(s,"remote",e.engineData[s]);o.html(r);for(var l=o.find(".chessBoardContainerContent"),c=o.find(".videoContainer"),d=o.find(".chessNotationContainer"),u=o.find(".videoControlContainer"),h=o.find(".userMoveModeMarker"),p=new Chess.GameHandler,f=new Chess.GameHandler,g=0;g<e.games.length;g++){for(var m=e.games[g],v=m.moves[0].fen,y=new Chess.Game({fen:v}).setSource("remote").setCheckForGameEnd(!1).setMoveMode({duringGame:{mainline:!1,sideline:!0},afterGame:{mainline:!1,sideline:!0}}).setRules("analyse"),w=new Chess.Game({fen:v}).setSource("remote").setCheckForGameEnd(!1).setMoveMode({duringGame:{mainline:!1,sideline:!0},afterGame:{mainline:!1,sideline:!0}}).setRules("analyse"),b=0;b<m.moves.length;b++){var C=m.moves[b];if(C.m){y.move(C.m,parseInt(C.pm,10),!C.m,C.id,"remote");var k=y.getLastAddedPosition();C.lineNumber||k.isInMainline()||y.promote(k),C.glyphs&&y.setGlyphes(C.glyphs,k),C.postComment&&config.level().isAdmin&&y.setComment(C.postComment,k)}if(C.highlights){for(var F=0;F<C.highlights.length;F++){var x=C.highlights[F];C.highlights[F]={color:x.color},"square"===x.type?C.highlights[F].frame=Chess.getSquare(x.y,x.x):"arrow"===x.type&&(C.highlights[F].line=Chess.translate.canToMove(x.from+x.to))}y.setHighlights(C.highlights,C.id)}if(!C.m){for(var T=[],_=y.getLastAddedPosition();_.parentMove;)T.unshift(_),_=_.parentMove;for(var E=0;E<T.length;E++){var S=T[E];w.move(S.moveCoords,void 0,!0,S.knotId,"remote"),S.hasGlyphes()&&w.setGlyphes(S.getGlyphes()),S.comment&&y.setComment(S.comment)}}}y.link(f,g),w.updateNextFreeKnotId(1e6).link(p,g)}for(var j=e.cuepoints,E=0;E<j.length;E++)j[E].index=E;var I=(new Handler.Keyboard).link(p);Handler.KeyboardDispatcher.add(I,l),new View.ChessBoard(l).link(p),new View.NotationArea(d,"videoDisplay").link(p),new View.UserMoveMode(h,"top").link(p),new View.Video(c,u,f,j,t,n).link(p);var A=c.data("flowplayer"),O=u.find(".fp-timeline");o.data("chessGameHandler",p),o.trigger("videoDisplayInitialized",{exerciseGroups:e.exerciseGroups,videoApi:A,timeline:O}),c.flowplayerErrorHandler()})})}}(),function(){var e={},t={},n={},i="videoSeries",o="ebook",r="CONTENT";jQuery.fn.addVideoSeriesPurchasePopUp=function(){var a=new Handler.Template("video").append(new Handler.Template);return this.each(function(){function s(){var r=d.data("content-type");void 0===r&&errorHandler.msg("warning",new Error("missing content type"),!0);var s=d.data("content-id");void 0===s&&errorHandler.msg("warning",new Error("missing content id"),!0);var u=r+"-"+s;if(Handler.tracking("single-purchase","open-dialog",u),t[u])return c(t[u],u,r,s);if(l(u),e[u])return!0;e[u]=!0;var h;switch(r){case o:h="/api/web/EbookAPI/ebookInfo?ebook_id="+s;break;case i:h="/api/web/VideoSeriesAPI/seriesInfo?series_id="+s;break;default:errorHandler.msg("warning",new Error("invalid content type: "+r),!0)}return jQuery.getJSON(h).done(function(e){var n;switch(r){case o:n=e.data.ebook,n.contentInfo=a.render("buyEbookInfo");break;case i:n=e.data.series,n.contentInfo=a.render("buySeriesInfo");break;default:errorHandler.msg("warning",new Error("invalid content type: "+r),!0)}t[u]=n,c(t[u],u,r,s,!0)}).fail(function(t,i,o){var r=jQuery.parseJSON(t.responseText);3===r.status?(n[u].modal("hide"),jQuery(".userMenu .login-link").trigger("click"),e[u]=!1):errorHandler.msg("critical",new Error("not able to load data for series purchase"),!1,{seriesId:s,textStatus:i,error:o})}),!0}function l(e){void 0===n[e]&&(n[e]=jQuery(a.render("popupBuyVideoSeries",{key:e,empty:!0})),jQuery("body").append(n[e]),n[e].modal({classes:"modal-payment"})),n[e].modal("show")}function c(e,t,i,o,s){function l(){var e=$(n[t]).find("form");e.append('<input type="hidden" name="content_id" value="'+o+'"/> ').append('<input type="hidden" name="content_type" value="'+i+'"/> '),Handler.VoucherCode.init(e,r,t)}if(s){e.empty=!1,e.key=t,e.isGuest=config.level().isGuest;var c=jQuery(a.render("popupBuyVideoSeries",e));n[t].html(c),n[t].find(".modal-payment__header__close").on("click",function(){l(),n[t].modal("hide")}),n[t].modal("adjust"),layout(c),n[t].find(".modal-payment__content__buy").validatable(),l(),n[t].find(".cBtnPremium").on("click",function(e){var t=jQuery(this).closest("form");if(t.validatable("clientvalidate")!==!1){var n={csrf:config.csrf(),acceptTerms:1,content_type:i,content_id:o,lang:config.language(),voucherCodeName:Handler.VoucherCode.getVoucherCodeValue(),requestType:r};$(".overlay").show(),jQuery.post("/api/web/shopAPI/getPurchaseContentForm",n,function(e){if(e.data&&e.data.redirect){var t=$("span[data-content-id='"+this.content_id+"'][data-content-type='"+this.content_type+"']");if(t){var n=t.closest(".learnItemBox").find(".learnItemBoxLink").attr("href");n?window.location.href=n:location.reload()}}else{var i,o=e.data.form;o.razorpay?(i=Handler.Razorpay.createPaymentForm(o),document.body.appendChild(i),setTimeout(function(){$(".razorpay-payment-button").hide(),$(".razorpay-payment-button").click(),$(".overlay").hide()},100)):(i=Handler.Adyen.createPaymentForm(o),document.body.appendChild(i),i.submit(),$(".overlay").hide())}}.bind(n)),e.preventDefault()}})}else n[t].modal("show"),l()}var d=jQuery(this);return d.data("addBuyContentPopUpInitialized")?this:(d.data("addBuyContentPopUpInitialized",!0),d.on("click",s),this)})}}(),$.fn.waterLabel=function(e){var t=$(this);e=e||t.data("watermark-label");var n=$("<div class='inputWaterlabel'>"+e+"</div>");t.data("pattern-waterlabel")||(t.after(n),n.click(function(){t.focus()}),this.keydown(function(){n.hide()}),t.bind("keyup blur input",function(){$(this).val().length?n.hide():n.show()}),t.focus(function(){n.addClass("input-block-focus")}),t.blur(function(){n.removeClass("input-block-focus")}),t.data("pattern-waterlabel",!0))},function(e){e.wrapTabs=function(t,n){var i=this;i.$el=jQuery(t),i.$nav=i.$el.find(".tabNav"),i.init=function(){i.options=e.extend({},e.wrapTabs.defaultOptions,n),i.$nav.on("click","li > a",null,function(e){if(!(jQuery(this).closest(".disabled").length>0)){if(jQuery(this).next("ul").length>0&&(jQuery(this).closest("li").hasClass("withSubTabs")||jQuery(this).closest(".tabNav").find("li.withSubTabs").each(function(){jQuery(this).removeClass("withSubTabs")})),jQuery(this).closest(".withSubTabs").length<=0&&(jQuery(this).next("ul").length>0?jQuery(this).closest("li").addClass("withSubTabs"):jQuery(".tabNav li").removeClass("withSubTabs")),jQuery(this).next("ul").find("li.autoCurrent").length>0)return void jQuery(this).next("ul").find("li.autoCurrent:first a").click();e.preventDefault();var t=i.$el.find("li.current a").attr("data-tab-content-id"),n=jQuery(this),o=n.attr("data-tab-content-id");if(o!=t&&0==i.$el.find(":animated").length){i.$el.find(".tabContentWrap");i.$el.find("#"+t).trigger("chess24:hide").fadeOut(i.options.speed,function(){i.$el.find("#"+o).trigger("chess24:show").fadeIn(i.options.speed),i.$el.find("#"+t).find(".customTabs section.active, .tabContentWrap > div:not(.hide)").trigger("chess24:hide"),i.$el.find("#"+o).find(".customTabs section.active, .tabContentWrap > div:not(.hide)").trigger("chess24:show"),i.$el.find(".tabNav li").removeClass("current"),n.closest("li").addClass("current")})}return!1}})},i.init()},e.wrapTabs.defaultOptions={speed:0},e.fn.wrapTabs=function(t){return this.each(function(){new e.wrapTabs(this,t)})}}(jQuery),function(e){e.yii={version:"1.0",submitForm:function(t,n,i){var o=e(t).parents("form")[0];o||(o=document.createElement("form"),o.style.display="none",t.parentNode.appendChild(o),o.method="POST"),"string"==typeof n&&""!=n&&(o.action=n),null!=t.target&&(o.target=t.target),i=i||{},i.csrf=config.csrf();var r=[];e.each(i,function(e,t){var n=document.createElement("input");n.setAttribute("type","hidden"),n.setAttribute("name",e),n.setAttribute("value",t),o.appendChild(n),r.push(n)}),e(o).data("submitObject",e(t)),e(o).trigger("submit"),e.each(r,function(){o.removeChild(this)})}}}(jQuery),function(e){var t,n,i=[];t=function(t){var n=i[t],o=e("#"+t).children("."+n.tableClass);return o.children("tbody").find("input.select-on-check").filter(":checked").each(function(){e(this).closest("tr").addClass("selected")}),o.children("thead").find("th input").filter('[type="checkbox"]').each(function(){var t=this.name.substring(0,this.name.length-4)+"[]",n=e("input[name='"+t+"']",o);this.checked=n.length>0&&n.length===n.filter(":checked").length}),this},n={init:function(n){var o=e.extend({ajaxUpdate:[],ajaxVar:"ajax",pagerClass:"pager",loadingClass:"loading",filterClass:"filters",tableClass:"items",selectableRows:1},n||{});return o.tableClass=o.tableClass.replace(/\s+/g,"."),this.each(function(){var n,r=e(this),a=r.attr("id"),s="#"+a+" ."+o.pagerClass.replace(/\s+/g,".")+" a",l="#"+a+" ."+o.tableClass+" thead th a.sort-link",c="#"+a+" ."+o.filterClass+" input, #"+a+" ."+o.filterClass+" select";o.updateSelector=o.updateSelector.replace("{page}",s).replace("{sort}",l),o.filterSelector=o.filterSelector.replace("{filter}",c),i[a]=o,o.ajaxUpdate.length>0&&e(document).on("click.yiiGridView",o.updateSelector,function(){if(o.enableHistory&&window.History.enabled){var t=e(this).attr("href").split("?"),n=e.deparam.querystring("?"+t[1]);delete n[o.ajaxVar],window.History.pushState(null,document.title,decodeURIComponent(e.param.querystring(t[0],n)))}else e("#"+a).yiiGridView("update",{url:e(this).attr("href")});return!1}),e(document).on("change.yiiGridView keydown.yiiGridView",o.filterSelector,function(t){if("keydown"===t.type){if(13!==t.keyCode)return;n="keydown"}else if("keydown"===n)return void(n="");var i=e(o.filterSelector).serialize();if(void 0!==o.pageVar&&(i+="&"+o.pageVar+"=1"),o.enableHistory&&o.ajaxUpdate!==!1&&window.History.enabled){var r=e("#"+a).yiiGridView("getUrl"),s=e.deparam.querystring(e.param.querystring(r,i));delete s[o.ajaxVar],window.History.pushState(null,document.title,decodeURIComponent(e.param.querystring(r.substr(0,r.indexOf("?")),s)))}else e("#"+a).yiiGridView("update",{data:i})}),o.enableHistory&&o.ajaxUpdate!==!1&&window.History.enabled&&e(window).bind("statechange",function(){var t=window.History.getState();e("#"+a).yiiGridView("update",{url:t.url})}),o.selectableRows>0?(t(this.id),e(document).on("click.yiiGridView","#"+a+" ."+o.tableClass+" > tbody > tr",function(t){var n,i,r,s,l=e(t.target);l.closest("td").is(".empty,.button-column")||"checkbox"===t.target.type&&!l.hasClass("select-on-check")||(i=e(this),n=e("#"+a),s=e("input.select-on-check",n),r=i.toggleClass("selected").hasClass("selected"),1===o.selectableRows&&(i.siblings().removeClass("selected"),s.prop("checked",!1)),e("input.select-on-check",i).prop("checked",r),e("input.select-on-check-all",n).prop("checked",s.length===s.filter(":checked").length),void 0!==o.selectionChanged&&o.selectionChanged(a))}),o.selectableRows>1&&e(document).on("click.yiiGridView","#"+a+" .select-on-check-all",function(){var t=e("#"+a),n=e("input.select-on-check",t),i=e("input.select-on-check-all",t),r=t.children("."+o.tableClass).children("tbody").children();this.checked?(r.addClass("selected"),n.prop("checked",!0),i.prop("checked",!0)):(r.removeClass("selected"),n.prop("checked",!1),i.prop("checked",!1)),void 0!==o.selectionChanged&&o.selectionChanged(a)})):e(document).on("click.yiiGridView","#"+a+" .select-on-check",!1)})},getKey:function(e){return this.children(".keys").children("span").eq(e).text()},getUrl:function(){var e=i[this.attr("id")].url;return e||this.children(".keys").attr("title")},getRow:function(e){var t=i[this.attr("id")].tableClass;return this.children("."+t).children("tbody").children("tr").eq(e).children()},getColumn:function(e){var t=i[this.attr("id")].tableClass;return this.children("."+t).children("tbody").children("tr").children("td:nth-child("+(e+1)+")")},update:function(n){var o;return n&&void 0!==n.error&&(o=n.error,delete n.error),this.each(function(){var r,a=e(this),s=a.attr("id"),l=i[s];a.addClass(l.loadingClass),n=e.extend({type:"GET",url:a.yiiGridView("getUrl"),success:function(n){var i=e("<div>"+n+"</div>");a.removeClass(l.loadingClass),e.each(l.ajaxUpdate,function(t,n){var o="#"+n;e(o).replaceWith(e(o,i))}),void 0!==l.afterAjaxUpdate&&l.afterAjaxUpdate(s,n),l.selectableRows>0&&t(s)},error:function(e,t,n){var i,r;if(a.removeClass(l.loadingClass),0!==e.readyState&&0!==e.status&&(void 0===o||(i=o(e),void 0===i||i))){switch(t){case"timeout":r="The request timed out!";break;case"parsererror":r="Parser error!";break;case"error":r=e.status&&!/^\s*$/.test(e.status)?"Error "+e.status:"Error",e.responseText&&!/^\s*$/.test(e.responseText)&&(r=r+": "+e.responseText)}void 0!==l.ajaxUpdateError?l.ajaxUpdateError(e,t,n,r):r&&alert(r)}}},n||{}),void 0!==n.data&&"GET"===n.type&&(n.url=e.param.querystring(n.url,n.data),n.data={}),l.ajaxUpdate!==!1?(n.url=e.param.querystring(n.url,l.ajaxVar+"="+s),void 0!==l.beforeAjaxUpdate&&l.beforeAjaxUpdate(s,n),e.ajax(n)):"GET"===n.type?window.location.href=n.url:(r=e('<form action="'+n.url+'" method="post"></form>').appendTo("body"),void 0===n.data&&(n.data={}),void 0===n.data.returnUrl&&(n.data.returnUrl=window.location.href),e.each(n.data,function(t,n){r.append(e('<input type="hidden" name="t" value="" />').attr("name",t).val(n))}),r.submit())})},getSelection:function(){var t=i[this.attr("id")],n=this.find(".keys span"),o=[];return this.find("."+t.tableClass).children("tbody").children().each(function(t){e(this).hasClass("selected")&&o.push(n.eq(t).text())}),o},getChecked:function(e){var t=i[this.attr("id")],n=this.find(".keys span"),o=[];return"[]"!==e.substring(e.length-2)&&(e+="[]"),this.find("."+t.tableClass).children("tbody").children("tr").children("td").children('input[name="'+e+'"]').each(function(e){this.checked&&o.push(n.eq(e).text())}),o}},e.fn.yiiGridView=function(t){return n[t]?n[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?(e.error("Method "+t+" does not exist on jQuery.yiiGridView"),!1):n.init.apply(this,arguments)},e.fn.yiiGridView.settings=i,e.fn.yiiGridView.getKey=function(t,n){return e("#"+t).yiiGridView("getKey",n)},e.fn.yiiGridView.getUrl=function(t){return e("#"+t).yiiGridView("getUrl")},e.fn.yiiGridView.getRow=function(t,n){return e("#"+t).yiiGridView("getRow",n)},e.fn.yiiGridView.getColumn=function(t,n){return e("#"+t).yiiGridView("getColumn",n)},e.fn.yiiGridView.update=function(t,n){e("#"+t).yiiGridView("update",n)},e.fn.yiiGridView.getSelection=function(t){return e("#"+t).yiiGridView("getSelection")},e.fn.yiiGridView.getChecked=function(t,n){return e("#"+t).yiiGridView("getChecked",n)}}(jQuery),function(e){e.fn.yiiListView=function(t){return this.each(function(){var n=e.extend({},e.fn.yiiListView.defaults,t||{}),i=e(this),o=i.attr("id");void 0==n.updateSelector&&(n.updateSelector="#"+o+" ."+n.pagerClass.replace(/\s+/g,".")+" a, #"+o+" ."+n.sorterClass.replace(/\s+/g,".")+" a"),e.fn.yiiListView.settings[o]=n,n.ajaxUpdate.length>0&&(e(document).on("click.yiiListView",n.updateSelector,function(){if(n.enableHistory&&window.History.enabled){var t=e(this).attr("href").split("?"),i=e.deparam.querystring("?"+t[1]);delete i[n.ajaxVar],window.History.pushState(null,document.title,decodeURIComponent(e.param.querystring(t[0],i)))}else e.fn.yiiListView.update(o,{url:e(this).attr("href")});return!1}),n.enableHistory&&window.History.enabled&&e(window).bind("statechange",function(){var t=window.History.getState();e.fn.yiiListView.update(o,{url:t.url})}))})},e.fn.yiiListView.defaults={ajaxUpdate:[],ajaxVar:"ajax",pagerClass:"pager",loadingClass:"loading",sorterClass:"sorter"},e.fn.yiiListView.settings={},e.fn.yiiListView.getKey=function(t,n){return e("#"+t+" > div.keys > span:eq("+n+")").text()},e.fn.yiiListView.getUrl=function(t){var n=e.fn.yiiListView.settings[t];return n.url||e("#"+t+" > div.keys").attr("title")},e.fn.yiiListView.update=function(t,n){var i,o=e.fn.yiiListView.settings[t];n&&void 0!==n.error&&(i=n.error,delete n.error),e("#"+t).addClass(o.loadingClass),n=e.extend({type:"GET",url:e.fn.yiiListView.getUrl(t),success:function(n,i){e.each(o.ajaxUpdate,function(t,i){var o="#"+i;e(o).replaceWith(e(o,"<div>"+n+"</div>"))}),void 0!=o.afterAjaxUpdate&&o.afterAjaxUpdate(t,n),e("#"+t).removeClass(o.loadingClass)},error:function(n,r,a){var s,l;if(e("#"+t).removeClass(o.loadingClass),0!==n.readyState&&0!==n.status&&(void 0===i||(s=i(n),void 0===s||s))){switch(r){case"timeout":l="The request timed out!";break;case"parsererror":l="Parser error!";break;case"error":l=n.status&&!/^\s*$/.test(n.status)?"Error "+n.status:"Error",n.responseText&&!/^\s*$/.test(n.responseText)&&(l=l+": "+n.responseText)}void 0!==o.ajaxUpdateError?o.ajaxUpdateError(n,r,a,l):l&&alert(l)}}},n||{}),void 0!=n.data&&"GET"==n.type&&(n.url=e.param.querystring(n.url,n.data),n.data={}),n.url=e.param.querystring(n.url,o.ajaxVar+"="+t),void 0!=o.beforeAjaxUpdate&&o.beforeAjaxUpdate(t),e.ajax(n)}}(jQuery);var defaults={tagName:"a",newLine:"\n",target:"_blank",linkClass:null,linkClasses:[],linkAttributes:null};Linkified.prototype={constructor:Linkified,init:function(){1===this.element.nodeType?Linkified.linkifyNode.call(this,this.element):this.element=Linkified.linkify.call(this,this.element.toString())},setOptions:function(e){this.settings=Linkified.extendSettings(e,this.settings)},toString:function(){return this.element.toString()}},Linkified.extendSettings=function(e,t){var n;t=t||{};for(n in defaults)t[n]||(t[n]=defaults[n]);for(n in e)t[n]=e[n];return t},Linkified.linkMatch=new RegExp(["(",'\\s|[^a-zA-Z0-9.\\+_\\/"\\>\\-]|^',")(?:","(","[a-zA-Z0-9\\+_\\-]+","(?:","\\.[a-zA-Z0-9\\+_\\-]+",")*@",")?(","http:\\/\\/|https:\\/\\/|ftp:\\/\\/",")?(","(?:(?:[a-z0-9][a-z0-9_%\\-_+]*\\.)+)",")(","(?:com|ca|co|edu|gov|net|org|dev|biz|cat|int|pro|tel|mil|aero|asia|coop|info|jobs|mobi|museum|name|post|travel|local|[a-z]{2})",")(","(?::\\d{1,5})",")?(","(?:","[\\/|\\?]","(?:","[\\-a-zA-Z0-9_%#*&+=~!?,;:.\\/]*",")*",")","[\\-\\/a-zA-Z0-9_%#*&+=~]","|","\\/?",")?",")(",'[^a-zA-Z0-9\\+_\\/"\\<\\-]|$',")"].join(""),"g"),Linkified.emailLinkMatch=/(<[a-z]+ href=\")(http:\/\/)([a-zA-Z0-9\+_\-]+(?:\.[a-zA-Z0-9\+_\-]+)*@)/g,Linkified.linkify=function(e,t){var n,i,o,r=[];if(this.constructor===Linkified&&this.settings?(i=this.settings,t&&(i=Linkified.extendSettings(t,i))):i=Linkified.extendSettings(t),o=i.linkClass?i.linkClass.split(/\s+/):[],o.push.apply(o,i.linkClasses),e=e.replace(/</g,"&lt;").replace(/(\s)/g,"$1$1"),i.domainWhitelist){var a=Linkified.linkMatch.exec(e);if(a&&a.length>4){var s=a[4]+a[5],l=new RegExp("^(www\\.)?("+i.domainWhitelist.join("|")+")$");if(!l.test(s))return e}}r.push("$1<"+i.tagName,'href="http://$2$4$5$6$7"'),r.push('class="linkified'+(o.length>0?" "+o.join(" "):"")+'"'),i.target&&r.push('target="'+i.target+'"');for(n in i.linkAttributes)r.push([n,'="',i.linkAttributes[n].replace(/\"/g,"&quot;").replace(/\$/g,"&#36;"),'"'].join(""));return r.push(">$2$3$4$5$6$7</"+i.tagName+">$8"),e=e.replace(Linkified.linkMatch,r.join(" ")),e=e.replace(Linkified.emailLinkMatch,"$1mailto:$3"),e=e.replace(/(\s){2}/g,"$1"),e=e.replace(/\n/g,i.newLine)},Linkified.linkifyNode=function(e){var t,n,i,o,r;if(e&&"object"==typeof e&&1===e.nodeType&&"a"!==e.tagName.toLowerCase()&&!/[^\s]linkified[\s$]/.test(e.className)){for(t=[],o=Linkified._dummyElement||document.createElement("div"),n=e.firstChild,i=e.childElementCount;n;){if(3===n.nodeType){for(;o.firstChild;)o.removeChild(o.firstChild);for(o.innerHTML=Linkified.linkify.call(this,n.textContent||n.innerText||n.nodeValue),t.push.apply(t,o.childNodes);o.firstChild;)o.removeChild(o.firstChild)}else 1===n.nodeType?t.push(Linkified.linkifyNode.call(this,n)):t.push(n);n=n.nextSibling}for(;e.firstChild;)e.removeChild(e.firstChild);for(r=0;r<t.length;r++)e.appendChild(t[r])}return e},Linkified._dummyElement=document.createElement("div"),function(e){var t,n,i="0.3.4",o="hasOwnProperty",r=/[\.\/]/,a="*",s=function(){},l=function(e,t){return e-t},c={n:{}},d=function(e,i){var o,r=n,a=Array.prototype.slice.call(arguments,2),s=d.listeners(e),c=0,u=[],h={},p=[],f=t;t=e,n=0;for(var g=0,m=s.length;m>g;g++)"zIndex"in s[g]&&(u.push(s[g].zIndex),s[g].zIndex<0&&(h[s[g].zIndex]=s[g]));for(u.sort(l);u[c]<0;)if(o=h[u[c++]],p.push(o.apply(i,a)),n)return n=r,p;for(g=0;m>g;g++)if(o=s[g],"zIndex"in o)if(o.zIndex==u[c]){if(p.push(o.apply(i,a)),n)break;do if(c++,o=h[u[c]],o&&p.push(o.apply(i,a)),n)break;while(o)}else h[o.zIndex]=o;else if(p.push(o.apply(i,a)),n)break;return n=r,t=f,p.length?p:null};d.listeners=function(e){var t,n,i,o,s,l,d,u,h=e.split(r),p=c,f=[p],g=[];for(o=0,s=h.length;s>o;o++){for(u=[],l=0,d=f.length;d>l;l++)for(p=f[l].n,n=[p[h[o]],p[a]],i=2;i--;)t=n[i],t&&(u.push(t),g=g.concat(t.f||[]));f=u}return g},d.on=function(e,t){for(var n=e.split(r),i=c,o=0,a=n.length;a>o;o++)i=i.n,!i[n[o]]&&(i[n[o]]={n:{}}),i=i[n[o]];for(i.f=i.f||[],o=0,a=i.f.length;a>o;o++)if(i.f[o]==t)return s;return i.f.push(t),function(e){+e==+e&&(t.zIndex=+e)}},d.stop=function(){n=1},d.nt=function(e){return e?new RegExp("(?:\\.|\\/|^)"+e+"(?:\\.|\\/|$)").test(t):t},d.off=d.unbind=function(e,t){var n,i,s,l,d,u,h,p=e.split(r),f=[c];for(l=0,d=p.length;d>l;l++)for(u=0;u<f.length;u+=s.length-2){if(s=[u,1],n=f[u].n,p[l]!=a)n[p[l]]&&s.push(n[p[l]]);else for(i in n)n[o](i)&&s.push(n[i]);f.splice.apply(f,s)}for(l=0,d=f.length;d>l;l++)for(n=f[l];n.n;){if(t){if(n.f){for(u=0,h=n.f.length;h>u;u++)if(n.f[u]==t){n.f.splice(u,1);break}!n.f.length&&delete n.f}for(i in n.n)if(n.n[o](i)&&n.n[i].f){var g=n.n[i].f;for(u=0,h=g.length;h>u;u++)if(g[u]==t){g.splice(u,1);break}!g.length&&delete n.n[i].f}}else{delete n.f;for(i in n.n)n.n[o](i)&&n.n[i].f&&delete n.n[i].f}n=n.n}},d.once=function(e,t){var n=function(){var i=t.apply(this,arguments);return d.unbind(e,n),i};return d.on(e,n)},d.version=i,d.toString=function(){return"You are running Eve "+i},"undefined"!=typeof module&&module.exports?module.exports=d:"undefined"!=typeof define?define("eve",[],function(){return d}):e.eve=d}(this),function(){function e(t){if(e.is(t,"function"))return y?t():eve.on("raphael.DOMload",t);if(e.is(t,z))return e._engine.create[E](e,t.splice(0,3+e.is(t[0],V))).add(t);var n=Array.prototype.slice.call(arguments,0);if(e.is(n[n.length-1],"function")){var i=n.pop();return y?i.call(e._engine.create[E](e,n)):eve.on("raphael.DOMload",function(){i.call(e._engine.create[E](e,n))})}return e._engine.create[E](e,arguments)}function t(e){if(Object(e)!==e)return e;var n=new e.constructor;for(var i in e)e[F](i)&&(n[i]=t(e[i]));return n}function n(e,t){for(var n=0,i=e.length;i>n;n++)if(e[n]===t)return e.push(e.splice(n,1)[0])}function i(e,t,i){function o(){var r=Array.prototype.slice.call(arguments,0),a=r.join("␀"),s=o.cache=o.cache||{},l=o.count=o.count||[];return s[F](a)?(n(l,a),i?i(s[a]):s[a]):(l.length>=1e3&&delete s[l.shift()],l.push(a),s[a]=e[E](t,r),i?i(s[a]):s[a])}return o}function o(){return this.hex}function r(e,t){for(var n=[],i=0,o=e.length;o-2*!t>i;i+=2){var r=[{x:+e[i-2],y:+e[i-1]},{x:+e[i],y:+e[i+1]},{x:+e[i+2],y:+e[i+3]},{x:+e[i+4],y:+e[i+5]}];t?i?o-4==i?r[3]={x:+e[0],y:+e[1]}:o-2==i&&(r[2]={x:+e[0],y:+e[1]},r[3]={x:+e[2],y:+e[3]}):r[0]={x:+e[o-2],y:+e[o-1]}:o-4==i?r[3]=r[2]:i||(r[0]={x:+e[i],y:+e[i+1]}),n.push(["C",(-r[0].x+6*r[1].x+r[2].x)/6,(-r[0].y+6*r[1].y+r[2].y)/6,(r[1].x+6*r[2].x-r[3].x)/6,(r[1].y+6*r[2].y-r[3].y)/6,r[2].x,r[2].y])}return n}function a(e,t,n,i,o){var r=-3*t+9*n-9*i+3*o,a=e*r+6*t-12*n+6*i;return e*a-3*t+3*n}function s(e,t,n,i,o,r,s,l,c){null==c&&(c=1),c=c>1?1:0>c?0:c;for(var d=c/2,u=12,h=[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816],p=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],f=0,g=0;u>g;g++){var m=d*h[g]+d,v=a(m,e,n,o,s),y=a(m,t,i,r,l),w=v*v+y*y;f+=p[g]*L.sqrt(w)}return d*f}function l(e,t,n,i,o,r,a,l,c){if(!(0>c||s(e,t,n,i,o,r,a,l)<c)){var d,u=1,h=u/2,p=u-h,f=.01;for(d=s(e,t,n,i,o,r,a,l,p);Q(d-c)>f;)h/=2,p+=(c>d?1:-1)*h,d=s(e,t,n,i,o,r,a,l,p);return p}}function c(e,t,n,i,o,r,a,s){if(!(N(e,n)<D(o,a)||D(e,n)>N(o,a)||N(t,i)<D(r,s)||D(t,i)>N(r,s))){var l=(e*i-t*n)*(o-a)-(e-n)*(o*s-r*a),c=(e*i-t*n)*(r-s)-(t-i)*(o*s-r*a),d=(e-n)*(r-s)-(t-i)*(o-a);if(d){var u=l/d,h=c/d,p=+u.toFixed(2),f=+h.toFixed(2);if(!(p<+D(e,n).toFixed(2)||p>+N(e,n).toFixed(2)||p<+D(o,a).toFixed(2)||p>+N(o,a).toFixed(2)||f<+D(t,i).toFixed(2)||f>+N(t,i).toFixed(2)||f<+D(r,s).toFixed(2)||f>+N(r,s).toFixed(2)))return{x:u,y:h}}}}function d(t,n,i){var o=e.bezierBBox(t),r=e.bezierBBox(n);if(!e.isBBoxIntersect(o,r))return i?0:[];for(var a=s.apply(0,t),l=s.apply(0,n),d=~~(a/5),u=~~(l/5),h=[],p=[],f={},g=i?0:[],m=0;d+1>m;m++){var v=e.findDotsAtSegment.apply(e,t.concat(m/d));h.push({x:v.x,y:v.y,t:m/d})}for(m=0;u+1>m;m++)v=e.findDotsAtSegment.apply(e,n.concat(m/u)),p.push({x:v.x,y:v.y,t:m/u});for(m=0;d>m;m++)for(var y=0;u>y;y++){var w=h[m],b=h[m+1],C=p[y],k=p[y+1],F=Q(b.x-w.x)<.001?"y":"x",x=Q(k.x-C.x)<.001?"y":"x",T=c(w.x,w.y,b.x,b.y,C.x,C.y,k.x,k.y);
if(T){if(f[T.x.toFixed(4)]==T.y.toFixed(4))continue;f[T.x.toFixed(4)]=T.y.toFixed(4);var _=w.t+Q((T[F]-w[F])/(b[F]-w[F]))*(b.t-w.t),E=C.t+Q((T[x]-C[x])/(k[x]-C[x]))*(k.t-C.t);_>=0&&1>=_&&E>=0&&1>=E&&(i?g++:g.push({x:T.x,y:T.y,t1:_,t2:E}))}}return g}function u(t,n,i){t=e._path2curve(t),n=e._path2curve(n);for(var o,r,a,s,l,c,u,h,p,f,g=i?0:[],m=0,v=t.length;v>m;m++){var y=t[m];if("M"==y[0])o=l=y[1],r=c=y[2];else{"C"==y[0]?(p=[o,r].concat(y.slice(1)),o=p[6],r=p[7]):(p=[o,r,o,r,l,c,l,c],o=l,r=c);for(var w=0,b=n.length;b>w;w++){var C=n[w];if("M"==C[0])a=u=C[1],s=h=C[2];else{"C"==C[0]?(f=[a,s].concat(C.slice(1)),a=f[6],s=f[7]):(f=[a,s,a,s,u,h,u,h],a=u,s=h);var k=d(p,f,i);if(i)g+=k;else{for(var F=0,x=k.length;x>F;F++)k[F].segment1=m,k[F].segment2=w,k[F].bez1=p,k[F].bez2=f;g=g.concat(k)}}}}}return g}function h(e,t,n,i,o,r){null!=e?(this.a=+e,this.b=+t,this.c=+n,this.d=+i,this.e=+o,this.f=+r):(this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0)}function p(){return this.x+A+this.y+A+this.width+" × "+this.height}function f(e,t,n,i,o,r){function a(e){return((u*e+d)*e+c)*e}function s(e,t){var n=l(e,t);return((f*n+p)*n+h)*n}function l(e,t){var n,i,o,r,s,l;for(o=e,l=0;8>l;l++){if(r=a(o)-e,Q(r)<t)return o;if(s=(3*u*o+2*d)*o+c,Q(s)<1e-6)break;o-=r/s}if(n=0,i=1,o=e,n>o)return n;if(o>i)return i;for(;i>n;){if(r=a(o),Q(r-e)<t)return o;e>r?n=o:i=o,o=(i-n)/2+n}return o}var c=3*t,d=3*(i-t)-c,u=1-c-d,h=3*n,p=3*(o-n)-h,f=1-h-p;return s(e,1/(200*r))}function g(e,t){var n=[],i={};if(this.ms=t,this.times=1,e){for(var o in e)e[F](o)&&(i[J(o)]=e[o],n.push(J(o)));n.sort(ce)}this.anim=i,this.top=n[n.length-1],this.percents=n}function m(t,n,i,o,r,a){i=J(i);var s,l,c,d,u,p,g=t.ms,m={},v={},y={};if(o)for(C=0,k=rt.length;k>C;C++){var w=rt[C];if(w.el.id==n.id&&w.anim==t){w.percent!=i?(rt.splice(C,1),c=1):l=w,n.attr(w.totalOrigin);break}}else o=+v;for(var C=0,k=t.percents.length;k>C;C++){if(t.percents[C]==i||t.percents[C]>o*t.top){i=t.percents[C],u=t.percents[C-1]||0,g=g/t.top*(i-u),d=t.percents[C+1],s=t.anim[i];break}o&&n.attr(t.anim[t.percents[C]])}if(s){if(l)l.initstatus=o,l.start=new Date-l.ms*o;else{for(var x in s)if(s[F](x)&&(te[F](x)||n.paper.customAttributes[F](x)))switch(m[x]=n.attr(x),null==m[x]&&(m[x]=ee[x]),v[x]=s[x],te[x]){case V:y[x]=(v[x]-m[x])/g;break;case"colour":m[x]=e.getRGB(m[x]);var T=e.getRGB(v[x]);y[x]={r:(T.r-m[x].r)/g,g:(T.g-m[x].g)/g,b:(T.b-m[x].b)/g};break;case"path":var _=Pe(m[x],v[x]),E=_[1];for(m[x]=_[0],y[x]=[],C=0,k=m[x].length;k>C;C++){y[x][C]=[0];for(var j=1,I=m[x][C].length;I>j;j++)y[x][C][j]=(E[C][j]-m[x][C][j])/g}break;case"transform":var A=n._,P=De(A[x],v[x]);if(P)for(m[x]=P.from,v[x]=P.to,y[x]=[],y[x].real=!0,C=0,k=m[x].length;k>C;C++)for(y[x][C]=[m[x][C][0]],j=1,I=m[x][C].length;I>j;j++)y[x][C][j]=(v[x][C][j]-m[x][C][j])/g;else{var B=n.matrix||new h,R={_:{transform:A.transform},getBBox:function(){return n.getBBox(1)}};m[x]=[B.a,B.b,B.c,B.d,B.e,B.f],Le(R,v[x]),v[x]=R._.transform,y[x]=[(R.matrix.a-B.a)/g,(R.matrix.b-B.b)/g,(R.matrix.c-B.c)/g,(R.matrix.d-B.d)/g,(R.matrix.e-B.e)/g,(R.matrix.f-B.f)/g]}break;case"csv":var L=O(s[x])[M](b),N=O(m[x])[M](b);if("clip-rect"==x)for(m[x]=N,y[x]=[],C=N.length;C--;)y[x][C]=(L[C]-m[x][C])/g;v[x]=L;break;default:for(L=[][S](s[x]),N=[][S](m[x]),y[x]=[],C=n.paper.customAttributes[x].length;C--;)y[x][C]=((L[C]||0)-(N[C]||0))/g}var D=s.easing,Q=e.easing_formulas[D];if(!Q)if(Q=O(D).match(K),Q&&5==Q.length){var H=Q;Q=function(e){return f(e,+H[1],+H[2],+H[3],+H[4],g)}}else Q=ue;if(p=s.start||t.start||+new Date,w={anim:t,percent:i,timestamp:p,start:p+(t.del||0),status:0,initstatus:o||0,stop:!1,ms:g,easing:Q,from:m,diff:y,to:v,el:n,callback:s.callback,prev:u,next:d,repeat:a||t.times,origin:n.attr(),totalOrigin:r},rt.push(w),o&&!l&&!c&&(w.stop=!0,w.start=new Date-g*o,1==rt.length))return st();c&&(w.start=new Date-w.ms*o),1==rt.length&&at(st)}eve("raphael.anim.start."+n.id,n,t)}}function v(e){for(var t=0;t<rt.length;t++)rt[t].el.paper==e&&rt.splice(t--,1)}e.version="2.1.0",e.eve=eve;var y,w,b=/[, ]+/,C={circle:1,rect:1,path:1,ellipse:1,text:1,image:1},k=/\{(\d+)\}/g,F="hasOwnProperty",x={doc:document,win:window},T={was:Object.prototype[F].call(x.win,"Raphael"),is:x.win.Raphael},_=function(){this.ca=this.customAttributes={}},E="apply",S="concat",j="createTouch"in x.doc,I="",A=" ",O=String,M="split",P="click dblclick mousedown mousemove mouseout mouseover mouseup touchstart touchmove touchend touchcancel"[M](A),B={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},R=O.prototype.toLowerCase,L=Math,N=L.max,D=L.min,Q=L.abs,H=L.pow,G=L.PI,V="number",U="string",z="array",W=Object.prototype.toString,$=(e._ISURL=/^url\(['"]?([^\)]+?)['"]?\)$/i,/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+%?(?:\s*,\s*[\d\.]+%?)?)\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\))\s*$/i),q={NaN:1,Infinity:1,"-Infinity":1},K=/^(?:cubic-)?bezier\(([^,]+),([^,]+),([^,]+),([^\)]+)\)/,Y=L.round,J=parseFloat,X=parseInt,Z=O.prototype.toUpperCase,ee=e._availableAttrs={"arrow-end":"none","arrow-start":"none",blur:0,"clip-rect":"0 0 1e9 1e9",cursor:"default",cx:0,cy:0,fill:"#fff","fill-opacity":1,font:'10px "Arial"',"font-family":'"Arial"',"font-size":"10","font-style":"normal","font-weight":400,gradient:0,height:0,href:"http://raphaeljs.com/","letter-spacing":0,opacity:1,path:"M0,0",r:0,rx:0,ry:0,src:"",stroke:"#000","stroke-dasharray":"","stroke-linecap":"butt","stroke-linejoin":"butt","stroke-miterlimit":0,"stroke-opacity":1,"stroke-width":1,target:"_blank","text-anchor":"middle",title:"Raphael",transform:"",width:0,x:0,y:0},te=e._availableAnimAttrs={blur:V,"clip-rect":"csv",cx:V,cy:V,fill:"colour","fill-opacity":V,"font-size":V,height:V,opacity:V,path:"path",r:V,rx:V,ry:V,stroke:"colour","stroke-opacity":V,"stroke-width":V,transform:"transform",width:V,x:V,y:V},ne=/[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/,ie={hs:1,rg:1},oe=/,?([achlmqrstvxz]),?/gi,re=/([achlmrqstvz])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/gi,ae=/([rstm])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/gi,se=/(-?\d*\.?\d*(?:e[\-+]?\d+)?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/gi,le=(e._radial_gradient=/^r(?:\(([^,]+?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*([^\)]+?)\))?/,{}),ce=function(e,t){return J(e)-J(t)},de=function(){},ue=function(e){return e},he=e._rectPath=function(e,t,n,i,o){return o?[["M",e+o,t],["l",n-2*o,0],["a",o,o,0,0,1,o,o],["l",0,i-2*o],["a",o,o,0,0,1,-o,o],["l",2*o-n,0],["a",o,o,0,0,1,-o,-o],["l",0,2*o-i],["a",o,o,0,0,1,o,-o],["z"]]:[["M",e,t],["l",n,0],["l",0,i],["l",-n,0],["z"]]},pe=function(e,t,n,i){return null==i&&(i=n),[["M",e,t],["m",0,-i],["a",n,i,0,1,1,0,2*i],["a",n,i,0,1,1,0,-2*i],["z"]]},fe=e._getPath={path:function(e){return e.attr("path")},circle:function(e){var t=e.attrs;return pe(t.cx,t.cy,t.r)},ellipse:function(e){var t=e.attrs;return pe(t.cx,t.cy,t.rx,t.ry)},rect:function(e){var t=e.attrs;return he(t.x,t.y,t.width,t.height,t.r)},image:function(e){var t=e.attrs;return he(t.x,t.y,t.width,t.height)},text:function(e){var t=e._getBBox();return he(t.x,t.y,t.width,t.height)}},ge=e.mapPath=function(e,t){if(!t)return e;var n,i,o,r,a,s,l;for(e=Pe(e),o=0,a=e.length;a>o;o++)for(l=e[o],r=1,s=l.length;s>r;r+=2)n=t.x(l[r],l[r+1]),i=t.y(l[r],l[r+1]),l[r]=n,l[r+1]=i;return e};if(e._g=x,e.type=x.win.SVGAngle||x.doc.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML","VML"==e.type){var me,ve=x.doc.createElement("div");if(ve.innerHTML='<v:shape adj="1"/>',me=ve.firstChild,me.style.behavior="url(#default#VML)",!me||"object"!=typeof me.adj)return e.type=I;ve=null}e.svg=!(e.vml="VML"==e.type),e._Paper=_,e.fn=w=_.prototype=e.prototype,e._id=0,e._oid=0,e.is=function(e,t){return t=R.call(t),"finite"==t?!q[F](+e):"array"==t?e instanceof Array:"null"==t&&null===e||t==typeof e&&null!==e||"object"==t&&e===Object(e)||"array"==t&&Array.isArray&&Array.isArray(e)||W.call(e).slice(8,-1).toLowerCase()==t},e.angle=function(t,n,i,o,r,a){if(null==r){var s=t-i,l=n-o;return s||l?(180+180*L.atan2(-l,-s)/G+360)%360:0}return e.angle(t,n,r,a)-e.angle(i,o,r,a)},e.rad=function(e){return e%360*G/180},e.deg=function(e){return 180*e/G%360},e.snapTo=function(t,n,i){if(i=e.is(i,"finite")?i:10,e.is(t,z)){for(var o=t.length;o--;)if(Q(t[o]-n)<=i)return t[o]}else{t=+t;var r=n%t;if(i>r)return n-r;if(r>t-i)return n-r+t}return n};e.createUUID=function(e,t){return function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(e,t).toUpperCase()}}(/[xy]/g,function(e){var t=16*L.random()|0,n="x"==e?t:3&t|8;return n.toString(16)});e.setWindow=function(t){eve("raphael.setWindow",e,x.win,t),x.win=t,x.doc=x.win.document,e._engine.initWin&&e._engine.initWin(x.win)};var ye=function(t){if(e.vml){var n,o=/^\s+|\s+$/g;try{var r=new ActiveXObject("htmlfile");r.write("<body>"),r.close(),n=r.body}catch(a){n=createPopup().document.body}var s=n.createTextRange();ye=i(function(e){try{n.style.color=O(e).replace(o,I);var t=s.queryCommandValue("ForeColor");return t=(255&t)<<16|65280&t|(16711680&t)>>>16,"#"+("000000"+t.toString(16)).slice(-6)}catch(i){return"none"}})}else{var l=x.doc.createElement("i");l.title="Raphaël Colour Picker",l.style.display="none",x.doc.body.appendChild(l),ye=i(function(e){return l.style.color=e,x.doc.defaultView.getComputedStyle(l,I).getPropertyValue("color")})}return ye(t)},we=function(){return"hsb("+[this.h,this.s,this.b]+")"},be=function(){return"hsl("+[this.h,this.s,this.l]+")"},Ce=function(){return this.hex},ke=function(t,n,i){if(null==n&&e.is(t,"object")&&"r"in t&&"g"in t&&"b"in t&&(i=t.b,n=t.g,t=t.r),null==n&&e.is(t,U)){var o=e.getRGB(t);t=o.r,n=o.g,i=o.b}return(t>1||n>1||i>1)&&(t/=255,n/=255,i/=255),[t,n,i]},Fe=function(t,n,i,o){t*=255,n*=255,i*=255;var r={r:t,g:n,b:i,hex:e.rgb(t,n,i),toString:Ce};return e.is(o,"finite")&&(r.opacity=o),r};e.color=function(t){var n;return e.is(t,"object")&&"h"in t&&"s"in t&&"b"in t?(n=e.hsb2rgb(t),t.r=n.r,t.g=n.g,t.b=n.b,t.hex=n.hex):e.is(t,"object")&&"h"in t&&"s"in t&&"l"in t?(n=e.hsl2rgb(t),t.r=n.r,t.g=n.g,t.b=n.b,t.hex=n.hex):(e.is(t,"string")&&(t=e.getRGB(t)),e.is(t,"object")&&"r"in t&&"g"in t&&"b"in t?(n=e.rgb2hsl(t),t.h=n.h,t.s=n.s,t.l=n.l,n=e.rgb2hsb(t),t.v=n.b):(t={hex:"none"},t.r=t.g=t.b=t.h=t.s=t.v=t.l=-1)),t.toString=Ce,t},e.hsb2rgb=function(e,t,n,i){this.is(e,"object")&&"h"in e&&"s"in e&&"b"in e&&(n=e.b,t=e.s,e=e.h,i=e.o),e*=360;var o,r,a,s,l;return e=e%360/60,l=n*t,s=l*(1-Q(e%2-1)),o=r=a=n-l,e=~~e,o+=[l,s,0,0,s,l][e],r+=[s,l,l,s,0,0][e],a+=[0,0,s,l,l,s][e],Fe(o,r,a,i)},e.hsl2rgb=function(e,t,n,i){this.is(e,"object")&&"h"in e&&"s"in e&&"l"in e&&(n=e.l,t=e.s,e=e.h),(e>1||t>1||n>1)&&(e/=360,t/=100,n/=100),e*=360;var o,r,a,s,l;return e=e%360/60,l=2*t*(.5>n?n:1-n),s=l*(1-Q(e%2-1)),o=r=a=n-l/2,e=~~e,o+=[l,s,0,0,s,l][e],r+=[s,l,l,s,0,0][e],a+=[0,0,s,l,l,s][e],Fe(o,r,a,i)},e.rgb2hsb=function(e,t,n){n=ke(e,t,n),e=n[0],t=n[1],n=n[2];var i,o,r,a;return r=N(e,t,n),a=r-D(e,t,n),i=0==a?null:r==e?(t-n)/a:r==t?(n-e)/a+2:(e-t)/a+4,i=(i+360)%6*60/360,o=0==a?0:a/r,{h:i,s:o,b:r,toString:we}},e.rgb2hsl=function(e,t,n){n=ke(e,t,n),e=n[0],t=n[1],n=n[2];var i,o,r,a,s,l;return a=N(e,t,n),s=D(e,t,n),l=a-s,i=0==l?null:a==e?(t-n)/l:a==t?(n-e)/l+2:(e-t)/l+4,i=(i+360)%6*60/360,r=(a+s)/2,o=0==l?0:.5>r?l/(2*r):l/(2-2*r),{h:i,s:o,l:r,toString:be}},e._path2string=function(){return this.join(",").replace(oe,"$1")};e._preload=function(e,t){var n=x.doc.createElement("img");n.style.cssText="position:absolute;left:-9999em;top:-9999em",n.onload=function(){t.call(this),this.onload=null,x.doc.body.removeChild(this)},n.onerror=function(){x.doc.body.removeChild(this)},x.doc.body.appendChild(n),n.src=e};e.getRGB=i(function(t){if(!t||(t=O(t)).indexOf("-")+1)return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:o};if("none"==t)return{r:-1,g:-1,b:-1,hex:"none",toString:o};!(ie[F](t.toLowerCase().substring(0,2))||"#"==t.charAt())&&(t=ye(t));var n,i,r,a,s,l,c=t.match($);return c?(c[2]&&(r=X(c[2].substring(5),16),i=X(c[2].substring(3,5),16),n=X(c[2].substring(1,3),16)),c[3]&&(r=X((s=c[3].charAt(3))+s,16),i=X((s=c[3].charAt(2))+s,16),n=X((s=c[3].charAt(1))+s,16)),c[4]&&(l=c[4][M](ne),n=J(l[0]),"%"==l[0].slice(-1)&&(n*=2.55),i=J(l[1]),"%"==l[1].slice(-1)&&(i*=2.55),r=J(l[2]),"%"==l[2].slice(-1)&&(r*=2.55),"rgba"==c[1].toLowerCase().slice(0,4)&&(a=J(l[3])),l[3]&&"%"==l[3].slice(-1)&&(a/=100)),c[5]?(l=c[5][M](ne),n=J(l[0]),"%"==l[0].slice(-1)&&(n*=2.55),i=J(l[1]),"%"==l[1].slice(-1)&&(i*=2.55),r=J(l[2]),"%"==l[2].slice(-1)&&(r*=2.55),("deg"==l[0].slice(-3)||"°"==l[0].slice(-1))&&(n/=360),"hsba"==c[1].toLowerCase().slice(0,4)&&(a=J(l[3])),l[3]&&"%"==l[3].slice(-1)&&(a/=100),e.hsb2rgb(n,i,r,a)):c[6]?(l=c[6][M](ne),n=J(l[0]),"%"==l[0].slice(-1)&&(n*=2.55),i=J(l[1]),"%"==l[1].slice(-1)&&(i*=2.55),r=J(l[2]),"%"==l[2].slice(-1)&&(r*=2.55),("deg"==l[0].slice(-3)||"°"==l[0].slice(-1))&&(n/=360),"hsla"==c[1].toLowerCase().slice(0,4)&&(a=J(l[3])),l[3]&&"%"==l[3].slice(-1)&&(a/=100),e.hsl2rgb(n,i,r,a)):(c={r:n,g:i,b:r,toString:o},c.hex="#"+(16777216|r|i<<8|n<<16).toString(16).slice(1),e.is(a,"finite")&&(c.opacity=a),c)):{r:-1,g:-1,b:-1,hex:"none",error:1,toString:o}},e),e.hsb=i(function(t,n,i){return e.hsb2rgb(t,n,i).hex}),e.hsl=i(function(t,n,i){return e.hsl2rgb(t,n,i).hex}),e.rgb=i(function(e,t,n){return"#"+(16777216|n|t<<8|e<<16).toString(16).slice(1)}),e.getColor=function(e){var t=this.getColor.start=this.getColor.start||{h:0,s:1,b:e||.75},n=this.hsb2rgb(t.h,t.s,t.b);return t.h+=.075,t.h>1&&(t.h=0,t.s-=.2,t.s<=0&&(this.getColor.start={h:0,s:1,b:t.b})),n.hex},e.getColor.reset=function(){delete this.start},e.parsePathString=function(t){if(!t)return null;var n=xe(t);if(n.arr)return _e(n.arr);var i={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0},o=[];return e.is(t,z)&&e.is(t[0],z)&&(o=_e(t)),o.length||O(t).replace(re,function(e,t,n){var r=[],a=t.toLowerCase();if(n.replace(se,function(e,t){t&&r.push(+t)}),"m"==a&&r.length>2&&(o.push([t][S](r.splice(0,2))),a="l",t="m"==t?"l":"L"),"r"==a)o.push([t][S](r));else for(;r.length>=i[a]&&(o.push([t][S](r.splice(0,i[a]))),i[a]););}),o.toString=e._path2string,n.arr=_e(o),o},e.parseTransformString=i(function(t){if(!t)return null;var n=[];return e.is(t,z)&&e.is(t[0],z)&&(n=_e(t)),n.length||O(t).replace(ae,function(e,t,i){var o=[];R.call(t);i.replace(se,function(e,t){t&&o.push(+t)}),n.push([t][S](o))}),n.toString=e._path2string,n});var xe=function(e){var t=xe.ps=xe.ps||{};return t[e]?t[e].sleep=100:t[e]={sleep:100},setTimeout(function(){for(var n in t)t[F](n)&&n!=e&&(t[n].sleep--,!t[n].sleep&&delete t[n])}),t[e]};e.findDotsAtSegment=function(e,t,n,i,o,r,a,s,l){var c=1-l,d=H(c,3),u=H(c,2),h=l*l,p=h*l,f=d*e+3*u*l*n+3*c*l*l*o+p*a,g=d*t+3*u*l*i+3*c*l*l*r+p*s,m=e+2*l*(n-e)+h*(o-2*n+e),v=t+2*l*(i-t)+h*(r-2*i+t),y=n+2*l*(o-n)+h*(a-2*o+n),w=i+2*l*(r-i)+h*(s-2*r+i),b=c*e+l*n,C=c*t+l*i,k=c*o+l*a,F=c*r+l*s,x=90-180*L.atan2(m-y,v-w)/G;return(m>y||w>v)&&(x+=180),{x:f,y:g,m:{x:m,y:v},n:{x:y,y:w},start:{x:b,y:C},end:{x:k,y:F},alpha:x}},e.bezierBBox=function(t,n,i,o,r,a,s,l){e.is(t,"array")||(t=[t,n,i,o,r,a,s,l]);var c=Me.apply(null,t);return{x:c.min.x,y:c.min.y,x2:c.max.x,y2:c.max.y,width:c.max.x-c.min.x,height:c.max.y-c.min.y}},e.isPointInsideBBox=function(e,t,n){return t>=e.x&&t<=e.x2&&n>=e.y&&n<=e.y2},e.isBBoxIntersect=function(t,n){var i=e.isPointInsideBBox;return i(n,t.x,t.y)||i(n,t.x2,t.y)||i(n,t.x,t.y2)||i(n,t.x2,t.y2)||i(t,n.x,n.y)||i(t,n.x2,n.y)||i(t,n.x,n.y2)||i(t,n.x2,n.y2)||(t.x<n.x2&&t.x>n.x||n.x<t.x2&&n.x>t.x)&&(t.y<n.y2&&t.y>n.y||n.y<t.y2&&n.y>t.y)},e.pathIntersection=function(e,t){return u(e,t)},e.pathIntersectionNumber=function(e,t){return u(e,t,1)},e.isPointInsidePath=function(t,n,i){var o=e.pathBBox(t);return e.isPointInsideBBox(o,n,i)&&u(t,[["M",n,i],["H",o.x2+10]],1)%2==1},e._removedFactory=function(e){return function(){eve("raphael.log",null,"Raphaël: you are calling to method “"+e+"” of removed object",e)}};var Te=e.pathBBox=function(e){var n=xe(e);if(n.bbox)return n.bbox;if(!e)return{x:0,y:0,width:0,height:0,x2:0,y2:0};e=Pe(e);for(var i,o=0,r=0,a=[],s=[],l=0,c=e.length;c>l;l++)if(i=e[l],"M"==i[0])o=i[1],r=i[2],a.push(o),s.push(r);else{var d=Me(o,r,i[1],i[2],i[3],i[4],i[5],i[6]);a=a[S](d.min.x,d.max.x),s=s[S](d.min.y,d.max.y),o=i[5],r=i[6]}var u=D[E](0,a),h=D[E](0,s),p=N[E](0,a),f=N[E](0,s),g={x:u,y:h,x2:p,y2:f,width:p-u,height:f-h};return n.bbox=t(g),g},_e=function(n){var i=t(n);return i.toString=e._path2string,i},Ee=e._pathToRelative=function(t){var n=xe(t);if(n.rel)return _e(n.rel);e.is(t,z)&&e.is(t&&t[0],z)||(t=e.parsePathString(t));var i=[],o=0,r=0,a=0,s=0,l=0;"M"==t[0][0]&&(o=t[0][1],r=t[0][2],a=o,s=r,l++,i.push(["M",o,r]));for(var c=l,d=t.length;d>c;c++){var u=i[c]=[],h=t[c];if(h[0]!=R.call(h[0]))switch(u[0]=R.call(h[0]),u[0]){case"a":u[1]=h[1],u[2]=h[2],u[3]=h[3],u[4]=h[4],u[5]=h[5],u[6]=+(h[6]-o).toFixed(3),u[7]=+(h[7]-r).toFixed(3);break;case"v":u[1]=+(h[1]-r).toFixed(3);break;case"m":a=h[1],s=h[2];default:for(var p=1,f=h.length;f>p;p++)u[p]=+(h[p]-(p%2?o:r)).toFixed(3)}else{u=i[c]=[],"m"==h[0]&&(a=h[1]+o,s=h[2]+r);for(var g=0,m=h.length;m>g;g++)i[c][g]=h[g]}var v=i[c].length;switch(i[c][0]){case"z":o=a,r=s;break;case"h":o+=+i[c][v-1];break;case"v":r+=+i[c][v-1];break;default:o+=+i[c][v-2],r+=+i[c][v-1]}}return i.toString=e._path2string,n.rel=_e(i),i},Se=e._pathToAbsolute=function(t){var n=xe(t);if(n.abs)return _e(n.abs);if(e.is(t,z)&&e.is(t&&t[0],z)||(t=e.parsePathString(t)),!t||!t.length)return[["M",0,0]];var i=[],o=0,a=0,s=0,l=0,c=0;"M"==t[0][0]&&(o=+t[0][1],a=+t[0][2],s=o,l=a,c++,i[0]=["M",o,a]);for(var d,u,h=3==t.length&&"M"==t[0][0]&&"R"==t[1][0].toUpperCase()&&"Z"==t[2][0].toUpperCase(),p=c,f=t.length;f>p;p++){if(i.push(d=[]),u=t[p],u[0]!=Z.call(u[0]))switch(d[0]=Z.call(u[0]),d[0]){case"A":d[1]=u[1],d[2]=u[2],d[3]=u[3],d[4]=u[4],d[5]=u[5],d[6]=+(u[6]+o),d[7]=+(u[7]+a);break;case"V":d[1]=+u[1]+a;break;case"H":d[1]=+u[1]+o;break;case"R":for(var g=[o,a][S](u.slice(1)),m=2,v=g.length;v>m;m++)g[m]=+g[m]+o,g[++m]=+g[m]+a;i.pop(),i=i[S](r(g,h));break;case"M":s=+u[1]+o,l=+u[2]+a;default:for(m=1,v=u.length;v>m;m++)d[m]=+u[m]+(m%2?o:a)}else if("R"==u[0])g=[o,a][S](u.slice(1)),i.pop(),i=i[S](r(g,h)),d=["R"][S](u.slice(-2));else for(var y=0,w=u.length;w>y;y++)d[y]=u[y];switch(d[0]){case"Z":o=s,a=l;break;case"H":o=d[1];break;case"V":a=d[1];break;case"M":s=d[d.length-2],l=d[d.length-1];default:o=d[d.length-2],a=d[d.length-1]}}return i.toString=e._path2string,n.abs=_e(i),i},je=function(e,t,n,i){return[e,t,n,i,n,i]},Ie=function(e,t,n,i,o,r){var a=1/3,s=2/3;return[a*e+s*n,a*t+s*i,a*o+s*n,a*r+s*i,o,r]},Ae=function(e,t,n,o,r,a,s,l,c,d){var u,h=120*G/180,p=G/180*(+r||0),f=[],g=i(function(e,t,n){var i=e*L.cos(n)-t*L.sin(n),o=e*L.sin(n)+t*L.cos(n);return{x:i,y:o}});if(d)x=d[0],T=d[1],k=d[2],F=d[3];else{u=g(e,t,-p),e=u.x,t=u.y,u=g(l,c,-p),l=u.x,c=u.y;var m=(L.cos(G/180*r),L.sin(G/180*r),(e-l)/2),v=(t-c)/2,y=m*m/(n*n)+v*v/(o*o);y>1&&(y=L.sqrt(y),n=y*n,o=y*o);var w=n*n,b=o*o,C=(a==s?-1:1)*L.sqrt(Q((w*b-w*v*v-b*m*m)/(w*v*v+b*m*m))),k=C*n*v/o+(e+l)/2,F=C*-o*m/n+(t+c)/2,x=L.asin(((t-F)/o).toFixed(9)),T=L.asin(((c-F)/o).toFixed(9));x=k>e?G-x:x,T=k>l?G-T:T,0>x&&(x=2*G+x),0>T&&(T=2*G+T),s&&x>T&&(x-=2*G),!s&&T>x&&(T-=2*G)}var _=T-x;if(Q(_)>h){var E=T,j=l,I=c;T=x+h*(s&&T>x?1:-1),l=k+n*L.cos(T),c=F+o*L.sin(T),f=Ae(l,c,n,o,r,0,s,j,I,[T,E,k,F])}_=T-x;var A=L.cos(x),O=L.sin(x),P=L.cos(T),B=L.sin(T),R=L.tan(_/4),N=4/3*n*R,D=4/3*o*R,H=[e,t],V=[e+N*O,t-D*A],U=[l+N*B,c-D*P],z=[l,c];if(V[0]=2*H[0]-V[0],V[1]=2*H[1]-V[1],d)return[V,U,z][S](f);f=[V,U,z][S](f).join()[M](",");for(var W=[],$=0,q=f.length;q>$;$++)W[$]=$%2?g(f[$-1],f[$],p).y:g(f[$],f[$+1],p).x;return W},Oe=function(e,t,n,i,o,r,a,s,l){var c=1-l;return{x:H(c,3)*e+3*H(c,2)*l*n+3*c*l*l*o+H(l,3)*a,y:H(c,3)*t+3*H(c,2)*l*i+3*c*l*l*r+H(l,3)*s}},Me=i(function(e,t,n,i,o,r,a,s){var l,c=o-2*n+e-(a-2*o+n),d=2*(n-e)-2*(o-n),u=e-n,h=(-d+L.sqrt(d*d-4*c*u))/2/c,p=(-d-L.sqrt(d*d-4*c*u))/2/c,f=[t,s],g=[e,a];return Q(h)>"1e12"&&(h=.5),Q(p)>"1e12"&&(p=.5),h>0&&1>h&&(l=Oe(e,t,n,i,o,r,a,s,h),g.push(l.x),f.push(l.y)),p>0&&1>p&&(l=Oe(e,t,n,i,o,r,a,s,p),g.push(l.x),f.push(l.y)),c=r-2*i+t-(s-2*r+i),d=2*(i-t)-2*(r-i),u=t-i,h=(-d+L.sqrt(d*d-4*c*u))/2/c,p=(-d-L.sqrt(d*d-4*c*u))/2/c,Q(h)>"1e12"&&(h=.5),Q(p)>"1e12"&&(p=.5),h>0&&1>h&&(l=Oe(e,t,n,i,o,r,a,s,h),g.push(l.x),f.push(l.y)),p>0&&1>p&&(l=Oe(e,t,n,i,o,r,a,s,p),g.push(l.x),f.push(l.y)),{min:{x:D[E](0,g),y:D[E](0,f)},max:{x:N[E](0,g),y:N[E](0,f)}}}),Pe=e._path2curve=i(function(e,t){var n=!t&&xe(e);if(!t&&n.curve)return _e(n.curve);for(var i=Se(e),o=t&&Se(t),r={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},a={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},s=(function(e,t){var n,i;if(!e)return["C",t.x,t.y,t.x,t.y,t.x,t.y];switch(!(e[0]in{T:1,Q:1})&&(t.qx=t.qy=null),e[0]){case"M":t.X=e[1],t.Y=e[2];break;case"A":e=["C"][S](Ae[E](0,[t.x,t.y][S](e.slice(1))));break;case"S":n=t.x+(t.x-(t.bx||t.x)),i=t.y+(t.y-(t.by||t.y)),e=["C",n,i][S](e.slice(1));break;case"T":t.qx=t.x+(t.x-(t.qx||t.x)),t.qy=t.y+(t.y-(t.qy||t.y)),e=["C"][S](Ie(t.x,t.y,t.qx,t.qy,e[1],e[2]));break;case"Q":t.qx=e[1],t.qy=e[2],e=["C"][S](Ie(t.x,t.y,e[1],e[2],e[3],e[4]));break;case"L":e=["C"][S](je(t.x,t.y,e[1],e[2]));break;case"H":e=["C"][S](je(t.x,t.y,e[1],t.y));break;case"V":e=["C"][S](je(t.x,t.y,t.x,e[1]));break;case"Z":e=["C"][S](je(t.x,t.y,t.X,t.Y))}return e}),l=function(e,t){if(e[t].length>7){e[t].shift();for(var n=e[t];n.length;)e.splice(t++,0,["C"][S](n.splice(0,6)));e.splice(t,1),u=N(i.length,o&&o.length||0)}},c=function(e,t,n,r,a){e&&t&&"M"==e[a][0]&&"M"!=t[a][0]&&(t.splice(a,0,["M",r.x,r.y]),n.bx=0,n.by=0,n.x=e[a][1],n.y=e[a][2],u=N(i.length,o&&o.length||0))},d=0,u=N(i.length,o&&o.length||0);u>d;d++){i[d]=s(i[d],r),l(i,d),o&&(o[d]=s(o[d],a)),o&&l(o,d),c(i,o,r,a,d),c(o,i,a,r,d);var h=i[d],p=o&&o[d],f=h.length,g=o&&p.length;r.x=h[f-2],r.y=h[f-1],r.bx=J(h[f-4])||r.x,r.by=J(h[f-3])||r.y,a.bx=o&&(J(p[g-4])||a.x),a.by=o&&(J(p[g-3])||a.y),a.x=o&&p[g-2],a.y=o&&p[g-1]}return o||(n.curve=_e(i)),o?[i,o]:i},null,_e),Be=(e._parseDots=i(function(t){for(var n=[],i=0,o=t.length;o>i;i++){var r={},a=t[i].match(/^([^:]*):?([\d\.]*)/);if(r.color=e.getRGB(a[1]),r.color.error)return null;r.color=r.color.hex,a[2]&&(r.offset=a[2]+"%"),n.push(r)}for(i=1,o=n.length-1;o>i;i++)if(!n[i].offset){for(var s=J(n[i-1].offset||0),l=0,c=i+1;o>c;c++)if(n[c].offset){l=n[c].offset;break}l||(l=100,c=o),l=J(l);for(var d=(l-s)/(c-i+1);c>i;i++)s+=d,n[i].offset=s+"%"}return n}),e._tear=function(e,t){e==t.top&&(t.top=e.prev),e==t.bottom&&(t.bottom=e.next),e.next&&(e.next.prev=e.prev),e.prev&&(e.prev.next=e.next)}),Re=(e._tofront=function(e,t){t.top!==e&&(Be(e,t),e.next=null,e.prev=t.top,t.top.next=e,t.top=e)},e._toback=function(e,t){t.bottom!==e&&(Be(e,t),e.next=t.bottom,e.prev=null,t.bottom.prev=e,t.bottom=e)},e._insertafter=function(e,t,n){Be(e,n),t==n.top&&(n.top=e),t.next&&(t.next.prev=e),e.next=t.next,e.prev=t,t.next=e},e._insertbefore=function(e,t,n){Be(e,n),t==n.bottom&&(n.bottom=e),t.prev&&(t.prev.next=e),e.prev=t.prev,t.prev=e,e.next=t},e.toMatrix=function(e,t){var n=Te(e),i={_:{transform:I},getBBox:function(){return n}};return Le(i,t),i.matrix}),Le=(e.transformPath=function(e,t){return ge(e,Re(e,t))},e._extractTransform=function(t,n){if(null==n)return t._.transform;n=O(n).replace(/\.{3}|\u2026/g,t._.transform||I);var i=e.parseTransformString(n),o=0,r=0,a=0,s=1,l=1,c=t._,d=new h;if(c.transform=i||[],i)for(var u=0,p=i.length;p>u;u++){var f,g,m,v,y,w=i[u],b=w.length,C=O(w[0]).toLowerCase(),k=w[0]!=C,F=k?d.invert():0;"t"==C&&3==b?k?(f=F.x(0,0),g=F.y(0,0),m=F.x(w[1],w[2]),v=F.y(w[1],w[2]),d.translate(m-f,v-g)):d.translate(w[1],w[2]):"r"==C?2==b?(y=y||t.getBBox(1),d.rotate(w[1],y.x+y.width/2,y.y+y.height/2),o+=w[1]):4==b&&(k?(m=F.x(w[2],w[3]),v=F.y(w[2],w[3]),d.rotate(w[1],m,v)):d.rotate(w[1],w[2],w[3]),o+=w[1]):"s"==C?2==b||3==b?(y=y||t.getBBox(1),d.scale(w[1],w[b-1],y.x+y.width/2,y.y+y.height/2),s*=w[1],l*=w[b-1]):5==b&&(k?(m=F.x(w[3],w[4]),v=F.y(w[3],w[4]),d.scale(w[1],w[2],m,v)):d.scale(w[1],w[2],w[3],w[4]),s*=w[1],l*=w[2]):"m"==C&&7==b&&d.add(w[1],w[2],w[3],w[4],w[5],w[6]),c.dirtyT=1,t.matrix=d}t.matrix=d,c.sx=s,c.sy=l,c.deg=o,c.dx=r=d.e,c.dy=a=d.f,1==s&&1==l&&!o&&c.bbox?(c.bbox.x+=+r,c.bbox.y+=+a):c.dirtyT=1}),Ne=function(e){var t=e[0];switch(t.toLowerCase()){case"t":return[t,0,0];case"m":return[t,1,0,0,1,0,0];case"r":return 4==e.length?[t,0,e[2],e[3]]:[t,0];case"s":return 5==e.length?[t,1,1,e[3],e[4]]:3==e.length?[t,1,1]:[t,1]}},De=e._equaliseTransform=function(t,n){n=O(n).replace(/\.{3}|\u2026/g,t),t=e.parseTransformString(t)||[],n=e.parseTransformString(n)||[];for(var i,o,r,a,s=N(t.length,n.length),l=[],c=[],d=0;s>d;d++){if(r=t[d]||Ne(n[d]),a=n[d]||Ne(r),r[0]!=a[0]||"r"==r[0].toLowerCase()&&(r[2]!=a[2]||r[3]!=a[3])||"s"==r[0].toLowerCase()&&(r[3]!=a[3]||r[4]!=a[4]))return;for(l[d]=[],c[d]=[],i=0,o=N(r.length,a.length);o>i;i++)i in r&&(l[d][i]=r[i]),i in a&&(c[d][i]=a[i])}return{from:l,to:c}};e._getContainer=function(t,n,i,o){var r;return r=null!=o||e.is(t,"object")?t:x.doc.getElementById(t),null!=r?r.tagName?null==n?{container:r,width:r.style.pixelWidth||r.offsetWidth,height:r.style.pixelHeight||r.offsetHeight}:{container:r,width:n,height:i}:{container:1,x:t,y:n,width:i,height:o}:void 0},e.pathToRelative=Ee,e._engine={},e.path2curve=Pe,e.matrix=function(e,t,n,i,o,r){return new h(e,t,n,i,o,r)},function(t){function n(e){return e[0]*e[0]+e[1]*e[1]}function i(e){var t=L.sqrt(n(e));e[0]&&(e[0]/=t),e[1]&&(e[1]/=t)}t.add=function(e,t,n,i,o,r){var a,s,l,c,d=[[],[],[]],u=[[this.a,this.c,this.e],[this.b,this.d,this.f],[0,0,1]],p=[[e,n,o],[t,i,r],[0,0,1]];for(e&&e instanceof h&&(p=[[e.a,e.c,e.e],[e.b,e.d,e.f],[0,0,1]]),a=0;3>a;a++)for(s=0;3>s;s++){for(c=0,l=0;3>l;l++)c+=u[a][l]*p[l][s];d[a][s]=c}this.a=d[0][0],this.b=d[1][0],this.c=d[0][1],this.d=d[1][1],this.e=d[0][2],this.f=d[1][2]},t.invert=function(){var e=this,t=e.a*e.d-e.b*e.c;return new h(e.d/t,-e.b/t,-e.c/t,e.a/t,(e.c*e.f-e.d*e.e)/t,(e.b*e.e-e.a*e.f)/t)},t.clone=function(){return new h(this.a,this.b,this.c,this.d,this.e,this.f)},t.translate=function(e,t){this.add(1,0,0,1,e,t)},t.scale=function(e,t,n,i){null==t&&(t=e),(n||i)&&this.add(1,0,0,1,n,i),this.add(e,0,0,t,0,0),(n||i)&&this.add(1,0,0,1,-n,-i)},t.rotate=function(t,n,i){t=e.rad(t),n=n||0,i=i||0;var o=+L.cos(t).toFixed(9),r=+L.sin(t).toFixed(9);this.add(o,r,-r,o,n,i),this.add(1,0,0,1,-n,-i)},t.x=function(e,t){return e*this.a+t*this.c+this.e},t.y=function(e,t){return e*this.b+t*this.d+this.f},t.get=function(e){return+this[O.fromCharCode(97+e)].toFixed(4)},t.toString=function(){return e.svg?"matrix("+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)].join()+")":[this.get(0),this.get(2),this.get(1),this.get(3),0,0].join()},t.toFilter=function(){return"progid:DXImageTransform.Microsoft.Matrix(M11="+this.get(0)+", M12="+this.get(2)+", M21="+this.get(1)+", M22="+this.get(3)+", Dx="+this.get(4)+", Dy="+this.get(5)+", sizingmethod='auto expand')"},t.offset=function(){return[this.e.toFixed(4),this.f.toFixed(4)]},t.split=function(){var t={};t.dx=this.e,t.dy=this.f;var o=[[this.a,this.c],[this.b,this.d]];t.scalex=L.sqrt(n(o[0])),i(o[0]),t.shear=o[0][0]*o[1][0]+o[0][1]*o[1][1],o[1]=[o[1][0]-o[0][0]*t.shear,o[1][1]-o[0][1]*t.shear],t.scaley=L.sqrt(n(o[1])),i(o[1]),t.shear/=t.scaley;var r=-o[0][1],a=o[1][1];return 0>a?(t.rotate=e.deg(L.acos(a)),0>r&&(t.rotate=360-t.rotate)):t.rotate=e.deg(L.asin(r)),t.isSimple=!(+t.shear.toFixed(9)||t.scalex.toFixed(9)!=t.scaley.toFixed(9)&&t.rotate),t.isSuperSimple=!+t.shear.toFixed(9)&&t.scalex.toFixed(9)==t.scaley.toFixed(9)&&!t.rotate,t.noRotation=!+t.shear.toFixed(9)&&!t.rotate,t},t.toTransformString=function(e){var t=e||this[M]();return t.isSimple?(t.scalex=+t.scalex.toFixed(4),t.scaley=+t.scaley.toFixed(4),t.rotate=+t.rotate.toFixed(4),(t.dx||t.dy?"t"+[t.dx,t.dy]:I)+(1!=t.scalex||1!=t.scaley?"s"+[t.scalex,t.scaley,0,0]:I)+(t.rotate?"r"+[t.rotate,0,0]:I)):"m"+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)]}}(h.prototype);var Qe=navigator.userAgent.match(/Version\/(.*?)\s/)||navigator.userAgent.match(/Chrome\/(\d+)/);"Apple Computer, Inc."==navigator.vendor&&(Qe&&Qe[1]<4||"iP"==navigator.platform.slice(0,2))||"Google Inc."==navigator.vendor&&Qe&&Qe[1]<8?w.safari=function(){var e=this.rect(-99,-99,this.width+99,this.height+99).attr({stroke:"none"});setTimeout(function(){e.remove()})}:w.safari=de;for(var He=function(){this.returnValue=!1},Ge=function(){return this.originalEvent.preventDefault()},Ve=function(){this.cancelBubble=!0},Ue=function(){return this.originalEvent.stopPropagation()},ze=function(){return x.doc.addEventListener?function(e,t,n,i){var o=j&&B[t]?B[t]:t,r=function(o){var r=x.doc.documentElement.scrollTop||x.doc.body.scrollTop,a=x.doc.documentElement.scrollLeft||x.doc.body.scrollLeft,s=o.clientX+a,l=o.clientY+r;if(j&&B[F](t))for(var c=0,d=o.targetTouches&&o.targetTouches.length;d>c;c++)if(o.targetTouches[c].target==e){var u=o;o=o.targetTouches[c],o.originalEvent=u,o.preventDefault=Ge,o.stopPropagation=Ue;break}return n.call(i,o,s,l)};return e.addEventListener(o,r,!1),function(){return e.removeEventListener(o,r,!1),!0}}:x.doc.attachEvent?function(e,t,n,i){var o=function(e){e=e||x.win.event;var t=x.doc.documentElement.scrollTop||x.doc.body.scrollTop,o=x.doc.documentElement.scrollLeft||x.doc.body.scrollLeft,r=e.clientX+o,a=e.clientY+t;return e.preventDefault=e.preventDefault||He,e.stopPropagation=e.stopPropagation||Ve,n.call(i,e,r,a)};e.attachEvent("on"+t,o);var r=function(){return e.detachEvent("on"+t,o),!0};return r}:void 0}(),We=[],$e=function(e){for(var t,n=e.clientX,i=e.clientY,o=x.doc.documentElement.scrollTop||x.doc.body.scrollTop,r=x.doc.documentElement.scrollLeft||x.doc.body.scrollLeft,a=We.length;a--;){if(t=We[a],j){for(var s,l=e.touches.length;l--;)if(s=e.touches[l],s.identifier==t.el._drag.id){n=s.clientX,i=s.clientY,(e.originalEvent?e.originalEvent:e).preventDefault();break}}else e.preventDefault();var c,d=t.el.node,u=d.nextSibling,h=d.parentNode,p=d.style.display;x.win.opera&&h.removeChild(d),d.style.display="none",c=t.el.paper.getElementByPoint(n,i),d.style.display=p,x.win.opera&&(u?h.insertBefore(d,u):h.appendChild(d)),c&&eve("raphael.drag.over."+t.el.id,t.el,c),n+=r,i+=o,eve("raphael.drag.move."+t.el.id,t.move_scope||t.el,n-t.el._drag.x,i-t.el._drag.y,n,i,e)}},qe=function(t){e.unmousemove($e).unmouseup(qe);for(var n,i=We.length;i--;)n=We[i],n.el._drag={},eve("raphael.drag.end."+n.el.id,n.end_scope||n.start_scope||n.move_scope||n.el,t);We=[]},Ke=e.el={},Ye=P.length;Ye--;)!function(t){e[t]=Ke[t]=function(n,i){
return e.is(n,"function")&&(this.events=this.events||[],this.events.push({name:t,f:n,unbind:ze(this.shape||this.node||x.doc,t,n,i||this)})),this},e["un"+t]=Ke["un"+t]=function(e){for(var n=this.events||[],i=n.length;i--;)if(n[i].name==t&&n[i].f==e)return n[i].unbind(),n.splice(i,1),!n.length&&delete this.events,this;return this}}(P[Ye]);Ke.data=function(t,n){var i=le[this.id]=le[this.id]||{};if(1==arguments.length){if(e.is(t,"object")){for(var o in t)t[F](o)&&this.data(o,t[o]);return this}return eve("raphael.data.get."+this.id,this,i[t],t),i[t]}return i[t]=n,eve("raphael.data.set."+this.id,this,n,t),this},Ke.removeData=function(e){return null==e?le[this.id]={}:le[this.id]&&delete le[this.id][e],this},Ke.hover=function(e,t,n,i){return this.mouseover(e,n).mouseout(t,i||n)},Ke.unhover=function(e,t){return this.unmouseover(e).unmouseout(t)};var Je=[];Ke.drag=function(t,n,i,o,r,a){function s(s){(s.originalEvent||s).preventDefault();var l=x.doc.documentElement.scrollTop||x.doc.body.scrollTop,c=x.doc.documentElement.scrollLeft||x.doc.body.scrollLeft;this._drag.x=s.clientX+c,this._drag.y=s.clientY+l,this._drag.id=s.identifier,!We.length&&e.mousemove($e).mouseup(qe),We.push({el:this,move_scope:o,start_scope:r,end_scope:a}),n&&eve.on("raphael.drag.start."+this.id,n),t&&eve.on("raphael.drag.move."+this.id,t),i&&eve.on("raphael.drag.end."+this.id,i),eve("raphael.drag.start."+this.id,r||o||this,s.clientX+c,s.clientY+l,s)}return this._drag={},Je.push({el:this,start:s}),this.mousedown(s),this},Ke.onDragOver=function(e){e?eve.on("raphael.drag.over."+this.id,e):eve.unbind("raphael.drag.over."+this.id)},Ke.undrag=function(){for(var t=Je.length;t--;)Je[t].el==this&&(this.unmousedown(Je[t].start),Je.splice(t,1),eve.unbind("raphael.drag.*."+this.id));!Je.length&&e.unmousemove($e).unmouseup(qe)},w.circle=function(t,n,i){var o=e._engine.circle(this,t||0,n||0,i||0);return this.__set__&&this.__set__.push(o),o},w.rect=function(t,n,i,o,r){var a=e._engine.rect(this,t||0,n||0,i||0,o||0,r||0);return this.__set__&&this.__set__.push(a),a},w.ellipse=function(t,n,i,o){var r=e._engine.ellipse(this,t||0,n||0,i||0,o||0);return this.__set__&&this.__set__.push(r),r},w.path=function(t){t&&!e.is(t,U)&&!e.is(t[0],z)&&(t+=I);var n=e._engine.path(e.format[E](e,arguments),this);return this.__set__&&this.__set__.push(n),n},w.image=function(t,n,i,o,r){var a=e._engine.image(this,t||"about:blank",n||0,i||0,o||0,r||0);return this.__set__&&this.__set__.push(a),a},w.text=function(t,n,i){var o=e._engine.text(this,t||0,n||0,O(i));return this.__set__&&this.__set__.push(o),o},w.set=function(t){!e.is(t,"array")&&(t=Array.prototype.splice.call(arguments,0,arguments.length));var n=new ct(t);return this.__set__&&this.__set__.push(n),n},w.setStart=function(e){this.__set__=e||this.set()},w.setFinish=function(e){var t=this.__set__;return delete this.__set__,t},w.setSize=function(t,n){return e._engine.setSize.call(this,t,n)},w.setViewBox=function(t,n,i,o,r){return e._engine.setViewBox.call(this,t,n,i,o,r)},w.top=w.bottom=null,w.raphael=e;var Xe=function(e){var t=e.getBoundingClientRect(),n=e.ownerDocument,i=n.body,o=n.documentElement,r=o.clientTop||i.clientTop||0,a=o.clientLeft||i.clientLeft||0,s=t.top+(x.win.pageYOffset||o.scrollTop||i.scrollTop)-r,l=t.left+(x.win.pageXOffset||o.scrollLeft||i.scrollLeft)-a;return{y:s,x:l}};w.getElementByPoint=function(e,t){var n=this,i=n.canvas,o=x.doc.elementFromPoint(e,t);if(x.win.opera&&"svg"==o.tagName){var r=Xe(i),a=i.createSVGRect();a.x=e-r.x,a.y=t-r.y,a.width=a.height=1;var s=i.getIntersectionList(a,null);s.length&&(o=s[s.length-1])}if(!o)return null;for(;o.parentNode&&o!=i.parentNode&&!o.raphael;)o=o.parentNode;return o==n.canvas.parentNode&&(o=i),o=o&&o.raphael?n.getById(o.raphaelid):null},w.getById=function(e){for(var t=this.bottom;t;){if(t.id==e)return t;t=t.next}return null},w.forEach=function(e,t){for(var n=this.bottom;n;){if(e.call(t,n)===!1)return this;n=n.next}return this},w.getElementsByPoint=function(e,t){var n=this.set();return this.forEach(function(i){i.isPointInside(e,t)&&n.push(i)}),n},Ke.isPointInside=function(t,n){var i=this.realPath=this.realPath||fe[this.type](this);return e.isPointInsidePath(i,t,n)},Ke.getBBox=function(e){if(this.removed)return{};var t=this._;return e?((t.dirty||!t.bboxwt)&&(this.realPath=fe[this.type](this),t.bboxwt=Te(this.realPath),t.bboxwt.toString=p,t.dirty=0),t.bboxwt):((t.dirty||t.dirtyT||!t.bbox)&&((t.dirty||!this.realPath)&&(t.bboxwt=0,this.realPath=fe[this.type](this)),t.bbox=Te(ge(this.realPath,this.matrix)),t.bbox.toString=p,t.dirty=t.dirtyT=0),t.bbox)},Ke.clone=function(){if(this.removed)return null;var e=this.paper[this.type]().attr(this.attr());return this.__set__&&this.__set__.push(e),e},Ke.glow=function(e){if("text"==this.type)return null;e=e||{};var t={width:(e.width||10)+(+this.attr("stroke-width")||1),fill:e.fill||!1,opacity:e.opacity||.5,offsetx:e.offsetx||0,offsety:e.offsety||0,color:e.color||"#000"},n=t.width/2,i=this.paper,o=i.set(),r=this.realPath||fe[this.type](this);r=this.matrix?ge(r,this.matrix):r;for(var a=1;n+1>a;a++)o.push(i.path(r).attr({stroke:t.color,fill:t.fill?t.color:"none","stroke-linejoin":"round","stroke-linecap":"round","stroke-width":+(t.width/n*a).toFixed(3),opacity:+(t.opacity/n).toFixed(3)}));return o.insertBefore(this).translate(t.offsetx,t.offsety)};var Ze=function(t,n,i,o,r,a,c,d,u){return null==u?s(t,n,i,o,r,a,c,d):e.findDotsAtSegment(t,n,i,o,r,a,c,d,l(t,n,i,o,r,a,c,d,u))},et=function(t,n){return function(i,o,r){i=Pe(i);for(var a,s,l,c,d,u="",h={},p=0,f=0,g=i.length;g>f;f++){if(l=i[f],"M"==l[0])a=+l[1],s=+l[2];else{if(c=Ze(a,s,l[1],l[2],l[3],l[4],l[5],l[6]),p+c>o){if(n&&!h.start){if(d=Ze(a,s,l[1],l[2],l[3],l[4],l[5],l[6],o-p),u+=["C"+d.start.x,d.start.y,d.m.x,d.m.y,d.x,d.y],r)return u;h.start=u,u=["M"+d.x,d.y+"C"+d.n.x,d.n.y,d.end.x,d.end.y,l[5],l[6]].join(),p+=c,a=+l[5],s=+l[6];continue}if(!t&&!n)return d=Ze(a,s,l[1],l[2],l[3],l[4],l[5],l[6],o-p),{x:d.x,y:d.y,alpha:d.alpha}}p+=c,a=+l[5],s=+l[6]}u+=l.shift()+l}return h.end=u,d=t?p:n?h:e.findDotsAtSegment(a,s,l[0],l[1],l[2],l[3],l[4],l[5],1),d.alpha&&(d={x:d.x,y:d.y,alpha:d.alpha}),d}},tt=et(1),nt=et(),it=et(0,1);e.getTotalLength=tt,e.getPointAtLength=nt,e.getSubpath=function(e,t,n){if(this.getTotalLength(e)-n<1e-6)return it(e,t).end;var i=it(e,n,1);return t?it(i,t).end:i},Ke.getTotalLength=function(){return"path"==this.type?this.node.getTotalLength?this.node.getTotalLength():tt(this.attrs.path):void 0},Ke.getPointAtLength=function(e){return"path"==this.type?nt(this.attrs.path,e):void 0},Ke.getSubpath=function(t,n){return"path"==this.type?e.getSubpath(this.attrs.path,t,n):void 0};var ot=e.easing_formulas={linear:function(e){return e},"<":function(e){return H(e,1.7)},">":function(e){return H(e,.48)},"<>":function(e){var t=.48-e/1.04,n=L.sqrt(.1734+t*t),i=n-t,o=H(Q(i),1/3)*(0>i?-1:1),r=-n-t,a=H(Q(r),1/3)*(0>r?-1:1),s=o+a+.5;return 3*(1-s)*s*s+s*s*s},backIn:function(e){var t=1.70158;return e*e*((t+1)*e-t)},backOut:function(e){e-=1;var t=1.70158;return e*e*((t+1)*e+t)+1},elastic:function(e){return e==!!e?e:H(2,-10*e)*L.sin((e-.075)*(2*G)/.3)+1},bounce:function(e){var t,n=7.5625,i=2.75;return 1/i>e?t=n*e*e:2/i>e?(e-=1.5/i,t=n*e*e+.75):2.5/i>e?(e-=2.25/i,t=n*e*e+.9375):(e-=2.625/i,t=n*e*e+.984375),t}};ot.easeIn=ot["ease-in"]=ot["<"],ot.easeOut=ot["ease-out"]=ot[">"],ot.easeInOut=ot["ease-in-out"]=ot["<>"],ot["back-in"]=ot.backIn,ot["back-out"]=ot.backOut;var rt=[],at=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){setTimeout(e,16)},st=function(){for(var t=+new Date,n=0;n<rt.length;n++){var i=rt[n];if(!i.el.removed&&!i.paused){var o,r,a=t-i.start,s=i.ms,l=i.easing,c=i.from,d=i.diff,u=i.to,h=(i.t,i.el),p={},f={};if(i.initstatus?(a=(i.initstatus*i.anim.top-i.prev)/(i.percent-i.prev)*s,i.status=i.initstatus,delete i.initstatus,i.stop&&rt.splice(n--,1)):i.status=(i.prev+(i.percent-i.prev)*(a/s))/i.anim.top,!(0>a))if(s>a){var g=l(a/s);for(var v in c)if(c[F](v)){switch(te[v]){case V:o=+c[v]+g*s*d[v];break;case"colour":o="rgb("+[lt(Y(c[v].r+g*s*d[v].r)),lt(Y(c[v].g+g*s*d[v].g)),lt(Y(c[v].b+g*s*d[v].b))].join(",")+")";break;case"path":o=[];for(var y=0,w=c[v].length;w>y;y++){o[y]=[c[v][y][0]];for(var b=1,C=c[v][y].length;C>b;b++)o[y][b]=+c[v][y][b]+g*s*d[v][y][b];o[y]=o[y].join(A)}o=o.join(A);break;case"transform":if(d[v].real)for(o=[],y=0,w=c[v].length;w>y;y++)for(o[y]=[c[v][y][0]],b=1,C=c[v][y].length;C>b;b++)o[y][b]=c[v][y][b]+g*s*d[v][y][b];else{var k=function(e){return+c[v][e]+g*s*d[v][e]};o=[["m",k(0),k(1),k(2),k(3),k(4),k(5)]]}break;case"csv":if("clip-rect"==v)for(o=[],y=4;y--;)o[y]=+c[v][y]+g*s*d[v][y];break;default:var x=[][S](c[v]);for(o=[],y=h.paper.customAttributes[v].length;y--;)o[y]=+x[y]+g*s*d[v][y]}p[v]=o}h.attr(p),function(e,t,n){setTimeout(function(){eve("raphael.anim.frame."+e,t,n)})}(h.id,h,i.anim)}else{if(function(t,n,i){setTimeout(function(){eve("raphael.anim.frame."+n.id,n,i),eve("raphael.anim.finish."+n.id,n,i),e.is(t,"function")&&t.call(n)})}(i.callback,h,i.anim),h.attr(u),rt.splice(n--,1),i.repeat>1&&!i.next){for(r in u)u[F](r)&&(f[r]=i.totalOrigin[r]);i.el.attr(f),m(i.anim,i.el,i.anim.percents[0],null,i.totalOrigin,i.repeat-1)}i.next&&!i.stop&&m(i.anim,i.el,i.next,null,i.totalOrigin,i.repeat)}}}e.svg&&h&&h.paper&&h.paper.safari(),rt.length&&at(st)},lt=function(e){return e>255?255:0>e?0:e};Ke.animateWith=function(t,n,i,o,r,a){var s=this;if(s.removed)return a&&a.call(s),s;var l=i instanceof g?i:e.animation(i,o,r,a);m(l,s,l.percents[0],null,s.attr());for(var c=0,d=rt.length;d>c;c++)if(rt[c].anim==n&&rt[c].el==t){rt[d-1].start=rt[c].start;break}return s},Ke.onAnimation=function(e){return e?eve.on("raphael.anim.frame."+this.id,e):eve.unbind("raphael.anim.frame."+this.id),this},g.prototype.delay=function(e){var t=new g(this.anim,this.ms);return t.times=this.times,t.del=+e||0,t},g.prototype.repeat=function(e){var t=new g(this.anim,this.ms);return t.del=this.del,t.times=L.floor(N(e,0))||1,t},e.animation=function(t,n,i,o){if(t instanceof g)return t;(e.is(i,"function")||!i)&&(o=o||i||null,i=null),t=Object(t),n=+n||0;var r,a,s={};for(a in t)t[F](a)&&J(a)!=a&&J(a)+"%"!=a&&(r=!0,s[a]=t[a]);return r?(i&&(s.easing=i),o&&(s.callback=o),new g({100:s},n)):new g(t,n)},Ke.animate=function(t,n,i,o){var r=this;if(r.removed)return o&&o.call(r),r;var a=t instanceof g?t:e.animation(t,n,i,o);return m(a,r,a.percents[0],null,r.attr()),r},Ke.setTime=function(e,t){return e&&null!=t&&this.status(e,D(t,e.ms)/e.ms),this},Ke.status=function(e,t){var n,i,o=[],r=0;if(null!=t)return m(e,this,-1,D(t,1)),this;for(n=rt.length;n>r;r++)if(i=rt[r],i.el.id==this.id&&(!e||i.anim==e)){if(e)return i.status;o.push({anim:i.anim,status:i.status})}return e?0:o},Ke.pause=function(e){for(var t=0;t<rt.length;t++)rt[t].el.id!=this.id||e&&rt[t].anim!=e||eve("raphael.anim.pause."+this.id,this,rt[t].anim)!==!1&&(rt[t].paused=!0);return this},Ke.resume=function(e){for(var t=0;t<rt.length;t++)if(rt[t].el.id==this.id&&(!e||rt[t].anim==e)){var n=rt[t];eve("raphael.anim.resume."+this.id,this,n.anim)!==!1&&(delete n.paused,this.status(n.anim,n.status))}return this},Ke.stop=function(e){for(var t=0;t<rt.length;t++)rt[t].el.id!=this.id||e&&rt[t].anim!=e||eve("raphael.anim.stop."+this.id,this,rt[t].anim)!==!1&&rt.splice(t--,1);return this},eve.on("raphael.remove",v),eve.on("raphael.clear",v),Ke.toString=function(){return"Raphaël’s object"};var ct=function(e){if(this.items=[],this.length=0,this.type="set",e)for(var t=0,n=e.length;n>t;t++)!e[t]||e[t].constructor!=Ke.constructor&&e[t].constructor!=ct||(this[this.items.length]=this.items[this.items.length]=e[t],this.length++)},dt=ct.prototype;dt.push=function(){for(var e,t,n=0,i=arguments.length;i>n;n++)e=arguments[n],!e||e.constructor!=Ke.constructor&&e.constructor!=ct||(t=this.items.length,this[t]=this.items[t]=e,this.length++);return this},dt.pop=function(){return this.length&&delete this[this.length--],this.items.pop()},dt.forEach=function(e,t){for(var n=0,i=this.items.length;i>n;n++)if(e.call(t,this.items[n],n)===!1)return this;return this};for(var ut in Ke)Ke[F](ut)&&(dt[ut]=function(e){return function(){var t=arguments;return this.forEach(function(n){n[e][E](n,t)})}}(ut));dt.attr=function(t,n){if(t&&e.is(t,z)&&e.is(t[0],"object"))for(var i=0,o=t.length;o>i;i++)this.items[i].attr(t[i]);else for(var r=0,a=this.items.length;a>r;r++)this.items[r].attr(t,n);return this},dt.clear=function(){for(;this.length;)this.pop()},dt.splice=function(e,t,n){e=0>e?N(this.length+e,0):e,t=N(0,D(this.length-e,t));var i,o=[],r=[],a=[];for(i=2;i<arguments.length;i++)a.push(arguments[i]);for(i=0;t>i;i++)r.push(this[e+i]);for(;i<this.length-e;i++)o.push(this[e+i]);var s=a.length;for(i=0;i<s+o.length;i++)this.items[e+i]=this[e+i]=s>i?a[i]:o[i-s];for(i=this.items.length=this.length-=t-s;this[i];)delete this[i++];return new ct(r)},dt.exclude=function(e){for(var t=0,n=this.length;n>t;t++)if(this[t]==e)return this.splice(t,1),!0},dt.animate=function(t,n,i,o){(e.is(i,"function")||!i)&&(o=i||null);var r,a,s=this.items.length,l=s,c=this;if(!s)return this;o&&(a=function(){!--s&&o.call(c)}),i=e.is(i,U)?i:a;var d=e.animation(t,n,i,a);for(r=this.items[--l].animate(d);l--;)this.items[l]&&!this.items[l].removed&&this.items[l].animateWith(r,d,d);return this},dt.insertAfter=function(e){for(var t=this.items.length;t--;)this.items[t].insertAfter(e);return this},dt.getBBox=function(){for(var e=[],t=[],n=[],i=[],o=this.items.length;o--;)if(!this.items[o].removed){var r=this.items[o].getBBox();e.push(r.x),t.push(r.y),n.push(r.x+r.width),i.push(r.y+r.height)}return e=D[E](0,e),t=D[E](0,t),n=N[E](0,n),i=N[E](0,i),{x:e,y:t,x2:n,y2:i,width:n-e,height:i-t}},dt.clone=function(e){e=new ct;for(var t=0,n=this.items.length;n>t;t++)e.push(this.items[t].clone());return e},dt.toString=function(){return"Raphaël‘s set"},e.registerFont=function(e){if(!e.face)return e;this.fonts=this.fonts||{};var t={w:e.w,face:{},glyphs:{}},n=e.face["font-family"];for(var i in e.face)e.face[F](i)&&(t.face[i]=e.face[i]);if(this.fonts[n]?this.fonts[n].push(t):this.fonts[n]=[t],!e.svg){t.face["units-per-em"]=X(e.face["units-per-em"],10);for(var o in e.glyphs)if(e.glyphs[F](o)){var r=e.glyphs[o];if(t.glyphs[o]={w:r.w,k:{},d:r.d&&"M"+r.d.replace(/[mlcxtrv]/g,function(e){return{l:"L",c:"C",x:"z",t:"m",r:"l",v:"c"}[e]||"M"})+"z"},r.k)for(var a in r.k)r[F](a)&&(t.glyphs[o].k[a]=r.k[a])}}return e},w.getFont=function(t,n,i,o){if(o=o||"normal",i=i||"normal",n=+n||{normal:400,bold:700,lighter:300,bolder:800}[n]||400,e.fonts){var r=e.fonts[t];if(!r){var a=new RegExp("(^|\\s)"+t.replace(/[^\w\d\s+!~.:_-]/g,I)+"(\\s|$)","i");for(var s in e.fonts)if(e.fonts[F](s)&&a.test(s)){r=e.fonts[s];break}}var l;if(r)for(var c=0,d=r.length;d>c&&(l=r[c],l.face["font-weight"]!=n||l.face["font-style"]!=i&&l.face["font-style"]||l.face["font-stretch"]!=o);c++);return l}},w.print=function(t,n,i,o,r,a,s){a=a||"middle",s=N(D(s||0,1),-1);var l,c=O(i)[M](I),d=0,u=0,h=I;if(e.is(o,i)&&(o=this.getFont(o)),o){l=(r||16)/o.face["units-per-em"];for(var p=o.face.bbox[M](b),f=+p[0],g=p[3]-p[1],m=0,v=+p[1]+("baseline"==a?g+ +o.face.descent:g/2),y=0,w=c.length;w>y;y++){if("\n"==c[y])d=0,k=0,u=0,m+=g;else{var C=u&&o.glyphs[c[y-1]]||{},k=o.glyphs[c[y]];d+=u?(C.w||o.w)+(C.k&&C.k[c[y]]||0)+o.w*s:0,u=1}k&&k.d&&(h+=e.transformPath(k.d,["t",d*l,m*l,"s",l,l,f,v,"t",(t-f)/l,(n-v)/l]))}}return this.path(h).attr({fill:"#000",stroke:"none"})},w.add=function(t){if(e.is(t,"array"))for(var n,i=this.set(),o=0,r=t.length;r>o;o++)n=t[o]||{},C[F](n.type)&&i.push(this[n.type]().attr(n));return i},e.format=function(t,n){var i=e.is(n,z)?[0][S](n):arguments;return t&&e.is(t,U)&&i.length-1&&(t=t.replace(k,function(e,t){return null==i[++t]?I:i[t]})),t||I},e.fullfill=function(){var e=/\{([^\}]+)\}/g,t=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g,n=function(e,n,i){var o=i;return n.replace(t,function(e,t,n,i,r){t=t||i,o&&(t in o&&(o=o[t]),"function"==typeof o&&r&&(o=o()))}),o=(null==o||o==i?e:o)+""};return function(t,i){return String(t).replace(e,function(e,t){return n(e,t,i)})}}(),e.ninja=function(){return T.was?x.win.Raphael=T.is:delete Raphael,e},e.st=dt,function(t,n,i){function o(){/in/.test(t.readyState)?setTimeout(o,9):e.eve("raphael.DOMload")}null==t.readyState&&t.addEventListener&&(t.addEventListener(n,i=function(){t.removeEventListener(n,i,!1),t.readyState="complete"},!1),t.readyState="loading"),o()}(document,"DOMContentLoaded"),T.was?x.win.Raphael=e:Raphael=e,eve.on("raphael.DOMload",function(){y=!0})}(),window.Raphael.svg&&function(e){var t="hasOwnProperty",n=String,i=parseFloat,o=parseInt,r=Math,a=r.max,s=r.abs,l=r.pow,c=/[, ]+/,d=e.eve,u="",h=" ",p="http://www.w3.org/1999/xlink",f={block:"M5,0 0,2.5 5,5z",classic:"M5,0 0,2.5 5,5 3.5,3 3.5,2z",diamond:"M2.5,0 5,2.5 2.5,5 0,2.5z",open:"M6,1 1,3.5 6,6",oval:"M2.5,0A2.5,2.5,0,0,1,2.5,5 2.5,2.5,0,0,1,2.5,0z"},g={};e.toString=function(){return"Your browser supports SVG.\nYou are running Raphaël "+this.version};var m=function(i,o){if(o){"string"==typeof i&&(i=m(i));for(var r in o)o[t](r)&&("xlink:"==r.substring(0,6)?i.setAttributeNS(p,r.substring(6),n(o[r])):i.setAttribute(r,n(o[r])))}else i=e._g.doc.createElementNS("http://www.w3.org/2000/svg",i),i.style&&(i.style.webkitTapHighlightColor="rgba(0,0,0,0)");return i},v=function(t,o){var c="linear",d=t.id+o,h=.5,p=.5,f=t.node,g=t.paper,v=f.style,y=e._g.doc.getElementById(d);if(!y){if(o=n(o).replace(e._radial_gradient,function(e,t,n){if(c="radial",t&&n){h=i(t),p=i(n);var o=2*(p>.5)-1;l(h-.5,2)+l(p-.5,2)>.25&&(p=r.sqrt(.25-l(h-.5,2))*o+.5)&&.5!=p&&(p=p.toFixed(5)-1e-5*o)}return u}),o=o.split(/\s*\-\s*/),"linear"==c){var w=o.shift();if(w=-i(w),isNaN(w))return null;var b=[0,0,r.cos(e.rad(w)),r.sin(e.rad(w))],C=1/(a(s(b[2]),s(b[3]))||1);b[2]*=C,b[3]*=C,b[2]<0&&(b[0]=-b[2],b[2]=0),b[3]<0&&(b[1]=-b[3],b[3]=0)}var k=e._parseDots(o);if(!k)return null;if(d=d.replace(/[\(\)\s,\xb0#]/g,"_"),t.gradient&&d!=t.gradient.id&&(g.defs.removeChild(t.gradient),delete t.gradient),!t.gradient){y=m(c+"Gradient",{id:d}),t.gradient=y,m(y,"radial"==c?{fx:h,fy:p}:{x1:b[0],y1:b[1],x2:b[2],y2:b[3],gradientTransform:t.matrix.invert()}),g.defs.appendChild(y);for(var F=0,x=k.length;x>F;F++)y.appendChild(m("stop",{offset:k[F].offset?k[F].offset:F?"100%":"0%","stop-color":k[F].color||"#fff"}))}}return m(f,{fill:"url(#"+d+")",opacity:1,"fill-opacity":1}),v.fill=u,v.opacity=1,v.fillOpacity=1,1},y=function(e){var t=e.getBBox(1);m(e.pattern,{patternTransform:e.matrix.invert()+" translate("+t.x+","+t.y+")"})},w=function(i,o,r){if("path"==i.type){for(var a,s,l,c,d,h=n(o).toLowerCase().split("-"),p=i.paper,v=r?"end":"start",y=i.node,w=i.attrs,b=w["stroke-width"],C=h.length,k="classic",F=3,x=3,T=5;C--;)switch(h[C]){case"block":case"classic":case"oval":case"diamond":case"open":case"none":k=h[C];break;case"wide":x=5;break;case"narrow":x=2;break;case"long":F=5;break;case"short":F=2}if("open"==k?(F+=2,x+=2,T+=2,l=1,c=r?4:1,d={fill:"none",stroke:w.stroke}):(c=l=F/2,d={fill:w.stroke,stroke:"none"}),i._.arrows?r?(i._.arrows.endPath&&g[i._.arrows.endPath]--,i._.arrows.endMarker&&g[i._.arrows.endMarker]--):(i._.arrows.startPath&&g[i._.arrows.startPath]--,i._.arrows.startMarker&&g[i._.arrows.startMarker]--):i._.arrows={},"none"!=k){var _="raphael-marker-"+k,E="raphael-marker-"+v+k+F+x;e._g.doc.getElementById(_)?g[_]++:(p.defs.appendChild(m(m("path"),{"stroke-linecap":"round",d:f[k],id:_})),g[_]=1);var S,j=e._g.doc.getElementById(E);j?(g[E]++,S=j.getElementsByTagName("use")[0]):(j=m(m("marker"),{id:E,markerHeight:x,markerWidth:F,orient:"auto",refX:c,refY:x/2}),S=m(m("use"),{"xlink:href":"#"+_,transform:(r?"rotate(180 "+F/2+" "+x/2+") ":u)+"scale("+F/T+","+x/T+")","stroke-width":(1/((F/T+x/T)/2)).toFixed(4)}),j.appendChild(S),p.defs.appendChild(j),g[E]=1),m(S,d);var I=l*("diamond"!=k&&"oval"!=k);r?(a=i._.arrows.startdx*b||0,s=e.getTotalLength(w.path)-I*b):(a=I*b,s=e.getTotalLength(w.path)-(i._.arrows.enddx*b||0)),d={},d["marker-"+v]="url(#"+E+")",(s||a)&&(d.d=Raphael.getSubpath(w.path,a,s)),m(y,d),i._.arrows[v+"Path"]=_,i._.arrows[v+"Marker"]=E,i._.arrows[v+"dx"]=I,i._.arrows[v+"Type"]=k,i._.arrows[v+"String"]=o}else r?(a=i._.arrows.startdx*b||0,s=e.getTotalLength(w.path)-a):(a=0,s=e.getTotalLength(w.path)-(i._.arrows.enddx*b||0)),i._.arrows[v+"Path"]&&m(y,{d:Raphael.getSubpath(w.path,a,s)}),delete i._.arrows[v+"Path"],delete i._.arrows[v+"Marker"],delete i._.arrows[v+"dx"],delete i._.arrows[v+"Type"],delete i._.arrows[v+"String"];for(d in g)if(g[t](d)&&!g[d]){var A=e._g.doc.getElementById(d);A&&A.parentNode.removeChild(A)}}},b={"":[0],none:[0],"-":[3,1],".":[1,1],"-.":[3,1,1,1],"-..":[3,1,1,1,1,1],". ":[1,3],"- ":[4,3],"--":[8,3],"- .":[4,3,1,3],"--.":[8,3,1,3],"--..":[8,3,1,3,1,3]},C=function(e,t,i){if(t=b[n(t).toLowerCase()]){for(var o=e.attrs["stroke-width"]||"1",r={round:o,square:o,butt:0}[e.attrs["stroke-linecap"]||i["stroke-linecap"]]||0,a=[],s=t.length;s--;)a[s]=t[s]*o+(s%2?1:-1)*r;m(e.node,{"stroke-dasharray":a.join(",")})}},k=function(i,r){var l=i.node,d=i.attrs,h=l.style.visibility;l.style.visibility="hidden";for(var f in r)if(r[t](f)){if(!e._availableAttrs[t](f))continue;var g=r[f];switch(d[f]=g,f){case"blur":i.blur(g);break;case"href":case"title":case"target":var b=l.parentNode;if("a"!=b.tagName.toLowerCase()){var k=m("a");b.insertBefore(k,l),k.appendChild(l),b=k}"target"==f?b.setAttributeNS(p,"show","blank"==g?"new":g):b.setAttributeNS(p,f,g);break;case"cursor":l.style.cursor=g;break;case"transform":i.transform(g);break;case"arrow-start":w(i,g);break;case"arrow-end":w(i,g,1);break;case"clip-rect":var F=n(g).split(c);if(4==F.length){i.clip&&i.clip.parentNode.parentNode.removeChild(i.clip.parentNode);var T=m("clipPath"),_=m("rect");T.id=e.createUUID(),m(_,{x:F[0],y:F[1],width:F[2],height:F[3]}),T.appendChild(_),i.paper.defs.appendChild(T),m(l,{"clip-path":"url(#"+T.id+")"}),i.clip=_}if(!g){var E=l.getAttribute("clip-path");if(E){var S=e._g.doc.getElementById(E.replace(/(^url\(#|\)$)/g,u));S&&S.parentNode.removeChild(S),m(l,{"clip-path":u}),delete i.clip}}break;case"path":"path"==i.type&&(m(l,{d:g?d.path=e._pathToAbsolute(g):"M0,0"}),i._.dirty=1,i._.arrows&&("startString"in i._.arrows&&w(i,i._.arrows.startString),"endString"in i._.arrows&&w(i,i._.arrows.endString,1)));break;case"width":if(l.setAttribute(f,g),i._.dirty=1,!d.fx)break;f="x",g=d.x;case"x":d.fx&&(g=-d.x-(d.width||0));case"rx":if("rx"==f&&"rect"==i.type)break;case"cx":l.setAttribute(f,g),i.pattern&&y(i),i._.dirty=1;break;case"height":if(l.setAttribute(f,g),i._.dirty=1,!d.fy)break;f="y",g=d.y;case"y":d.fy&&(g=-d.y-(d.height||0));case"ry":if("ry"==f&&"rect"==i.type)break;case"cy":l.setAttribute(f,g),i.pattern&&y(i),i._.dirty=1;break;case"r":"rect"==i.type?m(l,{rx:g,ry:g}):l.setAttribute(f,g),i._.dirty=1;break;case"src":"image"==i.type&&l.setAttributeNS(p,"href",g);break;case"stroke-width":(1!=i._.sx||1!=i._.sy)&&(g/=a(s(i._.sx),s(i._.sy))||1),i.paper._vbSize&&(g*=i.paper._vbSize),l.setAttribute(f,g),d["stroke-dasharray"]&&C(i,d["stroke-dasharray"],r),i._.arrows&&("startString"in i._.arrows&&w(i,i._.arrows.startString),"endString"in i._.arrows&&w(i,i._.arrows.endString,1));break;case"stroke-dasharray":C(i,g,r);break;case"fill":var j=n(g).match(e._ISURL);if(j){T=m("pattern");var I=m("image");T.id=e.createUUID(),m(T,{x:0,y:0,patternUnits:"userSpaceOnUse",height:1,width:1}),m(I,{x:0,y:0,"xlink:href":j[1]}),T.appendChild(I),function(t){e._preload(j[1],function(){var e=this.offsetWidth,n=this.offsetHeight;m(t,{width:e,height:n}),m(I,{width:e,height:n}),i.paper.safari()})}(T),i.paper.defs.appendChild(T),m(l,{fill:"url(#"+T.id+")"}),i.pattern=T,i.pattern&&y(i);break}var A=e.getRGB(g);if(A.error){if(("circle"==i.type||"ellipse"==i.type||"r"!=n(g).charAt())&&v(i,g)){if("opacity"in d||"fill-opacity"in d){var O=e._g.doc.getElementById(l.getAttribute("fill").replace(/^url\(#|\)$/g,u));if(O){var M=O.getElementsByTagName("stop");m(M[M.length-1],{"stop-opacity":("opacity"in d?d.opacity:1)*("fill-opacity"in d?d["fill-opacity"]:1)})}}d.gradient=g,d.fill="none";break}}else delete r.gradient,delete d.gradient,!e.is(d.opacity,"undefined")&&e.is(r.opacity,"undefined")&&m(l,{opacity:d.opacity}),!e.is(d["fill-opacity"],"undefined")&&e.is(r["fill-opacity"],"undefined")&&m(l,{"fill-opacity":d["fill-opacity"]});A[t]("opacity")&&m(l,{"fill-opacity":A.opacity>1?A.opacity/100:A.opacity});case"stroke":A=e.getRGB(g),l.setAttribute(f,A.hex),"stroke"==f&&A[t]("opacity")&&m(l,{"stroke-opacity":A.opacity>1?A.opacity/100:A.opacity}),"stroke"==f&&i._.arrows&&("startString"in i._.arrows&&w(i,i._.arrows.startString),"endString"in i._.arrows&&w(i,i._.arrows.endString,1));break;case"gradient":("circle"==i.type||"ellipse"==i.type||"r"!=n(g).charAt())&&v(i,g);break;case"opacity":d.gradient&&!d[t]("stroke-opacity")&&m(l,{"stroke-opacity":g>1?g/100:g});case"fill-opacity":if(d.gradient){O=e._g.doc.getElementById(l.getAttribute("fill").replace(/^url\(#|\)$/g,u)),O&&(M=O.getElementsByTagName("stop"),m(M[M.length-1],{"stop-opacity":g}));break}default:"font-size"==f&&(g=o(g,10)+"px");var P=f.replace(/(\-.)/g,function(e){return e.substring(1).toUpperCase()});l.style[P]=g,i._.dirty=1,l.setAttribute(f,g)}}x(i,r),l.style.visibility=h},F=1.2,x=function(i,r){if("text"==i.type&&(r[t]("text")||r[t]("font")||r[t]("font-size")||r[t]("x")||r[t]("y"))){var a=i.attrs,s=i.node,l=s.firstChild?o(e._g.doc.defaultView.getComputedStyle(s.firstChild,u).getPropertyValue("font-size"),10):10;if(r[t]("text")){for(a.text=r.text;s.firstChild;)s.removeChild(s.firstChild);for(var c,d=n(r.text).split("\n"),h=[],p=0,f=d.length;f>p;p++)c=m("tspan"),p&&m(c,{dy:l*F,x:a.x}),c.appendChild(e._g.doc.createTextNode(d[p])),s.appendChild(c),h[p]=c}else for(h=s.getElementsByTagName("tspan"),p=0,f=h.length;f>p;p++)p?m(h[p],{dy:l*F,x:a.x}):m(h[0],{dy:0});m(s,{x:a.x,y:a.y}),i._.dirty=1;var g=i._getBBox(),v=a.y-(g.y+g.height/2);v&&e.is(v,"finite")&&m(h[0],{dy:v})}},T=function(t,n){this[0]=this.node=t,t.raphael=!0,this.id=e._oid++,t.raphaelid=this.id,this.matrix=e.matrix(),this.realPath=null,this.paper=n,this.attrs=this.attrs||{},this._={transform:[],sx:1,sy:1,deg:0,dx:0,dy:0,dirty:1},!n.bottom&&(n.bottom=this),this.prev=n.top,n.top&&(n.top.next=this),n.top=this,this.next=null},_=e.el;T.prototype=_,_.constructor=T,e._engine.path=function(e,t){var n=m("path");t.canvas&&t.canvas.appendChild(n);var i=new T(n,t);return i.type="path",k(i,{fill:"none",stroke:"#000",path:e}),i},_.rotate=function(e,t,o){if(this.removed)return this;if(e=n(e).split(c),e.length-1&&(t=i(e[1]),o=i(e[2])),e=i(e[0]),null==o&&(t=o),null==t||null==o){var r=this.getBBox(1);t=r.x+r.width/2,o=r.y+r.height/2}return this.transform(this._.transform.concat([["r",e,t,o]])),this},_.scale=function(e,t,o,r){if(this.removed)return this;if(e=n(e).split(c),e.length-1&&(t=i(e[1]),o=i(e[2]),r=i(e[3])),e=i(e[0]),null==t&&(t=e),null==r&&(o=r),null==o||null==r)var a=this.getBBox(1);return o=null==o?a.x+a.width/2:o,r=null==r?a.y+a.height/2:r,this.transform(this._.transform.concat([["s",e,t,o,r]])),this},_.translate=function(e,t){return this.removed?this:(e=n(e).split(c),e.length-1&&(t=i(e[1])),e=i(e[0])||0,t=+t||0,this.transform(this._.transform.concat([["t",e,t]])),this)},_.transform=function(n){var i=this._;if(null==n)return i.transform;if(e._extractTransform(this,n),this.clip&&m(this.clip,{transform:this.matrix.invert()}),this.pattern&&y(this),this.node&&m(this.node,{transform:this.matrix}),1!=i.sx||1!=i.sy){var o=this.attrs[t]("stroke-width")?this.attrs["stroke-width"]:1;this.attr({"stroke-width":o})}return this},_.hide=function(){return!this.removed&&this.paper.safari(this.node.style.display="none"),this},_.show=function(){return!this.removed&&this.paper.safari(this.node.style.display=""),this},_.remove=function(){if(!this.removed&&this.node.parentNode){var t=this.paper;t.__set__&&t.__set__.exclude(this),d.unbind("raphael.*.*."+this.id),this.gradient&&t.defs.removeChild(this.gradient),e._tear(this,t),"a"==this.node.parentNode.tagName.toLowerCase()?this.node.parentNode.parentNode.removeChild(this.node.parentNode):this.node.parentNode.removeChild(this.node);for(var n in this)this[n]="function"==typeof this[n]?e._removedFactory(n):null;this.removed=!0}},_._getBBox=function(){if("none"==this.node.style.display){this.show();var e=!0}var t={};try{t=this.node.getBBox()}catch(n){}finally{t=t||{}}return e&&this.hide(),t},_.attr=function(n,i){if(this.removed)return this;if(null==n){var o={};for(var r in this.attrs)this.attrs[t](r)&&(o[r]=this.attrs[r]);return o.gradient&&"none"==o.fill&&(o.fill=o.gradient)&&delete o.gradient,o.transform=this._.transform,o}if(null==i&&e.is(n,"string")){if("fill"==n&&"none"==this.attrs.fill&&this.attrs.gradient)return this.attrs.gradient;if("transform"==n)return this._.transform;for(var a=n.split(c),s={},l=0,u=a.length;u>l;l++)n=a[l],n in this.attrs?s[n]=this.attrs[n]:e.is(this.paper.customAttributes[n],"function")?s[n]=this.paper.customAttributes[n].def:s[n]=e._availableAttrs[n];return u-1?s:s[a[0]]}if(null==i&&e.is(n,"array")){for(s={},l=0,u=n.length;u>l;l++)s[n[l]]=this.attr(n[l]);return s}if(null!=i){var h={};h[n]=i}else null!=n&&e.is(n,"object")&&(h=n);for(var p in h)d("raphael.attr."+p+"."+this.id,this,h[p]);for(p in this.paper.customAttributes)if(this.paper.customAttributes[t](p)&&h[t](p)&&e.is(this.paper.customAttributes[p],"function")){var f=this.paper.customAttributes[p].apply(this,[].concat(h[p]));this.attrs[p]=h[p];for(var g in f)f[t](g)&&(h[g]=f[g])}return k(this,h),this},_.toFront=function(){if(this.removed)return this;"a"==this.node.parentNode.tagName.toLowerCase()?this.node.parentNode.parentNode.appendChild(this.node.parentNode):this.node.parentNode.appendChild(this.node);var t=this.paper;return t.top!=this&&e._tofront(this,t),this},_.toBack=function(){if(this.removed)return this;var t=this.node.parentNode;"a"==t.tagName.toLowerCase()?t.parentNode.insertBefore(this.node.parentNode,this.node.parentNode.parentNode.firstChild):t.firstChild!=this.node&&t.insertBefore(this.node,this.node.parentNode.firstChild),e._toback(this,this.paper);this.paper;return this},_.insertAfter=function(t){if(this.removed)return this;var n=t.node||t[t.length-1].node;return n.nextSibling?n.parentNode.insertBefore(this.node,n.nextSibling):n.parentNode.appendChild(this.node),e._insertafter(this,t,this.paper),this},_.insertBefore=function(t){if(this.removed)return this;var n=t.node||t[0].node;return n.parentNode.insertBefore(this.node,n),e._insertbefore(this,t,this.paper),this},_.blur=function(t){var n=this;if(0!==+t){var i=m("filter"),o=m("feGaussianBlur");n.attrs.blur=t,i.id=e.createUUID(),m(o,{stdDeviation:+t||1.5}),i.appendChild(o),n.paper.defs.appendChild(i),n._blur=i,m(n.node,{filter:"url(#"+i.id+")"})}else n._blur&&(n._blur.parentNode.removeChild(n._blur),delete n._blur,delete n.attrs.blur),n.node.removeAttribute("filter")},e._engine.circle=function(e,t,n,i){var o=m("circle");e.canvas&&e.canvas.appendChild(o);var r=new T(o,e);return r.attrs={cx:t,cy:n,r:i,fill:"none",stroke:"#000"},r.type="circle",m(o,r.attrs),r},e._engine.rect=function(e,t,n,i,o,r){var a=m("rect");e.canvas&&e.canvas.appendChild(a);var s=new T(a,e);return s.attrs={x:t,y:n,width:i,height:o,r:r||0,rx:r||0,ry:r||0,fill:"none",stroke:"#000"},s.type="rect",m(a,s.attrs),s},e._engine.ellipse=function(e,t,n,i,o){var r=m("ellipse");e.canvas&&e.canvas.appendChild(r);var a=new T(r,e);return a.attrs={cx:t,cy:n,rx:i,ry:o,fill:"none",stroke:"#000"},a.type="ellipse",m(r,a.attrs),a},e._engine.image=function(e,t,n,i,o,r){var a=m("image");m(a,{x:n,y:i,width:o,height:r,preserveAspectRatio:"none"}),a.setAttributeNS(p,"href",t),e.canvas&&e.canvas.appendChild(a);var s=new T(a,e);return s.attrs={x:n,y:i,width:o,height:r,src:t},s.type="image",s},e._engine.text=function(t,n,i,o){var r=m("text");t.canvas&&t.canvas.appendChild(r);var a=new T(r,t);return a.attrs={x:n,y:i,"text-anchor":"middle",text:o,font:e._availableAttrs.font,stroke:"none",fill:"#000"},a.type="text",k(a,a.attrs),a},e._engine.setSize=function(e,t){return this.width=e||this.width,this.height=t||this.height,
this.canvas.setAttribute("width",this.width),this.canvas.setAttribute("height",this.height),this._viewBox&&this.setViewBox.apply(this,this._viewBox),this},e._engine.create=function(){var t=e._getContainer.apply(0,arguments),n=t&&t.container,i=t.x,o=t.y,r=t.width,a=t.height;if(!n)throw new Error("SVG container not found.");var s,l=m("svg"),c="overflow:hidden;";return i=i||0,o=o||0,r=r||512,a=a||342,m(l,{height:a,version:1.1,width:r,xmlns:"http://www.w3.org/2000/svg"}),1==n?(l.style.cssText=c+"position:absolute;left:"+i+"px;top:"+o+"px",e._g.doc.body.appendChild(l),s=1):(l.style.cssText=c+"position:relative",n.firstChild?n.insertBefore(l,n.firstChild):n.appendChild(l)),n=new e._Paper,n.width=r,n.height=a,n.canvas=l,n.clear(),n._left=n._top=0,s&&(n.renderfix=function(){}),n.renderfix(),n},e._engine.setViewBox=function(e,t,n,i,o){d("raphael.setViewBox",this,this._viewBox,[e,t,n,i,o]);var r,s,l=a(n/this.width,i/this.height),c=this.top,u=o?"meet":"xMinYMin";for(null==e?(this._vbSize&&(l=1),delete this._vbSize,r="0 0 "+this.width+h+this.height):(this._vbSize=l,r=e+h+t+h+n+h+i),m(this.canvas,{viewBox:r,preserveAspectRatio:u});l&&c;)s="stroke-width"in c.attrs?c.attrs["stroke-width"]:1,c.attr({"stroke-width":s}),c._.dirty=1,c._.dirtyT=1,c=c.prev;return this._viewBox=[e,t,n,i,!!o],this},e.prototype.renderfix=function(){var e,t=this.canvas,n=t.style;try{e=t.getScreenCTM()||t.createSVGMatrix()}catch(i){e=t.createSVGMatrix()}var o=-e.e%1,r=-e.f%1;(o||r)&&(o&&(this._left=(this._left+o)%1,n.left=this._left+"px"),r&&(this._top=(this._top+r)%1,n.top=this._top+"px"))},e.prototype.clear=function(){e.eve("raphael.clear",this);for(var t=this.canvas;t.firstChild;)t.removeChild(t.firstChild);this.bottom=this.top=null,(this.desc=m("desc")).appendChild(e._g.doc.createTextNode("Created with Raphaël "+e.version)),t.appendChild(this.desc),t.appendChild(this.defs=m("defs"))},e.prototype.remove=function(){d("raphael.remove",this),this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas);for(var t in this)this[t]="function"==typeof this[t]?e._removedFactory(t):null};var E=e.st;for(var S in _)_[t](S)&&!E[t](S)&&(E[S]=function(e){return function(){var t=arguments;return this.forEach(function(n){n[e].apply(n,t)})}}(S))}(window.Raphael),window.Raphael.vml&&function(e){var t="hasOwnProperty",n=String,i=parseFloat,o=Math,r=o.round,a=o.max,s=o.min,l=o.abs,c="fill",d=/[, ]+/,u=e.eve,h=" progid:DXImageTransform.Microsoft",p=" ",f="",g={M:"m",L:"l",C:"c",Z:"x",m:"t",l:"r",c:"v",z:"x"},m=/([clmz]),?([^clmz]*)/gi,v=/ progid:\S+Blur\([^\)]+\)/g,y=/-?[^,\s-]+/g,w="position:absolute;left:0;top:0;width:1px;height:1px",b=21600,C={path:1,rect:1,image:1},k={circle:1,ellipse:1},F=function(t){var i=/[ahqstv]/gi,o=e._pathToAbsolute;if(n(t).match(i)&&(o=e._path2curve),i=/[clmz]/g,o==e._pathToAbsolute&&!n(t).match(i)){var a=n(t).replace(m,function(e,t,n){var i=[],o="m"==t.toLowerCase(),a=g[t];return n.replace(y,function(e){o&&2==i.length&&(a+=i+g["m"==t?"l":"L"],i=[]),i.push(r(e*b))}),a+i});return a}var s,l,c=o(t);a=[];for(var d=0,u=c.length;u>d;d++){s=c[d],l=c[d][0].toLowerCase(),"z"==l&&(l="x");for(var h=1,v=s.length;v>h;h++)l+=r(s[h]*b)+(h!=v-1?",":f);a.push(l)}return a.join(p)},x=function(t,n,i){var o=e.matrix();return o.rotate(-t,.5,.5),{dx:o.x(n,i),dy:o.y(n,i)}},T=function(e,t,n,i,o,r){var a=e._,s=e.matrix,d=a.fillpos,u=e.node,h=u.style,f=1,g="",m=b/t,v=b/n;if(h.visibility="hidden",t&&n){if(u.coordsize=l(m)+p+l(v),h.rotation=r*(0>t*n?-1:1),r){var y=x(r,i,o);i=y.dx,o=y.dy}if(0>t&&(g+="x"),0>n&&(g+=" y")&&(f=-1),h.flip=g,u.coordorigin=i*-m+p+o*-v,d||a.fillsize){var w=u.getElementsByTagName(c);w=w&&w[0],u.removeChild(w),d&&(y=x(r,s.x(d[0],d[1]),s.y(d[0],d[1])),w.position=y.dx*f+p+y.dy*f),a.fillsize&&(w.size=a.fillsize[0]*l(t)+p+a.fillsize[1]*l(n)),u.appendChild(w)}h.visibility="visible"}};e.toString=function(){return"Your browser doesn’t support SVG. Falling down to VML.\nYou are running Raphaël "+this.version};var _=function(e,t,i){for(var o=n(t).toLowerCase().split("-"),r=i?"end":"start",a=o.length,s="classic",l="medium",c="medium";a--;)switch(o[a]){case"block":case"classic":case"oval":case"diamond":case"open":case"none":s=o[a];break;case"wide":case"narrow":c=o[a];break;case"long":case"short":l=o[a]}var d=e.node.getElementsByTagName("stroke")[0];d[r+"arrow"]=s,d[r+"arrowlength"]=l,d[r+"arrowwidth"]=c},E=function(o,l){o.attrs=o.attrs||{};var u=o.node,h=o.attrs,g=u.style,m=C[o.type]&&(l.x!=h.x||l.y!=h.y||l.width!=h.width||l.height!=h.height||l.cx!=h.cx||l.cy!=h.cy||l.rx!=h.rx||l.ry!=h.ry||l.r!=h.r),v=k[o.type]&&(h.cx!=l.cx||h.cy!=l.cy||h.r!=l.r||h.rx!=l.rx||h.ry!=l.ry),y=o;for(var w in l)l[t](w)&&(h[w]=l[w]);if(m&&(h.path=e._getPath[o.type](o),o._.dirty=1),l.href&&(u.href=l.href),l.title&&(u.title=l.title),l.target&&(u.target=l.target),l.cursor&&(g.cursor=l.cursor),"blur"in l&&o.blur(l.blur),(l.path&&"path"==o.type||m)&&(u.path=F(~n(h.path).toLowerCase().indexOf("r")?e._pathToAbsolute(h.path):h.path),"image"==o.type&&(o._.fillpos=[h.x,h.y],o._.fillsize=[h.width,h.height],T(o,1,1,0,0,0))),"transform"in l&&o.transform(l.transform),v){var x=+h.cx,E=+h.cy,j=+h.rx||+h.r||0,I=+h.ry||+h.r||0;u.path=e.format("ar{0},{1},{2},{3},{4},{1},{4},{1}x",r((x-j)*b),r((E-I)*b),r((x+j)*b),r((E+I)*b),r(x*b))}if("clip-rect"in l){var O=n(l["clip-rect"]).split(d);if(4==O.length){O[2]=+O[2]+ +O[0],O[3]=+O[3]+ +O[1];var M=u.clipRect||e._g.doc.createElement("div"),P=M.style;P.clip=e.format("rect({1}px {2}px {3}px {0}px)",O),u.clipRect||(P.position="absolute",P.top=0,P.left=0,P.width=o.paper.width+"px",P.height=o.paper.height+"px",u.parentNode.insertBefore(M,u),M.appendChild(u),u.clipRect=M)}l["clip-rect"]||u.clipRect&&(u.clipRect.style.clip="auto")}if(o.textpath){var B=o.textpath.style;l.font&&(B.font=l.font),l["font-family"]&&(B.fontFamily='"'+l["font-family"].split(",")[0].replace(/^['"]+|['"]+$/g,f)+'"'),l["font-size"]&&(B.fontSize=l["font-size"]),l["font-weight"]&&(B.fontWeight=l["font-weight"]),l["font-style"]&&(B.fontStyle=l["font-style"])}if("arrow-start"in l&&_(y,l["arrow-start"]),"arrow-end"in l&&_(y,l["arrow-end"],1),null!=l.opacity||null!=l["stroke-width"]||null!=l.fill||null!=l.src||null!=l.stroke||null!=l["stroke-width"]||null!=l["stroke-opacity"]||null!=l["fill-opacity"]||null!=l["stroke-dasharray"]||null!=l["stroke-miterlimit"]||null!=l["stroke-linejoin"]||null!=l["stroke-linecap"]){var R=u.getElementsByTagName(c),L=!1;if(R=R&&R[0],!R&&(L=R=A(c)),"image"==o.type&&l.src&&(R.src=l.src),l.fill&&(R.on=!0),(null==R.on||"none"==l.fill||null===l.fill)&&(R.on=!1),R.on&&l.fill){var N=n(l.fill).match(e._ISURL);if(N){R.parentNode==u&&u.removeChild(R),R.rotate=!0,R.src=N[1],R.type="tile";var D=o.getBBox(1);R.position=D.x+p+D.y,o._.fillpos=[D.x,D.y],e._preload(N[1],function(){o._.fillsize=[this.offsetWidth,this.offsetHeight]})}else R.color=e.getRGB(l.fill).hex,R.src=f,R.type="solid",e.getRGB(l.fill).error&&(y.type in{circle:1,ellipse:1}||"r"!=n(l.fill).charAt())&&S(y,l.fill,R)&&(h.fill="none",h.gradient=l.fill,R.rotate=!1)}if("fill-opacity"in l||"opacity"in l){var Q=((+h["fill-opacity"]+1||2)-1)*((+h.opacity+1||2)-1)*((+e.getRGB(l.fill).o+1||2)-1);Q=s(a(Q,0),1),R.opacity=Q,R.src&&(R.color="none")}u.appendChild(R);var H=u.getElementsByTagName("stroke")&&u.getElementsByTagName("stroke")[0],G=!1;!H&&(G=H=A("stroke")),(l.stroke&&"none"!=l.stroke||l["stroke-width"]||null!=l["stroke-opacity"]||l["stroke-dasharray"]||l["stroke-miterlimit"]||l["stroke-linejoin"]||l["stroke-linecap"])&&(H.on=!0),("none"==l.stroke||null===l.stroke||null==H.on||0==l.stroke||0==l["stroke-width"])&&(H.on=!1);var V=e.getRGB(l.stroke);H.on&&l.stroke&&(H.color=V.hex),Q=((+h["stroke-opacity"]+1||2)-1)*((+h.opacity+1||2)-1)*((+V.o+1||2)-1);var U=.75*(i(l["stroke-width"])||1);if(Q=s(a(Q,0),1),null==l["stroke-width"]&&(U=h["stroke-width"]),l["stroke-width"]&&(H.weight=U),U&&1>U&&(Q*=U)&&(H.weight=1),H.opacity=Q,l["stroke-linejoin"]&&(H.joinstyle=l["stroke-linejoin"]||"miter"),H.miterlimit=l["stroke-miterlimit"]||8,l["stroke-linecap"]&&(H.endcap="butt"==l["stroke-linecap"]?"flat":"square"==l["stroke-linecap"]?"square":"round"),l["stroke-dasharray"]){var z={"-":"shortdash",".":"shortdot","-.":"shortdashdot","-..":"shortdashdotdot",". ":"dot","- ":"dash","--":"longdash","- .":"dashdot","--.":"longdashdot","--..":"longdashdotdot"};H.dashstyle=z[t](l["stroke-dasharray"])?z[l["stroke-dasharray"]]:f}G&&u.appendChild(H)}if("text"==y.type){y.paper.canvas.style.display=f;var W=y.paper.span,$=100,q=h.font&&h.font.match(/\d+(?:\.\d*)?(?=px)/);g=W.style,h.font&&(g.font=h.font),h["font-family"]&&(g.fontFamily=h["font-family"]),h["font-weight"]&&(g.fontWeight=h["font-weight"]),h["font-style"]&&(g.fontStyle=h["font-style"]),q=i(h["font-size"]||q&&q[0])||10,g.fontSize=q*$+"px",y.textpath.string&&(W.innerHTML=n(y.textpath.string).replace(/</g,"&#60;").replace(/&/g,"&#38;").replace(/\n/g,"<br>"));var K=W.getBoundingClientRect();y.W=h.w=(K.right-K.left)/$,y.H=h.h=(K.bottom-K.top)/$,y.X=h.x,y.Y=h.y+y.H/2,("x"in l||"y"in l)&&(y.path.v=e.format("m{0},{1}l{2},{1}",r(h.x*b),r(h.y*b),r(h.x*b)+1));for(var Y=["x","y","text","font","font-family","font-weight","font-style","font-size"],J=0,X=Y.length;X>J;J++)if(Y[J]in l){y._.dirty=1;break}switch(h["text-anchor"]){case"start":y.textpath.style["v-text-align"]="left",y.bbx=y.W/2;break;case"end":y.textpath.style["v-text-align"]="right",y.bbx=-y.W/2;break;default:y.textpath.style["v-text-align"]="center",y.bbx=0}y.textpath.style["v-text-kern"]=!0}},S=function(t,r,a){t.attrs=t.attrs||{};var s=(t.attrs,Math.pow),l="linear",c=".5 .5";if(t.attrs.gradient=r,r=n(r).replace(e._radial_gradient,function(e,t,n){return l="radial",t&&n&&(t=i(t),n=i(n),s(t-.5,2)+s(n-.5,2)>.25&&(n=o.sqrt(.25-s(t-.5,2))*(2*(n>.5)-1)+.5),c=t+p+n),f}),r=r.split(/\s*\-\s*/),"linear"==l){var d=r.shift();if(d=-i(d),isNaN(d))return null}var u=e._parseDots(r);if(!u)return null;if(t=t.shape||t.node,u.length){t.removeChild(a),a.on=!0,a.method="none",a.color=u[0].color,a.color2=u[u.length-1].color;for(var h=[],g=0,m=u.length;m>g;g++)u[g].offset&&h.push(u[g].offset+p+u[g].color);a.colors=h.length?h.join():"0% "+a.color,"radial"==l?(a.type="gradientTitle",a.focus="100%",a.focussize="0 0",a.focusposition=c,a.angle=0):(a.type="gradient",a.angle=(270-d)%360),t.appendChild(a)}return 1},j=function(t,n){this[0]=this.node=t,t.raphael=!0,this.id=e._oid++,t.raphaelid=this.id,this.X=0,this.Y=0,this.attrs={},this.paper=n,this.matrix=e.matrix(),this._={transform:[],sx:1,sy:1,dx:0,dy:0,deg:0,dirty:1,dirtyT:1},!n.bottom&&(n.bottom=this),this.prev=n.top,n.top&&(n.top.next=this),n.top=this,this.next=null},I=e.el;j.prototype=I,I.constructor=j,I.transform=function(t){if(null==t)return this._.transform;var i,o=this.paper._viewBoxShift,r=o?"s"+[o.scale,o.scale]+"-1-1t"+[o.dx,o.dy]:f;o&&(i=t=n(t).replace(/\.{3}|\u2026/g,this._.transform||f)),e._extractTransform(this,r+t);var a,s=this.matrix.clone(),l=this.skew,c=this.node,d=~n(this.attrs.fill).indexOf("-"),u=!n(this.attrs.fill).indexOf("url(");if(s.translate(-.5,-.5),u||d||"image"==this.type)if(l.matrix="1 0 0 1",l.offset="0 0",a=s.split(),d&&a.noRotation||!a.isSimple){c.style.filter=s.toFilter();var h=this.getBBox(),g=this.getBBox(1),m=h.x-g.x,v=h.y-g.y;c.coordorigin=m*-b+p+v*-b,T(this,1,1,m,v,0)}else c.style.filter=f,T(this,a.scalex,a.scaley,a.dx,a.dy,a.rotate);else c.style.filter=f,l.matrix=n(s),l.offset=s.offset();return i&&(this._.transform=i),this},I.rotate=function(e,t,o){if(this.removed)return this;if(null!=e){if(e=n(e).split(d),e.length-1&&(t=i(e[1]),o=i(e[2])),e=i(e[0]),null==o&&(t=o),null==t||null==o){var r=this.getBBox(1);t=r.x+r.width/2,o=r.y+r.height/2}return this._.dirtyT=1,this.transform(this._.transform.concat([["r",e,t,o]])),this}},I.translate=function(e,t){return this.removed?this:(e=n(e).split(d),e.length-1&&(t=i(e[1])),e=i(e[0])||0,t=+t||0,this._.bbox&&(this._.bbox.x+=e,this._.bbox.y+=t),this.transform(this._.transform.concat([["t",e,t]])),this)},I.scale=function(e,t,o,r){if(this.removed)return this;if(e=n(e).split(d),e.length-1&&(t=i(e[1]),o=i(e[2]),r=i(e[3]),isNaN(o)&&(o=null),isNaN(r)&&(r=null)),e=i(e[0]),null==t&&(t=e),null==r&&(o=r),null==o||null==r)var a=this.getBBox(1);return o=null==o?a.x+a.width/2:o,r=null==r?a.y+a.height/2:r,this.transform(this._.transform.concat([["s",e,t,o,r]])),this._.dirtyT=1,this},I.hide=function(){return!this.removed&&(this.node.style.display="none"),this},I.show=function(){return!this.removed&&(this.node.style.display=f),this},I._getBBox=function(){return this.removed?{}:{x:this.X+(this.bbx||0)-this.W/2,y:this.Y-this.H,width:this.W,height:this.H}},I.remove=function(){if(!this.removed&&this.node.parentNode){this.paper.__set__&&this.paper.__set__.exclude(this),e.eve.unbind("raphael.*.*."+this.id),e._tear(this,this.paper),this.node.parentNode.removeChild(this.node),this.shape&&this.shape.parentNode.removeChild(this.shape);for(var t in this)this[t]="function"==typeof this[t]?e._removedFactory(t):null;this.removed=!0}},I.attr=function(n,i){if(this.removed)return this;if(null==n){var o={};for(var r in this.attrs)this.attrs[t](r)&&(o[r]=this.attrs[r]);return o.gradient&&"none"==o.fill&&(o.fill=o.gradient)&&delete o.gradient,o.transform=this._.transform,o}if(null==i&&e.is(n,"string")){if(n==c&&"none"==this.attrs.fill&&this.attrs.gradient)return this.attrs.gradient;for(var a=n.split(d),s={},l=0,h=a.length;h>l;l++)n=a[l],n in this.attrs?s[n]=this.attrs[n]:e.is(this.paper.customAttributes[n],"function")?s[n]=this.paper.customAttributes[n].def:s[n]=e._availableAttrs[n];return h-1?s:s[a[0]]}if(this.attrs&&null==i&&e.is(n,"array")){for(s={},l=0,h=n.length;h>l;l++)s[n[l]]=this.attr(n[l]);return s}var p;null!=i&&(p={},p[n]=i),null==i&&e.is(n,"object")&&(p=n);for(var f in p)u("raphael.attr."+f+"."+this.id,this,p[f]);if(p){for(f in this.paper.customAttributes)if(this.paper.customAttributes[t](f)&&p[t](f)&&e.is(this.paper.customAttributes[f],"function")){var g=this.paper.customAttributes[f].apply(this,[].concat(p[f]));this.attrs[f]=p[f];for(var m in g)g[t](m)&&(p[m]=g[m])}p.text&&"text"==this.type&&(this.textpath.string=p.text),E(this,p)}return this},I.toFront=function(){return!this.removed&&this.node.parentNode.appendChild(this.node),this.paper&&this.paper.top!=this&&e._tofront(this,this.paper),this},I.toBack=function(){return this.removed?this:(this.node.parentNode.firstChild!=this.node&&(this.node.parentNode.insertBefore(this.node,this.node.parentNode.firstChild),e._toback(this,this.paper)),this)},I.insertAfter=function(t){return this.removed?this:(t.constructor==e.st.constructor&&(t=t[t.length-1]),t.node.nextSibling?t.node.parentNode.insertBefore(this.node,t.node.nextSibling):t.node.parentNode.appendChild(this.node),e._insertafter(this,t,this.paper),this)},I.insertBefore=function(t){return this.removed?this:(t.constructor==e.st.constructor&&(t=t[0]),t.node.parentNode.insertBefore(this.node,t.node),e._insertbefore(this,t,this.paper),this)},I.blur=function(t){var n=this.node.runtimeStyle,i=n.filter;i=i.replace(v,f),0!==+t?(this.attrs.blur=t,n.filter=i+p+h+".Blur(pixelradius="+(+t||1.5)+")",n.margin=e.format("-{0}px 0 0 -{0}px",r(+t||1.5))):(n.filter=i,n.margin=0,delete this.attrs.blur)},e._engine.path=function(e,t){var n=A("shape");n.style.cssText=w,n.coordsize=b+p+b,n.coordorigin=t.coordorigin;var i=new j(n,t),o={fill:"none",stroke:"#000"};e&&(o.path=e),i.type="path",i.path=[],i.Path=f,E(i,o),t.canvas.appendChild(n);var r=A("skew");return r.on=!0,n.appendChild(r),i.skew=r,i.transform(f),i},e._engine.rect=function(t,n,i,o,r,a){var s=e._rectPath(n,i,o,r,a),l=t.path(s),c=l.attrs;return l.X=c.x=n,l.Y=c.y=i,l.W=c.width=o,l.H=c.height=r,c.r=a,c.path=s,l.type="rect",l},e._engine.ellipse=function(e,t,n,i,o){var r=e.path();r.attrs;return r.X=t-i,r.Y=n-o,r.W=2*i,r.H=2*o,r.type="ellipse",E(r,{cx:t,cy:n,rx:i,ry:o}),r},e._engine.circle=function(e,t,n,i){var o=e.path();o.attrs;return o.X=t-i,o.Y=n-i,o.W=o.H=2*i,o.type="circle",E(o,{cx:t,cy:n,r:i}),o},e._engine.image=function(t,n,i,o,r,a){var s=e._rectPath(i,o,r,a),l=t.path(s).attr({stroke:"none"}),d=l.attrs,u=l.node,h=u.getElementsByTagName(c)[0];return d.src=n,l.X=d.x=i,l.Y=d.y=o,l.W=d.width=r,l.H=d.height=a,d.path=s,l.type="image",h.parentNode==u&&u.removeChild(h),h.rotate=!0,h.src=n,h.type="tile",l._.fillpos=[i,o],l._.fillsize=[r,a],u.appendChild(h),T(l,1,1,0,0,0),l},e._engine.text=function(t,i,o,a){var s=A("shape"),l=A("path"),c=A("textpath");i=i||0,o=o||0,a=a||"",l.v=e.format("m{0},{1}l{2},{1}",r(i*b),r(o*b),r(i*b)+1),l.textpathok=!0,c.string=n(a),c.on=!0,s.style.cssText=w,s.coordsize=b+p+b,s.coordorigin="0 0";var d=new j(s,t),u={fill:"#000",stroke:"none",font:e._availableAttrs.font,text:a};d.shape=s,d.path=l,d.textpath=c,d.type="text",d.attrs.text=n(a),d.attrs.x=i,d.attrs.y=o,d.attrs.w=1,d.attrs.h=1,E(d,u),s.appendChild(c),s.appendChild(l),t.canvas.appendChild(s);var h=A("skew");return h.on=!0,s.appendChild(h),d.skew=h,d.transform(f),d},e._engine.setSize=function(t,n){var i=this.canvas.style;return this.width=t,this.height=n,t==+t&&(t+="px"),n==+n&&(n+="px"),i.width=t,i.height=n,i.clip="rect(0 "+t+" "+n+" 0)",this._viewBox&&e._engine.setViewBox.apply(this,this._viewBox),this},e._engine.setViewBox=function(t,n,i,o,r){e.eve("raphael.setViewBox",this,this._viewBox,[t,n,i,o,r]);var s,l,c=this.width,d=this.height,u=1/a(i/c,o/d);return r&&(s=d/o,l=c/i,c>i*s&&(t-=(c-i*s)/2/s),d>o*l&&(n-=(d-o*l)/2/l)),this._viewBox=[t,n,i,o,!!r],this._viewBoxShift={dx:-t,dy:-n,scale:u},this.forEach(function(e){e.transform("...")}),this};var A;e._engine.initWin=function(e){var t=e.document;t.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)");try{!t.namespaces.rvml&&t.namespaces.add("rvml","urn:schemas-microsoft-com:vml"),A=function(e){return t.createElement("<rvml:"+e+' class="rvml">')}}catch(n){A=function(e){return t.createElement("<"+e+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}},e._engine.initWin(e._g.win),e._engine.create=function(){var t=e._getContainer.apply(0,arguments),n=t.container,i=t.height,o=t.width,r=t.x,a=t.y;if(!n)throw new Error("VML container not found.");var s=new e._Paper,l=s.canvas=e._g.doc.createElement("div"),c=l.style;return r=r||0,a=a||0,o=o||512,i=i||342,s.width=o,s.height=i,o==+o&&(o+="px"),i==+i&&(i+="px"),s.coordsize=1e3*b+p+1e3*b,s.coordorigin="0 0",s.span=e._g.doc.createElement("span"),s.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;",l.appendChild(s.span),c.cssText=e.format("top:0;left:0;width:{0};height:{1};display:inline-block;position:relative;clip:rect(0 {0} {1} 0);overflow:hidden",o,i),1==n?(e._g.doc.body.appendChild(l),c.left=r+"px",c.top=a+"px",c.position="absolute"):n.firstChild?n.insertBefore(l,n.firstChild):n.appendChild(l),s.renderfix=function(){},s},e.prototype.clear=function(){e.eve("raphael.clear",this),this.canvas.innerHTML=f,this.span=e._g.doc.createElement("span"),this.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;",this.canvas.appendChild(this.span),this.bottom=this.top=null},e.prototype.remove=function(){e.eve("raphael.remove",this),this.canvas.parentNode.removeChild(this.canvas);for(var t in this)this[t]="function"==typeof this[t]?e._removedFactory(t):null;return!0};var O=e.st;for(var M in I)I[t](M)&&!O[t](M)&&(O[M]=function(e){return function(){var t=arguments;return this.forEach(function(n){n[e].apply(n,t)})}}(M))}(window.Raphael),Raphael.fn.arrow=function(e,t,n,i,o,r,a){a=a||"black";var s=Math.atan2(t-i,o-n);s=s/(2*Math.PI)*360;var l=t-i,c=o-n,d=Math.sqrt(c*c+l*l),u=(d-e/6)/d,h=t+(i-t)*u,p=n+(o-n)*u,f=this.path("M"+i+" "+o+" L"+(i-r)+" "+(o-r)+" L"+(i-r)+" "+(o+r)+" L"+i+" "+o).attr("fill",a).attr("stroke",a).rotate(90+s,i,o),g=this.path("M"+t+" "+n+" L"+h+" "+p).attr("stroke-linecap","round").attr("stroke",a).attr("stroke-width",Math.floor(r/2));return[g,f]},function(){function e(e){function n(){if(0===o.length)return void(s=!1);var e=t();if(e>=a){a=e+r;var i=o.shift();"function"==typeof i&&i.call()}setTimeout(n,a-e),s=!0}function i(e){o.push(e),s||n()}var o=[],r=e.interval,a=0,s=!1;return{add:i}}function t(){return(new Date).getTime()}var n=this;n.rateLimit={createQueue:e}}(window);var io="undefined"==typeof module?{}:module.exports;!function(){if(function(e,t){var n=e;n.version="0.9.16",n.protocol=1,n.transports=[],n.j=[],n.sockets={},n.connect=function(e,i){var o,r,a=n.util.parseUri(e);t&&t.location&&(a.protocol=a.protocol||t.location.protocol.slice(0,-1),a.host=a.host||(t.document?t.document.domain:t.location.hostname),a.port=a.port||t.location.port),o=n.util.uniqueUri(a);var s={host:a.host,secure:"https"==a.protocol,port:a.port||("https"==a.protocol?443:80),query:a.query||""};return n.util.merge(s,i),(s["force new connection"]||!n.sockets[o])&&(r=new n.Socket(s)),!s["force new connection"]&&r&&(n.sockets[o]=r),r=r||n.sockets[o],r.of(a.path.length>1?a.path:"")}}("object"==typeof module?module.exports:this.io={},this),function(e,t){var n=e.util={},i=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,o=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];n.parseUri=function(e){for(var t=i.exec(e||""),n={},r=14;r--;)n[o[r]]=t[r]||"";return n},n.uniqueUri=function(e){var n=e.protocol,i=e.host,o=e.port;return"document"in t?(i=i||document.domain,o=o||("https"==n&&"https:"!==document.location.protocol?443:document.location.port)):(i=i||"localhost",o||"https"!=n||(o=443)),(n||"http")+"://"+i+":"+(o||80)},n.query=function(e,t){var i=n.chunkQuery(e||""),o=[];n.merge(i,n.chunkQuery(t||""));for(var r in i)i.hasOwnProperty(r)&&o.push(r+"="+i[r]);return o.length?"?"+o.join("&"):""},n.chunkQuery=function(e){for(var t,n={},i=e.split("&"),o=0,r=i.length;r>o;++o)t=i[o].split("="),t[0]&&(n[t[0]]=t[1]);return n};var r=!1;n.load=function(e){return"document"in t&&"complete"===document.readyState||r?e():void n.on(t,"load",e,!1)},n.on=function(e,t,n,i){e.attachEvent?e.attachEvent("on"+t,n):e.addEventListener&&e.addEventListener(t,n,i)},n.request=function(e){if(e&&"undefined"!=typeof XDomainRequest&&!n.ua.hasCORS)return new XDomainRequest;if("undefined"!=typeof XMLHttpRequest&&(!e||n.ua.hasCORS))return new XMLHttpRequest;if(!e)try{return new(window[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(t){}return null},"undefined"!=typeof window&&n.load(function(){r=!0}),n.defer=function(e){return n.ua.webkit&&"undefined"==typeof importScripts?void n.load(function(){setTimeout(e,100)}):e()},n.merge=function(e,t,i,o){var r,a=o||[],s="undefined"==typeof i?2:i;for(r in t)t.hasOwnProperty(r)&&n.indexOf(a,r)<0&&("object"==typeof e[r]&&s?n.merge(e[r],t[r],s-1,a):(e[r]=t[r],a.push(t[r])));return e},n.mixin=function(e,t){n.merge(e.prototype,t.prototype)},n.inherit=function(e,t){function n(){}n.prototype=t.prototype,e.prototype=new n},n.isArray=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},n.intersect=function(e,t){for(var i=[],o=e.length>t.length?e:t,r=e.length>t.length?t:e,a=0,s=r.length;s>a;a++)~n.indexOf(o,r[a])&&i.push(r[a]);return i},n.indexOf=function(e,t,n){for(var i=e.length,n=0>n?0>n+i?0:n+i:n||0;i>n&&e[n]!==t;n++);return n>=i?-1:n},n.toArray=function(e){for(var t=[],n=0,i=e.length;i>n;n++)t.push(e[n]);return t},n.ua={},n.ua.hasCORS="undefined"!=typeof XMLHttpRequest&&function(){try{var e=new XMLHttpRequest}catch(t){return!1}return void 0!=e.withCredentials}(),n.ua.webkit="undefined"!=typeof navigator&&/webkit/i.test(navigator.userAgent),n.ua.iDevice="undefined"!=typeof navigator&&/iPad|iPhone|iPod/i.test(navigator.userAgent)}("undefined"!=typeof io?io:module.exports,this),function(e,t){function n(){}e.EventEmitter=n,n.prototype.on=function(e,n){return this.$events||(this.$events={}),this.$events[e]?t.util.isArray(this.$events[e])?this.$events[e].push(n):this.$events[e]=[this.$events[e],n]:this.$events[e]=n,this},n.prototype.addListener=n.prototype.on,n.prototype.once=function(e,t){function n(){i.removeListener(e,n),t.apply(this,arguments)}var i=this;return n.listener=t,this.on(e,n),this},n.prototype.removeListener=function(e,n){if(this.$events&&this.$events[e]){var i=this.$events[e];if(t.util.isArray(i)){for(var o=-1,r=0,a=i.length;a>r;r++)if(i[r]===n||i[r].listener&&i[r].listener===n){o=r;break}if(0>o)return this;i.splice(o,1),i.length||delete this.$events[e]}else(i===n||i.listener&&i.listener===n)&&delete this.$events[e]}return this},n.prototype.removeAllListeners=function(e){return void 0===e?(this.$events={},this):(this.$events&&this.$events[e]&&(this.$events[e]=null),this)},n.prototype.listeners=function(e){return this.$events||(this.$events={}),this.$events[e]||(this.$events[e]=[]),t.util.isArray(this.$events[e])||(this.$events[e]=[this.$events[e]]),this.$events[e]},n.prototype.emit=function(e){if(!this.$events)return!1;var n=this.$events[e];if(!n)return!1;var i=Array.prototype.slice.call(arguments,1);if("function"==typeof n)n.apply(this,i);else{if(!t.util.isArray(n))return!1;for(var o=n.slice(),r=0,a=o.length;a>r;r++)o[r].apply(this,i)}return!0}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(exports,nativeJSON){"use strict";function f(e){return 10>e?"0"+e:e}function date(e,t){return isFinite(e.valueOf())?e.getUTCFullYear()+"-"+f(e.getUTCMonth()+1)+"-"+f(e.getUTCDate())+"T"+f(e.getUTCHours())+":"+f(e.getUTCMinutes())+":"+f(e.getUTCSeconds())+"Z":null}function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var n,i,o,r,a,s=gap,l=t[e];switch(l instanceof Date&&(l=date(e)),"function"==typeof rep&&(l=rep.call(t,e,l)),typeof l){case"string":return quote(l);case"number":return isFinite(l)?String(l):"null";case"boolean":case"null":return String(l);case"object":if(!l)return"null";if(gap+=indent,a=[],"[object Array]"===Object.prototype.toString.apply(l)){for(r=l.length,n=0;r>n;n+=1)a[n]=str(n,l)||"null";return o=0===a.length?"[]":gap?"[\n"+gap+a.join(",\n"+gap)+"\n"+s+"]":"["+a.join(",")+"]",gap=s,o}if(rep&&"object"==typeof rep)for(r=rep.length,n=0;r>n;n+=1)"string"==typeof rep[n]&&(i=rep[n],o=str(i,l),o&&a.push(quote(i)+(gap?": ":":")+o));else for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(o=str(i,l),o&&a.push(quote(i)+(gap?": ":":")+o));return o=0===a.length?"{}":gap?"{\n"+gap+a.join(",\n"+gap)+"\n"+s+"}":"{"+a.join(",")+"}",gap=s,o}}if(nativeJSON&&nativeJSON.parse)return exports.JSON={parse:nativeJSON.parse,stringify:nativeJSON.stringify};var JSON=exports.JSON={},cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;JSON.stringify=function(e,t,n){var i;if(gap="",indent="","number"==typeof n)for(i=0;n>i;i+=1)indent+=" ";else"string"==typeof n&&(indent=n);if(rep=t,t&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw new Error("JSON.stringify");return str("",{"":e})},JSON.parse=function(text,reviver){function walk(e,t){var n,i,o=e[t];if(o&&"object"==typeof o)for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(i=walk(o,n),void 0!==i?o[n]=i:delete o[n]);return reviver.call(e,t,o)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof JSON?JSON:void 0),function(e,t){var n=e.parser={},i=n.packets=["disconnect","connect","heartbeat","message","json","event","ack","error","noop"],o=n.reasons=["transport not supported","client not handshaken","unauthorized"],r=n.advice=["reconnect"],a=t.JSON,s=t.util.indexOf;n.encodePacket=function(e){var t=s(i,e.type),n=e.id||"",l=e.endpoint||"",c=e.ack,d=null;switch(e.type){case"error":var u=e.reason?s(o,e.reason):"",h=e.advice?s(r,e.advice):"";(""!==u||""!==h)&&(d=u+(""!==h?"+"+h:""));break;case"message":""!==e.data&&(d=e.data);break;case"event":var p={name:e.name};e.args&&e.args.length&&(p.args=e.args),d=a.stringify(p);break;case"json":d=a.stringify(e.data);break;case"connect":e.qs&&(d=e.qs);break;case"ack":d=e.ackId+(e.args&&e.args.length?"+"+a.stringify(e.args):"")}var f=[t,n+("data"==c?"+":""),l];return null!==d&&void 0!==d&&f.push(d),f.join(":")},n.encodePayload=function(e){var t="";if(1==e.length)return e[0];for(var n=0,i=e.length;i>n;n++){var o=e[n];t+="�"+o.length+"�"+e[n]}return t};var l=/([^:]+):([0-9]+)?(\+)?:([^:]+)?:?([\s\S]*)?/;n.decodePacket=function(e){var t=e.match(l);if(!t)return{};var n=t[2]||"",e=t[5]||"",s={type:i[t[1]],endpoint:t[4]||""};switch(n&&(s.id=n,t[3]?s.ack="data":s.ack=!0),s.type){case"error":var t=e.split("+");s.reason=o[t[0]]||"",s.advice=r[t[1]]||"";break;case"message":s.data=e||"";break;case"event":try{var c=a.parse(e);s.name=c.name,s.args=c.args}catch(d){}s.args=s.args||[];break;case"json":try{s.data=a.parse(e)}catch(d){}break;case"connect":s.qs=e||"";break;case"ack":var t=e.match(/^([0-9]+)(\+)?(.*)/);if(t&&(s.ackId=t[1],s.args=[],t[3]))try{s.args=t[3]?a.parse(t[3]):[]}catch(d){}break;case"disconnect":case"heartbeat":}return s},n.decodePayload=function(e){if("�"==e.charAt(0)){for(var t=[],i=1,o="";i<e.length;i++)"�"==e.charAt(i)?(t.push(n.decodePacket(e.substr(i+1).substr(0,o))),i+=Number(o)+1,o=""):o+=e.charAt(i);return t}return[n.decodePacket(e)]}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(e,t){function n(e,t){this.socket=e,this.sessid=t}e.Transport=n,t.util.mixin(n,t.EventEmitter),n.prototype.heartbeats=function(){return!0},n.prototype.onData=function(e){if(this.clearCloseTimeout(),(this.socket.connected||this.socket.connecting||this.socket.reconnecting)&&this.setCloseTimeout(),""!==e){var n=t.parser.decodePayload(e);if(n&&n.length)for(var i=0,o=n.length;o>i;i++)this.onPacket(n[i])}return this},n.prototype.onPacket=function(e){return this.socket.setHeartbeatTimeout(),"heartbeat"==e.type?this.onHeartbeat():("connect"==e.type&&""==e.endpoint&&this.onConnect(),"error"==e.type&&"reconnect"==e.advice&&(this.isOpen=!1),this.socket.onPacket(e),this)},n.prototype.setCloseTimeout=function(){if(!this.closeTimeout){var e=this;this.closeTimeout=setTimeout(function(){e.onDisconnect()},this.socket.closeTimeout)}},n.prototype.onDisconnect=function(){return this.isOpen&&this.close(),this.clearTimeouts(),this.socket.onDisconnect(),this},n.prototype.onConnect=function(){return this.socket.onConnect(),this},n.prototype.clearCloseTimeout=function(){this.closeTimeout&&(clearTimeout(this.closeTimeout),this.closeTimeout=null)},n.prototype.clearTimeouts=function(){this.clearCloseTimeout(),this.reopenTimeout&&clearTimeout(this.reopenTimeout)},n.prototype.packet=function(e){this.send(t.parser.encodePacket(e))},n.prototype.onHeartbeat=function(e){this.packet({type:"heartbeat"})},n.prototype.onOpen=function(){this.isOpen=!0,this.clearCloseTimeout(),this.socket.onOpen()},n.prototype.onClose=function(){this.isOpen=!1,this.socket.onClose(),this.onDisconnect()},n.prototype.prepareUrl=function(){var e=this.socket.options;return this.scheme()+"://"+e.host+":"+e.port+"/"+e.resource+"/"+t.protocol+"/"+this.name+"/"+this.sessid},n.prototype.ready=function(e,t){t.call(this)}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(e,t,n){function i(e){if(this.options={
port:80,secure:!1,document:"document"in n?document:!1,resource:"socket.io",transports:t.transports,"connect timeout":1e4,"try multiple transports":!0,reconnect:!0,"reconnection delay":500,"reconnection limit":1/0,"reopen delay":3e3,"max reconnection attempts":10,"sync disconnect on unload":!1,"auto connect":!0,"flash policy port":10843,manualFlush:!1},t.util.merge(this.options,e),this.connected=!1,this.open=!1,this.connecting=!1,this.reconnecting=!1,this.namespaces={},this.buffer=[],this.doBuffer=!1,this.options["sync disconnect on unload"]&&(!this.isXDomain()||t.util.ua.hasCORS)){var i=this;t.util.on(n,"beforeunload",function(){i.disconnectSync()},!1)}this.options["auto connect"]&&this.connect()}function o(){}e.Socket=i,t.util.mixin(i,t.EventEmitter),i.prototype.of=function(e){return this.namespaces[e]||(this.namespaces[e]=new t.SocketNamespace(this,e),""!==e&&this.namespaces[e].packet({type:"connect"})),this.namespaces[e]},i.prototype.publish=function(){this.emit.apply(this,arguments);var e;for(var t in this.namespaces)this.namespaces.hasOwnProperty(t)&&(e=this.of(t),e.$emit.apply(e,arguments))},i.prototype.handshake=function(e){function n(t){t instanceof Error?(i.connecting=!1,i.onError(t.message)):e.apply(null,t.split(":"))}var i=this,r=this.options,a=["http"+(r.secure?"s":"")+":/",r.host+":"+r.port,r.resource,t.protocol,t.util.query(this.options.query,"t="+ +new Date)].join("/");if(this.isXDomain()&&!t.util.ua.hasCORS){var s=document.getElementsByTagName("script")[0],l=document.createElement("script");l.src=a+"&jsonp="+t.j.length,s.parentNode.insertBefore(l,s),t.j.push(function(e){n(e),l.parentNode.removeChild(l)})}else{var c=t.util.request();c.open("GET",a,!0),this.isXDomain()&&(c.withCredentials=!0),c.onreadystatechange=function(){4==c.readyState&&(c.onreadystatechange=o,200==c.status?n(c.responseText):403==c.status?i.onError(c.responseText):(i.connecting=!1,!i.reconnecting&&i.onError(c.responseText)))},c.send(null)}},i.prototype.getTransport=function(e){for(var n,i=e||this.transports,o=0;n=i[o];o++)if(t.Transport[n]&&t.Transport[n].check(this)&&(!this.isXDomain()||t.Transport[n].xdomainCheck(this)))return new t.Transport[n](this,this.sessionid);return null},i.prototype.connect=function(e){if(this.connecting)return this;var n=this;return n.connecting=!0,this.handshake(function(i,o,r,a){function s(e){return n.transport&&n.transport.clearTimeouts(),n.transport=n.getTransport(e),n.transport?void n.transport.ready(n,function(){n.connecting=!0,n.publish("connecting",n.transport.name),n.transport.open(),n.options["connect timeout"]&&(n.connectTimeoutTimer=setTimeout(function(){if(!n.connected&&(n.connecting=!1,n.options["try multiple transports"])){for(var e=n.transports;e.length>0&&e.splice(0,1)[0]!=n.transport.name;);e.length?s(e):n.publish("connect_failed")}},n.options["connect timeout"]))}):n.publish("connect_failed")}n.sessionid=i,n.closeTimeout=1e3*r,n.heartbeatTimeout=1e3*o,n.transports||(n.transports=n.origTransports=a?t.util.intersect(a.split(","),n.options.transports):n.options.transports),n.setHeartbeatTimeout(),s(n.transports),n.once("connect",function(){clearTimeout(n.connectTimeoutTimer),e&&"function"==typeof e&&e()})}),this},i.prototype.setHeartbeatTimeout=function(){if(clearTimeout(this.heartbeatTimeoutTimer),!this.transport||this.transport.heartbeats()){var e=this;this.heartbeatTimeoutTimer=setTimeout(function(){e.transport.onClose()},this.heartbeatTimeout)}},i.prototype.packet=function(e){return this.connected&&!this.doBuffer?this.transport.packet(e):this.buffer.push(e),this},i.prototype.setBuffer=function(e){this.doBuffer=e,!e&&this.connected&&this.buffer.length&&(this.options.manualFlush||this.flushBuffer())},i.prototype.flushBuffer=function(){this.transport.payload(this.buffer),this.buffer=[]},i.prototype.disconnect=function(){return(this.connected||this.connecting)&&(this.open&&this.of("").packet({type:"disconnect"}),this.onDisconnect("booted")),this},i.prototype.disconnectSync=function(){var e=t.util.request(),n=["http"+(this.options.secure?"s":"")+":/",this.options.host+":"+this.options.port,this.options.resource,t.protocol,"",this.sessionid].join("/")+"/?disconnect=1";e.open("GET",n,!1),e.send(null),this.onDisconnect("booted")},i.prototype.isXDomain=function(){var e=n.location.port||("https:"==n.location.protocol?443:80);return this.options.host!==n.location.hostname||this.options.port!=e},i.prototype.onConnect=function(){this.connected||(this.connected=!0,this.connecting=!1,this.doBuffer||this.setBuffer(!1),this.emit("connect"))},i.prototype.onOpen=function(){this.open=!0},i.prototype.onClose=function(){this.open=!1,clearTimeout(this.heartbeatTimeoutTimer)},i.prototype.onPacket=function(e){this.of(e.endpoint).onPacket(e)},i.prototype.onError=function(e){e&&e.advice&&"reconnect"===e.advice&&(this.connected||this.connecting)&&(this.disconnect(),this.options.reconnect&&this.reconnect()),this.publish("error",e&&e.reason?e.reason:e)},i.prototype.onDisconnect=function(e){var t=this.connected,n=this.connecting;this.connected=!1,this.connecting=!1,this.open=!1,(t||n)&&(this.transport.close(),this.transport.clearTimeouts(),t&&(this.publish("disconnect",e),"booted"!=e&&this.options.reconnect&&!this.reconnecting&&this.reconnect()))},i.prototype.reconnect=function(){function e(){if(n.connected){for(var e in n.namespaces)n.namespaces.hasOwnProperty(e)&&""!==e&&n.namespaces[e].packet({type:"connect"});n.publish("reconnect",n.transport.name,n.reconnectionAttempts)}clearTimeout(n.reconnectionTimer),n.removeListener("connect_failed",t),n.removeListener("connect",t),n.reconnecting=!1,delete n.reconnectionAttempts,delete n.reconnectionDelay,delete n.reconnectionTimer,delete n.redoTransports,n.options["try multiple transports"]=o}function t(){return n.reconnecting?n.connected?e():n.connecting&&n.reconnecting?n.reconnectionTimer=setTimeout(t,1e3):void(n.reconnectionAttempts++>=i?n.redoTransports?(n.publish("reconnect_failed"),e()):(n.on("connect_failed",t),n.options["try multiple transports"]=!0,n.transports=n.origTransports,n.transport=n.getTransport(),n.redoTransports=!0,n.connect()):(n.connect(),n.publish("reconnecting",n.reconnectionDelay,n.reconnectionAttempts),n.reconnectionTimer=setTimeout(t,n.reconnectionDelay))):void 0}this.reconnecting=!0,this.reconnectionAttempts=0,this.reconnectionDelay=this.options["reconnection delay"];var n=this,i=this.options["max reconnection attempts"],o=this.options["try multiple transports"];this.options["reconnection limit"];this.options["try multiple transports"]=!1,this.reconnectionTimer=setTimeout(t,this.reconnectionDelay),this.on("connect",t)}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),function(e,t){function n(e,t){this.socket=e,this.name=t||"",this.flags={},this.json=new i(this,"json"),this.ackPackets=0,this.acks={}}function i(e,t){this.namespace=e,this.name=t}e.SocketNamespace=n,t.util.mixin(n,t.EventEmitter),n.prototype.$emit=t.EventEmitter.prototype.emit,n.prototype.of=function(){return this.socket.of.apply(this.socket,arguments)},n.prototype.packet=function(e){return e.endpoint=this.name,this.socket.packet(e),this.flags={},this},n.prototype.send=function(e,t){var n={type:this.flags.json?"json":"message",data:e};return"function"==typeof t&&(n.id=++this.ackPackets,n.ack=!0,this.acks[n.id]=t),this.packet(n)},n.prototype.emit=function(e){var t=Array.prototype.slice.call(arguments,1),n=t[t.length-1],i={type:"event",name:e};return"function"==typeof n&&(i.id=++this.ackPackets,i.ack="data",this.acks[i.id]=n,t=t.slice(0,t.length-1)),i.args=t,this.packet(i)},n.prototype.disconnect=function(){return""===this.name?this.socket.disconnect():(this.packet({type:"disconnect"}),this.$emit("disconnect")),this},n.prototype.onPacket=function(e){function n(){i.packet({type:"ack",args:t.util.toArray(arguments),ackId:e.id})}var i=this;switch(e.type){case"connect":this.$emit("connect");break;case"disconnect":""===this.name?this.socket.onDisconnect(e.reason||"booted"):this.$emit("disconnect",e.reason);break;case"message":case"json":var o=["message",e.data];"data"==e.ack?o.push(n):e.ack&&this.packet({type:"ack",ackId:e.id}),this.$emit.apply(this,o);break;case"event":var o=[e.name].concat(e.args);"data"==e.ack&&o.push(n),this.$emit.apply(this,o);break;case"ack":this.acks[e.ackId]&&(this.acks[e.ackId].apply(this,e.args),delete this.acks[e.ackId]);break;case"error":e.advice?this.socket.onError(e):"unauthorized"==e.reason?this.$emit("connect_failed",e.reason):this.$emit("error",e.reason)}},i.prototype.send=function(){this.namespace.flags[this.name]=!0,this.namespace.send.apply(this.namespace,arguments)},i.prototype.emit=function(){this.namespace.flags[this.name]=!0,this.namespace.emit.apply(this.namespace,arguments)}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(e,t,n){function i(e){t.Transport.apply(this,arguments)}e.websocket=i,t.util.inherit(i,t.Transport),i.prototype.name="websocket",i.prototype.open=function(){var e,i=t.util.query(this.socket.options.query),o=this;return e||(e=n.MozWebSocket||n.WebSocket),this.websocket=new e(this.prepareUrl()+i),this.websocket.onopen=function(){o.onOpen(),o.socket.setBuffer(!1)},this.websocket.onmessage=function(e){o.onData(e.data)},this.websocket.onclose=function(){o.onClose(),o.socket.setBuffer(!0)},this.websocket.onerror=function(e){o.onError(e)},this},t.util.ua.iDevice?i.prototype.send=function(e){var t=this;return setTimeout(function(){t.websocket.send(e)},0),this}:i.prototype.send=function(e){return this.websocket.send(e),this},i.prototype.payload=function(e){for(var t=0,n=e.length;n>t;t++)this.packet(e[t]);return this},i.prototype.close=function(){return this.websocket.close(),this},i.prototype.onError=function(e){this.socket.onError(e)},i.prototype.scheme=function(){return this.socket.options.secure?"wss":"ws"},i.check=function(){return"WebSocket"in n&&!("__addTask"in WebSocket)||"MozWebSocket"in n},i.xdomainCheck=function(){return!0},t.transports.push("websocket")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),function(e,t){function n(){t.Transport.websocket.apply(this,arguments)}e.flashsocket=n,t.util.inherit(n,t.Transport.websocket),n.prototype.name="flashsocket",n.prototype.open=function(){var e=this,n=arguments;return WebSocket.__addTask(function(){t.Transport.websocket.prototype.open.apply(e,n)}),this},n.prototype.send=function(){var e=this,n=arguments;return WebSocket.__addTask(function(){t.Transport.websocket.prototype.send.apply(e,n)}),this},n.prototype.close=function(){return WebSocket.__tasks.length=0,t.Transport.websocket.prototype.close.call(this),this},n.prototype.ready=function(e,i){function o(){var t=e.options,o=t["flash policy port"],a=["http"+(t.secure?"s":"")+":/",t.host+":"+t.port,t.resource,"static/flashsocket","WebSocketMain"+(e.isXDomain()?"Insecure":"")+".swf"];n.loaded||("undefined"==typeof WEB_SOCKET_SWF_LOCATION&&(WEB_SOCKET_SWF_LOCATION=a.join("/")),843!==o&&WebSocket.loadFlashPolicyFile("xmlsocket://"+t.host+":"+o),WebSocket.__initialize(),n.loaded=!0),i.call(r)}var r=this;return document.body?o():void t.util.load(o)},n.check=function(){return"undefined"!=typeof WebSocket&&"__initialize"in WebSocket&&swfobject?swfobject.getFlashPlayerVersion().major>=10:!1},n.xdomainCheck=function(){return!0},"undefined"!=typeof window&&(WEB_SOCKET_DISABLE_AUTO_INITIALIZATION=!0),t.transports.push("flashsocket")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports),"undefined"!=typeof window)var swfobject=function(){function e(){if(!V){try{var e=R.getElementsByTagName("body")[0].appendChild(m("span"));e.parentNode.removeChild(e)}catch(t){return}V=!0;for(var n=D.length,i=0;n>i;i++)D[i]()}}function t(e){V?e():D[D.length]=e}function n(e){if(typeof B.addEventListener!=S)B.addEventListener("load",e,!1);else if(typeof R.addEventListener!=S)R.addEventListener("load",e,!1);else if(typeof B.attachEvent!=S)v(B,"onload",e);else if("function"==typeof B.onload){var t=B.onload;B.onload=function(){t(),e()}}else B.onload=e}function i(){N?o():r()}function o(){var e=R.getElementsByTagName("body")[0],t=m(j);t.setAttribute("type",O);var n=e.appendChild(t);if(n){var i=0;!function(){if(typeof n.GetVariable!=S){var o=n.GetVariable("$version");o&&(o=o.split(" ")[1].split(","),W.pv=[parseInt(o[0],10),parseInt(o[1],10),parseInt(o[2],10)])}else if(10>i)return i++,void setTimeout(arguments.callee,10);e.removeChild(t),n=null,r()}()}else r()}function r(){var e=Q.length;if(e>0)for(var t=0;e>t;t++){var n=Q[t].id,i=Q[t].callbackFn,o={success:!1,id:n};if(W.pv[0]>0){var r=g(n);if(r)if(!y(Q[t].swfVersion)||W.wk&&W.wk<312)if(Q[t].expressInstall&&s()){var d={};d.data=Q[t].expressInstall,d.width=r.getAttribute("width")||"0",d.height=r.getAttribute("height")||"0",r.getAttribute("class")&&(d.styleclass=r.getAttribute("class")),r.getAttribute("align")&&(d.align=r.getAttribute("align"));for(var u={},h=r.getElementsByTagName("param"),p=h.length,f=0;p>f;f++)"movie"!=h[f].getAttribute("name").toLowerCase()&&(u[h[f].getAttribute("name")]=h[f].getAttribute("value"));l(d,u,n,i)}else c(r),i&&i(o);else b(n,!0),i&&(o.success=!0,o.ref=a(n),i(o))}else if(b(n,!0),i){var m=a(n);m&&typeof m.SetVariable!=S&&(o.success=!0,o.ref=m),i(o)}}}function a(e){var t=null,n=g(e);if(n&&"OBJECT"==n.nodeName)if(typeof n.SetVariable!=S)t=n;else{var i=n.getElementsByTagName(j)[0];i&&(t=i)}return t}function s(){return!U&&y("6.0.65")&&(W.win||W.mac)&&!(W.wk&&W.wk<312)}function l(e,t,n,i){U=!0,x=i||null,T={success:!1,id:n};var o=g(n);if(o){"OBJECT"==o.nodeName?(k=d(o),F=null):(k=o,F=n),e.id=M,(typeof e.width==S||!/%$/.test(e.width)&&parseInt(e.width,10)<310)&&(e.width="310"),(typeof e.height==S||!/%$/.test(e.height)&&parseInt(e.height,10)<137)&&(e.height="137"),R.title=R.title.slice(0,47)+" - Flash Player Installation";var r=W.ie&&W.win?["Active"].concat("").join("X"):"PlugIn",a="MMredirectURL="+B.location.toString().replace(/&/g,"%26")+"&MMplayerType="+r+"&MMdoctitle="+R.title;if(typeof t.flashvars!=S?t.flashvars+="&"+a:t.flashvars=a,W.ie&&W.win&&4!=o.readyState){var s=m("div");n+="SWFObjectNew",s.setAttribute("id",n),o.parentNode.insertBefore(s,o),o.style.display="none",function(){4==o.readyState?o.parentNode.removeChild(o):setTimeout(arguments.callee,10)}()}u(e,t,n)}}function c(e){if(W.ie&&W.win&&4!=e.readyState){var t=m("div");e.parentNode.insertBefore(t,e),t.parentNode.replaceChild(d(e),t),e.style.display="none",function(){4==e.readyState?e.parentNode.removeChild(e):setTimeout(arguments.callee,10)}()}else e.parentNode.replaceChild(d(e),e)}function d(e){var t=m("div");if(W.win&&W.ie)t.innerHTML=e.innerHTML;else{var n=e.getElementsByTagName(j)[0];if(n){var i=n.childNodes;if(i)for(var o=i.length,r=0;o>r;r++)1==i[r].nodeType&&"PARAM"==i[r].nodeName||8==i[r].nodeType||t.appendChild(i[r].cloneNode(!0))}}return t}function u(e,t,n){var i,o=g(n);if(W.wk&&W.wk<312)return i;if(o)if(typeof e.id==S&&(e.id=n),W.ie&&W.win){var r="";for(var a in e)e[a]!=Object.prototype[a]&&("data"==a.toLowerCase()?t.movie=e[a]:"styleclass"==a.toLowerCase()?r+=' class="'+e[a]+'"':"classid"!=a.toLowerCase()&&(r+=" "+a+'="'+e[a]+'"'));var s="";for(var l in t)t[l]!=Object.prototype[l]&&(s+='<param name="'+l+'" value="'+t[l]+'" />');o.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+r+">"+s+"</object>",H[H.length]=e.id,i=g(e.id)}else{var c=m(j);c.setAttribute("type",O);for(var d in e)e[d]!=Object.prototype[d]&&("styleclass"==d.toLowerCase()?c.setAttribute("class",e[d]):"classid"!=d.toLowerCase()&&c.setAttribute(d,e[d]));for(var u in t)t[u]!=Object.prototype[u]&&"movie"!=u.toLowerCase()&&h(c,u,t[u]);o.parentNode.replaceChild(c,o),i=c}return i}function h(e,t,n){var i=m("param");i.setAttribute("name",t),i.setAttribute("value",n),e.appendChild(i)}function p(e){var t=g(e);t&&"OBJECT"==t.nodeName&&(W.ie&&W.win?(t.style.display="none",function(){4==t.readyState?f(e):setTimeout(arguments.callee,10)}()):t.parentNode.removeChild(t))}function f(e){var t=g(e);if(t){for(var n in t)"function"==typeof t[n]&&(t[n]=null);t.parentNode.removeChild(t)}}function g(e){var t=null;try{t=R.getElementById(e)}catch(n){}return t}function m(e){return R.createElement(e)}function v(e,t,n){e.attachEvent(t,n),G[G.length]=[e,t,n]}function y(e){var t=W.pv,n=e.split(".");return n[0]=parseInt(n[0],10),n[1]=parseInt(n[1],10)||0,n[2]=parseInt(n[2],10)||0,t[0]>n[0]||t[0]==n[0]&&t[1]>n[1]||t[0]==n[0]&&t[1]==n[1]&&t[2]>=n[2]?!0:!1}function w(e,t,n,i){if(!W.ie||!W.mac){var o=R.getElementsByTagName("head")[0];if(o){var r=n&&"string"==typeof n?n:"screen";if(i&&(_=null,E=null),!_||E!=r){var a=m("style");a.setAttribute("type","text/css"),a.setAttribute("media",r),_=o.appendChild(a),W.ie&&W.win&&typeof R.styleSheets!=S&&R.styleSheets.length>0&&(_=R.styleSheets[R.styleSheets.length-1]),E=r}W.ie&&W.win?_&&typeof _.addRule==j&&_.addRule(e,t):_&&typeof R.createTextNode!=S&&_.appendChild(R.createTextNode(e+" {"+t+"}"))}}}function b(e,t){if(z){var n=t?"visible":"hidden";V&&g(e)?g(e).style.visibility=n:w("#"+e,"visibility:"+n)}}function C(e){var t=/[\\\"<>\.;]/,n=null!=t.exec(e);return n&&typeof encodeURIComponent!=S?encodeURIComponent(e):e}var k,F,x,T,_,E,S="undefined",j="object",I="Shockwave Flash",A="ShockwaveFlash.ShockwaveFlash",O="application/x-shockwave-flash",M="SWFObjectExprInst",P="onreadystatechange",B=window,R=document,L=navigator,N=!1,D=[i],Q=[],H=[],G=[],V=!1,U=!1,z=!0,W=function(){var e=typeof R.getElementById!=S&&typeof R.getElementsByTagName!=S&&typeof R.createElement!=S,t=L.userAgent.toLowerCase(),n=L.platform.toLowerCase(),i=n?/win/.test(n):/win/.test(t),o=n?/mac/.test(n):/mac/.test(t),r=/webkit/.test(t)?parseFloat(t.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):!1,a=!1,s=[0,0,0],l=null;if(typeof L.plugins!=S&&typeof L.plugins[I]==j)l=L.plugins[I].description,!l||typeof L.mimeTypes!=S&&L.mimeTypes[O]&&!L.mimeTypes[O].enabledPlugin||(N=!0,a=!1,l=l.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),s[0]=parseInt(l.replace(/^(.*)\..*$/,"$1"),10),s[1]=parseInt(l.replace(/^.*\.(.*)\s.*$/,"$1"),10),s[2]=/[a-zA-Z]/.test(l)?parseInt(l.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0);else if(typeof B[["Active"].concat("Object").join("X")]!=S)try{var c=new(window[["Active"].concat("Object").join("X")])(A);c&&(l=c.GetVariable("$version"),l&&(a=!0,l=l.split(" ")[1].split(","),s=[parseInt(l[0],10),parseInt(l[1],10),parseInt(l[2],10)]))}catch(d){}return{w3:e,pv:s,wk:r,ie:a,win:i,mac:o}}();(function(){W.w3&&((typeof R.readyState!=S&&"complete"==R.readyState||typeof R.readyState==S&&(R.getElementsByTagName("body")[0]||R.body))&&e(),V||(typeof R.addEventListener!=S&&R.addEventListener("DOMContentLoaded",e,!1),W.ie&&W.win&&(R.attachEvent(P,function(){"complete"==R.readyState&&(R.detachEvent(P,arguments.callee),e())}),B==top&&!function(){if(!V){try{R.documentElement.doScroll("left")}catch(t){return void setTimeout(arguments.callee,0)}e()}}()),W.wk&&!function(){return V?void 0:/loaded|complete/.test(R.readyState)?void e():void setTimeout(arguments.callee,0)}(),n(e)))})(),function(){W.ie&&W.win&&window.attachEvent("onunload",function(){for(var e=G.length,t=0;e>t;t++)G[t][0].detachEvent(G[t][1],G[t][2]);for(var n=H.length,i=0;n>i;i++)p(H[i]);for(var o in W)W[o]=null;W=null;for(var r in swfobject)swfobject[r]=null;swfobject=null})}();return{registerObject:function(e,t,n,i){if(W.w3&&e&&t){var o={};o.id=e,o.swfVersion=t,o.expressInstall=n,o.callbackFn=i,Q[Q.length]=o,b(e,!1)}else i&&i({success:!1,id:e})},getObjectById:function(e){return W.w3?a(e):void 0},embedSWF:function(e,n,i,o,r,a,c,d,h,p){var f={success:!1,id:n};W.w3&&!(W.wk&&W.wk<312)&&e&&n&&i&&o&&r?(b(n,!1),t(function(){i+="",o+="";var t={};if(h&&typeof h===j)for(var g in h)t[g]=h[g];t.data=e,t.width=i,t.height=o;var m={};if(d&&typeof d===j)for(var v in d)m[v]=d[v];if(c&&typeof c===j)for(var w in c)typeof m.flashvars!=S?m.flashvars+="&"+w+"="+c[w]:m.flashvars=w+"="+c[w];if(y(r)){var C=u(t,m,n);t.id==n&&b(n,!0),f.success=!0,f.ref=C}else{if(a&&s())return t.data=a,void l(t,m,n,p);b(n,!0)}p&&p(f)})):p&&p(f)},switchOffAutoHideShow:function(){z=!1},ua:W,getFlashPlayerVersion:function(){return{major:W.pv[0],minor:W.pv[1],release:W.pv[2]}},hasFlashPlayerVersion:y,createSWF:function(e,t,n){return W.w3?u(e,t,n):void 0},showExpressInstall:function(e,t,n,i){W.w3&&s()&&l(e,t,n,i)},removeSWF:function(e){W.w3&&p(e)},createCSS:function(e,t,n,i){W.w3&&w(e,t,n,i)},addDomLoadEvent:t,addLoadEvent:n,getQueryParamValue:function(e){var t=R.location.search||R.location.hash;if(t){if(/\?/.test(t)&&(t=t.split("?")[1]),null==e)return C(t);for(var n=t.split("&"),i=0;i<n.length;i++)if(n[i].substring(0,n[i].indexOf("="))==e)return C(n[i].substring(n[i].indexOf("=")+1))}return""},expressInstallCallback:function(){if(U){var e=g(M);e&&k&&(e.parentNode.replaceChild(k,e),F&&(b(F,!0),W.ie&&W.win&&(k.style.display="block")),x&&x(T)),U=!1}}}}();!function(){if("undefined"!=typeof window&&!window.WebSocket){var e=window.console;if(e&&e.log&&e.error||(e={log:function(){},error:function(){}}),!swfobject.hasFlashPlayerVersion("10.0.0"))return void e.error("Flash Player >= 10.0.0 is required.");"file:"==location.protocol&&e.error("WARNING: web-socket-js doesn't work in file:///... URL unless you set Flash Security Settings properly. Open the page via Web server i.e. http://..."),WebSocket=function(e,t,n,i,o){var r=this;r.__id=WebSocket.__nextId++,WebSocket.__instances[r.__id]=r,r.readyState=WebSocket.CONNECTING,r.bufferedAmount=0,r.__events={},t?"string"==typeof t&&(t=[t]):t=[],setTimeout(function(){WebSocket.__addTask(function(){WebSocket.__flash.create(r.__id,e,t,n||null,i||0,o||null)})},0)},WebSocket.prototype.send=function(e){if(this.readyState==WebSocket.CONNECTING)throw"INVALID_STATE_ERR: Web Socket connection has not been established";var t=WebSocket.__flash.send(this.__id,encodeURIComponent(e));return 0>t?!0:(this.bufferedAmount+=t,!1)},WebSocket.prototype.close=function(){this.readyState!=WebSocket.CLOSED&&this.readyState!=WebSocket.CLOSING&&(this.readyState=WebSocket.CLOSING,WebSocket.__flash.close(this.__id))},WebSocket.prototype.addEventListener=function(e,t,n){e in this.__events||(this.__events[e]=[]),this.__events[e].push(t)},WebSocket.prototype.removeEventListener=function(e,t,n){if(e in this.__events)for(var i=this.__events[e],o=i.length-1;o>=0;--o)if(i[o]===t){i.splice(o,1);break}},WebSocket.prototype.dispatchEvent=function(e){for(var t=this.__events[e.type]||[],n=0;n<t.length;++n)t[n](e);var i=this["on"+e.type];i&&i(e)},WebSocket.prototype.__handleEvent=function(e){"readyState"in e&&(this.readyState=e.readyState),"protocol"in e&&(this.protocol=e.protocol);var t;if("open"==e.type||"error"==e.type)t=this.__createSimpleEvent(e.type);else if("close"==e.type)t=this.__createSimpleEvent("close");else{if("message"!=e.type)throw"unknown event type: "+e.type;var n=decodeURIComponent(e.message);t=this.__createMessageEvent("message",n)}this.dispatchEvent(t)},WebSocket.prototype.__createSimpleEvent=function(e){if(document.createEvent&&window.Event){var t=document.createEvent("Event");return t.initEvent(e,!1,!1),t}return{type:e,bubbles:!1,cancelable:!1}},WebSocket.prototype.__createMessageEvent=function(e,t){if(document.createEvent&&window.MessageEvent&&!window.opera){var n=document.createEvent("MessageEvent");return n.initMessageEvent("message",!1,!1,t,null,null,window,null),n}return{type:e,data:t,bubbles:!1,cancelable:!1}},WebSocket.CONNECTING=0,WebSocket.OPEN=1,WebSocket.CLOSING=2,WebSocket.CLOSED=3,WebSocket.__flash=null,WebSocket.__instances={},WebSocket.__tasks=[],WebSocket.__nextId=0,WebSocket.loadFlashPolicyFile=function(e){WebSocket.__addTask(function(){WebSocket.__flash.loadManualPolicyFile(e)})},WebSocket.__initialize=function(){if(!WebSocket.__flash){if(WebSocket.__swfLocation&&(window.WEB_SOCKET_SWF_LOCATION=WebSocket.__swfLocation),!window.WEB_SOCKET_SWF_LOCATION)return void e.error("[WebSocket] set WEB_SOCKET_SWF_LOCATION to location of WebSocketMain.swf");var t=document.createElement("div");t.id="webSocketContainer",t.style.position="absolute",WebSocket.__isFlashLite()?(t.style.left="0px",t.style.top="0px"):(t.style.left="-100px",t.style.top="-100px");var n=document.createElement("div");n.id="webSocketFlash",t.appendChild(n),document.body.appendChild(t),swfobject.embedSWF(WEB_SOCKET_SWF_LOCATION,"webSocketFlash","1","1","10.0.0",null,null,{hasPriority:!0,swliveconnect:!0,allowScriptAccess:"always"},null,function(t){t.success||e.error("[WebSocket] swfobject.embedSWF failed")})}},WebSocket.__onFlashInitialized=function(){setTimeout(function(){WebSocket.__flash=document.getElementById("webSocketFlash"),WebSocket.__flash.setCallerUrl(location.href),WebSocket.__flash.setDebug(!!window.WEB_SOCKET_DEBUG);for(var e=0;e<WebSocket.__tasks.length;++e)WebSocket.__tasks[e]();WebSocket.__tasks=[]},0)},WebSocket.__onFlashEvent=function(){return setTimeout(function(){try{for(var t=WebSocket.__flash.receiveEvents(),n=0;n<t.length;++n)WebSocket.__instances[t[n].webSocketId].__handleEvent(t[n])}catch(i){e.error(i)}},0),!0},WebSocket.__log=function(t){e.log(decodeURIComponent(t))},WebSocket.__error=function(t){e.error(decodeURIComponent(t))},WebSocket.__addTask=function(e){WebSocket.__flash?e():WebSocket.__tasks.push(e)},WebSocket.__isFlashLite=function(){if(!window.navigator||!window.navigator.mimeTypes)return!1;var e=window.navigator.mimeTypes["application/x-shockwave-flash"];return e&&e.enabledPlugin&&e.enabledPlugin.filename&&e.enabledPlugin.filename.match(/flashlite/i)?!0:!1},window.WEB_SOCKET_DISABLE_AUTO_INITIALIZATION||(window.addEventListener?window.addEventListener("load",function(){WebSocket.__initialize()},!1):window.attachEvent("onload",function(){WebSocket.__initialize()}))}}(),function(e,t,n){function i(e){e&&(t.Transport.apply(this,arguments),this.sendBuffer=[])}function o(){}e.XHR=i,t.util.inherit(i,t.Transport),i.prototype.open=function(){return this.socket.setBuffer(!1),this.onOpen(),this.get(),this.setCloseTimeout(),this},i.prototype.payload=function(e){for(var n=[],i=0,o=e.length;o>i;i++)n.push(t.parser.encodePacket(e[i]));this.send(t.parser.encodePayload(n))},i.prototype.send=function(e){return this.post(e),this},i.prototype.post=function(e){function t(){4==this.readyState&&(this.onreadystatechange=o,r.posting=!1,200==this.status?r.socket.setBuffer(!1):r.onClose())}function i(){this.onload=o,r.socket.setBuffer(!1)}var r=this;this.socket.setBuffer(!0),this.sendXHR=this.request("POST"),n.XDomainRequest&&this.sendXHR instanceof XDomainRequest?this.sendXHR.onload=this.sendXHR.onerror=i:this.sendXHR.onreadystatechange=t,this.sendXHR.send(e)},i.prototype.close=function(){return this.onClose(),this},i.prototype.request=function(e){var n=t.util.request(this.socket.isXDomain()),i=t.util.query(this.socket.options.query,"t="+ +new Date);if(n.open(e||"GET",this.prepareUrl()+i,!0),"POST"==e)try{n.setRequestHeader?n.setRequestHeader("Content-type","text/plain;charset=UTF-8"):n.contentType="text/plain"}catch(o){}return n},i.prototype.scheme=function(){return this.socket.options.secure?"https":"http"},i.check=function(e,i){try{var o=t.util.request(i),r=n.XDomainRequest&&o instanceof XDomainRequest,a=e&&e.options&&e.options.secure?"https:":"http:",s=n.location&&a!=n.location.protocol;if(o&&(!r||!s))return!0}catch(l){}return!1},i.xdomainCheck=function(e){return i.check(e,!0)}}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),function(e,t){function n(e){t.Transport.XHR.apply(this,arguments)}e.htmlfile=n,t.util.inherit(n,t.Transport.XHR),n.prototype.name="htmlfile",n.prototype.get=function(){this.doc=new(window[["Active"].concat("Object").join("X")])("htmlfile"),this.doc.open(),this.doc.write("<html></html>"),this.doc.close(),this.doc.parentWindow.s=this;var e=this.doc.createElement("div");e.className="socketio",this.doc.body.appendChild(e),this.iframe=this.doc.createElement("iframe"),e.appendChild(this.iframe);var n=this,i=t.util.query(this.socket.options.query,"t="+ +new Date);this.iframe.src=this.prepareUrl()+i,t.util.on(window,"unload",function(){n.destroy()})},n.prototype._=function(e,t){e=e.replace(/\\\//g,"/"),this.onData(e);try{var n=t.getElementsByTagName("script")[0];n.parentNode.removeChild(n)}catch(i){}},n.prototype.destroy=function(){if(this.iframe){try{this.iframe.src="about:blank"}catch(e){}this.doc=null,this.iframe.parentNode.removeChild(this.iframe),this.iframe=null,CollectGarbage()}},n.prototype.close=function(){return this.destroy(),t.Transport.XHR.prototype.close.call(this)},n.check=function(e){if("undefined"!=typeof window&&["Active"].concat("Object").join("X")in window)try{var n=new(window[["Active"].concat("Object").join("X")])("htmlfile");return n&&t.Transport.XHR.check(e)}catch(i){}return!1},n.xdomainCheck=function(){return!1},t.transports.push("htmlfile")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(e,t,n){function i(){t.Transport.XHR.apply(this,arguments)}function o(){}e["xhr-polling"]=i,t.util.inherit(i,t.Transport.XHR),t.util.merge(i,t.Transport.XHR),i.prototype.name="xhr-polling",i.prototype.heartbeats=function(){return!1},i.prototype.open=function(){var e=this;return t.Transport.XHR.prototype.open.call(e),!1},i.prototype.get=function(){function e(){4==this.readyState&&(this.onreadystatechange=o,200==this.status?(r.onData(this.responseText),r.get()):r.onClose())}function t(){this.onload=o,this.onerror=o,r.retryCounter=1,r.onData(this.responseText),r.get()}function i(){r.retryCounter++,!r.retryCounter||r.retryCounter>3?r.onClose():r.get()}if(this.isOpen){var r=this;this.xhr=this.request(),n.XDomainRequest&&this.xhr instanceof XDomainRequest?(this.xhr.onload=t,this.xhr.onerror=i):this.xhr.onreadystatechange=e,this.xhr.send(null)}},i.prototype.onClose=function(){if(t.Transport.XHR.prototype.onClose.call(this),this.xhr){this.xhr.onreadystatechange=this.xhr.onload=this.xhr.onerror=o;try{this.xhr.abort()}catch(e){}this.xhr=null}},i.prototype.ready=function(e,n){var i=this;t.util.defer(function(){n.call(i)})},t.transports.push("xhr-polling")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),function(e,t,n){function i(e){t.Transport["xhr-polling"].apply(this,arguments),this.index=t.j.length;var n=this;t.j.push(function(e){n._(e)})}var o=n.document&&"MozAppearance"in n.document.documentElement.style;e["jsonp-polling"]=i,t.util.inherit(i,t.Transport["xhr-polling"]),i.prototype.name="jsonp-polling",i.prototype.post=function(e){function n(){i(),o.socket.setBuffer(!1)}function i(){o.iframe&&o.form.removeChild(o.iframe);try{a=document.createElement('<iframe name="'+o.iframeId+'">')}catch(e){a=document.createElement("iframe"),a.name=o.iframeId}a.id=o.iframeId,o.form.appendChild(a),o.iframe=a}var o=this,r=t.util.query(this.socket.options.query,"t="+ +new Date+"&i="+this.index);if(!this.form){var a,s=document.createElement("form"),l=document.createElement("textarea"),c=this.iframeId="socketio_iframe_"+this.index;s.className="socketio",s.style.position="absolute",s.style.top="0px",s.style.left="0px",s.style.display="none",s.target=c,s.method="POST",s.setAttribute("accept-charset","utf-8"),l.name="d",s.appendChild(l),document.body.appendChild(s),this.form=s,this.area=l}this.form.action=this.prepareUrl()+r,i(),this.area.value=t.JSON.stringify(e);try{this.form.submit()}catch(d){}this.iframe.attachEvent?a.onreadystatechange=function(){"complete"==o.iframe.readyState&&n()}:this.iframe.onload=n,this.socket.setBuffer(!0)},i.prototype.get=function(){var e=this,n=document.createElement("script"),i=t.util.query(this.socket.options.query,"t="+ +new Date+"&i="+this.index);this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),n.async=!0,n.src=this.prepareUrl()+i,n.onerror=function(){e.onClose()};var r=document.getElementsByTagName("script")[0];r.parentNode.insertBefore(n,r),this.script=n,o&&setTimeout(function(){var e=document.createElement("iframe");
document.body.appendChild(e),document.body.removeChild(e)},100)},i.prototype._=function(e){return this.onData(e),this.isOpen&&this.get(),this},i.prototype.ready=function(e,n){var i=this;return o?void t.util.load(function(){n.call(i)}):n.call(this)},i.check=function(){return"document"in n},i.xdomainCheck=function(){return!0},t.transports.push("jsonp-polling")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),"function"==typeof define&&define.amd&&define([],function(){return io})}(),function(e,t){"use strict";function n(n,i){function o(e){return pe.preferFlash&&re&&!pe.ignoreFlash&&pe.flash[e]!==t&&pe.flash[e]}function r(e){return function(t){var n,i=this._s;return n=i&&i._a?e.call(this,t):null}}this.setupOptions={url:n||null,flashVersion:8,debugMode:!0,debugFlash:!1,useConsole:!0,consoleOnly:!0,waitForWindowLoad:!1,bgColor:"#ffffff",useHighPerformance:!1,flashPollingInterval:null,html5PollingInterval:null,flashLoadTimeout:1e3,wmode:null,allowScriptAccess:"always",useFlashBlock:!1,useHTML5Audio:!0,forceUseGlobalHTML5Audio:!1,ignoreMobileRestrictions:!1,html5Test:/^(probably|maybe)$/i,preferFlash:!1,noSWFCache:!1,idPrefix:"sound"},this.defaultOptions={autoLoad:!1,autoPlay:!1,from:null,loops:1,onid3:null,onload:null,whileloading:null,onplay:null,onpause:null,onresume:null,whileplaying:null,onposition:null,onstop:null,onfailure:null,onfinish:null,multiShot:!0,multiShotEvents:!1,position:null,pan:0,stream:!0,to:null,type:null,usePolicyFile:!1,volume:100},this.flash9Options={isMovieStar:null,usePeakData:!1,useWaveformData:!1,useEQData:!1,onbufferchange:null,ondataerror:null},this.movieStarOptions={bufferTime:3,serverURL:null,onconnect:null,duration:null},this.audioFormats={mp3:{type:['audio/mpeg; codecs="mp3"',"audio/mpeg","audio/mp3","audio/MPA","audio/mpa-robust"],required:!0},mp4:{related:["aac","m4a","m4b"],type:['audio/mp4; codecs="mp4a.40.2"',"audio/aac","audio/x-m4a","audio/MP4A-LATM","audio/mpeg4-generic"],required:!1},ogg:{type:["audio/ogg; codecs=vorbis"],required:!1},opus:{type:["audio/ogg; codecs=opus","audio/opus"],required:!1},wav:{type:['audio/wav; codecs="1"',"audio/wav","audio/wave","audio/x-wav"],required:!1}},this.movieID="sm2-container",this.id=i||"sm2movie",this.debugID="soundmanager-debug",this.debugURLParam=/([#?&])debug=1/i,this.versionNumber="V2.97a.20150601",this.version=null,this.movieURL=null,this.altURL=null,this.swfLoaded=!1,this.enabled=!1,this.oMC=null,this.sounds={},this.soundIDs=[],this.muted=!1,this.didFlashBlock=!1,this.filePattern=null,this.filePatterns={flash8:/\.mp3(\?.*)?$/i,flash9:/\.mp3(\?.*)?$/i},this.features={buffering:!1,peakData:!1,waveformData:!1,eqData:!1,movieStar:!1},this.sandbox={},this.html5={usingFlash:null},this.flash={},this.html5Only=!1,this.ignoreFlash=!1;var a,s,l,c,d,u,h,p,f,g,m,v,y,w,b,C,k,F,x,T,_,E,S,j,I,A,O,M,P,B,R,L,N,D,Q,H,G,V,U,z,W,$,q,K,Y,J,X,Z,ee,te,ne,ie,oe,re,ae,se,le,ce,de,ue,he,pe=this,fe=null,ge=null,me=navigator.userAgent,ve=e.location.href.toString(),ye=document,we=[],be=!1,Ce=!1,ke=!1,Fe=!1,xe=!1,Te=8,_e=null,Ee=null,Se=!1,je=!1,Ie=0,Ae=null,Oe=[],Me=null,Pe=Array.prototype.slice,Be=!1,Re=0,Le=1e3,Ne=me.match(/(ipad|iphone|ipod)/i),De=me.match(/android/i),Qe=me.match(/msie/i),He=me.match(/webkit/i),Ge=me.match(/safari/i)&&!me.match(/chrome/i),Ve=me.match(/opera/i),Ue=me.match(/(mobile|pre\/|xoom)/i)||Ne||De,ze=!ve.match(/usehtml5audio/i)&&!ve.match(/sm2\-ignorebadua/i)&&Ge&&!me.match(/silk/i)&&me.match(/OS X 10_6_([3-7])/i),We=(e.console!==t&&console.log!==t,ye.hasFocus!==t?ye.hasFocus():null),$e=Ge&&(ye.hasFocus===t||!ye.hasFocus()),qe=!$e,Ke=/(mp3|mp4|mpa|m4a|m4b)/i,Ye="about:blank",Je="data:audio/wave;base64,/UklGRiYAAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQIAAAD//w==",Xe=ye.location?ye.location.protocol.match(/http/i):null,Ze=Xe?"":"http://",et=/^\s*audio\/(?:x-)?(?:mpeg4|aac|flv|mov|mp4||m4v|m4a|m4b|mp4v|3gp|3g2)\s*(?:$|;)/i,tt=["mpeg4","aac","flv","mov","mp4","m4v","f4v","m4a","m4b","mp4v","3gp","3g2"],nt=new RegExp("\\.("+tt.join("|")+")(\\?.*)?$","i");this.mimePattern=/^\s*audio\/(?:x-)?(?:mp(?:eg|3))\s*(?:$|;)/i,this.useAltURL=!Xe,Q={swfBox:"sm2-object-box",swfDefault:"movieContainer",swfError:"swf_error",swfTimedout:"swf_timedout",swfLoaded:"swf_loaded",swfUnblocked:"swf_unblocked",sm2Debug:"sm2_debug",highPerf:"high_performance",flashDebug:"flash_debug"},this.hasHTML5=function(){try{return Audio!==t&&(Ve&&opera!==t&&opera.version()<10?new Audio(null):new Audio).canPlayType!==t}catch(e){return!1}}(),this.setup=function(e){var n=!pe.url;return e!==t&&ke&&Me&&pe.ok()&&(e.flashVersion!==t||e.url!==t||e.html5Test!==t),f(e),Be||(Ue?(!pe.setupOptions.ignoreMobileRestrictions||pe.setupOptions.forceUseGlobalHTML5Audio)&&(Oe.push(x.globalHTML5),Be=!0):pe.setupOptions.forceUseGlobalHTML5Audio&&(Oe.push(x.globalHTML5),Be=!0)),!he&&Ue&&(pe.setupOptions.ignoreMobileRestrictions?Oe.push(x.ignoreMobile):(pe.setupOptions.useHTML5Audio=!0,pe.setupOptions.preferFlash=!1,Ne?pe.ignoreFlash=!0:(De&&!me.match(/android\s2\.3/i)||!De)&&(Be=!0))),e&&(n&&S&&e.url!==t&&pe.beginDelayedInit(),S||e.url===t||"complete"!==ye.readyState||setTimeout(_,1)),he=!0,pe},this.ok=function(){return Me?ke&&!Fe:pe.useHTML5Audio&&pe.hasHTML5},this.supported=this.ok,this.getMovie=function(t){return s(t)||ye[t]||e[t]},this.createSound=function(e,n){function i(){return r=H(r),pe.sounds[r.id]=new a(r),pe.soundIDs.push(r.id),pe.sounds[r.id]}var o,r,s=null;if(!ke||!pe.ok())return!1;if(n!==t&&(e={id:e,url:n}),r=p(e),r.url=q(r.url),r.id===t&&(r.id=pe.setupOptions.idPrefix+Re++),U(r.id,!0))return pe.sounds[r.id];if(J(r))s=i(),s._setup_html5(r);else{if(pe.html5Only)return i();if(pe.html5.usingFlash&&r.url&&r.url.match(/data\:/i))return i();u>8&&null===r.isMovieStar&&(r.isMovieStar=!!(r.serverURL||(r.type?r.type.match(et):!1)||r.url&&r.url.match(nt))),r=G(r,o),s=i(),8===u?ge._createSound(r.id,r.loops||1,r.usePolicyFile):(ge._createSound(r.id,r.url,r.usePeakData,r.useWaveformData,r.useEQData,r.isMovieStar,r.isMovieStar?r.bufferTime:!1,r.loops||1,r.serverURL,r.duration||null,r.autoPlay,!0,r.autoLoad,r.usePolicyFile),r.serverURL||(s.connected=!0,r.onconnect&&r.onconnect.apply(s))),r.serverURL||!r.autoLoad&&!r.autoPlay||s.load(r)}return!r.serverURL&&r.autoPlay&&s.play(),s},this.destroySound=function(e,t){if(!U(e))return!1;var n,i=pe.sounds[e];for(i.stop(),i._iO={},i.unload(),n=0;n<pe.soundIDs.length;n++)if(pe.soundIDs[n]===e){pe.soundIDs.splice(n,1);break}return t||i.destruct(!0),i=null,delete pe.sounds[e],!0},this.load=function(e,t){return U(e)?pe.sounds[e].load(t):!1},this.unload=function(e){return U(e)?pe.sounds[e].unload():!1},this.onPosition=function(e,t,n,i){return U(e)?pe.sounds[e].onposition(t,n,i):!1},this.onposition=this.onPosition,this.clearOnPosition=function(e,t,n){return U(e)?pe.sounds[e].clearOnPosition(t,n):!1},this.play=function(e,t){var n=null,i=t&&!(t instanceof Object);if(!ke||!pe.ok())return!1;if(U(e,i))i&&(t={url:t});else{if(!i)return!1;i&&(t={url:t}),t&&t.url&&(t.id=e,n=pe.createSound(t).play())}return null===n&&(n=pe.sounds[e].play(t)),n},this.start=this.play,this.setPosition=function(e,t){return U(e)?pe.sounds[e].setPosition(t):!1},this.stop=function(e){return U(e)?pe.sounds[e].stop():!1},this.stopAll=function(){var e;for(e in pe.sounds)pe.sounds.hasOwnProperty(e)&&pe.sounds[e].stop()},this.pause=function(e){return U(e)?pe.sounds[e].pause():!1},this.pauseAll=function(){var e;for(e=pe.soundIDs.length-1;e>=0;e--)pe.sounds[pe.soundIDs[e]].pause()},this.resume=function(e){return U(e)?pe.sounds[e].resume():!1},this.resumeAll=function(){var e;for(e=pe.soundIDs.length-1;e>=0;e--)pe.sounds[pe.soundIDs[e]].resume()},this.togglePause=function(e){return U(e)?pe.sounds[e].togglePause():!1},this.setPan=function(e,t){return U(e)?pe.sounds[e].setPan(t):!1},this.setVolume=function(e,n){var i,o;{if(e===t||isNaN(e)||n!==t)return U(e)?pe.sounds[e].setVolume(n):!1;for(i=0,o=pe.soundIDs.length;o>i;i++)pe.sounds[pe.soundIDs[i]].setVolume(e)}},this.mute=function(e){var t=0;if(e instanceof String&&(e=null),e)return U(e)?pe.sounds[e].mute():!1;for(t=pe.soundIDs.length-1;t>=0;t--)pe.sounds[pe.soundIDs[t]].mute();return pe.muted=!0,!0},this.muteAll=function(){pe.mute()},this.unmute=function(e){var t;if(e instanceof String&&(e=null),e)return U(e)?pe.sounds[e].unmute():!1;for(t=pe.soundIDs.length-1;t>=0;t--)pe.sounds[pe.soundIDs[t]].unmute();return pe.muted=!1,!0},this.unmuteAll=function(){pe.unmute()},this.toggleMute=function(e){return U(e)?pe.sounds[e].toggleMute():!1},this.getMemoryUse=function(){var e=0;return ge&&8!==u&&(e=parseInt(ge._getMemoryUse(),10)),e},this.disable=function(n){var i;if(n===t&&(n=!1),Fe)return!1;for(Fe=!0,i=pe.soundIDs.length-1;i>=0;i--)P(pe.sounds[pe.soundIDs[i]]);return h(n),ie.remove(e,"load",y),!0},this.canPlayMIME=function(e){var t;return pe.hasHTML5&&(t=X({type:e})),!t&&Me&&(t=e&&pe.ok()?!!((u>8?e.match(et):null)||e.match(pe.mimePattern)):null),t},this.canPlayURL=function(e){var t;return pe.hasHTML5&&(t=X({url:e})),!t&&Me&&(t=e&&pe.ok()?!!e.match(pe.filePattern):null),t},this.canPlayLink=function(e){return e.type!==t&&e.type&&pe.canPlayMIME(e.type)?!0:pe.canPlayURL(e.href)},this.getSoundById=function(e,t){if(!e)return null;var n=pe.sounds[e];return n},this.onready=function(t,n){var i="onready",o=!1;if("function"!=typeof t)throw L("needFunction",i);return n||(n=e),m(i,t,n),v(),o=!0,o},this.ontimeout=function(t,n){var i="ontimeout",o=!1;if("function"!=typeof t)throw L("needFunction",i);return n||(n=e),m(i,t,n),v({type:i}),o=!0,o},this._writeDebug=function(e,t){return!0},this._wD=this._writeDebug,this._debug=function(){},this.reboot=function(t,n){var i,o,r;for(i=pe.soundIDs.length-1;i>=0;i--)pe.sounds[pe.soundIDs[i]].destruct();if(ge)try{Qe&&(Ee=ge.innerHTML),_e=ge.parentNode.removeChild(ge)}catch(a){}if(Ee=_e=Me=ge=null,pe.enabled=S=ke=Se=je=be=Ce=Fe=Be=pe.swfLoaded=!1,pe.soundIDs=[],pe.sounds={},Re=0,he=!1,t)we=[];else for(i in we)if(we.hasOwnProperty(i))for(o=0,r=we[i].length;r>o;o++)we[i][o].fired=!1;return pe.html5={usingFlash:null},pe.flash={},pe.html5Only=!1,pe.ignoreFlash=!1,e.setTimeout(function(){n||pe.beginDelayedInit()},20),pe},this.reset=function(){return pe.reboot(!0,!0)},this.getMoviePercent=function(){return ge&&"PercentLoaded"in ge?ge.PercentLoaded():null},this.beginDelayedInit=function(){xe=!0,_(),setTimeout(function(){return je?!1:(I(),T(),je=!0,!0)},20),w()},this.destruct=function(){pe.disable(!0)},a=function(e){var n,i,o,r,a,s,l,c,d,h,f=this,g=!1,m=[],v=0,y=null;d={duration:null,time:null},this.id=e.id,this.sID=this.id,this.url=e.url,this.options=p(e),this.instanceOptions=this.options,this._iO=this.instanceOptions,this.pan=this.options.pan,this.volume=this.options.volume,this.isHTML5=!1,this._a=null,h=this.url?!1:!0,this.id3={},this._debug=function(){},this.load=function(e){var n,i=null;if(e!==t?f._iO=p(e,f.options):(e=f.options,f._iO=e,y&&y!==f.url&&(f._iO.url=f.url,f.url=null)),f._iO.url||(f._iO.url=f.url),f._iO.url=q(f._iO.url),f.instanceOptions=f._iO,n=f._iO,!n.url&&!f.url)return f;if(n.url===f.url&&0!==f.readyState&&2!==f.readyState)return 3===f.readyState&&n.onload&&ue(f,function(){n.onload.apply(f,[!!f.duration])}),f;if(f.loaded=!1,f.readyState=1,f.playState=0,f.id3={},J(n))i=f._setup_html5(n),i._called_load||(f._html5_canplay=!1,f.url!==n.url&&(f._a.src=n.url,f.setPosition(0)),f._a.autobuffer="auto",f._a.preload="auto",f._a._called_load=!0);else{if(pe.html5Only)return f;if(f._iO.url&&f._iO.url.match(/data\:/i))return f;try{f.isHTML5=!1,f._iO=G(H(n)),f._iO.autoPlay&&(f._iO.position||f._iO.from)&&(f._iO.autoPlay=!1),n=f._iO,8===u?ge._load(f.id,n.url,n.stream,n.autoPlay,n.usePolicyFile):ge._load(f.id,n.url,!!n.stream,!!n.autoPlay,n.loops||1,!!n.autoLoad,n.usePolicyFile)}catch(o){A({type:"SMSOUND_LOAD_JS_EXCEPTION",fatal:!0})}}return f.url=n.url,f},this.unload=function(){return 0!==f.readyState&&(f.isHTML5?(r(),f._a&&(f._a.pause(),y=ee(f._a))):8===u?ge._unload(f.id,Ye):ge._unload(f.id),n()),f},this.destruct=function(e){f.isHTML5?(r(),f._a&&(f._a.pause(),ee(f._a),Be||o(),f._a._s=null,f._a=null)):(f._iO.onfailure=null,ge._destroySound(f.id)),e||pe.destroySound(f.id,!0)},this.play=function(e,n){var i,o,r,l,d,m,v=!0,y=null;if(n=n===t?!0:n,e||(e={}),f.url&&(f._iO.url=f.url),f._iO=p(f._iO,f.options),f._iO=p(e,f._iO),f._iO.url=q(f._iO.url),f.instanceOptions=f._iO,!f.isHTML5&&f._iO.serverURL&&!f.connected)return f.getAutoPlay()||f.setAutoPlay(!0),f;if(J(f._iO)&&(f._setup_html5(f._iO),a()),1!==f.playState||f.paused||(i=f._iO.multiShot,i||(f.isHTML5&&f.setPosition(f._iO.position),y=f)),null!==y)return y;if(e.url&&e.url!==f.url&&(f.readyState||f.isHTML5||8!==u||!h?f.load(f._iO):h=!1),f.loaded||(0===f.readyState?(f.isHTML5||pe.html5Only?f.isHTML5?f.load(f._iO):y=f:(f._iO.autoPlay=!0,f.load(f._iO)),f.instanceOptions=f._iO):2===f.readyState&&(y=f)),null!==y)return y;if(!f.isHTML5&&9===u&&f.position>0&&f.position===f.duration&&(e.position=0),f.paused&&f.position>=0&&(!f._iO.serverURL||f.position>0))f.resume();else{if(f._iO=p(e,f._iO),(!f.isHTML5&&null!==f._iO.position&&f._iO.position>0||null!==f._iO.from&&f._iO.from>0||null!==f._iO.to)&&0===f.instanceCount&&0===f.playState&&!f._iO.serverURL){if(r=function(){f._iO=p(e,f._iO),f.play(f._iO)},f.isHTML5&&!f._html5_canplay?(f.load({_oncanplay:r}),y=!1):f.isHTML5||f.loaded||f.readyState&&2===f.readyState||(f.load({onload:r}),y=!1),null!==y)return y;f._iO=c()}(!f.instanceCount||f._iO.multiShotEvents||f.isHTML5&&f._iO.multiShot&&!Be||!f.isHTML5&&u>8&&!f.getAutoPlay())&&f.instanceCount++,f._iO.onposition&&0===f.playState&&s(f),f.playState=1,f.paused=!1,f.position=f._iO.position===t||isNaN(f._iO.position)?0:f._iO.position,f.isHTML5||(f._iO=G(H(f._iO))),f._iO.onplay&&n&&(f._iO.onplay.apply(f),g=!0),f.setVolume(f._iO.volume,!0),f.setPan(f._iO.pan,!0),f.isHTML5?f.instanceCount<2?(a(),o=f._setup_html5(),f.setPosition(f._iO.position),o.play()):(l=new Audio(f._iO.url),d=function(){ie.remove(l,"ended",d),f._onfinish(f),ee(l),l=null},m=function(){ie.remove(l,"canplay",m);try{l.currentTime=f._iO.position/Le}catch(e){}l.play()},ie.add(l,"ended",d),f._iO.volume!==t&&(l.volume=Math.max(0,Math.min(1,f._iO.volume/100))),f.muted&&(l.muted=!0),f._iO.position?ie.add(l,"canplay",m):l.play()):(v=ge._start(f.id,f._iO.loops||1,9===u?f.position:f.position/Le,f._iO.multiShot||!1),9!==u||v||f._iO.onplayerror&&f._iO.onplayerror.apply(f))}return f},this.start=this.play,this.stop=function(e){var t,n=f._iO;return 1===f.playState&&(f._onbufferchange(0),f._resetOnPosition(0),f.paused=!1,f.isHTML5||(f.playState=0),l(),n.to&&f.clearOnPosition(n.to),f.isHTML5?f._a&&(t=f.position,f.setPosition(0),f.position=t,f._a.pause(),f.playState=0,f._onTimer(),r()):(ge._stop(f.id,e),n.serverURL&&f.unload()),f.instanceCount=0,f._iO={},n.onstop&&n.onstop.apply(f)),f},this.setAutoPlay=function(e){f._iO.autoPlay=e,f.isHTML5||(ge._setAutoPlay(f.id,e),e&&(f.instanceCount||1!==f.readyState||f.instanceCount++))},this.getAutoPlay=function(){return f._iO.autoPlay},this.setPosition=function(e){e===t&&(e=0);var n,i,o=f.isHTML5?Math.max(e,0):Math.min(f.duration||f._iO.duration,Math.max(e,0));if(f.position=o,i=f.position/Le,f._resetOnPosition(f.position),f._iO.position=o,f.isHTML5){if(f._a){if(f._html5_canplay){if(f._a.currentTime!==i)try{f._a.currentTime=i,(0===f.playState||f.paused)&&f._a.pause()}catch(r){}}else if(i)return f;f.paused&&f._onTimer(!0)}}else n=9===u?f.position:i,f.readyState&&2!==f.readyState&&ge._setPosition(f.id,n,f.paused||!f.playState,f._iO.multiShot);return f},this.pause=function(e){return f.paused||0===f.playState&&1!==f.readyState?f:(f.paused=!0,f.isHTML5?(f._setup_html5().pause(),r()):(e||e===t)&&ge._pause(f.id,f._iO.multiShot),f._iO.onpause&&f._iO.onpause.apply(f),f)},this.resume=function(){var e=f._iO;return f.paused?(f.paused=!1,f.playState=1,f.isHTML5?(f._setup_html5().play(),a()):(e.isMovieStar&&!e.serverURL&&f.setPosition(f.position),ge._pause(f.id,e.multiShot)),!g&&e.onplay?(e.onplay.apply(f),g=!0):e.onresume&&e.onresume.apply(f),f):f},this.togglePause=function(){return 0===f.playState?(f.play({position:9!==u||f.isHTML5?f.position/Le:f.position}),f):(f.paused?f.resume():f.pause(),f)},this.setPan=function(e,n){return e===t&&(e=0),n===t&&(n=!1),f.isHTML5||ge._setPan(f.id,e),f._iO.pan=e,n||(f.pan=e,f.options.pan=e),f},this.setVolume=function(e,n){return e===t&&(e=100),n===t&&(n=!1),f.isHTML5?f._a&&(pe.muted&&!f.muted&&(f.muted=!0,f._a.muted=!0),f._a.volume=Math.max(0,Math.min(1,e/100))):ge._setVolume(f.id,pe.muted&&!f.muted||f.muted?0:e),f._iO.volume=e,n||(f.volume=e,f.options.volume=e),f},this.mute=function(){return f.muted=!0,f.isHTML5?f._a&&(f._a.muted=!0):ge._setVolume(f.id,0),f},this.unmute=function(){f.muted=!1;var e=f._iO.volume!==t;return f.isHTML5?f._a&&(f._a.muted=!1):ge._setVolume(f.id,e?f._iO.volume:f.options.volume),f},this.toggleMute=function(){return f.muted?f.unmute():f.mute()},this.onPosition=function(e,n,i){return m.push({position:parseInt(e,10),method:n,scope:i!==t?i:f,fired:!1}),f},this.onposition=this.onPosition,this.clearOnPosition=function(e,t){var n;if(e=parseInt(e,10),isNaN(e))return!1;for(n=0;n<m.length;n++)e===m[n].position&&(t&&t!==m[n].method||(m[n].fired&&v--,m.splice(n,1)))},this._processOnPosition=function(){var e,t,n=m.length;if(!n||!f.playState||v>=n)return!1;for(e=n-1;e>=0;e--)t=m[e],!t.fired&&f.position>=t.position&&(t.fired=!0,v++,t.method.apply(t.scope,[t.position]),n=m.length);return!0},this._resetOnPosition=function(e){var t,n,i=m.length;if(!i)return!1;for(t=i-1;t>=0;t--)n=m[t],n.fired&&e<=n.position&&(n.fired=!1,v--);return!0},c=function(){var e,t,n=f._iO,i=n.from,o=n.to;return t=function(){f.clearOnPosition(o,t),f.stop()},e=function(){null===o||isNaN(o)||f.onPosition(o,t)},null===i||isNaN(i)||(n.position=i,n.multiShot=!1,e()),n},s=function(){var e,t=f._iO.onposition;if(t)for(e in t)t.hasOwnProperty(e)&&f.onPosition(parseInt(e,10),t[e])},l=function(){var e,t=f._iO.onposition;if(t)for(e in t)t.hasOwnProperty(e)&&f.clearOnPosition(parseInt(e,10))},a=function(){f.isHTML5&&z(f)},r=function(){f.isHTML5&&W(f)},n=function(e){e||(m=[],v=0),g=!1,f._hasTimer=null,f._a=null,f._html5_canplay=!1,f.bytesLoaded=null,f.bytesTotal=null,f.duration=f._iO&&f._iO.duration?f._iO.duration:null,f.durationEstimate=null,f.buffered=[],f.eqData=[],f.eqData.left=[],f.eqData.right=[],f.failures=0,f.isBuffering=!1,f.instanceOptions={},f.instanceCount=0,f.loaded=!1,f.metadata={},f.readyState=0,f.muted=!1,f.paused=!1,f.peakData={left:0,right:0},f.waveformData={left:[],right:[]},f.playState=0,f.position=null,f.id3={}},n(),this._onTimer=function(e){var t,n,i=!1,o={};return f._hasTimer||e?(f._a&&(e||(f.playState>0||1===f.readyState)&&!f.paused)&&(t=f._get_html5_duration(),t!==d.duration&&(d.duration=t,f.duration=t,i=!0),f.durationEstimate=f.duration,n=f._a.currentTime*Le||0,n!==d.time&&(d.time=n,i=!0),(i||e)&&f._whileplaying(n,o,o,o,o)),i):void 0},this._get_html5_duration=function(){var e=f._iO,t=f._a&&f._a.duration?f._a.duration*Le:e&&e.duration?e.duration:null,n=t&&!isNaN(t)&&t!==1/0?t:null;return n},this._apply_loop=function(e,t){e.loop=t>1?"loop":""},this._setup_html5=function(e){var t,o=p(f._iO,e),r=Be?fe:f._a,a=decodeURI(o.url);if(Be?a===decodeURI(oe)&&(t=!0):a===decodeURI(y)&&(t=!0),r){if(r._s)if(Be)r._s&&r._s.playState&&!t&&r._s.stop();else if(!Be&&a===decodeURI(y))return f._apply_loop(r,o.loops),r;t||(y&&n(!1),r.src=o.url,f.url=o.url,y=o.url,oe=o.url,r._called_load=!1)}else o.autoLoad||o.autoPlay?(f._a=new Audio(o.url),f._a.load()):f._a=Ve&&opera.version()<10?new Audio(null):new Audio,r=f._a,r._called_load=!1,Be&&(fe=r);return f.isHTML5=!0,f._a=r,r._s=f,i(),f._apply_loop(r,o.loops),o.autoLoad||o.autoPlay?f.load():(r.autobuffer=!1,r.preload="auto"),r},i=function(){function e(e,t,n){return f._a?f._a.addEventListener(e,t,n||!1):null}if(f._a._added_events)return!1;var t;f._a._added_events=!0;for(t in le)le.hasOwnProperty(t)&&e(t,le[t]);return!0},o=function(){function e(e,t,n){return f._a?f._a.removeEventListener(e,t,n||!1):null}var t;f._a._added_events=!1;for(t in le)le.hasOwnProperty(t)&&e(t,le[t])},this._onload=function(e){var t=!!e||!f.isHTML5&&8===u&&f.duration;return f.loaded=t,f.readyState=t?3:2,f._onbufferchange(0),f._iO.onload&&ue(f,function(){f._iO.onload.apply(f,[t])}),!0},this._onbufferchange=function(e){return 0===f.playState?!1:e&&f.isBuffering||!e&&!f.isBuffering?!1:(f.isBuffering=1===e,f._iO.onbufferchange&&f._iO.onbufferchange.apply(f,[e]),!0)},this._onsuspend=function(){return f._iO.onsuspend&&f._iO.onsuspend.apply(f),!0},this._onfailure=function(e,t,n){f.failures++,f._iO.onfailure&&1===f.failures&&f._iO.onfailure(e,t,n)},this._onwarning=function(e,t,n){f._iO.onwarning&&f._iO.onwarning(e,t,n)},this._onfinish=function(){var e=f._iO.onfinish;f._onbufferchange(0),f._resetOnPosition(0),f.instanceCount&&(f.instanceCount--,f.instanceCount||(l(),f.playState=0,f.paused=!1,f.instanceCount=0,f.instanceOptions={},f._iO={},r(),f.isHTML5&&(f.position=0)),(!f.instanceCount||f._iO.multiShotEvents)&&e&&ue(f,function(){e.apply(f)}))},this._whileloading=function(e,t,n,i){var o=f._iO;f.bytesLoaded=e,f.bytesTotal=t,f.duration=Math.floor(n),f.bufferLength=i,f.isHTML5||o.isMovieStar?f.durationEstimate=f.duration:o.duration?f.durationEstimate=f.duration>o.duration?f.duration:o.duration:f.durationEstimate=parseInt(f.bytesTotal/f.bytesLoaded*f.duration,10),f.isHTML5||(f.buffered=[{start:0,end:f.duration}]),(3!==f.readyState||f.isHTML5)&&o.whileloading&&o.whileloading.apply(f)},this._whileplaying=function(e,n,i,o,r){var a,s=f._iO;return isNaN(e)||null===e?!1:(f.position=Math.max(0,e),f._processOnPosition(),!f.isHTML5&&u>8&&(s.usePeakData&&n!==t&&n&&(f.peakData={left:n.leftPeak,right:n.rightPeak}),s.useWaveformData&&i!==t&&i&&(f.waveformData={left:i.split(","),right:o.split(",")}),s.useEQData&&r!==t&&r&&r.leftEQ&&(a=r.leftEQ.split(","),f.eqData=a,f.eqData.left=a,r.rightEQ!==t&&r.rightEQ&&(f.eqData.right=r.rightEQ.split(",")))),1===f.playState&&(f.isHTML5||8!==u||f.position||!f.isBuffering||f._onbufferchange(0),s.whileplaying&&s.whileplaying.apply(f)),!0)},this._oncaptiondata=function(e){f.captiondata=e,f._iO.oncaptiondata&&f._iO.oncaptiondata.apply(f,[e])},this._onmetadata=function(e,t){var n,i,o={};for(n=0,i=e.length;i>n;n++)o[e[n]]=t[n];f.metadata=o,f._iO.onmetadata&&f._iO.onmetadata.call(f,f.metadata)},this._onid3=function(e,t){var n,i,o=[];for(n=0,i=e.length;i>n;n++)o[e[n]]=t[n];f.id3=p(f.id3,o),f._iO.onid3&&f._iO.onid3.apply(f)},this._onconnect=function(e){e=1===e,f.connected=e,e&&(f.failures=0,U(f.id)&&(f.getAutoPlay()?f.play(t,f.getAutoPlay()):f._iO.autoLoad&&f.load()),f._iO.onconnect&&f._iO.onconnect.apply(f,[e]))},this._ondataerror=function(e){f.playState>0&&f._iO.ondataerror&&f._iO.ondataerror.apply(f)}},j=function(){return ye.body||ye.getElementsByTagName("div")[0]},s=function(e){return ye.getElementById(e)},p=function(e,n){var i,o,r=e||{};i=n===t?pe.defaultOptions:n;for(o in i)i.hasOwnProperty(o)&&r[o]===t&&("object"!=typeof i[o]||null===i[o]?r[o]=i[o]:r[o]=p(r[o],i[o]));return r},ue=function(t,n){t.isHTML5||8!==u?n():e.setTimeout(n,0)},g={onready:1,ontimeout:1,defaultOptions:1,flash9Options:1,movieStarOptions:1},f=function(e,n){var i,o=!0,r=n!==t,a=pe.setupOptions,s=g;for(i in e)if(e.hasOwnProperty(i))if("object"!=typeof e[i]||null===e[i]||e[i]instanceof Array||e[i]instanceof RegExp)r&&s[n]!==t?pe[n][i]=e[i]:a[i]!==t?(pe.setupOptions[i]=e[i],pe[i]=e[i]):s[i]===t?o=!1:pe[i]instanceof Function?pe[i].apply(pe,e[i]instanceof Array?e[i]:[e[i]]):pe[i]=e[i];else{if(s[i]!==t)return f(e[i],i);o=!1}return o},ie=function(){function t(e){var t=Pe.call(e),n=t.length;return r?(t[1]="on"+t[1],n>3&&t.pop()):3===n&&t.push(!1),t}function n(e,t){var n=e.shift(),i=[a[t]];r?n[i](e[0],e[1]):n[i].apply(n,e)}function i(){n(t(arguments),"add")}function o(){n(t(arguments),"remove")}var r=e.attachEvent,a={add:r?"attachEvent":"addEventListener",remove:r?"detachEvent":"removeEventListener"};return{add:i,remove:o}}(),le={abort:r(function(){}),canplay:r(function(){var e,n=this._s;if(n._html5_canplay)return!0;if(n._html5_canplay=!0,n._onbufferchange(0),e=n._iO.position===t||isNaN(n._iO.position)?null:n._iO.position/Le,this.currentTime!==e)try{this.currentTime=e}catch(i){}n._iO._oncanplay&&n._iO._oncanplay()}),canplaythrough:r(function(){var e=this._s;e.loaded||(e._onbufferchange(0),e._whileloading(e.bytesLoaded,e.bytesTotal,e._get_html5_duration()),e._onload(!0))}),durationchange:r(function(){var e,t=this._s;e=t._get_html5_duration(),isNaN(e)||e===t.duration||(t.durationEstimate=t.duration=e)}),ended:r(function(){var e=this._s;e._onfinish()}),error:r(function(){this._s._onload(!1)}),loadeddata:r(function(){var e=this._s;e._loaded||Ge||(e.duration=e._get_html5_duration())}),loadedmetadata:r(function(){}),loadstart:r(function(){this._s._onbufferchange(1)}),play:r(function(){this._s._onbufferchange(0)}),playing:r(function(){this._s._onbufferchange(0)}),progress:r(function(e){var t,n,i=this._s,o=0,r=("progress"===e.type,e.target.buffered),a=e.loaded||0,s=e.total||1;if(i.buffered=[],r&&r.length){for(t=0,n=r.length;n>t;t++)i.buffered.push({start:r.start(t)*Le,end:r.end(t)*Le});o=(r.end(0)-r.start(0))*Le,a=Math.min(1,o/(e.target.duration*Le))}isNaN(a)||(i._whileloading(a,s,i._get_html5_duration()),a&&s&&a===s&&le.canplaythrough.call(this,e))}),ratechange:r(function(){}),suspend:r(function(e){var t=this._s;le.progress.call(this,e),t._onsuspend()}),stalled:r(function(){}),timeupdate:r(function(){this._s._onTimer()}),waiting:r(function(){var e=this._s;e._onbufferchange(1)})},J=function(e){var t;return t=e&&(e.type||e.url||e.serverURL)?e.serverURL||e.type&&o(e.type)?!1:e.type?X({type:e.type}):X({url:e.url})||pe.html5Only||e.url.match(/data\:/i):!1},ee=function(e){var n;return e&&(n=Ge?Ye:pe.html5.canPlayType("audio/wav")?Je:Ye,e.src=n,e._called_unload!==t&&(e._called_load=!1)),Be&&(oe=null),n},X=function(e){if(!pe.useHTML5Audio||!pe.hasHTML5)return!1;var n,i,r,a,s=e.url||null,l=e.type||null,c=pe.audioFormats;if(l&&pe.html5[l]!==t)return pe.html5[l]&&!o(l);if(!Z){Z=[];for(a in c)c.hasOwnProperty(a)&&(Z.push(a),c[a].related&&(Z=Z.concat(c[a].related)));Z=new RegExp("\\.("+Z.join("|")+")(\\?.*)?$","i")}return r=s?s.toLowerCase().match(Z):null,r&&r.length?r=r[1]:l?(i=l.indexOf(";"),r=(-1!==i?l.substr(0,i):l).substr(6)):n=!1,r&&pe.html5[r]!==t?n=pe.html5[r]&&!o(r):(l="audio/"+r,n=pe.html5.canPlayType({type:l}),pe.html5[r]=n,n=n&&pe.html5[l]&&!o(l)),n},ne=function(){function e(e){var t,n,i=!1,o=!1;if(!a||"function"!=typeof a.canPlayType)return i;if(e instanceof Array){for(r=0,n=e.length;n>r;r++)(pe.html5[e[r]]||a.canPlayType(e[r]).match(pe.html5Test))&&(o=!0,pe.html5[e[r]]=!0,pe.flash[e[r]]=!!e[r].match(Ke));i=o}else t=a&&"function"==typeof a.canPlayType?a.canPlayType(e):!1,i=!(!t||!t.match(pe.html5Test));return i}if(!pe.useHTML5Audio||!pe.hasHTML5)return pe.html5.usingFlash=!0,Me=!0,!1;var n,i,o,r,a=Audio!==t?Ve&&opera.version()<10?new Audio(null):new Audio:null,s={};o=pe.audioFormats;for(n in o)if(o.hasOwnProperty(n)&&(i="audio/"+n,s[n]=e(o[n].type),s[i]=s[n],n.match(Ke)?(pe.flash[n]=!0,pe.flash[i]=!0):(pe.flash[n]=!1,pe.flash[i]=!1),o[n]&&o[n].related))for(r=o[n].related.length-1;r>=0;r--)s["audio/"+o[n].related[r]]=s[n],pe.html5[o[n].related[r]]=s[n],pe.flash[o[n].related[r]]=s[n];return s.canPlayType=a?e:null,pe.html5=p(pe.html5,s),pe.html5.usingFlash=Y(),Me=pe.html5.usingFlash,!0},x={},L=function(){},H=function(e){return 8===u&&e.loops>1&&e.stream&&(e.stream=!1),e},G=function(e,t){return e&&!e.usePolicyFile&&(e.onid3||e.usePeakData||e.useWaveformData||e.useEQData)&&(e.usePolicyFile=!0),e},V=function(e){},l=function(){return!1},P=function(e){var t;for(t in e)e.hasOwnProperty(t)&&"function"==typeof e[t]&&(e[t]=l);t=null},B=function(e){e===t&&(e=!1),(Fe||e)&&pe.disable(e)},R=function(e){var t,n=null;if(e)if(e.match(/\.swf(\?.*)?$/i)){if(n=e.substr(e.toLowerCase().lastIndexOf(".swf?")+4))return e}else e.lastIndexOf("/")!==e.length-1&&(e+="/");return t=(e&&-1!==e.lastIndexOf("/")?e.substr(0,e.lastIndexOf("/")+1):"./")+pe.movieURL,pe.noSWFCache&&(t+="?ts="+(new Date).getTime()),t},k=function(){u=parseInt(pe.flashVersion,10),8!==u&&9!==u&&(pe.flashVersion=u=Te);var e=pe.debugMode||pe.debugFlash?"_debug.swf":".swf";pe.useHTML5Audio&&!pe.html5Only&&pe.audioFormats.mp4.required&&9>u&&(pe.flashVersion=u=9),pe.version=pe.versionNumber+(pe.html5Only?" (HTML5-only mode)":9===u?" (AS3/Flash 9)":" (AS2/Flash 8)"),u>8?(pe.defaultOptions=p(pe.defaultOptions,pe.flash9Options),pe.features.buffering=!0,pe.defaultOptions=p(pe.defaultOptions,pe.movieStarOptions),pe.filePatterns.flash9=new RegExp("\\.(mp3|"+tt.join("|")+")(\\?.*)?$","i"),pe.features.movieStar=!0):pe.features.movieStar=!1,pe.filePattern=pe.filePatterns[8!==u?"flash9":"flash8"],pe.movieURL=(8===u?"soundmanager2.swf":"soundmanager2_flash9.swf").replace(".swf",e),pe.features.peakData=pe.features.waveformData=pe.features.eqData=u>8},O=function(e,t){return ge?void ge._setPolling(e,t):!1},M=function(){},U=this.getSoundById,D=function(){var e=[];return pe.debugMode&&e.push(Q.sm2Debug),pe.debugFlash&&e.push(Q.flashDebug),pe.useHighPerformance&&e.push(Q.highPerf),e.join(" ")},N=function(){var e=(L("fbHandler"),pe.getMoviePercent()),t=Q,n={type:"FLASHBLOCK"};return pe.html5Only?!1:void(pe.ok()?pe.oMC&&(pe.oMC.className=[D(),t.swfDefault,t.swfLoaded+(pe.didFlashBlock?" "+t.swfUnblocked:"")].join(" ")):(Me&&(pe.oMC.className=D()+" "+t.swfDefault+" "+(null===e?t.swfTimedout:t.swfError)),pe.didFlashBlock=!0,v({type:"ontimeout",ignoreInit:!0,error:n}),A(n)))},m=function(e,n,i){we[e]===t&&(we[e]=[]),we[e].push({method:n,scope:i||null,fired:!1})},v=function(e){if(e||(e={type:pe.ok()?"onready":"ontimeout"}),!ke&&e&&!e.ignoreInit)return!1;if("ontimeout"===e.type&&(pe.ok()||Fe&&!e.ignoreInit))return!1;var t,n,i={success:e&&e.ignoreInit?pe.ok():!Fe},o=e&&e.type?we[e.type]||[]:[],r=[],a=[i],s=Me&&!pe.ok();for(e.error&&(a[0].error=e.error),t=0,n=o.length;n>t;t++)o[t].fired!==!0&&r.push(o[t]);if(r.length)for(t=0,n=r.length;n>t;t++)r[t].scope?r[t].method.apply(r[t].scope,a):r[t].method.apply(this,a),s||(r[t].fired=!0);return!0},y=function(){e.setTimeout(function(){pe.useFlashBlock&&N(),v(),"function"==typeof pe.onload&&pe.onload.apply(e),pe.waitForWindowLoad&&ie.add(e,"load",y)},1)},ae=function(){if(re!==t)return re;var n,i,o,r=!1,a=navigator,s=a.plugins,l=e.ActiveXObject;if(s&&s.length)i="application/x-shockwave-flash",o=a.mimeTypes,o&&o[i]&&o[i].enabledPlugin&&o[i].enabledPlugin.description&&(r=!0);else if(l!==t&&!me.match(/MSAppHost/i)){try{n=new l("ShockwaveFlash.ShockwaveFlash")}catch(c){n=null}r=!!n,n=null}return re=r,r},Y=function(){var e,t,n=pe.audioFormats,i=Ne&&!!me.match(/os (1|2|3_0|3_1)\s/i);if(i?(pe.hasHTML5=!1,pe.html5Only=!0,pe.oMC&&(pe.oMC.style.display="none")):pe.useHTML5Audio&&(pe.html5&&pe.html5.canPlayType||(pe.hasHTML5=!1)),pe.useHTML5Audio&&pe.hasHTML5){K=!0;for(t in n)n.hasOwnProperty(t)&&n[t].required&&(pe.html5.canPlayType(n[t].type)?pe.preferFlash&&(pe.flash[t]||pe.flash[n[t].type])&&(e=!0):(K=!1,e=!0))}return pe.ignoreFlash&&(e=!1,K=!0),pe.html5Only=pe.hasHTML5&&pe.useHTML5Audio&&!e,!pe.html5Only},q=function(e){var t,n,i,o=0;if(e instanceof Array){for(t=0,n=e.length;n>t;t++)if(e[t]instanceof Object){if(pe.canPlayMIME(e[t].type)){o=t;break}}else if(pe.canPlayURL(e[t])){o=t;break}e[o].url&&(e[o]=e[o].url),i=e[o]}else i=e;return i},z=function(e){e._hasTimer||(e._hasTimer=!0,!Ue&&pe.html5PollingInterval&&(null===Ae&&0===Ie&&(Ae=setInterval($,pe.html5PollingInterval)),Ie++))},W=function(e){e._hasTimer&&(e._hasTimer=!1,!Ue&&pe.html5PollingInterval&&Ie--)},$=function(){var e;if(null!==Ae&&!Ie)return clearInterval(Ae),Ae=null,!1;for(e=pe.soundIDs.length-1;e>=0;e--)pe.sounds[pe.soundIDs[e]].isHTML5&&pe.sounds[pe.soundIDs[e]]._hasTimer&&pe.sounds[pe.soundIDs[e]]._onTimer()},A=function(n){n=n!==t?n:{},"function"==typeof pe.onerror&&pe.onerror.apply(e,[{type:n.type!==t?n.type:null}]),n.fatal!==t&&n.fatal&&pe.disable()},se=function(){if(!ze||!ae())return!1;var e,t,n=pe.audioFormats;for(t in n)if(n.hasOwnProperty(t)&&("mp3"===t||"mp4"===t)&&(pe.html5[t]=!1,
n[t]&&n[t].related))for(e=n[t].related.length-1;e>=0;e--)pe.html5[n[t].related[e]]=!1},this._setSandboxType=function(e){},this._externalInterfaceOK=function(e){if(pe.swfLoaded)return!1;pe.swfLoaded=!0,$e=!1,ze&&se(),setTimeout(d,Qe?100:1)},I=function(e,n){function i(){}function o(e,t){return'<param name="'+e+'" value="'+t+'" />'}if(be&&Ce)return!1;if(pe.html5Only)return k(),i(),pe.oMC=s(pe.movieID),d(),be=!0,Ce=!0,!1;var r,a,l,c,u,h,p,f,g=n||pe.url,m=pe.altURL||g,v="JS/Flash audio component (SoundManager 2)",y=j(),w=D(),b=null,C=ye.getElementsByTagName("html")[0];if(b=C&&C.dir&&C.dir.match(/rtl/i),e=e===t?pe.id:e,k(),pe.url=R(Xe?g:m),n=pe.url,pe.wmode=!pe.wmode&&pe.useHighPerformance?"transparent":pe.wmode,null!==pe.wmode&&(me.match(/msie 8/i)||!Qe&&!pe.useHighPerformance)&&navigator.platform.match(/win32|win64/i)&&(Oe.push(x.spcWmode),pe.wmode=null),r={name:e,id:e,src:n,quality:"high",allowScriptAccess:pe.allowScriptAccess,bgcolor:pe.bgColor,pluginspage:Ze+"www.macromedia.com/go/getflashplayer",title:v,type:"application/x-shockwave-flash",wmode:pe.wmode,hasPriority:"true"},pe.debugFlash&&(r.FlashVars="debug=1"),pe.wmode||delete r.wmode,Qe)a=ye.createElement("div"),c=['<object id="'+e+'" data="'+n+'" type="'+r.type+'" title="'+r.title+'" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0">',o("movie",n),o("AllowScriptAccess",pe.allowScriptAccess),o("quality",r.quality),pe.wmode?o("wmode",pe.wmode):"",o("bgcolor",pe.bgColor),o("hasPriority","true"),pe.debugFlash?o("FlashVars",r.FlashVars):"","</object>"].join("");else{a=ye.createElement("embed");for(l in r)r.hasOwnProperty(l)&&a.setAttribute(l,r[l])}if(M(),w=D(),y=j())if(pe.oMC=s(pe.movieID)||ye.createElement("div"),pe.oMC.id)f=pe.oMC.className,pe.oMC.className=(f?f+" ":Q.swfDefault)+(w?" "+w:""),pe.oMC.appendChild(a),Qe&&(u=pe.oMC.appendChild(ye.createElement("div")),u.className=Q.swfBox,u.innerHTML=c),Ce=!0;else{if(pe.oMC.id=pe.movieID,pe.oMC.className=Q.swfDefault+" "+w,h=null,u=null,pe.useFlashBlock||(pe.useHighPerformance?h={position:"fixed",width:"8px",height:"8px",bottom:"0px",left:"0px",overflow:"hidden"}:(h={position:"absolute",width:"6px",height:"6px",top:"-9999px",left:"-9999px"},b&&(h.left=Math.abs(parseInt(h.left,10))+"px"))),He&&(pe.oMC.style.zIndex=1e4),!pe.debugFlash)for(p in h)h.hasOwnProperty(p)&&(pe.oMC.style[p]=h[p]);try{Qe||pe.oMC.appendChild(a),y.appendChild(pe.oMC),Qe&&(u=pe.oMC.appendChild(ye.createElement("div")),u.className=Q.swfBox,u.innerHTML=c),Ce=!0}catch(F){throw new Error(L("domError")+" \n"+F.toString())}}return be=!0,i(),!0},T=function(){return pe.html5Only?(I(),!1):ge?!1:pe.url?(ge=pe.getMovie(pe.id),ge||(_e?(Qe?pe.oMC.innerHTML=Ee:pe.oMC.appendChild(_e),_e=null,be=!0):I(pe.id,pe.url),ge=pe.getMovie(pe.id)),"function"==typeof pe.oninitmovie&&setTimeout(pe.oninitmovie,1),!0):!1},w=function(){setTimeout(b,1e3)},C=function(){e.setTimeout(function(){pe.setup({preferFlash:!1}).reboot(),pe.didFlashBlock=!0,pe.beginDelayedInit()},1)},b=function(){var t,n=!1;return pe.url?Se?!1:(Se=!0,ie.remove(e,"load",w),re&&$e&&!We?!1:(ke||(t=pe.getMoviePercent(),t>0&&100>t&&(n=!0)),void setTimeout(function(){return t=pe.getMoviePercent(),n?(Se=!1,e.setTimeout(w,1),!1):void(!ke&&qe&&(null===t?pe.useFlashBlock||0===pe.flashLoadTimeout?pe.useFlashBlock&&N():!pe.useFlashBlock&&K?C():v({type:"ontimeout",ignoreInit:!0,error:{type:"INIT_FLASHBLOCK"}}):0===pe.flashLoadTimeout||(!pe.useFlashBlock&&K?C():B(!0))))},pe.flashLoadTimeout))):!1},F=function(){function t(){ie.remove(e,"focus",F)}return We||!$e?(t(),!0):(qe=!0,We=!0,Se=!1,w(),t(),!0)},de=function(){},ce=function(){},h=function(t){if(ke)return!1;if(pe.html5Only)return ke=!0,y(),!0;var n,i=pe.useFlashBlock&&pe.flashLoadTimeout&&!pe.getMoviePercent(),o=!0;return i||(ke=!0),n={type:!re&&Me?"NO_FLASH":"INIT_TIMEOUT"},(Fe||t)&&(pe.useFlashBlock&&pe.oMC&&(pe.oMC.className=D()+" "+(null===pe.getMoviePercent()?Q.swfTimedout:Q.swfError)),v({type:"ontimeout",error:n,ignoreInit:!0}),A(n),o=!1),Fe||(pe.waitForWindowLoad&&!xe?ie.add(e,"load",y):y()),o},c=function(){var e,n=pe.setupOptions;for(e in n)n.hasOwnProperty(e)&&(pe[e]===t?pe[e]=n[e]:pe[e]!==n[e]&&(pe.setupOptions[e]=pe[e]))},d=function(){function t(){ie.remove(e,"load",pe.beginDelayedInit)}if(ke)return!1;if(pe.html5Only)return ke||(t(),pe.enabled=!0,h()),!0;T();try{ge._externalInterfaceTest(!1),O(!0,pe.flashPollingInterval||(pe.useHighPerformance?10:50)),pe.debugMode||ge._disableDebug(),pe.enabled=!0,pe.html5Only||ie.add(e,"unload",l)}catch(n){return A({type:"JS_TO_FLASH_EXCEPTION",fatal:!0}),B(!0),h(),!1}return h(),t(),!0},_=function(){return S?!1:(S=!0,c(),M(),!re&&pe.hasHTML5&&pe.setup({useHTML5Audio:!0,preferFlash:!1}),ne(),!re&&Me&&(Oe.push(x.needFlash),pe.setup({flashLoadTimeout:1})),ye.removeEventListener&&ye.removeEventListener("DOMContentLoaded",_,!1),T(),!0)},te=function(){return"complete"===ye.readyState&&(_(),ye.detachEvent("onreadystatechange",te)),!0},E=function(){xe=!0,_(),ie.remove(e,"load",E)},ae(),ie.add(e,"focus",F),ie.add(e,"load",w),ie.add(e,"load",E),ye.addEventListener?ye.addEventListener("DOMContentLoaded",_,!1):ye.attachEvent?ye.attachEvent("onreadystatechange",te):A({type:"NO_DOM2_EVENTS",fatal:!0})}if(!e||!e.document)throw new Error("SoundManager requires a browser with window and document objects.");var i=null;e.SM2_DEFER!==t&&SM2_DEFER||(i=new n),"object"==typeof module&&module&&"object"==typeof module.exports?(module.exports.SoundManager=n,module.exports.soundManager=i):"function"==typeof define&&define.amd&&define(function(){function t(t){if(!e.soundManager&&t instanceof Function){var i=t(n);i instanceof n&&(e.soundManager=i)}return e.soundManager}return{constructor:n,getInstance:t}}),e.SoundManager=n,e.soundManager=i}(window),"undefined"==typeof Widgets&&(Widgets={}),Widgets.Base=function(){return{keys:{VK_RETURN:13,VK_ESCAPE:27,VK_PAGE_UP:33,VK_PAGE_DOWN:34,VK_END:35,VK_HOME:36,VK_LEFT:37,VK_UP:38,VK_RIGHT:39,VK_DOWN:40,VK_DELETE:46,VK_F1:112,VK_F2:113,VK_F3:114,VK_F4:115,VK_F5:116,VK_F6:117,VK_F7:118,VK_F8:119,VK_F9:120,VK_F10:121,VK_F11:122,VK_F12:123,VK_COPY:67,VK_PASTE:86},setup:function(e){var t;e=jQuery(e),0!==e.length&&(e.find("widget").each(function(){t=t||new Handler.Template("widgets");var e=jQuery(this),n=jQuery.parseJSON(e.attr("data")),i=t.render("widget-"+n.wid+"-content",n),o=jQuery(i).attr("data-widget",jQuery.toJSON(n));e.replaceWith(o)}),e.find(".widgetcontainer").each(this.setupSingleWidget),e.find(".widgetcontainer-inline").each(this.setupSingleWidget))},setupSingleWidget:function(){var e=jQuery(this),t=e.attr("data");if(t){t=jQuery.parseJSON(t);var n=Widgets[t.wid.toCamelCase(!0)];n&&n().create(e)}},properties:{},collectJson:function(e){var t={};return e.find("[json-data]").each(function(){var e=jQuery(this),n=e.attr("json-data"),i=this.tagName;switch(i.toLowerCase()){case"input":case"textarea":case"select":("checkbox"!==this.type&&"radio"!==this.type||this.checked)&&(t[n]=e.val());break;case"div":t[n]=e.html();break;case"a":t[n]=e.attr("href");break;case"img":t[n]=e.attr("src")}e=null}),t},saveJson:function(e){e.find("[json-target]").val(jQuery.toJSON(this.collectJson(e)))},create:function(e,t){var n=e.get(0).style.height;"%"===n.substr(n.length-1)&&e.css("height",e.width()*parseFloat(n)/100+"px"),"left"===e.css("float")?e.css("margin","0px 10px 10px 0px"):"right"===e.css("float")?e.css("margin","0px 0px 10px 10px"):e.css("margin","0px auto 0px auto");var i;if(t){var o=e.data("widget");if(e.resizef||(e.resizef=function(n,i){if(!i){var r=e.find(".widget-resize"),a=e.find(".widget-float");if(r.length+a.length!==0){if(r.length){var s=e.width(),l=e.height();if(!e.attr("style").match(/width\s*:\s*auto/i)){var c=jQuery("<p/>").html("&nbsp;").appendTo(t),d=c.width();c.remove(),l="auto"==o.properties.height?"auto":l/s*100+"%",s=d?Math.round(100*s/d)+"%":s+"px",void 0!==o.properties.width&&(o.properties.width=s),void 0!==o.properties.height&&(o.properties.height=l)}}a.length&&void 0!==o.properties["float"]&&(o.properties["float"]=e.css("float")||"none"),e.attr("data-widget",jQuery.toJSON(o)),e.css({"margin-left":"right"===o.properties["float"]?"10px":"left"===o.properties["float"]?"0px":"auto","margin-right":"left"===o.properties["float"]?"10px":"left"===o.properties["float"]?"0px":"auto"})}}}),e.off("resize",e.resizef).on("resize",e.resizef),i=e.css("float"),e.css({"margin-left":"right"===i?"10px":"none"===i?"auto":"0px","margin-right":"left"===i?"10px":"none"===i?"auto":"0px"}),e.is(t.widgetmask)){e.find(".cover").length||e.append(jQuery("<div/>").addClass("cover"));var r=function(){e.find(".cover").css({width:e.outerWidth()+"px",height:e.outerHeight()+"px"}).appendTo(e)};e.on("resize",r),r()}}else i=e.css("float"),e.css({"margin-left":"right"===i?"10px":"none"===i?"auto":"0px","margin-right":"left"===i?"10px":"none"===i?"auto":"0px"}),e.find(".cover").remove();return e},dialog:function(e,t,n,i,o){return e.find("a.back").on("click",function(){t.extensions.widgets.index()}),e},remove:function(e,t,n){return!1},extend:function(e){var t=this;return function(){var n=jQuery.extend({},t);n.parent={};for(var i in t)"function"==typeof t[i]?n.parent[i]=function(e){return function(){var i=n.parent;n.parent=t.parent;var o=t[e].apply(n,arguments);return n.parent=i,o}}(i):n.parent[i]=t[i];for(var i in e)n[i]=e[i];return n}}}},"undefined"==typeof Widgets&&(Widgets={}),Widgets.Chess=Widgets.Base().extend(function(){var e={},t={},n={},i={},o={},r={},a=Date.now(),s=function(e,t){for(var n=0;n<e.moves.length;n++)if(e.moves[n].fen===t)return e.moves[n].knotId;return 0},l=function(e,t){for(var n=0;n<e.moves.length;n++)if(e.moves[n].knotId==t)return e.moves[n].fen;return""},c={events:{},initialized:!1,lastCopyId:0,on:function(e,t){e&&"function"==typeof t&&(this.events[e]?this.events[e].push(t):this.events[e]=[t])},off:function(e,t){"undefined"!=typeof t?this.events[e]&&this.events[e].removeByValue(t):this.events[e]=[]},notify:function(e){if(this.events[e])for(var t=0;t<this.events[e].length;t++)this.events[e][t].apply(null,Array.convert(arguments).slice(1))},addController:function(n,i){var o=n+"@"+i;return e[o]||(e[o]=new Chess.GameHandler,e[o].addGame(n,t[n]),e[o].setCurrentGame(n),e[o].gotoStart(),this.decorateController(e[o]),this.notify("newcontroller",e[o])),o},addView:function(e,t,n){var e=e||++a;return a=Math.max(e,a),o[e]=t,this.unlinkView(e),n||this.linkView(e,"main"),e},linkView:function(t,n){o[t]&&e[n]&&("undefined"==typeof r[t]&&(r[t]=[]),r[t].contains(n)||(r[t].push(n),o[t].link(e[n])))},unlinkView:function(t,n){if(o[t]){"undefined"==typeof r[t]&&(r[t]=[]);for(var i=n?[n]:r[t],a=[],s=0;s<i.length;s++)r[t].contains(i[s])&&o[t].unlink(e[i[s]]);for(var s=0;s<r[t].length;s++)i.contains(r[t][s])||a.push(r[t][s]);r[t]=a}},createCopyId:function(){return++this.lastCopyId},separateView:function(t,n,i){if(!i){for(var o=!0,r=0;r<n.length;r++)if(!this.isViewSeparated(t,n[r],i)){o=!1;break}if(o)return}this.unlinkView(t);for(var a=this.addController(n[0],t),s=e[a],r=i?0:1;r<n.length;r++)s.addGame(n[r],this.getGame(n[r],i));i&&s.setCurrentGame(n[0]),s.gotoStart(),this.linkView(t,a)},isViewSeparated:function(e,t){for(var n=this.getControllersForView(e),i=0;i<n.length;i++)if("main"!=n[i]){var o=this.getController(n[i]);if(o.getGame(t))return!0}return!1},isViewLinked:function(e,t){return"undefined"==typeof r[e]?!1:r[e].contains(t)},checkSeparatedViews:function(t,n){var i=[];n.find("a").each(function(){var e=jQuery(this),t=e.attr("data");if(t&&(t=jQuery.parseJSON(t),t&&"chess-jump-to-link"==t.wid&&t.views&&t.views))for(var n=0;n<t.views.length;n++)i.contains(t.views[n])||i.push(t.views[n])});for(var o=0;o<t.length;o++)if(!this.isViewLinked(t[o],"main")&&!i.contains(t[o])){if(this.isStaticView(t[o]))continue;this.unlinkView(t[o]),this.linkView(t[o],"main")}var a=[],s=[];for(var l in r)a=a.concat(r[l]);for(var l in e)"main"==l||a.contains(l)||s.push(l);for(var o=0;o<s.length;o++)delete e[s[o]]},makeStaticView:function(t,n,i){var o=this.getGameJson(n);if(o){var r=l(o,i);if(r){this.unlinkView(t);var a=t+"@static";e[a]=new Chess.GameHandler,e[a].addGame(a,new Chess.Game({fen:r})),this.linkView(t,a)}}},isStaticView:function(e){for(var t=this.getControllersForView(e),n=0;n<t.length;n++)if("@static"==t[n].substr(t[n].length-7))return!0;return!1},getMoveByIndex:function(e,t){var n=this.getGameJson(e);return n&&n.moves[t]?n.moves[t]:null},getMoveByKnotId:function(e,t){var n=this.getGameJson(e);if(!n)return null;for(var i=0;i<n.moves.length;i++)if(n.moves[i].knotId==t)return n.moves[i];return null},getPositionByKnotId:function(e,t){var n=this.getGame(e);if(!n)return null;var i=function(e,t){if(!e)return null;if(e.knotId==t)return e;if(!e.childrenMoves)return null;for(var n=0;n<e.childrenMoves.length;n++){var o=i(e.childrenMoves[n],t);if(o)return o}return null};return i(n.getStartPosition(),t)},getParentMoveByKnotId:function(e,t){var n=this.getGameJson(e);if(!n)return null;for(var i=0;i<n.moves.length&&n.moves[i].knotId!=t;i++);if(i>=n.moves.length)return null;for(var o=0;o<n.moves.length;o++)if(n.moves[o].children&&n.moves[o].children.contains(i))return n.moves[o];return null},getController:function(t){return e[t]},getGames:function(){return jQuery.extend({},t)},getGamesJson:function(){return jQuery.extend({},n)},getGame:function(e,o){return o?(i[e]||(i[e]={}),i[e][o]||(i[e][o]=new Chess.couchToGame(n[e]),i[e][o].copyId=o),i[e][o]):t[e]},getGameJson:function(e){return n[e]?jQuery.extend({},n[e]):void 0},getViews:function(){return o},getView:function(e){return o[e]},getControllersForView:function(e){return r[e]||[]},decorateController:function(e){var t=new View.Highlight("highlighted");t.link(e)},addGame:function(i,o){t[i]||(n[i]=o,t[i]=new Chess.couchToGame(o),e.main.addGame(i,t[i]),e.main.setCurrentGame(i),o.meta&&o.meta.Fen?e.main.gotoId(i,s(o,o.meta.Fen)):e.main.gotoStart())},init:function(n){if(!this.initialized){if(e.main=new Chess.GameHandler,n&&!jQuery.isArray(n))for(var i in t){e.main.setCurrentGame(i),e.main.gotoStart();break}this.decorateController(e.main),this.initialized=!0}if(n&&!jQuery.isArray(n))for(var i in n)this.addGame(i,n[i])}};return{chessBase:c,create:function(e,t,n){return e=this.parent.create(e,t,n),t&&this.chessBase.init(n.chessGames),e}}}()),"undefined"==typeof Widgets&&(Widgets={}),Widgets.ChessView=Widgets.Chess().extend(function(){var e=function(e){var t=e.extensions.dom.getSelection();if(!t)return null;for(var n=e.extensions.dom.treeToVector(t.commonAncestorContainer.childNodes),i=t.startContainer,o=t.endContainer,r=jQuery("nothing"),a=0;a<n.length;a++)if(n[a]==i){for(;a<n.length&&n[a]!=o;a++){var s=jQuery(n[a]);if(s.is("a")&&s.hasClass("widgetcontainer-inline")){var l=s.data("widget");l&&"chess-jump-to-link"==l.wid&&(r=r.add(s))}}break}return r.length?r:null},t=function(e){var t=e.find("a.jump-to-link");return t.length?t:null};return{linkLinksToWidget:function(n,i,o,r){var a=r?e(n):t(n);if(a){var s=this,l=parseInt(i.data("widget").properties.viewId)||0,c=[];a.each(function(){var e=jQuery(this),t=e.data("widget");c.contains(t.resources[0].reference_id)||(c.push(t.resources[0].reference_id),s.chessBase.separateView(l,[t.resources[0].reference_id])),t.properties.views?t.properties.views.contains(l)||t.properties.views.push(l):t.properties.views=[l],e.attr("data-widget",jQuery.toJSON(t))}),n.trigger("mouseover")}},unlinkLinksFromWidget:function(n,i,o,r){var a=r?e(n):t(n);if(a){var s=parseInt(i.data("widget").properties.viewId)||0;a.each(function(){var e=jQuery(this),t=e.data("widget");if(t.properties.views){var n=t.properties.views.indexOf(s);-1!=n&&(t.properties.views.splice(n,1),e.attr("data-widget",jQuery.toJSON(t)))}})}},remove:function(e,t,n){var i=parseInt(e.data("widget").properties.viewId)||0;this.parent.remove(e,t,n);var o=this.chessBase.getView(i);if(o)for(var r=this.chessBase.getControllersForView(i),a=0;a<r.length;a++)o.unlink(this.chessBase.getController(r[a]));return t.find("a").each(function(){var e=jQuery(this);if(e.is(t.widgetmaskInline)){var n=e.data("widget");if(n&&"chess-jump-to-link"==n.wid&&n.properties.views){var o=n.properties.views.indexOf(i);if(-1!=o){var n=e.data("widget");n.properties.views.splice(o,1),e.attr("data",jQuery.toJSON(n))}}}}),!1},create:function(t,n,i){t=this.parent.create(t,n,i);var o=this,r=parseInt(t.data("widget").properties.viewId)||0;if(n){t.find(".widget-buttons").remove();var a=jQuery("<div/>").addClass("widget-buttons").appendTo(t),s=jQuery("<a/>").html(window.t("link")).append(jQuery("<span/>")).off("click").on("click",function(){o.linkLinksToWidget(n,t,i,!0),t.trigger("mouseover")}),l=jQuery("<a/>").html(window.t("unlink")).append(jQuery("<span/>")).off("click").on("click",function(){o.unlinkLinksFromWidget(n,t,i,!0),o.chessBase.checkSeparatedViews([r],n),t.trigger("mouseover")}),c=jQuery("<a/>").html(window.t("unlink all")).append(jQuery("<span/>")).off("click").on("click",function(){o.unlinkLinksFromWidget(n,t,i,!1),o.chessBase.checkSeparatedViews([r],n),t.trigger("mouseover"),n.find(".view-highlighted").removeClass("view-highlighted")});a.append(s).append(l).append(c),t.on("mouseover",function(){var t=n.extensions.dom.getSelection();if(!t||t.startContainer==t.endContainer&&t.startOffset==t.endOffset){var i=0;n.find(n.widgetmaskInline).each(function(){var e=jQuery(this).data("widget").properties.views;e&&e.contains(r)&&(i++,jQuery(this).addClass("view-highlighted"))}),i>0?(s.hide(),l.hide(),c.find("span").html(" ("+i+")").end().show()):(l.hide(),s.hide(),c.hide())}else{var o=e(n),i=0,d=0,u=0;o&&o.each(function(){var e=jQuery(this).data("widget").properties.views;e&&e.contains(r)?i++:d++,u++}),d>0?s.find("span").html(" ("+d+")").end().show():s.hide(),i>0?l.find("span").html(" ("+i+")").end().show():l.hide(),c.hide()}a.show()}).on("mouseout",function(){n.find(n.widgetmaskInline).filter(".view-highlighted").removeClass("view-highlighted"),a.hide()})}return t}}}()),"undefined"==typeof Widgets&&(Widgets={}),Widgets.Upload=Widgets.Base().extend({multiple:!1,callbacks:{add:function(){},done:function(){},error:function(){},change:function(){},progressall:function(){}},dialog:function(e,t,n,i,o){return e=this.parent.dialog(e,t,n,i,o),e.find("input[type=file]").on("chess24:add",function(e,n){n&&(n.formData=jQuery.extend(n.formData||{},t.config.formData))}).on("chess24:done",function(t,n){n&&e.find("[data-resource-property=reference_id]").val(n.result.data.reference_id)}).on("chess24:error",function(e,n,i,o){n&&t.showToolDialogErrors(jQuery.parseJSON(n.responseText.replace(/&quot;/g,'"')))}),e}}),jQuery(document).ready(function(){function e(){new View.ActivityStream(".communityStream","community").link(notificationHandler);var e=jQuery(".topicDialog").modal({close:!0});jQuery(".postStory").on("click",function(){e.modal("show")})}function n(){var e=jQuery("#ContentTopic_permalink"),t=jQuery("#ContentTopic_title"),n=0==e.val().trim().length;t.on("keyup",function(){n&&setTimeout(function(){e.val(t.val().permalink())},1)}),e.on("change",function(){n=0==e.val().trim().length})}function i(){function e(e){var t=e.target.parentElement.parentElement.id.substring(2);jQuery.post("/communityAdmin/topicDown",{id:t,csrf:config.csrf()},function(e){if(1==e.data.result){var n=jQuery("#tr"+t);n.insertAfter(n.next())}})}function t(e){var t=e.target.parentElement.parentElement.id.substring(2);jQuery.post("/communityAdmin/topicUp",{id:t,csrf:config.csrf()},function(e){if(1==e.data.result){var n=jQuery("#tr"+t);n.insertBefore(n.prev())}})}var n=$(".topicListMoveDown");n.each(function(){var t=jQuery(this);t.off("click").on("click",e)});var i=$(".topicListMoveUp");i.each(function(){var e=jQuery(this);e.off("click").on("click",t)})}function o(e){jQuery("td.online").each(function(){var t=jQuery(this),n=t.parent().find("td.id").text(),i=jQuery("<a/>").append(t.contents()).appendTo(t).on("click",function(){jQuery.getJSON(e+"?story="+n,function(e){i.html(1==e.data.result?"yes":"no")})})})}function r(e){new Controller.LiveVideo(jQuery(".liveVideoContainer"),e)}function a(e){var t=["lobby_en","lobby_de","lobby_es","lobby_fr","lobby_no","lobby_pt","lobby_ru","lobby_tr","lobby_zh","lobby_it","lobby_pl"],n=new RegExp("_"+config.language()),i=t.find(function(e){return n.test(e)})||t[0];chatHandler.addChat(".chatContainer",t,{showSpecialInput:!0,header:e,defaultChatRoom:i})}function s(){new View.GameSessionList("div.gameSessionList div.gridView > table > tbody .nativeScrollInsider > table","div.counterBox.onlineGames > span.counterNumber").link(notificationHandler)}function l(){($("#watchBuyVideoSeriesId").length>0||$("#learnBuyVideoSeriesId").length>0||$("#userBuyVideoSeriesId").length>0)&&jQuery(".buyVideoSeries").addVideoSeriesPurchasePopUp()}function c(){function e(e,t){t.hasClass("premium")&&(e?t.removeClass("premium"):t.children("input").attr("disabled","disabled"))}var t=config.level().isPremium;jQuery(".themeSelector.boards .themeSliderInner div.board").each(function(){e(t,jQuery(this))}),jQuery(".themeSelector.pieces .themeSliderInner div.piece").each(function(){e(t,jQuery(this))})}function d(){function e(e,n){n.hasClass("premium")&&(e||n.on("click",function(){t()}))}function t(e){n||(e&&"function"==typeof e.preventDefault&&e.preventDefault(),jQuery(Dialog.conversionGoPremium("premiumBoards",{returnHTML:!1,logo:!1,featureTable:!1,cancelButton:!1,rootClasses:"popupInsider conversionDialog conversionDialogGoPremium"})))}var n=config.level().isPremium;jQuery(".themeSelector.boards .themeSliderInner div.board").each(function(){e(n,jQuery(this))}),jQuery(".themeSelector.pieces .themeSliderInner div.piece").each(function(){e(n,jQuery(this))}),jQuery("input.premium").on("click",t)}function u(e){var t=$("#chessDatabaseIndexInitObjectId").attr("data");if(t){t=JSON.parse(t);var n=new Controller.ChessDB(".contentContainerInsider",t);e&&n.subscribe(e)}}function h(){jQuery("#metabrowser").val(navigator.appName+" "+navigator.appVersion),jQuery("#metaos").val(navigator.platform)}function p(){new View.OnlineUserList("div.userOnlineList div.gridView > table > tbody .nativeScrollInsider > table","div.counterBox.onlineUsers > span.counterNumber").link(notificationHandler)}function f(e){jQuery("body").addClass(e)}function g(){new View.LessonPages(".lessonPagesViewport",".afterLessonDialog",".lessonContainer header.lessonHeader",".lessonContainer .lessonProgressBar",showSchoolLessonInfo.lessonId,showSchoolLessonInfo.lessonFinished,showSchoolLessonInfo.pageIds,showSchoolLessonInfo.pageStates,"/api/web/SchoolAPI/preloadPages","/api/web/SchoolAPI/setPageState","/api/web/SchoolAPI/finishLesson",showSchoolLessonInfo.coursePermalink)}function m(){new BroadcastConfig.Editor(".broadcastConfigurator")}function v(){new achievementsManager}function y(){function e(){jQuery(".buyVideoSeries").addVideoSeriesPurchasePopUp();var e=$("#targetEloRange .cPatternSlider");e.on("afterstop",function(e,t){var n="level",i=t.values[0]+","+t.values[1],o=window.location.href;o=o.replace(new RegExp(n+"=[^&]*"),"").replace("&&","&").replace(/&$/,"").replace(/\?&?$/,"").replace("?&","?"),i&&(o+=(-1!=o.indexOf("?")?"&":"?")+n+"="+i),jQuery("#targetEloRangeLink").attr("href",o).get(0).click()}),jQuery("#purchasedOnly").click(function(e){var t="purchased",n=this.checked?1:0,i=window.location.href;i=i.replace(new RegExp(t+"=[^&]*"),"").replace("&&","&").replace(/&$/,"").replace(/\?&?$/,"").replace("?&","?"),i+=(-1!=i.indexOf("?")?"&":"?")+t+"="+n,jQuery("#priceCategoryLink").attr("href",i).get(0).click()}),layout("#learnOverview"),layout.oneTime.colorHeader(),jQuery(".rangeSliderContainer").styleRangeSlider()}e()}function w(e){chatHandler.addChat(".chatContainer",[e],{showSpecialInput:!0,autoscroll:!0,getMessagesLimit:50})}function b(){jQuery("#videoHolder").videoDisplay(showVideoSeriesInfo.video_series,showVideoSeriesInfo.videoUrls,showVideoSeriesInfo.videoImageUrls,showVideoSeriesInfo.securityCode),jQuery("#videoHolder").one("videoDisplayInitialized",function(e,t){var n=jQuery("#videoHolder").data("chessGameHandler"),i=new View.ChessDBMovesWithSelector("#databaseMovesTable").link(n),o=new View.ChessDBGames("#databaseGamesTable").link(n);new View.VideoExercises("#exercisesTab",t.exerciseGroups,t.videoApi,t.timeline,"#exerciseTabBtn","#afterVideoDialog",showVideoSeriesInfo.promoteSeries,".promoToBuyAfterPreview").link(n);var r=new View.EngineGroup("#videoEngineContent").link(n);jQuery("#videoTabDatabaseMoves").suspendResume(i),jQuery("#videoTabDatabaseGames").suspendResume(o),jQuery("#videoTabEngine").suspendResume(r),jQuery(".buyVideoSeries").addVideoSeriesPurchasePopUp()})}function C(e){var t=jQuery("#player1"),n=jQuery("#player2"),i=t.next(".selectBox-dropdown"),o=n.next(".selectBox-dropdown");jQuery("#compare").on("click",function(){var r=e,a=t.find(":selected").val(),s=n.find(":selected").val();return a.length?s.length?(r=r.replace("player1",a),r=r.replace("player2",s),void(window.location.href=r)):(o.addClass("inputError"),void n.on("change",function(){o.removeClass("inputError")})):(i.addClass("inputError"),void t.one("change",function(){i.removeClass("inputError")}))})}function k(){jQuery(".eventConditionSelector").eventConditionSelector()}function F(){jQuery(".translationTableWrapper").translationTable()}function x(e){missionBadgeManager(e)}function T(e){function t(t){if(t.origin===n){var i=t.data.substring((n+"/hc/"+e.langZendesk).length),o="/"+e.lang+"/faq"+i;window.history.pushState("","",o)}}if(e){e=JSON.parse(e);var n=e.ORIGIN;window.addEventListener("message",t)}}function _(){var e=jQuery(".container--video");e.flowplayer({playlist:[[{webm:e.data("webm"),mp4:e.data("mp4")}]],embed:!1,poster:e.data("poster"),keyboard:!1}),e.flowplayerErrorHandler()}function E(e){var t=e.attr("id");if("undefined"!=typeof editContentInfoObject){var n=editContentInfoObject["editContentInfo_"+t];n&&setTimeout(function(){$(".editor[data-cid="+n.formData.cid+"]").editor({input:jQuery(n.input),extensions:n.extensions,uploadUrl:n.uploadUrl,validateWidgetUrl:n.validateWidgetUrl,metaUploadUrl:n.metaUploadUrl,metaCropUrl:n.metaCropUrl,extraClass:n.extraClass,language:n.language,maxLength:n.maxLength,watermark:n.watermark,formData:n.formData,height:n.height,scrollToolbar:n.scrollToolbar,localBackup:n.localBackup,widgetsLayout:n.widgetsLayout,widgets:n.widgets,inlineWidgets:n.inlineWidgets,chessGames:n.chessGames})},10)}}function S(e){e=e||$(document),$.each(e,function(e,t){var n=$(t).find(".editContentId");E(n)})}function j(e){var t=e.attr("id");if(!V.contains(t)){var n=e.find("#viewContentChessgameId_"+t);if(n.length>0&&"undefined"!=typeof viewContentChessgameObject){var i=viewContentChessgameObject["viewContentChessgame_"+t];if(i){var o=i.chessGames;o&&Widgets.ChessView().chessBase.init(o)}}var r=e.find("#viewContentCid_"+t);if(r.length>0){var a=r.attr("data");return initGoogleMaps(),Widgets.Base().setup(".couch-content[data-cid="+a+"]"),V.push(t),!0}}return!1}function I(e){e=e||$(document);var t=!1;return $.each(e,function(e,n){var i=$(n).find(".viewContentInfoId");j(i)&&(t=!0)}),t}function A(e){function t(){r.on("movedPositionPointer.current",i),a.movementHandler.isActive()||a.movementHandler.activate()}function n(){r.off("movedPositionPointer.current",i),setTimeout(function(){a.movementHandler.isActive()&&a.movementHandler.deactivate()})}function i(e,t){var i=r.getCurrentPosition().getSan();jQuery(".userMove").val(i),s.removeClass("disabled"),l.removeClass("disabled"),n()}var o=e,r=new Chess.Game({fen:o}),a=new View.ChessBoard(jQuery(".puzzleBoard"),!0).link(r),s=jQuery(".cBtnFlexi.undo"),l=jQuery(".cBtnFlexi.submit"),c=jQuery(".cBtnFlexi.register");r.getCurrentPosition().moveRight===Chess.colors.white.letter?jQuery(".BWmove.white").show():(jQuery(".BWmove.black").show(),a.flip()),config.level().isGuest?(jQuery(".loggedOff").show(),n()):(jQuery(".loggedIn").show(),t()),s.on("click",function(){return s.is(".disabled")?!1:(r.deleteMove(void 0,!0),t(),s.addClass("disabled"),void l.addClass("disabled"))}),l.on("click",function(){l.is(".disabled")||(jQuery("form.puzzle .csrf").val(config.csrf()),jQuery("form.puzzle .fen").val(o),jQuery("form.puzzle").submit())}),c.on("click",function(){jQuery(".register-link:first").trigger("click")})}function O(){jQuery(".validatable").validatable()}function M(e){var n=$("form.easterForm");n.on("submit",function(n){n.preventDefault(),setTimeout(function(){$(".field-errors:visible").length<=0&&jQuery.post("/api/web/NewsletterAPI/subscribe",{email:$("#campagneEmailId").val(),channel:e,csrf:config.csrf()}).success(function(){$(".easterFormContainer").fadeOut(500,function(){$(".newsletter .message").html(t("Email was successfully sent")).parent().parent().removeClass("error").addClass("success").fadeIn()})}).error(function(e){var t=JSON.parse(e.responseText),n=t.errors.error[0];$(".newsletter .message").html(n).parent().parent().removeClass("success").addClass("error").show()})})})}function P(e){jQuery.post("/Campaign/easterEgg",{channel:e,csrf:config.csrf()}).then(function(e){if($(".easterMessageContainer .message").parent().parent().removeClass("error").addClass("success").fadeIn(),e&&e.data){const t=e.data;if(!t.isActive)return void $("#campaignOverId").show();$("#easterEggBadgeCampagneId").show(),!t.isPremium&&t.voucherCode&&($("#easterVoucherId").show(),$("#easterVoucherCodeId").show().html("<b>"+t.voucherCode+"</b>"),$("#easterVoucherReductionId").show().html("<b>"+t.voucherReduction+"</b>")),$("#easterBadgeId").show(),t.iconPath&&$(".easterMessageContainer img").show().attr("src",t.iconPath)}})["catch"](function(e){var t=JSON.parse(e.responseText),n=t.errors.error[0];$(".easterMessageContainer .message").html(n).parent().parent().removeClass("success").addClass("error").show()})}function B(){function e(){window.settings.clearLocalStorage()}jQuery(".linkLogout").off("click",e).on("click",e)}function R(e){$.staticTrackingCookie(e)}function L(e){config.consent().hasSocialMediaConsent&&(!function(e,t,n){var i,o=e.getElementsByTagName(t)[0],r=/^http:/.test(e.location)?"http":"https";e.getElementById(n)||(i=e.createElement(t),i.id=n,i.src=r+"://platform.twitter.com/widgets.js",o.parentNode.insertBefore(i,o))}(document,"script","twitter-wjs"),$(this).parent().show())}function N(e){config.consent().hasSocialMediaConsent&&($(this).find(".quickyTitle").css("display","block"),$(this).find(".facebook").css("display","inline-block"),$(this).find(".twitter").css("display","inline-block"),$(this).find(".google").css("display","inline-block"))}function D(e){config.level().isLabTester&&$(this).show()}function Q(){$(".formatLocalTime").each(function(){try{var e=$(this),t={weekday:"short",hour:"2-digit",minute:"2-digit",day:"2-digit",month:"2-digit",year:"numeric"},n=new Intl.DateTimeFormat("lookup",t),i=e.attr("timestamp");e.html(n.format(new Date(1e3*i)))}catch(o){}})}function H(){window.notificationHandler.on("channel:ng_game_start",function(e,t){window.open(t.content.gameUrl)})}function G(e,t){var n=new Helper.Deferred;if(!t)return n.reject(new Error("No selector set.")),n.promise;var i=$(t);return 0===i.length?(n.reject(new Error("No elements found for selector.")),n.promise):(i.each(function(t,n){e.call(n,$(n).attr("data"))}),n.resolve(),n.promise)}var V=[];G(e,"#loadCommunityId"),G(n,"#editTopicId"),G(i,"#listTopicId"),G(o,"#listStoryId"),G(r,"#listLiveVideoId"),G(a,"#playChatId"),G(s,"#watchGameSessionsId"),G(c,"#profileSettingsThemesId"),G(d,"#profilePremiumId"),G(loadTopTournamentPage,"#topTournamentPageId"),G(u,"#chessDatabaseIndexId"),G(h,"#contactBrowserInfoId"),G(p,"#onlineUsersId"),G(f,"#listLiveTournamentId"),G(g,"#schoolLessonId"),G(m,"#broadcastConfigIndexId"),G(v,"#loadAchievementsId"),G(y,"#listVideoSeriesId"),G(w,"#chatShowRoomId"),G(b,"#showVideoSeriesId"),G(C,"#headToHeadId"),G(k,"#eventConditionSelectorId"),G(F,"#translationTableId"),G(x,"#missionBadgeId"),G(T,"#siteFaqFrameId"),G(_,"#siteIndexId"),G(A,"#usChampionshipPuzlleFenId"),G(M,"#campagneSubmitId"),G(P,"#easterEggBadgeCampagneId"),G(R,"#landingPageUserTrackingId"),
G(L,".twitterWidget"),G(N,".globalSharing"),G(Controller.LandingPage.Play.renderChessBoard,"#landingChessBoard"),G(Controller.LandingPage.Broadcast.renderActive,"#activeTournamentsList"),G(Controller.LandingPage.Broadcast.renderAll,"#allTournamentsList"),G(Controller.LandingPage.News.load,"#landingNews"),G(Controller.LandingPage.News.loadBackgroundImages,"#newsImages"),G(Controller.FraudReports.addOnTdClick,"#fraud-reports-grid"),G(Controller.FraudReports.addOnGameCheckboxClick,"#batchGameContainer"),G(Q,"#fraudReportContainer"),G(D,"#labSectionId"),G(Handler.Choker.reviewSettings,"#labSection"),G(Handler.Choker.load,"#gameContainer"),G(Handler.DashboardRevision.load,"#dashboardRevision"),l(),S(),I(),O(),B(),window.settings.on("loaded",function(){reviewEmailSettings()}),H(),loadAdvertisement(),$.fn.initFilters=function(){y()},$.renderEditorContent=function(e){S(e)},$.renderContentChessGame=function(e){return I(e)}});var EMAIL_SETTINGS_REVIEW_CYCLE=72576e5,nextMilleniumLoaded=!1,googleDFPLoaded=!1,snigelLoaded=!1,snhb=snhb||{},googletag=googletag||window.googletag||{cmd:[]},snigelAuctionRequested=[],dfpAdRequested=[];jQuery(document).on("onLoadAdvertisement",function(){loadAdvertisement()}),jQuery(document).on("loadFallbackAdvertisement",function(e,t){}),jQuery(document).on("onCommentsLoaded",function(){function e(){var e=jQuery(".commentContent");$.renderContentChessGame(e),$.renderEditorContent(e)}e()}),jQuery(document).on("onLessonPageLoaded",function(e){function t(){var t=$(e.target);"undefined"!=typeof $.renderContentChessGame&&"undefined"!=typeof $.renderEditorContent&&$.renderContentChessGame(t)}t()}),jQuery(document).on("missingSettingsConsent",function(e,t,n){Dialog.confirmation({content:window.t("Data consent required"),comment:window.t("We respect your privacy and data protection guidelines. In order to use this feature you need to enable the storage of settings such as personally chosen themes and options. Would you like to do so?")},function(){$("#data-consent-form").find("input[name='DataConsentForm[hasSettingsConsent]']").trigger("click"),function e(i){return config.consent().hasSettingsConsent?void window.settings.save(t,n):void(i>10||setTimeout(e,200,++i))}(0)})}),jQuery(document).on("freeServiceActivity",function(e,t,n){return config.consent().hasMarketingConsent?config.consent().hasPerformanceConsent?void 0:void Dialog.confirmation({content:window.t("Missing Statistics Consent"),comment:window.t("We would be pleased to invite you enabling statistics tracking, so that we can improve functionality based on the usage.")},function(){$("#data-consent-form").find("input[name='DataConsentForm[hasPerformanceConsent]']").trigger("click")}):void Dialog.confirmation({content:window.t("Missing Marketing Consent"),comment:window.t("You're using a free service. Please give us the chance to cover a part of the costs by accepting personalized 3rd party advertisements.")},function(){$("#data-consent-form").find("input[name='DataConsentForm[hasMarketingConsent]']").trigger("click")})}),jQuery(document).ready(function(){Controller.Broadcast.onReady=function(){var e=jQuery(".liveTournamentContainer");if(e.length){var t={},n=!!e.data("embed"),i=e.data("round"),o=e.data("match"),r=e.data("game"),a=e.data("c24"),s=e.data("customer"),l=e.data("overrides"),c=e.data("board-theme"),d=""+e.data("tournament");d&&(d=d.split("|"));var u=(window.location.hash||"").replace("#","");d&&(t.startWith=d[0]),(n&&d||d&&!u&&!i)&&(t.exactList=d);var h=new Controller.Broadcast(e,{tournamentIds:t,roundId:i,embedded:n,c24:a,overrides:l,customer:s,boardTheme:c});if(window.adngin&&window.adngin.adnginLoaderReady&&adngin.queue.push(function(){adngin.cmd.startAuction(["broadcast_evaluation_leader"])}),e.is(".dualDisplay")){var p=e.data("id1"),f=e.data("id2");h.setSpecialMode("dual",{id1:p,id2:f}),t&&t.startWith&&i&&o&&r&&h.showGameWhenReady(t.startWith,i,o,r)}else e.is(".singleDisplay")?(h.setSpecialMode("single"),t.startWith&&(i&&o&&r||"live"===u?h.showGameWhenReady(t.startWith,i,o,r):"play"===u&&h.showOwnGame(t.startWith))):e.is(".multiBoardOnly")?h.setSpecialMode("multiBoardOnly"):t&&t.startWith&&(i&&o&&r||"live"===u?h.showGameWhenReady(t.startWith,i,o,r):"play"===u&&h.showOwnGame(t.startWith))}},Controller.Broadcast.onReady()}),"undefined"==typeof Handler&&(Handler={}),Handler.Choker={},Handler.Choker.load=function(){jQuery.when(jQuery.getScript("/choker/Build/UnityLoader.js"),jQuery.getScript("/choker/TemplateData/UnityProgress.js"),jQuery.getScript("/choker/xsolla.js")).then(function(e,t,n){var i=UnityLoader.instantiate("gameContainer","/choker/Build/Choker.json",{onProgress:UnityProgress});window.SendMessageToCs=function(e,t,n){i.SendMessage(e,t,n)}})["catch"](function(e){console.log("Could not load "+this.url+": "+e.statusText)})},Handler.Choker.reviewSettings=function(){jQuery(".chokerLink").on("click",function(e){e.preventDefault();var t=$(this).data("target");return settings.getBoolean("chokerEnabled")?void(document.location.href=t):void Dialog.ChokerConsent(t)})},jQuery(document).ready(loadComments).on("chess24:comments",loadComments),jQuery(document).ready(function(){!function(){function e(){n.hide(),jQuery(".communityPreviewBar").hide(),t.css("height",""),t.find("form").removeClass("inactive"),jQuery(window).off("scroll.preview")}var t=jQuery(".community_edit .storyForm");if(t.length){var n=jQuery(".communityPreview");jQuery(".cFormButtons .preview").on("click",function(){var e=jQuery('[name*="teaser_image_couch_id"]').val();n.find("h1").html(jQuery("#ContentGroup_title").val()),n.find(".couch-content").html(t.find(".editor").editor("html")),e?jQuery.getJSON("/api/web/contentWidgetAPI/getImageUrl?id="+e,function(e){n.find(".previewImage").attr("src",e.data.url).show()}):n.find(".previewImage").hide(),t.find("form").addClass("inactive"),jQuery("html, body").animate({scrollTop:0}),jQuery(".communityPreviewBar").appendTo("body").show(),n.show(),Widgets.Base().setup(n);var i=parseInt(n.css("padding-top"),10)+parseInt(n.css("padding-bottom"),10);n.outerHeight()<t.outerHeight()-i?n.css("height",t.outerHeight()-i+"px"):t.css("height",n.outerHeight()+"px")}),jQuery(".communityPreviewBar .goBack").on("click",e),jQuery(".communityPreviewBar .publish").on("click",function(){t.find("form").submit()}),t.find("form").on("validatable:error",e),jQuery("#ContentGroup_teaser_image_couch_id").on("chess24:error",function(e,t){jQuery(this).closest("dt").next("dd").find("span").addClass("error")}).on("chess24:done chess24:add",function(){jQuery(this).closest("dt").next("dd").find("span").removeClass("error")})}}(),function(){jQuery(".communityPopularList, .communityFeaturedTopics, .communityTopics").find(".ribbonSizeM a").on("click",function(){Dialog.conversionGoPremium("communityTopic")})}(),function(){var e=jQuery(".community_topic .topicStoriesList table tbody");e.lazyload({url:location.href,selector:"tr",offset:e.find("tr").length,onload:function(t){e.append(jQuery(t.data.html))}})}(),function(){jQuery(".community_show .storyControls .delete").on("click",function(){var e=jQuery(this),t=e.attr("href");return Dialog.confirmation(e.data("prompt"),function(){window.location=t}),!1})}(),function(){jQuery(".communityLanguagePicker").on("change",function(){var e=jQuery(this).val(),t=window.location.href.replace(/\?.*/,"");window.location=t+(e?"?language="+e:"")})}(),function(){jQuery(".forceSingleLineTrigger").each(function(){var e=jQuery(this),t=e.parent("p");t.height()>24?(e.insertAfter(t.addClass("forceSingleLine")).show(),jQuery(this).data("p",t)):e.remove()}).on("click",function(){var e=jQuery(this),t=e.data("p");if(t&&t.length){var n=e.data("altText");e.data("alt-text",e.html()).html(n),t.is(".forceSingleLine")?e.appendTo(t).before(" "):e.insertAfter(t),t.toggleClass("forceSingleLine")}})}()}),jQuery(document).ready(function(){var e=jQuery("#ContentGroup_permalink"),t=jQuery("#ContentGroup_title");if(e.length&&t.length){var n=0==e.val().trim().length;t.on("keyup",function(){n&&setTimeout(function(){e.val(t.val().permalink())},1)}),e.on("change",function(){n=0==e.val().trim().length})}var i=jQuery("#ContentGroup_teaser_image_couch_id, #ContentTopic_image_couch_id");if(i.length){var o,r,a=i.closest("dl"),s=a.siblings(".preview"),l=s.find(".empty"),c=s.find("input"),d=s.find("img");setTimeout(function(){o=a.find("input[type=hidden]").val(),r=d.attr("src"),c.add(c.parent()).add(d)[r?"show":"hide"](),l[d.attr("src")?"hide":"show"]()},100),c.on("click",function(){a.find("input[type=hidden]").val(""),a.find(".fileUploadDetails span").click(),d.hide().attr("src","about:blank"),c.add(c.parent()).hide(),l.show(),o=void 0}),i.on("chess24:done",function(e,t){if(i.is(".scale")){var n=jQuery(".editor-meta-thumbnail");n.length||(n=jQuery("<div/>").addClass("editor-meta-thumbnail").appendTo("body").css("padding","10px"));var o=jQuery("<img/>").attr("src",t.result.data.reference_url);n.html("").append(o).modal().modal("show").on("chess24:hide",function(){o.thumbnail("hide")}),o.on("load",function(){n.modal("show");var e=jQuery("#upload-width").val(),r=jQuery("#upload-height").val();o.thumbnail({width:parseInt(e,10),height:parseInt(r,10),scale:"save-ratio",callback:function(o,s,u,h){var p={csrf:config.csrf(),image:t.result.data.reference_id,left:Math.round(o),top:Math.round(s),width:Math.round(u),height:Math.round(h),sourcewidth:e,sourceheight:r};jQuery.post("/api/web/ContentWidgetAPI/cropMetaImage",p,function(e){0==e.status&&(n.modal("hide"),d.length||(d=jQuery("<img/>").insertBefore(c.parent())),d.attr("src",e.data.url).show(),c.add(c.parent()).show(),i=a.find("input[type=file]"),l.hide())})}})})}else d.length||(d=jQuery("<img/>").insertBefore(c.parent())),d.attr("src",t.result.data.reference_url).show(),c.add(c.parent()).show(),i=a.find("input[type=file]"),l.hide()}),i.on("chess24:cancel",function(e){o?(a.find("input[type=hidden]").val(o),d.attr("src",r)):(a.find("input[type=hidden]").val(""),d.attr("src","about:blank").hide(),c.add(c.parent()).hide(),l.show()),i=a.find("input[type=file]")})}var u=jQuery(".confirm-delete");u.length&&u.on("click",function(){jQuery(this);return confirm("Do you really want ro delete this item?")?void 0:!1});var h=jQuery("#insert-teaser");h.length&&h.on("click",function(){var e=jQuery(this),t={csrf:config.csrf()};return t.ccid=e.data("api-url").replace(/.*ccid=(.+)/,"$1"),!jQuery("textarea.teaser-text-target").val()||confirm("Override the current teasertext with text from content?")?(jQuery.post(e.data("api-url"),t,function(e){0===e.status&&jQuery(".teaser-text-target").val(e.data.text)}),!1):void 0});var p=jQuery(".headToHead .selectAnother select");p.length&&p.on("change",function(){var e=jQuery(this),t=e.closest(".player.one").length?"left":"right",n=e.val(),i=jQuery(".player"+("left"==t?".one":".two")),o=jQuery(".comparison ."+t),r=window.location.pathname.split("/")[1],a={permalink:n,lang:r,csrf:config.csrf()};jQuery.post("/api/web/biographyAPI/playerDetails",a,function(e){if(0==e.status){var t=e.data.player;i.find("img").attr("src",t.image),i.find(".name a").html(t.name),i.find(".title").html(t.title),i.find(".rank").html(parseInt(t.rank)||"-"),i.find(".rating").html(t.rating||"-"),i.find(".federation").html(t.federation+' <span class="icoFlag flag3-'+t.federationiso3+'"></span>'),i.find(".link").attr("href",t.url),o.filter(".age").html(t.age+(t.death?" ("+window.t("d. ")+t.death+")":" ("+window.t("b. ")+t.birth+")")),o.filter(".birthplace").html(t.birthplace||"-"),o.filter(".federation").html(t.federation),o.filter(".peak").html(t.peak?t.peak+" ("+t.peakdate+")":"-"),o.filter(".blitz").html(t.blitz||"-"),o.filter(".rapid").html(t.rapid||"-")}})});var f=jQuery(".bodyContainer");if(f.is(".news_view, .tromso2014_view")&&jQuery(".newsMeta .arrow").shareButtons({noLabel:!0,facebook:!0,twitter:jQuery(".oneNews h1").text(),google:!1,mail:!1,embed:!1}),f.is(".news, .tromso2014_home, .tromso2014_dashboard, .user_dashboard")&&jQuery(".topNewsHeadline .arrow, .topNews .arrow, .allNews .arrow, .dashboardTopNews .arrow").each(function(){jQuery(this).shareButtons({noLabel:!0,url:jQuery(this).closest(".newsMeta").parent().find("> a, h3 a").attr("href"),facebook:!0,twitter:jQuery(this).closest(".newsMeta").parent().find("h3, .newsInfo a").text(),google:!1,mail:!1,embed:!1})}),f.is(".news_edit")){var g=f.find(".editor");g.length&&setTimeout(function(){g.on("change",function(e,t){t||window.onbeforeunload||(window.onbeforeunload=function(){return"Are you sure you want to leave this page? There are unsaved changed in the editor."},jQuery(".cFormButtons input").on("click",function(){window.onbeforeunload=void 0}))})},1e4)}}),jQuery(function(){function e(){jQuery(".tacticsTrainerSlider").each(function(){var e=jQuery(this);e.find("> div:first").fadeOut(1e3).next().fadeIn(1e3).end().appendTo(e)})}function t(e,t,n,i,o,r){var a=o?"lang="+config.language():"";a+=r||"",$.ajax({url:"/api/web/UserAPI/"+e,type:"GET",data:a,dataType:"json"}).done(function(e){e&&0===e.status&&e.data&&t(e.data)}).fail(function(e){errorHandler.error("error getting "+n+" info: "+e.statusText,{},!1)}).always(function(){i&&i()})}if(jQuery(".dashboardTileAchievements .profileBadgeIcon").length>0){var n=jQuery("<div>",{id:"achievementsBubble"}).append(jQuery("<h3>",{id:"bubbleTitle"}).html("&nbsp;")).append(jQuery("<p>",{id:"bubbleDescription"}).html("&nbsp;"));jQuery("body").append(n),n.bubble({side:"bottom",point:"precise",flexible:!0,noanimation:!0}),jQuery(".dashboardTileAchievements .profileBadgeIcon").on("mouseover",function(){var e=jQuery(this);n.bubble("hide"),setTimeout(function(){n.find("#bubbleTitle").html(e.data("title")),n.find("#bubbleDescription").html(e.data("description")),n.show().bubble("realign",e).bubble("show")},1)}),jQuery(".dashboardTileAchievements .profileBadgeIcon").on("mouseout",function(){n.bubble("hide")})}if(1==jQuery("#latestGameBoardContainer").length){var i=jQuery("#latestGameBoardContainer").data("fen"),o=new Chess.Game(i?{fen:i}:void 0).setNoTimeout(!0);new View.ChessBoard("#latestGameBoardContainer").link(o),jQuery(".dashboardTileGame .playNowLink").off("click").on("click",function(){Controller.getPlayZone().playNow()})}if(jQuery(".tacticsTrainerSlider").length>0){jQuery(".dashboardTileGame .board.latestPuzzle").each(function(){var e=jQuery(this),t=e.data("fen"),n=new Chess.Game(t?{fen:t}:void 0);new View.ChessBoard(e).link(n)});var r=setInterval(e,4e3);jQuery(".tacticsTrainerSlider").hover(function(e){clearInterval(r)},function(t){r=setInterval(e,4e3)})}jQuery(".playBtn").on("click",function(){Controller.getPlayZone().playNow()});var a=new Handler.Template("dashboard");(function(){function e(e){$stats=jQuery(a.render("_dashboard_user_stats",{username:e.username,isPremiumWelcomeMessage:e.isPremiumWelcomeMessage,bulletInfo:e.bulletInfo,blitzInfo:e.blitzInfo,classicalInfo:e.classicalInfo,allGames:e.allGames,wins:e.wins,losses:e.losses,draws:e.draws,badgesInfo:e.badgesInfo})),n.append($stats),n.off("click",".playBtn").on("click",".playBtn",function(){Controller.getPlayZone().playNow()})}var n=$(".dashboardUserStatsContainer");if(0!=n.length)if(config.level().isGuest){var i=$(".pageSidebar").css("margin-top");$(".pageSidebar").css({"margin-top":"-1px"}),n.hide(function(){$(".pageSidebar").css({"margin-top":i})})}else{n.show();var o=config.user().uuid+"dashboardUserStatistics",r=new Helper.Cache(6e5),s=r.get(o);s&&e(s),t("getUserStatistics",e,"user statistics")}})(),function(){function e(e){var t=$(a.render("LatestNewsWidget",{topNews:e.latestNewsInfo.topNews,news:e.latestNewsInfo.news}));n.replaceWith(t)}var n=$(".userContentLatestNews");if(0!=n.length){var i=new Date;t("getLatestNews",e,"latest news",null,!0,"&offset="+i.getTimezoneOffset())}}(),function(){function e(){function e(e){function t(){var t=$(".userContentLiveEvents");s(t,10,e.items,e.liveVideo,!0,!0,!1)}function n(){var t=$(".mainMenuLiveEvents");s(t,10,e.items,"",!1,!0,!1)}function i(){var t=$(".sidebarLiveEvents");s(t,10,e.items,"",!1,!0,!1)}function o(){var t=$(".urlWatchLiveEvents");s(t,15,e.items,"",!1,!1,!1)}function r(){var t=$(".urlEventsLiveEvents");s(t,100,e.items,"",!1,!1,!0)}function s(e,t,n,i,o,r,s){if(n.length>=t&&(n=n.slice(0,t)),0!=e.length){var l=$(a.render("LiveEventsWidget",{items:n,liveVideo:i,title:o,footer:r,eventsTitle:s}));e.replaceWith(l),l.trigger("newhtml")}}t(),n(),i(),o(),r()}t("getLiveEvents",e,"live events",null,!0,"&maxItems=100")}e()}(),function(){function e(){function e(e){var t=$(a.render("PlaynowWidget",{}));i.replaceWith(t),new View.PlayButton("li.playButton",e.data).link(notificationHandler)}var i=$(".sidebarPlaynow");0!=i.length&&t("getSidebarPlaynow",e,"play now button",n)}function n(){function e(e){var t=$(a.render("ChallengesWidget",{incomingMessagesNumber:e.incomingMessagesNumber,outgoingMessagesNumber:e.outgoingMessagesNumber,unseenMessagesNumber:e.unseenMessagesNumber}));n.replaceWith(t)}if(config.level().isGuest)o();else{var n=$(".sidebarChallenge");0!=n.length&&t("getSidebarChallenge",e,"challenge",i)}}function i(){function e(e){var t="0"===e.incomingMessagesNumber?"":e.incomingMessagesNumber,i=$(a.render("MyFriendsWidget",{incomingMessagesNumber:t,urlToProfile:e.urlToProfile}));n.replaceWith(i)}if(!config.level().isGuest){var n=$(".sidebarMyFriends");0!=n.length&&t("getSidebarMyFriends",e,"my friends",o)}}function o(){function e(e){t(),e.addClass("active"),e.find(".sidebarMenuContent").show(),$(document).on(o,n)}function t(){i.find("> ul > li").removeClass("active"),i.find(".sidebarMenuContent").hide(),$(document).off(o,n)}function n(e){i.is(e.target)||i.has(e.target).length||t()}var i=$("nav.sidebarMenu"),o="mouseup.closeSidebar";i.find("> ul > li > a").not(".playNowLink, .customLink").on("click",function(){var n=$(this).closest("li");return n.hasClass("active")?void t():void e(n)});var a=i.find(".challenges");if(a.length){var s=i.find(".navChallengeAccepted");new View.Challenge(a,s).link(notificationHandler)}var l=i.find(".myFriends");l.length&&(new View.FriendshipButton("csrf",config.csrf()),new View.FriendshipSidebar),r()}function r(){function e(){"-1px"!==t.css("margin-top")?t.stick_in_parent({offset_top:77,spacer:".sidebarWrapper",parent:".pageWrap"}):t.trigger("sticky_kit:detach")}var t=$(".pageSidebar");$(window).resize(e),e(),$(".contentContainer").resize(function(){t.trigger("sticky_kit:recalc")})}e()}(),function(){function e(e){var t=config.level(),i=(config.language(),e.html);i&&(t.isGuest?i=i.guest:t.isPremium?i=i.premium:t.isRegistered&&(i=i.registered));var o=$(a.render("ConversionCustomWidget",{html:i}));n.replaceWith(o),o.trigger("newhtml"),new View.ConversionSidebar("#customSidebarWidget").link(notificationHandler)}var n=$(".sidebarConversionWidget");0!=n.length&&t("getSidebarCustomWidget",e,"sidebar conversion widget",null,!0)}(),function(){function e(){var e=config.level(),n=$(a.render("AdminWidget",{showAdmin:e.isAdmin||e.isTournamentOrganiser||e.isEditor||e.isFraudAgent||e.isModerator,showReadCreate:e.isAdmin||e.isEditor,showBroadcastConfig:e.isAdmin||e.isTournamentOrganiser,showAdministrationLinks:e.isAdmin,showFraudReports:e.isAdmin||e.isFraudAgent,showChatAdmin:e.isAdmin||e.isModerator}));t.replaceWith(n)}var t=$(".sidebarAdmin");0!=t.length&&e()}(),function(){function e(){function e(){function e(e){var t=$(a.render("_user_content_top_players",{}));n.replaceWith(t),n=$(".topPlayers");var i=new Handler.Template("lobby"),o=$(i.render("topPlayers",{players:e.topPlayers})),r=n.find(".topPlayersContent");r.append(o);var s=$("div.topPlayers .topPlayersContent");$(".userDashboard").length>0&&s.length>0&&new View.TopActivePlayers(s,$("div.topPlayers .playzoneStreamGameTypes li")).link(notificationHandler)}var n=$(".topPlayers");t("getTopPlayers",e,"content")}function i(){function e(e){var t=$(a.render("_user_content_top_games",{}));n.replaceWith(t);var i=Controller.getPlayZone(),o=e.topGamesOptions,r={gameSessionToken:o.gameSessionToken,authToken:o.authToken,role:o.role,mode:o.gameSessionToken?o.gameSessionIsRunning?"human":"analysis":"standby",chessGame:o.chessGame,stream:o.stream,playingServer:{host:o.host,port:o.port},container:o.container,template:o.template,nonExclusiveView:o.nonExclusiveView};i.initGameSession(r)}var n=$(".topGames");t("getTopGames",e,"content")}var o=$(a.render("_user_content_section_play",{}));n.append(o),i(),e()}var n=$(".userContentGamesPlayers");0!=n.length&&e()}(),function(){function e(e){var t=$(a.render("LatestVideosWidget",{videos:e.videos}));n.replaceWith(t),jQuery(".buyVideoSeries").addVideoSeriesPurchasePopUp()}var n=$(".userContentLatestVideos");0!=n.length&&t("getLatestVideos",e,"latest videos",null,!0)}(),function(){function e(e){n.attr("href",e.permalink)}var n=$("#footerReferralsPermalink");0!=n.length&&t("getFooterReferralsPermalink",e,"Referrals Permalink",null,!0)}(),function(){function e(e){var t=$(a.render("ConversionGetPremiumWidget",{premiumUrl:e.premiumUrl,top:e.top}));i.replaceWith(t)}var n=config.level();if(!n.isGuest&&!n.isPremium){var i=$(".conversionPremiumWidget");0!=i.length&&t("getConversionPremiumWidget",e,"premium widget",null,!0)}}(),function(){function e(){var e=[];e.push({bulletText:"Unlimited games & more! Free"}),e.push({bulletText:"Quick & easy"}),e.push({bulletText:"A no-brainer"});var t=$(a.render("ConversionBecomeMemberWidget",{bulletPoints:e}));n.replaceWith(t)}var t=config.level();if(t.isGuest){var n=$(".conversionBecomeMemberWidget");0!=n.length&&e()}}(),function(){function e(e){n.switchClass(t,e)}var t="sUserLevelCSS",n=$("."+t);if(0!=n.length){var i="userIsGuest";config.level().isGuest||(i="userIsRegistered",config.level().isPremium&&(i+=" userIsPremium")),e(i)}}(),function(){var e=$(".dashboardAdvert");0!=e.length&&config.level().isGuest}(),function(){function e(e){var t=$(a.render("_playnow_shortcuts",{}));n.replaceWith(t),new View.PlayShortcuts(".playnowShortcuts",e.active).link(notificationHandler)}var n=$(".dashboardPlayShortcuts");0!=n.length&&t("getPlayShortcuts",e,"play shortcuts",null,!0)}()}),"undefined"==typeof Handler&&(Handler={}),Handler.DashboardRevision={},Handler.DashboardRevision.load=function(){var e=new Handler.Template("dashboardRev"),t="https://chess24.com",n=$("#language").attr("data-language");$.getJSON(t+"/api/web/UserAPI/GetLatestNews",{lang:n}).done(function(t){var n=t.data.latestNewsInfo.news;n.forEach(function(e){e.publish_start=new Date(1e3*e.publish_start).toLocaleDateString(),e.teaser_image_url=e.teaser_image_url.replace("170x108","600x380")}),$("#rev_dashboard_news").html(e.render("latestNews",{news:n})),$(".update-item").html(e.render("topNews",{item:t.data.latestNewsInfo.topNews}))}),$.getJSON(t+"/api/web/UserAPI/GetDashboardHighlight",{lang:n}).done(function(t){var n=t.data.data.pop();n&&(n.start_at=new Date(1e3*n.start_at).toLocaleDateString()),$("#w-highlight").html(e.render("highlight",{highlight:n}))}),$.getJSON(t+"/api/web/UserAPI/GetFeaturedLiveEvents",{lang:n}).done(function(t){var n=t.data.items.map(function(e){return e.getFormattedStartAt=$(e.getFormattedStartAt).prop("outerHTML").replace("<dt","<span").replace("/dt","/span"),e.isShow=-1===e.classes.indexOf("liveTournament"),e}),i=$("#featuredLive").html(e.render("featuredLive",{events:n}));i.trigger("newhtml")}),$.getJSON(t+"/api/web/AdvertisementAPI/GetDashboardAds",{language:n}).done(function(t){var n=t.data.featuredEventAd;$("#dashboardFeaturedEventAd").html(e.render("internalAd",{advertisement:n})),n=t.data.rectangleAd,$("#dashboardRectangleAd").html(e.render("internalAd",{advertisement:n}))}),$.getJSON(t+"/api/web/UserAPI/GetLiveEvents",{lang:n}).done(function(t){var n=t.data.items.map(function(e){return e.type=-1!==e.classes.indexOf("Tournament")?window.t("see Tournament"):window.t("Show"),e.getFormattedStartAt=$(e.getFormattedStartAt).prop("outerHTML").replace("<dt","<span").replace("/dt","/span"),e.isShow=e.type&&"Show"===e.type,e}),i=$("#liveEvents .event-list").html(e.render("liveEvents",{items:n}));i.trigger("newhtml")});var i=n;if("en"!==i&&"es"!==i&&"de"!==i&&(i+=",en"),$.getJSON(t+"/api/web/LiveVideoAPI/getLiveVideos",{query:"",languages:i,offset:0}).done(function(t){var i=[],o=[],r=[],a=new Date;t.data.liveVideos.forEach(function(e){e.endAt=new Date(1e3*e.startAt+60*e.duration*1e3),e.startAt=new Date(1e3*e.startAt),e.startAtTime=e.startAt.toLocaleString(n,{hour:"numeric",minute:"numeric"}),e.startAtDate=e.startAt.toLocaleString(n,{day:"numeric",month:"short"}),e.thumbnail=e.thumbnail.replace("90x50","640x360"),e.thumbnail=e.thumbnail.replace('width="90"','width="180"'),e.thumbnail=e.thumbnail.replace('height="50"','height="100"');var t=a.valueOf()<=e.startAt.valueOf(),s=a.valueOf()>=e.startAt.valueOf(),l=a.valueOf()<=e.endAt;e.live=s&&l,e.live===!0?i.push(e):t?o.push(e):s&&r.push(e)});var s=function(e,t){return e.startAt.valueOf()-t.startAt.valueOf()},l=function(e,t){return t.startAt.valueOf()-e.startAt.valueOf()};i=i.sort(s),o=o.sort(s),r=r.sort(l);var c=i.concat(o).concat(r).slice(0,4);$("#rev_dashboard_live_videos").html(e.render("liveVideos",{liveVideos:c}))}),$.get(t+"/api/web/UserAPI/GetFeaturedVideos",{lang:n}).done(function(n){function i(t){t.forEach(function(e){e.image_url=e.image_url.replace("214x100","original"),e.isAd=!1}),$("#rev_dashboard_featured_video_series").html(e.render("videoSeries",{videoSeries:t.slice(0,1)})),!config.level().isPremium&&t.length>2&&(t[2]={isAd:!0}),$("#rev_dashboard_video_series").html(e.render("videoSeries",{videoSeries:t.slice(1,5)})),jQuery(document).trigger("onLoadAdvertisement")}var o=n.data.videos;o.length>=5&&i(o),o.length<5&&$.get(t+"/api/web/UserAPI/GetFeaturedVideos",{lang:"en"}).done(function(e){var t=e.data.videos;i(o.concat(t))})}),window.setTimeout(function(){$(".box-play-now .ui-button, .box-play-now a.quick-play-link").click(function(e){e.preventDefault(),goToNewHousePool(e.currentTarget.getAttribute("settings"))})},250),$.getJSON("/api/web/userAPI/getUserStatistics").done(function(t){$(".stats-list").html(e.render("stats",t.data))}),config.level().isPremium&&$("#rev_dashboard_tactics_trainer").show(),null!==window.notificationHandler&&void 0!==window.notificationHandler){var o=function(e,t){window.location.href=t.content.data.url};window.notificationHandler.off("channel:gameSession:add:self",o),window.notificationHandler.on("channel:gameSession:add:self",o)}},$(document).ready(function(){$(".contentContainerInsider.ebook").length&&(jQuery(".buyVideoSeries").addVideoSeriesPurchasePopUp(),$(".contentContainerInsider.ebook").each(function(){var e={};e.ebook=$(this),e.meta=e.ebook.next(".ebookMeta"),e.ebookCurrentSection=e.ebook.find(".ebookCurrentSection"),e.banner=e.ebook.find(".ebookCurrentSection .banner"),e.lastMove=e.ebook.find(".ebookLastMove"),e.scroller=e.ebook.find(".ebookScroll"),e.scrollerContent=e.ebook.find(".ebookScrollInsider"),e.sectionname=e.ebook.find(".section-name"),e.timeline=e.ebook.find(".fp-timeline"),e.progress=e.ebook.find(".fp-progress"),e.buffer=e.ebook.find(".fp-buffer");var t,n=[],i=e.scroller.height(),o=e.scroller[0].scrollHeight,r=1/(1-i/o),a=e.timeline.width(),s=function(){var i,s=e.scroller.scrollTop()*r;if(n.length){for(var l,c=-1,d=0;d<n.length&&n[d].top<s;d++)c=d;-1==c&&n[0]&&(c=0),l=n[c].header,i=c<n.length-1?n[c+1].top:o}else i=o;e.sectionname.html(l?l.find(".header").text():"");var u=Math.round(a*Math.min(s/o,1))+"px";e.progress.stop().css("width",u);var h=Math.round(a*Math.min(i/o,1))+"px";t!==h&&(e.buffer.stop().animate({width:h},200),t=h);var p=e.meta.find("ul li.current ul li").removeClass("completed");p.eq(c).add(p.eq(c).prevAll()).addClass("completed")},l=function(t,n){var i=n.getFan();return i?(i="w"==n.moveRight?n.moveCounter-1+"... "+i:n.moveCounter+". "+i,void e.lastMove.html(window.t("Last move")+": "+i+", "+("w"==n.moveRight?window.t("White to play"):window.t("Black to play"))).show()):void e.lastMove.hide()},c=function(t,n){var i=n.getCurrentPosition(),o=n.getMeta();if(o){var r;if(o.Title)r=o.Title;else{var a=o.White,s=a.Name&&"?"!==a.Name?a.Name:"",c=o.Black,d=c.Name&&"?"!==c.Name?c.Name:"",u=s&&d?" vs. ":"";r=s+u+d+(o.Result?" "+o.Result:"")}var h;if(o.Description)h=o.Description;else{var p=o.Site&&"?"!==o.Site?o.Site:o.Event&&"?"!==o.Event?o.Event:"",f=o.Date||"";f&&(f=f.replace(".??","").replace(".??","").replace("????","")),h=p+(p&&f?", ":"")+f}r||h?(e.banner.find(".title").html(r).attr("title",r),e.banner.find(".locationdate").html(h),e.ebookCurrentSection.show(),e.banner.show()):e.ebookCurrentSection.hide()}else e.ebookCurrentSection.hide();l(t,i),v.setCurrentGame(n)},d=function(t){for(var r=0;r<n.length;r++){var a=n[r].header.data("widget");if(a.vid==t||a.properties.uuid==t){var s=Math.min(Math.max(0,n[r].header.offset().top-e.scrollerContent.offset().top-10),o-i);e.scroller.stop().animate({scrollTop:s},200,"swing")}}};if(e.scrollerContent.height()>e.scroller.height()){e.ebook.find(".widgetcontainer.ebook-section").each(function(){var e=$(this);n.push({top:e.position().top,header:e})}),e.scroller.scroll(s),s();var u,h,p,f=$("<span/>").hide().appendTo(e.timeline).addClass("fp-timeline-tooltip cTooltipTop").on("mousemove",function(){e.timeline.trigger("mousemove")}),g=!1,m=function(t){u||(u=e.timeline.offset()),h||(h=e.timeline.width());var i;i=u.left>t.pageX?0:t.pageX>u.left+h?100:100*(t.pageX-u.left)/h;for(var a=o*i/100,s=-1,l=0;l<n.length&&n[l].top<a;l++)s=l;if(s!=p&&(-1==s&&n[0]&&(s=0),-1!=s&&f.attr("data-tooltip",n[s].header.find(".header").text()),p=s),g?e.progress.css("width",i+"%"):f.css("left",t.pageX-u.left+"px"),g){var c=e.progress.width()/(r*e.timeline.width());e.scroller.scrollTop(e.scroller.prop("scrollHeight")*c)}return t.preventDefault(),!1};e.timeline.on("mousedown",function(t){u=e.timeline.offset(),h=e.timeline.width(),g=!0,f.hide(),m(t),$(document).one("mouseup",function(){g=!1})}),e.timeline.on("mousemove",m),e.timeline.on("mouseover",function(e){g||f.show()}),e.timeline.on("mouseout",function(e){f.hide()})}var v,y=Widgets.Chess().chessBase,w=new View.ChessBoard(e.ebook.find(".ebookDiagram"),!0),b=new View.Cursor(e.ebook.find(".cursor")).addEventButtons();e.ebook.find(".cursor .chess-cursor").addClass("cursorView stylePlain");var C=e.ebook.find(".burgerMenu");layout.tooltipOnClick(C),C.find(".flipBoard").on("click",function(){w.flip()}),C.find(".settings").on("click",function(){(new Dialog.PlayzoneSettings).getContent().modal("show")}),C.find(".playPosition").on("click",function(){goToNewHousePlay()}),e.ebook.find(".chess-cursor .start").attr("title",window.t("Go to first move")),e.ebook.find(".chess-cursor .prev").attr("title",window.t("Go to previous move")),e.ebook.find(".chess-cursor .next").attr("title",window.t("Go to next move")),e.ebook.find(".chess-cursor .last").attr("title",window.t("Go to last move")),e.ebook.find(".chess-cursor .textPrev").attr("title",window.t("Go to previous move in text")),e.ebook.find(".chess-cursor .textNext").attr("title",window.t("Go to next move in text")),e.ebook.find(".flipBoard").attr("title",window.t("Flip board"));var k=y.getGames();for(var F in k)"object"==typeof k[F]&&(v||(v=new Chess.GameHandler),v.addGame(F,k[F]));v||w.link(new Chess.Game);var x=y.getViews(),T=[];for(var _ in x)if("object"==typeof x[_])for(var E=y.getControllersForView(_),S=0;S<E.length;S++)T.contains(E[S])||T.push(E[S]);T.length||(T=["main"]);for(var j,I,S=0;S<T.length;S++){var A=y.getController(T[S]);A&&(j||(j=A.getCurrentGame(),I=A),A.on("movedPositionPointer",l),A.on("currentGameChanged",c),w.link(A),b.link(A))}j&&c({publisher:I},j);var O={},M=e.ebook.find(".jump-to-link"),P=null;if(M.length){for(var S=0;S<M.length;S++){var B=M.eq(S).data("widget"),R=B.resources[0].reference_id+"_"+B.properties.index;O[R]={previous:S>0?M.eq(S-1):void 0,next:S<M.length-1?M.eq(S+1):void 0}}$(document).on("chess24:nextlink",function(){if(!P)return void M.eq(0).trigger("click");var e=P.data("widget"),t=e.resources[0].reference_id+"_"+e.properties.index;O[t]&&O[t].next&&O[t].next.trigger("click")}),$(document).on("chess24:previouslink",function(){if(!P)return void M.eq(M.length-1).trigger("click");
var e=P.data("widget"),t=e.resources[0].reference_id+"_"+e.properties.index;O[t]&&O[t].previous&&O[t].previous.trigger("click")}),M.on("highlight",function(){var t=$(this);e.ebook.find(".jump-to-link.highlight").removeClass("highlighted"),P=t.addClass("highlighted");var n,r=e.scroller.scrollTop(),a=r+i,s=t.offset().top-e.scrollerContent.offset().top,l=s+t.height();r>s-30?(n=Math.max(0,s-30),e.scroller.stop().animate({scrollTop:n},200,"swing")):l+30>a&&(n=Math.min(o-i,s+30-i),e.scroller.stop().animate({scrollTop:n},200,"swing"))})}else e.ebook.find(".ebookCurrentSection").remove();v&&(M.eq(0).trigger("click"),v.getCurrentGame().gotoStart());var L=e.meta.find(".videosList > ul > li.subExercises").each(function(){var t=$(this),i=t.hasClass("current");if(i&&n){var o=new RegExp(window.location.origin+window.location.pathname+"#section-","g");e.ebook.find("a").filter(function(){return this.href.match(o)}).on("click",function(){var e=this.href.replace(/.*section-(.+)?$/,"$1");return d(e),!1})}t.on("click",function(){L.removeClass("open"),t.addClass("open")}),t.find("> h3 > a").on("click",function(){return t.hasClass("open")?!i:(L.removeClass("open"),t.addClass("open"),!1)}),i&&n&&t.find("ul a").on("click",function(){var e=this.href.replace(/.*section-(\d+)(\D.*)?$/,"$1");return d(e),!1})});if(v){e.meta.find("#capturedPiecesContainer").capturedPieces({chessGameHandler:v});var N=new View.ChessDBMovesWithSelector(e.meta.find("#databaseMovesTable")).link(v),D=new View.ChessDBGames(e.meta.find("#databaseGamesTable"),N).link(v);new View.EngineGroup("#videoEngineContent").link(v),e.meta.find("#videoTabDatabaseMoves").suspendResume(N),e.meta.find("#videoTabDatabaseGames").suspendResume(D)}else e.meta.find("[data-tab-content-id=videoTabDatabaseMoves]").parent().remove(),e.meta.find("[data-tab-content-id=videoTabDatabaseGames]").parent().remove(),e.meta.find("[data-tab-content-id=videoTabEngine]").parent().remove(),e.meta.find("#videoTabDatabaseMoves").remove(),e.meta.find("#videoTabEngine").remove(),e.meta.find("#videoTabDatabaseGames").remove();var Q=new Handler.Template("videoSeries"),H=[],G=[],V=e.ebook.find(".widgetcontainer.ebook-exercise");if(V.each(function(e){var t=$(this),n=t.data("exercises"),i={groupIndex:e,number:e+1,exercises:[]};if(n){G.push(n);for(var o=0;o<n.length;o++)i.exercises.push({exerciseIndex:o})}H.push(i)}),G.length>0){e.meta.find("#exercisesTab").html(Q.render("exerciseGroups",{noVideo:!0,groupsInfo:H})).find(".exerciseGroupTabButton").on("click",function(){var t=$(this);t.hasClass("disabled")||e.meta.find(".exerciseGroup"+t.data("group-index")).trigger("chess24:show"),$("body,html").animate({scrollTop:e.meta.offset().top-200})});var U=e.scrollerContent.height();V.each(function(t){var n=$(this),i=$(Q.render("exerciseKnobOnVideo")).css("left",100*Math.min(1,n.position().top/U)+"%").addClass("preventSelection").appendTo(e.timeline);i.css("left",parseInt(i.css("left"))-i.width()/2);var o=e.meta.find(".exerciseGroupContent.exerciseGroup"+t).addClass("exercises-from-"+n.data("widget").vid).on("chess24:show",function(n,i){i&&(e.meta.find("#exerciseTabBtn").trigger("click"),$("body,html").animate({scrollTop:e.meta.offset().top-200},200,"swing")),e.meta.find(".exerciseGroupTabButton").removeClass("open").filter(".tabBtn"+t).addClass("open"),e.meta.find(".exerciseGroupContent").hide().filter(".exerciseGroup"+t).show()});new View.VideoExercises.exerciseGroup(G[t],o,"",i,e.meta.find(".exerciseGroupTabButton.tabBtn"+t).removeClass("disabled"),function(){})}),e.meta.find(".exerciseGroup0").trigger("chess24:show")}else e.meta.find("[data-tab-content-id=videoTabExercises]").parent().remove(),e.meta.find("#videoTabExercises").remove();if(window.location.hash){var z=window.location.hash.replace(/.*section-(\d+)(\D.*)?$/,"$1");$("body,html").get(0).scrollTop=0,parseInt(z,10)&&d(z)}else e.scroller.stop(),e.scroller.attr("scrollTop",0)}))}),jQuery(document).ready(function(){var e=jQuery("#search-glossary");if(e.length){e.on("chess24:select",function(e){window.location=jQuery(this).data("submit-url")+"#word-"+this.value});var t=jQuery(".glossaryLetters");if(0!==t.length){var n=jQuery(".pageHeader").height(),i=t.clone(!0).addClass("detached").css({left:t.offset().left+"px",top:n+"px",width:t.width()+"px"}).hide().insertAfter(t),o=t.offset().top,r=!1,a={};jQuery(".glossaryList h2 a").each(function(){var e=this.name;a[e]=jQuery(this).offset().top}),jQuery(window).on("scroll",function(){var e=jQuery(document).scrollTop();!r&&e+n>o?(r=!0,i.show()):r&&o>e+n&&(r=!1,i.hide());var s;for(var l in a)e+20>=a[l]&&(!s||s&&a[l]>a[s])&&(s=l);t.find("a").add(i.find("a")).removeClass("current"),s&&t.find('a[data-letter="'+s+'"]').add(i.find('a[data-letter="'+s+'"]')).addClass("current")}),jQuery(".glossaryLetters").on("change keyup chess24:select","input.suggestField",function(e){var t=jQuery(this);setTimeout(function(){jQuery(".glossaryLetters input.suggestField").not(t).val(t.val())},1)}),jQuery(".glossaryLetters").on("chess24:select","input",function(e){var t=jQuery(this).next().find("input");setTimeout(function(){jQuery(".glossaryLetters input.suggestField").not(t).val(t.val())},1)})}}}),jQuery(document).ready(initLikes).on("chess24:lazyloaddone",initLikes),jQuery(function(){jQuery(".imagesWidget").each(function(){var e=jQuery(this),t=e.find("a");t.each(function(){var e=jQuery(this),t=e.find("img");e.css("background-image","url("+t.attr("src")+")"),t.remove()}),t.not(t.first()).hide(),function n(){jQuery(t[0]).stop().css("opacity",1).animate({opacity:0},500,function(){jQuery(t[0]).hide().appendTo(e),t=e.find("a")}),jQuery(t[1]).stop().css("opacity",0).show().animate({opacity:1},500),setTimeout(n,5e3)}()})}),jQuery(function(){if(0!==jQuery(".bodyContainer.play_leaderboard").length){var e=new Handler.Template("playZone").append(new Handler.Template),t=0,n=0,i=0,o=20,r=function(a,s,l){var c=jQuery(".playzoneLeaderboard."+a+" .leaderboardList").addClass("loading");jQuery(".playzoneLeaderboard."+a+" .overview").css("top",0);var d=jQuery(e.render("leaderboard.list",{list:[{attributes:{title:{code:"GM"},staff:!0,premium:!0,moderator:!0,fraud:!0,cop:!0}}]})),u=d.find(".attributeTitle"),h=d.find(".attributeStaff").get(0).outerHTML,p=d.find(".attributeModerator").get(0).outerHTML,f=d.find(".attributeFraud").get(0).outerHTML,g=d.find(".attributeCop").get(0).outerHTML,m=d.find(".attributePremium").get(0).outerHTML;jQuery.getJSON("/api/web/playzoneAPI/leaderboard?type="+a+(l&&l!==!0?"&locate="+l:"&page="+s),function(l){"undefined"!=typeof l.data.page&&(s=l.data.page),"bullet"==a?t=s:"blitz"==a?n=s:i=s;for(var d="bullet"===a?t:"blitz"===a?n:i,v=d*o,y=0;y<l.data.table.length;y++)l.data.table[y].nick=l.data.table[y].nick.ellipsis({pixels:127,css:{"font-style":"italic","font-size":"12px"},append:(l.data.table[y].attributes.title?u.find("span").html(l.data.table[y].attributes.title.code).end().get(0).outerHTML:"")+(l.data.table[y].attributes.staff?h:"")+(l.data.table[y].attributes.moderator?p:"")+(l.data.table[y].attributes.fraud?f:"")+(l.data.table[y].attributes.cop?g:"")+(l.data.table[y].attributes.premium?m:"")}),l.data.table[y].i=v+y+1,l.data.table[y].change_class=l.data.table[y].elo_change_period>0?"positive":l.data.table[y].elo_change_period<0?"negative":"neutral";var w=e.render("leaderboard.list",{list:l.data.table});c.removeClass("loading").html(w),jQuery(document).trigger("newhtml"),jQuery(".playzoneLeaderboard."+a+" .nativeScroll").trigger("scroll");var b=jQuery(".playzoneLeaderboard."+a+" .cPagination");b.find("li").not(".goFirst,.goPrev,.goNext,.goLast").remove(),l.data.pages>0?(jQuery("<a/>").html(window.t("{current} of {all}",{"{current}":d+1,"{all}":l.data.pages})).addClass("active").appendTo(jQuery("<li/>").insertBefore(b.find(".goNext"))),d>0?(b.find(".goFirst").removeClass("inactive").find("a").off("click").on("click",function(){r(a,0,!0)}),b.find(".goPrev").removeClass("inactive").find("a").off("click").on("click",function(){r(a,d-1,!0)})):b.find(".goFirst, .goPrev").addClass("inactive").find("a").off("click"),d<l.data.pages-1?(b.find(".goLast").removeClass("inactive").find("a").off("click").on("click",function(){r(a,l.data.pages-1,!0)}),b.find(".goNext").removeClass("inactive").find("a").off("click").on("click",function(){r(a,d+1,!0)})):b.find(".goLast, .goNext").addClass("inactive").find("a").off("click"),b.show()):b.hide(),c.find("ul li").on("click",function(){var e,t=jQuery(this),n=(t.prevAll("li").length,c.closest(".nativeScroll")),i=t.position().top,o=parseInt(c.parent().css("top"),10)||0;e=0>o+i?Math.max(0,i-10):o+i+t.height()>n.height()?Math.max(0,Math.min(c.height()-n.height(),o+i+t.height()-n.height()+10)):-o,void 0!==e&&e!=-o&&c.parent().animate({top:"-"+e+"px"},200,function(){})}),void 0!==l.data.locate&&null!==l.data.locate&&(c.find(".selected").removeClass("selected"),c.find("ul li:eq("+l.data.locate+")").addClass("selected")),jQuery(document).trigger("newhtml")}).fail(function(){c.removeClass("loading")})};r("bullet",0),r("blitz",0),r("classic",0),jQuery(".playzoneLeaderboard.bullet [data-auto-suggest]").on("chess24:select",function(){this.value&&r("bullet",0,this.value)}),jQuery(".playzoneLeaderboard.blitz [data-auto-suggest]").on("chess24:select",function(){this.value&&r("blitz",0,this.value)}),jQuery(".playzoneLeaderboard.classic [data-auto-suggest]").on("chess24:select",function(){this.value&&r("classic",0,this.value)}),jQuery(".playzoneLeaderboard.bullet a.me").on("click",function(){return jQuery(this).is(".cBtnInactive")?!1:void r("bullet",0,"me")}),jQuery(".playzoneLeaderboard.blitz a.me").on("click",function(){return jQuery(this).is(".cBtnInactive")?!1:void r("blitz",0,"me")}),jQuery(".playzoneLeaderboard.classic a.me").on("click",function(){return jQuery(this).is(".cBtnInactive")?!1:void r("classic",0,"me")})}}),jQuery(function(){function e(e,t){var n=Handler.socket.getSocket(Handler.socket.types.NOTIFICATION),i="model:PlayzoneTournamentRedisAR",o=i+":"+e,r={type:i,id:e,rkey:o},a=new Record.TournamentSocketPR(r,n,function(){t(a)})}if(0!==jQuery(".bodyContainer.play_lobby, .bodyContainer.play_index, .bodyContainer.play_playnow").length){var t=Controller.getPlayZone();new View.PlayShortcuts(jQuery(".playVsHumans .opponentSelector"),!0).link(notificationHandler),jQuery(".playVsEngines .opponentSelector a").on("click",function(){var e=jQuery(this).data("engine");t.playNow(function(){Dialog.playZone.playNow().showEngine(e).start()})});var n=jQuery(".nextTournament"),i=n.data("id");if(i){var o=new Controller.BroadcastTournament;new Controller.Broadcast(n,{norender:!0}),e(i,function(e){o.add(e,i);var t=n.find("h3"),r=n.find(".standings"),a=n.find(".playzoneTournamentTime"),s=n.find(".playzoneTournamentHeader"),l=n.find(".enrollButton"),c=[];c.push(new View.OpenStandings(r,i)),c.push(new View.TournamentTime(a,i)),c.push(new View.EnrollButton(l,i)),c.push(new View.TournamentAttribute(t,i,{attribute:"titles",action:"content"})),c.push(new View.Header(s,i)),c.push(new View.TournamentAttribute(s,i,{attribute:"status",action:"classname",predicate:function(){var e=o.getAttribute(i,"status");return s.removeClass("stateRunning statePending"),"running"==e?"stateRunning":"statePending"}})),c.forEach(function(e){e.link&&e.link(o),e.resume&&e.resume()})})}var r=jQuery(".lobbyCounters .onlineUsers .counterNumber"),a=jQuery(".lobbyCounters .onlineGames .counterNumber");new View.OnlineUserCount(r,r.data("count")).link(notificationHandler),new View.RunningGamesCount(a).link(notificationHandler);var s=jQuery(".topPlayers"),l=s.find(".playzoneStreamGameTypes li"),c=s.find(".topPlayersContent");new View.TopActivePlayers(c,l).link(notificationHandler),jQuery(".playBtn").on("click",function(){var e=jQuery(this).hasClass("engine");t.playNow(function(){e&&Dialog.playZone.playNow().showEngine()})})}}),jQuery(function(){function e(e,t){e.modal({destroyOnClose:!0,alignX:jQuery(".contentContainer"),close:!0}).modal("show"),e.find("li.gameShare").shareButtons({url:t,noIcon:!0,facebook:!0,twitter:jQuery('meta[property="og:title"]').attr("content")||!0,google:!1,mail:!1,embed:!1}),e.find(".gameNew a").on("click",function(){e.modal("hide"),Controller.getPlayZone().playNow()})}var t=jQuery("#tabAchievements");t.length&&(jQuery(".popupBadgeDialog").length&&e(jQuery(".popupBadgeDialog"),window.location.href),jQuery("#tabAchievements").one("chess24:loaded",function(){var t=jQuery(this);t.find(".badgeLink").on("click",function(){var t=jQuery(this);return jQuery.getJSON("/api/web/UserAPI/badge?uuid="+jQuery(this).data("award"),function(n){var i=new Handler.Template,o=jQuery(i.render("badgeDialog",n.data));e(o,t.attr("href"))}),!1})}))}),jQuery(function(){function e(e){e.find(".pinboardChessGame").add(e.filter(".pinboardChessGame")).each(function(){t(this)}),e.find(".pinboardItem").each(function(){var e=jQuery(this);e.find(".date.formatTimeAgo").showAge()}),config.level().isPremium||e.find(".cIconEngine").removeAttr("href").on("click",function(){return new Dialog.conversionGoPremium("analysisMode"),!1});for(var n=e.find(".ofMiniProfile"),i=jQuery(),o=n.length-1;o>=0;o--){var r=n.eq(o);if(r.data("initializedMiniprofile"))break;i=i.add(r)}i.length&&i.addMiniprofile()}function t(e){var t=jQuery(e),n=t.data("game"),i=t.data("role");"object"!=typeof n&&(n=jQuery.parseJSON(n));var o=new Chess.GameHandler,r=new View.ChessBoard(t.find(".chessBoardView")).link(o);r.movementHandler.setPremove(!1),"black"===i&&r.flip(),new View.Cursor(t.find(".cursorView")).link(o),new View.FloatingNotation(t.find(".floatingNotationView")).link(o),Chess.couchToGame(n).setMoveMode({afterGame:{mainline:!0,sideline:!0}}).link(o),t.attr("data-game","").attr("data-role","").data("game","").data("role","");var a=t.find(".pinboardEntrySocialBar");a.find(".pinboardEntrySocialNetwork").shareButtons({url:t.find(".pinboardEntryView a.gameUrl").attr("href"),facebook:!0,twitter:t.find(".textContainer p").text(),google:!1,mail:!1,embed:!1}),a.find(".cIconGamesList").on("click",function(){jQuery('a[data-tab-content-id="tabRating"]').trigger("click")}),config.level().isPremium?a.find(".cIconPgn").on("click",function(){return Handler.tracking("pgn","pinboard"),!0}):a.find(".cIconPgn").removeAttr("href").on("click",function(){Handler.tracking("pgn","pinboardConversion"),Dialog.conversionGoPremium("pgnDownload")})}var n=jQuery("#tabPinboard");n.length&&jQuery("#tabPinboard .tabContentInsider").one("chess24:loaded",function(){e(n);var t=jQuery((new Handler.Template).render("commonLoader")),i=n.find(".pinboardEntry").length,o=n.find("#pinboard-container");o.lazyload({url:o.data("url"),offset:i,selector:".pinboardEntry",onload:function(n){t.detach(),e(jQuery(n.data.html).appendTo("#pinboard-container"))},onstart:function(){n.append(t)}})})}),jQuery(function(){function e(){function n(e){var n=u.val()||7;y=Math.max(y,a(w,n)),b=y==a(l(),n);var i=v.replace("{{days}}",n).replace("{{start}}",y);jQuery.getJSON(i,function(n){t.find(".dateLegend").html(n.data.startDate+" - "+n.data.endDate),d.lineChart({}).lineChart("reset");for(var i in n.data.start)n.data[i].start=n.data.start[i];d.lineChart("path","classical",n.data.classical,"#3f9e00",!1),d.lineChart("path","bullet",n.data.bullet,"#009fe3",!1),d.lineChart("path","blitz",n.data.blitz,"#2d0367",!1),d.lineChart("path","trainerClassic",n.data.trainerClassic,"#b84d23",!1),d.lineChart("path","trainerSpeed",n.data.trainerSpeed,"#004b9e"),"function"==typeof e&&e()}),C=!1}function i(e){var t=v.replace("{{days}}",1).replace("{{start}}",e);jQuery.getJSON(t,function(e){d.lineChart("reset");for(var t in e.data.start)e.data[t].start=e.data.start[t];for(var n in e.data)for(var i=0;i<e.data[n].length;i++){var o=new Date(1e3*e.data[n][i][2]);e.data[n][i][1]=o.toLocaleTimeString().substr(0,5)}d.lineChart("path","classical",e.data.classical,void 0,!1),d.lineChart("path","bullet",e.data.bullet,void 0,!1),d.lineChart("path","blitz",e.data.blitz,void 0,!1),d.lineChart("path","trainerClassic",e.data.trainerClassic,void 0,!1),d.lineChart("path","trainerSpeed",e.data.trainerSpeed)}),h.css("display","inline-block"),C=!0}function o(){jQuery(document).trigger("newhtml"),config.level().isPremium?(jQuery("#rating-container").on("click",".cIconPgn",function(){return Handler.tracking("pgn","rating"),!0}),jQuery("#rating-container").on("click",".cIconEngine",function(){return Handler.tracking("engine","rating"),!0})):(jQuery("#rating-container").on("click",".cIconPgn",function(){return Handler.tracking("pgn","ratingConversion"),Dialog.conversionGoPremium("pgnDownload"),!1}),jQuery("#rating-container").on("click",".cIconEngine",function(){return Handler.tracking("engine","ratingConversion"),Dialog.conversionGoPremium("analysisMode"),!1}));var e=jQuery("#rating-container .customTabs section");e.filter("#ratingTableClassical").lazyload({url:"/api/web/userAPI/tabledata?table=classical&uuid="+m+"&language="+config.language(),selector:"tr.game",onload:F}),e.filter("#ratingTableBlitz").lazyload({url:"/api/web/userAPI/tabledata?table=blitz&uuid="+m+"&language="+config.language(),selector:"tr.game",onload:F}),e.filter("#ratingTableBullet").lazyload({url:"/api/web/userAPI/tabledata?table=bullet&uuid="+m+"&language="+config.language(),selector:"tr.game",onload:F}),e.filter("#ratingTableTrainerClassic").lazyload({url:"/api/web/userAPI/tabledata?table=trainerClassic&uuid="+m+"&language="+config.language(),selector:"tr.session",onload:F}),e.filter("#ratingTableTrainerSpeed").lazyload({url:"/api/web/userAPI/tabledata?table=trainerSpeed&uuid="+m+"&language="+config.language(),selector:"tr.session",onload:F}),d.on("chartover",function(e,t){t.dot.removeClass("classical blitz bullet trainerClassic trainerSpeed").addClass("cTooltipBox position-top "+t.setname).append(k.html("<h2>"+t.value+"</h2><br/>"+t.label))}).on("chartclick",function(e,t){C||i(t.label)}),p.on("change",function(){var e=jQuery(this),t=e.is(":checked"),n=e.data("chart");n?(d.lineChart("toggle",n,t),p.filter("[name=all]").get(0).checked=p.filter("[data-chart]:checked").length==p.filter("[data-chart]").length):(p.not(this).each(function(){this.checked=t}),d.lineChart("toggle","classical bullet blitz trainerClassic trainerSpeed",t))}),u.on("change",function(){y=b?l():y,n()}),h.on("click",function(){h.hide(),n()}),f.find(".start").on("click",function(){y=w,n()}),f.find(".prev").on("click",function(){var e=u.val();7==e?y=r(y,-7):31==e?y=r(y,0,-1):91==e?y=r(y,0,-3):182==e?y=r(y,0,-6):365==e&&(y=r(y,0,0,-1)),w>y&&(y=w),n()}),f.find(".next").on("click",function(){var e=u.val();7==e?y=r(y,7):31==e?y=r(y,0,1):91==e?y=r(y,0,3):182==e?y=r(y,0,6):365==e&&(y=r(y,0,0,1)),y>l()&&(y=l()),n()}),f.find(".last").on("click",function(){y=l(),n()})}function r(e,t,n,i){t=t||0,n=n||0,i=i||0;var o=s(1e3*e),r=s(o.getFullYear()+i,o.getMonth()+n,o.getDate()+t,0,0,0);return(r.getTime()/1e3).toFixed()}function a(e,t){var n,i=new Date(1e3*e),o=864e5;if(7==t){var r=(i.getDay()||7)-1;n=new Date(i.getTime()-r*o),n=s(n.getFullYear(),n.getMonth(),n.getDate(),0,0,0)}else if(31==t)n=new Date(i.getTime()-(i.getDate()-1)*o),n=s(n.getFullYear(),n.getMonth(),n.getDate(),0,0,0);else if(91==t){var a=i.getMonth()-i.getMonth()%3;n=s(i.getFullYear(),a,1,0,0,0)}else if(182==t){var l=i.getMonth()-i.getMonth()%6;n=s(i.getFullYear(),l,1,0,0,0)}else n=365==t?s(i.getFullYear(),0,1,0,0,0):s();return n.getTime()/1e3}function s(e,t,n,i,o,r){var a;a="undefined"!=typeof e&&"undefined"!=typeof t&&"undefined"!=typeof n?new Date(e,t,n,i||0,o||0,r||0):"undefined"!=typeof e?new Date(e):new Date;var s=6e4*a.getTimezoneOffset();return new Date(a.getTime()-s)}function l(){return s().getTime()/1e3}function c(e){x.pieChart({className:"gameStatisticsPieChart",defaultColor:"colorLightGrey",data:[{value:T[e+".share.wins"],label:window.t("Won: {wins}%",{"{wins}":T[e+".share.wins"]}),color:"colorGreen"},{value:T[e+".share.losses"],label:window.t("Lost: {losses}%",{"{losses}":T[e+".share.losses"]}),color:"colorOrange"},{value:T[e+".share.draws"],label:window.t("Drawn: {draws}%",{"{draws}":T[e+".share.draws"]}),color:"colorNavyBlue"}]})}var d=t.find(".lineChart"),u=jQuery(".chartFilters select",t),h=t.find("a.return"),p=t.find(":checkbox"),f=t.find(".chess-cursor"),g=t.find(".statistics");if(!u.length)return void setTimeout(e,500);var m=jQuery(".userProfilePage").data("uuid"),v="/api/web/userAPI/chartdata?uuid="+m+"&days={{days}}&start={{start}}",y=Math.round(l()),w=d.data("chart-start")||0,b=!0,C=!1,k=jQuery("<span/>").addClass("cTooltipBoxContainer"),F=function(e){this.find("tbody").append(e.data.html),jQuery(document).trigger("newhtml")},x=jQuery("#rating-container .pieChart"),T=x.data("graph");x.removeAttr("data-graph"),jQuery(".gameTypeSelector select").on("change",function(){g.removeClass("all bullet blitz classic").addClass(this.value),c(this.value)}).trigger("change"),setTimeout(function(){n(o)},200),jQuery(".downloadPgn").on("click",function(){if(!config.level().isPremium)return void Dialog.conversionGoPremium("pgnDownload");var e=jQuery(".downloadPgnMonth").val(),t=jQuery(".userProfilePage").data("uuid");jQuery.getJSON("/api/web/UserAPI/requestPgn",{month:e,uuid:t}).done(function(){Dialog.alert({content:window.t("PGN download"),comment:window.t("You will receive an e-mail with the link to<br/>your file within next couple of minutes")})})})}var t=jQuery("#tabRating");t.length&&jQuery("#tabRating").one("chess24:show",function(){setTimeout(e,500)})}),jQuery(document).ready(function(){function e(){return t().get("hideFideTitlePromo")}function t(){return jQuery.initNamespaceStorage("common").localStorage}function n(){t().set("hideFideTitlePromo",!0),a.animate({opacity:0},function(){a.remove()})}if(jQuery(".bodyContainer.profile .customTabSettings").length){$("nav.sidebarMenu > ul > li.tellAfriendReferral > a").on("click",function(){$(".customTabPartner > a").trigger("click")}),$tabs=jQuery(".userProfileTabs"),$tabs.on("click",".playBtn",function(){Controller.getPlayZone().playNow()}),$tabs.on("click",".cBtnCompleteProfile",function(){$tabs.find('a[data-tab-content-id="tabSettings"]').trigger("click")}),jQuery(".bodyContainer.profile").on("click",".btnShowFriendsList",function(){$tabs.find('a[data-tab-content-id="tabFriends"]').trigger("click"),this.preventDefault=!0}),window.settings.attach(".setGroup",!0);var i=jQuery(".playzoneSettings");i.length&&new Dialog.PlayzoneSettings(i),window.settings.on("settings",function(e,t){var n=jQuery("span.cIcon."+t.name);n.length&&(n.removeClass("cIconPrivacyVisible cIconPrivacyOnlyFriends cIconPrivacyNotVisible").addClass(privacyIcons[t.value]),n.parent().attr("data-tooltip")&&n.parent().attr("data-tooltip",privacyText[t.value]))}),jQuery(".updateImg").addClass("uploadReady").find("input[type=file]").on("chess24:add",function(e,t){jQuery(".userDetails .userPic").addClass("uploadingImage")}).on("chess24:done chess24:cancel",function(e,t){jQuery(".userDetails .userPic").removeClass("uploadingImage")}).on("chess24:done",function(e,t){jQuery(".userDetails .userPic img").attr("src",t.result.data.reference_url),jQuery(".userMenu .userPic img").attr("src",t.result.data.reference_url)}),jQuery(".cancelUserSettings").click(function(e){jQuery(this).closest(".editValues").find("form").validatable("clear"),jQuery(this).closest(".editValues").hide().prev(".showValues").show(),e.preventDefault()}),jQuery(".editUserSettings").click(function(e){jQuery(this).closest(".showValues").hide().next(".cForm").show().find("select").selectBox("destroy").selectBox(),e.preventDefault()}),jQuery(".editValues form").on("submit",function(e){e.preventDefault()}),jQuery(".editValues input[type=text],.editValues input[type=password]").keyup(function(e){13==e.keyCode&&jQuery(this).closest(".editValues").find(".saveUserSettings").click()}),jQuery(".saveUserSettings").click(function(e){var t=jQuery(this);if(t.hasClass("cBtnIcon"))return void e.preventDefault();if(t.closest("form").validatable("clientvalidate")!==!1){var n="/api/web/userAPI/saveUserSettings",i=t.closest(".editValues").find("input,select").serializeArray();i.push({name:"lang",value:config.language()}),t.addClass("cBtnIcon cIconFileUploading"),jQuery.post(n,i,function(e,n){if(0===e.status&&e.data){if("geo_country_id"in e.data.attributes){var i=e.data.attributes.geo_country_iso2,o=jQuery('#UserSettingsForm_geo_country_id option[value="'+e.data.attributes.geo_country_id+'"]').text();e.data.attributes.geo_country='<span class="icoFlag flag-'+i+'"></span> '+o,e.data.attributes.geo_country_short='<span class="icoFlag flag-'+i+'"></span> '+o}else if("quote"in e.data.attributes){var r=jQuery("<div/>").html(e.data.attributes.quote).text(),a=jQuery(".userQuoteText");r?a.text(r):a.text(a.attr("default-text"));var s=r?window.t("Edit"):window.t("Add");jQuery(".btnAddEditQuote").text(s);var l=r?"":window.t("default");jQuery(".userQuoteText").removeClass("default").addClass(l)}else"website"in e.data.attributes&&(e.data.attributes.website='<a href="'+e.data.attributes.website+'" target="_blank">'+e.data.attributes.website.replace(/http:\/\/|https:\/\//g,"")+"</a>");jQuery.each(e.data.attributes,function(e,t){jQuery("[data-user-profile-attr="+e+"]").html(t)}),jQuery(".editValues input[type=password]").val(""),t.removeClass("cIconFileUploading").addClass("cIconOKwhite"),setTimeout(function(){t.removeClass("cBtnIcon cIconOKwhite").next(".cancelUserSettings").click()},2e3)}},"json").fail(function(e,n,i){try{var o=jQuery.parseJSON(e.responseText);1===o.status&&jQuery.each(o.errors,function(e,n){t.closest(".editValues").find("#UserSettingsForm_"+e).trigger("validatable:error",{name:"",errors:n})})}catch(r){}t.removeClass("cBtnIcon cIconFileUploading")})}});var o=jQuery(".tabMessagesContent");o.length&&new View.Conversation.Conversation(o),jQuery('a[data-tab-content-id="tabSettingsGame"]').on("click",function(){setTimeout(function(){jQuery("#tabSettingsGame select").selectBox("destroy").selectBox()},300)}),jQuery(".editAffiliateSettings").click(function(e){jQuery(this).closest(".partnerIdDisplay").hide().next(".editValues").show().find("select").selectBox("destroy").selectBox(),e.preventDefault()});var r=function(e){jQuery.each(e,function(e,t){switch(e){case"url":jQuery("#partnerUrl").attr("value",t);var n=jQuery(".textLink .arrow");n.each(function(){n.data("share-buttons",!1),n.html("")}),n.shareButtons({url:t,noLabel:!0,facebook:!0,twitter:!0,google:!1,mail:!1,embed:!1});break;case"link_text":jQuery("#refLinkText").text(t);break;case"link_banner_portrait":jQuery("#refLogoPortraitHTML").text(t);break;case"link_banner_landscape":jQuery("#refLogoLandscapeHTML").text(t);break;case"link_banner_portrait_special":jQuery("#refLogoPortraitSpecialHTML").text(t);break;case"link_banner_landscape_special":jQuery("#refLogoLandscapeSpecialHTML").text(t);break;case"iframe_playzone":jQuery("#embeddedPlayzoneHTML").text(t)}})};jQuery(".saveAffiliateSettings").click(function(e){var t=jQuery(this);if(t.hasClass("cBtnIcon"))return void e.preventDefault();if(t.closest("form").validatable("clientvalidate")!==!1){var n="/api/web/affiliateAPI/saveAffiliateSettings",i=t.closest(".editValues").find("input,select").serialize();t.addClass("cBtnIcon cIconFileUploading"),jQuery.post(n,i,function(e,n){0===e.status&&(jQuery.each(e.data.attributes,function(e,t){switch(e){case"code":jQuery("[data-affiliate-attr="+e+"]").html(t);break;case"links":r(t)}}),t.removeClass("cIconFileUploading").addClass("cIconOKwhite"),t.removeClass("cBtnIcon cIconOKwhite").next(".cancelAffiliateSettings").click())}).fail(function(e,n,i){try{var o=jQuery.parseJSON(e.responseText);1===o.status&&jQuery.each(o.errors,function(e,n){t.closest(".editValues").find("#Affiliate_"+e).trigger("validatable:error",{name:"",errors:n})})}catch(r){}t.removeClass("cBtnIcon cIconFileUploading")})}}),jQuery(".registerAffiliate").click(function(e){var t=jQuery(this);if(t.hasClass("cBtnIcon"))return void e.preventDefault();var n="/api/web/affiliateAPI/registerPartner";t.addClass("cBtnIcon cIconFileUploading");var i={csrf:config.csrf()};jQuery.post(n,i,function(e,n){0===e.status&&(t.removeClass("cIconFileUploading"),jQuery(".partnerUnregistered").hide().next().show(),jQuery.each(e.data.attributes,function(e,t){switch(e){case"code":jQuery("#Affiliate_code").attr("value",t),jQuery("[data-affiliate-attr="+e+"]").html(t);break;case"since":jQuery(".partnerSinceDate").text(t);break;case"links":r(t)}}))}).fail(function(e,n,i){try{jQuery.parseJSON(e.responseText)}catch(o){}t.removeClass("cBtnIcon cIconFileUploading")})}),jQuery(".cancelAffiliateSettings").click(function(e){jQuery(this).closest(".editValues").find("form").validatable("clear"),jQuery(this).closest(".editValues").hide().prev(".partnerIdDisplay").show(),e.preventDefault()}),jQuery(".btnCopyRefLinkText").click(function(e){var t=jQuery("#refLinkText").text(),n='<a href="'+t+'">chess24.com your playground</a>';e.preventDefault();var i=jQuery("<div/>").addClass("popupInsider").append(jQuery("<div/>").addClass("dialogContent").html('<textarea rows="5" class="cPattern" style="width: 400px;">'+n+'</textarea><br class="clear"/>')).append(jQuery("<div/>").addClass("dialogFooter"));i.modal({classes:"defaultPopup inlineBtnCloseDialog",close:!0,destroyOnClose:!0}).modal("show"),i.find("textarea").select(),document.execCommand("Copy")}),jQuery(".btnCopyEmbeddedPlayzone").click(function(e){var t=jQuery("#embeddedPlayzoneHTML").text();e.preventDefault();var n=jQuery("<div/>").addClass("popupInsider").append(jQuery("<div/>").addClass("dialogContent").html('<textarea rows="5" class="cPattern" style="width: 400px;">'+t+'</textarea><br class="clear"/>')).append(jQuery("<div/>").addClass("dialogFooter"));n.modal({classes:"defaultPopup inlineBtnCloseDialog",close:!0,destroyOnClose:!0}).modal("show"),n.find("textarea").select(),document.execCommand("Copy")}),jQuery(".btnCopyBannerPortrait").click(function(e){var t=jQuery("#refLogoPortraitHTML").text();e.preventDefault();var n=jQuery("<div/>").addClass("popupInsider").append(jQuery("<div/>").addClass("dialogContent").html('<textarea rows="5" class="cPattern" style="width: 400px;">'+t+'</textarea><br class="clear"/>')).append(jQuery("<div/>").addClass("dialogFooter"));n.modal({classes:"defaultPopup inlineBtnCloseDialog",close:!0,destroyOnClose:!0}).modal("show"),n.find("textarea").select(),document.execCommand("Copy")}),jQuery(".btnCopyBannerLandscape").click(function(e){var t=jQuery("#refLogoLandscapeHTML").text();e.preventDefault();var n=jQuery("<div/>").addClass("popupInsider").append(jQuery("<div/>").addClass("dialogContent").html('<textarea rows="5" class="cPattern" style="width: 400px;">'+t+'</textarea><br class="clear"/>')).append(jQuery("<div/>").addClass("dialogFooter"));n.modal({classes:"defaultPopup inlineBtnCloseDialog",close:!0,destroyOnClose:!0}).modal("show"),n.find("textarea").select(),document.execCommand("Copy")}),jQuery(".shareLinkWithFriends").shareButtons({url:jQuery("#partnerUrl").attr("value"),noLabel:!0,facebook:!0,twitter:!0,google:!1,mail:!1,embed:!1}),jQuery(".btnPreviewEmbeddedPlayzone").click(function(e){e.preventDefault();var t=$("<div/>").addClass("popupInsider").append($("<div/>").addClass("dialogContent").attr("style","width:480;height:96;").append($("<p>").text("embedded playzone")).append($("<div>").html(jQuery("#embeddedPlayzoneHTML").attr("preview-data"))).append($("<input>").attr("style","left: 0;bottom: 0;opacity: 0;position: absolute;"))).append($("<div/>").addClass("dialogFooter"));t.modal({classes:"defaultPopup",close:!0,destroyOnClose:!0}).modal("show"),t.find("input").select(),setTimeout(function(){jQuery(window).trigger("resize")},100)}),jQuery(".btnPreviewBannerPortrait").click(function(e){e.preventDefault();var t=$("<div/>").addClass("popupInsider").append($("<div/>").addClass("dialogContent").append($("<p>").text($("#wideScyscraperBanner").text().trim()+" 160 x 600")).append($("<img>").attr("src",config.assetDir()+"/images/partner/skyscraper.png").attr("style","width:144px;height:558px").on("load",function(){setTimeout(function(){jQuery(window).trigger("resize")},100)})).append($("<input>").attr("style","left: 0;bottom: 0;opacity: 0;position: absolute;"))).append($("<div/>").addClass("dialogFooter"));
t.modal({classes:"defaultPopup",close:!0,destroyOnClose:!0}).modal("show"),t.find("input").select()}),jQuery(".btnPreviewBannerLandscape").click(function(e){e.preventDefault();var t=$("<div/>").addClass("popupInsider").append($("<div/>").addClass("dialogContent").attr("style","width:480;height:96;").append($("<p>").text($("#fullBanner").text().trim()+" 480 x 60")).append($("<img>").attr("src",config.assetDir()+"/images/partner/wide.png").on("load",function(){setTimeout(function(){jQuery(window).trigger("resize")},100)})).append($("<input>").attr("style","left: 0;bottom: 0;opacity: 0;position: absolute;"))).append($("<div/>").addClass("dialogFooter"));t.modal({classes:"defaultPopup",close:!0,destroyOnClose:!0}).modal("show"),t.find("input").select(),setTimeout(function(){jQuery(window).trigger("resize")},100)}),jQuery("#UserSettingsForm_quote").on("input",function(){var e=150,t=jQuery(this),n=t.val();n.length>e&&(n=n.substr(0,e),t.val(n));var i=e-n.length;jQuery("#quoteCharsLeft").text(i)});var a=jQuery(".fideTitlePromo");a&&(e()?a.remove():a.css("opacity",0).show().animate({opacity:1}),a.find("a.yes").on("click",function(){jQuery('a[data-tab-content-id="tabSettings"]').trigger("click"),setTimeout(function(){jQuery("#tabSettingsGeneral .editUserSettings:first").trigger("click")},1e3),n()}),a.find("a.no").on("click",n)),jQuery("#tabSettingsBlockedUsers").one("chess24:show",function(){var e=jQuery(".blockedUsers").lazyload({url:"/api/web/userAPI/getBlockedUsers",array:"users",onload:function(t){var n=new Handler.Template("friendship"),i=jQuery();t.data.users.forEach(function(e){i=i.add(jQuery(n.render("blockedUser",e)))}),e.append(i),layout.formatTimeAgo(i).userMiniprofile(i),i.find(".cBtn").on("click",function(){var e=jQuery(this);jQuery.post("/api/web/UserFriendAPI/UpdateFriendshipRelation",{csrf:config.csrf(),relationType:"Unblock",relatedUser:e.data("uuid")}).done(function(){e.closest("li").remove()})})}})})}}),jQuery(document).ready(function(){function e(e,t,i,o){n.removeClass("stats").addClass("loading"),jQuery.getJSON("/api/web/tacticTrainerAPI/summary?session="+e+"&puzzles=1",function(e){n.removeClass("loading"),jQuery(".tacticTrainerDashboard").hide();var r="classic"==t?TacticTrainer.ClassicServer:TacticTrainer.SpeedServer,a=new r(".tacticTrainerRoot");if(a.showSummary(e.data.summary,o),i)for(var s=0;s<e.data.summary.puzzles.length;s++)if(e.data.summary.puzzles[s].id==i){setTimeout(function(){a.summaryDetails(e.data.summary.puzzles[s])},1e3);break}})}var t=new Handler.Template("tacticTrainer").append(new Handler.Template),n=jQuery(".tacticTrainer .contentContainerInsider");if(n.length){var i=n.find(".tacticTrainerRoot").data("session");if(i){var o=(window.location.hash||"").replace("#","");e(i.id,i.type,o,!0)}jQuery(".tacticTrainerDashboard").length&&(jQuery(".cBtn.classic").on("click",function(){jQuery(".tacticTrainerDashboard").hide();var e=new TacticTrainer.ClassicServer(".tacticTrainerRoot");return e.start(),!1}),jQuery(".cBtn.speed").on("click",function(){jQuery(".tacticTrainerDashboard").hide();var e=new TacticTrainer.SpeedServer(".tacticTrainerRoot",{time:60*window.settings.getNumber("tactics-length")});return e.start(),!1}),window.settings.attach(".tacticTrainerDashboard"));var r=!1,a=function(i){var o=n.find(".tacticStats");return r?void o.find('.tabNav a[data-tab-content-id="stats-'+i+'"]').trigger("click"):(n.addClass("loading"),void jQuery.getJSON("/api/web/TacticTrainerAPI/sessions",function(a){if(n.removeClass("loading"),0===a.status){var s=t.render("tactics-stats",a.data);o.find(".tacticStatsRoot").html(s),o.find(".tabNav li.current").removeClass("current"),o.find('.tabNav a[data-tab-content-id="stats-'+i+'"]').closest("li").addClass("current"),jQuery(document).trigger("newhtml");var l=o.find("table.items tbody tr");l.on("click",function(){var t=jQuery(this),n=t.data("id");n&&e(n,t.closest("#stats-classic").length?"classic":"speed")}),jQuery.getJSON("/api/web/TacticTrainerAPI/chartdata",function(e){if(0===e.status){var t,n,i={classic:o.find("#stats-classic .lineChart").lineChart({loading:!0}),speed:o.find("#stats-speed .lineChart").lineChart({loading:!0})},r=jQuery("<span/>").addClass("cTooltipBoxContainer");o.find(".lineChart").each(function(){var i=jQuery(this),o=i.closest("#stats-speed").length?"speed":"classic";"classic"==o?t="rating":n="rating",i.lineChart("path",e.data[o].rating).on("chartover",function(e,t){t.dot.addClass("cTooltipBox position-top").append(r.html("<h2>"+t.value+"</h2>"+t.label))})}),o.find(".cPagination a").on("click",function(){var o=jQuery(this),r=o.closest("#stats-classic").length?"classic":"speed",a=o.data("sort");o.closest("ul").find("a").removeClass("active"),o.addClass("active"),i[r].lineChart("path",e.data[r][a]),"classic"==r?t=a:n=a}),o.find("[data-tab-content-id=stats-classic]").on("click",function(){t&&setTimeout(function(){i.classic.lineChart("path",e.data.classic[t])},300)}),o.find("[data-tab-content-id=stats-speed]").on("click",function(){n&&setTimeout(function(){i.speed.lineChart("path",e.data.speed[n])},300)})}}),r=!0}}))};if(n.on("click",".tacticTrainerClassic a.cBtn.stats, a.statsClassic",function(){n.addClass("stats"),a("classic")}),n.on("click",".tacticTrainerSpeed a.cBtn.stats, a.statsSpeed",function(){n.addClass("stats"),a("speed")}),jQuery(".leaderboard.classic").length){var s=0,l=0,c=50,d=function(e,n,i,o){var r=jQuery(".leaderboard."+e+" .leaderboardList").addClass("loading"),a=jQuery(".leaderboard."+e+" .nativeScroll"),u=jQuery(t.render("leaderboard-list",{list:[{attributes:{title:{code:"GM"},staff:!0,premium:!0,moderator:!0,fraud:!0,cop:!0}}]})),h=u.find(".attributeTitle"),p=u.find(".attributeStaff").get(0).outerHTML,f=u.find(".attributeModerator").get(0).outerHTML,g=u.find(".attributeFraud").get(0).outerHTML,m=u.find(".attributeCop").get(0).outerHTML,v=u.find(".attributePremium").get(0).outerHTML;jQuery.getJSON("/api/web/tacticTrainerAPI/leaderboard?type="+e+"&sort="+n+(o&&o!==!0?"&locate="+o:"&page="+i),function(u){"undefined"!=typeof u.data.page&&(i=u.data.page),"classic"==e?s=i:l=i;for(var y="classic"==e?s:l,w=y*c,b=0;b<u.data.table.length;b++)u.data.table[b].nick=u.data.table[b].nick.ellipsis({pixels:137,css:{"font-style":"italic","font-size":"14px"},append:(u.data.table[b].attributes.title?h.find("span").html(u.data.table[b].attributes.title.code).end().get(0).outerHTML:"")+(u.data.table[b].attributes.staff?p:"")+(u.data.table[b].attributes.moderator?f:"")+(u.data.table[b].attributes.fraud?g:"")+(u.data.table[b].attributes.cop?m:"")+(u.data.table[b].attributes.premium?v:"")}),u.data.table[b].i=w+b+1,u.data.table[b].item="ratio"==n?"%":"tempo"==n?" "+window.t("s/pos."):"";var C=t.render("leaderboard-list",{list:u.data.table});r.removeClass("loading").html(C),jQuery(document).trigger("newhtml");var k=jQuery(".leaderboard."+e+" .cPagination");k.find("li").not(".goFirst,.goPrev,.goNext,.goLast").remove(),u.data.pages>0?(jQuery("<a/>").html(window.t("{current} of {all}",{"{current}":y+1,"{all}":u.data.pages})).addClass("active").appendTo(jQuery("<li/>").insertBefore(k.find(".goNext"))),y>0?(k.find(".goFirst").removeClass("inactive").find("a").off("click").on("click",function(){d(e,n,0,!0)}),k.find(".goPrev").removeClass("inactive").find("a").off("click").on("click",function(){d(e,n,y-1,!0)})):k.find(".goFirst, .goPrev").addClass("inactive").find("a").off("click"),y<u.data.pages-1?(k.find(".goLast").removeClass("inactive").find("a").off("click").on("click",function(){d(e,n,u.data.pages-1,!0)}),k.find(".goNext").removeClass("inactive").find("a").off("click").on("click",function(){d(e,n,y+1,!0)})):k.find(".goLast, .goNext").addClass("inactive").find("a").off("click"),k.show()):k.hide(),r.find("ul li").on("click",function(){var i=jQuery(this);jQuery(".leaderboard.classic li.selected, .leaderboard.speed li.selected").removeClass("selected");var o=i.prevAll("li").length;i.addClass("selected");var s=t.render("leaderboard-profile",{profile:u.data.table[o]});jQuery(".leaderboardProfile").html(s).find("li.active").removeClass("active").end().find(".leaderboardResults."+e+" li."+n).addClass("active");var l,c=i.position().top,d=a.scrollTop();l=0>d+c?Math.max(0,c-10):d+c+i.height()>a.height()?Math.max(0,Math.min(r.height()-a.height(),d+c+i.height()-a.height()+10)):-d,void 0!==l&&l!=-d&&a.animate({scrollTop:l+"px"},200)}),o===!0?r.find("ul li:first").trigger("click"):"undefined"!=typeof u.data.locate&&r.find("ul li:eq("+u.data.locate+")").trigger("click"),jQuery(document).trigger("newhtml")}).fail(function(){r.removeClass("loading")})};d("classic","rating",0,!0),d("speed","rating",0),jQuery(".leaderboard.classic select").on("change",function(){d("classic",this.value,0,!0)}),jQuery(".leaderboard.speed select").on("change",function(){d("speed",this.value,0,!0)}),jQuery(".leaderboard.classic [data-auto-suggest]").on("chess24:select",function(){d("classic",jQuery(".leaderboard.classic select").val(),0,this.value)}),jQuery(".leaderboard.speed [data-auto-suggest]").on("chess24:select",function(){d("speed",jQuery(".leaderboard.speed select").val(),0,this.value)}),jQuery(".leaderboard.classic a.me").on("click",function(){d("classic",jQuery(".leaderboard.classic select").val(),0,"me")}),jQuery(".leaderboard.speed a.me").on("click",function(){d("speed",jQuery(".leaderboard.speed select").val(),0,"me")})}n.on("click",".reportPuzzle",function(){var e=jQuery(this).data("puzzle-id");Dialog.userReport({source:"tactic-trainer",referenceId:e})})}}),jQuery(function(){jQuery(".bodyContainer").is(".tromso2014, .tromso2014Staticpage")&&(jQuery(".olympiad2014Faq li a, .olympiad2014Faq li h2").on("click",function(){jQuery(this).closest("li").toggleClass("open")}),jQuery(".olympiad2014Partners img").on("mouseenter",function(){var e=jQuery(this);e.data("backup",e.attr("src")),e.attr("src",e.data("src"))}).on("mouseleave",function(){var e=jQuery(this);e.attr("src",e.data("backup"))}))}),jQuery(function(){function e(e,t){t.find("img").attr("src",e.media),t.find("h2").html(e.title),t.find("h3").html(e.author+(e.authorTitle?" ("+e.authorTitle+")":""));var n=t.find("p a").detach().attr("href",e.url);t.find("p").html(e.description).append("&nbsp;").append(n),e.freeVideoUrl?t.find(".preview").attr("href",e.freeVideoUrl):t.find(".preview").hide(),t.find(".price").html(e.price),t.find(".buy").data("content-id",e.seriesId).addVideoSeriesPurchasePopUp(),t.find(".watch").attr("href",e.url),config.level().isPremium?t.find(".non-premium").remove():t.find(".premium").remove()}function t(e){var n=l.eq(e);n.length&&(n.prevAll(".seriesTeaser").each(function(t){jQuery(this).stop().animate({left:-(e-t)*r+"px"},200)}),n.nextAll(".seriesTeaser").each(function(e){jQuery(this).stop().animate({left:(e+1)*r+"px"},200)}),n.stop().animate({left:"0px"},200),d.find("a").removeClass("active").eq(e).addClass("active"),clearTimeout(a),a=setTimeout(function(){t(e+1<l.length?e+1:0)},s))}function n(){function e(e){var t=jQuery(e),n=window.location.href;n=n.replace(new RegExp(t.attr("name")+"=[^&]*"),"").replace("&&","&").replace(/&$/,"").replace(/\?&?$/,"").replace("?&","?"),t.val()&&(n+=(-1!=n.indexOf("?")?"&":"?")+t.attr("name")+"="+t.val()),jQuery(".fakeSearchLink").attr("href",n).trigger("click")}jQuery(document).on("keypress",".filterBar .cIconSearch .cInputText",function(t){13===t.which&&e(this)}).on("click",".filterBar .cIconSearch",function(t){var n=jQuery(this);n.width()-t.offsetX<24&&e(n.find(".cInputText"))})}var i=jQuery(".seriesTeasers");if(!i.length){var o=$("#listVideoSeriesId");return void(o.length>0&&n())}var r,a,s=7e3,l=jQuery(),c=i.find(".seriesTeaser"),d=i.find(".navigation");jQuery(".rangeSliderContainer").styleRangeSlider(),jQuery.getJSON("/api/web/advertisementAPI/getSeriesTeasers?language="+config.language()+"&level="+config.level().toString(),function(n){n.data.advertisements&&n.data.advertisements.length&&(i.show(),r=c.width(),c.detach(),n.data.advertisements.forEach(function(n,i){var o=c.clone().css("left",i*r+"px").show();e(n,o),l=l.add(o),d.append(jQuery("<a/>").on("click",function(){t(i)}))}),1==n.data.advertisements.length&&d.hide(),l.appendTo(".seriesTeasers"),t(0))}),n()}),"undefined"==typeof View&&(View={}),function(){var e={};View.NotationArea=function(t,n){function i(){return Array.prototype.concat.apply([],Object.values(f).map(Object.values))}function o(){return h.getMeta().GameUUID?void Controller.Recommender.renderEmptyRecommendation(t):void Controller.Recommender.addRecommendationForGame(t.find(".nativeScroll"),h)}function r(){t.html(p.render("main",{extensions:Object.map(f,function(e){return Object.keys(e)})}))}function a(e,n){return t.find(".extension-"+e+" .extension-item."+n)}function s(e,n){var i=a(e,n),o=f[e][n].getContent();if(i.length)return void i.replaceWith(o);var r=$(p.render("extensions.item",n));r.append(o),t.find(".extension-"+e).append(r),t.addClass("with-"+e)}function l(e,n){a(e,n).remove();var i=t.find(".extension-"+e);i.children().length||t.removeClass("with-"+e)}function c(t,n){var i=e[t].position;if(!f[i][t]){var o=new e[t].extension(n);f[i][t]=o,s(i,t),h&&o.link(h)}}function d(t){var n=e[t].position,i=f&&f[n]&&f[n][t];i&&(delete f[n][t],l(n,t),h&&i.unlink(h))}var u=this;t=jQuery(t),t.length||errorHandler.error(new Error("container not found in NotationArea"));var h,p=new Handler.Template("notationTable"),f={before:{},main:{},after:{},bottom:{}};n=n||"default";var g=View.NotationArea.ConfigSet[n];return Extend.Suspendable(u).onSuspend(function(){i().forEach(function(e){e.suspend&&e.suspend()})}).onResume(function(){i().forEach(function(e){e.resume&&e.resume()})}),Extend.Subscriber(u,{gameStatusChanged:o,"move.mainline.add.remote":o},{afterLink:function(e){h=e.publisher,i().forEach(function(t){t.link(e.publisher)})},afterUnlink:function(e){h=void 0,i().forEach(function(t){t.unlink(e.publisher)})}}),u.toggleExtension=function(e,t,n){return t?(c(e,n),u):(d(e),u)},u.setBlindfold=function(e){return i().forEach(function(t){t.setBlindfold&&t.setBlindfold(e)}),u},u.setUserCommentWritePermission=function(e){return i().forEach(function(t){t.setUserCommentWritePermission&&t.setUserCommentWritePermission(e)}),u},r(),Object.forEach(g,function(e,t){c(t,e)}),u},View.NotationArea.registerExtension=function(t,n,i){return e[t]={position:n,extension:i},View.NotationArea},View.NotationArea.ConfigSet={"default":{GameEnd:!0,Moves:!0},positionDetails:{GameEnd:!0,Moves:{time:!1}},tooltip:{Moves:{engine:!1,time:!1}},playing:{GameEnd:{score:!1},AfterGameControls:!0,PlayingVsGuest:!0,Moves:{engine:!1},PlayZoneChat:!0},broadcast:{Moves:{ms:!1}},videoDisplay:{GameEnd:!0,Moves:{time:!1}},analyse:{GameEnd:!0,Moves:!0,Comment:!0}}}(),jQuery(function(){notificationHandler.on("engine",function(e,t){t.content.source="Cloud",Handler.engine.set(e.channel.replace("engine.",""),Handler.engine.DETAILED_ENGINE_TYPE,t.content)});var e={};Handler.engine.setDataGetter(Handler.engine.DETAILED_ENGINE_TYPE,function(t){return e[t]?!0:(e[t]=!0,notificationHandler.subscribeRequest("engine."+t),!0)})}),"undefined"==typeof Dialog&&(Dialog={}),Dialog.AfterTheGame=function(e){function n(e){d.init(p,f);var n=e.gameSessionToken,F=config.user().authToken;h=new Handler.Playing(n,F),u=new Handler.Pairing;var j="ABORTED"===e.chessGame.getGameStatus().endedBy;j&&k.remove(),k.one("click.reMatch",function(){i(n,F)}),h.on("noReMatch",function(){o(n,F)}),d.on("hide",function(){o(n,F)}),h.on("reMatchOffered",r),u.off("initGameSession").on("initGameSession",function(e,t){d.close(),Controller.getPlayZone().initGameSession(t)}),x.one("click.newGame",a),_.shareButtons({url:e.url,noIcon:!0,facebook:!0,twitter:jQuery('meta[property="og:title"]').attr("content")||!0,google:!1,mail:!1,embed:!1}),e.tournamentUuid?s():T.remove();var I=e.chessGame,A=I.getGameStatus(),O=config.assetDir()+"/images/img";"w"===e.role&&A.result.white>A.result.black||"b"===e.role&&A.result.black>A.result.white?(g.html(t("Congratulations you won!")),v.attr("src",O+"/smiley_win.png"),E.hide(),S.show()):A.result.black===A.result.white?(g.html(t("You can't win 'em all!")),v.attr("src",O+"/smiley_draw.png"),E.show(),S.hide()):(g.html(t("Bad luck, you lost!")),v.attr("src",O+"/smiley_loose.png"),E.show(),S.hide());var M,P,B,R,L,N,D,Q,H,G="",V="",U=I.getType(),z=I.getMeta();if("w"===e.role?(M=z.Black.Name,P=z.Black.UUID,B=z.Black.Link,R=I.additionalInformation.scoreTotal.white,L=I.additionalInformation.scoreTotal.black,N=I.additionalInformation.eloNew.white,H=I.additionalInformation.badges?I.additionalInformation.badges.white:[],D=I.additionalInformation.eloNew.whiteChange,Q=I.additionalInformation.lockedEngines.white):"b"===e.role&&(M=z.White.Name,P=z.White.UUID,B=z.White.Link,R=I.additionalInformation.scoreTotal.black,L=I.additionalInformation.scoreTotal.white,N=I.additionalInformation.eloNew.black,H=I.additionalInformation.badges?I.additionalInformation.badges.black:[],D=I.additionalInformation.eloNew.blackChange,Q=I.additionalInformation.lockedEngines.black),H&&H.length){var W=[];jQuery.each(H,function(e,t){var n={};n.title=t.title[config.language()],n.image=t.image[config.language()],W.push(n)});var $=d.templates.render("dialogs.play.content.afterGameBadges",{badges:W,onlyOne:1===W.length,badgesCount:W.length});p.append($)}var q="";0!==D?(0>D?(D=-1*D,q="down"):D>0&&(q="up"),b.html(t('Your new "{elo_type}" rating is now:',{"{elo_type}":U})),C.html(Handler.Template.renderString('<strong><span>{{elo_new}}</span></strong> | <strong><span class="{{css_class}}">{{elo_change}}</span></strong>',{elo_new:N,elo_change:D,css_class:q}))):(b.html(t('Your "{elo_type}" rating remains unchanged and is:',{"{elo_type}":U,"{elo_new}":N})),C.html(Handler.Template.renderString('<strong class="singleValue"><span class="{{css_class}}">{{elo_new}}</span></strong>',{elo_new:N,css_class:q}))),m.html(l(I,M,P,B)),R%1>0&&(R=Math.floor(R),R=0===R?"":R,G="&#189;"),L%1>0&&(L=Math.floor(L),L=0===L?"":L,V="&#189;");var K=c({name:M,uuid:P,link:B});if("ABORTED"!==A.endedBy&&(y.html(t("Your total score against {opponent} is now:",{"{opponent}":K})),w.html(Handler.Template.renderString("<strong><span>{{&games_won}}</span></strong> : <strong><span>{{&games_won_opponent}}</span></strong>",{games_won:R+G,games_won_opponent:L+V}))),e.recommendation&&e.recommendation.url){var Y=Controller.Recommender.getTemplateHtml(e.recommendation),J=p.parents(".popupInsider.playZoneDialog.customPopup"),X=J.find("#recommendationAfterTheGameId");X.append(Y),J.addClass("dialogWithRecommendation"),X.on("click",function(){Handler.tracking("recommendation","click-after-game",e.recommendation.url)}),d.modalDialog.on("modalAttached",function(){d.modalDialog.closest(".bubble.modal").on("afterReposition",function(){J.addClass("showRecommendation")})})}d.show(e.delay)}function i(e,n){j=!0,I||(k.removeClass("active").addClass("inactive"),F.html(t("Wait for your opponent to accept your re-match offer")).show()),u.reMatch({gameSessionToken:e,authToken:n}),h.reMatch({gameSessionToken:e,authToken:n})}function o(e,t){k.removeClass("active").addClass("inactive"),F.hide(),k.off("click.reMatch"),h.noReMatch({gameSessionToken:e,authToken:t})}function r(){I=!0,j||(k.removeClass("inactive").addClass("active"),F.show())}function a(){d.close(),Controller.getPlayZone().playNow()}function s(){var t=jQuery(d.templates.render("dialogs.play.content.afterTheGameInTournament")),n=new Controller.BroadcastTournament,i=n.getAttribute(e.tournamentUuid,"rounds"),o=n.getAttribute(e.tournamentUuid,"currentRound");o<Object.getLength(i)?(t.find(".gameComingUp").show(),t.find(".lastGame").hide(),window.settings.attach(t)):(t.find(".gameComingUp").hide(),t.find(".lastGame").show()),p.append(t)}function l(n,i,o,r){var a,s=n.getGameStatus(),l=n.getClockInformation(),d=c({name:i,uuid:o,link:r});if("w"===e.role&&s.result.white>s.result.black||"b"===e.role&&s.result.black>s.result.white)switch(s.endedBy){case"CHECKMATE":a=t("You checkmated {opponent}",{"{opponent}":d});break;case"RESIGN":a=t("{opponent} resigned",{"{opponent}":d});break;case"TOURNAMENT_NO_SHOW":a=t("{opponent} didn't start playing in time",{"{opponent}":d});break;case"CLOCKFLAG":a=t("{opponent} lost on time",{"{opponent}":d});break;case"DISCONNECT_TIMEOUT":a=t("{opponent} failed to reconnect on time",{"{opponent}":d})}else if("w"===e.role&&s.result.white<s.result.black||"b"===e.role&&s.result.black<s.result.white)switch(s.endedBy){case"CHECKMATE":a=t("{opponent} checkmated you",{"{opponent}":d});break;case"RESIGN":a=t("you resigned");break;case"TOURNAMENT_NO_SHOW":a=t("you didn't start playing in time");break;case"CLOCKFLAG":a=t("you lost on time");break;case"DISCONNECT_TIMEOUT":a=t("you failed to reconnect on time")}else if(void 0!==s.result.black&&void 0!==s.result.white&&s.result.black===s.result.white)switch(s.endedBy){case"CLOCKFLAG_VS_INSUFFICENT_MATERIAL":"w"===e.role&&l.white.flagDown===!0||"b"===e.role&&l.black.flagDown===!0?a=t("Draw as you ran out of time but {opponent} has insufficient material to mate",{"{opponent}":d}):("w"===e.role&&l.black.flagDown===!0||"b"===e.role&&l.white.flagDown===!0)&&(a=t("Draw as {opponent} ran out of time but you have insufficient material to mate",{"{opponent}":d}));break;case"DISCONNECT_VS_INSUFFICENT_MATERIAL":a=n.getEndOfMainlinePosition().isInsufficentMaterial(e.role)?t("Draw as {opponent} disconnected, but you have insufficient material to mate",{"{opponent}":d}):t("Draw as you disconnected, but {opponent} have insufficient material to mate",{"{opponent}":d});break;case"DRAW_AGREED":a=t("Draw by agreement");break;case"STALEMATE":"w"===e.role&&"w"===n.getMoveRight()||"b"===e.role&&"b"===n.getMoveRight()?a=t("Draw by stalemate you are unable to move but not in check"):("w"===e.role&&"b"===n.getMoveRight()||"b"===e.role&&"w"===n.getMoveRight())&&(a=t("Draw by stalemate {opponent} is unable to move but is not in check",{"{opponent}":d}));break;case"INSUFFICENT_MATERIAL":a=t("Draw as neither side has enough material to mate");break;case"REPETITION":a=t("Draw as the position was repeated 3 times");break;case"NO_ACTION":a=t("Draw as there were no pawn moves or captures in 50 moves")}else switch(s.endedBy){case"ABORTED":a=t("Game aborted")}return a}function c(e){return Handler.Template.renderString('<strong class="ofMiniProfile" data-uuid="{{uuid}}"><a href="{{link}}">{{name}}</a></strong>',{uuid:e.uuid,link:e.link,name:e.name})}var d=new Dialog.PlayZone(this);e.isPremium=config.level().isPremium,e.playzoneTournament=!(!e.chessGame||!e.chessGame.getMeta().TournamentUUID);var u,h,p=jQuery(d.templates.render("dialogs.play.content.afterTheGame",e)),f=jQuery(d.templates.render("dialogs.play.footer.afterTheGame",e)),g=p.find(".title"),m=p.find(".explanation"),v=p.find("img.smiley"),y=p.find(".scoreContainer > h5.text"),w=p.find(".scoreContainer > div.value"),b=p.find(".eloContainer > h5.text"),C=p.find(".eloContainer > div.value"),k=f.find("li.gameRematch"),F=f.find("li.gameRematch > a > span.cTooltipBoxContainer"),x=f.find("li.gameNew"),T=f.find("li.gameOverview"),_=f.find("li.gameShare"),E=f.find("li.btnImprove"),S=f.find("li.btnTacticTrainer");!function(e){e.gameSessionToken&&Controller.Recommender.shouldShowRecommendation(e.chessGame)?Controller.Recommender.getRecommendationForPlayzoneGame(e.chessGame,function(t){return t&&t.data?(e.recommendation=t.data.recommendation,n(e),void Controller.Recommender.renderRecommendation($(Controller.Recommender.getRecommendationContainer($)).closest(".nativeScroll"),e.recommendation)):void n(e)}):n(e)}(e);var j=!1,I=!1;return d.getContent=function(){return p},d},"undefined"==typeof Dialog&&(Dialog={}),Dialog.AnalysisShare=function(e){function t(t){i=jQuery(c.render("share",{id:e,username:config.user().permalink})),i.modal({classes:"customPopup",destroyOnClose:!0,close:!0,alignX:".contentContainer"}).modal("show"),o=i.find(".invite"),r=i.find("input.code"),a=i.find(".copy"),s=i.find(".btnCancel a"),l=i.find("input:checkbox").prop("checked",t),l.on("change",function(){Dialog.AnalysisShare.togglePublic(e,l.prop("checked"))}),a.off("click").on("click",function(){n(a),Handler.KeyboardDispatcher.copy(r.val())}),r.on("focus",function(){setTimeout(function(){r.select()})}),o.on("click",function(){var t=[];i.find('.suggestField span [name="users[]"]').each(function(){t.push(jQuery(this).val())});var r={csrf:config.csrf(),id:e,users:t};jQuery.post("/api/web/chessDatabaseAPI/analysisShare",r).done(function(e){var t=e.data.sent?window.t("Sent {number} invitations",{"{number}":e.data.sent}):window.t("No invitations sent");o.find(".copyTooltip").attr("data-tooltip",t),n(o)})}),s.on("click",function(){i.modal("hide")})}function n(e){var t=jQuery(e),n=t.find(".copyTooltip"),i=n.data("timeout");clearTimeout(i),n.addClass("fixed").show(),i=setTimeout(function(){n.removeClass("fixed").hide()},2e3),n.data("timeout",i)}var i,o,r,a,s,l,c=new Handler.Template("database");Dialog.AnalysisShare.togglePublic(e,!0,t)},Dialog.AnalysisShare.togglePublic=function(e,t,n){var i={id:e,status:t?"public":"private",csrf:config.csrf()};jQuery.post("/api/web/ChessDatabaseAPI/sessionToggleStatus",i).done(function(){n&&n(t)})},"undefined"==typeof Dialog&&(Dialog={}),Dialog.Challenge=function(e,n){function i(){if(b(),l(),c(jQuery.parseJSON($.attr("settings")),!0),$.on("click",function(){if($.hasClass(_))return!1;var t=$.attr("settings"),i=jQuery.parseJSON(t);if(null!==i){if(X){if(!J.getCurrentPosition().isValid())return q.html(window.t("Please make sure the starting position is valid")).show(),void J.on("movedPositionPointer.start",k);i.fen=J.toString();var r=parseInt(j.find("input.clockWhiteMinutes").val(),10)||0,a=parseInt(j.find("input.clockWhiteSeconds").val(),10)||0,s=parseInt(j.find("input.clockBlackMinutes").val(),10)||0,l=parseInt(j.find("input.clockBlackSeconds").val(),10)||0;(r||a)&&(s||l)&&(i.whiteClock=1e3*(60*r+a),i.blackClock=1e3*(60*s+l),delete i.clock)}i.user=e,jQuery.post("/api/web/challengeAPI/gameRequest",jQuery.extend(i,K),function(t){if(0===t.status){if(o(),t.data.isEngineChallenge)return;notificationHandler.emit("game_challenge",{content:{action:"sent",challenge:t.data.challenge,color:i.color,clock:1e3*i.clock,increment:1e3*i.increment,rating:i.rating,userUuid:e,toUuid:t.data.toUuid,userName:n.name,userOnline:!0,cancelled:t.data.cancelled}})}}).fail(function(e){try{var t=jQuery.parseJSON(e.responseText);for(var n in t.errors){q.html(window.t(t.errors[n][0])).show();break}}catch(i){}})}}),W.on("click",function(){o()}),A.find("a").on("click",function(){O.hide(),I.show(),j.modal("adjust")}),M.find("a").on("click",function(){I.hide(),O.show(),j.modal("adjust")}),P.positionBuilder(J),X){var t=O.find(".clocks input");t.on("change",function(){var e;t.each(function(){jQuery(this).val().length>0&&(e=!0)}),e&&(c({clock:void 0,increment:t.filter(".customIncrement").val()||0},!1),j.find(".cTime.active").removeClass("active")),x()}),O.find("input.customIncrement").on("change",function(){c({increment:parseInt(jQuery(this).val(),10)||0},!1),j.find(".cTime.active").removeClass("active")}),J.on("movedPositionPointer.start",function(){setTimeout(x)})}else j.addClass("showConversion"),j.find(".containerOverlayConversion .btnCancel a").on("click",function(){O.hide(),I.show(),j.modal("adjust")});jQuery.ajax({type:"GET",url:"/api/web/playzoneAPI/playNow?authToken="+config.user().authToken,success:function(e){!e.data.isAllowed&&e.data.suspended?r(window.t("Playzone is temporarily disabled, please try again in a couple of minutes.")):void 0!==e.data.nextTournamentStartsAt&&(e.data.nextTournamentRunning?r(window.t("You are playing in a currently running tournament!")):e.data.nextTournamentStartsTooSoon?r(window.t("A tournament is about to start soon, you can't send challenges now.")):(E=e.data.nextTournamentStartsAt,C()))}})}function o(){j.modal("hide")}function r(e){Y=!0,$.addClass(_),q.html(e).show()}function a(){Y=!1,$.removeClass(_),q.empty().hide()}function s(e){e?($.removeClass(_),q.empty().hide()):($.addClass(_),q.html(window.t("Your opponent went offline. You can wait or cancel challenge.")).show())}function l(){R.on("click.timePredefined",function(){u(jQuery(this))}),L.on("click.timeCustomButton",function(){h()}),D.on("click.timeCustomSelect",function(){w()}),G.on("click.timeCustom",function(e){p(e,jQuery(this))}),jQuery(document).on("click.closeCutomTimeList",function(){y()}),V.on("click",function(){f(jQuery(this))}),U.on("change",function(){g(jQuery(this))})}function c(e,t){"string"==typeof e&&(e=jQuery.parseJSON(e));var n=jQuery.parseJSON($.attr("settings"));jQuery.extend(n,e),$.attr("settings",jQuery.toJSON(n)),t&&d(e),C()}function d(e){X&&(void 0!==e.clock&&(j.find(".clockWhiteMinutes, .clockBlackMinutes").val(Math.floor(e.clock/60)),j.find(".clockWhiteSeconds, .clockBlackSeconds").val(e.clock%60||"")),void 0!==e.increment&&j.find(".customIncrement").val(e.increment||0))}function u(e){R.removeClass("active"),e.addClass("active"),e.hasClass("mPlus")||v(),c(e.attr("settings"),!0),x()}function h(){m(),c(H.find("li > a.active").attr("settings"),!0),x()}function p(e,t){G.removeClass("active"),t.addClass("active"),c(t.attr("settings"),!0),Q.removeClass().addClass("cTime").addClass(t.attr("time")),y(),x(),e.stopPropagation()}function f(e){V.parent().filter(".active").removeClass("active"),e.parent().addClass("active"),c(jQuery.parseJSON(e.attr("settings")),!1)}function g(e){var t={};t[e.attr("setting")]=e.is(":checked")?1:0,c(t,!1)}function m(){N.slideDown()}function v(){N.slideUp(),y()}function y(){H.hasClass("open")&&H.slideUp().removeClass("open")}function w(){H.toggleClass("open"),H.slideToggle()}function b(){$.html(t("Challenge")),$.css("display","inline-block"),W.html(t("Cancel")),z.removeClass("inactive")}function C(){if(void 0!==E){try{var e=$.attr("settings");e=jQuery.parseJSON(e)}catch(t){return}var n=2*(e.clock+40*e.increment)*1e3;n||(n=72e5),a(),Date.now()+n>E&&r(Date.now()>E?window.t("You are playing in a currently running tournament!"):window.t("Selected timeframe for the game might overlap the tournament that you are enrolled to!"))}}function k(){J.getCurrentPosition().isValid()&&q.hide(),J.off("movedPositionPointer.start",k)}function F(){var e={},t=J.toString();if(t!==Chess.defaultFen){var n=t.split(" ");"rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR"!=n[0]?e.position=!0:e.other=!0}return 0===j.find(".cTime.active").length&&(e.clocks=!0),Object.getLength(e)?e:!1}function x(){var e=U.filter("[setting=rating]"),t=F();if(t){e.prop("disabled")||e.data("backup-value",e.prop("checked")).prop("checked",!1).prop("disabled",!0),M.addClass("enabled");var n=[];t.position&&n.push(window.t("custom position")),t.clocks&&n.push(window.t("custom clocks")),t.other&&n.push(window.t("opening conditions")),n.length?B.html(n.join(", ")):B.empty()}else e.prop("disabled",!1).prop("checked",e.data("backup-value")),M.removeClass("enabled"),B.empty();g(e)}var T=this,_="cBtnInactive";n=n||{};var E,S=new Handler.Template("challenges").append(new Handler.Template),j=jQuery(S.render("dialogs.challengeGame",n)),I=j.find(".basicSettings"),A=j.find(".basicSettingsLink"),O=j.find(".advancedSettings"),M=j.find(".advancedSettingsLink"),P=j.find(".challengePositionBuilder"),B=j.find(".enabledOptions"),R=j.find("ul.chooseTimeList > li > a.cTime"),L=j.find("ul.chooseTimeList > li > a.mPlus"),N=j.find(".chooseCustomTime"),D=j.find(".chooseCustomTime .selectCustomTime"),Q=D.find("div span"),H=D.find("ul"),G=H.find("li > a"),V=j.find(".cColor"),U=j.find(".cSetting"),z=j.find("ul"),W=j.find(".cancelButton"),$=j.find(".submitButton"),q=j.find(".opponentOffline"),K={csrf:config.csrf()},Y=!1,J=new Chess.Game,X=config.level().isPremium;return s(View.Online.getState(e)),notificationHandler.on("channel:online:"+e,function(e,t){s("online"===t.content.action)}),T.getContent=function(){return j},i(),T},"undefined"==typeof Dialog&&(Dialog={}),"undefined"==typeof Dialog.Chat&&(Dialog.Chat={}),Dialog.Chat.banUser=function(e,n){var i=new Handler.Template("chat"),o=jQuery(i.render("dialogs.banUser",{userName:e})).modal({classes:"customPopup commonDialog",persistent:!0,
alignX:".contentContainer",destroyOnClose:!0}),r=o.find(".dialogFooter > ul > li > a.yes"),a=o.find(".dialogFooter > ul > li > a.no"),s=o.find(".inputRemoveMessages");return r.html(t("yes")),r.on("click.yes",function(){if(o.modal("hide",!0),"function"==typeof n){var e=s.is(":checked");n(e)}}),a.html(t("no")),a.on("click.no",function(){o.modal("hide",!0)}),o.modal("show"),o},"undefined"==typeof Dialog&&(Dialog={}),Dialog.ChokerConsent=function(e){if(!(this instanceof Dialog.ChokerConsent))return new Dialog.ChokerConsent(e);var t=new Handler.Template("dialogs");return this.dialog=jQuery(t.render("chokerConsent")),this.init(e),this},Dialog.ChokerConsent.prototype.init=function(e){this.dialog.modal({classes:"defaultPopup",destroyOnClose:!0,close:!0}).modal("show"),this.dialog.find("#choker-consent-opt-in").on("click",function(){settings.on("settings.chokerEnabled.on",function(){document.location.href=e}),settings.set("chokerEnabled",1)})},"undefined"==typeof Dialog&&(Dialog={}),Dialog.Coaching=function(e,t){function n(n){var r=jQuery(o.render("settings",{uuid:e,username:config.user().permalink,nofriends:!n}));r.modal({classes:"customPopup",destroyOnClose:!0,close:!0,alignX:".contentContainer"}).modal("show");var a=r.find(".invite"),s=r.find("input.code"),l=r.find(".copy"),c=r.find(".yes"),d=r.find(".no");l.off("click").on("click",function(){i(l),Handler.KeyboardDispatcher.copy(s.val())}),s.on("focus",function(){setTimeout(function(){s.select()})}),a.on("click",function(){var n=t.get("coaching"),o=n.invited||[],s=[];r.find('.suggestField span [name="users[]"]').each(function(){s.push(jQuery(this).val())});var l=s.filter(function(e){return!o.contains(e)}),c={csrf:config.csrf(),uuid:e,users:l};jQuery.post("/api/web/chessDatabaseAPI/coachingInvite",c,function(e){e.data.sent?a.find(".copyTooltip").attr("data-tooltip",window.t("Sent {number} invitations",{"{number}":e.data.sent})):a.find(".copyTooltip").attr("data-tooltip",window.t("No invitations sent")),i(a)})});var u=r.find(".restriction"),h=t.get("coaching").restrictions;u.each(function(){var e=jQuery(this),t=e.data("attribute");e.prop("checked",!h[t])}),d.on("click",function(){r.modal("hide")}),c.on("click",function(){var t={restrictions:{}};u.each(function(){var e=jQuery(this),n=e.data("attribute");t.restrictions[n]=!e.is(":checked")}),notificationHandler.sendMessage("coaching.properties",{uuid:e,data:t}),r.modal("hide")})}function i(e){var t=jQuery(e),n=t.find(".copyTooltip"),i=n.data("timeout");clearTimeout(i),n.addClass("fixed").show(),i=setTimeout(function(){n.removeClass("fixed").hide()},2e3),n.data("timeout",i)}var o=new Handler.Template("database");jQuery.getJSON("/api/web/userFriendAPI/count",function(e){n(e.data&&e.data.count)})},"undefined"==typeof Dialog&&(Dialog={}),function(){function e(e){e=e||{};var t={returnHTML:!1,logo:!0,featureTable:!0,cancelButton:!1,rootClasses:"popupInsider conversionDialog conversionDialogGoPremium"};return jQuery.extend(t,e)}function n(e,n,i){const o="1. Join custom games and private challenges <br> 2. Live Chat during Broadcast <br> 3. Access free samples of top Video Series";var r={"default":{title:"Go Premium to use this feature",message:"This feature is only available to Premium members. To gain access why not upgrade to a Premium account today!"},chatCooldown:{goPremium:{title:t("Go Premium for unlimited chat"),message:t("<strong>What's the wait?</strong> To keep chat readable non-Premium Members must wait {{n}} seconds before posting again. Go Premium to post as often as you like! Other benefits include:",{"{{n}}":i?i.cooldown:""})}},chatPremiumOnly:{goPremium:{title:t("Go Premium for unlimited chat"),message:t("Go premium to post messages to chat rooms which are restricted to our premium members! Other benefits include:")}},playZone:{register:{title:t("Register to play more chess"),message:t("<strong>You are quite a player!</strong> You have reached the maximum number of games for unregistered users today. If you want to play more just register, it is:")}},analysis:{goPremium:{title:t("Go Premium to view full database"),message:t("Registered users can view only three rows of our database results. Upgrade to Premium to unlock unlimited access to the database.")},register:{title:t("Register to use all analysis feature"),message:t("This feature is only available to registered members. In order to use it please create an account, it is:")}},customOpeningTree:{goPremium:{title:t("Go Premium to build custom opening Trees"),message:t("Upgrade to Premium to unlock unlimited access to the database and custom opening trees.")},register:{title:t("Register to use all analysis feature"),message:t("This feature is only available to registered members. In order to use it please create an account.")}},engine:{register:{title:t("Register to get evaluations faster"),message:t("As a guest evaluations you request have a lower priority than the evaluations of premium and registered users. If you want faster evaluations, please register.")},goPremium:{title:t("Go Premium to get evaluations faster"),message:t("As a registered user evaluations you request have a lower prioirty than the evaluations of premium users. If you want faster evaluations, become premium.")}},challenge:{register:{title:t("Register to challenge people"),message:t("As a guest user you are not allowed to challenge people. If you want more, please register.")},goPremium:{title:t("Go premium to challenge more people"),message:t("<strong>You are a kind of warrior!</strong> You have reached the maximum number of challenges for basic users. If you want to challenge more, become premium.")}},tacticTrainer:{goPremium:{title:t("Daily training is over"),message:t("Unless you are a premium user, you can only play 5 puzzles daily. If you want more, please subscribe to our premium membership.")},register:{title:t("Demo is over"),message:t("As a guest user you only can play the 3 puzzles which you have just played. If you want more, please register.")}},pgnDownload:{goPremium:{title:t("Go Premium to download PGN files"),message:t("This feature is only available to premium members. If you want to have access to it please subscribe to our premium membership.")}},playzoneTournament:{goPremium:{title:t("Register to participate in tournaments"),message:t("<strong>You are a player!</strong> If you want to participate in playzone tournaments you must have an account. Please create an account, it is:")},register:{title:t("Register to participate in tournaments"),message:t("<strong>You are a player!</strong> If you want to participate in playzone tournaments you must have an account. Please create an account, it is:")}},analysisMode:{goPremium:{title:t("Go Premium to use all analysis features"),message:t("This feature is only available to Premium members. To gain access why not upgrade to a Premium account today!")},register:{title:t("Go Premium for computer analysis"),message:t("This feature is only available to Premium members. To gain access why not upgrade to a Premium account today!")}},premiumBoards:{goPremium:{title:t("You picked a Premium setting"),message:t("As a non-Premium user you can not use these settings. Why not upgrade to Premium to get unlimited access to all settings and much, much more!")}},enroll:{goPremium:{title:t("Go Premium to join premium-only tournaments"),message:t("This tournament is only open for Premium members. To gain access why not upgrade to a Premium account today!")}},communityTopic:{register:{title:t("Register to access member-only community topics"),message:t("This topic is only open for chess24 members. To gain access why not register today!")},goPremium:{title:t("Go Premium to access premium-only community topics"),message:t("This topic is only open for Premium members. To gain access why not upgrade to a Premium account today!")}},multiboard:{goPremium:{title:t("Go Premium to use custom multiboard view"),message:t("This feature is only available to Premium members. To gain access why not upgrade to a Premium account today!")}},biggerBoard:{goPremium:{title:t("Go Premium to expand the board"),message:t("This feature is only available to Premium members. To gain access why not upgrade to a Premium account today!")}},reminder:{register:{title:t("Register on chess24 to:"),message:t(o)},goPremium:{title:t("Go Premium on chess24 to:"),message:t("- Get full access to our video library <br> - Challenge GMs on our Banter Blitz shows <br> - Train like a pro. Explore our expanding collection of high-quality games on our database <br> or simply to show support to our broadcast teams")}},reminderBroadcast:{register:{title:t("Enjoying our broadcast?"),message:t("Register for free on chess24 to access more: <br> "+o)}}},a={};return a.strings=r[e]&&r[e][n]||r["default"],a.embed=1===parseInt(jQuery("body").data("embed"),10),a}Dialog.alert=function(e,n){n=n||dummy;var i=new Handler.Template("dialogs"),o=jQuery(i.render("alert")).modal({classes:"customPopup commonDialog",persistent:!0,alignX:".contentContainer",destroyOnClose:!0}),r=o.find(".dialogContent > h3"),a=o.find(".dialogContent > p"),s=o.find(".dialogFooter > ul .ok");return"object"==typeof e?(r.html(e.content),a.html(e.comment)):(r.html(e),a.remove()),s.html(t("ok")),s.on("click.ok",function(){o.modal("hide",!0),n()}),o.modal("show"),o},Dialog.confirmation=function(e,n,i){if("function"==typeof n)var o=n,r=t("yes"),a="";else"object"==typeof n&&(o=n.callback,r=n.label,a=n.className);if("function"==typeof i)var s=i,l=t("no"),c="";else"object"==typeof i&&(s=i.callback,l=i.label,c=i.className);var d=new Handler.Template("dialogs"),u=jQuery(d.render("confirm")).modal({classes:"customPopup commonDialog",persistent:!0,alignX:".contentContainer",destroyOnClose:!0}),h=u.find(".dialogContent > h3"),p=u.find(".dialogContent > p"),f=u.find(".dialogFooter > ul > li > a.yes"),g=u.find(".dialogFooter > ul > li > a.no");return"object"==typeof e?(h.html(e.content),p.html(e.comment)):(h.html(e),p.remove()),f.html(r||t("yes")).addClass(a||""),f.on("click.yes",function(){u.modal("hide",!0),"function"==typeof o&&o()}),g.html(l||t("no")).addClass(c||""),g.on("click.no",function(){u.modal("hide",!0),"function"==typeof s&&s()}),u.modal("show"),u},Dialog.prompt=function(e){function t(){switch(e.input){case"short":break;case"long":return r.find(".prompt").val();case"editor":}}var n=new Helper.Deferred,i=Object.merge(e,{"short":"short"===e.input,"long":"long"===e.input,editor:"editor"===e.input}),o=new Handler.Template("dialogs"),r=jQuery(o.render("prompt",i)).modal({classes:"customPopup",persistent:!0,alignX:".contentContainer",destroyOnClose:!0});return r.find("a.yes").on("click.yes",function(){r.modal("hide",!0),n.resolve(t())}),r.find("a.no").on("click.no",function(){r.modal("hide",!0)}),r.modal("show"),n.promise},Dialog.conversionRegister=function(t,i){i=e(i);var o=new Handler.Template("dialogs"),r=n(t,"register"),a=o.render("register",jQuery.extend(i,r));if("reminder"===t||"reminderBroadcast"===t?Handler.tracking(t+"Register","register"):Handler.tracking("conversionDialog","register",t),i.returnHTML)return a;var s=jQuery(a).modal({classes:"customPopup",persistent:!1,alignX:".contentContainer",destroyOnClose:!0});return config.attachLoginLink(),s.modal("show"),s},Dialog.conversionGoPremium=function(t,i,o){i=e(i);var r=new Handler.Template("dialogs"),a=n(t,"goPremium",o);a.sourceId="dlg-"+t;var s=r.render("goPremium",jQuery.extend(i,a));if("reminder"===t||"reminderHoliday"===t?Handler.tracking(t+"Premium","premium"):Handler.tracking("conversionDialog","premium",t),i.returnHTML)return s;var l=jQuery(s).modal({classes:"customPopup",persistent:!1,alignX:".contentContainer",close:!0,destroyOnClose:!0});return l.modal("show"),l},Dialog.showMobilePremiumPackages=function(){var e=new Handler.Template("dialogs"),t=e.render("mobilePremiumPackages");Handler.tracking("conversionDialog","premium","mobilePremiumPackage");var n=jQuery(t).modal({classes:"customPopup",persistent:!1,alignX:".contentContainer",close:!0,destroyOnClose:!0});return n.modal("show"),n},Dialog.editChessGame=function(e,t){function n(e){var t=l.find("select.endedBy"),n=e.endedBy;t.find("option").prop("selected",!1),t.find('option[value="'+n+'"]').prop("selected",!0)}function i(e){var t=l.find("select.result"),n=Chess.GameStatus.resultToString(e.result);t.find("option").prop("selected",!1),t.find('option[value="'+n+'"]').prop("selected",!0),o(e.result),t.on("change",function(){var e=jQuery(this).val();o(Chess.GameStatus.stringToResult(e))})}function o(e){l.find("#gameStatus-result-white").val(e&&e.white),l.find("#gameStatus-result-black").val(e&&e.black),l.find("#meta-Result").val(Chess.GameStatus.resultToString(e))}t=t||dummy;var r=new Handler.Template("dialogs"),a=r.render("editChessGame",e),s=jQuery(a).modal({classes:"customPopup",persistent:!1,alignX:".contentContainer",close:!0,destroyOnClose:!0}),l=s.find(".dialogContent form");return n(e.gameStatus),i(e.gameStatus),s.find(".dialogFooter .btnOk > a").on("click",function(){var e={};l.serializeArray().forEach(function(t){Object.setByPath(e,t.name,t.value,"-")}),t(e),s.modal("hide",!0)}),s.find(".dialogFooter .btnCancel > a").on("click",function(){s.modal("hide",!0)}),s.modal("show"),s},Dialog.setupPosition=function(e,t){var n=new Handler.Template("dialogs"),i=n.render("setupPosition"),o=new Chess.Game({ruleSet:"build",fen:t}),r=jQuery(i).modal({classes:"customPopup",persistent:!1,alignX:".contentContainer",close:!0,destroyOnClose:!0});return r.find(".positionBuilder").positionBuilder(o),r.find(".dialogFooter > ul > li.btnOk > a").on("click",function(){return o.getCurrentPosition().isValid()?(r.modal("hide",!0),"function"==typeof e&&e(o),void $(".cIconMoveMode").click()):(r.find(".error").html(window.t("The given position is invalid")).show(),void r.modal("adjust"))}),r.find(".dialogFooter > ul > li.btnCancel > a").on("click",function(){r.modal("hide",!0)}),r.modal("show"),r},Dialog.confirmMove=function(e,t,n){var i=new Handler.Template("dialogs"),o=i.render("confirmMove",{san:e.getCurrentPosition().getSan()}),r=jQuery(o).modal({classes:"customPopup",persistent:!0,alignX:".contentContainer",close:!0,destroyOnClose:!0}),a=r.find(".board");r.find(".yes").html(window.t("yes")).on("click",function(){r.modal("hide"),t()}),r.find(".no").html(window.t("no")).on("click",function(){r.modal("hide")});var s=new View.ChessBoard(a,!1).link(e);n&&s.flip(),r.modal("show")}}(),"undefined"==typeof Dialog&&(Dialog={}),Dialog.createFTPUser=function(e){function t(e){13==e.which&&n()}function n(){d.find(".errorMessage").hide(),s.removeClass("error");var t=s.val().trim(),n=l.val().trim(),i=c.prop("checked");return/^[a-zA-Z0-9-_]{8,30}$/.test(t)?(s.prop("disabled",!0),l.prop("disabled",!0),c.prop("disabled",!0),o.find(".dialogFooter").hide(),void $.post("/api/web/BroadcastConfigurationAPI/createUser",{csrf:config.csrf(),username:t,password:n,autogenerate:i,server:e}).done(function(e){o.find(".dialogFooter").hide(),o.find(".ftpUserForm").hide(),$success=o.find(".success"),$success.show(),$success.find("#username").html(t),$success.find("#password").html(e.data.password)}).fail(function(e){s.prop("disabled",!1),l.prop("disabled",!1),c.prop("disabled",!1),o.find(".dialogFooter").show(),d.find("#feedbackDetails").html(e.statusText),d.find("#feedbackInvalidResponse").show()})):(s.addClass("error"),void d.find("#feedbackInvalidUsername").show())}var i=new Handler.Template("broadcastConfig"),o=jQuery(i.render("dialogs.createFTPUser")).modal({classes:"customPopup commonDialog",persistent:!0,alignX:".contentContainer",destroyOnClose:!0,close:!0}),r=o.find(".dialogFooter > ul > li > a.yes"),a=o.find(".dialogFooter > ul > li > a.no"),s=o.find("#ftpUsername"),l=o.find("#ftpPassword"),c=o.find("#ftpAutogenerate"),d=o.find(".feedback");return c.on("click",function(){l.prop("disabled",c.prop("checked"))}),s.on("keyup",t),l.on("keyup",t),r.on("click.yes",n),a.on("click.no",function(){o.modal("hide",!0)}),o.modal("show"),o},"undefined"==typeof Dialog&&(Dialog={}),Dialog.reviewEmailSettings=function(){var e=new Handler.Template("dialogs"),t=jQuery(e.render("reviewEmailSettings")).modal({classes:"dataConsentModal",destroyOnClose:!0,close:!1}).setPersistent();return window.settings.attach(t,!1),t.find("#email-consent-opt-in-all").on("click",function(){settings.set("notification-news",1),settings.set("welcome-emails",1),settings.set("lastEmailSettingsReview",(new Date).toISOString()),t.modal("hide",!0),Handler.tracking("email-settings","all-in",config.level().isPremium?"premium":"registered")}),t.find("#email-consent-remind").on("click",function(){settings.set("lastEmailSettingsReview",(new Date).toISOString()),t.modal("hide",!0),Handler.tracking("email-settings","reviewLater",config.level().isPremium?"premium":"registered")}),t.find("#email-consent-no-thanks").click(function(){settings.set("notification-news",0,!0),settings.set("welcome-emails",0,!0),settings.set("lastEmailSettingsReview",(new Date).toISOString()),settings.set("no-thanks",1),t.modal("hide",!0),Handler.tracking("email-settings","no-thanks",config.level().isPremium?"premium":"registered")}),t.modal("show"),t},"undefined"==typeof Dialog&&(Dialog={}),Dialog.Engine=function(e){function t(t){h=jQuery(T.render("dialogs.play.content.engine",Object.merge(t,{minutesWhite:e.clock&&e.clock.white?Math.floor(e.clock.white/6e4):15,secondsWhite:e.clock&&e.clock.white?Math.floor(e.clock.white%6e4/1e3):0,minutesBlack:e.clock&&e.clock.black?Math.floor(e.clock.black/6e4):15,secondsBlack:e.clock&&e.clock.black?Math.floor(e.clock.black%6e4/1e3):0,increment:e.increment/1e3||0}))),p=h.find(".challengePositionBuilder"),f=h.find(".chooseCompOpponenet li"),g=h.find(".cColor"),m=h.find(".clocks"),v=h.find(".cancelButton"),y=h.find(".submitButton"),b=h.find("input.timed"),w=h.find(".errorMessage"),S?(void 0!==t.nextTournamentStartsAt&&(t.nextTournamentRunning?o(window.t("You are playing in a currently running tournament!")):t.nextTournamentStartsTooSoon?o(window.t("A tournament is about to start soon, you can't start new games now.")):(C=t.nextTournamentStartsAt,c())),a(),y.on("click",function(){if(y.parent().hasClass(F))return!1;var e=u();if(null!==e){if(x&&new View.Challenge(jQuery("<div/>")).link(notificationHandler),!E.getCurrentPosition().isValid())return w.html(window.t("Please make sure the starting position is valid")).show(),void E.on("movedPositionPointer.start",d);jQuery.post("/api/web/challengeAPI/gameRequest",jQuery.extend(e,_)).done(i).fail(function(e){try{var t=jQuery.parseJSON(e.responseText);for(var n in t.errors){w.html(window.t(t.errors[n][0])).show(),h.modal("adjust");break}}catch(i){}})}}),v.on("click",function(){i()})):(h.addClass("showConversion"),h.find(".containerOverlayConversion .btnCancel a").on("click",i)),p.positionBuilder(E),n()}function n(){h.modal({close:!0,destroyOnClose:!0,classes:"customPopup"}).modal("show")}function i(){h.modal("hide")}function o(e){y.parent().addClass(F),w.html(e).show()}function r(){y.parent().removeClass(F),w.empty().hide()}function a(){b.on("change",function(){m[this.checked?"fadeIn":"fadeOut"](function(){h.modal("adjust")}),c()}),f.children(".engineAvatar").on("click.engine",function(){l(jQuery(this).parent())}),g.on("click",function(){s(jQuery(this))}),m.find("input").on("change",c),g.parent().removeClass("active"),g.filter("."+("w"==E.getMoveRight()?"white":"black")).parent().addClass("active")}function s(e){g.parent().filter(".active").removeClass("active"),e.parent().addClass("active")}function l(e){e.hasClass("locked")||(f.removeClass("active"),e.addClass("active"))}function c(){if(void 0!==C){var e=u(),t=e.whiteClock+e.blackClock+80*e.increment;t||(t=72e5),r(),Date.now()+t>C&&o(Date.now()>C?window.t("You are playing in a currently running tournament!"):window.t("Selected timeframe for the game might overlap the tournament that you are enrolled to!"))}}function d(){E.getCurrentPosition().isValid()&&w.hide(),E.off("movedPositionPointer.start",d)}function u(){var e=!!b.prop("checked");if(e){var t=parseInt(h.find("input.clockWhiteMinutes").val(),10)||0,n=parseInt(h.find("input.clockWhiteSeconds").val(),10)||0,i=parseInt(h.find("input.clockBlackMinutes").val(),10)||0,o=parseInt(h.find("input.clockBlackSeconds").val(),10)||0;(!t&&!n||!i&&!o)&&(e=!1)}return{fen:E.toString(!0),engine:f.filter(".active").data("engine"),whiteClock:e?1e3*(60*t+n):0,blackClock:e?1e3*(60*i+o):0,increment:e?h.find("input.customIncrement").val()||0:0,rated:0,immediate:1,color:g.parent().filter(".active").find("a").attr("color")}}var h,p,f,g,m,v,y,w,b,C,k=this,F="inactive",x=parseInt(jQuery("body").data("embed"),10),T=new Handler.Template("playZone"),_={csrf:config.csrf()},E=new Chess.Game(e.fen&&{fen:e.fen}||void 0),S=config.level().isPremium;return jQuery.getJSON("/api/web/playzoneAPI/playNow",{authToken:config.user().authToken},function(e){t(e.data)}),k},"undefined"==typeof Dialog&&(Dialog={}),function(){var e=[];Dialog.Enroll=function(t,n,i){function o(e,t){clearTimeout(s),a=t.value,s=setTimeout(r,1e3-Controller.Broadcast.offsetCorrectedDateNow()%1e3)}function r(e){if(clearTimeout(s),void 0===e&&(e=a-Controller.Broadcast.offsetCorrectedDateNow()),!(0>=e)){s=setTimeout(function(){r(e-1e3)},1e3-Controller.Broadcast.offsetCorrectedDateNow()%1e3);var t=Date.getSplitedTime(e);p.text((""+t.hours).lpad("0",2)),f.text((""+t.minutes).lpad("0",2)),g.text((""+t.seconds).lpad("0",2)),h.text((""+t.days).lpad("0",2)),u.toggleClass("withDays",!!t.days)}}var a,s,l=this,c=new Handler.Template("playZone"),d=jQuery(c.render("dialogs.play.content.enroll")).addClass(n?"success":"failure"),u=d.find(".clock"),h=u.find(".days"),p=u.find(".hours"),f=u.find(".minutes"),g=u.find(".seconds");return d=d.modal({classes:"customPopup",alignX:".contentContainer",close:!0,destroyOnClose:!0}),d.on("chess24:show",function(){e.push(d)}).on("chess24:hide",function(){e.removeByValue(d)}),window.settings.attach(d),i&&d.find("h2.dialogTitle").html(i),d.on("chess24:hide",function(){clearTimeout(s)}),d.find(".buttons .gameRematch").on("click",function(){d.modal("hide")}),d.find(".buttons .gameShare a").shareButtons({noLabel:!0,noIcon:!0,facebook:!0,twitter:!0,google:!1,mail:!1,embed:!1}),Extend.Subscriber(l,{},{afterLink:function(e){e.publisher.on("set."+t+":1.startDate",o);var n=e.publisher.getAttribute(t,"title");d.find(".name strong").html(n);var i=e.publisher.getAttribute(t,"rounds"),r=i&&i[1]?i[1].startDate:0;o(e,{value:r})}}),l.getContent=function(){return d},l},Dialog.Enroll.close=function(){for(var t=e.length-1;t>=0;t--)e[t].modal("hide")}}(),"undefined"==typeof Dialog&&(Dialog={}),Dialog.GameSelector=function(e,t,n,i){function o(e,t){if(u[t])return u[t];for(var n in e)for(var i in e[n].rooster)if(e[n].rooster[i]==t)return u[t]=n}function r(e,t){return!n||0===n.length||!!n.find(function(n){return n.matchId==e&&n.gameId==t})}function a(){var n=d.getAttribute(e,"rounds"),i=0,a=0;if(p)var s=d.getAttribute(e,"teams"),l=d.getAttribute(e,"gamesPerMatch");var u=[];for(var h in n[t].matches){var m=n[t].matches[h];if(!p||!m.teams||m.teams[1]&&m.teams[2]){var v=[],y={games:v};if(p){Object.extend(y,{teamA:s[m.teams[1]].name,teamB:s[m.teams[2]].name,teamIdA:m.teams[1],teamIdB:m.teams[2],scoreA:0,scoreB:0,matchId:h});var w=0,b=o(s,m.games[1]&&m.games[1].player.white),C=b!==m.teams[1];C&&(w=1)}u.push(y);for(var k in m.games){k=parseInt(k,10);var F=m.games[k],x=p&&!((w+k)%2),T=x?"black":"white",_=x?"white":"black",E=d.getPlayer(e,F.player[T]),S=d.getPlayer(e,F.player[_]);v.push({gameId:h+"-"+k,tournamentId:e,roundNo:t,matchNo:h,gameNo:k,reverse:x,showEngine:g,url:c.getGameUrl(e,t,h,k),engine:Controller.Broadcast.convertEvaluationToPercent(F.engine,!x),player:{white:Object.merge(E,{name:c.shorterFirstName(E.name,18)}),black:Object.merge(S,{name:c.shorterFirstName(S.name,18)})},status:{finished:"finished"===F.gameStatus.status,running:"running"===F.gameStatus.status,upcoming:"upcoming"===F.gameStatus.status,playerA:{score:Controller.Broadcast.scoreToString(F.gameStatus.result&&F.gameStatus.result[T]),won:F.gameStatus.result&&1===F.gameStatus.result[T]},playerB:{score:Controller.Broadcast.scoreToString(F.gameStatus.result&&F.gameStatus.result[_]),won:F.gameStatus.result&&1===F.gameStatus.result[_]}},checked:r(h,k),noLink:!0}),F.gameStatus.result&&(F.gameStatus.result[T]&&(y.scoreA+=F.gameStatus.result[T]),F.gameStatus.result[_]&&(y.scoreB+=F.gameStatus.result[_])),i++,a+=["running","upcoming"].contains(F.gameStatus.status)?1:0}y.winnerA=y.scoreA>y.scoreB&&y.scoreA>l/2,y.winnerB=y.scoreB>y.scoreA&&y.scoreB>l/2,y.scoreA=Controller.Broadcast.scoreToString(y.scoreA),y.scoreB=Controller.Broadcast.scoreToString(y.scoreB)}}var j={matches:u,knockoutEvent:f,teamEvent:p,showCheckbox:!0,countAllGames:i,countRunningGames:a};return j}function s(){var e=[];return m.find("input:checkbox:checked").each(function(){var t=jQuery(this);e.push({matchId:t.data("match"),gameId:t.data("game")})}),e}var l=new Handler.Template("broadcast"),c=new Controller.Broadcast,d=new Controller.BroadcastTournament,u={},h=jQuery(".reset"),p=d.isTeamEvent(e),f=d.isKnockoutEvent(e),g=window.settings.getBoolean("game-broadcast-engine"),m=jQuery(l.render("multiboard.setup"+$redesignSuffix,a()));m.modal({classes:"customPopup",destroyOnClose:!0,close:!0,alignX:".contentContainer"}).modal("show"),m.find(".cancel").on("click",function(){m.modal("hide")}),m.find(".ok").on("click",function(){if($redesign){if(0===$(".selectGame input:checked").length)return void $(".dialogError").show();$(".dialogError").hide()}i(s()),m.modal("hide")}),m.find(".selectall").on("click",function(){m.find("input:checkbox").prop("checked",!0),h.removeClass("active"),h=jQuery(this),h.addClass("active")}),m.find(".reset").on("click",function(){m.find("input:checkbox").each(function(){var e=jQuery(this),t=e.data("match"),n=e.data("game");e.prop("checked",r(t,n))}),h.removeClass("active")}),m.find(".default").on("click",function(){var e=c.getCurrentGamePath();m.find("input:checkbox").each(function(){var t=jQuery(this);t.prop("checked",t.data("match")==e.match)}),h.removeClass("active")}),m.find(".onlyrunning").on("click",function(){m.find("input:checkbox").each(function(){var n=jQuery(this),i=n.data("match"),o=n.data("game"),r="finished"!=d.getAttribute(e,"rounds")[t].matches[i].games[o].gameStatus.status;n.prop("checked",r)}),h.removeClass("active"),h=jQuery(this),h.addClass("active")}),m.find(".unselect").on("click",function(){m.find("input:checkbox").prop("checked",!1),h.removeClass("active")}),m.find("tr").on("click",function(){var e=jQuery(this),t=e.find("input:checkbox");t.length&&t.prop("checked",!t.prop("checked")),h.removeClass("active")}),m.find("tr input:checkbox").on("click",function(e){h.removeClass("active"),e.stopPropagation()})},"undefined"==typeof Dialog&&(Dialog={}),Dialog.Games=function(e){function t(){y.find(".cancel").on("click",function(){y.modal("hide")}),y.find(".yes").on("click",function(){var e=y.find(".gamesList"),t=[].slice.apply(e.find("input:checked").map(function(){return v[parseInt(this.value,10)]})),n=y.find("div.suggestField").suggestField("values",!0);u(t,n)});var t=y.find(".cIconListView, .cIconGridView").on("click",function(){var e=jQuery(this);e.is(".disabled")||h(t,e.is(".cIconListView"))});h(t,window.settings.getBoolean("analysis-list-mode"));var r=y.find(".selectAll, .deselectAll");r.off("click").on("click",function(){var e=jQuery(this),t=e.is(".selectAll");C.find("input:checkbox").each(function(){jQuery(this).prop("checked",t)}),e.hide(),r.not(e).show()}),e.playzone&&n(),e.pgn&&i(),e.sessions&&o()}function n(){var e=y.find("input#importuser");y.find("a.cIconSearch").on("click",function(t){return f.emit("search",{pattern:e.val()}),t.stopPropagation(),t.preventDefault(),!1})}function i(){}function o(){function e(){return f.setCurrentTag(),f.emit("search",{pattern:t.val().trim()}),!1}k.on("click",function(){f.emit("alltags")}),F.on("click",function(){f.emit("allgames")}),y.find(".new").on("click",function(){f.emit("newgame")}),x.on("click",a),T.on("click",s),y.find(".confirmDeleteSessions").on("click",l),y.find(".deleteBatch").on("click",d),y.find(".cancelBatch").on("click",c);var t=y.find(".search input"),n=y.find(".search .cBtn");n.on("click",e),t.on("keyup",function(t){return 13===t.which?e():void 0})}function r(e){e.filter("li").each(function(){var e=jQuery(this);p(function(){var t=e.find(".chessBoard");new View.ChessBoard(t,!1).link(new Chess.Game({fen:t.data("fen")}))}),e.find(".cIconPrivacyNotVisible, .cIconPrivacyVisible").on("click",function(t){Dialog.AnalysisShare.togglePublic(e.data("id"),jQuery(this).is(".cIconPrivacyNotVisible"),function(t){e.toggleClass("public",t)}),t.stopPropagation()}),e.find(".shareLink").on("click",function(t){new Dialog.AnalysisShare(e.data("id"),!1),y.modal("hide"),t.stopPropagation()}),e.find(".deleteLink").on("click",function(t){e.addClass("promptDelete");var n=e.find(".confirmDelete");n.on("click",function(e){e.stopPropagation()}),n.find(".cancel").off("click").on("click",function(){e.removeClass("promptDelete")}),n.find(".delete").off("click").on("click",function(){jQuery(this).off("click").addClass("disabled"),f.emit("delete",{id:e.data("id")})}),t.stopPropagation()})}).on("click",function(e){if(m){var t=jQuery(this).data("token"),n=jQuery(this).data("id"),i=v.find(function(e){return t&&e.gameSessionToken===t||n&&e.id===n});i&&u([i])}else{if(jQuery(e.target).is("input:checkbox"))return e.stopPropagation(),!0;var o=jQuery(this).find("input:checkbox");o.prop("checked",!o.prop("checked"))}return!1}),e.find(".time").showAge()}function a(){f.switchToGames(),m=!1,x.addClass("disabled"),T.removeClass("disabled"),y.find(".deletionControls").show(),y.modal("adjust"),C.find("li").each(function(e){var t=jQuery(this),n=t.find(".sessionName");n.length||(n=jQuery('<a class="sessionName"/>').appendTo(t).data("deleteAfterDeletion",!0)),n.append('<input type="checkbox" value="'+e+'"/><label></label>')})}function s(){m||(m=!0,x.removeClass("disabled"),T.addClass("disabled"),y.find(".deletionControls").hide(),y.modal("adjust"),C.find("li").each(function(){var e=jQuery(this);e.data("deleteAfterDeletion")?e.remove():e.find("input:checkbox").remove()}))}function l(){y.find(".deletionControls .confirmDelete").show(),y.modal("adjust")}function c(){y.find(".deletionControls .confirmDelete").hide(),y.modal("adjust")}function d(){c();var e=[].slice.apply(C.find("input:checked").map(function(){return jQuery(this).closest("li").data("id")}));f.emit("delete",{id:e})}function u(e,t){f.emit("select",{games:e,tags:t})}function h(e,t){e.each(function(){var e=jQuery(this);jQuery(this).toggleClass("disabled",t===e.is(".cIconListView"))}),C.toggleClass("listMode",t).toggleClass("gridMode",!t),window.settings.set("analysis-list-mode",t?1:0)}function p(e){p.queue=p.queue||[],window.settings.getBoolean("analysis-list-mode")?p.queue.push(e):e()}var f=this,g=new Handler.Template("database").append(new Handler.Template),m=e.playzone||e.sessions,v=[],y=jQuery(g.render("dialogGames",e)).modal({persistent:!0,close:!0,destroyOnClose:!0}),w=y.find(".currentTag"),b=y.find("input:text"),C=y.find(".gamesList"),k=y.find(".allTags"),F=y.find(".allGames"),x=y.find(".deleteSessions"),T=y.find(".cancelDeleteSessions"),_=y.find(".nativeScroll.games"),E=y.find(".nativeScroll.tags");return layout(y),Extend.Publisher(f),t(),f.show=function(){return y.modal("show"),layout(y),f},f.hide=function(){return y.modal("hide"),f},f.loading=function(e){return y.find(".loading").toggle(e),f},f.emptyMessage=function(e){return y.find(".empty").toggle(!!e),"search"===e?y.find(".empty span").hide().filter(".searchEmpty").show():"general"===e&&y.find(".empty span").hide().filter(".generalEmpty").show(),f},f.selectAll=function(){return y.find(".selectAll").trigger("click"),f},f.switchToTags=function(e){s(),k.addClass("disabled"),F.removeClass("disabled");var t=jQuery(g.render("tags",{tag:e}));return _.hide(),E.show().find(".nativeScrollInsider").empty().append(t),t.filter(".tag").on("click",function(){
var e=jQuery(this).data("tag");f.setCurrentTag(e),f.emit("tag",{tag:e}),b.val("")}),E.find(".tagsEmpty").toggle(!e.length),E.find(".tagsEmpty a").off("click").on("click",f.switchToGames),f},f.switchToGames=function(){return s(),k.removeClass("disabled"),F.addClass("disabled"),E.hide(),_.show(),f},f.addTags=function(e){y.find(".gamesDialog").addClass("ready");var t=y.find("div.suggestField");return e&&e.length&&e.forEach(function(e){t.suggestField("add",{name:e,value:e})}),y.find(".gamesDialog").on("chess24:select",function(){y.find(".tagCount").html(t.suggestField("count"))}),y.find(".tagCount").html(t.suggestField("count")),y.find(".showTags").on("click",function(){y.find(".pgnTags").toggle(),t.suggestField("adjust"),y.modal("adjust")}),f},f.setCurrentTag=function(e){return w.length&&(e?w.text(e).removeClass("hidden"):w.addClass("hidden")),f},f.addGames=function(t){t=t.map(function(e,t){if(!e.fen){for(var n=0;;){if(!e.moves[n].children||!e.moves[n].children[0])break;n=e.moves[n].children[0]}e.fen=e.moves[n].fen}return e.index=t,e}),v=v.concat(t);var n=jQuery(g.render("dialogGamesList",Object.merge(e,{games:t})));return C.append(n),r(n),f},f.countRendered=function(){return C.find("li").length},f.setupInfiniteLoading=function(e){return y.find(".gamesList li").remove(),y.find(".nativeScrollInsider").lazyload("reset").lazyload(e),f},f.deleteGame=function(e){if(Array.isArray(e)){var t=jQuery();e.forEach(function(e){t=t.add(y.find(".gamesList li[data-id="+e+"]"))})}else t=y.find(".gamesList li[data-id="+e+"]");t.fadeOut(function(){t.remove()}),setTimeout(function(){y.find(".nativeScrollInsider").trigger("scroll")},1e3),s()},window.settings.on("settings.analysis-list-mode.off",function(){for(;p.queue&&p.queue.length;)p.queue.shift()()}),f},"undefined"==typeof Dialog&&(Dialog={}),Dialog.PlayNow=function(e){function n(){return P.init(D,Q),L=new Handler.Pairing,L.off("initGameSession").on("initGameSession",function(e,t){P.close(),N.initGameSession(t)}),L.off("noMatch").on("noMatch",P.noMatch),L.off("informNotAllowed").on("informNotAllowed",P.informNotAllowed),L.off("connectionError").on("connectionError",function(){T(),P.message.show(t("An error occured during connect. Please check your connection."),"red")}),L.off("serverError").on("serverError",function(e){T();var n=e&&e.errorId;if(n)var i=t("An error occured. ErrorId: {{errorId}}",{"{{errorId}}":n});else i=t("An error occured.");P.message.show(i,"red")}),M=!1,V.show(),U.hide(),H.children("a").off("click").on("click",a),G.children("a").off("click").on("click",s),_(),T(),config.level().isGuest||J.remove(),Y.off("click").on("click",w),i(),P}function i(){X.off("slidechange").on("slidechange",function(){var e=X.slider("values");window.settings.set({"play-elo-range-min":e[0],"play-elo-range-max":e[1]})})}function o(){M!==!0&&(z.on("click.timePredefined",function(){d(jQuery(this))}),$.children(".engineAvatar").on("click.engine",function(){u(jQuery(this).parent())}),M=!0)}function r(){M!==!1&&(z.off("click.timePredefined"),$.off("click.engine"),M=!1)}function a(){y(),d(D.find(".playWithHuman a.cTime.active")),c(B),l(B)}function s(e,t){y(),t=t||"claudia";var n="";switch(t){case"casper":n=D.find("li.compCasper");break;case"kevin":n=D.find("li.compKevin");break;case"claudia":n=D.find("li.compClaudia");break;case"magnus":n=D.find("li.compMagnus");break;case"donhugo":n=D.find("li.compDonHugo");break;case"victoria":n=D.find("li.compVictoria")}u(n),c(R),setTimeout(function(){l(R)}),layout.inputElements(U)}function l(e){e===B?(V.slideDown(function(){}),U.slideUp(function(){P.adjust()})):e===R&&(V.slideUp(function(){}),U.slideDown(function(){P.adjust()}))}function c(e){e===B?(G.removeClass("active"),H.addClass("active"),K.removeClass(R).addClass(B)):e===R&&(H.removeClass("active"),G.addClass("active"),K.removeClass(B).addClass(R))}function d(e){z.removeClass("active"),e.addClass("active"),k(JSON.parse(e.attr("clockSettings"))),O()}function u(e){e.hasClass("locked")||($.removeClass("active"),e.addClass("active"),q.prop("disabled",!e.hasClass("rated")),x(e.attr("engineSettings")),O())}function h(){if(!te){var e=p();e.eloRange=g(),e.rated=v(),null!==e&&(S(f()),L.play(e))}}function p(){return H.hasClass("active")?C():G.hasClass("active")?F():{}}function f(){return G.hasClass("active")?!0:!1}function g(){var e=X.data("min-value"),t=X.data("max-value"),n=parseInt(m().min||e,10),i=parseInt(m().max||t,10);return{min:-500!==n?n:void 0,max:500!==i?i:void 0}}function m(){var e={min:window.settings.get("play-elo-range-min"),max:window.settings.get("play-elo-range-max")};return e}function v(){return q.is(":checked")&&!q.prop("disabled")}function y(){L.cancel(),T()}function w(){L.cancel(),P.close()}function b(){var e={clock:window.settings.getNumber("game-clock"),increment:window.settings.getNumber("game-increment")};return e}function C(){var e=z.filter(".active"),t={clock:300,increment:0};return e.length>0&&e[0].attributes.clocksettings&&(t=JSON.parse(e[0].attributes.clocksettings.value)),t}function k(e){K.attr("clockSettings",JSON.stringify(e)),window.settings.set({"game-clock":e.clock,"game-increment":e.increment})}function F(){return JSON.parse(K.attr("engineSettings"))}function x(e){K.attr("engineSettings",e)}function T(){K.removeClass().html(t("Play Now")).addClass("playNowButton human"),K.parent().removeClass("gameSearch").addClass("gameNew"),K.off("click.playNow").on("click.playNow",h),P.message.hide(),K.css("display","inline-block"),W.removeClass("inactive"),o(),I()}function _(){var t={clock:e.settings&&parseInt(e.settings.clock,10)||b().clock,increment:e.settings&&void 0!==e.settings.increment?parseInt(e.settings.increment,10):b().increment};60===t.clock&&0===t.increment?E(".m1"):180===t.clock&&0===t.increment?E(".m3"):300===t.clock&&0===t.increment?E(".m5"):900===t.clock&&0===t.increment?E(".m15"):180===t.clock&&1===t.increment?E(".m3s1"):180===t.clock&&2===t.increment?E(".m3s2"):240===t.clock&&2===t.increment?E(".m4s2"):600===t.clock&&0===t.increment?E(".m10"):1800===t.clock&&0===t.increment?E(".m30"):3600===t.clock&&30===t.increment?E(".m60s30"):(E(".m5"),t.clock=300,t.increment=0),k(t),O()}function E(e){z.removeClass("active"),z.filter(e).addClass("active")}function S(e){if(e=e||!1)var n=t("Connecting to engine");else n=t("Searching for an Opponent");K.removeClass().html(t("stop searching")),K.parent().removeClass("gameNew").addClass("gameSearch"),K.off("click.playNow").on("click.playNow",y),P.message.show(n),W.addClass("inactive"),r(),A()}function j(){K.html(t("try again")),K.removeClass().html(t("try again")).addClass("playNowButton human"),K.off("click.playNow").on("click.playNow",h),K.css("display","inline-block"),P.message.show(t("Unfortunately no Opponent was found"),"cMessage"),W.removeClass("inactive"),o(),I()}function I(){ne&&X.slider("enable"),X.off("slidecreate").on("slidecreate",function(){ne=!0,X.slider("enable")})}function A(){ne&&X.slider("disable")}function O(){if("function"==typeof Z)try{Z(1e3*clockSettings.clock,1e3*clockSettings.increment)}catch(e){}}var M,P=new Dialog.PlayZone(this);const B="human",R="engine";var L,N=Controller.getPlayZone();e.chessGame&&e.chessGame.additionalInformation&&e.chessGame.additionalInformation.lockedEngines&&("w"===e.role?e.lockedEngines=e.chessGame.additionalInformation.lockedEngines.white:"b"===e.role&&(e.lockedEngines=e.chessGame.additionalInformation.lockedEngines.black)),e.chessGame&&e.chessGame.additionalInformation&&e.chessGame.additionalInformation.ratedEngines&&("w"===e.role?e.ratedEngines=e.chessGame.additionalInformation.ratedEngines.white:"b"===e.role&&(e.ratedEngines=e.chessGame.additionalInformation.ratedEngines.black)),e.initialMinValue=parseInt(m().min,10),e.initialMaxValue=parseInt(m().max,10);var D=jQuery(P.templates.render("dialogs.play.content.playNow",e)),Q=jQuery(P.templates.render("dialogs.play.footer.playNow",e));jQuery(".rangeSliderContainer",D).styleRangeSlider();var H=D.find("header li.playWithHuman"),G=D.find("header li.playWithEngine"),V=D.find("section.playWithHuman"),U=D.find("section.playWithEngine"),z=V.find("ul.chooseTimeList > li > a.cTime"),W=V.find("ul"),$=U.find(".chooseCompOpponenet li"),q=U.find(".playRatedGames input"),K=Q.find("li.gameNew > a"),Y=Q.find("li.btnCancel > a"),J=V.find(".chooseEloRange .conversionOverlay"),X=V.find(".chooseEloRange .eloRange > .cPatternSlider");jQuery("body").data("embed")&&Y.remove();var Z,ee,te=!1;P.showHuman=function(){return a(void 0),P},P.showEngine=function(e){return s(void 0,e),P},P.start=function(){return setTimeout(function(){K.trigger("click.playNow")}),P};var ne=!1;return P.noMatch=function(){return j(),P},P.informNotAllowed=function(e,n){switch(n=n||{reason:"limit"},ee=!1,T(),n.reason){case"limit":P.close(),Dialog.conversionRegister("playZone");break;case"playing":P.message.show(t("You are already playing another game."));break;case"tournament":P.message.show(t("You are playing in a currently running tournament!"));break;case"suspended":P.message.show(t("You are temporarily suspended."));break;default:P.message.show(t("You are not allowed to play."))}return P},P.onTimeSelection=function(e){Z=e},P.disable=function(){te=!0,K.addClass("disabled")},P.enable=function(){te=!1,K.removeClass("disabled")},n()},"undefined"==typeof Dialog&&(Dialog={}),Dialog.playZone||(Dialog.playZone={}),function(){var e,t,n=[];Dialog.playZone.playNow=function(t){return e||t||errorHandler.error(new Error("Play now dialog not rendered yet and no data to render.")),t&&(e=new Dialog.PlayNow(t)),e},Dialog.playZone.afterTheGame=function(e){return t||e||errorHandler.error(new Eror("After the game dialog not rendered yet and no data to render.")),e&&(t=new Dialog.AfterTheGame(e)),t},Dialog.PlayZone=function(e){var t=Extend.Publisher(e||this),i={classes:"customPopup",persistent:!0,alignX:".contentContainer",close:!0,destroyOnClose:!0};t.templates=new Handler.Template("playZone");var o=jQuery(t.templates.render("dialogs.play.main"));return t.modalDialog=o,o.on("chess24:show",function(){n.push(o)}).on("chess24:hide",function(){n.removeByValue(o)}),t.init=function(e,n){return o.find(".dialogContent").html(e),o.find(".dialogFooter").html(n),t},t.show=function(e){return e=e||0,setTimeout(function(){o.modal(i).show().on("chess24:hide",function(){t.emit("hide")}),t.emit("afterShow")},e),t},t.setTimeWarning=function(e,n){Dialog.playZone.playNow().onTimeSelection(function(i,o){var r=2*(i+40*o),a=!0;r||(r=72e5),Date.now()+r>=e?n||Date.now()>e?(t.message.show(window.t("You are playing in a currently running tournament!")),a=!1):t.message.show(window.t("Selected timeframe for the game might overlap the tournament that you are enrolled to!")):t.message.hide(),t.toggleAllowed(a)})},t.close=function(){return t.hide(!0)},t.hide=function(e){return e=e||!1,o.modal().hide(e),t.emit("hide"),t},t.message={},t.message.show=function(e,n){n=n||"";var i=o.find(".dialogMessage");return i.removeClass().addClass("dialogMessage cMessage "+n).html(e).stop(!0).slideDown(),t},t.message.hide=function(){var e=o.find(".dialogMessage");return e.is(":visible")&&o.find(".dialogMessage").stop(!0).slideUp(),t},t.adjust=function(){return o.modal("adjust",300),t},t},Dialog.PlayZone.close=function(){for(var e=n.length-1;e>=0;e--)n[e].modal("hide")}}(),"undefined"==typeof Dialog&&(Dialog={}),Dialog.PlayzoneSettings=function(e,t){function n(){function t(e){return function(){u.prop("checked")?d.find(".section.soundSettings")[e?"fadeIn":"show"]():d.find(".section.soundSettings")[e?"fadeOut":"hide"]()}}if(e&&jQuery(e).length)d=jQuery(e);else{var n=new Handler.Template("playZone");d=jQuery(n.render("dialogs.settings",c)),d.modal({destroyOnClose:!0,close:!0,classes:"customPopup"})}i();var l=d.find("[data-settings-save]").length>0;window.settings.attach(d,l);var u=d.find("input[name=sound-category]");o(),r(u,d.find("[data-setting^=game-sound-category]")),r(d.find("input[name=highlight]"),d.find("[data-setting^=game-highlight]")),a(),s(),u.on("change",t(!0)),t(!1)()}function i(){function e(e){e.preventDefault(),n=!0,jQuery(".themeSelector.boards .themeSliderInner div.board.premium").off("click.premium"),jQuery(".themeSelector.pieces .themeSliderInner div.piece.premium").off("click.premium");var i=jQuery(Dialog.conversionGoPremium("premiumBoards",{returnHTML:!0,logo:!1,featureTable:!1,cancelButton:!0,rootClasses:"containerInsiderWrapper"}));i.find(".dialogContent").removeClass().addClass("content position position--h-center"),i.find("h2").removeClass("titleWicon"),i.find(".dialogFooter").addClass("special premium"),i.find(".dialogFooter .cBtnPremium").addClass("test").attr("target","_blank"),jQuery(".containerOverlayConversion .containerInsider").empty().prepend(i),jQuery(".dialogContent").addClass("showConversion"),jQuery(".dialogFooter .btnCancel").on("click",t)}function t(){n&&(jQuery(".dialogContent").removeClass("showConversion"),jQuery(".themeSelector.boards .themeSliderInner div.board.premium").on("click.premium",e),jQuery(".themeSelector.pieces .themeSliderInner div.piece.premium").on("click.premium",e))}var n=!1,i=config.level().isPremium;i?(jQuery(".themeSelector.boards .themeSliderInner div.board.premium").removeClass("premium"),jQuery(".themeSelector.pieces .themeSliderInner div.piece.premium").removeClass("premium")):(jQuery(".themeSelector.boards .themeSliderInner div.board.premium").on("click.premium",e),jQuery(".themeSelector.pieces .themeSliderInner div.piece.premium").on("click.premium",e),jQuery(".themeSelector.boards .themeSliderInner div.board:not(.premium)").on("click.nonpremium",t),jQuery(".themeSelector.pieces .themeSliderInner div.piece:not(.premium)").on("click.nonpremium",t),jQuery("input.premium").on("click",e))}function o(){function e(e){e?l.addClass("cIconSoundOn").removeClass("cIconSoundOff"):l.addClass("cIconSoundOff").removeClass("cIconSoundOn"),soundManager.setVolume("sample-"+r.filter(":checked").val(),e)}function t(){var e=config.assetDir()+"/sounds";r.each(function(){var t=jQuery(this),n=t.val();soundManager.createSound({id:"sample-"+n,url:[{type:"audio/mp3",url:e+"/"+n+"/theme.mp3"},{type:"audio/ogg",url:e+"/"+n+"/theme.oga"},{type:"audio/m4a",url:e+"/"+n+"/theme.m4a"}],autoLoad:!0,autoPlay:!1})})}function n(e,t){soundManager.stopAll();var i=parseInt(a.val(),10);0!==i&&(e=e||r.filter(":checked").val(),s.removeClass("cIconPause").addClass("cIconSoundPlay").filter("[data-theme="+e+"]").addClass("cIconPause").removeClass("cIconSoundPlay"),soundManager.play("sample-"+e,{volume:i,onfinish:function(){s.filter("[data-theme="+e+"]").removeClass("cIconPause").addClass("cIconSoundPlay"),t&&n(e,t)}}))}function i(){if(o.length){var e=!o.get(0).checked;r.each(function(){this.disabled=e})}}var o=d.find("input[data-setting=game-sounds]"),r=d.find("input[data-setting=game-sounds-theme]"),a=d.find("input[data-setting=game-sounds-volume]"),s=d.find(".soundSettings .cIconSoundPlay"),l=d.find(".soundLevel .cIcon");o.on("change",i),i(),a.parent(".cPatternSlider").on("slidestart",function(t,i){n(void 0,!0),e(i.value)}).on("slidestop",function(t,n){soundManager.stopAll(),e(n.value)}).on("slide",function(t,n){e(n.value)}),s.on("click",function(){var e=jQuery(this);e.hasClass("cIconPause")?(soundManager.stopAll(),e.removeClass("cIconPause").addClass("cIconSoundPlay")):n(e.data("theme"))});var c=0;l.on("click",function(){soundManager.stopAll(),l.hasClass("cIconSoundOff")?(a.parent(".cPatternSlider").slider("value",c),c=0):(c=a.val(),a.parent(".cPatternSlider").slider("value",0)),l.toggleClass("cIconSoundOff")}),soundManager.setup({url:config.assetDir()+"/images/swf",flashVersion:9,useHTML5Audio:!0,preferFlash:!1,html5Only:!1,debugMode:!1,onready:t})}function r(e,t){function n(n,i){if(e.length&&!i){var o=!1;t.each(function(){this.checked&&(o=!0)}),e.prop("checked")!=o&&e.prop("checked",o).trigger("change",!0)}}t.on("change",n),n(),e.on("change",function(e,n){if(!n){var i=this.checked;t.each(function(){this.checked!=i&&(this.checked=i,jQuery(this).trigger("change",!0))})}})}function a(){var e=d.find("input[name=engine-local]");e.attr("disabled",!window.settings.getBoolean("game-broadcast-engine")),window.settings.on("settings.game-broadcast-engine.on",function(){e.attr("disabled",!1)}),window.settings.on("settings.game-broadcast-engine.off",function(){e.attr("disabled",!0)})}function s(){Controller.Recommender.setDefaultShowRecommendationPlayzone(),Controller.Recommender.setDefaultShowRecommendationBroadcast()}var l=this,c={isPremium:config.level().isPremium};["broadcast","playzone","tacticTrainer"].contains(t)?c[t]=!0:c.playzone=!0;var d;return l.getContent=function(){return d},n(),l},"undefined"==typeof Dialog&&(Dialog={}),function(){var e=[];Dialog.PlayzoneTournamentGame=function(t,n){function i(){s=jQuery(m.render("dialogs.play.content.playzoneTournamentGame",{title:v.getTitle(t)})),l=s.find(".gameStarted"),c=s.find(".gameWon"),d=s.find(".gameSkipped"),u=s.find(".gameAborted"),h=s.find(".gameBye"),p=s.find(".buttonPlay"),f=s.find(".buttonOverview"),g=s.find(".buttonClose"),s.modal({classes:"customPopup",alignX:".contentContainer",close:!0,destroyOnClose:!0}).on("chess24:show",function(){e.push(s)}).on("chess24:hide",function(){e.removeByValue(s)}),window.settings.attach(s)}function o(){function e(){if(Dialog.Enroll.close(),Dialog.PlayzoneTournamentGame.close(),Dialog.PlayZone.close(),o){var e=Handler.Template.renderString(decodeURIComponent(n),o);a?Handler.singleTab("tournament-game-"+t+"-"+o.roundId,function(){w.showGame(t,o.roundId,o.matchId,o.gameId)}):Handler.singleTab("tournament-game-"+t+"-"+o.roundId,function(){window.location=e})}}var i=v.getAttribute(t,"players");if(i[config.user().uuid]&&!i[config.user().uuid].removed){var o=v.findPlayersGame(t,config.user().uuid);if(o)if("string"==typeof o)if("ABORTED"===o)l.hide(),c.hide(),d.hide(),u.show(),h.hide();else if("TOURNAMENT_BYE"===o){l.hide(),c.hide(),d.hide(),u.hide(),h.show();var r=v.getAttribute(t,"currentRound"),m=v.getAttribute(t,"rounds")[r];errorHandler.warning("tournament.bye",{url:window.location.href,userUuid:config.user().uuid,version:config.version(),dateNow:Date.now(),tournamentId:t,roundId:r,games:m&&m.matches&&m.matches[1]&&m.matches[1].games})}else l.hide(),c.show(),d.hide(),u.hide(),h.hide();else{if(window.settings.getBoolean("game-tournament-immediate"))return void e();l.show(),c.hide(),d.hide(),u.hide(),h.hide()}else l.hide(),c.hide(),d.show(),u.hide(),h.hide();Dialog.Enroll.close(),Dialog.PlayzoneTournamentGame.close(),Dialog.PlayZone.close(),g.on("click",function(){s.modal("hide")}),f.on("click",function(){return s.modal("hide"),a?(w.showOverview(f.attr("href")),!1):!0}),p.on("click",e),s.modal("show")}}var r=this,a=!!jQuery("body > div.liveTournament").length;a=!1;var s,l,c,d,u,h,p,f,g,m=new Handler.Template("playZone"),v=new Controller.BroadcastTournament,y=new Helper.Deferred;if(a){var w=new Controller.Broadcast;y.resolve()}else{var b=Handler.socket.getSocket(Handler.socket.types.NOTIFICATION),C="model:PlayzoneTournamentRedisAR",k=C+":"+t,F={type:C,id:t,rkey:k},x=new Record.TournamentSocketPR(F,b,function(){v.add(x,t),y.resolve()});w=new Controller.Broadcast(jQuery("<div/>"),{norender:!0})}return y.promise.done(function(){i(),o()}),r},Dialog.PlayzoneTournamentGame.close=function(){for(var t=e.length-1;t>=0;t--)e[t].modal("hide")}}(),"undefined"==typeof Dialog&&(Dialog={}),Dialog.UserMessage=function(e){function t(){return a?(n(),a.modal({classes:"defaultPopup",destroyOnClose:!0,close:!0}).modal("show"),void s.focus()):(errorHandler.msg("critical",new Error("No template loaded for Message Send"),!0),{})}function n(){l.click(function(t){t.preventDefault(),l.hasClass("cBtnInactive")||(c.hide(),l.addClass("cBtnInactive"),conversationHandler.sendPrivateMessage(e,s.val(),function(e){!e||e.sent?i():l.removeClass("cBtnInactive")}))})}function i(){a.modal("hide")}var o=this,r=new Handler.Template,a=jQuery(r.render("userMessage")),s=a.find(".messageBody"),l=a.find(".messageSubmit"),c=a.find(".cFormErrors");({csrf:config.csrf()});return o.getContent=function(){return a},t(),o},"undefined"==typeof Dialog&&(Dialog={}),function(){function e(e,t,n,i,r){var a={csrf:config.csrf(),source:e,reason:t,reported_user_uuid:n,description:i,reference_id:r},s=o+"sendReport";jQuery.post(s,a,function(){Dialog.userReportConfirmation()},"json").fail(function(e){var t=e.responseJSON,n=t&&t.data&&t.data.message,i=n?t.data.message:"report failed, unknown reason...";Dialog.alert(i)})}var t=0,n=1,i=2,o="/api/web/userReportAPI/",r=!1;Dialog.userReport=function(a,s){if(r)return self;var l;switch(a.source){case"playzone":l=n;break;case"tactic-trainer":l=i;break;default:l=t}var c=o+"getReportData",d={language:window.config.language(),source:l};r=!0,jQuery.get(c,d,function(t,n){if(r=!1,0===t.status){var i=new Handler.Template("dialogs");t.data.users=a.users;var o=jQuery(i.render("userReport",t.data)).modal({classes:"customPopup commonDialog",close:!0,persistent:!0,alignX:".contentContainer",destroyOnClose:!0});$inputReason=o.find("#inputReason"),$inputUser=o.find("#inputUser"),$inputDescription=o.find("#inputDescription"),$charactersLeft=o.find("#charactersLeft"),descriptionMaxLen=2e3,$charactersLeft.text(descriptionMaxLen);var c=o.find(".btnOk > a");c.on("click",function(){if(!c.hasClass("disabled")){o.modal("hide",!0);var t=$inputReason.find(":selected").val(),n=$inputUser.find(":selected").val(),i=$inputDescription.val();"function"==typeof s?s(t,i):e(l,t,n,i,a.referenceId)}});var d=o.find(".btnCancel > a");d.on("click",function(){o.modal("hide",!0)});var u=o.find("#inputReason");u.on("change",function(){2==$(this).val()?o.find("div.reportUser").css("display","inline"):o.find("div.reportUser").css("display","none")});var h=function(){var e=$inputReason.find(":selected").val(),t=$inputUser.find(":selected").val(),n=$inputDescription.val();""===e||!n&&2!=e||2==e&&""==t?c.addClass("disabled"):c.removeClass("disabled"),$charactersLeft.text(descriptionMaxLen-n.length),n.length>=descriptionMaxLen&&$inputDescription.val(n.substr(0,descriptionMaxLen))};return $inputReason.change(h),$inputUser.change(h),$inputDescription.on("keyup",h),o.modal("show"),o.find("div.reportUser").css("display","none"),o}},"json").fail(function(e,t,n){r=!1})},Dialog.userReportConfirmation=function(){var e=new Handler.Template("dialogs"),t=jQuery(e.render("userReportConfirmation")).modal({classes:"customPopup commonDialog",close:!0,persistent:!0,alignX:".contentContainer",destroyOnClose:!0}),n=t.find(".btnOk > a");return n.on("click",function(){t.modal("hide",!0)}),t.modal("show"),t}}();var PuzzleFactory=function(){function e(e,n){if(t=t||new Handler.Template("puzzle"),"multiple_choice"===n.type){for(var i=!1,l=0;l<n.options.length;l++)if(n.options[l].fen){i=!0;break}return i?new r(e,n):new o(e,n)}if("move"===n.type)return new a(e,n);if("select_tiles"===n.type)return new s(e,n);throw new Error("I don't know exercise type "+n.type)}var t,n=inheritable.extend({__constructor:function(e,t){throw new Error("BasePuzzle can't be instantiated")},init:function(e,t){return Extend.Publisher(this),this.container=jQuery(e),this.data=t,this},start:function(){return this.html=this.buildHtml(),this},remove:function(){return this.container.html(""),this},submit:function(){return this},feedback:function(e){return this.emit(e?"success":"failure"),this},buildHtml:function(){return{}},highlightAnswer:function(){return this},stop:function(){return this},getAnswer:function(){return[]},setSubmitBtn:function(e){var t=this;this.html.submitBtn?this.html.submitBtn.remove():this.container.find("a.puzzleSubmitBtn").remove(),this.html.submitBtn=e,this.html.submitBtn.on("click",function(){t.submit()})},giveAnswer:function(e){return this},showGameHighlights:function(e,t){if(!e||!t||!t.length)return!1;for(var n=0;n<t.length;n++){var i=t[n];"square"===i.type?e.addHighlight({color:i.color,frame:Chess.getSquare(i.y,i.x)}):"arrow"===i.type&&e.addHighlight({color:i.color,line:Chess.translate.canToMove(i.from+i.to)})}}}),i=n.extend({__constructor:function(e,t){throw new Error("MultipleChoicePuzzle can't be instantiated")},submit:function(){if(0==this.selectedOptions().length||this.html.submitBtn.hasClass("cBtnInactive"))return this;for(var e=[],t=0;t<this.data.options.length;t++)this.data.options[t].correct&&e.push(t);var n=this.selectedOptions();return e.sort(),n.sort(),this.feedback(e.join("-")==n.join("-")),this},selectedOptions:function(){var e=[];return this.html.options.each(function(){var t=jQuery(this);t.is(":checked")&&e.push(parseInt(t.data("index")))}),e},getOptionContainers:function(){return null},highlightAnswer:function(){var e=this.getOptionContainers();e.removeClass("correct").removeClass("incorrect");for(var t={},n=0;n<this.data.options.length;n++)if(this.data.options[n].correct){t[n]=n;var i=jQuery(e.get(n));i.addClass("correct"),i.removeClass("checked")}for(var o=this.selectedOptions(),r=0;r<o.length;r++){var a=o[r];if(!t.hasOwnProperty(a)){var i=jQuery(e.get(a));i.addClass("incorrect"),i.removeClass("checked")}}return this},getAnswer:function(){return this.selectedOptions()},afterBuildHtml:function(e){var t=this;e.options.on("change",function(){return 0==t.selectedOptions().length?e.submitBtn.addClass("cBtnInactive"):e.submitBtn.removeClass("cBtnInactive"),!0})}}),o=i.extend({__constructor:function(e,t){this.init(e,t)},feedback:function(e){return this.highlightAnswer(),this.parent.feedback(e),this},buildHtml:function(){for(var e=this,n=0;n<this.data.options.length;n++)this.data.options[n].index=n;var i=t.render("puzzle-text",this.data);if(!i)return errorHandler.msg("critical",new Error("No template loaded for TextMultipleChoicePuzzle"),!0),{};if(this.container.html(i),this.data.header_fen){var o=new Chess.Game({fen:this.data.header_fen});new View.ChessBoard(this.container.find(".textExerciseBoard"),!1).link(o),this.showGameHighlights(o,this.data.header_highlights)}else this.container.find(".textExerciseBoard").remove();var r={question:this.container.find("h3"),options:this.container.find("ul input[type=checkbox]"),submitBtn:this.container.find("a")};return layout.inputElements(r.options),r.submitBtn.on("click",function(){e.submit()}),r.options.on("change",function(){var e=jQuery(this).parents(".puzzleOptionContainer");return this.checked?e.addClass("checked"):e.removeClass("checked"),!0}),this.afterBuildHtml(r),r},getOptionContainers:function(){return this.container.find(".puzzleOptionContainer")},stop:function(){return this.container.find('input[type="checkbox"]').attr("disabled","disabled"),this},giveAnswer:function(e){for(var t=0;t<e.length;t++){var n=this.container.find(".puzzleOptionContainer.puzzleOptionContainer"+e[t]+" label.checkBox");jQuery(n).trigger("click")}return this.submit(),this}}),r=i.extend({__constructor:function(e,t){this.init(e,t)},feedback:function(e){return this.highlightAnswer(),this.parent.feedback(e),this},buildHtml:function(){for(var e=this,n=0;n<this.data.options.length;n++)this.data.options[n].index=n;var i=t.render("puzzle-boards",this.data);if(!i)return errorHandler.msg("critical",new Error("No template loaded for TextMultipleChoicePuzzle"),!0),{};this.container.html(i);var o={question:this.container.find("h3"),options:this.container.find("ul input[type=checkbox]"),submitBtn:this.container.find("a.cBtn")};o.options.length%2==0&&this.container.find(".puzzleBoardOptionContainer.last").remove();for(var r=this.container.find("ul .board"),n=0;n<this.data.options.length;n++){var a=new Chess.Game({fen:this.data.options[n].fen});new View.ChessBoard(r.eq(n),!1).link(a)}var s=this.container.find(".boardOverlay");return jQuery.each(s,function(t,n){var i=jQuery(n);i.on("mouseover",function(){i.addClass("mouseOver")}),i.on("mouseout",function(){i.removeClass("mouseOver")}),i.click(function(){e.triggerBoardSelection(t)})}),o.submitBtn.on("click",function(){e.submit()}),this.afterBuildHtml(o),o},triggerBoardSelection:function(e){var t=this.container.find('input[type="checkbox"][data-index='+e+"]"),n=jQuery(this.container.find(".puzzleBoardOptionContainer").get(e));if(t.prop("checked"))t.prop("checked",!1),t.triggerHandler("change"),n.removeClass("checked");else{var i=this.container.find(".puzzleBoardOptionContainer");i.removeClass("checked");var o=this.container.find('input[type="checkbox"]');o.prop("checked",!1),t.prop("checked",!0),t.triggerHandler("change"),n.addClass("checked")}return this},getOptionContainers:function(){return this.container.find(".puzzleBoardOptionContainer")},stop:function(){return this.container.find(".boardOverlay").off("mouseover mouseout click"),this},giveAnswer:function(e){for(var t=0;t<e.length;t++){var n=this.container.find(".puzzleBoardOptionContainer").get(e[t]),i=jQuery(n).find(".boardOverlay");jQuery(i).trigger("click")}return this.submit(),this}}),a=n.extend({__constructor:function(e,t){this.init(e,t)},start:function(){var e=this,t=!0;return this.html=this.buildHtml(),this.game=new Chess.Game({fen:this.data.fen}).setCheckForGameEnd(!1),this.html.board.link(this.game),"b"===this.game.getCurrentPosition().moveRight&&this.game.emit("flipBoard"),this.html.board.movementHandler.switchAutoQueen(!1),new View.Color(this.html.nextColorIndicator,"b").link(this.game),this.showGameHighlights(this.game,this.data.highlights),this.unifiedMoves=this.parseMoves(e.data.moves),this.currentLine=this.unifiedMoves.slice(),this.userMoves=[],this.listener=function(n,i){if(!t)return t=!0,void e.currentLine.splice(0,1);var o=!1;if(i.getSan()===e.currentLine[0].move.replace("=",""))o=!0;else for(var r=0;r<e.currentLine[0].sublines.length;r++)if(i.moveCoords===Chess.translate.sanToMove(e.currentLine[0].sublines[r][0].move,i.parentMove)){e.currentLine=e.currentLine[0].sublines[r],o=!0;break}e.userMoves.push(i.getSan()),o?(e.currentLine.splice(0,1),e.currentLine.length>0?(t=!1,e.rebuildingAnswer!==!0?setTimeout(function(){e.game.moveSan(e.currentLine[0].move)},500):e.game.moveSan(e.currentLine[0].move)):setTimeout(function(){e.feedback(!0)},e.rebuildingAnswer?1:1e3)):setTimeout(function(){e.feedback(!1)},e.rebuildingAnswer?1:1e3)},this.game.on("movedPositionPointer.current",this.listener),this},parseMoves:function(e){if(e.length&&e[0].move)return e;for(var t=[],n=0;n<e.length;n++)t.push({move:e[n],sublines:[]});return t},remove:function(){return this.html.board.unlink(this.game),this.parent.remove(),this},feedback:function(e){this.game.getCurrentPosition();return this.answer=this.userMoves,this.highlightAnswer(e),this.parent.feedback(e),this.html.nextColorIndicator.hide(),this},buildHtml:function(){var e=t.render("puzzle-move",this.data);if(!e)return errorHandler.msg("critical",new Error("No template loaded for TextMultipleChoicePuzzle"),!0),{};this.container.html(e);var n={question:this.container.find("h3"),board:new View.ChessBoard(this.container.find(".board"),!0),nextColorIndicator:this.container.find(".puzzleMoveNextColor")};return n},highlightAnswer:function(e){function t(e){for(var n=0;n<e.length;n++){var o=i.game.getCurrentPosition();i.game.moveSan(e[n].move,void 0,!0);var s=i.game.getCurrentPosition();if(o.knotId==r.knotId&&!a){var l=o.childrenMoves[0];o.childrenMoves[0]=o.childrenMoves[1],o.childrenMoves[1]=l,a=!0}for(var c=0;c<e[n].sublines.length;c++)i.game.gotoParentPosition(),t(e[n].sublines[c]),i.game.setCurrentPosition(s)}}var n=this.container.find(".puzzleChessBoard");if(this.game.off("movedPositionPointer.current",this.listener),e)n.addClass("correct");else{n.addClass("incorrect");var i=this,o=this.game.getCurrentPosition(),r=o.parentMove,a=!1;this.game.gotoStart(),t(this.unifiedMoves),this.game.gotoStart();var s=this.container.find(".puzzleMoveNotation");s.show(),new View.FloatingNotation(s).link(this.game),s.find(".moveId_"+o.knotId).addClass("wrongMove")}return this},stop:function(){return this.container.find(".boardOverlay").show(),this},getAnswer:function(){return this.answer},giveAnswer:function(e){this.rebuildingAnswer=!0;for(var t=0;t<e.length;t++)this.game.moveSan(e[t]);return this}}),s=n.extend({__constructor:function(e,t){this.init(e,t)},start:function(){
var e=this;e.selectedSquares={},this.html=this.buildHtml(),this.game=new Chess.Game({fen:this.data.fen}),this.html.board.link(this.game);var t={a:"0",b:"1",c:"2",d:"3",e:"4",f:"5",g:"6",h:"7"},n={1:"0",2:"1",3:"2",4:"3",5:"4",6:"5",7:"6",8:"7"};this.correctSquares=[];for(var i=0;i<this.data.squares.length;i++){var o=this.data.squares[i];this.correctSquares.push(n[o[1]]+t[o[0]])}return this.game.setMoveMode({duringGame:{mainline:!1,sideline:!1},afterGame:{mainline:!1,sideline:!1}}),new View.Color(this.html.nextColorIndicator,"b").link(this.game),this.showGameHighlights(this.game,this.data.highlights),this.container.find(".board .cell").on("click",function(){var t=jQuery(this).data("coordinates");return e.game.addHighlight({color:"green",frame:Chess.getSquare(t[0],t[1])}),e.selectedSquares[t]?delete e.selectedSquares[t]:e.selectedSquares[t]=t,Object.keys(e.selectedSquares).length>0?e.html.submitBtn.removeClass("cBtnInactive"):e.html.submitBtn.addClass("cBtnInactive"),!1}),this},buildHtml:function(){var e=this,n=t.render("puzzle-select-tiles",this.data);if(!n)return errorHandler.msg("critical",new Error("No template loaded for SelectTilesPuzzle"),!0),{};this.container.html(n);var i={board:new View.ChessBoard(this.container.find(".board"),!1),submitBtn:this.container.find("a"),nextColorIndicator:this.container.find(".puzzleMoveNextColor")};return i.submitBtn.on("click",function(){e.submit()}),i},remove:function(){return this.html.board.unlink(this.game),this.parent.remove(),this},feedback:function(e){return this.answer=this.selectedSquares,this.highlightAnswer(e),this.parent.feedback(e),this.html.nextColorIndicator.hide(),this},submit:function(){if(0==Object.keys(this.selectedSquares).length||this.html.submitBtn.hasClass("cBtnInactive"))return this;var e=[];for(var t in this.selectedSquares)e.push(t);var n=this.correctSquares.slice();return n.sort(),e.sort(),this.feedback(n.join("-")==e.join("-")),this},highlightAnswer:function(e){var t=this.container.find(".puzzleChessBoard");if(e)t.addClass("correct");else{t.addClass("incorrect");for(var n=[],i=Object.merge(this.selectedSquares),o=0;o<this.correctSquares.length;o++){var r=this.correctSquares[o];this.selectedSquares[r]?delete i[r]:n.push(r)}for(var o=0;o<n.length;o++)this.game.addHighlight({color:"green",frame:Chess.getSquare(n[o][0],n[o][1])});for(var r in i)this.game.addHighlight({color:"red",frame:Chess.getSquare(r[0],r[1])})}return this},stop:function(){return this.container.find(".boardOverlay").show(),this},getAnswer:function(){return this.answer},giveAnswer:function(e){for(var t in e)this.container.find(".board .cell._"+t).trigger("click");return this.submit(),this}});return e}();if("undefined"==typeof TacticTrainer&&(TacticTrainer={}),TacticTrainer.PuzzleHandler=inheritable.extend({__constructor:function(e,t,n){var i=this;return Extend.Publisher(this),this.settings=jQuery.extend({},n),this.container=jQuery(e),this.puzzle=t.puzzle,this.id=t.id||TacticTrainer.PuzzleHandler.nextId++,this.game=Chess.couchToGame(t.puzzle),this.started=Date.now(),this.playing=!1,this.expecting=[],this.result={status:"progress",time:0,failure:void 0},this.html=this.buildHtml(),TacticTrainer.PuzzleHandler.handler||(TacticTrainer.PuzzleHandler.handler=new Chess.GameHandler),TacticTrainer.PuzzleHandler.handler.addGame(this.id,this.game).setCurrentGame(this.id),this.board=new View.ChessBoard(this.html.board,!0),this.sound=new View.Sound("tactic"),this.listening=!1,this.subscriber={movedPositionPointer:function(){i.listening&&setTimeout(function(){i.check()},1)},afterLink:function(){i.board.link(TacticTrainer.PuzzleHandler.handler),i.board.movementHandler.switchAutoQueen(!1),i.board.movementHandler.setPremove(!1),i.sound.link(TacticTrainer.PuzzleHandler.handler),TacticTrainer.PuzzleHandler.handler.gotoStart();var e=i.game.getCurrentPosition();t.lastmove?("w"===e.moveRight&&i.board.flip(),TacticTrainer.PuzzleHandler.handler.gotoNextPosition(),e=i.game.getCurrentPosition()):"b"===e.moveRight&&i.board.flip(),i.sound.setUserRole(e.moveRight),i.expecting=[];for(var n=0;n<e.childrenMoves.length;n++)i.expecting.push(e.childrenMoves[n].knotId);i.listening=!0;var o=i.game.getMoveRight();i.html.mr.white["w"===o?"show":"hide"](),i.html.mr.black["b"===o?"show":"hide"](),i.html.mr.you.show(),i.hint()}},Extend.Subscriber(this.subscriber,this.subscriber,this.subscriber),this.subscriber.link(TacticTrainer.PuzzleHandler.handler),this},start:function(){},cancel:function(e){return"progress"!==this.result.status?this:(this.listening=!1,this.result.time=(Date.now()-this.started)/1e3,this.result.status=e?"failure":"cancelled",this.cleanup(),this)},ended:function(e,t){return"progress"!==this.result.status?this:(this.listening=!1,this.result.time=(Date.now()-this.started)/1e3,this.result.status=e?"success":"failure",t&&(this.result.failure=t),this.showFeedback(e),this.cleanup(),this.emit(e?"success":"failure"),this)},cleanup:function(){this.sound.unlink(TacticTrainer.PuzzleHandler.handler),this.subscriber.unlink(TacticTrainer.PuzzleHandler.handler)},remove:function(){return this.container.html(""),this.cleanup(),this},check:function(){var e=this,t=this.game.getCurrentPosition();if(this.html.mr.you.hide(),this.expecting.contains(t.knotId))if(t.childrenMoves&&0!==t.childrenMoves.length){this.listening=!1;var n=Math.floor(Math.random()*t.childrenMoves.length);TacticTrainer.PuzzleHandler.handler.gotoId(t.childrenMoves[n].knotId),t=this.game.getCurrentPosition(),this.expecting=[];for(var i=0;i<t.childrenMoves.length;i++)this.expecting.push(t.childrenMoves[i].knotId);this.listening=!0,0===t.childrenMoves.length?e.ended(!0):setTimeout(function(){e.html.mr.you.show()},500),this.hint()}else e.ended(!0);else e.ended(!1,t.knotId)},summary:function(){return this.result},showFeedback:function(e){this.html.feedback.border.addClass(e?"success":"failure"),this.html.feedback.overlay.show().addClass(e?"success":"failure").animate({opacity:0},1e3)},buildHtml:function(){var e=this,t=new Handler.Template("tacticTrainer");return this.container.html(t.render("tactics-puzzle",{id:this.id,hint:"classic"===this.settings.type,hinttime:Math.round(.33*(this.puzzle.duration||TacticTrainer.BaseServer.DURATION))})),this.container.find(".hint").on("click",function(){e.hintFigure()}),{board:this.container.find(".tacticTrainerBoard"),feedback:{border:this.container.find(".tacticTrainerFeedback"),overlay:this.container.find(".tacticTrainerFadingFeedback")},mr:{white:this.container.find(".tacticMoveRight.white"),black:this.container.find(".tacticMoveRight.black"),you:this.container.find(".tacticYourMove .yourmove")}}},hint:function(){return this},hintFigure:function(){var e=this;return setTimeout(function(){var t=e.game.getCurrentPosition();if(t.childrenMoves[0]){var n=t.childrenMoves[0].moveCoords;e.board.highlightHandler.highlightCellTake(n.y1+""+n.x1,"red",!1)}},1),this.emit("hint"),this}}),TacticTrainer.PuzzleHandler.nextId=1,"undefined"==typeof TacticTrainer&&(TacticTrainer={}),TacticTrainer.PuzzleProvider=inheritable.extend({__constructor:function(e){var t={type:"classic",preload:4,preloadAt:2,url:"/api/web/TacticTrainerAPI/<action>",reset:!0};this.current=void 0,this.settings=jQuery.extend({},t,e),this.queue=[],this.sessionId="",this.stop=!1,this.stat={elo:0,success:0,failure:0};var n=location.pathname.split("/")[5];return n&&(this.sessionId=n),this},get:function(e,t){this.queue.length?(e(this.queue.shift()),!t&&this.queue.length<=this.settings.preloadAt&&(this.stop||this.preload())):t?e(null,this.stop):this.preload(e)},preload:function(e){var t=this,n=this.settings.url.replace("<action>","get");return n+="?count="+this.settings.preload+"&type="+this.settings.type,this.settings.reset?n+="&session="+this.sessionId:this.settings.reset=!1,jQuery.getJSON(n,function(n){0==n.status&&(t.sessionId=n.data.session,n.data.puzzles?t.queue=t.queue.concat(n.data.puzzles):t.stop=n.data.empty||!0,e&&t.get(e,!0))}).fail(function(){this.stop=!0,e&&t.get(e,!0)}),this},report:function(e,t){var n=this,i=this.settings.url.replace("<action>","report");e.session=this.sessionId,e.csrf=config.csrf(),jQuery.post(i,e,function(e){0==e.status&&("function"==typeof t&&t(e.data),e.data&&(n.stat.elo=e.data.eloNew))}).fail(function(){t(null)})},summary:function(){return this.stat},promise:function(e,t){"function"==typeof e&&"undefined"==typeof t&&(t=e,e=void 0);var n=this.settings.url.replace("<action>","promise");n+="?session="+this.sessionId+(e?"&promise="+e:""),jQuery.getJSON(n,function(e){0==e.status&&t(e.data)}).fail(function(){t(null)})}}),"undefined"==typeof TacticTrainer&&(TacticTrainer={}),TacticTrainer.BaseServer=inheritable.extend({__constructor:function(e,t){throw new Error("I'm not supposed to be instantiated, please use my children")},type:function(){return void 0},showError:function(e,t){this.showSummary();var n=jQuery('<div class="popupWithClose popupInsider"/>').append(jQuery('<div class="dialogContent"/>').append("<h3>"+e+"</h3>"+(t?"<p>"+t+"</p>":""))).append(jQuery('<div class="dialogFooter"/>').append(jQuery('<a class="cBtn cBtnGrey">'+window.t("Close")+"</a>").on("click",function(){n.modal("hide")})));n.modal({destroyOnClose:!0,classes:"defaultPopup"}).modal("show")},showSettings:function(){new Dialog.PlayzoneSettings(void 0,"tacticTrainer").getContent().modal("show")},init:function(e){Extend.Publisher(this),this.container=jQuery(e).show(),this.session=[],this.results={},this.currentpuzzle=null,this.readonly=!1,this.html=this.buildHtml(),this.timeline=new TacticTrainer.Timeline(this.html.timeline)},start:function(){var e=this;this.resetTimer(!0);var t=function(){var t=(Date.now()-e.startedSession)/1e3,n=(Date.now()-e.startedPuzzle)/1e3;e.timer(n,t)};clearTimeout(this.timeout),this.timeout=setInterval(t,100),this.puzzle(!0)},stop:function(e){return this},next:function(e){return this},proceed:function(){return this},puzzle:function(e){var t=this;return this.timeline.update(this.session,!0),this.toggleKeyboard(!1),this.handler&&this.handler.remove(),this.provider.get(function(n,i){return t.resetTimer(),n?(t.handler=new TacticTrainer.PuzzleHandler(t.html.puzzle,n,{type:t.type()}),t.currentpuzzle={status:"none",lastmove:n.lastmove,handlerId:t.handler.id,puzzleId:parseInt(n.id),avg:parseFloat(n.avg),likes:parseInt(n.likes)||0,unlikes:parseInt(n.unlikes)||0,iLiked:!!n.iliked,iUnliked:!!n.iunliked,eloPuzzle:parseInt(n.elo),eloUser:t.feedback&&t.feedback.eloUser?parseInt(t.feedback.eloUser):void 0,eloSuccess:t.feedback&&t.feedback.eloSuccess?parseInt(t.feedback.eloSuccess):void 0,eloFailure:t.feedback&&t.feedback.eloFailure?parseInt(t.feedback.eloFailure):void 0,eloResult:void 0},t.feedback=null,t.session.push(t.currentpuzzle),e&&(t.subsessionStart=t.session.length-1),(1==t.session.length||e)&&t.provider.promise(t.session[t.subsessionStart].puzzleId,function(e){return e?(t.startElo=parseInt(e.eloUser),t.currentpuzzle.eloSuccess=parseInt(e.eloSuccess),t.currentpuzzle.eloFailure=parseInt(e.eloFailure),void(t.currentpuzzle.eloUser=parseInt(e.eloUser))):void t.showError(window.t("Your session is expired. Please restart the session."))}),t.handler.on("success",function(){t.next(!0,!0)}).on("failure",function(){t.next(!1,!0)}).on("hint",function(){t.currentpuzzle&&(t.startedPuzzle-=.33*(t.currentpuzzle.duration||TacticTrainer.BaseServer.DURATION)*1e3),t.handler.started-=.33*(t.currentpuzzle.duration||TacticTrainer.BaseServer.DURATION)*1e3}),void t.handler.start()):void("guest"==i?(Dialog.conversionRegister("tacticTrainer"),t.showSummary()):"daily"==i?(Dialog.conversionGoPremium("tacticTrainer"),t.showSummary()):t.showError(window.t("There are no more puzzles left to show"),window.t("Most likely it is because you solved all of the puzzles within your level range.")))}),this},timer:function(e){return this},resetTimer:function(e){return this.startedPuzzle=Date.now(),e&&(this.startedSession=this.startedPuzzle),this},stopTimer:function(){return clearTimeout(this.timeout),this},keydown:function(e){var t=TacticTrainer.PuzzleHandler.handler.getCurrentPosition(),n=!1;if(37==e.which)TacticTrainer.BaseServer.dialog&&(TacticTrainer.BaseServer.dialog.remove(),TacticTrainer.BaseServer.dialog=null),t.parentMove&&TacticTrainer.PuzzleHandler.handler.gotoId(t.parentMove.knotId);else if(39==e.which)if(TacticTrainer.BaseServer.dialog)TacticTrainer.BaseServer.dialog.select().remove(),TacticTrainer.BaseServer.dialog=null;else if(t.childrenMoves.length>1){for(var i=[],o=0;o<t.childrenMoves.length;o++){var r=t.childrenMoves[o].getSan();i.push({id:t.childrenMoves[o].knotId,text:("w"==t.moveRight?t.moveCounter+". ":t.moveCounter+"... ")+r})}TacticTrainer.BaseServer.dialog=new popupList(i,function(e){TacticTrainer.PuzzleHandler.handler.gotoId(e),TacticTrainer.BaseServer.dialog.remove(),TacticTrainer.BaseServer.dialog=null})}else 1==t.childrenMoves.length&&TacticTrainer.PuzzleHandler.handler.gotoId(t.childrenMoves[0].knotId);else 38==e.which?TacticTrainer.BaseServer.dialog&&(TacticTrainer.BaseServer.dialog.up(),n=!0):40==e.which?TacticTrainer.BaseServer.dialog&&(TacticTrainer.BaseServer.dialog.down(),n=!0):13==e.which?TacticTrainer.BaseServer.dialog&&(TacticTrainer.BaseServer.dialog.select().remove(),TacticTrainer.BaseServer.dialog=null):27==e.which&&TacticTrainer.BaseServer.dialog&&(TacticTrainer.BaseServer.dialog.remove(),TacticTrainer.BaseServer.dialog=null,n=!0);if(n)try{e.preventDefault(),e.stopPropagation()}catch(a){e.cancelBubble=!0,e.returnValue=!1}},cursorEvents:function(e){var t=!0;"chess24:lastmove"==e.type?TacticTrainer.PuzzleHandler.handler.gotoEndOfLine():"chess24:firstmove"==e.type?TacticTrainer.PuzzleHandler.handler.gotoStart():"chess24:previousmove"==e.type?TacticTrainer.PuzzleHandler.handler.gotoParentPosition():"chess24:nextmove"==e.type&&(t=!1,e.which=39,this.keydown(e)),t&&TacticTrainer.BaseServer.dialog&&(TacticTrainer.BaseServer.dialog.remove(),TacticTrainer.BaseServer.dialog=null)},importSession:function(e){TacticTrainer.PuzzleHandler.handler||(TacticTrainer.PuzzleHandler.handler=new Chess.GameHandler),this.session=[];for(var t=0;t<e.puzzles.length;t++){this.session.push(e.puzzles[t]);var n=Chess.couchToGame(e.puzzles[t].puzzle);if(e.puzzles[t].failure){try{var i=n.getPositionByKnotId(parseInt(e.puzzles[t].failureat));n.moveSan(e.puzzles[t].failure.trim(),i,!1);for(var o=0;o<i.childrenMoves.length;o++)i.childrenMoves[o].getSan()==e.puzzles[t].failure&&(e.puzzles[t].failure=i.childrenMoves[o].knotId)}catch(r){}e.puzzles[t].failureat=void 0}TacticTrainer.PuzzleHandler.handler.addGame(e.puzzles[t].id,n).setCurrentGame(n)}this.subsessionStart=0,this.readonly=!0},showSummary:function(e,t){var n=this;if(!this.html||!this.html.summary)return this;if(e&&this.importSession(e),TacticTrainer.PuzzleHandler.handler||(TacticTrainer.PuzzleHandler.handler=new Chess.GameHandler),this.report.working)return setTimeout(function(){n.showSummary()},50),this;var i=n.container.siblings(".tacticTrainerDashboard"),o=function(e){var o="w";e.tempo=Math.round(10*e.tempo)/10,e.time=0,e.countFailure=0;for(var r=0;r<e.puzzles.length;r++)e.time+=e.puzzles[r].time,e.countFailure+="failure"==e.puzzles[r].status?1:0;e.time=Math.round(10*e.time)/10,e[n.type()]=!0,e.readonly=n.readonly,e.standalone=!!t,e.eloChange=e.eloChange,e.eloChangeDisplay=Math.abs(e.eloChange),n.timeline.update(n.session,!1).callback(function(t,i){for(var r=0;r<e.puzzles.length;r++)if(e.puzzles[r].id==t){n.summaryDetails(e.puzzles[r],i);break}var a=TacticTrainer.PuzzleHandler.handler.getMoveRight();"1"==e.puzzles[r].lastmove&&(a="w"==a?"b":"w"),o!=a&&(n.summary.board.flip(),o=a);var s=n.html.summary.find(".analysis"),l=Handler.Template.renderString(s.data("url"),{sessionId:n.provider.sessionId,puzzleId:e.puzzles[r].id});s.attr("href",l)}),n.html.puzzleBundle.hide(),n.html.summary.html(new Handler.Template("tacticTrainer").render("tactics-summary",e)).show(),n.container.removeClass("smaller"),n.summary={},e.countTotal?(n.summary.board=new View.ChessBoard(n.html.summary.find(".board"),!1).link(TacticTrainer.PuzzleHandler.handler),n.summary.sound=new View.Sound("tactic").link(TacticTrainer.PuzzleHandler.handler),n.summary.cursor=new View.Cursor(n.html.summary.find(".cursor")).link(TacticTrainer.PuzzleHandler.handler),n.summary.notation=new View.FloatingNotation(n.html.summary.find(".notation")).link(TacticTrainer.PuzzleHandler.handler),n.summary.cursor.switchEventBased(!0)):n.summary.board=new View.ChessBoard(n.html.summary.find(".board"),!1),n.timeline.engage(n.subsessionStart),n.html.summary.find(".settings").on("click",n.showSettings),n.html.summary.find("a.continue").on("click",function(){n.proceed()}),n.html.summary.find("a.overview").on("click",function(){n.container.hide(),$("div.globalSharing").removeClass("withComments"),i.show()}),n.html.summary.find("a.classic").on("click",function(){n.hideSummary(),new TacticTrainer.ClassicServer(n.container).start()}),n.html.summary.find("a.speed").on("click",function(){var e,t=window.settings.getNumber("tactics-length"),i=function(t){e.modal("hide").remove(),n.hideSummary(),new TacticTrainer.SpeedServer(n.container,{time:60*t}).start()},o=function(n){return function(){t=n,e.find(".chooseTimeList a").removeClass("active"),jQuery(this).addClass("active")}};e=jQuery("<div/>").addClass("popupInsider").append(jQuery("<div/>").addClass("dialogContent").append(jQuery("<h3>"+window.t("Tactic Trainer Speed")+"</h3>")).append(jQuery("<p>"+window.t("Please choose a time interval")+"</p>")).append(jQuery('<ul class="chooseTimeList"/>').append(jQuery("<li/>").append(jQuery("<a/>").addClass("cTime m1"+(1==t?" active":"")).html(window.t("<strong>1</strong> min")).on("click",o(1)))).append(jQuery("<li/>").append(jQuery("<a/>").addClass("cTime m3"+(3==t?" active":"")).html(window.t("<strong>3</strong> min")).on("click",o(3)))).append(jQuery("<li/>").append(jQuery("<a/>").addClass("cTime m5"+(5==t?" active":"")).html(window.t("<strong>5</strong> min")).on("click",o(5))))).append(jQuery("<a/>").addClass("cBtnFlexi cBtnWhite cancel").html(window.t("Cancel")).on("click",function(){e.modal("hide").remove()})).append(jQuery("<a/>").addClass("cBtnFlexi cBtnGrey submit").html(window.t("Start")).on("click",function(){t&&i(t)})).append('<br class="clear"/>')).modal({classes:"tacticTrainerDialog"}).modal("show")}),n.toggleKeyboard(!0)};if(e)o(e);else{for(var r=0;r<this.session.length;r++)this.session[r].eloResult||(this.session[r].eloResult=r<this.session.length-1?this.session[r+1].eloUser:this.feedback?this.feedback.eloUser:null);jQuery.getJSON("/api/web/TacticTrainerAPI/summary?session="+this.provider.sessionId,function(e){if(0==e.status){var t=e.data.summary;o(t)}})}return this},toggleKeyboard:function(e){if(jQuery(document).off("chess24:lastmove.tactictrainer chess24:nextmove.tactictrainer chess24:previousmove.tactictrainer chess24:firstmove.tactictrainer").off("keydown.tactictrainer"),e){var t,n=this;jQuery(document).on("chess24:lastmove.tactictrainer chess24:nextmove.tactictrainer chess24:previousmove.tactictrainer chess24:firstmove.tactictrainer",function(e){clearTimeout(t),t=setTimeout(function(){n.cursorEvents(e)})}).on("keydown.tactictrainer",function(e){clearTimeout(t),t=setTimeout(function(){n.keydown(e)})})}},hideSummary:function(){this.summary&&(this.summary.board&&this.summary.board.unlink(TacticTrainer.PuzzleHandler.handler),this.summary.sound&&this.summary.sound.unlink(TacticTrainer.PuzzleHandler.handler),this.summary.cursor&&this.summary.cursor.unlink(TacticTrainer.PuzzleHandler.handler),this.summary.notation&&this.summary.notation.unlink(TacticTrainer.PuzzleHandler.handler),TacticTrainer.BaseServer.dialog&&(TacticTrainer.BaseServer.dialog.remove(),TacticTrainer.BaseServer.dialog=null),this.html.summary.hide().html(""),jQuery(document).off("keyup",this.keydown),jQuery(document).trigger("chess24:comments"),this.timeline.callback(null))},summaryDetails:function(e,t){var n=this.html.summary.find(".tacticTrainerDetails");n.find(".puzzle-no").html("#"+e.id),n.find(".elo-user").html(e.eloUser+' <span class="eloChange dif'+e.eloChange+'">'+Math.abs(e.eloChange)+"</span>"),n.find(".elo-puzzle").html(e.eloPuzzle),n.find(".time-user").html(e.time?Math.round(10*e.time)/10+"s":window.t("N/A")),n.find(".time-avg").html(e.timeAvg?Math.round(10*e.timeAvg)/10+"s":window.t("N/A")),this.container.find(".reportPuzzle").data("puzzle-id",e.id);var i=this.html.summary.find(".underBoard");i.find(".plus")[e.iLiked?"addClass":"removeClass"]("on").find("label").html(e.likes),i.find(".minus")[e.iUnliked?"addClass":"removeClass"]("on").find("label").html(e.unlikes),this.timeline.highlight(e.id),this.summary.board.highlightHandler.unHighlightAll(),TacticTrainer.PuzzleHandler.handler.setCurrentGame(e.id).gotoStart(),t&&this.html.summary.find(".notation .moveId_"+t).addClass("wrongMove"),i.find(".plus, .minus").off("click").on("click",function(){var t=jQuery(this),n="/api/web/TacticTrainerAPI/feedback?id="+e.id+"&feedback="+(t.is(".plus")?"1":"-1");jQuery.getJSON(n,function(t){0==t.status&&(e.likes=t.data.likes,e.unlikes=t.data.unlikes,e.iLiked=t.data.iliked,e.iUnliked=t.data.iunliked,i.find(".plus")[e.iLiked?"addClass":"removeClass"]("on").find("label").html(t.data.likes),i.find(".minus")[e.iUnliked?"addClass":"removeClass"]("on").find("label").html(t.data.unlikes))})});var o=this.html.summary.find(".comments").empty().addClass("loading"),r="/api/web/CommentAPI/comments?lang="+config.language()+"&puzzle="+e.id;jQuery.getJSON(r,function(e){e.data.html?o.show().append(e.data.html):o.hide(),jQuery(document).trigger("newhtml").trigger("chess24:comments")}),this.toggleKeyboard("cancelled"!=e.status),this.html.summary.find(".cursor,.notation")["cancelled"==e.status?"hide":"show"]()},buildHtml:function(){return{}},report:function(e,t,n){if(!t)return this;var i=this,o={puzzle:t.puzzleId,result:"success"==t.status?1:0,time:t.time,type:this.type()};return n&&(o.promise="on"),t.failure&&(o.failureat=TacticTrainer.PuzzleHandler.handler.getCurrentPosition().parentMove.knotId,o.failure=TacticTrainer.PuzzleHandler.handler.getCurrentPosition().getSan()),this.report.working=!0,this.provider.report(o,function(o){if(n){if(!o)return void(i.report.working=!1);var r=i.session.indexOf(t);r>=0&&i.session[r+1]?jQuery.extend(i.session[r+1],o):i.feedback=o}i.report.working=!1,"function"==typeof e&&e(),Handler.tracking("tactics-trainer",i.type(),t.status)}),this}}),TacticTrainer.BaseServer.DURATION=60,TacticTrainer.BaseServer.DELAY=1.5,TacticTrainer.ClassicServer=TacticTrainer.BaseServer.extend({__constructor:function(e,t){return this.provider=new TacticTrainer.PuzzleProvider({type:"classic"}),this.settings=jQuery.extend({},t),this.init(e),this},type:function(){return"classic"},stop:function(e){if(e)this.halt=!0;else if(this.handler){this.handler.cancel(),jQuery.extend(this.currentpuzzle,this.handler.summary()),this.handler.remove();var t=this;this.report(function(){t.showSummary()},this.currentpuzzle,!1)}return this},next:function(e,t){var n=this;this.handler&&jQuery.extend(this.currentpuzzle,this.handler.cancel().summary());var i=window.settings.get("tactics-stop");return this.halt||"always"==i||e===!1&&"failure"==i?("failure"==i&&(this.subsessionStart=this.session.length-1),this.report(function(){setTimeout(function(){n.showSummary()},t?1e3*TacticTrainer.BaseServer.DELAY:0)},this.currentpuzzle,!1)):(this.report(void 0,this.currentpuzzle,!0),setTimeout(function(){n.puzzle()},t?1e3*TacticTrainer.BaseServer.DELAY:0)),this},proceed:function(){this.switchTimeline(),this.hideSummary(),this.currentpuzzle=null,this.halt=!1,this.html.puzzleBundle.show(),"always"!=window.settings.get("tactics-stop")&&this.html.stoplater.show(),this.html.stoplateron.hide(),this.puzzle(!0)},timer:function(e,t){if(this.html.countdown&&this.currentpuzzle&&"undefined"!=typeof this.currentpuzzle.eloSuccess){var n=this.currentpuzzle.eloSuccess-this.currentpuzzle.eloUser,i=this.currentpuzzle.duration||TacticTrainer.BaseServer.DURATION,o=(10>e?0:e>i?i:e)/i,r=this.currentpuzzle.eloUser+n-n*Math.pow(o,2),a=Math.min(this.currentpuzzle.eloSuccess,this.currentpuzzle.eloUser,this.currentpuzzle.eloFailure),s=Math.max(this.currentpuzzle.eloSuccess,this.currentpuzzle.eloUser,this.currentpuzzle.eloFailure),l=s-a;if(this.html.countdown.data("id")!=this.currentpuzzle.handlerId){this.html.countdown.data("id",this.currentpuzzle.handlerId),0==this.html.countdown.find(".line").length&&(this.html.countdown.html(new Handler.Template("tacticTrainer").render("tactics-countdown-classic")),this.html.countdown.eloCurrent=this.html.countdown.find(".current"),this.html.countdown.eloSuccess=this.html.countdown.find(".success"),this.html.countdown.eloFailure=this.html.countdown.find(".failure"),this.html.countdown.eloPromise=this.html.countdown.find(".pointer"),this.html.countdown.labelCurrent=this.html.countdown.find(".label-current"),this.html.countdown.labelSuccess=this.html.countdown.find(".label-success"),this.html.countdown.labelFailure=this.html.countdown.find(".label-failure"),this.html.countdown.labelPromise=this.html.countdown.find(".label-pointer"),this.html.countdown.find(".boardSettings").on("click",this.showSettings));var c="animate"}else c="css";var d=100*(this.currentpuzzle.eloUser-a)/l,u=100*(this.currentpuzzle.eloSuccess-a)/l,h=100*(this.currentpuzzle.eloFailure-a)/l,p=100*(r-a)/l;this.html.countdown.eloCurrent.stop()[c]({width:d+"%"},100),this.html.countdown.eloSuccess.stop()[c]({width:u+"%"},100),this.html.countdown.eloFailure.stop()[c]({width:h+"%"},100),this.html.countdown.eloPromise.stop()[c]({width:p+"%"},100);var f=this.html.countdown.find(".line").width()/100;return this.html.countdown.labelCurrent.html(this.currentpuzzle.eloUser).stop()[c]({left:Math.round(d*f-this.html.countdown.labelCurrent.width()/2)+"px"},100),this.html.countdown.labelSuccess.html(this.currentpuzzle.eloSuccess).stop()[c]({left:Math.round(u*f-this.html.countdown.labelSuccess.width())+"px"},100),this.html.countdown.labelFailure.html(this.currentpuzzle.eloFailure).stop()[c]({left:Math.round(h*f)+"px"},100),this.html.countdown.labelPromise.html(Math.floor(r)).stop()[c]({left:Math.round(p*f-this.html.countdown.labelPromise.width()/2)+"px"},100),this}},buildHtml:function(){this.container.html(new Handler.Template("tacticTrainer").render("tactics-classic"));var e={puzzle:this.container.find(".tacticTrainerPuzzle"),timeline:this.container.find(".tacticTrainerTimeline"),summary:this.container.find(".tacticTrainerSummary"),countdown:this.container.find(".tacticTrainerCountdown"),stopnow:this.container.find(".cBtn.stopnow"),stoplater:this.container.find(".cBtn.stoplater"),stoplateron:this.container.find(".stoplateron")};e.puzzleBundle=e.puzzle.add(e.stopnow).add(e.stoplater).add(e.stoplateron).add(this.container.find(".tacticTrainerButtons"));var t=this;return e.stopnow.on("click",function(){return t.stop(!1),!1}),e.stoplater.on("click",function(){return t.stop(!0),e.stoplater.hide(),e.stoplateron.show().find(":checkbox").attr("checked","true"),!1}),e.stoplateron.find(":checkbox").on("click",function(){t.halt=!1,e.stoplater.show(),e.stoplateron.hide()}),"always"==window.settings.get("tactics-stop")&&e.stoplater.hide(),this.container.find(".cPremium")[config.level().isPremium||config.level().isGuest?"hide":"show"](),this.container.find(".cRegister")[config.level().isGuest?"show":"hide"](),this.container.find(".tacticHeader")[config.level().isPremium?"addClass":"removeClass"]("noButtons"),jQuery(document).trigger("newhtml"),this.switchTimeline=function(){if(e.puzzle.is(":visible")){var n=window.settings.getBoolean("tactics-timeline");n?(e.countdown.show(),e.puzzleBundle=e.puzzleBundle.add(e.countdown),t.container.removeClass("smaller")):(e.countdown.hide(),e.puzzleBundle=e.puzzleBundle.not(e.countdown),t.container.addClass("smaller"))}},window.settings.on("settings.tactics-timeline",this.switchTimeline),this.switchTimeline(),e}}),TacticTrainer.SpeedServer=TacticTrainer.BaseServer.extend({__constructor:function(e,t){return this.settings=jQuery.extend({time:20},t),this.provider=new TacticTrainer.PuzzleProvider({type:"speed"}),this.timeLeft=this.settings.time,this.totalTime=this.settings.time,this.maxTime=this.settings.time+60,this.renderedTime=0,this.playing=!0,this.pauseTimer=!1,this.init(e),this},type:function(){return"speed"},next:function(e,t){this.handler&&jQuery.extend(this.currentpuzzle,this.handler.cancel().summary()),t&&(this.pauseTimer=!0),this.report(void 0,this.currentpuzzle,!0),e&&(this.totalTime=Math.min(this.totalTime+TacticTrainer.SpeedServer.REWARD,this.maxTime),this.createTimer(this.html.countdown,Math.min(this.timeLeft+TacticTrainer.SpeedServer.REWARD,this.totalTime))),t&&(this.totalTime+=TacticTrainer.BaseServer.DELAY);var n=this;setTimeout(function(){n.pauseTimer=!1,n.playing&&n.puzzle()},t?1e3*TacticTrainer.BaseServer.DELAY:0)},timer:function(e,t){if(!this.pauseTimer)if(this.timeLeft=this.totalTime-t,this.timeLeft<=0){var n=this.handler?!!this.handler.playing:!1;this.playing=!1,this.stopTimer(),this.resetTimer(!0),this.handler&&(jQuery.extend(this.currentpuzzle,this.handler.cancel(n).summary()),this.handler.remove()),this.session.length>1&&(this.session[this.session.length-2].eloResult=this.currentpuzzle.eloUser);var i=this;n?this.report(function(){i.showSummary()},this.currentpuzzle,!1):i.showSummary()}else this.updateTimer()},proceed:function(){this.hideSummary(),this.session=[],this.provider=new TacticTrainer.PuzzleProvider({type:"speed"}),this.currentpuzzle=null,this.timeline.update(this.session,!0),this.hideSummary(),this.html.puzzleBundle.show(),this.resetTimer(!0),this.puzzle()},buildHtml:function(){this.container.html(new Handler.Template("tacticTrainer").render("tactics-speed"));var e={puzzle:this.container.find(".tacticTrainerPuzzle"),countdown:this.container.find(".tacticTrainerCountdown"),timeline:this.container.find(".tacticTrainerTimeline"),summary:this.container.find(".tacticTrainerSummary")};return e.puzzleBundle=e.puzzle.add(e.countdown).add(e.skip),this.createTimer(e.countdown),this.container.find(".boardSettings").on("click",this.showSettings),this.container.find(".cPremium")[config.level().isPremium||config.level().isGuest?"hide":"show"](),this.container.find(".cRegister")[config.level().isGuest?"show":"hide"](),this.container.find(".tacticHeader")[config.level().isPremium?"addClass":"removeClass"]("noButtons"),jQuery(document).trigger("newhtml"),e},updateTimer:function(){this.html.countdown.find(".pointer").css("width",this.timeLeft/this.renderedTime*100+"%")},createTimer:function(e,t){if(t=t||this.totalTime,t<=this.renderedTime)return this;this.renderedTime=t,e.html(new Handler.Template("tacticTrainer").render("tactics-countdown-speed"));for(var n=e.find(".line"),i=0,o=n.width(),r=0;r<=this.renderedTime;r+=60){var a=o*(r/this.renderedTime),s=(jQuery("<div/>").addClass("dash").appendTo(n).css("width",a+"px"),jQuery("<div/>").addClass("label").appendTo(n).html(i));s.css("left",a-s.width()/4+"px"),++i}return n.find(".pointer").css("width",n.width()+"px"),this}}),TacticTrainer.SpeedServer.REWARD=3,TacticTrainer.SpeedServer.MAX_REWARD=60,"undefined"==typeof TacticTrainer&&(TacticTrainer={}),TacticTrainer.Timeline=inheritable.extend({__constructor:function(e){return this.container=jQuery(e),this.container.length||(this.container=null),this},update:function(e,t){if(!this.container)return this;this.container.html(new Handler.Template("tacticTrainer").render("tactics-timeline",{items:e,playing:t})),this.container[t?"addClass":"removeClass"]("playing"),this.scroller=this.container.find(".tacticTrainerTimelineItems"),this.items=this.scroller.find("a"),this.pager=this.container.find(".pager");var n=this.items.first().outerWidth()+parseInt(this.items.first().css("margin-left"),10)+parseInt(this.items.first().css("margin-right"),10);return this.scroller.css("width",this.items.length*n+"px"),this.updatePager(),this.setupDragging(),this.scroll(e.length),this},updatePager:function(){if(!this.container)return this;for(var e=this.container.width()-2*parseInt(this.scroller.css("margin-left"),10),t=this.items.first(),n=this.scroller.find("a").length*(t.outerWidth()+parseInt(t.css("margin-left"),10)+parseInt(t.css("margin-right"),10)),i=this,o=Math.ceil(n/e),r=0;o>r;r++)this.pager.append(jQuery("<a/>").on("click",function(e){
return function(){i.scroll(e)}}(r)));this.pager.find("a:first").addClass("active"),this.pager.show(),this.container.addClass("withPager")},setupDragging:function(){var e,t,n=this,i=function(i){n.scrollTo(e+i.pageX-t,!1);try{i.preventDefault()}catch(o){}return!1},o=function(e){Math.abs(e.pageX-t)>10&&n.pager.find(".active").removeClass("active"),jQuery(document).off("mousemove",i).off("mouseup",o)};return this.container.off("mousedown").on("mousedown",function(r){return e=parseInt(n.scroller.css("left"),10),t=r.pageX,jQuery(document).on("mousemove",i).on("mouseup",o),r.preventDefault(),!1}),this},realwidth:function(){var e=this.items.first();return this.scroller.find("a").length*(e.outerWidth()+parseInt(e.css("margin-left"),10)+parseInt(e.css("margin-right"),10))},scrollTo:function(e,t){var n=parseInt(this.scroller.css("margin-left"),10),i=this.container.width()-2*n,o=this.realwidth();return i>o?this:(e=Math.min(e,0),e=Math.max(e,-(o-i)),t?this.scroller.stop().animate({left:e+"px"},200):this.scroller.css("left",e+"px"),this)},scroll:function(e){if(!this.container)return this;var t=parseInt(this.scroller.css("margin-left"),10),n=this.container.width()-2*t;return this.scrollTo(-(n+t)*e,!0),this.pager.find("a").removeClass("active"),this.pager.find("a:eq("+e+")").addClass("active"),this},scrollItem:function(e){if(!this.container)return this;var t=parseInt(this.scroller.css("margin-left"),10),n=this.items.filter("[data-id="+e+"]");if(!n.length)return this;var i,o=n.offset(),r=this.container.offset(),a=r.left+2*t-o.left,s=o.left-(r.left+this.container.width()-3*t);a>0?(i=Math.min(0,parseInt(this.scroller.css("left"),10)+a),this.scrollTo(i,!0)):s>0&&(i=parseInt(this.scroller.css("left"),10)-Math.min(parseInt(this.scroller.width(),10),s),this.scrollTo(i,!0))},callback:function(e){return this.container?("function"!=typeof e?this.items.off("click"):this.items.on("click",function(){var t=jQuery(this);e(t.data("id"),t.data("failure"))}),this):this},engage:function(e){return this.container&&this.items.eq(e||0).click(),this},highlight:function(e){return this.container?(this.items.filter(".active").removeClass("active"),this.items.filter("[data-id="+e+"]").addClass("active"),void this.scrollItem(e)):this}}),jQuery.fn.editorextensions=jQuery.fn.editorextensions||{},jQuery.fn.editorextensions.align=function(e,t){return{index:function(t){return["left","right","center","justify"].contains(t)?function(n){var i=e.extensions.dom.getSelection();if(i){var o=i.startContainer,r=i.endContainer;if(o==e.get(0)&&(o=e.get(0).firstChild),r==e.get(0)&&(r=e.get(0).lastChild),o==r){for(var a=o;a&&(3==a.nodeType||!e.extensions.dom.isBlockElement(a));)a=a.parentNode;a&&(t=jQuery(a).hasClass("align"+t)?"left":t,jQuery(a).removeClass("alignleft alignright aligncenter alignjustify").addClass("align"+t))}else{var s=e.extensions.dom.treeToVector(e.get(0).childNodes,e.extensions.dom.isBlockElement);o=e.extensions.dom.findBlockParent(o),r=e.extensions.dom.findBlockParent(r),0==i.endOffset&&r.previousSibling&&(r=r.previousSibling);var l=s.indexOf(o),c=s.indexOf(r);if(-1==l)return t=e.hasClass("align"+t)?"left":t,void e.removeClass("alignleft alignright aligncenter alignjustify").addClass("align"+t);-1==c&&(c=s.length-1);for(var d=!0,u=l;c>=u;u++)if(!jQuery(s[u]).hasClass("align"+t)){d=!1;break}for(t=d?"left":t,u=l;c>=u;u++)jQuery(s[u]).removeClass("alignleft alignright aligncenter alignjustify").addClass("align"+t)}}}:function(){}},toolbuttons:{alignleft:{name:window.t("Align left"),icon:"alignleft.png",onclick:function(e){this.extensions.align.index("left")(e)},highlight:function(e){return this.extensions.highlight.check(e,"",{"text-align":"left start"})},shortcut:"Ctrl-L"},aligncenter:{name:window.t("Align center"),icon:"aligncenter.png",onclick:function(e){this.extensions.align.index("center")(e)},highlight:function(e){return this.extensions.highlight.check(e,".aligncenter")}},alignright:{name:window.t("Align right"),icon:"alignright.png",onclick:function(e){this.extensions.align.index("right")(e)},highlight:function(e){return this.extensions.highlight.check(e,".alignright")},shortcut:"Ctrl-R"},alignjustify:{name:window.t("Align full"),icon:"alignjustify.png",onclick:function(e){this.extensions.align.index("justify")(e)},highlight:function(e){return this.extensions.highlight.check(e,".alignjustify")}}},provides:{attributes:{p:["class"],h1:["class"],h2:["class"],h3:["class"],blockquote:["class"],li:["class"]}}}},jQuery.fn.editorextensions=jQuery.fn.editorextensions||{},jQuery.fn.editorextensions.browser=function(e,t){var n,i,o,r,a,s;return{open:function(){n||(n=jQuery("<div/>").addClass("editor-browser").appendTo("body"),i=jQuery("<div/>").addClass("editor-browser-folders").appendTo(n),o=jQuery("<div/>").addClass("editor-browser-files").appendTo(n),r=jQuery("<div/>").addClass("editor-browser-meta").appendTo(n),n.modal()),n.modal("show")},close:function(){n.modal("hide")},renderFolders:function(e){var t=this,n=function(e){for(var i=jQuery("<ul/>"),o=0;o<e.length;o++){var r=jQuery("<li/>").appendTo(i).data("name",e[o].data.name),a=jQuery("<a/>").html(e[o].name).on("click",function(e){return function(){t.expandCollapseFolder(e.data.name),t.loadFiles(e)}}(e[o]));r.append(a),e[o].folders&&r.append(n(e[o].folders))}return i};i.html("").removeClass("loading").append(n(e))},renderFiles:function(e,t){for(var n=this,i=jQuery("<ul/>"),r=0;r<e.length;r++){var l=jQuery("<li/>").appendTo(i),c=jQuery("<a/>").html(e[r].name).addClass("folder").on("click",function(e){return function(){a=e.data.name,n.expandCollapseFolder(e.data.name),n.loadFiles(e)}}(e[r]));l.append(c)}for(var r=0;r<t.length;r++){var l=jQuery("<li/>").appendTo(i),c=jQuery("<a/>").addClass("file").html(t[r].name).on("click",function(e){return function(){s=e.data.name,n.renderMeta(e)}}(t[r])).on("dblclick",function(e){return function(){n.reportAndClose(e)}}(t[r]));l.append(c)}o.html("").removeClass("loading").append(i)},expandCollapseFolder:function(e){i.find("li").each(function(){var t=jQuery(this);t.data("name")==e&&(t.parentsUntil(i,"ul").show(),t.find("> ul").toggle())})},renderMeta:function(e){r.html("Chosen file: "+e.name)},loadFiles:function(e){var n=this;o.html("").addClass("loading"),jQuery.getJSON(t.browserFiles,{type:"file",folder:e?e.data.name:""},function(e){n.renderFiles(e.data.folders,e.data.files)})},reportAndClose:function(e){"function"==typeof this.callback&&this.callback(e),this.close()},load:function(e){var n=this;i.html("").addClass("loading"),jQuery.getJSON(t.browserFolders,{type:"file"},function(e){n.renderFolders(e.data.folders)}),this.loadFiles()},loading:function(){i&&i.addClass("loading"),o&&o.addClass("loading")},index:function(e){this.open(),this.load(e),this.callback=e?e.callback:null}}},jQuery.fn.editorextensions=jQuery.fn.editorextensions||{},jQuery.fn.editorextensions.character=function(e,t){var n=[{text:"&#33;",title:"Glyph 1"},{text:"&#63;",title:"Glyph 2"},{text:"&#x203C;",title:"Glyph 3"},{text:"&#x2047;",title:"Glyph 4"},{text:"&#x2049;",title:"Glyph 5"},{text:"&#x2048;",title:"Glyph 6"},{text:"&#x25A1;",title:"Glyph 7"},{text:"&#61;",title:"Glyph 8"},{text:"&#x221E;",title:"Glyph 9"},{text:"&#43;/&#61;",oldtext:"&#x2A72;",title:"Glyph 10"},{text:"&#61;/&#43;",oldtext:"&#x2A71;",title:"Glyph 11"},{text:"&plusmn;",title:"Glyph 12"},{text:"&#x2213;",title:"Glyph 13"},{text:"&#43;&minus;",title:"Glyph 14"},{text:"&minus;&#43;",title:"Glyph 15"},{text:"&#x2A00;",title:"Glyph 16"},{text:"&#x25CB;",title:"Glyph 17"},{text:"&#x27F3;",title:"Glyph 18"},{text:"&#x2192;",title:"Glyph 19"},{text:"&#x2191;",title:"Glyph 20"},{text:"&#61;/&#x221E;",title:"Glyph 21"},{text:"&#x21C6;",title:"Glyph 22"},{text:"&#x2295;",title:"Glyph 23"},{text:"&#x2206;",title:"Glyph 24"},{text:"&#x2313;",title:"Glyph 25"},{text:"N",title:"Glyph 26"},{text:"&#x21D4;",title:"Glyph 27"},{text:"&#x21D7;",title:"Glyph 28"},{text:"&#x27EB;",title:"Glyph 29"},{text:"&#x27EA;",title:"Glyph 30"},{text:"&#x2715;",title:"Glyph 31"},{text:"&#x22A5;",title:"Glyph 32"}],i=0;return{index:function(t){var o=e.extensions.dom.getSelection();if(o){for(var r=jQuery("<div/>"),a=0;a<n.length;a++)a>0&&a%8==0&&r.append("<br/>"),r.append(jQuery("<span/>").addClass("editor-dialog-character").html(n[a].text).attr("title",n[a].title).on("mousedown",function(t){e.setFocus(!0);var n=jQuery("<span/>").addClass("glyph").html(jQuery(this).html());e.insertAtCursor(n),n.after("&nbsp;");var i=n.get(0).nextSibling;return e.extensions.dom.setCursor(i,"after"),e.registerCursor(),e.hideToolDialog(),!1}));setTimeout(function(){e.hideToolDialog(i)||(i=e.showToolDialog(r,t))},10)}},toolbuttons:{character:{name:window.t("Special characters"),icon:"character.png",onclick:function(e){this.extensions.character.index(e)}}},provides:{tags:["span"],attributes:{span:["class"]}}}},jQuery.fn.editorextensions=jQuery.fn.editorextensions||{},jQuery.fn.editorextensions.chess=function(e,t){var n=0,i={csrf:config.csrf()},o=["Title","Description","Event","Site","Date","White.Name","White.Elo","Black.Name","Black.Elo","Round","ECO","Annotator","Result","Source"];t&&Widgets.Chess().chessBase.init(t.chessGames);var r=function(e){var t=jQuery("<div/>").addClass("game-builder"),n="4k3/8/8/8/8/8/8/4K3 w - - 0 1",i=!1;e?i=!0:e=new Chess.Game;var o,r,a,s,l=!!i,c=function(n){if(l){var i=e.getCurrentPosition(),o=!i.isRootPosition(),r=i.isRootPosition()?!1:i.parentMove.childrenMoves[0]!=i;t.find(".cBtn.remove")[o?"removeClass":"addClass"]("disabled"),t.find(".cBtn.promote")[r?"removeClass":"addClass"]("disabled"),"move"==n.currentChannel&&t.trigger("chess24:change")}else v(e.getCurrentPosition())},d=function(){var n=jQuery("<div/>").addClass("popupInsider").css("width","315px").append(jQuery("<div/>").addClass("dialogContent").append("<p>"+window.t("Please insert your FEN string here")+"</p>").append('<input type="text" class="cPattern"/>')).append(jQuery("<div/>").addClass("dialogFooter"));n.find(".dialogFooter").append(jQuery("<a/>").addClass("cBtn cBtnGrey").html("OK").on("click",function(){var t=n.find("input").val(),i=Chess.isFen(t);if(!i||!i.valid)return n.find(".dialogContent p").addClass("error").html(window.t("This is not a valid FEN string")+"</p>"),void n.find("span.inputTextWrapper, input").addClass("inputError");var r=new Chess.Position({fen:t,validators:e.getRules()});e.setStartPosition(r),o.gotoStart(),n.modal("hide"),g()})).append(jQuery("<a/>").addClass("cBtn cBtnWhite").html("Cancel").on("click",function(){n.modal("hide")})),n.modal({classes:"defaultPopup",align:t}).modal("show"),jQuery(document).trigger("newhtml")},u=function(){R.show(),t.find("h4").html(window.t("Step 1: set up the starting position")),t.find(".headline").html(window.t("Move pieces around to set up the position from which the game should start")),e.setRules("build"),r.movementHandler.activate(),r.highlightHandler.deactivate(),T.hide(),S.show(),_.hide(),E.hide(),x.find(".chess-board").css("overflow","visible")},h=function(){e.setStartPosition(new Chess.Position({fen:Chess.defaultFen,validators:e.getRules()})),o.gotoStart(),g()},p=function(){e.setStartPosition(new Chess.Position({fen:n,validators:e.getRules()})),o.gotoStart(),g()},f=function(){var n=e.getCurrentPosition();n.moveRight=t.find(".moveright-w").is(":checked")?"w":"b",n.moveCounter=O.find("input").val()||1,n.ep=M.find("select").get(0).selectedIndex>0?parseInt(M.find("select").val()):-1,n.castlingRights={white:{kingSide:t.find(".castling-w-2").is(":checked")?"H":"",queenSide:t.find(".castling-w-3").is(":checked")?"A":""},black:{kingSide:t.find(".castling-b-2").is(":checked")?"h":"",queenSide:t.find(".castling-b-3").is(":checked")?"a":""}},e.reOpen(),v(n)&&(l=!0,R.hide(),i||L.show(),t.find("h4").html(window.t("Step 2: create the game")),t.find(".headline").html(window.t("Make moves on the board")),i||e.setStartPosition(new Chess.Position({knotId:0,fen:n.toString(!0),dontCheckForInsufficentMaterial:!0})),e.setRules("play"),o.gotoStart(),r.movementHandler.activate(),r.highlightHandler.activate(),P.hide(),S.hide(),T.show(),_.show(),E.show(),L.removeClass("disabled"),x.find(".chess-board").css("overflow","hidden"))},g=function(){var n=e.getCurrentPosition();t.find(".moveright-w").attr("checked","w"==n.moveRight),t.find(".moveright-b").attr("checked","b"==n.moveRight),t.find(".castling-w-3").attr("checked",n.canCastleQueenside("w")),t.find(".castling-w-2").attr("checked",n.canCastleKingside("w")),t.find(".castling-b-3").attr("checked",n.canCastleQueenside("b")),t.find(".castling-b-2").attr("checked",n.canCastleKingside("b")),t.find(".game-builder-movenumber input").val(n.moveCounter)},m={k:[1,1],q:[0,9],r:[0,10],n:[0,10],b:[0,10],p:[0,8],white:[1,16],black:[1,16]},v=function(e){var n=!1,i=!1;P.removeClass("invalid").html(window.t("Position is valid"));for(var o=e.countPiecesOnBoard(),r=["k","q","r","n","b","p","K","Q","R","N","B","P","white","black"],a=0;a<r.length;a++)(o[r[a]]<m[r[a].toLowerCase()][0]||o[r[a]]>m[r[a].toLowerCase()][1])&&(n=!0);if(o.k&&o.K){var s=t.find(".moveright-w").is(":checked")?"w":"b";e.isAttacked(e.kingPos.b)&&e.isAttacked(e.kingPos.w)&&(i=!0),e.isAttacked(e.kingPos.b)&&"w"==s&&(i=!0),e.isAttacked(e.kingPos.w)&&"b"==s&&(i=!0)}var l="abcdefgh",c=t.find(".moveright-b").is(":checked")?3:4,d=t.find(".moveright-b").is(":checked")?"P":"p",u=3==c?2:5;M.find("option").not(":first").remove();for(var h=0;8>h;h++)e.getPiece(c,h)==d&&"-"==e.getPiece(u,h)&&M.find("select").append('<option value="'+h+'">'+l.substr(h,1)+"</option>");return M.find("select").selectBox("destroy").selectBox(),P[n||i?"addClass":"removeClass"]("invalid").html(window.t(n||i?"Invalid position":"Position is valid")),R[i?"addClass":"removeClass"]("disabled"),!i},y=function(){var n=e.getCurrentPosition();!n.isRootPosition()&&n.parentMove&&(e.deleteMove(),t.trigger("chess24:change"))},w=function(){var n=e.getCurrentPosition();!n.isRootPosition()&&n.parentMove&&0!=n.parentMove.childrenMoves.indexOf(n)&&(n.parentMove.childrenMoves.removeByValue(n),n.parentMove.childrenMoves.unshift(n),o.gotoId(n.knotId),t.trigger("chess24:change"))},b=function(){t.find("h4").html(window.t("Step 3: enter game details")),t.find(".headline").html(window.t("Please enter the basic game information. More details can be added after the game has been created")),L.hide(),N.show(),x.hide(),P.hide(),S.hide(),T.hide(),_.hide(),E.hide(),B.show(),B.find("select").selectBox("destroy").selectBox()},C=function(){e.setMeta("Title",B.find("[name=title]").val()),e.setMeta({White:{Name:B.find("[name=white]").val()||"?"}}),e.setMeta({Black:{Name:B.find("[name=black]").val()||"?"}}),e.setMeta("Result",B.find("[name=result]").val()||"*"),e.setMeta("SourceFile","Generated")},k=config.assetDir()+"/images",F=k+"/chess/themes/pieces/chess24/";jQuery("<p/>").appendTo(t).append(jQuery("<a/>").addClass("cBtn cBtnWhite").append('<img src="'+k+'/editor/exercise-back.png"/>').append(window.t("Back")).on("click",function(){t.trigger("chess24:hide")})).append(jQuery("<h4/>")).after(jQuery("<p/>").addClass("headline"));var x=jQuery("<div/>").attr("id","game-builder-board").addClass("game-builder-board").appendTo(t),T=jQuery("<div/>").addClass("game-builder-notation").appendTo(t).hide().append(jQuery("<div/>").attr("id","game-builder-notation"));t.append('<br class="clear"/>');var _=jQuery("<div/>").attr("id","game-builder-cursor").addClass("game-builder-cursor").appendTo(t),E=jQuery("<div/>").attr("id","game-builder-playbuttons").appendTo(t).append(jQuery("<a/>").html("Delete move").addClass("cBtn cBtnWhite remove disabled").on("click",y)).append(jQuery("<a/>").html("Promote move").addClass("cBtn cBtnWhite promote disabled").on("click",w)),S=jQuery("<div/>").addClass("game-builder-start").insertBefore(T).hide(),j=jQuery("<div/>").addClass("game-builder-figures").appendTo(S).append(jQuery("<img/>").attr("src",F+"white/p.png").data("new-piece","P")).append(jQuery("<img/>").attr("src",F+"white/r.png").data("new-piece","R")).append(jQuery("<img/>").attr("src",F+"white/n.png").data("new-piece","N")).append(jQuery("<img/>").attr("src",F+"white/b.png").data("new-piece","B")).append(jQuery("<img/>").attr("src",F+"white/q.png").data("new-piece","Q")).append(jQuery("<img/>").attr("src",F+"white/k.png").data("new-piece","K")).append("<br/>").append(jQuery("<img/>").attr("src",F+"black/p.png").data("new-piece","p")).append(jQuery("<img/>").attr("src",F+"black/r.png").data("new-piece","r")).append(jQuery("<img/>").attr("src",F+"black/n.png").data("new-piece","n")).append(jQuery("<img/>").attr("src",F+"black/b.png").data("new-piece","b")).append(jQuery("<img/>").attr("src",F+"black/q.png").data("new-piece","q")).append(jQuery("<img/>").attr("src",F+"black/k.png").data("new-piece","k")),I=jQuery("<div/>").addClass("game-builder-trash").html(window.t("drag here to remove pieces")).prependTo(j),A=jQuery("<div/>").addClass("game-builder-options").appendTo(S).append(jQuery('<input type="radio"/>').addClass("cPattern moveright-w").attr("name","moveRight").val("w").attr("checked","w"==e.getMoveRight())).append('<span>White to move</span><br class="clear"/>').append(jQuery('<input type="radio"/>').addClass("cPattern moveright-b").attr("name","moveRight").val("b").attr("checked","b"==e.getMoveRight())).append("<span>Black to move</span>").append('<br class="clear"/>');A.find("input:radio").on("click",function(){v(e.getCurrentPosition())});var O=jQuery("<div/>").addClass("game-builder-movenumber").appendTo(A).append(jQuery('<input type="text" value="1"/>').addClass("cPattern inputTextMini")).append(jQuery("<span/>").html("Move number")),M=jQuery("<div/>").addClass("game-builder-enpassant").appendTo(A).append(jQuery("<select/>").append("<option>"+window.t("En passant")+"</option>")),P=(jQuery("<div/>").addClass("game-builder-options").appendTo(S).append(jQuery('<input type="checkbox"/>').addClass("cPattern castling-w-3").attr("checked",!0)).append(jQuery('<span>White O-O-O</span><br class="clear"/>')).append(jQuery('<input type="checkbox"/>').addClass("cPattern castling-w-2").attr("checked",!0)).append(jQuery('<span>White O-O</span><br class="clear"/>')).append(jQuery('<input type="checkbox"/>').addClass("cPattern castling-b-3").attr("checked",!0)).append(jQuery('<span>Black O-O-O</span><br class="clear"/>')).append(jQuery('<input type="checkbox"/>').addClass("cPattern castling-b-2").attr("checked",!0)).append(jQuery("<span>Black O-O</span>")),jQuery("<div/>").addClass("game-builder-valid").html(window.t("Position is valid")).appendTo(S));S.append(jQuery("<div/>").addClass("game-buider-positionsetup").append(jQuery("<a/>").addClass("cBtn cBtnWhite").html(window.t("Enter FEN")).on("click",d)).append(jQuery("<a/>").addClass("cBtn cBtnWhite").html(window.t("Reset")).on("click",h)).append(jQuery("<a/>").addClass("cBtn cBtnWhite").html(window.t("Clear")).on("click",p)));var B=jQuery("<div/>").addClass("game-builder-meta").appendTo(t).hide().append("<label>Title for game</label>").append('<input type="text" class="cPattern" name="title"/>').append('<br class="clear"/>').append("<label>White player</label>").append('<input type="text" class="cPattern" name="white"/>').append('<br class="clear"/>').append("<label>Black player</label>").append('<input type="text" class="cPattern" name="black"/>').append('<br class="clear"/>').append("<label>Result</label>").append(jQuery('<select class="cPattern" name="result"/>').append('<option value="1-0">1-0</option>').append('<option value="0-1">0-1</option>').append('<option value="1/2-1/2">&#189;-&#189;</option>').append('<option value="*">*</option>'));t.append('<br class="clear"/>');var R=jQuery("<a/>").hide().appendTo(t).addClass("cBtn cBtnWhite position").html(window.t("Use this position")).on("click",f),L=jQuery("<a/>").hide().appendTo(t).addClass("cBtn cBtnWhite moves disabled").html(window.t("Proceed to entering the game details")).on("click",b),N=jQuery("<a/>").hide().appendTo(t).addClass("cBtn cBtnWhite submit").html(window.t("Save game")).on("click",function(){C(),t.trigger("chess24:done",e)});return I.droppable({drop:function(t,n){var i=n.draggable.parent();if(i.is("div.cell")){for(var r,a=i.attr("class").split(" "),s=0;s<a.length;s++)if(a[s].match(/^_\d\d$/)){r=a[s].substr(1);break}if(r){var l=Chess.getSquare(parseInt(r.substr(0,1)),parseInt(r.substr(1,1))),c=e.getCurrentPosition().setPiece(l,"-");e.setStartPosition(new Chess.Position({fen:c.toString(!0),validators:e.getRules()})),o.gotoStart(),I.removeClass("mouseover")}}},over:function(e,t){I.addClass("mouseover")},out:function(e,t){I.removeClass("mouseover")}}),j.find("img").draggable({helper:"clone",zIndex:100,distance:5,start:function(e,t){},stop:function(e,t){}}),t.start=function(){t.css({overflow:"visible",height:"auto"}),o=(new Chess.GameHandler).addGame("game-builder",e),r=new View.ChessBoard("#game-builder-board",!0).link(o),a=new View.NotationArea("#game-builder-notation").link(o),s=new View.Cursor("#game-builder-cursor",!1,function(){r.flip()}).link(o),r.movementHandler.switchAutoQueen(!1);var n={};Extend.Subscriber(n,{move:c,"movedPositionPointer.current":c}),n.link(o),i?f():u(),M.find("select").selectBox(),jQuery(document).trigger("newhtml")},t},a=function(e,t,n){e&&jQuery(e).length?e=jQuery(e).addClass("position-builder"):e&&jQuery(e).length||(e=jQuery("<div/>").addClass("position-builder"));var i="4k3/8/8/8/8/8/8/4K3 w - - 0 1",o=e.find(".position-builder-board"),r=e.find(".position-builder-fen"),a=e.find(".position-builder-reset"),s=e.find(".position-builder-clear");o.length||(o=jQuery("<div/>").addClass("position-builder-board").appendTo(e)),r.length||(r=jQuery("<div/>").addClass("position-builder-fen").appendTo(e));var l=new Chess.GameHandler,c=new View.ChessBoard(o,!0).link(l).attachPositionHandler(l),d=new Chess.Game({ruleSet:"build"});l.addGame("position-builder",d).setCurrentGame("position-builder"),c.movementHandler.switchPersistentHighlights(!0),c.movementHandler.deactivate("click"),d.on("movedPositionPointer.current",function(e,t){h(t)}),l.on("position.highlights",function(e,t){h(l.getCurrentPosition())}),l.on("currentGameChanged",function(){"position-builder"==l.getCurrentGameKey()?c.movementHandler.deactivate("click").activate("dragDrop"):c.movementHandler.deactivate()});var u=function(e){var t=Chess.isFen(e);return t&&t.valid?(c.movementHandler.deactivate("click").activate("dragDrop"),d.setStartPosition(new Chess.Position({fen:e,validators:d.getRules()})),!0):!1},h=function(t){e.trigger("chess24:change",{fen:t.toString(!0),highlights:p(t.getHighlights())})},p=function(e){for(var t=[],n=0;n<e.length;n++)e[n].square?t.push({square:{x:e[n].square.x,y:e[n].square.y},color:e[n].color}):e[n].frame?t.push({frame:{x:e[n].frame.x,y:e[n].frame.y},color:e[n].color}):e[n].line&&t.push({line:{x1:e[n].line.x1,y1:e[n].line.y1,x2:e[n].line.x2,y2:e[n].line.y2},color:e[n].color});return t};if(r.on("click",function(){var e=jQuery("<div/>").addClass("popupInsider").css("width","315px").append(jQuery("<div/>").addClass("dialogContent").append("<p>"+window.t("Please insert your FEN string here")+"</p>").append('<input type="text" class="cPattern"/>')).append(jQuery("<div/>").addClass("dialogFooter"));e.find(".dialogFooter").append(jQuery("<a/>").addClass("cBtn cBtnGrey").html("OK").on("click",function(){var t=e.find("input").val();u(t)?e.modal("hide"):(e.find(".dialogContent p").addClass("error").html(window.t("This is not a valid FEN string")+"</p>"),e.find("span.inputTextWrapper, input").addClass("inputError"))})).append(jQuery("<a/>").addClass("cBtn cBtnWhite").html("Cancel").on("click",function(){e.modal("hide")})),e.modal({classes:"defaultPopup"}).modal("show"),jQuery(document).trigger("newhtml")}),a.on("click",function(){u(Chess.defaultFen)}),s.on("click",function(){u(i)}),u(t||Chess.defaultFen),n)for(var f=0;f<n.length;f++)n[f].square?d.addHighlight({square:Chess.getSquare(n[f].square.y,n[f].square.x),color:n[f].color}):n[f].frame?d.addHighlight({frame:Chess.getSquare(n[f].frame.y,n[f].frame.x),color:n[f].color}):n[f].line&&d.addHighlight({line:Chess.getMove(n[f].line.y1,n[f].line.x1,n[f].line.y2,n[f].line.x2),color:n[f].color});return e.data("handler",l),e};return{gameBuilder:r,positionBuilder:a,helperBoard:null,showHelperBoard:function(){var t=this;if(this.helperBoardcontainer=jQuery(".helper-board"),this.helperBoardcontainer.length)this.helperBoardcontainer.show();else{this.helperBoardcontainer=jQuery("<div/>").addClass("helper-board").appendTo("body"),this.helperBoardcontainer.append(jQuery("<div/>").attr("id","helper-board-handle").on("mousedown",function(e){var n=t.helperBoardcontainer.offset().left-jQuery(document).scrollLeft(),i=t.helperBoardcontainer.offset().top-jQuery(document).scrollTop(),o=function(o){t.helperBoardcontainer.css({left:n+o.pageX-e.pageX+"px",top:i+o.pageY-e.pageY+"px"})},r=function(){jQuery(document).off("mousemove",o).off("mouseup",r)};return jQuery(document).on("mousemove",o).on("mouseup",r),e.preventDefault(),e.stopPropagation(),!1}).append(jQuery("<a/>").html(window.t("close")).on("click",function(){t.hideHelperBoard()}))),this.helperBoardcontainer.append(jQuery("<div/>").attr("id","helper-board-board")),e.extensions.widgets&&this.helperBoardcontainer.append(jQuery("<a/>").addClass("cBtn cBtnWhite").html("Insert Diagram").on("click",function(){var n={wid:"chess-board",vid:null,properties:jQuery.extend({},Widgets.ChessBoard().properties,{fen:t.helperBoard.getCurrentPosition().toString(!0)}),resources:[]};e.extensions.widgets.instantCreate(n)})),this.helperBoard=new View.ChessBoard("#helper-board-board",!1);var n=Widgets.Chess().chessBase,i=n.getViews(),o=[];for(var r in i)for(var a=n.getControllersForView(r),s=0;s<a.length;s++)o.contains(a[s])||o.push(a[s]);for(var s=0;s<o.length;s++)this.helperBoard.link(n.getController(o[s]));n.on("newcontroller",function(e){t.helperBoard.link(e)})}},hideHelperBoard:function(){this.helperBoardcontainer&&this.helperBoardcontainer.closest(".helper-board").hide()},convertLink:function(t){var n=jQuery(t);e.extensions.widgets.createWidget("chess-jump-to-link",n)},restoreLink:function(t){var n=jQuery(t),i=jQuery("<a/>").html(n.html()).attr("href","http://");n.replaceWith(i),e.extensions.link&&(e.extensions.link.setup(),i.trigger("dblclick"))},editGame:function(e,n){var r=Widgets.Chess().chessBase;r.init(t.chessGames);var a=this,s=n.find(".form");if(s.length)return void s.animate({height:"0px"},200,function(){s.remove()});s=jQuery("<div/>").addClass("form").appendTo(n).hide();for(var l=r.getGameJson(e),c=0;c<o.length;c++){var d,u=o[c];if(-1<o[c].indexOf(".")){for(var h=u.split("."),d=l.meta,p=0;p<h.length;p++)d=d[h[p]];u=o[c].replace("."," ")}else d=l.meta[o[c]];s.append(jQuery("<label/>").html(window.t(u))),s.append(jQuery('<input type="text"/>').attr("name",o[c]).val(d))}s.append(jQuery("<label/>").html("&nbsp;")),s.append(jQuery('<input type="button"/>').addClass("save cPattern").attr("value",window.t("Save")).on("click",function(){var t=jQuery.extend({id:e,attribute:"chessGame.meta"},i),o=r.getGame(e).getMeta();s.find("input").not(".save").each(function(){t["data["+this.name.replace(/\./g,"][")+"]"]=this.value;for(var e=this.name.split("."),n=o,i=0;i<e.length-1;i++)"undefined"==typeof n[e[i]]&&(n[e[i]]={}),n=n[e[i]];n[e[e.length-1]]=this.value}),r.getGame(e).setMeta(o),a.editGame(e,n),jQuery.post("/api/web/couchAPI/partialUpdate",t,function(){n.find("strong").html(o.Title);var e=r.getViews(),t=[];for(var i in e)for(var a=r.getControllersForView(i),s=0;s<a.length;s++)t.contains(a[s])||t.push(a[s]);for(var s=0;s<t.length;s++)r.getController(t[s]).emit("currentGameChanged")})}));var f=s.height();s.css("height","0px").show().animate({height:f+"px"},200,function(){s.css("height","auto")}),jQuery(document).trigger("newhtml")},loadList:function(){var t=this;this.listContainer.html("").show();var n={},i=0;for(var o in e.config.chessGames)if("object"==typeof e.config.chessGames[o]){i++;var r=jQuery.extend({id:o},e.config.chessGames[o]),a=r.meta.SourceFile||"_";n[a]||(n[a]=[]),n[a].push(r)}if(!i)return void t.empty.add(t.form.find(".hint")).show();t.empty.add(t.form.find(".hint")).hide();for(var a in n){var s=n[a];"_"!=a&&t.listContainer.append(jQuery('<div class="label">'+a+"</div>").append(jQuery("<a/>").html("remove").on("click",function(e){return function(){for(var n=[],i=0;i<e.length;i++)n.push(e[i].id);t.removeGames(n)}}(n[a])))).append(jQuery('<div class="label right"/>').append(jQuery("<a/>").html("Insert all as viewer").on("click",function(e){return function(){for(var n=[],i=0;i<e.length;i++)n.push(e[i].id);t.insertAllAsBubble(n)}}(n[a]))));for(var l=jQuery("<ul/>").appendTo(t.listContainer),c=0;c<s.length;c++){var d=s[c].meta.Title?s[c].meta.Title.replace(/\{([^}]+)\}/g,function(e){return s[c].meta[e.replace(/[\{\}]/g,"")]||"{"+e+"}"}):"";l.append(jQuery("<li/>").append(jQuery("<strong/>").html(d)).append(" - "+s[c].meta.Date).append("<br/>").append(window.t("Annotated by {annotator}",{"{annotator}":s[c].meta.Annotator})).append(" - ").append(jQuery("<a/>").html(window.t("Edit details")).on("click",function(e){return function(){t.editGame(e,jQuery(this).closest("li"))}}(s[c].id))).append(" - ").append(jQuery("<a/>").html(window.t("Remove")).on("click",function(e){return function(){t.removeGames([e])}}(s[c].id))).append(jQuery("<a/>").addClass("close").html("x").on("click",function(e){return function(){t.removeGames(e)}}(s[c].id))).append(jQuery("<a/>").addClass("cBtn cBtnGrey").html(window.t("insert")).on("click",function(e,n){return function(){t.insertContent(e,n)}}(s[c].id,s[c].meta.AnnotationId))))}}t.loading.html("").hide(),t.listContainer[t.listContainer.find("ul").length?"show":"hide"](),t.listContainer.get(0).scrollHeight>t.listContainer.height()?t.uploadContainer.addClass("overflow"):t.uploadContainer.removeClass("overflow")},insertAllAsBubble:function(t){if(e.extensions.widgets){var n=this;this.loading.html(window.t("Creating chess board view...")).show();for(var i={wid:"chess-bubble",vid:null,properties:{name:"Games",hidetools:!1},resources:[]},o=0;o<t.length;o++)i.resources.push({"class":"chessGame",reference_id:t[o],properties:{}});this.listContainer.hide(),this.loading.html(window.t("Loading data...")).show(),Widgets.Chess().chessBase.init(e.config.chessGames),e.extensions.widgets.instantCreate(i),n.loading.html(window.t("Finalizing...")).show(),e.hideToolDialog()}},insertContent:function(n,o){Widgets.Chess().chessBase.init(t.chessGames);var r=this;this.listContainer.hide(),this.loading.html(window.t("Loading data...")).show(),jQuery.post("/api/web/couchAPI/prepareMerge",jQuery.extend({source_id:o},i),function(i){if(0==i.status){r.loading.html(window.t("Auto-formatting content...")).show();var a=jQuery("<div/>"),s=jQuery("<p/>").append(i.data.content);a.append(s);var l=function(n){r.loading.html(window.t("Finalizing...")).show(),Widgets.Chess().chessBase.init(e.config.chessGames),n&&(a.prepend(jQuery("<p/>").append(n)),Widgets.ChessBubble().create(n,e,t),Widgets.ChessView().linkLinksToWidget(a,a.find(e.widgetmask),t,!1)),e.insertAtCursor(a.contents()),e.rescueOrphans(),e.removeUnwanted(),e.setupWidgets()};if(e.hideToolDialog(),e.extensions.widgets&&e.isWidgetAllowed("chess-bubble")){var c={wid:"chess-bubble",vid:null,properties:{name:o,hidetools:!1},resources:[{"class":"chessGame",reference_id:n,properties:{}}]};c.resources[0]["default"]=!0,r.loading.html(window.t("Creating chess board view...")).show(),e.extensions.widgets.borrowedWidgets(a.find(e.widgetmaskInline)),l(e.extensions.widgets.instantCreate(c,!0))}else l();a.remove(),delete a}else e.showToolDialogErrors(i.errors);r.loading.html("").hide(),r.listContainer.show()}).fail(function(t,n,i){var o=jQuery.parseJSON(t.responseText);e.showToolDialogErrors(o.errors),r.loading.html("").hide(),r.listContainer.show()})},removeGames:function(n){var i=this,o=["id="+t.formData.cid];if(jQuery.isArray(n))for(var r=0;r<n.length;r++)o.push("reference_id[]="+n[r]);else o.push("reference_id="+n);o.push("csrf="+config.csrf()),jQuery.post("/api/web/couchAPI/remove",o.join("&"),function(t){
0==t.status?(e.config.chessGames[n]=void 0,i.loadList(),e.hideToolDialogErrors()):e.showToolDialogErrors(t.errors)}).fail(function(t,n,i){var o=jQuery.parseJSON(t.responseText);e.showToolDialogErrors(o.errors)})},setupUpload:function(){var n=this;jQuery('<input type="hidden"/>').appendTo(this.uploadContainer).attr("name","type").val("pgn").attr("id","editor-chess-type");var i=jQuery('<input type="file"/>').appendTo(this.uploadContainer).addClass("cPattern").attr("name","file").attr("data-url","/api/web/couchAPI/upload").attr("data-filters","editor-chess-type,editor-chess-link");i.on("chess24:add",function(t,n){n.formData=jQuery.extend(n.formData||{},e.config.formData),e.hideToolDialogErrors()}).on("chess24:done",function(i,o){var r=o.result;if(0==r.status){if(e.hideToolDialogErrors(),n.uploadContainer.find(".fileUploadProgress,.fileUploadDetails").remove(),r.data.result){var a=Widgets.Chess().chessBase;a.init(t.chessGames),e.config.chessGames||(e.config.chessGames={});for(var s in r.data.result)a.addGame(s,r.data.result[s]),e.config.chessGames[s]=r.data.result[s]}e.hideToolDialogErrors()}else e.showToolDialogErrors(r.errors);n.loadList(),n.uploadContainer.find(".inputFileUpload .cBtn").html(window.t("Add file"))}).on("chess24:error",function(t,i){try{var o=jQuery.parseJSON(jQuery("<div/>").html(i.responseText.replace(/\r\n/g,"")).text());e.showToolDialogErrors(o.errors)}catch(t){console.error(i.responseText)}n.uploadContainer.find(".fileUploadProgress,.fileUploadDetails").remove(),n.loadList()}).on("chess24:progress",function(e,t){100==t&&(n.listContainer.hide(),n.empty.add(n.form.find(".hint")).hide(),n.loading.html(window.t("Processing uploaded file...")).show())})},index:function(t){var i=this;this.form=jQuery("<div/>"),this.form.append(jQuery("<h2/>").html(window.t("Add games or exercises"))),this.form.append(jQuery('<p class="hint"/>').html(window.t("Here you can add a single game, a game viewer or exercises for your readers"))),this.empty=jQuery("<p/>").addClass("editor-chess-list-empty").html(window.t("Get started by uploading some games! Please note that the current limit is 5 games per PGN file.")).hide().appendTo(this.form),this.loading=jQuery("<div/>").addClass("editor-chess-loading").hide().appendTo(this.form),this.listContainer=jQuery("<div/>").addClass("editor-chess-list").appendTo(this.form),this.uploadContainer=jQuery("<div/>").addClass("editor-chess-upload").appendTo(this.form),this.loadList(),this.setupUpload(),jQuery("<a/>").addClass("cBtn cBtnWhite").html(window.t("Create game")).appendTo(this.uploadContainer).on("click",function(){i.form.hide();var t=i.gameBuilder();t.insertBefore(i.form).on("chess24:done",function(n,o){var r=Chess.gameToCouch(o),a={},s={0:0},l={},c=function(e){a[e.knotId]=e.getSan(),"b"==e.moveRight&&(l[e.knotId]=e.moveCounter);for(var t=0;t<e.childrenMoves.length;t++)s[e.childrenMoves[t].knotId]=s[e.knotId]+t,c(e.childrenMoves[t])};c(o.getStartPosition());var d="",u=function(e){l[e.knotId]&&(d+=l[e.knotId]+". "),a[e.knotId]&&(d+="[["+e.knotId+"]["+a[e.knotId]+"][0]["+s[e.knotId]+"]] ")},h=function(e){if(e.length){u(e[0]);for(var t=1;t<e.length;t++)u(e[t]),e[t].childrenMoves&&e[t].childrenMoves.length&&h(e[t].childrenMoves);e[0].childrenMoves&&e[0].childrenMoves.length&&h(e[0].childrenMoves)}};h(o.getStartPosition().childrenMoves);var p=jQuery.extend({data:jQuery.toJSON(r),content:d,type:"game"},e.config.formData);jQuery.post("/api/web/couchAPI/create",p,function(n){var o=Widgets.Chess().chessBase;o.init(),o.addGame(n.data.reference_id,r),r.meta.AnnotationId=n.data.annotation_id,e.config.chessGames[n.data.reference_id]=r,t.remove(),i.form.show(),i.loadList()})}).on("chess24:hide",function(){t.remove(),i.form.show()}),t.start()}),jQuery("<a/>").addClass("cBtn cBtnWhite").html(window.t("Show helper board")).appendTo(this.uploadContainer).on("click",function(){i.showHelperBoard(),e.hideToolDialog()}),setTimeout(function(){e.hideToolDialog(n)||(n=e.showToolDialog(i.form,t,{}),e.toggleToolDialogButtons(!1),jQuery(document).trigger("newhtml"))},10)},toolbuttons:{chess:{icon:"chess.png",name:window.t("Chess"),onclick:function(e){this.extensions.chess.index(e)},special:!0}},provides:{tags:["span","p"],attributes:{span:["class"],p:["class"]}}}},jQuery.fn.editorextensions=jQuery.fn.editorextensions||{},jQuery.fn.editorextensions.clear=function(e,t){return{index:function(t){var n=e.extensions.dom.getSelection();if(n){var i=n.startContainer,o=n.endContainer,r=n.startOffset,a=n.endOffset;if(i=e.extensions.dom.findTextNode(i),o=e.extensions.dom.findTextNode(o,"back"),i==o){var s=e.extensions.dom.findBlockParent(i),l=e.extensions.dom.breakNode(s,[[i,r],[o,a]]);jQuery(s).html("").append(jQuery(l[0]).contents());var c=document.createTextNode(jQuery(l[1]).text());jQuery(s).append(c),jQuery(s).append(jQuery(l[2]).contents()),e.extensions.dom.flatten(s),e.extensions.dom.setSelection(c,c)}else{var d=e.extensions.dom.findBlockParent(i),u=e.extensions.dom.findBlockParent(o);if(d==u){var l=e.extensions.dom.breakNode(d,[[i,r],[o,a]]),c=document.createTextNode(jQuery(l[1]).text());jQuery(d).html("").append(jQuery(l[0]).contents()),jQuery(d).append(c),jQuery(d).append(jQuery(l[2]).contents()),e.extensions.dom.flatten(d),e.extensions.dom.setSelection(c,c)}else{var l=e.extensions.dom.breakNode(d,[[i,r]]),h=document.createTextNode(jQuery(l[1]).text());jQuery(d).html("").append(jQuery(l[0]).contents()),jQuery(d).append(h);for(var p=d.nextSibling;p!=u;)jQuery(p).find("*").each(function(){jQuery(this).is(e.widgetmask)||0!=jQuery(this).closest(e.widgetmask).length||jQuery(this).replaceWith(jQuery(this).contents())}),p=p.nextSibling;l=e.extensions.dom.breakNode(u,[[o,a]]);var f=document.createTextNode(jQuery(l[0]).text());jQuery(u).html("").append(jQuery(l[1]).contents()),jQuery(u).prepend(f),e.extensions.dom.flatten(d),e.extensions.dom.flatten(u),e.extensions.dom.setSelection(h,f)}}}},toolbuttons:{clear:{name:window.t("Remove formatting"),icon:"clear.png",onclick:function(e){this.extensions.clear.index(e)},shortcut:window.t("Ctrl-Del")}}}},jQuery.fn.editorextensions=jQuery.fn.editorextensions||{},jQuery.fn.editorextensions.dom=function(e,t){function n(t){if(!t)return null;var n=function(t,n){for(var i=null,o=-1,r=3==t.nodeType?[t]:e.extensions.dom.treeToVector(t.childNodes),a=0;a<r.length;a++){var s=r[a];if(3==s.nodeType){var l=s.nodeValue,c=n.indexOf(l);if(0!=c||n==l){i=s,o=n.length-1;break}n=n.substring(l.length)}}return{node:i,offset:o}};if(""==t.text){var i=t.duplicate();try{i.moveToElementText(i.parentElement()),i.setEndPoint("EndToEnd",t),t.startContainer=e.extensions.dom.findTextNode(i.parentElement(),"end"),t.endContainer=t.startContainer,t.startOffset=i.text.length;for(var o=e.extensions.dom.treeToVector(i.parentElement().childNodes),r=0;r<o.length&&o[r]!=t.startContainer;r++)3==o[r].nodeType&&(t.startOffset-=o[r].nodeValue.length);return t.endOffset=t.startOffset,t}catch(a){return null}}else if(""==t.htmlText){var i=t.duplicate();t.startContainer=t.parentElement(),t.endContainer=t.parentElement(),i.collapse(!0),i.moveStart("character",-1);for(var r=1;r<(t.startContainer.innerText||t.startContainer.textContent).length&&(t.startContainer.innerText||t.startContainer.textContent).substr(0,r)!=i.text;r++)i.moveStart("character",-1);if(""==i.text){var s=e.extensions.dom.findTextNode(t.startContainer);return s?(t.startContainer=s,t.startOffset=0,t.endOffset=0,t):null}var l=n(t.startContainer,i.text);return t.startContainer=l.node,t.startOffset=l.offset+1,t.endOffset=l.offset+1,t}if("undefined"==typeof t.duplicate)return null;var c=t.duplicate(),d=t.duplicate(),u=t.duplicate(),h=t.duplicate();c.collapse(!0),c.moveEnd("character",1),d.collapse(!1),d.moveStart("character",-1);var p=c.parentElement(),f=d.parentElement();u.moveToElementText(p),u.setEndPoint("EndToEnd",c),h.moveToElementText(f),h.setEndPoint("EndToEnd",d);var g=n(p,u.text),m=n(f,h.text);return t.startContainer=g.node,t.startOffset=g.offset,t.endContainer=m.node,t.endOffset=m.offset+1,t}var i=function(e){var t=e.outerHTML,n=e.innerHTML;if(!t)return["",""];var i=t.lastIndexOf("<"),o=t.substr(i);if(o==t)return[t,""];if(t=t.substr(0,i),n){i=t.lastIndexOf(n);var r=t.substr(0,i)}else var r=t;return delete t,delete n,[r,o]},o={valid:function(){return this.startContainer?"object"!=typeof this.startContainer.parentNode?!1:!0:!1},before:function(){if(!this.valid())return void 0;var t="",n=e.extensions.dom.findTextNode(this.startContainer,"forward"),o=e.get(0);n?t=n.nodeValue.substr(0,this.startOffset):(n=this.startContainer,t=i(n)[0]);for(var r=n;;){for(;r.previousSibling;)t=(r.previousSibling.outerHTML||r.previousSibling.nodeValue)+t,r=r.previousSibling;if(!r.parentNode||r.parentNode==o)break;t=i(r.parentNode)[0]+t,r=r.parentNode}return t},after:function(){if(!this.valid())return void 0;var t="",n=e.extensions.dom.findTextNode(this.endContainer,"back"),o=e.get(0);n?t=n.nodeValue.substr(this.endOffset):(n=this.endContainer,t=n.innerHTML+i(n)[1]);for(var r=n;;){for(;r.nextSibling;)t+=r.nextSibling.outerHTML||r.nextSibling.nodeValue,r=r.nextSibling;if(!r.parentNode||r.parentNode==o)break;t+=i(r.parentNode)[1],r=r.parentNode}return t}};return{ignore:["div"],mayBeEmpty:["div","br","hr","img"],mayBeJoined:["strong","i","u","strike"],msie:function(){for(var e=3,t=document.createElement("div"),n=t.getElementsByTagName("i");t.innerHTML="<!--[if gt IE "+ ++e+"]><i></i><![endif]-->",n[0];)return e>4?e:void 0}(),treeToVector:function(e,t){for(var n=[],i=0;i<e.length;i++)1==e[i].nodeType&&this.ignore.contains(e[i].tagName.toLowerCase())||((!t||t&&t(e[i]))&&n.push(e[i]),n=n.concat(this.treeToVector(e[i].childNodes,t)));return n},closestChildOf:function(e,t){for(var n=e;n&&n.parentNode;){if(n.parentNode==t)return n;n=n.parentNode}return delete n,null},scrubNode:function(e){if(1==e.nodeType&&this.mayBeEmpty.contains(e.tagName.toLowerCase()))return!1;for(var t=0;t<e.childNodes.length;t++)3==e.childNodes[t].nodeType&&""==e.childNodes[t].nodeValue?(t>0&&3==e.childNodes[t-1].nodeType||t<e.childNodes.length-1&&3==e.childNodes[t+1].nodeType)&&(e.removeChild(e.childNodes[t]),t--):this.scrubNode(e.childNodes[t]);return 1==e.nodeType&&0==e.childNodes.length?(e.parentNode.removeChild(e),!0):!1},deduplicate:function(e){return this.ignore.contains(e.tagName.toLowerCase())?void 0:(jQuery(e).find(e.tagName).each(function(){jQuery(this).replaceWith(jQuery(this).contents())}),e)},flatten:function(t,n){if(1!=t.nodeType||!this.ignore.contains(t.tagName.toLowerCase())||e.is(t)){var i,o=!1,r=t.childNodes;for(i=0;i<r.length;i++)3==r[i].nodeType&&""==r[i].nodeValue?(i>0&&3==r[i-1].nodeType||i<r.length-1&&3==r[i+1].nodeType)&&(o=!0,t.removeChild(r[i--])):1==r[i].nodeType&&(o=this.flatten(r[i])||o);if(this.scrubNode(t))return void delete r;for(i=0;i<r.length-1;)1!=r[i].nodeType||this.mayBeJoined.contains(r[i].tagName.toLowerCase())?n&&3==r[i].nodeType&&3==r[i+1].nodeType?(r[i].nodeValue+=r[i+1].nodeValue,t.removeChild(r[i+1]),o=!0):1==r[i].nodeType&&1==r[i+1].nodeType&&r[i].tagName.toLowerCase()==r[i+1].tagName.toLowerCase()?(jQuery(r[i]).append(jQuery(r[i+1]).contents()),t.removeChild(r[i+1]),o=!0):1==r[i].nodeType&&r[i+2]&&1==r[i+2].nodeType&&r[i].tagName.toLowerCase()==r[i+2].tagName.toLowerCase()&&3==r[i+1].nodeType&&!r[i+1].nodeValue.trim()?(jQuery(r[i]).append(r[i+1].nodeValue).append(jQuery(r[i+2]).contents()),t.removeChild(r[i+2]),t.removeChild(r[i+1]),o=!0):i++:i++;return delete r,o?this.flatten(t):!1}},breakNode:function(e,t){for(var n=[],i=function(){jQuery(this).replaceWith(jQuery(this).contents())},o=0;o<t.length;o++)"editor-wrapper"!=t[o][0].parentNode.className&&jQuery("<span/>").addClass("editor-wrapper").insertAfter(t[o][0]).append(t[o][0]);for(var r=jQuery(e).clone(!0),o=0;o<t.length;o++){var a=r.clone(!0),s=o>0?t[o][0]==t[o-1][0]?0:1:0,l=o>0&&t[o][0]==t[o-1][0]?t[o][1]-t[o-1][1]:t[o][1],c=a.find(".editor-wrapper:eq("+s+")");for(c.text(c.text().substr(0,l)),c=c.get(0);c&&!a.is(c);){for(;c.nextSibling;)c.parentNode.removeChild(c.nextSibling);c=c.parentNode}for(c=r.find(".editor-wrapper:eq("+s+")"),c.text(c.text().substr(l)),c=c.get(0);c&&!r.is(c);){for(;c.previousSibling;)c.parentNode.removeChild(c.previousSibling);c=c.parentNode}a.find(".editor-wrapper").each(i),n.push(a.get(0)),delete a}return r.find(".editor-wrapper").each(i),n.push(r.get(0)),jQuery(e).find(".editor-wrapper").each(i),delete r,n},findTextNode:function(e,t){if(!e)return null;if(3==e.nodeType)return e;"undefined"==typeof t&&(t="forward");var n=this.findBlockParent(e);switch(t){case"forward":for(var i=this.treeToVector((n||e).childNodes),o=n?i.indexOf(e):0,r=o+1;r<i.length;r++)if(3==i[r].nodeType){var a=i[r];return delete i,a}break;case"back":for(var i=this.treeToVector((n||e).childNodes),o=n==e?i.length:n?i.indexOf(e):0,r=o-1;r>=0;r--)if(3==i[r].nodeType){var a=i[r];return delete i,a}break;case"end":for(i=this.treeToVector(e.childNodes),r=i.length-1;r>=0;r--)if(3==i[r].nodeType){var a=i[r];return delete i,a}break;default:if(t>0&&e.childNodes[t]&&3==e.childNodes[t].nodeType)return e.childNodes[t]}return delete i,null},findBlockParent:function(e){if(!e)return null;for(var t=e;t&&(1!=t.nodeType||!this.isBlockElement(t));)t=t.parentNode;return t},rangeIsValid:function(t){return t&&t.commonAncestorContainer&&(jQuery(t.commonAncestorContainer).is(e)||jQuery(t.commonAncestorContainer).closest(e).length>0)},isBlockElement:function(e){return 1==e.nodeType&&void 0!==jQuery(e).css("display")&&-1==jQuery(e).css("display").indexOf("inline")},findNonTextNode:function(t){if("object"!=typeof t.parentNode)return null;for(;t;){if(1==t.nodeType)return e.is(t)||0==e.find(t).length?null:t;t=t.parentNode}return null},findTextOffset:function(e,t){var n=this.treeToVector(t.childNodes),i=n.indexOf(e);if(-1==i)return 0;var o=0;for(i--;i>=0;i--)3==n[i].nodeType&&(o+=n[i].nodeValue.length);return o},getSelection:function(){var t=function(){return e.cursorLastSeenAt?jQuery.extend({startContainer:e.cursorLastSeenAt,endContainer:e.cursorLastSeenAt,startOffset:e.cursorLastSeenAtIndex||0,endOffset:e.cursorLastSeenAtIndex||0,commonAncestorContainer:e.extensions.dom.findNonTextNode(e.cursorLastSeenAt)},o):null};if(window.getSelection){var i=window.getSelection();if(0==i.rangeCount)return null;if(i=i.getRangeAt(0),this.rangeIsValid(i))return jQuery.extend(i,o)}else{var r=document.selection.createRange();if(!r.parentElement||jQuery(r.parentElement()).find(e).length)return t();var i=n(r);if(!i||!i.startContainer)return t();for(var a=i.startContainer.parentNode;a&&(1!=a.nodeType||!jQuery.contains(a,i.endContainer));)a=a.parentNode;if(a&&(i.commonAncestorContainer=a),this.rangeIsValid(i))return jQuery.extend(i,o)}return t()},setSelection:function(e,t,n,i){if(e&&t)if(window.getSelection){for(;e&&1==e.nodeType;)e=e.firstChild;for(;t&&1==t.nodeType;)t=t.lastChild;if(!e||!t)return;"undefined"==typeof n&&(n=0),"undefined"==typeof i&&(i=t.nodeValue.length);var o=document.createRange();o.setStart(e,n),o.setEnd(t,i),window.getSelection().removeAllRanges(),window.getSelection().addRange(o),delete e,delete t,delete o}else{if(e=this.findTextNode(e,"forward"),t=this.findTextNode(t,"end"),!e||!t)return;var r=this.findNonTextNode(e,"before"),a=this.findNonTextNode(t,"before"),s=this.findTextOffset(e,r)+(n||0),l=this.findTextOffset(t,a)+(i||t.nodeValue.length),c=document.body.createTextRange();c.moveToElementText(r),c.moveStart("character",s);var d=document.body.createTextRange();d.moveToElementText(a),d.collapse(!0),d.moveEnd("character",l),c.setEndPoint("EndToEnd",d),c.select(),delete r,delete a,delete e,delete t,delete c,delete d}},setCursor:function(e,t){if(e&&e.parentNode){if(isNaN(t)&&"after"!=t&&"before"!=t&&(t="before"),isNaN(t)||1!=e.nodeType)e=this.findTextNode(e,"before"==t?"forward":"end");else{for(var n=this.treeToVector(e.childNodes),i=0;i<n.length;i++)if(3==n[i].nodeType){if(t<n[i].nodeValue.length){e=n[i];break}if(t-=n[i].nodeValue.length,0==t){for(e=n[i],t=n[i].nodeValue.length,i++;i<n.length;i++)if(3==n[i].nodesType){e=n[i],t=0;break}break}}1==e.nodeType&&(e=this.findTextNode(e,"forward"))}if(e)if(window.getSelection){t>e.nodeValue.length&&(t="after");var o=document.createRange();"after"==t?t=e.nodeValue.length:"before"==t&&(t=0),isNaN(t)?(o.selectNode(e),o.collapse("after"!=t)):(t=Math.min(t,e.nodeValue.length),o.setStart(e,t),o.setEnd(e,t)),window.getSelection().removeAllRanges(),window.getSelection().addRange(o),delete o}else{e=this.findTextNode(e);var r=this.findNonTextNode(e);if(!r)return;isNaN(t)||(t+=this.findTextOffset(e,r));var o=document.body.createTextRange();o.moveToElementText(r),isNaN(t)?"after"==t?o.collapse(!1):"before"==t&&o.collapse(!0):(o.collapse(!0),t>0&&(o.moveEnd("character",t),o.collapse(!1))),o.select()}}},setSelectionXY:function(e,t){var n=document.elementFromPoint(e,t),i=jQuery(n);if(!i.hasClass("not-selectable")&&!i.closest(".not-selectable").length)if("undefined"!=typeof document.body.createTextRange)try{var o=document.body.createTextRange();o.moveToPoint(e,t),o.select(),delete o}catch(r){}else if("function"==typeof document.createRange){var o=document.createRange();o.setStart(n,0),o.setEnd(n,0),window.getSelection().removeAllRanges(),window.getSelection().addRange(o)}},getSelectionXY:function(){var e=0,t=0;if(window.getSelection){var n=window.getSelection();if(n.rangeCount){var i=n.getRangeAt(0).cloneRange();if(i.getClientRects){i.collapse(!0);var o=i.getClientRects()[0];o&&(e=o.left,t=o.top)}}}else window.selection&&"Control"!=n.type&&(i=n.createRange(),i.collapse(!0),e=i.boundingLeft,t=i.boundingTop);return{x:e,y:t}},unsetSelection:function(){if("function"==typeof document.body.createTextRange){var t=document.body.createTextRange();t.moveToElementText(e.get(0)),t.collapse(!0),t.select(),delete t}else if("function"==typeof document.createRange){var t=document.createRange();t.setStart(e.get(0),0),t.setEnd(e.get(0),0),window.getSelection().removeAllRanges(),window.getSelection().addRange(t)}},isEmpty:function(e){var t=e.innerHTML;return"<br>"==t||"<br/>"==t||""==t||"&nbsp;"==t||" "==t},makeNonEmpty:function(e){if(e&&1==e.nodeType&&this.isBlockElement(e)&&this.isEmpty(e)){for(;e.childNodes.length>0;)e.removeChild(e.childNodes[0]);this.msie?e.appendChild(document.createTextNode("")):(e.appendChild(document.createTextNode("")),e.appendChild(document.createElement("br")))}}}},jQuery.fn.editorextensions=jQuery.fn.editorextensions||{},jQuery.fn.editorextensions.emoticons=function(e,t){function n(){e.setFocus(!0);var t=e.extensions.dom.findBlockParent(e.extensions.dom.getSelection().startContainer);if(t){var n=e.extensions.dom.treeToVector(t.childNodes,function(e){return 1===e.nodeType});if(1===n.length&&"BR"==n[0].tagName)var i=n[0]}var o=jQuery(this).find("img").clone(),r=document.createTextNode("");return e.insertAtCursor(o),i&&i.parentNode&&i.parentNode.removeChild(i),o.after(r),o.on("click",function(t){var n=o.get(0);t.offsetX<o.width()/2?e.extensions.dom.setCursor(n.previousSibling,"after"):(n.nextSibling||n.parentNode.appendChild(document.createTextNode("")),e.extensions.dom.setCursor(n.nextSibling,"before"))}),e.extensions.dom.setCursor(r,0),e.registerCursor(),e.setFocus(!0),!1}function i(){var e=jQuery("<div/>").addClass("customTabs emoticonTabs tab-position-bottom").on("chess24:hide chess24:show",function(e){e.stopPropagation()}),t=Emoticons.getByCategory();return Emoticons.getCategories().forEach(function(i){var o=jQuery("<section/>").attr("id",(new Helper.UUID).getShort()).data("tab-class","emojiCat "+i.css).data("tab-title",'<span title="'+i.title+'"></span>');t[i.key].forEach(function(e){o.append(jQuery("<span/>").addClass("editor-dialog-character btnEmoticon").attr("title",e.title).append(jQuery("<img/>").addClass("emoticon emoji "+e.css).attr("src",config.assetDir()+"/images/empty.png").attr("key",e.key)).on("click",n))}),e.append(o)}),e}var o=t&&t.extensionConfig&&t.extensionConfig.emoticons?t.extensionConfig.emoticons.dialogContainer:null,r=!!o;return r&&o.each(function(){var e=jQuery(this);e.append(i())}),{toolbuttons:{emoticons:{customClasses:"cTooltipBox position-bottom",getCustomContent:function(e){return jQuery('<img src="'+e+'emoticons.png"/><span class="cTooltipBoxContainer">').append(jQuery("<span>").append(i()))}}},provides:{tags:["img"],attributes:{img:["class","src","key"]},attributeValueRestrictions:{img:{src:["/images/empty.png",document.location.origin+"/images/empty.png",config.assetDir()+"/images/empty.png"]}}}}},jQuery.fn.editorextensions=jQuery.fn.editorextensions||{},jQuery.fn.editorextensions.highlight=function(e){return{check:function(t,n,i){if(!t)return!1;var o=e.extensions.dom.findNonTextNode(t.startContainer);if(n){n=n.split(" ");for(var r=o,a=n.length-1;a>=0;a--){var s=jQuery(r).closest(n[a]);if(!s.length&&!s.closest(e).length)return!1}}if(i){for(var r=e.extensions.dom.findBlockParent(o);r;){if(jQuery(r).is(e))return!1;var l,c=!0;for(l in i){for(var d=i[l].split(" "),u=!1,a=0;a<d.length;a++)if(jQuery(r).css(l)==d[a]){u=!0;break}if(!u){c=!1;break}}if(c)return!0;r=r.parentNode}return!1}return!0}}},jQuery.fn.editorextensions=jQuery.fn.editorextensions||{},jQuery.fn.editorextensions.history=function(e,t){var n=!1,i=[],o=[],r=function(){var t=e.extensions.dom.getSelection();if(!t)return 0;for(var n=0,i=e.extensions.dom.treeToVector(e.get(0).childNodes,function(e){return 3==e.nodeType}),o=0;o<i.length;o++){if(i[o]==t.startContainer)return Math.min(n+t.startOffset,e.text().length);i[o].nodeValue&&(n+=i[o].nodeValue.length)}return delete i,n},a=function(t){if(t>=e.text().length){var n=e.extensions.dom.findTextNode(e.get(0),"end");if(n)e.extensions.dom.setCursor(n,n.nodeValue.length);else{var i=e.find("> *").get(0);i&&(e.extensions.dom.makeNonEmpty(i),e.extensions.dom.setCursor(i))}}else{for(var o=e.extensions.dom.treeToVector(e.get(0).childNodes,function(e){return 3==e.nodeType}),r=0;r<o.length;r++)if(o[r].nodeValue){if(o[r].nodeValue.length>t){e.extensions.dom.setCursor(o[r],t);break}t-=o[r].nodeValue.length}delete o}};return{start:function(){i.push({html:e.getHtml(),full:e.html(),cursor:r(),putcursor:r()}),e.on("change",function(){if(n)return void(n=!1);var t=e.getHtml(),o=e.html();t!=i[i.length-1].html&&i.push({html:t,full:o,cursor:r(),putcursor:r()})}),e.on("keypress click paste",function(){i[i.length-1].putcursor=r()}),e.on("keyup",function(){var t=e.extensions.dom.getSelection();if(t&&t.commonAncestorContainer){var n=t.commonAncestorContainer;3==n.nodeType&&(n=n.parentNode),n&&(n=jQuery(n),n.is("a.unusual-link")&&n.trigger("change"))}}),e.backupWidgets()},index:function(t){if("undo"==t){if(1==i.length)return;n=!0;for(var r=i[i.length-1].html.replace(/<[^>]+>/g,""),s=i[i.length-1].cursor,l=0,c=i.length-2;c>=0;c--){var d=i[c].html.replace(/<[^>]+>/g,""),u=i[c].cursor;if(d==r)break;var h=!0,p=!0,f=!0;if(r.substr(s)!=d.substr(d.length-(r.length-s))&&(h=!1,f=!1),r.substr(0,s-l-1)!=d.substr(0,u)&&(h=!1),r.substr(0,s)!=d.substr(0,u-l-1)&&(f=!1),r.substr(0,s)!=d.substr(0,s)&&(p=!1),r.substr(s)!=d.substr(u+l+1)&&(p=!1),!h&&!p&&!f)break;l++}o.push(i.pop()),i=i.slice(0,Math.max(1,i.length-l)),e.html(i[i.length-1].full),a(i[i.length-1].putcursor),e.setupWidgets()}else if("redo"==t){if(0==o.length)return;n=!0;var g=o.pop();i.push(g),e.html(g.full),a(g.putcursor),e.setupWidgets(),delete g}},toolbuttons:{}}},jQuery.fn.editorextensions=jQuery.fn.editorextensions||{},jQuery.fn.editorextensions.hr=function(e,t){return{index:function(t){var n=e.extensions.dom.getSelection();if(n){if(e.is(n.startContainer))return void e.append("<hr/>");var i=e.extensions.dom.findBlockParent(n.startContainer);if(i==n.startContainer){var o=jQuery("<hr/>");if(n.startOffset>0?jQuery(i).after(o):jQuery(i).before(o),o.next().length)e.extensions.dom.setCursor(o.next().get(0),0);else{var r=jQuery("<p/>").insertAfter(o).get(0);e.extensions.dom.makeNonEmpty(r),e.extensions.dom.setCursor(r,0)}}else{var a=e.extensions.dom.breakNode(i,[[n.startContainer,n.startOffset]]);jQuery(a[1]).insertAfter(i),jQuery("<hr/>").insertAfter(i),(a[0].innerText||a[0].textContent).trim()&&jQuery(a[0]).insertAfter(i),jQuery(i).remove(),e.extensions.dom.makeNonEmpty(a[1]),e.extensions.dom.setCursor(a[1],0)}e.setFocus()}},toolbuttons:{hr:{name:window.t("Horizontal line"),icon:"hr.png",onclick:function(e){this.extensions.hr.index(e)}}},provides:{tags:["hr"]}}},jQuery.fn.editorextensions=jQuery.fn.editorextensions||{},jQuery.fn.editorextensions.link=function(e,t){var n="",i=/^(https?\:\/\/[a-z][\w\.\-]+([\/\?].*)?)?$/i,o=0,r=[{name:"link",label:"URL",show:function(){return!0},onclick:function(t){if(t.length>0){var n=t.attr("data"),i=jQuery("<a/>").html(t.html()).attr("href","http://");t.replaceWith(i),e.extensions.link.setup(),i.trigger("dblclick"),n&&(n=jQuery.parseJSON(n),n.views&&Widgets.Chess().chessBase.checkSeparatedViews(n.views,e))}}},{name:"chess-jump-to-link",label:"Chess link",show:function(){return!!e.extensions.chess&&!!e.extensions.widgets&&e.isWidgetAllowed("chess-jump-to-link")},onclick:function(t){e.extensions.widgets.createWidget("chess-jump-to-link",t)}},{name:"glossary-link",label:"Glossary",show:function(){return!!e.extensions.widgets&&!!e.isWidgetAllowed("glossary-link")},onclick:function(t){e.extensions.widgets.createWidget("glossary-link",t)}},{name:"biography-link",label:"Biography",show:function(){return!!e.extensions.widgets&&!!e.isWidgetAllowed("biography-link")},onclick:function(t){e.extensions.widgets.createWidget("biography-link",t)}},{name:"ebook-link",label:"Ebook",show:function(){return!!e.extensions.widgets&&!!e.isWidgetAllowed("ebook-link")},onclick:function(t){e.extensions.widgets.createWidget("ebook-link",t)}}],a=function(r){var a={};a[window.t("Save")]=function(t){return t.href?("http://"!=t.href.substr(0,7).toLowerCase()&&"https://"!=t.href.substr(0,8).toLowerCase()&&"mailto:"!=t.href.substr(0,7)&&(t.href="http://"+t.href),jQuery(r).attr("href",t.href).attr("title",t.title).attr("target",t.blank?"_blank":"").data("just-created",""),void e.extensions.dom.setSelection(r,r)):void(a[window.t("Delete")]||a[window.t("x")])()},a[e.is(".white")?"x":window.t("Delete")]=function(t){var n=r.parentNode,i=e.extensions.dom.findTextNode(r,"forward"),o=e.extensions.dom.findTextNode(r,"end");jQuery(r).replaceWith(jQuery(r).contents()),e.extensions.dom.flatten(n),e.extensions.dom.setSelection(i,o)},a[window.t("Cancel")]=function(t){if(t.href==n&&jQuery(r).data("just-created")){var i=r.parentNode,o=e.extensions.dom.findTextNode(r,"forward"),a=e.extensions.dom.findTextNode(r,"end");jQuery(r).replaceWith(jQuery(r).contents()),e.extensions.dom.flatten(i),e.extensions.dom.setSelection(o,a)}else e.extensions.dom.setCursor(r,0)};var s=t.extraClass&&t.extraClass.match(/white/),l=jQuery("<div/>").append(jQuery("<h3>"+window.t("Link properties")+"</h3>")),c=(jQuery("<label/>").addClass("options").appendTo(l),jQuery("<div/>").addClass(s?"":"resource-properties").appendTo(l)),d="";jQuery(r).attr("href")&&(d=jQuery(r).attr("href")),!d&&jQuery(r).text().match(i)&&(d=jQuery(r).text());var u=jQuery("<div/>").addClass("url").appendTo(c);u.append(jQuery("<label/>").html(window.t("URL"))),u.append(jQuery('<input type="text"/>').addClass(s?"":"cPattern").attr("name","href").val(d).attr("size","50")),u.append(s?"":'<br class="clear"/>');var h=jQuery("<div/>").addClass("title").appendTo(c);h.append(jQuery("<label/>").html(window.t("Title"))),h.append(jQuery('<input type="text"/>').addClass(s?"":"cPattern").attr("name","title").val(jQuery(r).attr("title")||"").attr("size","50")),h.append(s?"":'<br class="clear"/>');var p=jQuery("<div/>").addClass("target").appendTo(c);p.append(jQuery('<input type="checkbox"/>').addClass("cPattern").attr("name","blank").val("_blank"==jQuery(r).attr("target")?1:0).attr("checked","_blank"==jQuery(r).attr("target"))),p.append(jQuery("<span/>").html(window.t("Open in a new window"))),p.append(s?"":'<br class="clear"/>'),e.extensions.link.formOptions(l,r,"link"),o=e.showToolDialog(l,r,a),jQuery(document).trigger("newhtml")};return{init:function(t){var n=this;return n.setup(),e.on("change",function(){n.setup()}),this},setup:function(){e.find("a").each(function(){jQuery(this).hasClass("unusual-link")||jQuery(this).closest("div").hasClass("editor")&&jQuery(this).off("dblclick").on("dblclick",function(){return a(this),!1})}).on("click",function(e){try{e.preventDefault()}catch(t){e.returnValue=!1}return!1})},formOptions:function(e,t,n){var i=e.find(".options");if(i.length){i.html("");for(var o=0;o<r.length;o++)r[o].show()&&(n==r[o].name?i.append(jQuery("<span/>").html(r[o].label)):jQuery("<a/>").html(r[o].label).on("click",function(e){return function(){e(jQuery(t))}}(r[o].onclick)).appendTo(i));var a=i.find("a,span");a.length<2?i.hide():a.not(a.last()).after(" - ")}},index:function(t){if(!e.hideToolDialog(o)){var i=e.extensions.dom.getSelection();if(i){var r=i.startContainer,s=i.endContainer,l=i.startOffset,c=i.endOffset;if(3!=r.nodeType&&(r=e.extensions.dom.findTextNode(r,"forward"),l=0),3!=s.nodeType&&(s=e.extensions.dom.findTextNode(s,"back"),c=s?s.nodeValue.length:c),r&&s){var d=n;if(r!=s||l!=c){for(;l<r.nodeValue.length&&!r.nodeValue.substr(l,1).trim();)l++;for(;c>1&&!s.nodeValue.substr(c-1,1).trim();)c--;var u=e.extensions.dom.findBlockParent(r),h=e.extensions.dom.findBlockParent(s);if(u!=h?(s=e.extensions.dom.findTextNode(u,"end"),c=s.nodeValue.length):u=i.commonAncestorContainer,3==u.nodeType&&(u=u.parentNode),jQuery(u).is("a"))return void jQuery(u).trigger("dblclick");var p=jQuery(u).closest("a").get(0);if(p)return void a(p);if(jQuery(u).find("a").each(function(){var t=jQuery(this);(e.extensions.dom.closestChildOf(r,this)||e.extensions.dom.closestChildOf(s,this))&&(d==n&&t.attr("href")&&(d=t.attr("href")),t.replaceWith(t.contents()))}),r==s&&3==r.nodeType){var f=document.createTextNode(r.nodeValue.substr(0,l)),g=document.createTextNode(r.nodeValue.substr(c)),m=jQuery("<a/>").attr("href",d).data("just-created",1).text(r.nodeValue.substr(l,c-l)).on("dblclick",function(){return a(this),!1}).get(0);return r.parentNode.insertBefore(f,r),r.parentNode.insertBefore(m,r),r.parentNode.insertBefore(g,r),r.parentNode.removeChild(r),a(m),void e.extensions.dom.setSelection(m,m)}var v=e.extensions.dom.breakNode(u,[[r,l],[s,c]]),m=jQuery("<a/>").attr("href",d).data("just-created",1).append(jQuery(v[1]).contents()).on("dblclick",function(){return a(this),!1}).get(0);jQuery(u).html("").append(jQuery(v[0]).contents()),jQuery(u).append(m),jQuery(u).append(jQuery(v[2]).contents()),e.extensions.dom.flatten(u),a(m),e.extensions.dom.setSelection(m,m)}else if(r){var y=jQuery(r).closest("a");y.length&&y.trigger("dblclick")}}}}},toolbuttons:{link:{name:window.t("Add link"),icon:"link.png",onclick:function(e){this.extensions.link.index(e)},highlight:function(e){return this.extensions.highlight.check(e,"a")}}},provides:{tags:["a"],attributes:{a:["href","class","data","contenteditable","unselectable","target","title","data-widget"]}}}},jQuery.fn.editorextensions=jQuery.fn.editorextensions||{},jQuery.fn.editorextensions.list=function(e,t){var n=["ul","ol"],i=function(e){var t,n=jQuery(e);return n.find("li").each(function(){var e=jQuery(this);e.find("*:first").is("h1,h2,h3,p,blockquote")?(t=e.find("*:last"),e.contents().insertBefore(n)):t=jQuery("<p/>").append(e.contents()).insertBefore(n)}),n.remove(),t},o=function(e,t){var n=jQuery(e);n.replaceWith(jQuery("<"+t+"/>").append(n.contents()))};return{keypress:function(e,t,n,i){return t||n||i?!1:8==e?this.keypressBackspace():!1},keypressBackspace:function(){setTimeout(function(){e.find(n.join(",")).each(function(){var e=jQuery(this);if(e.parent().length){for(this.tagName;e.next().is(this.tagName);)e.append(e.next().contents()),e.next().remove()}})},50);var t=e.extensions.dom.getSelection();if(!t)return!1;var i=t.startContainer;if(!i)return!1;if(t.startOffset>0)return!1;var o;3==i.nodeType&&(i=i.parentNode);var r=jQuery(i);if(!r.is("li")&&0==r.closest("li").length)return!1;if(r.is("li"))o=r;else{for(var a=r;;){if(0==a.length)return!1;if(a.is("li"))break;if(a.prevAll().html())return!1;
a=a.parent()}o=a}var s=jQuery(t.startContainer).closest("ol,ul");if(!s.length||!o||!o.length)return!1;if(0!=t.startOffset)return!1;o.addClass("break-list");var l=s.clone(!0);l.find(".break-list").prevAll("li").remove(),l.find(".break-list").remove(),l.insertAfter(s),s.find(".break-list").nextAll("li").remove();var c=document.createTextNode(""),d=o.contents();return""==d.html()&&(d="&nbsp;"),jQuery("<p/>").append(c).append(d).insertAfter(s),o.remove(),e.extensions.dom.setCursor(c,"after"),0==s.find("li").length&&s.remove(),0==l.find("li").length&&l.remove(),!0},index:function(t){return n.contains(t)?function(r){var a=e.extensions.dom.getSelection();if(a){var s=n[1-n.indexOf(t)],l=a.startContainer,c=a.endContainer,d=a.startOffset,u=a.endOffset,h=a.startContainer,p=a.endContainer;if(h==e.get(0)&&(h=e.get(0).firstChild),p==e.get(0)&&(p=e.get(0).lastChild),h==p){var f=h;if(f=e.extensions.dom.findBlockParent(h),f==e.get(0)){var g=document.createTextNode(""),m=jQuery("<li/>").append(g);return void e.insertAtCursor(jQuery("<"+t+"/>").append(m))}if(f){var v=jQuery(f);if(v.is("h1,h2,h3")){var y=v.closest("li");y.length&&(v=y,f=v.get(0))}if(v.is(t))i(f);else if(v.is(s))o(f,t);else if(v.is("li")||v.closest("li").length)if(v.is("li")||(v=v.closest("li")),v.parent().is(t)){i(v.parent())}else v.parent().is(s)?o(v.parent(),t):v.replaceWith(jQuery("<p/>").append(v.contents()));else{l=a.startContainer,d=a.startOffset,c=a.endContainer,u=a.endOffset;var m=jQuery("<li/>");v.is("h1,h2,h3")?(jQuery("<"+t+"/>").append(m).insertBefore(v),m.append(v)):(m.append(v.contents()),v.replaceWith(jQuery("<"+t+"/>").append(m)))}}}else{var w=a.commonAncestorContainer,b=jQuery(w);if(b.is(s))b.replaceWith(jQuery("<"+t+"/>").append(b.contents()));else if(b.is(t)){i(b)}else{var C=e.extensions.dom.closestChildOf(h,w),k=e.extensions.dom.closestChildOf(p,w);if(!C||!k)return;var F=jQuery("<"+t+"/>").insertBefore(C),x=Array.convert(w.childNodes).indexOf(C),T=Array.convert(w.childNodes).indexOf(k);jQuery(C).is(s)&&jQuery(C).replaceWith(jQuery("<"+t+"/>").append(jQuery(C).contents())),jQuery(k).is(s)&&jQuery(k).replaceWith(jQuery("<"+t+"/>").append(jQuery(k).contents()));for(var _=Array.convert(w.childNodes).slice(x,T+1),E=0;E<_.length;E++){var S=jQuery(_[E]);3==_[E].nodeType?F.append(jQuery("<li/>").append(_[E])):S.is(t)?(F.append(S.contents()),S.remove()):S.is("p")?(F.append(jQuery("<li/>").append(S.contents())),S.remove()):F.append(jQuery("<li/>").append(S))}}}l!=c||d!=u?e.extensions.dom.setSelection(l,c,d,u):e.extensions.dom.setCursor(l,d)}}:function(){}},toolbuttons:{ulist:{name:window.t("Bullet list"),icon:"ulist.png",onclick:function(e){this.extensions.list.index("ul")(e)},highlight:function(e){return this.extensions.highlight.check(e,"ul li")}},olist:{name:window.t("Ordered list"),icon:"olist.png",onclick:function(e){this.extensions.list.index("ol")(e)},highlight:function(e){return this.extensions.highlight.check(e,"ol li")}}},provides:{tags:["ol","ul","li"]}}},jQuery.fn.editorextensions=jQuery.fn.editorextensions||{},jQuery.fn.editorextensions.paragraph=function(e,t){var n=["h1","h2","h3","blockquote","p"];return{keypress:function(e,t,n,i){return t||n||i?!1:8==e?this.keypressBackspace():13==e?this.keypressEnter():!1},keypressEnter:function(){var t=e.extensions.dom.getSelection();if(!t)return!1;var i=e.extensions.dom.findNonTextNode(t.startContainer,"before");if(!i)return!1;var o=e.extensions.dom.findBlockParent(i);if(!o||!jQuery(o).is(n.join(",")))return!1;var r=jQuery(o).closest("li");if(0==r.length||!e.find(r).length)return!1;var a=e.extensions.dom.breakNode(r.get(0),[[t.startContainer,t.startOffset]]);r.after(a[1]).replaceWith(a[0]);for(var s=0;s<a.length;s++)if(""==jQuery(a[s]).text()){var l=jQuery(a[s]).find("> *:first").get(0);e.extensions.dom.makeNonEmpty(l||a[1])}var c=e.extensions.dom.findTextNode(a[1]);return e.extensions.dom.setCursor(c,0),!0},keypressBackspace:function(){var t=e.extensions.dom.getSelection();if(!t)return!1;var i=e.extensions.dom.findNonTextNode(t.startContainer);if(!i)return!1;var o=e.extensions.dom.findBlockParent(i);if(!o||!jQuery(o).is(n.join(",")))return!1;var r=jQuery(o),a=r.closest("blockquote");if(!a.length)return!1;if(r.nextAll().length||""!=r.text())return!1;r.insertAfter(a);var s=document.createTextNode("");return r.append(s),e.extensions.dom.setCursor(s,0),!0},indent:function(t){var n=e.extensions.dom.getSelection();if(n){var i,o,r=e.get(0);for(e.is(n.startContainer)?(i=r.childNodes[0],o=r.childNodes[r.childNodes.length-1]):(i=e.extensions.dom.closestChildOf(n.startContainer,r),o=e.extensions.dom.closestChildOf(n.endContainer,r));;){var a=parseInt(i.className.replace(/.*depth-(\d+).*/,"$1")||0);if((!t&&a>0||t&&24>a)&&jQuery(i).removeClass("depth-"+a).addClass("depth-"+(parseInt(a)+(t?1:-1))),i==o)break;i=i.nextSibling}}},index:function(t){return n.contains(t)?function(i){var o=e.extensions.dom.getSelection();if(o){var r=o.startContainer,a=o.startOffset,s=o.endContainer,l=o.endOffset,c=e.extensions.dom.findBlockParent(o.startContainer),d=e.extensions.dom.findBlockParent(o.endContainer);if(c==e.get(0)&&(c=e.get(0).firstChild),d==e.get(0)&&(d=e.get(0).lastChild),c==d){var u=e.extensions.dom.findBlockParent(c);if(u==e.get(0))return u=jQuery("<"+t+"/>"),e.insertAtCursor(u),void e.extensions.dom.setCursor(u,"after");if(u){var h,p=jQuery(u);if((h=p.closest(t))&&h.length)h.find(n.join(",")).length||h.closest("li").length?h.replaceWith(h.contents()):h.after(jQuery("<p/>").append(h.contents())).remove();else if(p.is(t))p.find(n.join(",")).length||p.closest("li").length?p.replaceWith(p.contents()):p.after(jQuery("<p/>").append(p.contents())).remove();else if((h=p.closest("ul,ol"))&&h.length)if("blockquote"==t){var f=p.closest("li");f.addClass("break-list");var g=h.clone(!0).insertAfter(h);h.find(".break-list").nextAll("li").remove(),g.find(".break-list").prevAll("li").remove(),g.find(".break-list").remove(),jQuery("<"+t+"/>").insertAfter(h).append(h.find(".break-list").contents()),h.find(".break-list").remove(),0==h.find("li").length&&h.remove(),0==g.find("li").length&&g.remove()}else p.append(jQuery("<"+t+"/>").append(p.contents()));else{var m=e.extensions.dom.closestChildOf(u,e.get(0));if(m){var v=jQuery(m);if("blockquote"==t)jQuery("<"+t+"/>").insertAfter(v).append(v);else if(v.is("blockquote"))p.replaceWith(jQuery("<"+t+"/>").append(p.contents()));else{var y=jQuery("<"+t+"/>").append(v.contents());if(v.replaceWith(y),""==y.text()){var w=document.createTextNode("");y.prepend(w),r=w,s=w,a=0,l=0}}}}}}else{0==o.endOffset&&d.previousSibling&&(d=d.previousSibling);var b,C,k;"blockquote"==t?(c=e.extensions.dom.closestChildOf(c,e.get(0)),d=e.extensions.dom.closestChildOf(d,e.get(0)),b=Array.convert(e.get(0).childNodes),C=b.indexOf(c),k=b.indexOf(d)):(b=e.extensions.dom.treeToVector(o.commonAncestorContainer.childNodes,e.extensions.dom.isBlockElement),C=b.indexOf(c),k=b.indexOf(d));for(var F=!0,x=C;k>=x;x++)if(!jQuery(b[x]).is(t)){F=!1;break}if("blockquote"==t)if(F)for(var x=C;k>=x;x++){var p=jQuery(b[x]);p.find(n.join(",")).length?p.replaceWith(p.contents()):p.replaceWith(jQuery("<p/>").append(p.contents()))}else for(var T=jQuery("<"+t+"/>").insertBefore(e.extensions.dom.closestChildOf(c,e.get(0))),x=C;k>=x;x++){var p=jQuery(b[x]);p.is(t)?(T.append(p.contents()),p.remove()):T.append(p)}else if(F)for(var x=C;k>=x;x++){var p=jQuery(b[x]);p.is(t)?p.find(n.join(",")).length?p.replaceWith(p.contents()):(p.replaceWith(jQuery("<p/>").append(p.contents())),p.remove()):p.find(t).length&&p.find(t).each(function(){jQuery(this).replaceWith(jQuery("<p/>").append(jQuery(this).contents()))})}else for(var x=C;k>=x;x++){var p=jQuery(b[x]);p.is(t)||(p.is("blockquote")?p.find(n.join(",")).length?p.find(n.join(",")).each(function(){jQuery(this).replaceWith(jQuery("<"+t+"/>").append(jQuery(this).contents()))}):p.append(jQuery("<"+t+"/>").append(p.contents())):p.is(n.join(","))&&p.after(jQuery("<"+t+"/>").append(p.contents())).remove())}}e.extensions.dom.setSelection(r,s,a,l)}}:function(){}},toolbuttons:{h1:{name:window.t("Header 1"),icon:"h1.png",onclick:function(e){this.extensions.paragraph.index("h1")(e)},highlight:function(e){return this.extensions.highlight.check(e,"h1")},shortcut:window.t("Ctrl-1")},h2:{name:window.t("Header 2"),icon:"h2.png",onclick:function(e){this.extensions.paragraph.index("h2")(e)},highlight:function(e){return this.extensions.highlight.check(e,"h2")},shortcut:window.t("Ctrl-2")},h3:{name:window.t("Header 3"),icon:"h3.png",onclick:function(e){this.extensions.paragraph.index("h3")(e)},highlight:function(e){return this.extensions.highlight.check(e,"h3")},shortcut:window.t("Ctrl-3")},blockquote:{name:window.t("Quote"),icon:"blockquote.png",onclick:function(e){this.extensions.paragraph.index("blockquote")(e)},highlight:function(e){return this.extensions.highlight.check(e,"blockquote")}},indent:{name:window.t("Increase indent"),icon:"indent.png",onclick:function(e){this.extensions.paragraph.indent(!0)},highlight:function(){return!1}},unindent:{name:window.t("Decrease indent"),icon:"unindent.png",onclick:function(e){this.extensions.paragraph.indent(!1)},highlight:function(){return!1}}},provides:{tags:["p","h1","h2","h3","blockquote"],attributes:{p:["class"],blockquote:["contenteditable"]}}}},jQuery.fn.editorextensions=jQuery.fn.editorextensions||{},jQuery.fn.editorextensions.resizable=function(e,t){return{index:function(t,n){var i=t.attr("properties")?jQuery.parseJSON(t.attr("properties")):{},o=[];switch(i.resizable){case"x":o=["e","w"];break;case"y":o=["n","s"];break;case"save-ratio":case"free":o=["n","ne","e","se","s","sw","w","nw"]}var r=i["resizable-xfrom"]||0,a=i["resizable-xto"]||0,s=i["resizable-yfrom"]||0,l=i["resizable-yto"]||0,c=i["resizable-xstep"]||1,d=i["resizable-ystep"]||1;t.find(".widget-resize, .widget-float").remove();var u=o.contains("n")?jQuery('<div class="widget-resize widget-resize-n"/>').appendTo(t):jQuery("null"),h=o.contains("e")?jQuery('<div class="widget-resize widget-resize-e"/>').appendTo(t):jQuery("null"),p=o.contains("w")?jQuery('<div class="widget-resize widget-resize-w"/>').appendTo(t):jQuery("null"),f=o.contains("s")?jQuery('<div class="widget-resize widget-resize-s"/>').appendTo(t):jQuery("null"),g=(o.contains("nw")?jQuery('<div class="widget-resize widget-resize-nw"/>').appendTo(t):jQuery("null"),o.contains("ne")?jQuery('<div class="widget-resize widget-resize-ne"/>').appendTo(t):jQuery("null"),o.contains("sw")?jQuery('<div class="widget-resize widget-resize-sw"/>').appendTo(t):jQuery("null"),o.contains("se")?jQuery('<div class="widget-resize widget-resize-se"/>').appendTo(t):jQuery("null"),jQuery('<div class="widget-float widget-float-left"/>').appendTo(t)),m=jQuery('<div class="widget-float widget-float-none"/>').appendTo(t),v=jQuery('<div class="widget-float widget-float-right"/>').appendTo(t),y=t.find(".widget-resize"),w=t.find(".widget-float"),b=function(){u.add(f).css("left",t.outerWidth()/2-u.width()/2+"px"),p.add(h).css("top",t.height()/2-p.height()/2+"px"),g.css("left",t.outerWidth()/2-40-g.width()+"px"),m.css("left",t.outerWidth()/2-m.width()/2+"px"),v.css("left",t.outerWidth()/2+40+"px"),w.css("top",t.height()/2-w.height()/2+"px"),w.removeClass("highlighted"),t.find(".widget-float-"+t.css("float")).addClass("highlighted")};t.on("resize.resizable",b),b();var C=r||parseInt(e.css("line-height"))||16,k=jQuery("<p/>").appendTo(e),F=a||k.width()-(t.outerWidth()-t.width());k.remove();var x=s||parseInt(e.css("line-height"))||16,T=l||e.height(),_=!1;y.hide(),w.hide(),t.on("mouseover.resizable",function(){y.show(),w.show()}).on("mouseout.resizable",function(){_||(y.hide(),w.hide())}),w.on("click",function(){var e=this.className.match(/widget-float-(\w+)/)[1];t.css({"float":e,clear:"none"===e?"both":"none",margin:"left"===e?"0px 10px 10px 0px":"right"===e?"0px 0px 10px 10px":"0px auto 0px auto"}),t.trigger("resize"),b()}),y.each(function(){var e=this.className.match(/widget-resize-(\w+)/)[1],o=jQuery(this);o.on("mousedown",function(r){jQuery("body").css("cursor",o.css("cursor")),_=!0;var a=r.clientX,s=r.clientY,l=t.width(),u=t.height(),h=l/u;try{r.stopPropagation(),r.preventDefault()}catch(p){r.cancelBubble=!0,r.returnValue=!1}var f=function(o){var r=["nw","w","sw"].contains(e)?-1:1,p=["nw","n","ne"].contains(e)?-1:1,f=o.clientX-a,g=o.clientY-s;"none"==t.css("float")&&(f*=2);var m=l+r*f,v=u+p*g;if(m=["e","w","se","sw","ne","nw"].contains(e)?Math.min(F,Math.max(C,m)):l,v=["s","n","se","sw","ne","nw"].contains(e)?Math.min(T,Math.max(x,v)):u,m=c*Math.round(m/c),v=d*Math.round(v/d),"save-ratio"==n){var y="v";["e","w"].contains(e)&&(y="h"),["se","sw","ne","nw"].contains(e)&&(y=f>g?"h":"v"),"v"==y?m=v*h:v=m/h,C>m&&(m=C,v=m/h),m>F&&(m=F,v=m/h)}(m!=t.width()||v!=t.height())&&(t.css("width","y"==i.resizable?"auto":m+"px"),t.css("height","x"==i.resizable?"auto":v+"px"),b(),t.trigger("resize",[!0]))},g=function(){_=!1,jQuery("body").css("cursor",""),jQuery(document).off("mousemove",f),t.trigger("resize"),t.trigger("mouseout")};jQuery(document).on("mousemove",f),jQuery(document).one("mouseup",g)})})},reset:function(e){e.find(".widget-resize, .widget-float").remove(),e.off("resize.resizable mouseover.resizable mouseout.resizable"),e.css({margin:"0px auto 0px auto","float":"none"})}}},jQuery.fn.editorextensions=jQuery.fn.editorextensions||{},jQuery.fn.editorextensions.source=function(e,t){var n=function(e){var t=jQuery("<div/>").html(e);return e="",t.find("> *").each(function(){if(jQuery(this).is("ol,ul")){var t=[];jQuery(this).find("> li").each(function(){this.innerHTML=this.innerHTML.replace(/<widget>/gi,"[widget]").replace(/<\/widget>/gi,"[/widget]").trim(),t.push(this.outerHTML.replace(/\[(\/?widget)\]/gi,"<$1>"))}),this.innerHTML="\n"+t.join("\n")+"\n"}else this.innerHTML=this.innerHTML.replace(/<widget>/gi,"[widget]").replace(/<\/widget>/gi,"[/widget]").trim();e+=this.outerHTML.replace(/\[(\/?widget)\]/gi,"<$1>")+"\n\n"}),t.remove(),e};return{leave:function(t){var n=this.getContainer(!0);if(n&&n.length){e.toggleToolbarButtons(!0,null,["source"]),e.html(n.val()).restoreWidgets(),e.removeUnwanted(),e.rescueOrphans(),n.hide(),e.show(),t&&e.trigger("change");var i=e.extensions.dom.findTextNode(e.get(0));if(!i){var o=e.find("> *:first").get(0);o||(e.rescueOrphans(),o=e.find("> *:first").get(0)),e.extensions.dom.makeNonEmpty(o),i=o}e.extensions.dom.setCursor(i,0)}},getContainer:function(t){var n=e.siblings(".editor-source:first"+(t?":visible":""));return n.length?n:null},index:function(){var t=e.siblings(".editor-source:first");t.length||(t=jQuery("<textarea/>").addClass("editor-source").insertAfter(e),t.css({width:e.outerWidth()-parseInt(t.css("padding-left"))-parseInt(t.css("padding-right"))+"px",height:e.outerHeight()+"px",resize:"vertical"}).hide()),"block"==t.css("display")?this.leave(!0):(e.toggleToolbarButtons(!1,null,["source"]),e.backupWidgets(!1),t.val(n(e.getHtml())),e.hide(),t.show())},toolbuttons:{source:{name:window.t("Toggle visual/HTML mode"),icon:"source.png",onclick:function(e){this.extensions.source.index(e)},special:!0}}}},jQuery.fn.editorextensions=jQuery.fn.editorextensions||{},jQuery.fn.editorextensions.widgets=function(e,t){var n,i=t.widgets||[],o=t.widgetsLayout||[["image","slideshow","audio","file","broadcast"],["chess-board","tournament","table","simple-chess-board","author"],["ebook-section","ebook-exercise","external-video","google-maps","twitter","html"]],r=0,a=new Handler.Template("widgets");return{lastwidgetid:0,widgetid:function(){return"new"+ ++this.lastwidgetid},borrowedWidgets:function(e){var t=this;e.each(function(){var e=jQuery(this),n=t.widgetid(),i=jQuery.parseJSON(e.attr("data"));i&&(i.vid=n,e.attr("data",jQuery.toJSON(i)));var o=e.data("widget");o&&(o.vid=n,e.data("widget",o))})},setupButtons:function(){var e=this;this.form.on("click",".add-button",function(){var t=jQuery(this).data("key");e.addResource(t),e.form.find(".resources-previews").hide(),e.form.find(".resource-properties[data-key="+t+"]").show()}),this.form.on("click",".edit-button",function(){var t=jQuery(this).closest(".resources-preview-item").data("resource-id");e.editResource(t)}),this.form.on("click",".save-button",function(){var t=jQuery(this).closest(".resource-properties"),n=t.data("resource-id");e.saveResource(n,t)}),this.form.on("click",".delete-button",function(){var t=jQuery(this).closest(".resources-preview-item").data("resource-id");e.removeResource(t)})},collectResource:function(e){var t={"class":void 0,reference_id:void 0,properties:{}};return e.find("input,select,textarea").each(function(){var e=jQuery(this);if(!e.is("input[type=radio],input[type=checkbox]")||e.is(":checked")){var n=e.val();e.is("input[type=hidden]")&&e.parent().is(".checkbox")&&(n=e.parent().is(".checked")?"on"==e.val()?1:e.parent().attr("data")||1:""),"json"==e.data("format")&&n&&(n=jQuery.parseJSON(n));var i=jQuery(this).data("resource-property");switch(i){case"reference_id":t.reference_id=n;break;case"class":t["class"]=n;break;default:i&&("[]"==i.substr(i.length-2)?(i=i.substr(0,i.length-2),Array.isArray(t.properties[i])?t.properties[i].push(n):t.properties[i]=[n]):t.properties[i]=n)}}}),t},collectProperties:function(e){var t={wid:void 0,vid:void 0,properties:{}};return e.find("input,select,textarea").each(function(){var e=jQuery(this),n=e.val();e.is("input[type=radio],input[type=checkbox]")?n=e.is(":checked")?"on"==n?1:n:"on"==n?0:"":e.is("input[type=hidden]")&&e.parent().is(".checkbox")&&(n=e.parent().is(".checked")?"on"==e.val()?1:e.parent().attr("data")||1:""),"json"==e.data("format")&&n&&(n=jQuery.parseJSON(n));var i=jQuery(this).data("widget-property");switch(i){case"wid":t.wid=n;break;case"vid":t.vid=n;break;default:i&&("[]"==i.substr(i.length-2)?(i=i.substr(0,i.length-2),Array.isArray(t.properties[i])?t.properties[i].push(n):t.properties[i]=[n]):t.properties[i]=n)}}),t},addResource:function(e){this.form.find(".resources-previews").hide();var t=this.form.find(".resource-properties[data-key="+e+"]").show().trigger("show");t.find("[data-resource-property]").val("").html(""),t.find("[data-resource-property=class]").val(e),t.find("[data-resource-property=reference_id]").val(""),t.data("resource-id",-1)},editResource:function(e){var t=this.widgetdata.resources[e];this.form.find(".resources-previews").hide();var n=this.form.find(".resource-properties[data-key="+t["class"]+"]").show().trigger("show");n.find("[data-resource-property=class]").val(t["class"]),n.find("[data-resource-property=reference_id]").val(t.reference_id),n.data("resource-id",e);for(var i in t.properties)n.find("[data-resource-property="+i+"]").each(function(){var e=jQuery(this);e.is(".editor")?e.html(t.properties[i]):e.val(t.properties[i])})},saveResource:function(e,t){(0>e||"undefined"==typeof e)&&(e=this.widgetdata.resources.length);var n=this.collectResource(t);n._id=e,this.widgetdata.resources[e]=n;var i=a.render("widget-"+this.widgetdata.wid+"-preview-"+n["class"],n),o=jQuery(i).attr("data-resource-id",e);return this.form.find(".resources-previews [data-resource-id="+e+"]").length?this.form.find(".resources-previews [data-resource-id="+e+"]").replaceWith(o):this.form.find(".resources-previews .resources-previews-list").append(o),this.form.trigger("update"),this.form.find(".resources-previews").show(),this.form.find(".resource-properties").hide(),e},removeResource:function(e){this.widgetdata.resources.remove(e),this.form.find(".resources-previews [data-resource-id="+e+"]").remove(),this.form.trigger("update")},reorderResources:function(e){for(var t=[],n=0;n<e.length;n++){var i=this.widgetdata.resources[e[n]];i._id=n,t.push(i)}this.widgetdata.resources=t},createWidget:function(n,i){var o=this,r=Widgets[n.toCamelCase(!0)]();this.widgetdata={vid:this.widgetid(),wid:n,properties:jQuery.extend({},r.properties),resources:[]},this.widget=i||null;var s=a.render("widget-"+this.widgetdata.wid+"-dialog",this.widgetdata);this.form=jQuery(s);var l={};l[window.t("Insert")]=function(e){return o.save(),!0},e.showToolDialog(this.form,null,l),this.setupButtons(),r.dialog(this.form,e,t,{},this.widget)},editWidget:function(n){var i=this;this.widgetdata=jQuery.extend({},n.data("widget"));for(var o=0;o<this.widgetdata.resources.length;o++)this.widgetdata.resources[o]._id=o;this.widget=n;var r=a.render("widget-"+this.widgetdata.wid+"-dialog",this.widgetdata);this.form=jQuery(r);var s=Widgets[this.widgetdata.wid.toCamelCase(!0)](),l={};l[window.t("Save")]=function(e){return i.save(),!0},l[window.t("Delete")]=n?function(o){jQuery.parseJSON(n.attr("data"));s.remove(n,e,t)||i.remove(n)}:null,e.showToolDialog(this.form,n,l),this.setupButtons(),s.dialog(this.form,e,t,{},n),jQuery(document).trigger("newhtml")},save:function(){var n=this,i=Widgets[this.widgetdata.wid.toCamelCase(!0)](),o=this.collectProperties(this.form);this.widgetdata.vid=o.vid||this.widgetdata.vid,this.widgetdata.wid=o.wid||this.widgetdata.wid,this.widgetdata.properties=jQuery.extend({},i.properties,this.widgetdata.properties,o.properties),this.form.is(".singleresource")&&(this.widgetdata.resources=[this.collectResource(this.form)]);for(var r=this.widgetdata.resources.length-1;r>=0;r--)this.widgetdata.resources[r]&&this.widgetdata.resources[r]["class"]||this.widgetdata.resources.remove(r);var s=[];for(var l in t.formData)s.push(l+"="+t.formData[l]);s.push("widget[wid]="+this.widgetdata.wid),s.push("widget[vid]="+this.widgetdata.vid);for(var c in this.widgetdata.properties)if("function"!=typeof this.widgetdata.properties[c])if(Array.isArray(this.widgetdata.properties[c]))for(var r=0;r<this.widgetdata.properties[c].length;r++)s.push("widget[properties]["+c+"][]="+this.widgetdata.properties[c][r]);else s.push("widget[properties]["+c+"]="+this.widgetdata.properties[c]);for(var r=0;r<this.widgetdata.resources.length;r++){s.push("widget[resources]["+r+"][class]="+this.widgetdata.resources[r]["class"]),this.widgetdata.resources[r].reference_id&&s.push("widget[resources]["+r+"][reference_id]="+this.widgetdata.resources[r].reference_id);for(var c in this.widgetdata.resources[r].properties)if("function"!=typeof this.widgetdata.resources[r].properties[c])if(Array.isArray(this.widgetdata.resources[r].properties[c]))for(var d=0;d<this.widgetdata.resources[r].properties[c].length;d++)s.push("widget[resources]["+r+"][properties]["+c+"][]="+this.widgetdata.resources[r].properties[c][d]);else s.push("widget[resources]["+r+"][properties]["+c+"]="+this.widgetdata.resources[r].properties[c])}jQuery.post(t.validateWidgetUrl,s.join("&")).then(function(t){if(0==t.status){var i=a.render("widget-"+n.widgetdata.wid+"-content",n.widgetdata),o=jQuery(i).attr("data-widget",jQuery.toJSON(n.widgetdata));n.widget?n.widget.replaceWith(o):e.insertAtCursor(o),e.setupWidgets(),e.hideToolDialog()}}).fail(function(t){e.showToolDialogErrors(jQuery.parseJSON(t.responseText).errors)})},instantCreate:function(t,n){if(!t||!t.wid)return null;t.vid=this.widgetid();var i=a.render("widget-"+t.wid+"-content",t),o=jQuery(i).attr("data-widget",jQuery.toJSON(t));return n?o:(e.insertAtCursor(o),e.setupWidgets(),e.hideToolDialog(),void 0)},remove:function(n){var i=n.data("widget");Widgets[i.wid.toCamelCase(!0)]().remove(n,e,t)||(n.remove(),e.rescueOrphans())},checkBack:function(){var t=e.find(e.widgetmask).last(),n=t;if(n.length){for(;!e.is(n)&&n.length;){if(n.next().length||n.get(0).nextSibling)return;n=n.parent()}var i=e.find("> *").last();if(t.closest(i).length){var o=jQuery("<p/>").appendTo(e);e.extensions.dom.makeNonEmpty(o.get(0))}}},initialize:function(n){var i=this,o=n.attr("data");if(o){o=jQuery.parseJSON(o),Widgets[o.wid.toCamelCase(!0)]().create(n,e,t),n.off("dblclick").on("dblclick",function(){e.extensions.dom.unsetSelection(),i.editWidget(n)});var r=n.attr("properties");if(r&&(r=jQuery.parseJSON(r),r.resizable&&e.extensions.resizable&&e.extensions.resizable.index(n,r.resizable)),!n.is(e.widgetmaskInline)){var a=jQuery("<div/>").addClass("widget-main-buttons").appendTo(n);a.append(jQuery("<a/>").addClass("edit").on("click",function(){n.trigger("dblclick")})),a.append(jQuery("<a/>").addClass("delete").on("click",function(){e.extensions.widgets.remove(n)}))}}},index:function(t){var a=this;e.extensions.dom.getSelection();n=t;var s=jQuery("<div/>").addClass("widget-groups");s.append(jQuery("<h3/>").html(window.t("Insert Media")));for(var l={},c=0;c<i.length;c++)l[i[c].name]=i[c].label;for(var c=0;c<o.length;c++){for(var d=jQuery("<div/>"),u=!1,h=0;h<o[c].length;h++){var p=o[c][h];l[p]&&(u=!0,d.append(jQuery("<span/>").html(l[p]).on("mousedown",function(e){return function(t){return a.createWidget(e),!1}}(p))))}u&&d.appendTo(s)}setTimeout(function(){e.hideToolDialog(r)||(r=e.showToolDialog(s,t))},10)},toolbuttons:{widgets:{name:window.t("Widgets"),icon:"image.png",onclick:function(e){this.extensions.widgets.index(e)},special:!0},simplechessboard:{name:window.t("Insert Diagram"),icon:"simplechessboard.png",onclick:function(e){var t=this;t.find(".widgetcontainer.simple-chess-board").length?t.extensions.widgets.editWidget(t.find(".widgetcontainer.simple-chess-board")):t.extensions.widgets.createWidget("simple-chess-board")},special:!0},chessboard:{name:window.t("Insert Diagram"),icon:"simplechessboard.png",onclick:function(e){this.toolDialog.is(":visible")?this.hideToolDialog():this.extensions.widgets.createWidget("chess-board")}}}}},jQuery.fn.editorextensions=jQuery.fn.editorextensions||{},jQuery.fn.editorextensions.wrapper=function(e,t){return{index:function(t){return function(n){var i=e.extensions.dom.getSelection();if(i){var o=i.startContainer,r=i.endContainer,a=i.startOffset,s=i.endOffset;if(o==r&&a==s&&0==jQuery(o).closest(t).length){var l=document.createElement(t);l.innerHTML="&zwnj;";var c=l.childNodes[0];if(1==o.nodeType)0==a?o.insertBefore(l,o.childNodes[0]):o.appendChild(l);else if(3==o.nodeType){var d=document.createTextNode(o.nodeValue.substr(a));o.nodeValue=o.nodeValue.substr(0,a),o.parentNode.insertBefore(d,o.nextSibling),o.parentNode.insertBefore(l,d)}return void e.extensions.dom.setCursor(c,"after")}var u=e.extensions.dom.treeToVector(e.get(0).childNodes);if(1==o.nodeType&&(a?(o=o.childNodes[a-1],a=o.nodeValue.length):o=o.childNodes[0]),1==r.nodeType&&(r=s?r.childNodes[s-1]:r.childNodes[0],s=r.nodeValue.length),o&&r&&u.contains(o)&&u.contains(r)){for(;a<o.nodeValue.length&&" "==o.nodeValue.substr(a,1);a++);for(;s>0&&" "==r.nodeValue.substr(s-1,1);s--);F=u.indexOf(o);var h,p,f=null,g=null,m=jQuery(o).closest(t),v=jQuery(r).closest(t);if(m.length&&v.length&&m.is(v)){var y=e.extensions.dom.breakNode(m,[[o,a],[r,s]]);m.after(y[2]);var w=jQuery(y[1]).contents();1==w.length&&3==w[0].nodeType&&""==w[0].nodeValue?m.after("&zwnj;"):m.after(jQuery(y[1]).contents()),m.replaceWith(y[0]),f=e.extensions.dom.findTextNode(y[0].nextSibling,"forward"),h=0,g=e.extensions.dom.findTextNode(y[2].previousSibling,"back"),p=g.nodeValue.length}else{for(var b=!1,C=u.indexOf(o),k=u.indexOf(r),F=C;k>=F;F++){var l=u[F],x=jQuery(l);1==l.nodeType&&x.is(t)&&(x.is(v)||x.is(m)||(f||(f=e.extensions.dom.findTextNode(x.get(0))),g=e.extensions.dom.findTextNode(x.get(0),"end"),x.replaceWith(x.contents()),b=!0))}if(m.length){var y=e.extensions.dom.breakNode(m,[[o,a]]);m.after(jQuery(y[1]).contents()).after(y[0]).remove(),f=e.extensions.dom.findTextNode(y[0].nextSibling,"after"),h=0,g=null,p=void 0,b=!0}if(v.length){var y=e.extensions.dom.breakNode(v,[[r,s]]);v.before(jQuery(y[0]).contents()).after(y[1]).remove(),f?(g=e.extensions.dom.findTextNode(y[1],"back"),p=g.nodeValue.length):(f=e.extensions.dom.findTextNode(y[1],"back"),h=0,g=null,p=void 0),b=!0}if(!b){var T=e.extensions.dom.findBlockParent(o),_=e.extensions.dom.findBlockParent(r);if(o==r){var E=jQuery("<"+t+"/>").text(o.nodeValue.substr(a,s-a)).get(0),d=document.createTextNode(o.nodeValue.substr(s));o.nodeValue=o.nodeValue.substr(0,a),o.parentNode.insertBefore(E,o.nextSibling),o.parentNode.insertBefore(d,E.nextSibling),jQuery(E).find(e.widgetmask).insertBefore(E),f=E.childNodes[0],h=0,g=E.childNodes[0],p=E.innerHTML.length}else if(T==_){var S=i.commonAncestorContainer,y=e.extensions.dom.breakNode(S,[[o,a],[r,s]]),E=jQuery("<"+t+"/>").append(jQuery(y[1]).contents());jQuery(S).html("").append(jQuery(y[0]).contents()),jQuery(S).append(E),jQuery(S).append(jQuery(y[2]).contents()),f=e.extensions.dom.findTextNode(E.get(0)),g=e.extensions.dom.findTextNode(E.get(0),"end"),jQuery(E).find(e.widgetmask).insertBefore(E)}else{var y=e.extensions.dom.breakNode(T,[[o,a]]),E=jQuery("<"+t+"/>").append(jQuery(y[1]).contents());jQuery(T).html("").append(jQuery(y[0]).contents()),jQuery(T).append(E),f=e.extensions.dom.findTextNode(E.get(0)),jQuery(E).find(e.widgetmask).insertBefore(E);for(var j=e.extensions.dom.treeToVector(T.parentNode.childNodes,e.extensions.dom.isBlockElement),F=j.indexOf(T)+1;j[F]!=_&&F<j.length;F++)jQuery(j[F]).find(_).length>0||jQuery("<"+t+"/>").append(jQuery(j[F]).contents()).appendTo(jQuery(j[F]));y=e.extensions.dom.breakNode(_,[[r,s]]),E=jQuery("<"+t+"/>").append(jQuery(y[0]).contents()),jQuery(_).html("").append(jQuery(y[1]).contents()),jQuery(_).prepend(E),g=e.extensions.dom.findTextNode(E.get(0),"end"),jQuery(E).find(e.widgetmask).insertBefore(E)}}}e.find(t).each(function(){e.extensions.dom.deduplicate(this)}),f&&f.parentNode&&g&&g.parentNode?e.extensions.dom.setSelection(f,g,h,p):e.extensions.dom.setCursor(f,0)}}}},toolbuttons:{bold:{name:window.t("Bold"),icon:"bold.png",onclick:function(e){this.extensions.wrapper.index("strong")(e)},highlight:function(e){return this.extensions.highlight.check(e,"strong")},shortcut:window.t("Ctrl-B")},italic:{name:window.t("Italic"),icon:"italic.png",onclick:function(e){this.extensions.wrapper.index("i")(e)},highlight:function(e){return this.extensions.highlight.check(e,"i")},shortcut:window.t("Ctrl-I")},underline:{name:window.t("Underline"),icon:"underline.png",onclick:function(e){this.extensions.wrapper.index("u")(e)},highlight:function(e){return this.extensions.highlight.check(e,"u")},shortcut:window.t("Ctrl-U")},strike:{name:window.t("Strikethrough"),icon:"strike.png",onclick:function(e){this.extensions.wrapper.index("strike")(e)},highlight:function(e){return this.extensions.highlight.check(e,"strike")}}},provides:{options:{bold:{tags:["strong"]},italic:{tags:["i"]},underline:{tags:["u"]},strike:{tags:["strike"]}}}}},function(jQuery){var editorInstances={},tools={},dragging=null,defaultConfig={input:jQuery("null"),allowed:["p","br","span"],allowedInside:["div"],allowedAttributes:{span:["class"]},allowedCssProperties:[],attributeValueRestrictions:{},restricted:{div:function(e){return e.is(this.widgetmask)||e.is(this.widgetmaskInline)}},iconsUrl:config.assetDir()+"/images/editor/toolbar/",saveResource:"/",formData:{},extensions_url:"/js/editor/",extensions:[],toolbar:{left:["widgets","chess","source","simplechessboard","chessboard","|","character","bold","italic","underline","strike","link","emoticons","|","h1","h2","h3","|","alignleft","aligncenter","alignright","alignjustify","|","ulist","olist","|","indent","unindent","blockquote","hr"],right:["|","clear","undo","redo"]},height:600},lastid=0,init=function(e){var t=jQuery.extend(this,editor);if(t.extensions={},t.config=jQuery.extend(!0,{},defaultConfig,e),t.config.formData.csrf=config.csrf(),e.localBackup){jQuery.initNamespaceStorage("editor").localStorage}t.attr("id")||t.attr("id","editor-"+ ++lastid);for(var n=["dom","highlight","resizable"].concat(t.config.extensions),i=0;i<n.length;i++)t.load(n[i],t.config.extensions_url+"editor-"+n[i]+".js");t.attr("contenteditable",!0).attr("designmode",!1).css("min-height",parseInt(t.config.height)+"px").css("width",t.config.width?parseInt(t.config.width)+"px":""),t.find("div").attr("contenteditable",!1).attr("unselectable","on"),t.config.extraClass&&t.addClass(t.config.extraClass),t.config.watermark&&t.setWatermark(t.config.watermark),t.rescueOrphans(),t.setupWidgets(),t.createToolbar(),t.setupDialogs(),t.removeUnwanted(),t.pollChanges(),t.config.input&&0!==jQuery(t.config.input).length?t.config.input=jQuery(t.config.input):t.config.input=jQuery('<input type="hidden"/>').insertAfter(t),
t.config.input.attr("value",t.config.escape?escape(t.getHtml(!0)):t.getHtml(!0)),t.on("change",function(e,n){t.handleOnChange(e,n)}).on("paste",function(e){setTimeout(function(){t.handleOnPaste(e)},10)}).on("keydown",function(e){t.handleOnKeyDown(e)}).on("keyup",function(e){t.handleOnKeyUp(e)}).on("keypress",t.config.maxLength?function(e){t.handleOnKeyPress(e)}:null).on("click focus",function(){t.handleOnFocus()}).on("cleanup",function(){t.removeUnwanted()}).on("drop",function(){setTimeout(function(){t.removeUnwanted()})}),t.closest("form").on("submit",function(e){t.handleOnFormSubmit(e)}),t.extensions.history&&t.extensions.history.start(),t.extensions.dom.flatten(t.get(0)),t.trigger("change",!0),e.localBackup&&setTimeout(function(){t.doLocalBackup.call(t)},10);try{document.execCommand("enableObjectResizing",null,!1)}catch(o){}return this},editor={widgetmask:"div.widgetcontainer",widgetmaskInline:"a.widgetcontainer-inline"};editor.load=function(name,url){var self=this,match=name.match(/^(\w+)\((.*)?\)$/),options=null;return match&&(name=match[1],options=match[2]?match[2].split(","):[]),"function"==typeof this.editorextensions[name]?this.registerExtension(name,this.editorextensions[name](this,this.config),options):jQuery.ajax({url:url,cache:!0,dataType:"text",async:!1,success:function(code){if("function"==typeof jQuery.fn.editorextensions[name])self.registerExtension(name,jQuery.fn.editorextensions[name](self,self.config),options);else{var $editor=self,$config=self.config;eval(code),"object"==typeof extension&&self.registerExtension(name,extension,options)}},error:function(e,t){errorHandler.msg("error",t,!1,{name:name,url:url})}}),this},editor.registerExtension=function(e,t,n){if(!(!t instanceof Object)){if("function"==typeof t.init&&t.init(this,this.config),this.extensions[e]=jQuery.extend({},t),t.toolbuttons)for(var i in t.toolbuttons)(!n||n.contains(i))&&(tools[i]=t.toolbuttons[i]);if(t.provides){if(t.provides.options){if(!n||!n.length){n=[];for(var o in t.provides.options)t.provides.options.hasOwnProperty(o)&&n.push(o)}for(var r=0;r<n.length;r++){var o=t.provides.options[n[r]];o.tags&&(t.provides.tags=(t.provides.tags||[]).concat(o.tags)),o.attributes&&(t.provides.attributes=jQuery.extend(t.provides.attributes||{},o.attributes)),o.cssProperties&&(t.provides.cssProperties=(t.provides.cssProperties||[]).concat(o.cssProperties))}}if(t.provides.tags&&(this.config.allowed=this.config.allowed.concat(t.provides.tags)),t.provides.attributes)for(var i in t.provides.attributes)this.config.allowedAttributes[i]?this.config.allowedAttributes[i]=this.config.allowedAttributes[i].concat(t.provides.attributes[i]):this.config.allowedAttributes[i]=t.provides.attributes[i];if(t.provides.cssProperties&&(this.config.allowedCssProperties=this.config.allowedCssProperties.concat(t.provides.cssProperties)),t.provides.attributeValueRestrictions){var a=this.config.attributeValueRestrictions,s=t.provides.attributeValueRestrictions;for(var l in s)if(a[l])for(var c in s[l])a[l][c]&&(a[l][c]=a[l][c].concat(s[l][c])),a[l][c]=s[l][c];else a[l]=s[l]}}}},editor.insertAtCursor=function(e){var t=this.extensions.dom.getSelection();if(t&&t.startContainer&&!this.is(t.startContainer)){var n=this.extensions.dom.findTextNode(t.startContainer,t.startOffset);if(n){var i=n;if(3==i.nodeType&&(i=this.extensions.dom.findNonTextNode(i)),i){var o=jQuery(i).is(this.widgetmaskInline)?jQuery(i):jQuery(i).closest(this.widgetmaskInline);if(o.length)return void o.before(e)}}else{if(1==t.startContainer.childNodes.length&&t.startContainer.firstChild.tagName&&"br"==t.startContainer.firstChild.tagName.toLowerCase()){if(e instanceof jQuery&&e.is(this.widgetmask))return e.insertBefore(t.startContainer),this.extensions.dom.makeNonEmpty(t.startContainer),this.extensions.dom.setCursor(t.startContainer,0),void this.registerCursor();try{var r=jQuery(e);if(r.is(this.widgetmask)||r.is(this.widgetmaskInline))return r.insertBefore(t.startContainer),this.extensions.dom.makeNonEmpty(t.startContainer),this.extensions.dom.setCursor(t.startContainer,0),void this.registerCursor()}catch(a){}jQuery(t.startContainer).find("*").remove()}n=document.createTextNode(""),t.startContainer.appendChild(n)}var s=n.parentNode,l=document.createTextNode(n.nodeValue.substr(t.startOffset)),c=t.startOffset;if("string"==typeof e)try{c+=jQuery(e).text().length}catch(a){c+=e.length}else e instanceof jQuery?c+=e.text().length:("undefined"!=typeof Node&&e instanceof Node||"undefined"!=typeof e.nodeType)&&(c+=(e.innerText||e.textContent||e.nodeValue||"").length);n.nodeValue=n.nodeValue.substr(0,t.startOffset),s.insertBefore(l,n.nextSibling),jQuery(n).after(e);var d=this.extensions.dom.findTextOffset(l,s);this.extensions.dom.flatten(n.parentNode,!0),this.extensions.dom.setCursor(s,d),this.registerCursor(),delete l,delete n}else if(this.cursorLastSeenAt){if(jQuery(this.cursorLastSeenAt).is(this.widgetmask)||jQuery(this.cursorLastSeenAt).is(this.widgetmaskInline))jQuery(this.cursorLastSeenAt).before(e);else if(this.extensions.dom.isBlockElement(this.cursorLastSeenAt))jQuery(this.cursorLastSeenAt).prepend(e);else if(1==this.cursorLastSeenAt.nodeType)this.cursorLastSeenAt.after(e);else if(3==this.cursorLastSeenAt.nodeType){var n=this.cursorLastSeenAt,u=this.cursorLastSeenAtIndex,l=document.createTextNode(n.nodeValue.substr(u));n.nodeValue=n.nodeValue.substr(0,u),n.parentNode.insertBefore(l,n.nextSibling);try{jQuery(n).after(e)}catch(a){jQuery(document.createTextNode(e)).insertAfter(n)}this.registerCursor(),delete l,delete n}}else this.append(jQuery("<p/>").append(e));return delete t,this},editor.registerCursor=function(){var e=this.extensions.dom.getSelection();if(e&&e.startContainer){var t=jQuery(this.extensions.dom.findNonTextNode(e.startContainer));if(t.is(this.widgetmask)||t.closest(this.widgetmask).length>0){var n=t.is(this.widgetmask)?t:t.closest(this.widgetmask),i=this.extensions.dom.treeToVector(this.get(0).childNodes),o=i.indexOf(n.parent().get(0));if(-1==o)return;for(var r=o+1;r<i.length;r++)if(3==i[r].nodeType&&i[r].nodeValue.trim())return this.extensions.dom.setCursor(i[r],0),void this.registerCursor();for(r=o-1;r>=0;r--)if(3==i[r].nodeType&&i[r].nodeValue.trim())return this.extensions.dom.setCursor(i[r],i[r].nodeValue.length-1),void this.registerCursor()}this.cursorLastSeenAt=e.startContainer,this.cursorLastSeenAtIndex=e.startOffset}e&&delete e},editor.setFocus=function(e){if(this.preventFocus)return void(this.preventFocus=!1);if(this.extensions.dom.msie||this.focus(),this.is(document.activeElement)||e){var t=this.extensions.dom.getSelection();if(t&&t.startContainer==t.endContainer&&t.startOffset==t.endOffset&&this.cursorLastSeenAt){var n,i;1==this.cursorLastSeenAt.nodeType?(n=this.cursorLastSeenAt.childNodes[this.cursorLastSeenAtIndex],i=0):(n=this.extensions.dom.findTextNode(this.cursorLastSeenAt),i=this.cursorLastSeenAtIndex),n&&n.parentNode&&n.parentNode.parentNode&&this.extensions.dom.setCursor(n,i||0)}}},editor.doLocalBackup=function(){var e=this;if(storage.isSet(e.config.input.attr("id"))){var t=jQuery("<div/>").append(storage.get(e.config.input.attr("id"))).find(e.widgetmask+","+e.widgetmaskInline).remove().end().html().replace(/<[^>]+>/gm,"").replace(/[\s\n\t]+/g," ").trim(),n=jQuery("<div/>").append(jQuery(e.html())).find(e.widgetmask+","+e.widgetmaskInline).remove().end().html().replace(/<[^>]+>/gm,"").replace(/[\s\n\t]+/g," ").trim();t!=n&&Dialog.confirmation(window.t("An unsaved backed up version of this article is found, do you want to restore it?"),function(){e.html(storage.get(e.config.input.attr("id"))),e.removeUnwanted(),e.extensions.dom.flatten(e.get(0)),e.setupWidgets(),e.rescueOrphans(),e.trigger("afterpaste")})}},editor.createToolbar=function(e){var t=this;e=e||t.config.toolbar,jQuery.isArray(e)&&(e={left:e,right:[]});var n=function(e,n){for(var i=0;i<e.length;i++){var o=e[i];if("|"!=o){var r=tools[o];if(r){var a=r.getCustomContent?r.getCustomContent(t.config.iconsUrl):jQuery('<img src="'+t.config.iconsUrl+r.icon+'"/>'),s=r.name+(r.shortcut?" ("+r.shortcut+")":""),l="toolbar-"+o+(r.special?" special":"")+(r.customClasses?" "+r.customClasses:""),c=jQuery("<span/>").addClass(l).empty().append(a).attr("title",s);r.onclick&&c.on("click",function(e){return function(){jQuery(this).hasClass("disabled")||(t.setFocus(),e.call(t,jQuery(this)))}}(r.onclick)),n.append(c)}}else{var d=n.find("> :last");if(d.is(".separator")||0===d.length)continue;n.append(jQuery("<span>").html('<img src="'+config.assetDir()+'/images/editor/toolbar/separator.png"/>').addClass("separator"))}}},i=jQuery("<div/>").addClass("editor-toolbar"+(t.config.extraClass?" "+t.config.extraClass:"")).insertBefore(this).append(jQuery('<div class="banner"/>').html(t.config.banner||""));if(!this.config.hideToolbar){var o=jQuery("<div/>").addClass("editor-toolbar-right").appendTo(i);n(e.right,o);var r=jQuery("<div/>").addClass("editor-toolbar-left").appendTo(i);n(e.left,r)}var a=jQuery("<div/>").addClass("info").appendTo(i);if(a.append(jQuery("<div/>").addClass("info-right").html(window.t("autosaved at")+" <span>17:34</span>")),a.append(jQuery("<div/>").addClass("info-left").html(window.t("created on")+" <span>05.05.2013</span>")),a.append(jQuery("<div/>").addClass("info-center").html(window.t("modified on")+" <span>05.05.2013</span>")),!this.config.scrollToolbar)return void i.css("width","auto");var s=i.clone(!0),l=function(){var e=t;if(!e.is(":visible")&&t.extensions.source){var n=t.extensions.source.getContainer();n&&n.is(":visible")&&(e=n)}return e.outerWidth()-parseInt(i.css("padding-left"))-parseInt(i.css("padding-right"))-parseInt(i.css("border-left-width"))-parseInt(i.css("border-right-width"))};return i.css("width","auto"),jQuery(window).on("scroll resize",function(){if(i.is(":visible")){var e=t;t.extensions.source&&(e=t.extensions.source.getContainer(!0)||e);var n=jQuery(":visible").filter(function(){return"fixed"==jQuery(this).css("position")&&0==parseInt(jQuery(this).css("top"))}).outerHeight()||0;n=Math.max(0,n-5-parseInt(i.css("margin-top")));var o=l(),r=e.offset().top-i.outerHeight()+(s.parent().length&&i.find(".editor-dialog").is(":visible")?i.find(".editor-dialog").outerHeight():0);if(i.css("width",o+"px"),r<jQuery(document).scrollTop()+n){var a=e.offset().left-parseInt(i.css("margin-left"));"fixed"!=i.css("position")?(s.insertBefore(i),i.addClass("detached").css({left:a+"px",top:n+"px"})):i.css("left",a+"px")}else s.detach(),i.removeClass("detached").css({left:"auto",top:"auto"})}}),this},editor.toggleToolbarButtons=function(e,t,n){var i=jQuery("null"),o=this.prev(".editor-toolbar");if(t)for(var r=0;r<t.length;r++)i=i.add(o.find(".toolbar-"+t[r]));if(n){t||(i=o.find("span"));for(var r=0;r<n.length;r++)i=i.not(".toolbar-"+n[r])}i[e?"removeClass":"addClass"]("disabled")},editor.setupDialogs=function(){var e=this,t=this.prev(".editor-toolbar");return this.toolDialog=jQuery('<div class="editor-dialog" />').hide().append('<div class="decoration"/>').insertBefore(t.find(".info")),this.toolDialog.append(jQuery("<a/>").addClass("collapse").on("click",function(){e.hideToolDialog()})),this.toolDialogErrors=jQuery('<div class="editor-dialog-errors"/>').appendTo(this.toolDialog).hide(),this.toolDialogContent=jQuery('<div class="editor-dialog-content"/>').appendTo(this.toolDialog),this.toolDialogButtons=jQuery('<div class="editor-dialog-buttons"/>').appendTo(this.toolDialog),jQuery(document).trigger("newhtml"),this},editor.setupWidgets=function(e){var t=this;e||(e=t.find(t.widgetmask).add(t.find(t.widgetmaskInline)));var n=function(e){t.setupDragging();try{e.originalEvent.dataTransfer.setData("text/html",'<span class="editor-movement"/>'),e.originalEvent.dataTransfer.dropEffect="copy",e.originalEvent.dataTransfer.effectAllowed="copy"}catch(e){e.returnValue=!1,e.cancelBubble=!0}dragging=jQuery(this)};return setTimeout(function(){var i=[];if(t.config.widgets)for(var o=0;o<t.config.widgets.length;o++)i.push(t.config.widgets[o].name);if(t.config.inlineWidgets)for(var o=0;o<t.config.inlineWidgets.length;o++)i.push(t.config.inlineWidgets[o].name);var r=function(){var e=jQuery(this),o=jQuery(this).is(t.widgetmaskInline),r=e.attr("data");if(r){if(r=jQuery.parseJSON(r),!i.contains(r.wid))return void jQuery(this).remove();o||(e.attr("draggable","true").attr("contenteditable","false").addClass("not-selectable"),e.find("*").attr("draggable",!1),t.extensions.dom.msie?e.off("mousedown").on("mousedown",n):e.off("dragstart").on("dragstart",n),e.css("overflow","visible")),t.extensions.widgets&&t.extensions.widgets.initialize(e)}},a=[];e.each(function(){var e=jQuery(this),n=e.data("widget");if(a.contains(n.vid)){n.vid=t.extensions.widgets.widgetid(),e.attr("data-widget",jQuery.toJSON(n));var i=jQuery.parseJSON(e.attr("data"));i.vid=n.vid,e.attr("data",jQuery.toJSON(i))}a.push(n.vid)}),e.filter(t.widgetmask).attr("contenteditable",!1).attr("unselectable","on").each(r),e.filter(t.widgetmaskInline).each(r)},1),this},editor.backupWidgets=function(e){var t=this;return this.widgetsCache={},this.find(this.widgetmask+", "+this.widgetmaskInline).each(function(){var n=jQuery(this),i=jQuery.parseJSON(n.attr("data")).vid;t.widgetsCache[i]=n.get(0).outerHTML,e&&n.replaceWith('<widget data="'+(n.attr("data-widget").replace(/"/g,"&quot;")||"")+'">'+i+"</widget>")}),this},editor.restoreWidgets=function(){if(!this.widgetsCache)return this;var e=this;return this.find("widget").each(function(){var t,n=jQuery(this);if("<widget"!=this.outerHTML.toLowerCase().substr(0,7)||this.innerHTML)var t=n.text();else{var t=this.nextSibling.nodeValue;this.parentNode.removeChild(this.nextSibling),this.parentNode.removeChild(this.nextSibling)}if(e.widgetsCache[t])n.replaceWith(e.widgetsCache[t]);else if(e.extensions.widgets){var i=n.attr("data");if(i)try{i=jQuery.parseJSON(i);var o=e.extensions.widgets.instantCreate(i,!0);o?n.replaceWith(o):n.remove()}catch(r){n.remove()}}}),this.setupWidgets(),this},editor.isWidgetAllowed=function(e){var t=[];if(this.config.widgets)for(var n=0;n<this.config.widgets.length;n++)t.push(this.config.widgets[n].name);if(this.config.inlineWidgets)for(var n=0;n<this.config.inlineWidgets.length;n++)t.push(this.config.inlineWidgets[n].name);return t.contains(e)},editor.setupDragging=function(){var e=this,t=function(t){if(dragging&&!e.extensions.dom.msie){if(t.preventDefault(),document.caretRangeFromPoint)var n=document.caretRangeFromPoint(t.originalEvent.clientX,t.originalEvent.clientY);else t.originalEvent.rangeParent&&(n=document.createRange(),n.setStart(t.originalEvent.rangeParent,t.originalEvent.rangeOffset));var i=n.offsetNode||n.startContainer,o=n.offset||n.startOffset;if(3==i.nodeType){var r=i.splitText(o);i.parentNode.insertBefore(dragging.get(0),r)}else jQuery(i).before(dragging);return void(dragging=void 0)}if(dragging){e.off("mousemove").off("dragend").off("mouseup").off("selectstart");var a=e.find(".editor-movement:first");if(a.length>0)if(a.parent().is(e))e.insertAtCursor(dragging);else{var s=a.closest(e.widgetmask).add(a.closest(e.widgetmaskInline));s.length&&a.insertAfter(s);var l=e.extensions.dom.findBlockParent(a.get(0)),c=e.extensions.dom.closestChildOf(a.get(0),l);c!=a.get(0)&&a.insertBefore(c);var d=jQuery(l).clone().find(".editor-movement").remove().end();e.extensions.dom.isEmpty(d.get(0))?jQuery(l).html("").append(dragging):a.replaceWith(dragging),e.extensions.dom.flatten(l),d.remove(),delete d}else{var u;if(t.originalEvent.clientX||t.originalEvent.clientY){var u=document.elementFromPoint(t.originalEvent.clientX,t.originalEvent.clientY);if(u&&!jQuery(u).is(e)&&0==e.find(u).length)return e.find(".editor-movement").remove(),void(dragging=null)}if(u){var h=jQuery(u);if(h.is(e.widgetmaskInline)){for(var p="",f=u.className.split(" "),g=0;g<f.length;g++)if("vid-"==f[g].substr(0,4)){p=f[g];break}p&&jQuery("."+p).not(":first").each(function(){h.append(jQuery(this).contents())}).remove(),h.after(dragging)}else h.is(e.widgetmask)||h.closest(e.widgetmask).length||(e.extensions.dom.isEmpty(u)?h.html("").append(dragging):e.insertAtCursor(dragging))}else{e.insertAtCursor(dragging);var l=e.extensions.dom.findBlockParent(dragging.get(0).parentNode),c=e.extensions.dom.closestChildOf(dragging.get(0),l);c!=dragging.get(0)&&dragging.insertBefore(c)}}dragging.trigger("chess24:dragend")}e.find(".editor-movement").each(function(){jQuery(this).replaceWith(jQuery(this).contents())}),dragging=null,e.rescueOrphans()},n=function(t){e.extensions.dom.msie&&e.extensions.dom.setSelectionXY(t.clientX,t.clientY)};return this.extensions.dom.msie?(this.off("mousemove").on("mousemove",n),this.off("mouseup").on("mouseup",t),this.off("selectstart").on("selectstart",function(e){return e.originalEvent.returnValue=!1,!1})):this.off("dragover").on("dragover",function(e){e.stopPropagation()}).off("drop").on("drop",t),this},editor.pollChanges=function(e){var t=this,n=this.getHtml(!0);"undefined"!=typeof MutationObserver?new MutationObserver(function(){var e=t.getHtml(!0);e!=n&&(n=e,t.pcto&&clearTimeout(t.pcto),t.pcto=setTimeout(function(){t.trigger("change")},100))}).observe(t.get(0),{childList:!0,attributes:!0,characterData:!0,subtree:!0,attributeOldValue:!0,characterDataOldValue:!0}):"undefined"!=typeof MutationEvent?this.on("DOMSubtreeModified DOMAttrModified",function(){t.pcto&&clearTimeout(t.pcto),t.pcto=setTimeout(function(){var e=t.getHtml(!0);e!=n&&(n=e,t.trigger("change"))},10)}):("undefined"!=typeof e&&n!=e&&this.trigger("change"),setTimeout(function(){t.pollChanges(n)},100))},editor.scrollToolDialog=function(e){var t=e.offset().top-this.toolDialogContent.offset().top-20;this.toolDialogContent.animate({scrollTop:t},200)},editor.toggleToolDialogButtons=function(e){return this.toolDialogButtons[e?"show":"hide"](),this},editor.showToolDialogErrors=function(e){var t=jQuery("<ul/>");for(var n in e)for(var i=0;i<e[n].length;i++)t.append(jQuery("<li/>").html(e[n][i]));return this.toolDialogErrors.html("").append(t).show(),this.toolDialog.bubble("adjust"),this},editor.hideToolDialogErrors=function(){return this.toolDialogErrors.hide(),this.toolDialog.bubble("adjust"),this},editor.serializeToolDialog=function(e){var t={},n=this.toolDialogContent;return n.length||(n=this.toolDialogContent),n.find("input, select, textarea").each(function(){var n=jQuery(this);("function"!=typeof e||e(n))&&this.name&&("checkbox"!=n.attr("type")&&'"radio'!=n.attr("type")||n.get(0).checked)&&("[]"==this.name.substr(this.name.length-2)?t[this.name]?t[this.name].push(this.value):t[this.name]=[this.value]:t[this.name]=this.value)}),t},editor.showToolDialog=function(e,t,n,i){var o=this;if(o.toolDialogContent.html("").append(e),o.toolDialogButtons.show().find("*").remove().end().removeClass("overflow"),o.toolDialogErrors.hide().find("*").remove(),n){this.toolDialogButtons.show();var r=0;for(var a in n)"function"==typeof n[a]&&jQuery("<a/>").addClass("cBtn cBtnGrey button-"+ ++r).attr("data-cancel",a==window.t("Cancel")?1:0).html(a).appendTo(this.toolDialogButtons).one("click",function(e){return function(){n[e](o.serializeToolDialog(i))||o.hideToolDialog()}}(a))}else this.toolDialogButtons.hide();var s=o.toolDialog.css("height","auto").height();return o.toolDialog.css("height","0px").show().stop().animate({height:s+"px"},200,function(){o.toolDialog.css("height","auto"),layout(o.toolDialog)}),o.toolDialog.on("keypress keyup",function(e){if(13==e.which){var t=jQuery(e.target);t.is("textarea")||t.is("[contenteditable]")||e.preventDefault()}}),this.dialogCounter=this.dialogCounter?this.dialogCounter+1:1,this.dialogCounter},editor.hideToolDialog=function(e){var t=this;if("undefined"!=typeof e){if(t.dialogCounter!=e)return!1;if("none"==t.toolDialog.css("display"))return t.dialogCounter=void 0,!1}return t.toolDialogButtons.find("a[data-cancel=1]")&&t.toolDialogButtons.find("a[data-cancel=1]").trigger("click"),t.dialogCounter=void 0,t.toolDialog.stop().animate({height:"0px"},200,function(){t.toolDialog.hide().css("height","auto")}),!0},editor.rescueOrphans=function(){var e="p,h1,h2,h3,ul,ol,hr";if(0==this.find(e).length){var t=jQuery("<p/>").append(this.contents()).appendTo(this);return this.extensions.dom.makeNonEmpty(t.get(0)),delete t,this}for(var n=this.get(0).childNodes,i=0;i<n.length;i++)jQuery(n[i]).is(this.widgetmask)||(!n[i]||3!=n[i].nodeType&&this.extensions.dom.isBlockElement(n[i])?this.extensions.dom.isBlockElement(n[i])&&""==n[i].innerHTML&&"hr"!=n[i].tagName.toLowerCase()&&(jQuery(n[i]).next().is(this.widgetmask)?jQuery(n[i]).append(jQuery(n[i]).next()):(n[i].parentNode.removeChild(n[i]),i--)):(n[i].nodeValue||n[i].innerText||n[i].textContent).length?1==n[i].nodeType?jQuery(n[i]).prev().is(e)?(jQuery(n[i]).appendTo(jQuery(n[i]).prev()),i--):jQuery(n[i]).wrap(jQuery("<p/>")):n[i].previousSibling&&jQuery(n[i].previousSibling).is(e)?(jQuery(n[i].previousSibling).append(n[i]),i--):(this.get(0).insertBefore(jQuery("<p/>").text(n[i].nodeValue).get(0),n[i]),this.get(0).removeChild(n[i+1])):(n[i].parentNode.removeChild(n[i]),i--));if(0==this.get(0).childNodes.length){var t=jQuery("<p/>").appendTo(this);this.extensions.dom.makeNonEmpty(t.get(0)),delete t}return this},editor.removeUnwanted=function(e){var t,n,i,o=jQuery(e),r={b:"strong",em:"i",s:"strike"};for(n in r)this.find(n).each(function(e){return function(){jQuery(this).after(jQuery("<"+r[e]+"/>").append(jQuery(this).contents())).remove()}}(n));var a=this.config.allowed.concat(this.config.allowedInside),s=[];if(e)if(1==e.nodeType){var l=e.tagName.toLowerCase();if(a.contains(l)){if(this.config.attributeValueRestrictions[l]){var c=this.config.attributeValueRestrictions[l];Object.every(c,function(t,n){return t.indexOf(e.getAttribute(n))>=0})||(s=Array.convert(e.childNodes),o.replaceWith(o.contents()))}if(this.config.restricted[l])if("function"==typeof this.config.restricted[l])this.config.restricted[l].call(this,o)||(s=s.concat(Array.convert(e.childNodes)),o.replaceWith(o.contents()));else{var d=this.config.restricted[l];for(t=0;t<d.length;t++){var u=!0;for(n in d[t])if(e.getAttribute(n)!=d[t][n]){u=!1;break}if(u)break}if(u)return;s=s.concat(Array.convert(e.childNodes)),o.replaceWith(o.contents())}else{var h=[];if(this.config.allowedAttributes[l]&&this.config.allowedAttributes[l].contains("style"))for(i=e.style.length,t=0;i>t;t++)this.config.allowedCssProperties.contains(e.style[t])||h.push(e.style[t]);for(i=h.length,t=0;i>t;t++)try{e.style.removeProperty(h[t])}catch(p){e.style[e.style[t]]=""}for(h=[],i=e.attributes.length,t=0;i>t;t++)this.config.allowedAttributes[l]&&this.config.allowedAttributes[l].contains(e.attributes[t].nodeName)||h.push(e.attributes[t].nodeName);if(e.className){var f=e.className.split(" ");for(i=f.length,t=0;i>t;t++)"mso"==f[t].substr(0,3).toLowerCase()&&o.removeClass(f[t]);""==e.className&&h.push("class")}for(""===o.attr("style")&&h.push("style"),i=h.length,t=0;i>t;t++)e.removeAttribute(h[t]);s=s.concat(Array.convert(e.childNodes))}}else"span"==l||"a"==l?(s=Array.convert(e.childNodes),o.replaceWith(o.contents())):(s=[],o.remove())}else 3==e.nodeType&&-1<e.nodeValue.indexOf("&nbsp;")&&(e.nodeValue=e.nodeValue.replace(/\&nbsp\;/g," "));else e=this.get(0),s=Array.convert(e.childNodes);for(i=s.length,t=0;i>t;t++)this.removeUnwanted(s[t])},editor.checkLength=function(){if(this.config.maxLength){var e=this.text().trim().length-this.config.maxLength;if(e>0){for(var t=this.extensions.dom.treeToVector(this.get(0).childNodes,function(e){return 3==e.nodeType}),n=t[t.length-1],i=t.length,o=i-1;o>=0;o--){var r=t[o].nodeValue.length;if(!(e>=r)){t[o].nodeValue=t[o].nodeValue.substr(0,r-e),n=t[o];break}if(e-=r,t[o].parentNode.removeChild(t[o]),n=o>0?t[o-1]:null,0==e)break}this.extensions.dom.setCursor(n,"after")}}},editor.quickClean=function(){var e=this;this.find("span").each(function(){var t=jQuery(this);if(!t.closest(e.widgetmask).length&&!t.attr("class")){var n=e.extensions.dom.getSelection();if(n&&n.startContainer&&t.find(n.startContainer).length){var i=!0;startContainer=this.childNodes[this.childNodes.length-1],startOffset=startContainer.nodeValue.length}for(;this.childNodes.length>0;)this.parentNode.insertBefore(this.childNodes[0],this);t.remove(),i&&e.extensions.dom.setCursor(startContainer,startOffset)}}),this.find("p").each(function(){for(var e=jQuery(this),t=Array.convert(this.childNodes),n=!1,i=e,o=t.length,r=0;o>r;r++){var a=jQuery(t[r]);a.is("p,h1,h2,h3,blockquote")?(i=a.insertAfter(i),n=!0):n&&(i=jQuery("<p/>").append(t[r]).insertAfter(i))}});var t=jQuery("nothing");this.find("p").each(function(){0==this.childNodes.length?t=t.add(this):1!=this.childNodes.length||3!=this.childNodes[0].nodeType||this.childNodes[0].nodeValue.trim()||(t=t.add(this))}),t.remove(),this.extensions.widgets&&this.extensions.widgets.checkBack()},editor.highlightToolbar=function(){return this},editor.setWatermark=function(e){jQuery.domCss("#"+this.attr("id")+'.watermark:before { content: "'+e+'" !important; }'),this.toggleWatermark()},editor.toggleWatermark=function(){if(this.config.watermark){var e=this.get(0).innerHTML,t=""===e||"<p><br></p>"===e||"<p></p>"===e;this[t?"addClass":"removeClass"]("watermark")}},editor.keypress=function(e,t,n,i){var o={del:46,entf:46,tab:9,back:8,enter:13},r=function(e){var t={ctrl:!1,shift:!1,alt:!1,code1:0,code2:0},n=e.match(/^((.*)\s*[-\+]\s*)?(.*)$/);if(n){var i=n[2]?n[2].toLowerCase().replace("+","-").replace(" ","").split("-"):[];t.ctrl=i.contains("ctrl")||i.contains("strg"),t.shift=i.contains("shift"),t.alt=i.contains("alt"),t.code1=n[3]?o[n[3].toLowerCase()]?o[n[3].toLowerCase()]:n[3].toLowerCase().charCodeAt(0):0,t.code2=n[3]?o[n[3].toLowerCase()]?o[n[3].toLowerCase()]:n[3].toUpperCase().charCodeAt(0):0}return t},a=[];jQuery.isArray(this.config.toolbar)&&(a=a.concat(this.config.toolbar)),jQuery.isArray(this.config.toolbar.left)&&(a=a.concat(this.config.toolbar.left)),jQuery.isArray(this.config.toolbar.right)&&(a=a.concat(this.config.toolbar.right));for(var s=0;s<a.length;s++)if(tools[a[s]]&&tools[a[s]].shortcut){var l=r(tools[a[s]].shortcut);if(l.ctrl==!!t&&l.shift==!!n&&l.alt==!!i&&(l.code1==e||l.code2==e))return tools[a[s]].onclick.call(this,this),!0}for(var c in this.extensions){var d=this.extensions[c];if(d&&"function"==typeof d.keypress&&d.keypress(e,t,n,i))return!0}var u=this;return setTimeout(function(){var e=u.extensions.dom.getSelectionXY().y;if(e>0){e+=jQuery(document).scrollTop();var t=u.prev(".editor-toolbar:first"),n=t.offset().top+t.outerHeight(),i=n-e;i>0&&jQuery(document).scrollTop(jQuery(document).scrollTop()-i)}},100),!1},editor.getHtml=function(e){var t=this;return!e&&t._renderedHtml?t._renderedHtml:(this.find("span.editor-movement").remove(),this._renderedHtml=t.clone().find(t.widgetmask+", "+t.widgetmaskInline).each(function(){var e=jQuery(this),t=jQuery.parseJSON(e.attr("data"));e.replaceWith('<widget data="'+(e.attr("data-widget").replace(/"/g,"&quot;")||"")+'">'+t.vid+"</widget>")}).end().html())},editor.getText=function(e){var t="";this.find("span.editor-movement").remove();var n=this,i=function(e,t){var o=jQuery(e);if(o.length>0){if(o.is(n.widgetmask)||o.is(n.widgetmaskInline))return"";for(var r=e.childNodes.length,a="",s=0;r>s;s++){var l=e.childNodes[s];switch(l.nodeType){case 1:switch(l.tagName){case"IMG":var c=jQuery(l).attr("key");c&&(a+=":"+jQuery(l).attr("key")+":");break;case"BR":n.config.removeLineBreaks||(a+="\n");break;default:a+=i(l)}break;case 3:a+=l.nodeValue;break;default:a+=i(l)}}return a}};return t=i(n.get(0),!0),t=t.replace(/<(\w+)><\/(\w+)>/g,function(e,t,n){return t==n?"<"+t+"/>":e})},editor.handleOnChange=function(e,t){var n=this;n.quickClean(),n.toggleWatermark();var i=n.getHtml(!0);if(""==i.trim()||"<br>"==i.trim().replace(/[ \/]/g,"")){var o=jQuery("<p/>");n.append(o),n.extensions.dom.makeNonEmpty(o.get(0)),t||n.setFocus(),i=n.html()}n.config.input.attr("value",n.config.escape?escape(i):i),n.highlightToolbar(),n.registerCursor(),n.find("image,blockquote,div").on("resizestart",function(e){e.originalEvent.returnValue=!1}),n.extensions.dom.msie&&n.find("blockquote").off("mousedown").on("mousedown",function(e){if(!jQuery(this).closest(n.widgetmask).length){var t=n.extensions.dom.getSelection();if(t&&t.startContainer){var i=n.extensions.dom.findNonTextNode(t.startContainer,"before");if(jQuery(this).find(i).length||jQuery(this).is(i))return}n.extensions.dom.setSelectionXY(e.clientX,e.clientY)}}).css("outline","0")},editor.handleOnPaste=function(){var e=this;if(e.config.removeLineBreaks){e.find("br").remove();var t=e.find("p:first");t.length||(t=jQuery("<p/>").prependTo(e));var n=e.find("p").not(t);t.append(n.contents()),n.remove()}e.checkLength(),e.toggleWatermark();for(var i=e.extensions.dom.getSelection(),o=e.extensions.dom.treeToVector(e.get(0).childNodes,function(e){return 1!=e.nodeType&&3!=e.nodeType}),r=0;r<o.length;r++)o[r].parentNode&&o[r].parentNode.removeChild(o[r]);var a=e.extensions.dom.treeToVector(e.get(0).childNodes,function(e){return 3==e.nodeType}),s=null,l=null;if(a.length)if(e.is(i.endContainer))l=a[a.length-1];else if(a.length)if(3==i.endContainer.nodeType)s=0==i.endOffset?i.endContainer:a[a.indexOf(i.endContainer)+1],s||(l=i.startContainer);else for(var c=i.endContainer;;){if(e.is(c)){l=a[a.length-1];break}if(3==c.nodeType){s=c;break}if(c.nextSibling)for(c=c.nextSibling;c.childNodes[0];)c=c.childNodes[0];else c=c.parentNode}e.removeUnwanted(),e.extensions.dom.flatten(e.get(0)),e.setupWidgets(),e.rescueOrphans(),e.trigger("afterpaste"),l?e.extensions.dom.setCursor(l,"after"):s?e.extensions.dom.setCursor(s,"before"):e.extensions.dom.setCursor(e.get(0),"after"),e.registerCursor()},editor.handleOnKeyDown=function(e){var t=this;if(t.keypress(e.which||e.keyCode,e.ctrlKey,e.shiftKey,e.altKey))try{e.originalEvent.preventDefault(),e.originalEvent.stopPropagation(),t.registerCursor()}catch(n){e.originalEvent.cancelBubble=!0,e.originalEvent.returnValue=!1}},editor.handleOnKeyUp=function(e){var t=this;t.registerCursor(),t.highlightToolbar()},editor.handleOnKeyPress=function(e){var t=this,n=String.fromCharCode(e.charCode);return e.charCode&&n&&n.length>0&&(t.text().trim()+n).length>t.config.maxLength?(e.preventDefault(),e.returnValue=!1,!1):void 0},editor.handleOnFocus=function(){var e=this;e.highlightToolbar(),e.registerCursor()},editor.handleOnFormSubmit=function(){var e=this;if(e.extensions.source&&e.extensions.source.leave(!1),e.removeUnwanted(),e.trigger("change",!0),e.config.localBackup){for(var t=storage.keys(),n=0;n<t.length-19;n++)storage.remove(t[n]);storage.set(e.config.input.attr("id"),e.html())}return""==e.config.input.val()?confirm("An error occurred, most likely no content will be saved. Are you sure you want to save it?"):void 0};var publ={html:function(e){var t=jQuery(this).attr("id"),n=editorInstances[t];return n.trigger("cleanup"),n.getHtml()},text:function(e){var t=jQuery(this).attr("id"),n=editorInstances[t];return n.trigger("cleanup"),n.getText()},insert:function(e){var t=jQuery(this).attr("id"),n=editorInstances[t];n.insertAtCursor(e)},reset:function(){var e=jQuery(this).attr("id"),t=editorInstances[e];this.empty();var n=jQuery("<p/>").get(0);t.extensions.dom.makeNonEmpty(n),t.append(n),t.extensions.dom.setCursor(n)},setValue:function(e,t){var n=jQuery(this).attr("id"),i=editorInstances[n];i.preventFocus=!!t,i.html(e)},isEmpty:function(){var e=this.get(0).innerHTML;return""===e||"<p><br></p>"===e||"<p></p>"===e},configuration:function(){var e=jQuery(this).attr("id"),t=editorInstances[e];return jQuery.extend(!0,{},t.config)},debug:function(){var e=jQuery.extend(this,editor);return e[arguments[0]](Array.convert(arguments).slice(1))}};jQuery.fn.editor=function(){if("string"==typeof arguments[0]&&"function"==typeof publ[arguments[0]]){var e=jQuery.extend(this,publ);return e[arguments[0]].apply(e,[].slice.call(arguments,1))}var t=arguments[0]||{};return"undefined"==typeof window.editors&&(window.editors=[]),this.each(function(){if(!jQuery(this).data("editor-initialized")){var e=init.call(jQuery(this),t),n=e.attr("id");editorInstances[n]=e,window.editors.push(e),jQuery(this).data("editor-initialized",!0)}})}}(jQuery),Emoticons={},
function(){function e(){return a=[{key:"dog",title:"dog face",category:"nature",css:"emoji_dog"},{key:"wolf",title:"wolf face",category:"nature",css:"emoji_wolf"},{key:"cat",title:"cat face",category:"nature",css:"emoji_cat"},{key:"mouse",title:"mouse face",category:"nature",css:"emoji_mouse"},{key:"hamster",title:"hamster face",category:"nature",css:"emoji_hamster"},{key:"rabbit",title:"rabbit face",category:"nature",css:"emoji_rabbit"},{key:"frog",title:"frog face",category:"nature",css:"emoji_frog"},{key:"tiger",title:"tiger face",category:"nature",css:"emoji_tiger"},{key:"koala",title:"koala",category:"nature",css:"emoji_koala"},{key:"bear",title:"bear face",category:"nature",css:"emoji_bear"},{key:"pig",title:"pig face",category:"nature",css:"emoji_pig"},{key:"pig_nose",title:"pig nose",category:"nature",css:"emoji_pig_nose"},{key:"cow",title:"cow face",category:"nature",css:"emoji_cow"},{key:"boar",title:"boar",category:"nature",css:"emoji_boar"},{key:"monkey_face",title:"monkey face",category:"nature",css:"emoji_monkey_face"},{key:"monkey",title:"monkey",category:"nature",css:"emoji_monkey"},{key:"horse",title:"horse face",category:"nature",css:"emoji_horse"},{key:"sheep",title:"sheep",category:"nature",css:"emoji_sheep"},{key:"elephant",title:"elephant",category:"nature",css:"emoji_elephant"},{key:"panda_face",title:"panda face",category:"nature",css:"emoji_panda_face"},{key:"penguin",title:"penguin",category:"nature",css:"emoji_penguin"},{key:"bird",title:"bird",category:"nature",css:"emoji_bird"},{key:"baby_chick",title:"baby chick",category:"nature",css:"emoji_baby_chick"},{key:"hatched_chick",title:"front-facing baby chick",category:"nature",css:"emoji_hatched_chick"},{key:"hatching_chick",title:"hatching chick",category:"nature",css:"emoji_hatching_chick"},{key:"chicken",title:"chicken",category:"nature",css:"emoji_chicken"},{key:"snake",title:"snake",category:"nature",css:"emoji_snake"},{key:"turtle",title:"turtle",category:"nature",css:"emoji_turtle"},{key:"bug",title:"bug",category:"nature",css:"emoji_bug"},{key:"bee",title:"honeybee",category:"nature",css:"emoji_bee"},{key:"ant",title:"ant",category:"nature",css:"emoji_ant"},{key:"beetle",title:"lady beetle",category:"nature",css:"emoji_beetle"},{key:"snail",title:"snail",category:"nature",css:"emoji_snail"},{key:"octopus",title:"octopus",category:"nature",css:"emoji_octopus"},{key:"shell",title:"spiral shell",category:"nature",css:"emoji_shell"},{key:"tropical_fish",title:"tropical fish",category:"nature",css:"emoji_tropical_fish"},{key:"fish",title:"fish",category:"nature",css:"emoji_fish"},{key:"dolphin",title:"dolphin",category:"nature",css:"emoji_dolphin"},{key:"whale",title:"spouting whale",category:"nature",css:"emoji_whale"},{key:"whale2",title:"whale",category:"nature",css:"emoji_whale2"},{key:"cow2",title:"cow",category:"nature",css:"emoji_cow2"},{key:"ram",title:"ram",category:"nature",css:"emoji_ram"},{key:"rat",title:"rat",category:"nature",css:"emoji_rat"},{key:"water_buffalo",title:"water buffalo",category:"nature",css:"emoji_water_buffalo"},{key:"tiger2",title:"tiger",category:"nature",css:"emoji_tiger2"},{key:"rabbit2",title:"rabbit",category:"nature",css:"emoji_rabbit2"},{key:"dragon",title:"dragon",category:"nature",css:"emoji_dragon"},{key:"racehorse",title:"horse",category:"nature",css:"emoji_racehorse"},{key:"goat",title:"goat",category:"nature",css:"emoji_goat"},{key:"rooster",title:"rooster",category:"nature",css:"emoji_rooster"},{key:"dog2",title:"dog",category:"nature",css:"emoji_dog2"},{key:"pig2",title:"pig",category:"nature",css:"emoji_pig2"},{key:"mouse2",title:"mouse",category:"nature",css:"emoji_mouse2"},{key:"ox",title:"ox",category:"nature",css:"emoji_ox"},{key:"dragon_face",title:"dragon face",category:"nature",css:"emoji_dragon_face"},{key:"blowfish",title:"blowfish",category:"nature",css:"emoji_blowfish"},{key:"crocodile",title:"crocodile",category:"nature",css:"emoji_crocodile"},{key:"camel",title:"bactrian camel",category:"nature",css:"emoji_camel"},{key:"dromedary_camel",title:"dromedary camel",category:"nature",css:"emoji_dromedary_camel"},{key:"leopard",title:"leopard",category:"nature",css:"emoji_leopard"},{key:"cat2",title:"cat",category:"nature",css:"emoji_cat2"},{key:"poodle",title:"poodle",category:"nature",css:"emoji_poodle"},{key:"feet",title:"paw prints",category:"nature",css:"emoji_feet"},{key:"bouquet",title:"bouquet",category:"nature",css:"emoji_bouquet"},{key:"cherry_blossom",title:"cherry blossom",category:"nature",css:"emoji_cherry_blossom"},{key:"tulip",title:"tulip",category:"nature",css:"emoji_tulip"},{key:"four_leaf_clover",title:"four leaf clover",category:"nature",css:"emoji_four_leaf_clover"},{key:"rose",title:"rose",category:"nature",css:"emoji_rose"},{key:"sunflower",title:"sunflower",category:"nature",css:"emoji_sunflower"},{key:"hibiscus",title:"hibiscus",category:"nature",css:"emoji_hibiscus"},{key:"maple_leaf",title:"maple leaf",category:"nature",css:"emoji_maple_leaf"},{key:"leaves",title:"leaf fluttering in wind",category:"nature",css:"emoji_leaves"},{key:"fallen_leaf",title:"fallen leaf",category:"nature",css:"emoji_fallen_leaf"},{key:"herb",title:"herb",category:"nature",css:"emoji_herb"},{key:"ear_of_rice",title:"ear of rice",category:"nature",css:"emoji_ear_of_rice"},{key:"mushroom",title:"mushroom",category:"nature",css:"emoji_mushroom"},{key:"cactus",title:"cactus",category:"nature",css:"emoji_cactus"},{key:"palm_tree",title:"palm tree",category:"nature",css:"emoji_palm_tree"},{key:"evergreen_tree",title:"evergreen tree",category:"nature",css:"emoji_evergreen_tree"},{key:"deciduous_tree",title:"deciduous tree",category:"nature",css:"emoji_deciduous_tree"},{key:"chestnut",title:"chestnut",category:"nature",css:"emoji_chestnut"},{key:"seedling",title:"seedling",category:"nature",css:"emoji_seedling"},{key:"blossom",title:"blossom",category:"nature",css:"emoji_blossom"},{key:"globe_with_meridians",title:"globe with meridians",category:"nature",css:"emoji_globe_with_meridians"},{key:"sun_with_face",title:"sun with face",category:"nature",css:"emoji_sun_with_face"},{key:"full_moon_with_face",title:"full moon with face",category:"nature",css:"emoji_full_moon_with_face"},{key:"new_moon_with_face",title:"new moon with face",category:"nature",css:"emoji_new_moon_with_face"},{key:"new_moon",title:"new moon symbol",category:"nature",css:"emoji_new_moon"},{key:"waxing_crescent_moon",title:"waxing crescent moon symbol",category:"nature",css:"emoji_waxing_crescent_moon"},{key:"first_quarter_moon",title:"first quarter moon symbol",category:"nature",css:"emoji_first_quarter_moon"},{key:"moon",title:"waxing gibbous moon symbol",category:"nature",css:"emoji_moon"},{key:"full_moon",title:"full moon symbol",category:"nature",css:"emoji_full_moon"},{key:"waning_gibbous_moon",title:"waning gibbous moon symbol",category:"nature",css:"emoji_waning_gibbous_moon"},{key:"last_quarter_moon",title:"last quarter moon symbol",category:"nature",css:"emoji_last_quarter_moon"},{key:"waning_crescent_moon",title:"waning crescent moon symbol",category:"nature",css:"emoji_waning_crescent_moon"},{key:"last_quarter_moon_with_face",title:"last quarter moon with face",category:"nature",css:"emoji_last_quarter_moon_with_face"},{key:"first_quarter_moon_with_face",title:"first quarter moon with face",category:"nature",css:"emoji_first_quarter_moon_with_face"},{key:"crescent_moon",title:"crescent moon",category:"nature",css:"emoji_crescent_moon"},{key:"earth_africa",title:"earth globe europe-africa",category:"nature",css:"emoji_earth_africa"},{key:"earth_americas",title:"earth globe americas",category:"nature",css:"emoji_earth_americas"},{key:"earth_asia",title:"earth globe asia-australia",category:"nature",css:"emoji_earth_asia"},{key:"volcano",title:"volcano",category:"nature",css:"emoji_volcano"},{key:"milky_way",title:"milky way",category:"nature",css:"emoji_milky_way"},{key:"stars",title:"shooting star",category:"nature",css:"emoji_stars"},{key:"star",title:"white medium star",category:"nature",css:"emoji_star"},{key:"sunny",title:"black sun with rays",category:"nature",css:"emoji_sunny"},{key:"partly_sunny",title:"sun behind cloud",category:"nature",css:"emoji_partly_sunny"},{key:"cloud",title:"cloud",category:"nature",css:"emoji_cloud"},{key:"zap",title:"high voltage sign",category:"nature",css:"emoji_zap"},{key:"umbrella",title:"umbrella with rain drops",category:"nature",css:"emoji_umbrella"},{key:"snowflake",title:"snowflake",category:"nature",css:"emoji_snowflake"},{key:"snowman",title:"snowman without snow",category:"nature",css:"emoji_snowman"},{key:"cyclone",title:"cyclone",category:"nature",css:"emoji_cyclone"},{key:"foggy",title:"foggy",category:"nature",css:"emoji_foggy"},{key:"rainbow",title:"rainbow",category:"nature",css:"emoji_rainbow"},{key:"ocean",title:"water wave",category:"nature",css:"emoji_ocean"},{key:"bamboo",title:"pine decoration",category:"objects",css:"emoji_bamboo"},{key:"gift_heart",title:"heart with ribbon",category:"objects",css:"emoji_gift_heart"},{key:"dolls",title:"japanese dolls",category:"objects",css:"emoji_dolls"},{key:"school_satchel",title:"school satchel",category:"objects",css:"emoji_school_satchel"},{key:"mortar_board",title:"graduation cap",category:"objects",css:"emoji_mortar_board"},{key:"flags",title:"carp streamer",category:"objects",css:"emoji_flags"},{key:"fireworks",title:"fireworks",category:"objects",css:"emoji_fireworks"},{key:"sparkler",title:"firework sparkler",category:"objects",css:"emoji_sparkler"},{key:"wind_chime",title:"wind chime",category:"objects",css:"emoji_wind_chime"},{key:"rice_scene",title:"moon viewing ceremony",category:"objects",css:"emoji_rice_scene"},{key:"jack_o_lantern",title:"jack-o-lantern",category:"objects",css:"emoji_jack_o_lantern"},{key:"ghost",title:"ghost",category:"objects",css:"emoji_ghost"},{key:"santa",title:"father christmas",category:"objects",css:"emoji_santa"},{key:"christmas_tree",title:"christmas tree",category:"objects",css:"emoji_christmas_tree"},{key:"gift",title:"wrapped present",category:"objects",css:"emoji_gift"},{key:"tanabata_tree",title:"tanabata tree",category:"objects",css:"emoji_tanabata_tree"},{key:"tada",title:"party popper",category:"objects",css:"emoji_tada"},{key:"confetti_ball",title:"confetti ball",category:"objects",css:"emoji_confetti_ball"},{key:"balloon",title:"balloon",category:"objects",css:"emoji_balloon"},{key:"crossed_flags",title:"crossed flags",category:"objects",css:"emoji_crossed_flags"},{key:"crystal_ball",title:"crystal ball",category:"objects",css:"emoji_crystal_ball"},{key:"movie_camera",title:"movie camera",category:"objects",css:"emoji_movie_camera"},{key:"camera",title:"camera",category:"objects",css:"emoji_camera"},{key:"video_camera",title:"video camera",category:"objects",css:"emoji_video_camera"},{key:"vhs",title:"videocassette",category:"objects",css:"emoji_vhs"},{key:"cd",title:"optical disc",category:"objects",css:"emoji_cd"},{key:"dvd",title:"dvd",category:"objects",css:"emoji_dvd"},{key:"minidisc",title:"minidisc",category:"objects",css:"emoji_minidisc"},{key:"floppy_disk",title:"floppy disk",category:"objects",css:"emoji_floppy_disk"},{key:"computer",title:"personal computer",category:"objects",css:"emoji_computer"},{key:"iphone",title:"mobile phone",category:"objects",css:"emoji_iphone"},{key:"phone",title:"black telephone",category:"objects",css:"emoji_phone"},{key:"telephone_receiver",title:"telephone receiver",category:"objects",css:"emoji_telephone_receiver"},{key:"pager",title:"pager",category:"objects",css:"emoji_pager"},{key:"fax",title:"fax machine",category:"objects",css:"emoji_fax"},{key:"satellite",title:"satellite antenna",category:"objects",css:"emoji_satellite"},{key:"tv",title:"television",category:"objects",css:"emoji_tv"},{key:"radio",title:"radio",category:"objects",css:"emoji_radio"},{key:"loud_sound",title:"speaker with three sound waves",category:"objects",css:"emoji_loud_sound"},{key:"sound",title:"speaker with one sound wave",category:"objects",css:"emoji_sound"},{key:"speaker",title:"speaker",category:"objects",css:"emoji_speaker"},{key:"mute",title:"speaker with cancellation stroke",category:"objects",css:"emoji_mute"},{key:"bell",title:"bell",category:"objects",css:"emoji_bell"},{key:"no_bell",title:"bell with cancellation stroke",category:"objects",css:"emoji_no_bell"},{key:"loudspeaker",title:"public address loudspeaker",category:"objects",css:"emoji_loudspeaker"},{key:"mega",title:"cheering megaphone",category:"objects",css:"emoji_mega"},{key:"hourglass",title:"hourglass",category:"objects",css:"emoji_hourglass"},{key:"alarm_clock",title:"alarm clock",category:"objects",css:"emoji_alarm_clock"},{key:"hourglass_flowing_sand",title:"hourglass with flowing sand",category:"objects",css:"emoji_hourglass_flowing_sand"},{key:"watch",title:"watch",category:"objects",css:"emoji_watch"},{key:"unlock",title:"open lock",category:"objects",css:"emoji_unlock"},{key:"lock",title:"lock",category:"objects",css:"emoji_lock"},{key:"lock_with_ink_pen",title:"lock with ink pen",category:"objects",css:"emoji_lock_with_ink_pen"},{key:"closed_lock_with_key",title:"closed lock with key",category:"objects",css:"emoji_closed_lock_with_key"},{key:"key",title:"key",category:"objects",css:"emoji_key"},{key:"mag_right",title:"right-pointing magnifying glass",category:"objects",css:"emoji_mag_right"},{key:"bulb",title:"electric light bulb",category:"objects",css:"emoji_bulb"},{key:"flashlight",title:"electric torch",category:"objects",css:"emoji_flashlight"},{key:"high_brightness",title:"high brightness symbol",category:"objects",css:"emoji_high_brightness"},{key:"low_brightness",title:"low brightness symbol",category:"objects",css:"emoji_low_brightness"},{key:"electric_plug",title:"electric plug",category:"objects",css:"emoji_electric_plug"},{key:"battery",title:"battery",category:"objects",css:"emoji_battery"},{key:"mag",title:"left-pointing magnifying glass",category:"objects",css:"emoji_mag"},{key:"bath",title:"bath",category:"objects",css:"emoji_bath"},{key:"bathtub",title:"bathtub",category:"objects",css:"emoji_bathtub"},{key:"shower",title:"shower",category:"objects",css:"emoji_shower"},{key:"toilet",title:"toilet",category:"objects",css:"emoji_toilet"},{key:"wrench",title:"wrench",category:"objects",css:"emoji_wrench"},{key:"nut_and_bolt",title:"nut and bolt",category:"objects",css:"emoji_nut_and_bolt"},{key:"hammer",title:"hammer",category:"objects",css:"emoji_hammer"},{key:"door",title:"door",category:"objects",css:"emoji_door"},{key:"smoking",title:"smoking symbol",category:"objects",css:"emoji_smoking"},{key:"bomb",title:"bomb",category:"objects",css:"emoji_bomb"},{key:"gun",title:"pistol",category:"objects",css:"emoji_gun"},{key:"hocho",title:"hocho",category:"objects",css:"emoji_hocho"},{key:"pill",title:"pill",category:"objects",css:"emoji_pill"},{key:"syringe",title:"syringe",category:"objects",css:"emoji_syringe"},{key:"moneybag",title:"money bag",category:"objects",css:"emoji_moneybag"},{key:"yen",title:"banknote with yen sign",category:"objects",css:"emoji_yen"},{key:"dollar",title:"banknote with dollar sign",category:"objects",css:"emoji_dollar"},{key:"pound",title:"banknote with pound sign",category:"objects",css:"emoji_pound"},{key:"euro",title:"banknote with euro sign",category:"objects",css:"emoji_euro"},{key:"credit_card",title:"credit card",category:"objects",css:"emoji_credit_card"},{key:"money_with_wings",title:"money with wings",category:"objects",css:"emoji_money_with_wings"},{key:"calling",title:"mobile phone with rightwards arrow at left",category:"objects",css:"emoji_calling"},{key:"e-mail",title:"e-mail symbol",category:"objects",css:"emoji_e-mail"},{key:"outbox_tray",title:"outbox tray",category:"objects",css:"emoji_outbox_tray"},{key:"inbox_tray",title:"inbox tray",category:"objects",css:"emoji_inbox_tray"},{key:"email",title:"envelope",category:"objects",css:"emoji_email"},{key:"envelope_with_arrow",title:"envelope with downwards arrow above",category:"objects",css:"emoji_envelope_with_arrow"},{key:"incoming_envelope",title:"incoming envelope",category:"objects",css:"emoji_incoming_envelope"},{key:"postal_horn",title:"postal horn",category:"objects",css:"emoji_postal_horn"},{key:"mailbox",title:"closed mailbox with raised flag",category:"objects",css:"emoji_mailbox"},{key:"mailbox_closed",title:"closed mailbox with lowered flag",category:"objects",css:"emoji_mailbox_closed"},{key:"mailbox_with_mail",title:"open mailbox with raised flag",category:"objects",css:"emoji_mailbox_with_mail"},{key:"mailbox_with_no_mail",title:"open mailbox with lowered flag",category:"objects",css:"emoji_mailbox_with_no_mail"},{key:"postbox",title:"postbox",category:"objects",css:"emoji_postbox"},{key:"package",title:"package",category:"objects",css:"emoji_package"},{key:"memo",title:"memo",category:"objects",css:"emoji_memo"},{key:"page_facing_up",title:"page facing up",category:"objects",css:"emoji_page_facing_up"},{key:"page_with_curl",title:"page with curl",category:"objects",css:"emoji_page_with_curl"},{key:"bookmark_tabs",title:"bookmark tabs",category:"objects",css:"emoji_bookmark_tabs"},{key:"bar_chart",title:"bar chart",category:"objects",css:"emoji_bar_chart"},{key:"chart_with_upwards_trend",title:"chart with upwards trend",category:"objects",css:"emoji_chart_with_upwards_trend"},{key:"chart_with_downwards_trend",title:"chart with downwards trend",category:"objects",css:"emoji_chart_with_downwards_trend"},{key:"scroll",title:"scroll",category:"objects",css:"emoji_scroll"},{key:"clipboard",title:"clipboard",category:"objects",css:"emoji_clipboard"},{key:"date",title:"calendar",category:"objects",css:"emoji_date"},{key:"calendar",title:"tear-off calendar",category:"objects",css:"emoji_calendar"},{key:"card_index",title:"card index",category:"objects",css:"emoji_card_index"},{key:"file_folder",title:"file folder",category:"objects",css:"emoji_file_folder"},{key:"open_file_folder",title:"open file folder",category:"objects",css:"emoji_open_file_folder"},{key:"scissors",title:"black scissors",category:"objects",css:"emoji_scissors"},{key:"pushpin",title:"pushpin",category:"objects",css:"emoji_pushpin"},{key:"paperclip",title:"paperclip",category:"objects",css:"emoji_paperclip"},{key:"black_nib",title:"black nib",category:"objects",css:"emoji_black_nib"},{key:"pencil2",title:"pencil",category:"objects",css:"emoji_pencil2"},{key:"straight_ruler",title:"straight ruler",category:"objects",css:"emoji_straight_ruler"},{key:"triangular_ruler",title:"triangular ruler",category:"objects",css:"emoji_triangular_ruler"},{key:"closed_book",title:"closed book",category:"objects",css:"emoji_closed_book"},{key:"green_book",title:"green book",category:"objects",css:"emoji_green_book"},{key:"blue_book",title:"blue book",category:"objects",css:"emoji_blue_book"},{key:"orange_book",title:"orange book",category:"objects",css:"emoji_orange_book"},{key:"notebook",title:"notebook",category:"objects",css:"emoji_notebook"},{key:"notebook_with_decorative_cover",title:"notebook with decorative cover",category:"objects",css:"emoji_notebook_with_decorative_cover"},{key:"ledger",title:"ledger",category:"objects",css:"emoji_ledger"},{key:"books",title:"books",category:"objects",css:"emoji_books"},{key:"book",title:"open book",category:"objects",css:"emoji_book"},{key:"tomato",title:"tomato",category:"objects",css:"emoji_tomato"},{key:"bookmark",title:"bookmark",category:"objects",css:"emoji_bookmark"},{key:"name_badge",title:"name badge",category:"objects",css:"emoji_name_badge"},{key:"microscope",title:"microscope",category:"objects",css:"emoji_microscope"},{key:"telescope",title:"telescope",category:"objects",css:"emoji_telescope"},{key:"newspaper",title:"newspaper",category:"objects",css:"emoji_newspaper"},{key:"art",title:"artist palette",category:"objects",css:"emoji_art"},{key:"clapper",title:"clapper board",category:"objects",css:"emoji_clapper"},{key:"microphone",title:"microphone",category:"objects",css:"emoji_microphone"},{key:"headphones",title:"headphone",category:"objects",css:"emoji_headphones"},{key:"musical_score",title:"musical score",category:"objects",css:"emoji_musical_score"},{key:"musical_note",title:"musical note",category:"objects",css:"emoji_musical_note"},{key:"notes",title:"multiple musical notes",category:"objects",css:"emoji_notes"},{key:"musical_keyboard",title:"musical keyboard",category:"objects",css:"emoji_musical_keyboard"},{key:"violin",title:"violin",category:"objects",css:"emoji_violin"},{key:"trumpet",title:"trumpet",category:"objects",css:"emoji_trumpet"},{key:"saxophone",title:"saxophone",category:"objects",css:"emoji_saxophone"},{key:"guitar",title:"guitar",category:"objects",css:"emoji_guitar"},{key:"space_invader",title:"alien monster",category:"objects",css:"emoji_space_invader"},{key:"video_game",title:"video game",category:"objects",css:"emoji_video_game"},{key:"black_joker",title:"playing card black joker",category:"objects",css:"emoji_black_joker"},{key:"flower_playing_cards",title:"flower playing cards",category:"objects",css:"emoji_flower_playing_cards"},{key:"mahjong",title:"mahjong tile red dragon",category:"objects",css:"emoji_mahjong"},{key:"game_die",title:"game die",category:"objects",css:"emoji_game_die"},{key:"dart",title:"direct hit",category:"objects",css:"emoji_dart"},{key:"football",title:"american football",category:"objects",css:"emoji_football"},{key:"basketball",title:"basketball and hoop",category:"objects",css:"emoji_basketball"},{key:"soccer",title:"soccer ball",category:"objects",css:"emoji_soccer"},{key:"baseball",title:"baseball",category:"objects",css:"emoji_baseball"},{key:"tennis",title:"tennis racquet and ball",category:"objects",css:"emoji_tennis"},{key:"8ball",title:"billiards",category:"objects",css:"emoji_8ball"},{key:"rugby_football",title:"rugby football",category:"objects",css:"emoji_rugby_football"},{key:"bowling",title:"bowling",category:"objects",css:"emoji_bowling"},{key:"golf",title:"flag in hole",category:"objects",css:"emoji_golf"},{key:"mountain_bicyclist",title:"mountain bicyclist",category:"objects",css:"emoji_mountain_bicyclist"},{key:"bicyclist",title:"bicyclist",category:"objects",css:"emoji_bicyclist"},{key:"checkered_flag",title:"chequered flag",category:"objects",css:"emoji_checkered_flag"},{key:"horse_racing",title:"horse racing",category:"objects",css:"emoji_horse_racing"},{key:"trophy",title:"trophy",category:"objects",css:"emoji_trophy"},{key:"ski",title:"ski and ski boot",category:"objects",css:"emoji_ski"},{key:"snowboarder",title:"snowboarder",category:"objects",css:"emoji_snowboarder"},{key:"swimmer",title:"swimmer",category:"objects",css:"emoji_swimmer"},{key:"surfer",title:"surfer",category:"objects",css:"emoji_surfer"},{key:"fishing_pole_and_fish",title:"fishing pole and fish",category:"objects",css:"emoji_fishing_pole_and_fish"},{key:"coffee",title:"hot beverage",category:"objects",css:"emoji_coffee"},{key:"tea",title:"teacup without handle",category:"objects",css:"emoji_tea"},{key:"sake",title:"sake bottle and cup",category:"objects",css:"emoji_sake"},{key:"baby_bottle",title:"baby bottle",category:"objects",css:"emoji_baby_bottle"},{key:"beer",title:"beer mug",category:"objects",css:"emoji_beer"},{key:"beers",title:"clinking beer mugs",category:"objects",css:"emoji_beers"},{key:"cocktail",title:"cocktail glass",category:"objects",css:"emoji_cocktail"},{key:"tropical_drink",title:"tropical drink",category:"objects",css:"emoji_tropical_drink"},{key:"wine_glass",title:"wine glass",category:"objects",css:"emoji_wine_glass"},{key:"fork_and_knife",title:"fork and knife",category:"objects",css:"emoji_fork_and_knife"},{key:"pizza",title:"slice of pizza",category:"objects",css:"emoji_pizza"},{key:"hamburger",title:"hamburger",category:"objects",css:"emoji_hamburger"},{key:"fries",title:"french fries",category:"objects",css:"emoji_fries"},{key:"poultry_leg",title:"poultry leg",category:"objects",css:"emoji_poultry_leg"},{key:"meat_on_bone",title:"meat on bone",category:"objects",css:"emoji_meat_on_bone"},{key:"spaghetti",title:"spaghetti",category:"objects",css:"emoji_spaghetti"},{key:"curry",title:"curry and rice",category:"objects",css:"emoji_curry"},{key:"fried_shrimp",title:"fried shrimp",category:"objects",css:"emoji_fried_shrimp"},{key:"bento",title:"bento box",category:"objects",css:"emoji_bento"},{key:"sushi",title:"sushi",category:"objects",css:"emoji_sushi"},{key:"fish_cake",title:"fish cake with swirl design",category:"objects",css:"emoji_fish_cake"},{key:"rice_ball",title:"rice ball",category:"objects",css:"emoji_rice_ball"},{key:"rice_cracker",title:"rice cracker",category:"objects",css:"emoji_rice_cracker"},{key:"rice",title:"cooked rice",category:"objects",css:"emoji_rice"},{key:"ramen",title:"steaming bowl",category:"objects",css:"emoji_ramen"},{key:"stew",title:"pot of food",category:"objects",css:"emoji_stew"},{key:"oden",title:"oden",category:"objects",css:"emoji_oden"},{key:"dango",title:"dango",category:"objects",css:"emoji_dango"},{key:"egg",title:"cooking",category:"objects",css:"emoji_egg"},{key:"bread",title:"bread",category:"objects",css:"emoji_bread"},{key:"doughnut",title:"doughnut",category:"objects",css:"emoji_doughnut"},{key:"custard",title:"custard",category:"objects",css:"emoji_custard"},{key:"icecream",title:"soft ice cream",category:"objects",css:"emoji_icecream"},{key:"ice_cream",title:"ice cream",category:"objects",css:"emoji_ice_cream"},{key:"shaved_ice",title:"shaved ice",category:"objects",css:"emoji_shaved_ice"},{key:"birthday",title:"birthday cake",category:"objects",css:"emoji_birthday"},{key:"cake",title:"shortcake",category:"objects",css:"emoji_cake"},{key:"cookie",title:"cookie",category:"objects",css:"emoji_cookie"},{key:"chocolate_bar",title:"chocolate bar",category:"objects",css:"emoji_chocolate_bar"},{key:"candy",title:"candy",category:"objects",css:"emoji_candy"},{key:"lollipop",title:"lollipop",category:"objects",css:"emoji_lollipop"},{key:"honey_pot",title:"honey pot",category:"objects",css:"emoji_honey_pot"},{key:"apple",title:"red apple",category:"objects",css:"emoji_apple"},{key:"green_apple",title:"green apple",category:"objects",css:"emoji_green_apple"},{key:"tangerine",title:"tangerine",category:"objects",css:"emoji_tangerine"},{key:"lemon",title:"lemon",category:"objects",css:"emoji_lemon"},{key:"cherries",title:"cherries",category:"objects",css:"emoji_cherries"},{key:"grapes",title:"grapes",category:"objects",css:"emoji_grapes"},{key:"watermelon",title:"watermelon",category:"objects",css:"emoji_watermelon"},{key:"strawberry",title:"strawberry",category:"objects",css:"emoji_strawberry"},{key:"peach",title:"peach",category:"objects",css:"emoji_peach"},{key:"melon",title:"melon",category:"objects",css:"emoji_melon"},{key:"banana",title:"banana",category:"objects",css:"emoji_banana"},{key:"pear",title:"pear",category:"objects",css:"emoji_pear"},{key:"pineapple",title:"pineapple",category:"objects",css:"emoji_pineapple"},{key:"sweet_potato",title:"roasted sweet potato",category:"objects",css:"emoji_sweet_potato"},{key:"eggplant",title:"aubergine",category:"objects",css:"emoji_eggplant"},{key:"corn",title:"ear of maize",category:"objects",css:"emoji_corn"},{key:"smile",title:"smiling face with open mouth and smiling eyes",category:"people",css:"emoji_smile",ascii:[":)",":-)"]},{key:"smiley",title:"smiling face with open mouth",category:"people",css:"emoji_smiley"},{key:"grinning",title:"grinning face",category:"people",css:"emoji_grinning",ascii:[":D"]},{key:"blush",title:"smiling face with smiling eyes",category:"people",css:"emoji_blush"},{key:"relaxed",title:"white smiling face",category:"people",css:"emoji_relaxed"},{key:"wink",title:"winking face",category:"people",css:"emoji_wink",ascii:[";)",";-)"]},{key:"heart_eyes",title:"smiling face with heart-shaped eyes",category:"people",css:"emoji_heart_eyes"},{key:"kissing_heart",title:"face throwing a kiss",category:"people",css:"emoji_kissing_heart"},{key:"kissing_closed_eyes",title:"kissing face with closed eyes",category:"people",css:"emoji_kissing_closed_eyes"},{key:"kissing",title:"kissing face",category:"people",css:"emoji_kissing"},{key:"kissing_smiling_eyes",title:"kissing face with smiling eyes",category:"people",css:"emoji_kissing_smiling_eyes"},{key:"stuck_out_tongue_winking_eye",title:"face with stuck-out tongue and winking eye",category:"people",css:"emoji_stuck_out_tongue_winking_eye"},{key:"stuck_out_tongue_closed_eyes",title:"face with stuck-out tongue and tightly-closed eyes",category:"people",css:"emoji_stuck_out_tongue_closed_eyes"},{key:"stuck_out_tongue",title:"face with stuck-out tongue",category:"people",css:"emoji_stuck_out_tongue",ascii:[":p",":-p",":P",":-P"]},{key:"flushed",title:"flushed face",category:"people",css:"emoji_flushed"},{key:"grin",title:"grinning face with smiling eyes",category:"people",css:"emoji_grin"},{key:"pensive",title:"pensive face",category:"people",css:"emoji_pensive"},{key:"relieved",title:"relieved face",category:"people",css:"emoji_relieved"},{key:"unamused",title:"unamused face",category:"people",css:"emoji_unamused"},{key:"disappointed",title:"disappointed face",category:"people",css:"emoji_disappointed",ascii:[":(",":-("]},{key:"persevere",title:"persevering face",category:"people",css:"emoji_persevere"},{key:"cry",title:"crying face",category:"people",css:"emoji_cry",ascii:[":'("]},{key:"joy",title:"face with tears of joy",category:"people",css:"emoji_joy"},{key:"sob",title:"loudly crying face",category:"people",css:"emoji_p1"},{key:"sleepy",title:"sleepy face",category:"people",css:"emoji_m1"},{key:"disappointed_relieved",title:"disappointed but relieved face",category:"people",css:"emoji_disappointed_relieved"},{key:"cold_sweat",title:"face with open mouth and cold sweat",category:"people",css:"emoji_cold_sweat"},{key:"sweat_smile",title:"smiling face with open mouth and cold sweat",category:"people",css:"emoji_sweat_smile"},{key:"sweat",title:"face with cold sweat",category:"people",css:"emoji_sweat"},{key:"weary",title:"weary face",category:"people",css:"emoji_weary"},{key:"tired_face",title:"tired face",category:"people",css:"emoji_tired_face"},{key:"fearful",title:"fearful face",category:"people",css:"emoji_fearful"},{key:"scream",title:"face screaming in fear",category:"people",css:"emoji_scream"},{key:"angry",title:"angry face",category:"people",css:"emoji_angry"},{key:"rage",title:"pouting face",category:"people",css:"emoji_rage"},{key:"triumph",title:"face with look of triumph",category:"people",css:"emoji_triumph"},{key:"confounded",title:"confounded face",category:"people",css:"emoji_confounded"},{key:"laughing",title:"smiling face with open mouth and tightly-closed eyes",category:"people",css:"emoji_laughing"},{key:"yum",title:"face savouring delicious food",category:"people",css:"emoji_yum"},{key:"mask",title:"face with medical mask",category:"people",css:"emoji_mask"},{key:"sunglasses",title:"smiling face with sunglasses",category:"people",css:"emoji_sunglasses"},{key:"sleeping",title:"sleeping face",category:"people",css:"emoji_sleeping"},{key:"dizzy_face",title:"dizzy face",category:"people",css:"emoji_dizzy_face"},{key:"astonished",title:"astonished face",category:"people",css:"emoji_astonished"},{key:"worried",title:"worried face",category:"people",css:"emoji_worried"},{key:"frowning",title:"frowning face with open mouth",category:"people",css:"emoji_frowning"},{key:"smiling_imp",title:"smiling face with horns",category:"people",css:"emoji_smiling_imp"},{key:"anguished",title:"anguished face",category:"people",css:"emoji_anguished"},{key:"imp",title:"imp",category:"people",css:"emoji_imp"},{key:"open_mouth",title:"face with open mouth",category:"people",css:"emoji_open_mouth"},{key:"grimacing",title:"grimacing face",category:"people",css:"emoji_grimacing"},{key:"neutral_face",title:"neutral face",category:"people",css:"emoji_neutral_face"},{key:"confused",title:"confused face",
category:"people",css:"emoji_confused"},{key:"hushed",title:"hushed face",category:"people",css:"emoji_hushed"},{key:"no_mouth",title:"face without mouth",category:"people",css:"emoji_no_mouth"},{key:"innocent",title:"smiling face with halo",category:"people",css:"emoji_innocent"},{key:"smirk",title:"smirking face",category:"people",css:"emoji_smirk"},{key:"expressionless",title:"expressionless face",category:"people",css:"emoji_expressionless"},{key:"man_with_gua_pi_mao",title:"man with gua pi mao",category:"people",css:"emoji_man_with_gua_pi_mao"},{key:"man_with_turban",title:"man with turban",category:"people",css:"emoji_man_with_turban"},{key:"cop",title:"police officer",category:"people",css:"emoji_cop"},{key:"construction_worker",title:"construction worker",category:"people",css:"emoji_construction_worker"},{key:"guardsman",title:"guardsman",category:"people",css:"emoji_guardsman"},{key:"baby",title:"baby",category:"people",css:"emoji_baby"},{key:"boy",title:"boy",category:"people",css:"emoji_boy"},{key:"girl",title:"girl",category:"people",css:"emoji_girl"},{key:"man",title:"man",category:"people",css:"emoji_man"},{key:"woman",title:"woman",category:"people",css:"emoji_woman"},{key:"older_man",title:"older man",category:"people",css:"emoji_older_man"},{key:"older_woman",title:"older woman",category:"people",css:"emoji_older_woman"},{key:"person_with_blond_hair",title:"person with blond hair",category:"people",css:"emoji_person_with_blond_hair"},{key:"angel",title:"baby angel",category:"people",css:"emoji_angel"},{key:"princess",title:"princess",category:"people",css:"emoji_princess"},{key:"smiley_cat",title:"smiling cat face with open mouth",category:"people",css:"emoji_smiley_cat"},{key:"smile_cat",title:"grinning cat face with smiling eyes",category:"people",css:"emoji_smile_cat"},{key:"heart_eyes_cat",title:"smiling cat face with heart-shaped eyes",category:"people",css:"emoji_heart_eyes_cat"},{key:"kissing_cat",title:"kissing cat face with closed eyes",category:"people",css:"emoji_kissing_cat"},{key:"smirk_cat",title:"cat face with wry smile",category:"people",css:"emoji_smirk_cat"},{key:"scream_cat",title:"weary cat face",category:"people",css:"emoji_scream_cat"},{key:"crying_cat_face",title:"crying cat face",category:"people",css:"emoji_crying_cat_face"},{key:"joy_cat",title:"cat face with tears of joy",category:"people",css:"emoji_joy_cat"},{key:"pouting_cat",title:"pouting cat face",category:"people",css:"emoji_pouting_cat"},{key:"japanese_ogre",title:"japanese ogre",category:"people",css:"emoji_japanese_ogre"},{key:"japanese_goblin",title:"japanese goblin",category:"people",css:"emoji_japanese_goblin"},{key:"see_no_evil",title:"see-no-evil monkey",category:"people",css:"emoji_see_no_evil"},{key:"hear_no_evil",title:"hear-no-evil monkey",category:"people",css:"emoji_hear_no_evil"},{key:"speak_no_evil",title:"speak-no-evil monkey",category:"people",css:"emoji_speak_no_evil"},{key:"skull",title:"skull",category:"people",css:"emoji_skull"},{key:"alien",title:"extraterrestrial alien",category:"people",css:"emoji_alien"},{key:"hankey",title:"pile of poo",category:"people",css:"emoji_hankey"},{key:"fire",title:"fire",category:"people",css:"emoji_fire"},{key:"sparkles",title:"sparkles",category:"people",css:"emoji_sparkles"},{key:"star2",title:"glowing star",category:"people",css:"emoji_star2"},{key:"dizzy",title:"dizzy symbol",category:"people",css:"emoji_dizzy"},{key:"boom",title:"collision symbol",category:"people",css:"emoji_boom"},{key:"anger",title:"anger symbol",category:"people",css:"emoji_anger"},{key:"sweat_drops",title:"splashing sweat symbol",category:"people",css:"emoji_sweat_drops"},{key:"droplet",title:"droplet",category:"people",css:"emoji_droplet"},{key:"zzz",title:"sleeping symbol",category:"people",css:"emoji_zzz"},{key:"dash",title:"dash symbol",category:"people",css:"emoji_dash"},{key:"ear",title:"ear",category:"people",css:"emoji_ear"},{key:"eyes",title:"eyes",category:"people",css:"emoji_eyes"},{key:"nose",title:"nose",category:"people",css:"emoji_nose"},{key:"tongue",title:"tongue",category:"people",css:"emoji_tongue"},{key:"lips",title:"mouth",category:"people",css:"emoji_lips"},{key:"+1",title:"thumbs up sign",category:"people",css:"emoji_p1"},{key:"-1",title:"thumbs down sign",category:"people",css:"emoji_m1"},{key:"ok_hand",title:"ok hand sign",category:"people",css:"emoji_ok_hand"},{key:"facepunch",title:"fisted hand sign",category:"people",css:"emoji_facepunch"},{key:"fist",title:"raised fist",category:"people",css:"emoji_fist"},{key:"v",title:"victory hand",category:"people",css:"emoji_v"},{key:"wave",title:"waving hand sign",category:"people",css:"emoji_wave"},{key:"hand",title:"raised hand",category:"people",css:"emoji_hand"},{key:"open_hands",title:"open hands sign",category:"people",css:"emoji_open_hands"},{key:"point_up_2",title:"white up pointing backhand index",category:"people",css:"emoji_point_up_2"},{key:"point_down",title:"white down pointing backhand index",category:"people",css:"emoji_point_down"},{key:"point_right",title:"white right pointing backhand index",category:"people",css:"emoji_point_right"},{key:"point_left",title:"white left pointing backhand index",category:"people",css:"emoji_point_left"},{key:"raised_hands",title:"person raising both hands in celebration",category:"people",css:"emoji_raised_hands"},{key:"pray",title:"person with folded hands",category:"people",css:"emoji_pray"},{key:"point_up",title:"white up pointing index",category:"people",css:"emoji_point_up"},{key:"clap",title:"clapping hands sign",category:"people",css:"emoji_clap"},{key:"muscle",title:"flexed biceps",category:"people",css:"emoji_muscle"},{key:"walking",title:"pedestrian",category:"people",css:"emoji_walking"},{key:"runner",title:"runner",category:"people",css:"emoji_runner"},{key:"dancer",title:"dancer",category:"people",css:"emoji_dancer"},{key:"couple",title:"man and woman holding hands",category:"people",css:"emoji_couple"},{key:"family",title:"family",category:"people",css:"emoji_family"},{key:"two_men_holding_hands",title:"two men holding hands",category:"people",css:"emoji_two_men_holding_hands"},{key:"two_women_holding_hands",title:"two women holding hands",category:"people",css:"emoji_two_women_holding_hands"},{key:"couplekiss",title:"kiss",category:"people",css:"emoji_couplekiss"},{key:"couple_with_heart",title:"couple with heart",category:"people",css:"emoji_couple_with_heart"},{key:"dancers",title:"woman with bunny ears",category:"people",css:"emoji_dancers"},{key:"ok_woman",title:"face with ok gesture",category:"people",css:"emoji_ok_woman"},{key:"no_good",title:"face with no good gesture",category:"people",css:"emoji_no_good"},{key:"information_desk_person",title:"information desk person",category:"people",css:"emoji_information_desk_person"},{key:"raising_hand",title:"happy person raising one hand",category:"people",css:"emoji_raising_hand"},{key:"massage",title:"face massage",category:"people",css:"emoji_massage"},{key:"haircut",title:"haircut",category:"people",css:"emoji_haircut"},{key:"nail_care",title:"nail polish",category:"people",css:"emoji_nail_care"},{key:"bride_with_veil",title:"bride with veil",category:"people",css:"emoji_bride_with_veil"},{key:"person_with_pouting_face",title:"person with pouting face",category:"people",css:"emoji_person_with_pouting_face"},{key:"person_frowning",title:"person frowning",category:"people",css:"emoji_person_frowning"},{key:"bow",title:"person bowing deeply",category:"people",css:"emoji_bow"},{key:"tophat",title:"top hat",category:"people",css:"emoji_tophat"},{key:"crown",title:"crown",category:"people",css:"emoji_crown"},{key:"womans_hat",title:"womans hat",category:"people",css:"emoji_womans_hat"},{key:"athletic_shoe",title:"athletic shoe",category:"people",css:"emoji_athletic_shoe"},{key:"mans_shoe",title:"mans shoe",category:"people",css:"emoji_mans_shoe"},{key:"sandal",title:"womans sandal",category:"people",css:"emoji_sandal"},{key:"high_heel",title:"high-heeled shoe",category:"people",css:"emoji_high_heel"},{key:"boot",title:"womans boots",category:"people",css:"emoji_boot"},{key:"shirt",title:"t-shirt",category:"people",css:"emoji_shirt"},{key:"necktie",title:"necktie",category:"people",css:"emoji_necktie"},{key:"womans_clothes",title:"womans clothes",category:"people",css:"emoji_womans_clothes"},{key:"dress",title:"dress",category:"people",css:"emoji_dress"},{key:"running_shirt_with_sash",title:"running shirt with sash",category:"people",css:"emoji_running_shirt_with_sash"},{key:"jeans",title:"jeans",category:"people",css:"emoji_jeans"},{key:"kimono",title:"kimono",category:"people",css:"emoji_kimono"},{key:"bikini",title:"bikini",category:"people",css:"emoji_bikini"},{key:"briefcase",title:"briefcase",category:"people",css:"emoji_briefcase"},{key:"handbag",title:"handbag",category:"people",css:"emoji_handbag"},{key:"pouch",title:"pouch",category:"people",css:"emoji_pouch"},{key:"purse",title:"purse",category:"people",css:"emoji_purse"},{key:"eyeglasses",title:"eyeglasses",category:"people",css:"emoji_eyeglasses"},{key:"ribbon",title:"ribbon",category:"people",css:"emoji_ribbon"},{key:"closed_umbrella",title:"closed umbrella",category:"people",css:"emoji_closed_umbrella"},{key:"lipstick",title:"lipstick",category:"people",css:"emoji_lipstick"},{key:"yellow_heart",title:"yellow heart",category:"people",css:"emoji_yellow_heart"},{key:"blue_heart",title:"blue heart",category:"people",css:"emoji_blue_heart"},{key:"purple_heart",title:"purple heart",category:"people",css:"emoji_purple_heart"},{key:"green_heart",title:"green heart",category:"people",css:"emoji_green_heart"},{key:"heart",title:"heavy black heart",category:"people",css:"emoji_heart"},{key:"broken_heart",title:"broken heart",category:"people",css:"emoji_broken_heart"},{key:"heartpulse",title:"growing heart",category:"people",css:"emoji_heartpulse"},{key:"heartbeat",title:"beating heart",category:"people",css:"emoji_heartbeat"},{key:"two_hearts",title:"two hearts",category:"people",css:"emoji_two_hearts"},{key:"sparkling_heart",title:"sparkling heart",category:"people",css:"emoji_sparkling_heart"},{key:"revolving_hearts",title:"revolving hearts",category:"people",css:"emoji_revolving_hearts"},{key:"cupid",title:"heart with arrow",category:"people",css:"emoji_cupid"},{key:"love_letter",title:"love letter",category:"people",css:"emoji_love_letter"},{key:"kiss",title:"kiss mark",category:"people",css:"emoji_kiss"},{key:"ring",title:"ring",category:"people",css:"emoji_ring"},{key:"gem",title:"gem stone",category:"people",css:"emoji_gem"},{key:"bust_in_silhouette",title:"bust in silhouette",category:"people",css:"emoji_bust_in_silhouette"},{key:"busts_in_silhouette",title:"busts in silhouette",category:"people",css:"emoji_busts_in_silhouette"},{key:"speech_balloon",title:"speech balloon",category:"people",css:"emoji_speech_balloon"},{key:"footprints",title:"footprints",category:"people",css:"emoji_footprints"},{key:"thought_balloon",title:"thought balloon",category:"people",css:"emoji_thought_balloon"},{key:"church",title:"church",category:"places",css:"emoji_church"},{key:"city_sunrise",title:"sunset over buildings",category:"places",css:"emoji_city_sunrise"},{key:"city_sunset",title:"cityscape at dusk",category:"places",css:"emoji_city_sunset"},{key:"tent",title:"tent",category:"places",css:"emoji_tent"},{key:"sunrise_over_mountains",title:"sunrise over mountains",category:"places",css:"emoji_sunrise_over_mountains"},{key:"sunrise",title:"sunrise",category:"places",css:"emoji_sunrise"},{key:"night_with_stars",title:"night with stars",category:"places",css:"emoji_night_with_stars"},{key:"bridge_at_night",title:"bridge at night",category:"places",css:"emoji_bridge_at_night"},{key:"carousel_horse",title:"carousel horse",category:"places",css:"emoji_carousel_horse"},{key:"ferris_wheel",title:"ferris wheel",category:"places",css:"emoji_ferris_wheel"},{key:"fountain",title:"fountain",category:"places",css:"emoji_fountain"},{key:"boat",title:"sailboat",category:"places",css:"emoji_boat"},{key:"airplane",title:"airplane",category:"places",css:"emoji_airplane"},{key:"anchor",title:"anchor",category:"places",css:"emoji_anchor"},{key:"ticket",title:"ticket",category:"places",css:"emoji_ticket"},{key:"warning",title:"warning sign",category:"places",css:"emoji_warning"},{key:"fuelpump",title:"fuel pump",category:"places",css:"emoji_fuelpump"},{key:"slot_machine",title:"slot machine",category:"places",css:"emoji_slot_machine"},{key:"hotsprings",title:"hot springs",category:"places",css:"emoji_hotsprings"},{key:"circus_tent",title:"circus tent",category:"places",css:"emoji_circus_tent"},{key:"performing_arts",title:"performing arts",category:"places",css:"emoji_performing_arts"},{key:"house",title:"house building",category:"places",css:"emoji_house"},{key:"house_with_garden",title:"house with garden",category:"places",css:"emoji_house_with_garden"},{key:"school",title:"school",category:"places",css:"emoji_school"},{key:"office",title:"office building",category:"places",css:"emoji_office"},{key:"post_office",title:"japanese post office",category:"places",css:"emoji_post_office"},{key:"hospital",title:"hospital",category:"places",css:"emoji_hospital"},{key:"bank",title:"bank",category:"places",css:"emoji_bank"},{key:"convenience_store",title:"convenience store",category:"places",css:"emoji_convenience_store"},{key:"love_hotel",title:"love hotel",category:"places",css:"emoji_love_hotel"},{key:"hotel",title:"hotel",category:"places",css:"emoji_hotel"},{key:"wedding",title:"wedding",category:"places",css:"emoji_wedding"},{key:"department_store",title:"department store",category:"places",css:"emoji_department_store"},{key:"european_post_office",title:"european post office",category:"places",css:"emoji_european_post_office"},{key:"japanese_castle",title:"japanese castle",category:"places",css:"emoji_japanese_castle"},{key:"european_castle",title:"european castle",category:"places",css:"emoji_european_castle"},{key:"factory",title:"factory",category:"places",css:"emoji_factory"},{key:"tokyo_tower",title:"tokyo tower",category:"places",css:"emoji_tokyo_tower"},{key:"japan",title:"silhouette of japan",category:"places",css:"emoji_japan"},{key:"mount_fuji",title:"mount fuji",category:"places",css:"emoji_mount_fuji"},{key:"statue_of_liberty",title:"statue of liberty",category:"places",css:"emoji_statue_of_liberty"},{key:"roller_coaster",title:"roller coaster",category:"places",css:"emoji_roller_coaster"},{key:"ship",title:"ship",category:"places",css:"emoji_ship"},{key:"speedboat",title:"speedboat",category:"places",css:"emoji_speedboat"},{key:"rowboat",title:"rowboat",category:"places",css:"emoji_rowboat"},{key:"rocket",title:"rocket",category:"places",css:"emoji_rocket"},{key:"seat",title:"seat",category:"places",css:"emoji_seat"},{key:"helicopter",title:"helicopter",category:"places",css:"emoji_helicopter"},{key:"steam_locomotive",title:"steam locomotive",category:"places",css:"emoji_steam_locomotive"},{key:"tram",title:"tram",category:"places",css:"emoji_tram"},{key:"station",title:"station",category:"places",css:"emoji_station"},{key:"mountain_railway",title:"mountain railway",category:"places",css:"emoji_mountain_railway"},{key:"train2",title:"train",category:"places",css:"emoji_train2"},{key:"bullettrain_side",title:"high-speed train",category:"places",css:"emoji_bullettrain_side"},{key:"bullettrain_front",title:"high-speed train with bullet nose",category:"places",css:"emoji_bullettrain_front"},{key:"light_rail",title:"light rail",category:"places",css:"emoji_light_rail"},{key:"metro",title:"metro",category:"places",css:"emoji_metro"},{key:"monorail",title:"monorail",category:"places",css:"emoji_monorail"},{key:"train",title:"tram car",category:"places",css:"emoji_train"},{key:"railway_car",title:"railway car",category:"places",css:"emoji_railway_car"},{key:"trolleybus",title:"trolleybus",category:"places",css:"emoji_trolleybus"},{key:"bus",title:"bus",category:"places",css:"emoji_bus"},{key:"oncoming_bus",title:"oncoming bus",category:"places",css:"emoji_oncoming_bus"},{key:"blue_car",title:"recreational vehicle",category:"places",css:"emoji_blue_car"},{key:"oncoming_automobile",title:"oncoming automobile",category:"places",css:"emoji_oncoming_automobile"},{key:"car",title:"automobile",category:"places",css:"emoji_car"},{key:"taxi",title:"taxi",category:"places",css:"emoji_taxi"},{key:"oncoming_taxi",title:"oncoming taxi",category:"places",css:"emoji_oncoming_taxi"},{key:"articulated_lorry",title:"articulated lorry",category:"places",css:"emoji_articulated_lorry"},{key:"truck",title:"delivery truck",category:"places",css:"emoji_truck"},{key:"rotating_light",title:"police cars revolving light",category:"places",css:"emoji_rotating_light"},{key:"police_car",title:"police car",category:"places",css:"emoji_police_car"},{key:"oncoming_police_car",title:"oncoming police car",category:"places",css:"emoji_oncoming_police_car"},{key:"fire_engine",title:"fire engine",category:"places",css:"emoji_fire_engine"},{key:"ambulance",title:"ambulance",category:"places",css:"emoji_ambulance"},{key:"minibus",title:"minibus",category:"places",css:"emoji_minibus"},{key:"bike",title:"bicycle",category:"places",css:"emoji_bike"},{key:"aerial_tramway",title:"aerial tramway",category:"places",css:"emoji_aerial_tramway"},{key:"suspension_railway",title:"suspension railway",category:"places",css:"emoji_suspension_railway"},{key:"mountain_cableway",title:"mountain cableway",category:"places",css:"emoji_mountain_cableway"},{key:"tractor",title:"tractor",category:"places",css:"emoji_tractor"},{key:"barber",title:"barber pole",category:"places",css:"emoji_barber"},{key:"busstop",title:"bus stop",category:"places",css:"emoji_busstop"},{key:"vertical_traffic_light",title:"vertical traffic light",category:"places",css:"emoji_vertical_traffic_light"},{key:"traffic_light",title:"horizontal traffic light",category:"places",css:"emoji_traffic_light"},{key:"construction",title:"construction sign",category:"places",css:"emoji_construction"},{key:"beginner",title:"japanese symbol for beginner",category:"places",css:"emoji_beginner"},{key:"izakaya_lantern",title:"izakaya lantern",category:"places",css:"emoji_izakaya_lantern"},{key:"moyai",title:"moyai",category:"places",css:"emoji_moyai"},{key:"round_pushpin",title:"round pushpin",category:"places",css:"emoji_round_pushpin"},{key:"triangular_flag_on_post",title:"triangular flag on post",category:"places",css:"emoji_triangular_flag_on_post"},{key:"jp",title:"regional indicator symbol letters jp",category:"places",css:"emoji_jp"},{key:"kr",title:"regional indicator symbol letters kr",category:"places",css:"emoji_kr"},{key:"de",title:"regional indicator symbol letters de",category:"places",css:"emoji_de"},{key:"cn",title:"regional indicator symbol letters cn",category:"places",css:"emoji_cn"},{key:"us",title:"regional indicator symbol letters us",category:"places",css:"emoji_us"},{key:"fr",title:"regional indicator symbol letters fr",category:"places",css:"emoji_fr"},{key:"es",title:"regional indicator symbol letters es",category:"places",css:"emoji_es"},{key:"it",title:"regional indicator symbol letters it",category:"places",css:"emoji_it"},{key:"ru",title:"regional indicator symbol letters ru",category:"places",css:"emoji_ru"},{key:"gb",title:"regional indicator symbol letters gb",category:"places",css:"emoji_gb"},{key:"one",title:"keycap 1",category:"symbols",css:"emoji_one"},{key:"two",title:"keycap 2",category:"symbols",css:"emoji_two"},{key:"three",title:"keycap 3",category:"symbols",css:"emoji_three"},{key:"four",title:"keycap 4",category:"symbols",css:"emoji_four"},{key:"five",title:"keycap 5",category:"symbols",css:"emoji_five"},{key:"six",title:"keycap 6",category:"symbols",css:"emoji_six"},{key:"seven",title:"keycap 7",category:"symbols",css:"emoji_seven"},{key:"eight",title:"keycap 8",category:"symbols",css:"emoji_eight"},{key:"nine",title:"keycap 9",category:"symbols",css:"emoji_nine"},{key:"zero",title:"keycap 0",category:"symbols",css:"emoji_zero"},{key:"keycap_ten",title:"keycap ten",category:"symbols",css:"emoji_keycap_ten"},{key:"1234",title:"input symbol for numbers",category:"symbols",css:"emoji_1234"},{key:"hash",title:"hash key",category:"symbols",css:"emoji_hash"},{key:"symbols",title:"input symbol for symbols",category:"symbols",css:"emoji_symbols"},{key:"arrow_up",title:"upwards black arrow",category:"symbols",css:"emoji_arrow_up"},{key:"arrow_down",title:"downwards black arrow",category:"symbols",css:"emoji_arrow_down"},{key:"arrow_left",title:"leftwards black arrow",category:"symbols",css:"emoji_arrow_left"},{key:"arrow_right",title:"black rightwards arrow",category:"symbols",css:"emoji_arrow_right"},{key:"capital_abcd",title:"input symbol for latin capital letters",category:"symbols",css:"emoji_capital_abcd"},{key:"abcd",title:"input symbol for latin small letters",category:"symbols",css:"emoji_abcd"},{key:"abc",title:"input symbol for latin letters",category:"symbols",css:"emoji_abc"},{key:"arrow_upper_right",title:"north east arrow",category:"symbols",css:"emoji_arrow_upper_right"},{key:"arrow_upper_left",title:"north west arrow",category:"symbols",css:"emoji_arrow_upper_left"},{key:"arrow_lower_left",title:"south west arrow",category:"symbols",css:"emoji_arrow_lower_left"},{key:"arrow_lower_right",title:"south east arrow",category:"symbols",css:"emoji_arrow_lower_right"},{key:"left_right_arrow",title:"left right arrow",category:"symbols",css:"emoji_left_right_arrow"},{key:"arrow_up_down",title:"up down arrow",category:"symbols",css:"emoji_arrow_up_down"},{key:"arrows_counterclockwise",title:"anticlockwise downwards and upwards open circle arrows",category:"symbols",css:"emoji_arrows_counterclockwise"},{key:"arrow_up_small",title:"up-pointing small red triangle",category:"symbols",css:"emoji_arrow_up_small"},{key:"arrow_down_small",title:"down-pointing small red triangle",category:"symbols",css:"emoji_arrow_down_small"},{key:"leftwards_arrow_with_hook",title:"leftwards arrow with hook",category:"symbols",css:"emoji_leftwards_arrow_with_hook"},{key:"arrow_right_hook",title:"rightwards arrow with hook",category:"symbols",css:"emoji_arrow_right_hook"},{key:"information_source",title:"information source",category:"symbols",css:"emoji_information_source"},{key:"rewind",title:"black left-pointing double triangle",category:"symbols",css:"emoji_rewind"},{key:"fast_forward",title:"black right-pointing double triangle",category:"symbols",css:"emoji_fast_forward"},{key:"arrow_double_up",title:"black up-pointing double triangle",category:"symbols",css:"emoji_arrow_double_up"},{key:"arrow_double_down",title:"black down-pointing double triangle",category:"symbols",css:"emoji_arrow_double_down"},{key:"arrow_heading_down",title:"arrow pointing rightwards then curving downwards",category:"symbols",css:"emoji_arrow_heading_down"},{key:"arrow_heading_up",title:"arrow pointing rightwards then curving upwards",category:"symbols",css:"emoji_arrow_heading_up"},{key:"ok",title:"squared ok",category:"symbols",css:"emoji_ok"},{key:"twisted_rightwards_arrows",title:"twisted rightwards arrows",category:"symbols",css:"emoji_twisted_rightwards_arrows"},{key:"repeat",title:"clockwise rightwards and leftwards open circle arrows",category:"symbols",css:"emoji_repeat"},{key:"repeat_one",title:"clockwise rightwards and leftwards open circle arrows with circled one overlay",category:"symbols",css:"emoji_repeat_one"},{key:"new",title:"squared new",category:"symbols",css:"emoji_new"},{key:"up",title:"squared up with exclamation mark",category:"symbols",css:"emoji_up"},{key:"cool",title:"squared cool",category:"symbols",css:"emoji_cool"},{key:"free",title:"squared free",category:"symbols",css:"emoji_free"},{key:"ng",title:"squared ng",category:"symbols",css:"emoji_ng"},{key:"signal_strength",title:"antenna with bars",category:"symbols",css:"emoji_signal_strength"},{key:"cinema",title:"cinema",category:"symbols",css:"emoji_cinema"},{key:"koko",title:"squared katakana koko",category:"symbols",css:"emoji_koko"},{key:"u6307",title:"squared cjk unified ideograph-6307",category:"symbols",css:"emoji_u6307"},{key:"u7a7a",title:"squared cjk unified ideograph-7a7a",category:"symbols",css:"emoji_u7a7a"},{key:"u6e80",title:"squared cjk unified ideograph-6e80",category:"symbols",css:"emoji_u6e80"},{key:"u5408",title:"squared cjk unified ideograph-5408",category:"symbols",css:"emoji_u5408"},{key:"u7981",title:"squared cjk unified ideograph-7981",category:"symbols",css:"emoji_u7981"},{key:"ideograph_advantage",title:"circled ideograph advantage",category:"symbols",css:"emoji_ideograph_advantage"},{key:"u5272",title:"squared cjk unified ideograph-5272",category:"symbols",css:"emoji_u5272"},{key:"u55b6",title:"squared cjk unified ideograph-55b6",category:"symbols",css:"emoji_u55b6"},{key:"u6709",title:"squared cjk unified ideograph-6709",category:"symbols",css:"emoji_u6709"},{key:"u7121",title:"squared cjk unified ideograph-7121",category:"symbols",css:"emoji_u7121"},{key:"restroom",title:"restroom",category:"symbols",css:"emoji_restroom"},{key:"mens",title:"mens symbol",category:"symbols",css:"emoji_mens"},{key:"womens",title:"womens symbol",category:"symbols",css:"emoji_womens"},{key:"baby_symbol",title:"baby symbol",category:"symbols",css:"emoji_baby_symbol"},{key:"wc",title:"water closet",category:"symbols",css:"emoji_wc"},{key:"potable_water",title:"potable water symbol",category:"symbols",css:"emoji_potable_water"},{key:"put_litter_in_its_place",title:"put litter in its place symbol",category:"symbols",css:"emoji_put_litter_in_its_place"},{key:"parking",title:"negative squared latin capital letter p",category:"symbols",css:"emoji_parking"},{key:"no_smoking",title:"no smoking symbol",category:"symbols",css:"emoji_no_smoking"},{key:"u6708",title:"squared cjk unified ideograph-6708",category:"symbols",css:"emoji_u6708"},{key:"u7533",title:"squared cjk unified ideograph-7533",category:"symbols",css:"emoji_u7533"},{key:"sa",title:"squared katakana sa",category:"symbols",css:"emoji_sa"},{key:"m",title:"circled latin capital letter m",category:"symbols",css:"emoji_m"},{key:"passport_control",title:"passport control",category:"symbols",css:"emoji_passport_control"},{key:"baggage_claim",title:"baggage claim",category:"symbols",css:"emoji_baggage_claim"},{key:"left_luggage",title:"left luggage",category:"symbols",css:"emoji_left_luggage"},{key:"customs",title:"customs",category:"symbols",css:"emoji_customs"},{key:"accept",title:"circled ideograph accept",category:"symbols",css:"emoji_accept"},{key:"secret",title:"circled ideograph secret",category:"symbols",css:"emoji_secret"},{key:"congratulations",title:"circled ideograph congratulation",category:"symbols",css:"emoji_congratulations"},{key:"cl",title:"squared cl",category:"symbols",css:"emoji_cl"},{key:"sos",title:"squared sos",category:"symbols",css:"emoji_sos"},{key:"id",title:"squared id",category:"symbols",css:"emoji_id"},{key:"no_entry_sign",title:"no entry sign",category:"symbols",css:"emoji_no_entry_sign"},{key:"underage",title:"no one under eighteen symbol",category:"symbols",css:"emoji_underage"},{key:"no_mobile_phones",title:"no mobile phones",category:"symbols",css:"emoji_no_mobile_phones"},{key:"do_not_litter",title:"do not litter symbol",category:"symbols",css:"emoji_do_not_litter"},{key:"non-potable_water",title:"non-potable water symbol",category:"symbols",css:"emoji_non-potable_water"},{key:"no_bicycles",title:"no bicycles",category:"symbols",css:"emoji_no_bicycles"},{key:"no_pedestrians",title:"no pedestrians",category:"symbols",css:"emoji_no_pedestrians"},{key:"children_crossing",title:"children crossing",category:"symbols",css:"emoji_children_crossing"},{key:"no_entry",title:"no entry",category:"symbols",css:"emoji_no_entry"},{key:"eight_spoked_asterisk",title:"eight spoked asterisk",category:"symbols",css:"emoji_eight_spoked_asterisk"},{key:"sparkle",title:"sparkle",category:"symbols",css:"emoji_sparkle"},{key:"negative_squared_cross_mark",title:"negative squared cross mark",category:"symbols",css:"emoji_negative_squared_cross_mark"},{key:"white_check_mark",title:"white heavy check mark",category:"symbols",css:"emoji_white_check_mark"},{key:"eight_pointed_black_star",title:"eight pointed black star",category:"symbols",css:"emoji_eight_pointed_black_star"},{key:"heart_decoration",title:"heart decoration",category:"symbols",css:"emoji_heart_decoration"},{key:"vs",title:"squared vs",category:"symbols",css:"emoji_vs"},{key:"vibration_mode",title:"vibration mode",category:"symbols",css:"emoji_vibration_mode"},{key:"mobile_phone_off",title:"mobile phone off",category:"symbols",css:"emoji_mobile_phone_off"},{key:"a",title:"negative squared latin capital letter a",category:"symbols",css:"emoji_a"},{key:"b",title:"negative squared latin capital letter b",category:"symbols",css:"emoji_b"},{key:"ab",title:"negative squared ab",category:"symbols",css:"emoji_ab"},{key:"o2",title:"negative squared latin capital letter o",category:"symbols",css:"emoji_o2"},{key:"diamond_shape_with_a_dot_inside",title:"diamond shape with a dot inside",category:"symbols",css:"emoji_diamond_shape_with_a_dot_inside"},{key:"loop",title:"double curly loop",category:"symbols",css:"emoji_loop"},{key:"recycle",title:"black universal recycling symbol",category:"symbols",css:"emoji_recycle"},{key:"aries",title:"aries",category:"symbols",css:"emoji_aries"},{key:"taurus",title:"taurus",category:"symbols",css:"emoji_taurus"},{key:"gemini",title:"gemini",category:"symbols",css:"emoji_gemini"},{key:"cancer",title:"cancer",category:"symbols",css:"emoji_cancer"},{key:"leo",title:"leo",category:"symbols",css:"emoji_leo"},{key:"virgo",title:"virgo",category:"symbols",css:"emoji_virgo"},{key:"libra",title:"libra",category:"symbols",css:"emoji_libra"},{key:"scorpius",title:"scorpius",category:"symbols",css:"emoji_scorpius"},{key:"sagittarius",title:"sagittarius",category:"symbols",css:"emoji_sagittarius"},{key:"capricorn",title:"capricorn",category:"symbols",css:"emoji_capricorn"},{key:"aquarius",title:"aquarius",category:"symbols",css:"emoji_aquarius"},{key:"pisces",title:"pisces",category:"symbols",css:"emoji_pisces"},{key:"ophiuchus",title:"ophiuchus",category:"symbols",css:"emoji_ophiuchus"},{key:"six_pointed_star",title:"six pointed star with middle dot",category:"symbols",css:"emoji_six_pointed_star"},{key:"atm",title:"automated teller machine",category:"symbols",css:"emoji_atm"},{key:"chart",title:"chart with upwards trend and yen sign",category:"symbols",css:"emoji_chart"},{key:"arrow_backward",title:"black left-pointing triangle",category:"symbols",css:"emoji_arrow_backward"},{key:"heavy_dollar_sign",title:"heavy dollar sign",category:"symbols",css:"emoji_heavy_dollar_sign"},{key:"arrow_forward",title:"black right-pointing triangle",category:"symbols",css:"emoji_arrow_forward"},{key:"currency_exchange",title:"currency exchange",category:"symbols",css:"emoji_currency_exchange"},{key:"copyright",title:"copyright sign",category:"symbols",css:"emoji_copyright"},{key:"registered",title:"registered sign",category:"symbols",css:"emoji_registered"},{key:"tm",title:"trade mark sign",category:"symbols",css:"emoji_tm"},{key:"x",title:"cross mark",category:"symbols",css:"emoji_x"},{key:"bangbang",title:"double exclamation mark",category:"symbols",css:"emoji_bangbang"},{key:"interrobang",title:"exclamation question mark",category:"symbols",css:"emoji_interrobang"},{key:"exclamation",title:"heavy exclamation mark symbol",category:"symbols",css:"emoji_exclamation"},{key:"question",title:"black question mark ornament",category:"symbols",css:"emoji_question"},{key:"grey_exclamation",title:"white exclamation mark ornament",category:"symbols",css:"emoji_grey_exclamation"},{key:"grey_question",title:"white question mark ornament",category:"symbols",css:"emoji_grey_question"},{key:"o",title:"heavy large circle",category:"symbols",css:"emoji_o"},{key:"top",
title:"top with upwards arrow above",category:"symbols",css:"emoji_top"},{key:"end",title:"end with leftwards arrow above",category:"symbols",css:"emoji_end"},{key:"back",title:"back with leftwards arrow above",category:"symbols",css:"emoji_back"},{key:"on",title:"on with exclamation mark with left right arrow above",category:"symbols",css:"emoji_on"},{key:"soon",title:"soon with rightwards arrow above",category:"symbols",css:"emoji_soon"},{key:"arrows_clockwise",title:"clockwise downwards and upwards open circle arrows",category:"symbols",css:"emoji_arrows_clockwise"},{key:"clock12",title:"clock face twelve oclock",category:"symbols",css:"emoji_clock12"},{key:"clock1230",title:"clock face twelve-thirty",category:"symbols",css:"emoji_clock1230"},{key:"clock1",title:"clock face one oclock",category:"symbols",css:"emoji_clock1"},{key:"clock130",title:"clock face one-thirty",category:"symbols",css:"emoji_clock130"},{key:"clock2",title:"clock face two oclock",category:"symbols",css:"emoji_clock2"},{key:"clock230",title:"clock face two-thirty",category:"symbols",css:"emoji_clock230"},{key:"clock3",title:"clock face three oclock",category:"symbols",css:"emoji_clock3"},{key:"clock330",title:"clock face three-thirty",category:"symbols",css:"emoji_clock330"},{key:"clock4",title:"clock face four oclock",category:"symbols",css:"emoji_clock4"},{key:"clock430",title:"clock face four-thirty",category:"symbols",css:"emoji_clock430"},{key:"clock5",title:"clock face five oclock",category:"symbols",css:"emoji_clock5"},{key:"clock530",title:"clock face five-thirty",category:"symbols",css:"emoji_clock530"},{key:"clock6",title:"clock face six oclock",category:"symbols",css:"emoji_clock6"},{key:"clock630",title:"clock face six-thirty",category:"symbols",css:"emoji_clock630"},{key:"clock7",title:"clock face seven oclock",category:"symbols",css:"emoji_clock7"},{key:"clock730",title:"clock face seven-thirty",category:"symbols",css:"emoji_clock730"},{key:"clock8",title:"clock face eight oclock",category:"symbols",css:"emoji_clock8"},{key:"clock830",title:"clock face eight-thirty",category:"symbols",css:"emoji_clock830"},{key:"clock9",title:"clock face nine oclock",category:"symbols",css:"emoji_clock9"},{key:"clock930",title:"clock face nine-thirty",category:"symbols",css:"emoji_clock930"},{key:"clock10",title:"clock face ten oclock",category:"symbols",css:"emoji_clock10"},{key:"clock1030",title:"clock face ten-thirty",category:"symbols",css:"emoji_clock1030"},{key:"clock11",title:"clock face eleven oclock",category:"symbols",css:"emoji_clock11"},{key:"clock1130",title:"clock face eleven-thirty",category:"symbols",css:"emoji_clock1130"},{key:"wheelchair",title:"wheelchair symbol",category:"symbols",css:"emoji_wheelchair"},{key:"heavy_multiplication_x",title:"heavy multiplication x",category:"symbols",css:"emoji_heavy_multiplication_x"},{key:"heavy_plus_sign",title:"heavy plus sign",category:"symbols",css:"emoji_heavy_plus_sign"},{key:"heavy_minus_sign",title:"heavy minus sign",category:"symbols",css:"emoji_heavy_minus_sign"},{key:"heavy_division_sign",title:"heavy division sign",category:"symbols",css:"emoji_heavy_division_sign"},{key:"spades",title:"black spade suit",category:"symbols",css:"emoji_spades"},{key:"hearts",title:"black heart suit",category:"symbols",css:"emoji_hearts"},{key:"clubs",title:"black club suit",category:"symbols",css:"emoji_clubs"},{key:"diamonds",title:"black diamond suit",category:"symbols",css:"emoji_diamonds"},{key:"white_flower",title:"white flower",category:"symbols",css:"emoji_white_flower"},{key:"100",title:"hundred points symbol",category:"symbols",css:"emoji_100"},{key:"heavy_check_mark",title:"heavy check mark",category:"symbols",css:"emoji_heavy_check_mark"},{key:"ballot_box_with_check",title:"ballot box with check",category:"symbols",css:"emoji_ballot_box_with_check"},{key:"radio_button",title:"radio button",category:"symbols",css:"emoji_radio_button"},{key:"link",title:"link symbol",category:"symbols",css:"emoji_link"},{key:"curly_loop",title:"curly loop",category:"symbols",css:"emoji_curly_loop"},{key:"wavy_dash",title:"wavy dash",category:"symbols",css:"emoji_wavy_dash"},{key:"part_alternation_mark",title:"part alternation mark",category:"symbols",css:"emoji_part_alternation_mark"},{key:"trident",title:"trident emblem",category:"symbols",css:"emoji_trident"},{key:"black_medium_small_square",title:"black medium small square",category:"symbols",css:"emoji_black_medium_small_square"},{key:"white_medium_small_square",title:"white medium small square",category:"symbols",css:"emoji_white_medium_small_square"},{key:"black_medium_square",title:"black medium square",category:"symbols",css:"emoji_black_medium_square"},{key:"white_medium_square",title:"white medium square",category:"symbols",css:"emoji_white_medium_square"},{key:"black_small_square",title:"black small square",category:"symbols",css:"emoji_black_small_square"},{key:"white_small_square",title:"white small square",category:"symbols",css:"emoji_white_small_square"},{key:"small_red_triangle",title:"up-pointing red triangle",category:"symbols",css:"emoji_small_red_triangle"},{key:"black_square_button",title:"black square button",category:"symbols",css:"emoji_black_square_button"},{key:"white_square_button",title:"white square button",category:"symbols",css:"emoji_white_square_button"},{key:"black_circle",title:"medium black circle",category:"symbols",css:"emoji_black_circle"},{key:"white_circle",title:"medium white circle",category:"symbols",css:"emoji_white_circle"},{key:"red_circle",title:"large red circle",category:"symbols",css:"emoji_red_circle"},{key:"large_blue_circle",title:"large blue circle",category:"symbols",css:"emoji_large_blue_circle"},{key:"small_red_triangle_down",title:"down-pointing red triangle",category:"symbols",css:"emoji_small_red_triangle_down"},{key:"white_large_square",title:"white large square",category:"symbols",css:"emoji_white_large_square"},{key:"black_large_square",title:"black large square",category:"symbols",css:"emoji_black_large_square"},{key:"large_orange_diamond",title:"large orange diamond",category:"symbols",css:"emoji_large_orange_diamond"},{key:"large_blue_diamond",title:"large blue diamond",category:"symbols",css:"emoji_large_blue_diamond"},{key:"small_orange_diamond",title:"small orange diamond",category:"symbols",css:"emoji_small_orange_diamond"},{key:"small_blue_diamond",title:"small blue diamond",category:"symbols",css:"emoji_small_blue_diamond"}]}function n(){return s=[{key:"people",title:t("emojiCatPeople"),css:"emojiCatPeople"},{key:"nature",title:t("emojiCatNature"),css:"emojiCatNature"},{key:"objects",title:t("emojiCatObjects"),css:"emojiCatObjects"},{key:"places",title:t("emojiCatPlaces"),css:"emojiCatPlaces"},{key:"symbols",title:t("emojiCatSymbols"),css:"emojiCatSymbols"}]}function i(){return l={},Emoticons.getDefs().forEach(function(e){e.category||(e.category="symbols"),l[e.category]||(l[e.category]=[]),l[e.category].push(e)}),l}function o(){return c={},Emoticons.getDefs().forEach(function(e){c[e.key]=e}),c}function r(){var e=[];return Emoticons.getDefs().forEach(function(t){e.push(t.key)}),e}var a,s,l,c,d;Emoticons.getDefs=function(){return a||e()},Emoticons.getDefsByKey=function(){return c||o()},Emoticons.getCategories=function(){return s||n()},Emoticons.getByCategory=function(){return l||i()},Emoticons.getKeys=function(){return d||r()}}(),function(){Controller=Controller||{},Controller.FraudReports=Controller.FraudReports||{},Controller.FraudReports.addOnTdClick=function(){var e=$("#fraud-reports-grid td").not(".button-column").not(':has("select")');e.not(':has("input")').off("click").on("click",function(){var e=$(this).find("a").attr("href");e?window.open(e,"_blank"):window.open($(this).closest("tr").attr("data"),"_blank")})},Controller.FraudReports.addOnGameCheckboxClick=function(){var e=$(".batchGame");e.off("click").on("click",function(){var e=$(this).attr("batchId"),t=$(this).attr("gameToken");jQuery.post("/api/web/fraudAPI/gameViewed",{batchId:e,gameToken:t,checked:this.checked,csrf:config.csrf()},function(n){0!==n.status&&errorHandler.warning("Error saving game viewed ",{batchId:e,gameToken:t})})})}}(),jQuery(function(){function e(e){e.removeClass("error");var t=e.parent().parent().find(".btnAddTournament");t.removeClass("disabled"),t.hasClass("cIconBlocked")&&(t.removeClass("cIconBlocked"),t.addClass("cIconAdd"))}function t(){if($(this).hasClass("disabled"))return!1;var e=$(this).attr("data-server");Dialog.createFTPUser(e)}function n(e){if(!e.prop("disabled")){var t=e.val().trim();if(!/^[\/home\/|\.\/json\/][a-zA-Z0-9-_\/]{3,}\.json$/.test(t))return void e.addClass("error");var n=e.parent().parent(),i=n.attr("data-server");e.prop("disabled",!0);var a=n.find(".btnAddTournament");a.addClass("disabled"),a.removeClass("cIconAdd"),a.addClass("cIconLoading"),$.post("/api/web/BroadcastConfigurationAPI/addTournament",{csrf:config.csrf(),tournamentConfigFile:t,server:i}).done(function(){a.removeClass("cIconLoading"),a.addClass("cIconOK");var s=new Handler.Template("broadcastConfig"),l=jQuery(s.render("importTournament",{server:i,configFile:t,label:t}));n.before(l),l.find(".btnRemoveTournament").click(function(){o(l)}),l.find(".btnReaddTournament").click(function(){r(l)}),setTimeout(function(){a.removeClass("cIconOK"),a.addClass("cIconAdd"),e.val(""),a.removeClass("disabled"),e.prop("disabled",!1)},1e3)}).fail(function(t){a.removeClass("cIconLoading"),a.addClass("cIconBlocked"),e.addClass("error"),e.prop("disabled",!1)})}}function i(e,t,n){13==e.which&&(e.stopPropagation(),n(t))}function o(e){var t=e.attr("data-server"),n=e.attr("data-config-file"),i=e.find(".btnRemoveTournament");i.removeClass("cIconDelete"),i.addClass("cIconLoading"),i.addClass("disabled");var o=e.find(".btnReaddTournament");o.addClass("disabled"),$.post("/api/web/BroadcastConfigurationAPI/removeTournament",{csrf:config.csrf(),tournamentConfigFile:n,server:t}).done(function(){i.removeClass("cIconLoading"),i.addClass("cIconOK"),setTimeout(function(){e.remove()},1e3)}).fail(function(e){i.removeClass("cIconLoading"),i.addClass("cIconBlocked"),setTimeout(function(){i.removeClass("cIconBlocked"),i.addClass("cIconDelete"),i.removeClass("disabled"),o.removeClass("disabled")},1e3)})}function r(e){var t=e.attr("data-server"),n=e.attr("data-config-file"),i=e.find(".btnReaddTournament");i.removeClass("cIconReload"),i.addClass("cIconLoading"),i.addClass("disabled");var o=e.find(".btnRemoveTournament");o.addClass("disabled"),$.post("/api/web/BroadcastConfigurationAPI/readdTournament",{csrf:config.csrf(),tournamentConfigFile:n,server:t}).done(function(){i.removeClass("cIconLoading"),i.addClass("cIconOK"),setTimeout(function(){i.removeClass("cIconOK"),i.addClass("cIconReload"),i.removeClass("disabled"),o.removeClass("disabled")},1e3)}).fail(function(e){i.removeClass("cIconLoading"),i.addClass("cIconBlocked"),setTimeout(function(){i.removeClass("cIconBlocked"),i.addClass("cIconReload"),i.removeClass("disabled"),o.removeClass("disabled")},1e3)})}$container=$(".importTournaments"),$container.find(".btnCreateFTPUser").click(t),setTimeout(function(){$container.find(".btnAddTournament").fadeIn(150)},1e3),$container.find(".btnRemoveTournament").click(function(){o($(this).parent().parent())}),$container.find(".btnReaddTournament").click(function(){r($(this).parent().parent())}),$container.find(".btnAddTournament").click(function(){n($(this).parent().find("input.textAddTournament"))});var a="";$container.find("[data-auto-suggest]").on("chess24:select",function(){var t=$(this).parent().find("input.textAddTournament");a!==t.val()&&(e(t),a=t.val())}),$container.find("input.textAddTournament").keyup(function(t){var o=$(this);e(o),i(t,o,n)})}),"undefined"==typeof Controller&&(Controller={}),Controller.Broadcast=function(e,n){function i(){jQuery("div.modalOverlay.loader").hide(),jQuery("div.modalOverlay.error").show()}function o(e){he=e,s(e)}function r(e){var t=e.find("input.searchTournamentOrPlayer"),n=e.find("a.searchTournamentOrPlayer");t.on("keydown",function(e){e.keyCode===Handler.Keyboard.keys.VK_RETURN&&a(t.val())}),t.on("input",function(){n.toggle($(this).val().trim().length>0)}),n.on("click",function(){a(t.val())})}function a(e){e.length>0?jQuery.getJSON("/api/web/broadcastAPI/searchTournaments",{q:e}).done(function(e){var t=e.data&&e.data.tournaments;t.length>0&&(ge=[],ce.empty(),s(t))}):(ge=[],ce.empty(),s(he))}function s(e){if("dual"===se)return void p(e);for(var t=0;t<e.length;t++)ge.push(function(e){return function(t){c(e,!1,function(){setTimeout(t)})}}(e[t]));if(ae){layout(N);var i=V.startWith;if(i)if(re[i])ae(re[i]);else{var o="model:"+J+Y,r=o+":"+i,a={rkey:r};re[i]="connecting";var s=new Record.TournamentSocketPR(a,D,function(){"object"!=typeof re[i]&&(re[i]=s,Z.add(s,i)),ae(s)});n&&n.overrides&&s.setOverrides(n.overrides)}}u()}function l(e){return c(e,!0)}function c(e,t,i){function o(){return d(e,r)?("object"!=typeof re[e]&&(re[e]=r,Z.add(r,e)),t?h(r,e,!0):(h(r,e),ae&&ae(r)),void(i&&i())):(r.unsubscribe(),delete re[e],void(i&&i()))}if(V&&V.blackList&&V.blackList.contains(e)||V&&V.whiteList&&!V.whiteList.contains(e))return void i();var r;if(re[e])return void function c(){re[e]instanceof Record.TournamentSocketPR?(r=re[e],setTimeout(o)):setTimeout(c,5)}();var a="model:"+J+Y,s=a+":"+e,l={rkey:s};r=new Record.TournamentSocketPR(l,D,o),n&&n.overrides&&r.setOverrides(n.overrides),re[e]="connecting"}function d(e,t){var n=!!t.get("c24");if(W!==n)return!1;if(n){var i=t.get("private");if(i&&(!V.exactList||!V.exactList.contains(e)))return!1;var o=t.get("enrollingFrom"),r=t.get("rounds");if(r[1]&&r[1].startDate-o>Date.now()&&(!V.exactList||!V.exactList.contains(e)))return!1}return!0}function u(){u.already?jQuery(window).trigger("scroll"):(u.already=!0,ce.lazyload({distance:300,onstart:function(e){var t=ge.shift();"function"==typeof t?t(function(){e(!0)}):(e(!1),u.already=!1)}}))}function h(e,t,o){var r=e.get("currentRound"),a=U||r,s=!!e.get("c24"),l=(e.get("video")||[]).map(function(e){return e.language}).unique();if("multiBoardOnly"===se){a=n.roundId||a;var c=new View.MultiBoard(ce,t,a,1);return c.resume(),layout(N),void jQuery("div.modalOverlay.loader").hide()}var d=X.render("tournament.main",{tournamentId:t,languages:l,playzone:s});o?ce.prepend(d):ce.append(d);var u=N.find("div.tournamentId"+t),h=[],p=u.find(".tournamentHeader");p.length&&h.push(new View.Header(p,t,a).setTournamentUrl(L.getGameUrl(t,a,1,1)).link(Z));var f=u.find(s?".playzoneTournament":".tournamentIntro .colInsider p");f.length&&h.push(new View.Intro(f,t).link(Z));var g=u.find(".specialTournamentTitle");g.length&&h.push(new View.TournamentAttribute(g.find("h3"),t,{attribute:"headline",action:"content",hideOnEmpty:g}));var m=u.find(".specialTournamentDescription");m.length&&h.push(new View.TournamentAttribute(m,t,{attribute:"prizes",action:"content",hideOnEmpty:!0})),h.push(new View.TournamentAttribute(u,t,{attribute:"classname",action:"classname"})),h.push(new View.TournamentAttribute(u,t,{attribute:"headline",action:"toggleClass",classname:"specialTournament"})),h.push(new View.TournamentAttribute(u,t,{attribute:"featured",action:"toggleClass",classname:"featuredTournament"})),s&&h.push(new View.TournamentAttribute(u,t,{attribute:"enrollingFrom",action:"toggleClass",classname:"pending",predicate:function(){var t=e.get("enrollingFrom"),n=e.get("rounds");return n[1]&&n[1].startDate-t>Date.now()}}));var v=e.get("eventType"),y=u.find(".tournamentDataContainer"),w="div.tournamentId"+t+" .tournamentDataContainer";switch(v){case"knockout":y.addClass("tournamentKnockoutTree"),y.length&&h.push(new View.KnockoutTreeGroup(y,w,t,a).link(Z));break;case"teamRoundRobin":y.length&&y.addClass("tournamentTeamRoundRobin"),h.push(new View.TeamRoundRobin(y,t,a));break;case"open":u.append(X.render("open.main"));var b=u.find(".tournamentStandings"),C=u.find(".tournamentOngoingGames");C.length&&h.push(new View.OpenGames(C,t,a,!0).link(Z)),b.length&&h.push(new View.OpenStandings(b,t,a).link(Z));break;case"bunchOfGames":default:u.append(X.render("bunchOfGames.main")),C=u.find(".tournamentOngoingGames"),h.push(new View.OpenGames(C,t,a,!0).link(Z))}"single"==se?(h.forEach(function(e){e.resume()}),N.suspendResume(h)):N.find("#tabTournaments").suspendResume(h),layout(N),jQuery("div.modalOverlay.loader").hide(),D.off("error",i),D.off("connect_failed",i)}function p(e){var t,i;e.forEach(function(e){if(e===pe.id1){var o="model:"+J+Y,r=o+":"+e,a={rkey:r};re[e]="connecting";var s=new Record.TournamentSocketPR(a,D,function(){var n=!!s.get("c24");W===n&&(re[e]=s,Z.add(s,e),e===pe.id1?t=s:i=s,g(t,i,pe.id1,pe.id2),ae&&ae(s))});n&&n.overrides&&s.setOverrides(n.overrides)}})}function f(e,t){if(e===pe.id2&&!re[e]){var i="model:"+J+Y,o=i+":"+e,r={rkey:o};re[e]="connecting";var a=new Record.TournamentSocketPR(r,D,function(){re[e]=a,Z.add(a,e),t()});n&&n.overrides&&a.setOverrides(n.overrides)}}function g(e,t,n,i){var o=e.get("currentRound"),r=U||o,a=[],s=e.get("video")||t&&t.get("video");if(s)for(var l in s)l=l.split("-")[0],a.contains(l)||a.push(l);var c=[L.getGameUrl(n,o,1,1),L.getGameUrl(i,o,1,1)],d=X.render("tournament.dualMain",{tournamentId:n,languages:a,tournamentUrl:c[0]});N.prepend(d);var u=N.find("div.tournamentId"+n);u.find(".tournamentLiveStream a").on("click",function(e){return L.showGame(n,o),!1});var h,p=[u.find(".tournamentHeader:eq(0)"),u.find(".tournamentHeader:eq(1)").hide()],g=new View.Header(p[0],n,r).setTournamentUrl(c[0]).link(Z),m=u.find(".tournamentIntro .colInsider p"),v=new View.Intro(m,n).link(Z),y=u.find(".tournamentDataContainer"),w=new View.Dual(Z,y,n,i,r,f,"olympiad2014women"===n);w.on("switch",function(e,t){var n=(t+1)%2;if(p[t].show(),p[n].hide(),!h&&1===t){p[1].replaceWith(X.render("tournament.header",{tournamentId:i,languages:a,tournamentUrl:c[1]})),p[1]=u.find(".tournamentHeader:eq(1)");var o=new View.Header(u.find(".tournamentHeader:eq(1)"),i,r).setTournamentUrl(c[1]).link(Z);N.suspendResume(o),h=!0}}),[n,i].contains(V.startWith)&&w.showTournament(V.startWith),N.suspendResume(g,v,w),layout(N),jQuery("div.modalOverlay.loader").hide()}function m(e){return be[e]||(be[e]=function(){C(e)})}function v(e,t,n){var i=e.get("rounds")[t];if(i)for(var o in i.matches){var r=i.matches[o];if(r.games[n])return o}}function y(e,n,i,o,r,a){var s=Z.getRounds(e),l=s[n],c=l.matches[i].games[o];if(!c||!c.server){var d=!0;c={player:{},gameSessionToken:""}}w(e,n,i,o);var u=Z.getTitle(e),h=Controller.getPlayZone(),p="s";c.player.white==config.user().uuid?p="w":c.player.black==config.user().uuid&&(p="b"),void 0!==Q[e]&&x(e)||(Q[e]=T(N,e,u));var f=Q[e].tab.content;if(Q[e].isNewlyCreated){if("knockout"===r)var g=t("Knockout Tree");else"teamRoundRobin"===r?g=t("Round Table"):"open"===r&&(g=t("Tournament"));h.resetLayout(),f.html(X.render("game.playzone",{tournamentTabTitle:g,separate:!!le,separateUrl:N.data("list-url"),showTabTournamentStandings:Object.getLength(Object.without(Z.getAttribute(e,"players"),"unknown"))<=View.StandingsTable.MAX_PLAYERS}));var m=f.find(".tabTournamentGames").attr("id","tabTournamentGamesShared"),v=f.find(".tabMultiboard").attr("id","tabMultiboardShared"),y=f.find(".tabTournamentStandings").attr("id","tabTournamentStandingsShared"),b=f.find(".tabInformation").attr("id","tabInformationShared"),C=f.find(".tabPgn").attr("id","tabPgnShared");if("teamRoundRobin"===r){var F=new View.TeamRoundRobin(m,e,n);m.suspendResume(F)}else if("open"===r){m.append(X.render("open.main"));var _=m.find(".tournamentStandings"),E=m.find(".tournamentOngoingGames"),S=new View.OpenGames(E,e,void 0,!0).link(Z),j=new View.OpenStandings(_,e).link(Z);m.suspendResume(S,j)}if(L.snapshotsAvailable(e)){var I=new View.MultiBoard(v,e,n,i,k(e));I.setCurrentGame(i,o),v.suspendResume(I),Q[e].matchViews.push(I)}else v.remove();if(y.length){var A=new View.StandingsTable(y,e).link(Z);y.suspendResume(A)}if(b.length){var O=new View.TournamentInformation(b,e,n);b.suspendResume(O)}if(C.length){var M=new View.PgnDownload(C,e,n,i,o);C.suspendResume(M)}if(le){var P=f.find(".returnToOverview a");P.data("view",new View.OverviewButton(P,e,n,i,o))}Q[e].isNewlyCreated=!1,layout(f)}else{C=f.find("section.tabPgn").data("view").changeGame(e,n,i,o);for(var B in Q[e].matchViews)Q[e].matchViews[B]instanceof View.MultiBoard&&Q[e].matchViews[B].setCurrentRound(n,i).setCurrentGame(i,o);var P=f.find(".returnToOverview a"),R=P.data("view");R&&R.switchGame(e,n,i,o)}Q[e].tab.nav.find("> *").first().click(),le&&(f.suspendResume(h),f.show().trigger("chess24:show"),N.hide().trigger("chess24:hide")),Controller.getPlayingServer(c.gameSessionToken).done(function(t){h.initGameSession({broadcast:!0,gameSessionToken:c.gameSessionToken,authToken:config.user().authToken,mode:d?"standby":"human",role:p,clock:parseInt(l.timeControl.base,10)/1e3,increment:parseInt(l.timeControl.incrementPerMove,10)/1e3,playingServer:d?{}:{host:t.host,port:t.port},container:Q[e].tab.content.find(".playzoneTournamentGame"),tournamentUuid:e,url:a})}).fail(function(e){errorHandler.error(e)})}function w(e,t,n,i){for(var o in re)if(re[o]instanceof Record.TournamentSocketPR){var r=Z.findPlayersGame(o,config.user().uuid);r&&r.gameId&&(e==o&&t==r.roundId&&n==r.matchId&&i==r.gameId?notificationHandler.emit("channel:gameSession:add:self",{}):notificationHandler.emit("playzone_tournament",{content:{action:"playing",tournamentId:o,roundId:r.roundId,matchId:r.matchId,gameId:r.gameId}}))}I(e?{title:Z.getTitle(e),round:t,game:i}:!0)}function b(e,n,i,o,r){var a={},s={};if("dual"===se){if(!Q[e]){var l=e===pe.id1?pe.id2:pe.id1;Q[l]&&(Q[e]=Q[l])}}else if("single"===se&&!Q[e])for(var l in Q){Q[e]=Q[l];break}void 0===Q[e]&&(Q[e]=T(N,e),jQuery("html, body").animate({scrollTop:0},"fast")),jQuery("div.modalOverlay.loader").show();var c=Q[e].tab.content;if(c.data("embed-url",L.getEmbedUrl(e,n,i,o)),Q[e].isNewlyCreated){switch(r){case"knockout":var d=t("Knockout Tree");break;case"teamRoundRobin":d=t("Round Table");break;case"open":case"bunchOfGames":default:d=t("Tournament")}var u="main";if(q&&(u="embeds."+q),c.html(jQuery(X.render("game."+u+$redesignSuffix,{tournamentTabTitle:d,showTabTournamentGames:!fe,isKnockout:"knockout"===r,headless:te,showTabTournamentCrossTable:!fe&&"open"===r&&Object.getLength(Object.without(Z.getAttribute(e,"players"),"unknown"))<=View.StandingsTable.MAX_PLAYERS,showTabTournamentStandings:!fe&&"teamRoundRobin"===r,separate:!!le,betting:!config.level().isGuest&&!!Z.getAttribute(e,"betting")}))),a.chessGame=c.find(".gameInsider .chessGame"),a.chessGameLeft=a.chessGame.children(".left"),a.chessGameRight=a.chessGame.children(".right"),a.chessGameLeftTop=a.chessGameLeft.children(".top"),a.chessGameLeftBottom=a.chessGameLeft.children(".bottom"),a.chessBoardInsider=a.chessGameLeft.children(".chessBoardInsider"),a.chessGameLeftLeft=a.chessBoardInsider.children(".left"),a.chessGameLeftRight=a.chessBoardInsider.children(".right"),a.chessGameRightTop=a.chessGameRight.children(".top"),a.chessGameRightBottom=a.chessGameRight.children(".bottom"),a.chessBoard=a.chessBoardInsider.children(".chessBoard"),a.engineLines=c.find(".engineLines"),a.playerInfoTop=a.chessGameLeftTop.children(".playerInfo"),a.playerInfoBottom=a.chessGameLeftBottom.children(".playerInfo"),a.evalIndicator=a.chessGame.find(".evalIndicator"),a.evalIndicatorTooltip=a.chessGame.find(".evalindicatorTooltip").children("span"),a.clockTop=a.chessGameLeftRight.find(".clocks .top"),a.clockBottom=a.chessGameLeftRight.find(".clocks .bottom"),a.userMoveMode=a.chessGameLeftRight.children(".userMoveMode"),$embedCCT&&(a.userMoveMode=a.chessGameLeftBottom.children(".userMoveMode")),a.flipBoard=a.chessGameLeftBottom.find(".burgerMenu .flipBoard"),a.settings=a.chessGameLeftBottom.find(".burgerMenu .settings"),a.playPosition=a.chessGameLeftBottom.find(".burgerMenu .playPosition"),a.cursor=a.chessGameLeftBottom.find(".cursor"),a.gameSlidingTabs=a.chessGameRight.find(".gameSlidingTabs"),a.notationTable=a.chessGameRight.find(".notationTable"),($embedCCT||$mainBroadcast)&&R(),a.video=a.chessGame.find(".top .video"),a.navigation=a.chessGame.find(".navigation"),a.navigation.length||(a.navigation=N.find(".externalRoundNavigation")),a.autoPlayButton=a.chessGameLeftBottom.find(".btnAutoPlay"),a.engineToggleButton=a.chessGameLeftBottom.find(".btnEngineToggle"),a.tabGamesEngine=c.find(".tabGamesEngine").attr("id","tabGamesEngine"+e),a.tabDatabaseMoves=c.find(".tabDatabaseMoves").attr("id","tabDatabaseMoves"+e),a.tabDatabaseGames=c.find(".tabDatabaseGames").attr("id","tabDatabaseGames"+e),a.tabTournamentGames=c.find(".tabTournamentGames").attr("id","tabTournamentGames"+e),a.tabTournamentStandings=c.find(".tabTournamentStandings").attr("id","tabTournamentStandings"+e),a.tabMultiboard=c.find(".tabMultiboard").attr("id","tabMultiboard"+e),a.tabPgn=c.find(".tabPgn").attr("id","tabPgn"+e),a.tabInformation=c.find(".tabInformation").attr("id","tabInformation"+e),a.tabBetting=c.find(".tabBetting").attr("id","tabBetting"+e),s.soundView=new View.Sound("broadcast").link(ee[e]),s.broadcastPageTitle=new View.BroadcastPageTitle(e).link(ee[e]),a.gameSlidingTabs.length?s.tournamentChat=new View.ChatTournament(a.gameSlidingTabs,e,z).link(ee[e]):a.notationTable.length&&(s.notationTable=new View.NotationArea(a.notationTable,"broadcast").link(ee[e])),a.chessBoard.length&&(q&&["condensed"].contains(q)?(s.chessBoard=new View.ChessBoard(a.chessBoard,!1).link(ee[e]),s.boardLink=new View.BoardLink(a.chessBoard,e)):(s.chessBoard=new View.ChessBoard(a.chessBoard,!0).link(ee[e]),s.chessBoard.movementHandler.setPremove(!1))),a.engineLines.length&&(s.engineLines=new View.Engine(a.engineLines).link(ee[e])),a.playerInfoTop.length&&(s.playerInfoTop=new View.PlayerInfo(a.playerInfoTop,"b",void 0,e).link(ee[e])),a.playerInfoBottom.length&&(s.playerInfoBottom=new View.PlayerInfo(a.playerInfoBottom,"w",void 0,e).link(ee[e])),$redesign||(a.clockTop.length&&(s.clockTop=new View.ChessClock(a.clockTop,"b").link(ee[e])),a.clockBottom.length&&(s.clockBottom=new View.ChessClock(a.clockBottom,"w").link(ee[e]))),a.cursor.length){var h=!1;($redesign||$embedCCT)&&(h=!0),s.cursor=new View.Cursor(a.cursor,!1,void 0,!0,h).link(ee[e])}a.evalIndicator.length&&(s.evalIndicator=new View.EvalIndicator(a.evalIndicator,a.evalIndicatorTooltip).link(ee[e])),a.userMoveMode.length&&(s.userMoveMode=new View.UserMoveMode(a.userMoveMode,"right").link(ee[e])),a.flipBoard.length&&(s.flipBoard=new View.FlipBoard(a.flipBoard).link(ee[e])),a.navigation.length&&(s.navigation=new View.RoundNavigation(a.navigation,e,n,i,o)),a.autoPlayButton.length&&(s.autoPlay=new View.AutoPlay(a.autoPlayButton),s.autoPlay.link(ee[e]).link(s.chessBoard.movementHandler)),a.engineToggleButton.length&&(s.engineToggle=new View.EngineToggle(a.engineToggleButton)),a.settings.length&&a.settings.on("click",function(){new Dialog.PlayzoneSettings(void 0,"broadcast").getContent().modal("show")}),a.playPosition.length&&a.playPosition.on("click",function(){goToNewHousePlay()});var p=(new Handler.Keyboard).link(ee[e]).link(L);if(Handler.KeyboardDispatcher.add(p,a.chessGame),a.tabGamesEngine.length){var f=new View.EngineGroup(a.tabGamesEngine,["Engine"]);a.tabGamesEngine.suspendResume(f),f.link(ee[e])}if(a.tabDatabaseMoves.length){var g=new View.ChessDBMovesWithSelector(a.tabDatabaseMoves.find(".databaseMovesWithScroller"));a.tabDatabaseMoves.suspendResume(g),g.link(ee[e])}if(a.tabDatabaseGames.length){var m=new View.ChessDBGames(a.tabDatabaseGames.find(".databaseGames"),g);a.tabDatabaseGames.suspendResume(m),m.link(ee[e])}if(a.tabPgn.length&&(s.tabPgn=new View.PgnDownload(a.tabPgn,e,n,i,o),a.tabPgn.suspendResume(s.tabPgn)),a.tabGamesEngine.length)if("knockout"===r)new View.KnockoutTreeGroup(a.tabTournamentGames,".tournamentId"+e+" .tabTournamentGames",e,n).link(Z);else if("teamRoundRobin"===r){if(a.tabTournamentGames.length){var v=new View.TeamRoundRobin(a.tabTournamentGames,e,n);a.tabTournamentGames.suspendResume(v)}if(a.tabTournamentStandings.length){var y=new View.StandingsTable(a.tabTournamentStandings,e).link(Z);a.tabTournamentStandings.suspendResume(y)}}else if("open"===r){var w=a.tabTournamentGames;w.append(X.render("open.main"));var b=w.find(".tournamentStandings"),C=w.find(".tournamentOngoingGames"),F=new View.OpenGames(C,e,n,!0).link(Z),x=new View.OpenStandings(b,e).link(Z);w.suspendResume(F,x),a.tabTournamentStandings.length&&(y=new View.StandingsTable(a.tabTournamentStandings,e).link(Z),a.tabTournamentStandings.suspendResume(y))}else if("bunchOfGames"===r){var w=a.tabTournamentGames;w.append(X.render("bunchOfGames.main"));var C=w.find(".tournamentOngoingGames"),F=new View.OpenGames(C,e,n,!0).link(Z);w.suspendResume(F,x)}if(a.tabBetting.length){var _=Z.getAttribute(e,"betting");if(_.standings){var E=new View.StandingsBetting(a.tabBetting,e);a.tabBetting.suspendResume(E)}}le&&c.find(".returnToOverview").on("click",function(){L.showOverview(N.data("list-url"))}),Q[e].views=s,Q[e].$containers=a,Q[e].isNewlyCreated=!1,layout(c)}else Q[e].views.navigation.setCurrentGame(e,n,i,o),Q[e].views.tabPgn&&Q[e].views.tabPgn.changeGame(e,n,i,o);if(Q[e].matchViews&&Q[e].matchViews.length)for(var S=0;S<Q[e].matchViews.length;S++)Q[e].matchViews[S]instanceof View.MultiBoard&&Q[e].matchViews[S].setCurrentRound(n,i).setCurrentGame(i,o);else if(Q[e].roundNo=n,Q[e].matchNo=i,Q[e].$containers.tabMultiboard.length){var j=new View.MultiBoard(Q[e].$containers.tabMultiboard,e,n,i,k(e));j.setCurrentGame(i,o),Q[e].$containers.tabMultiboard.suspendResume(j),Q[e].matchViews.push(j)}else Q[e].$containers.tabMultiboard.remove();if(Q[e].$containers.tabInformation.length){var I=new View.TournamentInformation(Q[e].$containers.tabInformation,e,n);Q[e].$containers.tabInformation.suspendResume(I)}return le&&(c.show().trigger("chess24:show"),N.hide().trigger("chess24:hide")),Q[e].views}function C(e){var t=Z.getAttribute(e,"video"),n=Q[e].$containers,i=Q[e].views.video;t?i||(n.chessGame.addClass("withVideo"),n.video.length&&(Q[e].views.video=new View.VideoSimple(n.video,e,!q).link(Z)),Q[e].views.video&&(q||(Q[e].views.overlay=new View.AdvertisementOverlay(e,Q[e].views.video).link(notificationHandler))),n.chessGameRightTop.append(n.video),n.chessGameLeftTop.prepend(n.playerInfoTop),n.chessGameLeftBottom.prepend(n.playerInfoBottom),Q[e].tab.content.suspendResume(Q[e].views.video)):(i&&(i.unlink(Z),delete Q[e].views.video),n.chessGame.removeClass("withVideo"),n.video.remove())}function k(e){return function(t,n,i){L.showGame(e,t,n,i)}}function F(e){return"separateDisplayGame_"+e}function x(e){var t=F(e),n=jQuery("#"+t);return n.length>0?!0:!1}function T(e,t,n){return{tab:_(e.find(".tournamentTabs"),t,n),current:{},roundNo:void 0,matchNo:void 0,matchViews:[],isNewlyCreated:!0}}function _(e,t,n){if(le)return jQuery(".separateDisplayGame").attr("id",F(t)),{nav:jQuery(),content:jQuery(".separateDisplayGame")};var i="tabTournament"+t;n=n&&window.t(n)||Z.getTitle(t);var o={tabContentId:i,tabLabel:n,tournamentId:t},r=jQuery(X.render("tabNavItem",o)),a=jQuery("<section />").attr("id",i).addClass("gameViewContainer tournamentId"+t),s={};return s.nav=r,e.find("> .tabsList").append(r),s.content=a,e.append(a),s}function E(e,t,n){var i=[],o=Z.getRounds(e);for(var r in o)if(r==t){var a=o[r];for(var s in a.matches){var l=a.matches[s];for(var c in l.games)c==n&&void 0!==l.games[c]&&i.push(parseInt(s,10))}}return i}function S(e){var t=".colorHeader",n=".video",i=t,o=n;return $(t+" "+e).is(":empty")&&(i=n,o=t),$(i+" "+e).empty(),o}function j(e,t,n,i,o){return Handler.Template.renderString(e,{tournamentId:t,roundId:n,matchId:i,gameId:o})}function I(e){var t="broadcast";$redesign&&(t+="Redesign"),void 0!==e&&e!==!0&&(e={currentTournamentId:G,template:t,data:e}),layout.safe(function(){jQuery(document).trigger("chess24:header",e)})}function A(){return $(".gameViewContainer.active").attr("id")}function O(){return A().replace("tabTournament","")}function M(){return $("#"+A())}function P(){var e=O(),t=M();R();var n=t.find(".broadcastChessGame > .left");Q[e].views.chessBoard.resize(n.width());
var i=t.find(".broadcastChessGame > .right").width();if(!t.parents(".contentContainer").hasClass("broadcastVideoTheaterMode")){t.find(".videoContainer iframe").width(i);var o=i*(9/16);t.find(".videoContainerWrapper").add(".videoContainer iframe").height(o)}}function B(){var e=$._data($(window)[0],"events").resize,t=!0;e.forEach(function(e){"updateSizes"===e.handler.name&&(t=!1)}),t&&$(window).resize(P)}function R(e){$(function(){var e=M(),t=e.find(".chessGame > .right .top"),n=e.find(".chessGame > .top");window.config.isMobileView()?n[0]||t.detach().prependTo(e.find(".chessGame")):t[0]||n.detach().prependTo(e.find(".chessGame > .right"))})}if(Controller.Broadcast.instance)return Controller.Broadcast.instance;var L=this,N=jQuery(e);N.length||errorHandler.error(new Error("container not found"),{container:N});var D,Q,H,G,V=n.tournamentIds,U=n.defaultRoundId,z=n.embedded,W=!!n.c24,q=n.customer,K=n.boardTheme,Y=W?"PlayzoneTournamentRedisAR":"TournamentRedisAR",J=W?"":"web",X=new Handler.Template("broadcast"),Z=new Controller.BroadcastTournament,ee={},te=N.hasClass("headless"),ne={},ie={},oe={},re={};Handler.engine.setDataGetter(Handler.engine.NUMERICAL_ENGINE_TYPE,function(){return!1});var ae,se,le,ce,de,ue,he,pe={},fe=!1,ge=[],me=jQuery(".contentContainerInsider > .dailyTournamentSchedule"),ve=N.data("game-url"),ye=N.data("game-embed-url"),we=!1;L.init=function(){if(Q={},$embedCCT&&$("html").addClass("cct"),se?ce=N:(N.empty().append(X.render("main"+$redesignSuffix,{listUrl:N.data("list-url"),playzoneTournaments:W,headless:te})),ce=N.find("#tabTournaments .tabContentInsider"),ue=N.find("div.searchCore"),I(!0)),q)switch(q){case"condensed":window.settings.setOverride("game-board-theme","chess24new"),window.settings.setOverride("game-piece-theme","chess24")}K&&window.settings.setOverride("game-board-theme",K),D=Handler.socket.getSocket(Handler.socket.types.NOTIFICATION),D.on("error",i),D.on("connect_failed",i),D.on("model:add"+J+Y,l),"multiBoardOnly"===se&&V.startWith?setTimeout(function(){s([V.startWith])}):V.exactList?s(V.exactList):n.c24?D.emit("getPlayzoneTournamentIds",J,s):D.emit("getTournamentIds",J,o),N.on("click",".tournamentTabs > .tabsList > li > div:not(:first)",function(e){if(!$(e.target).hasClass("icon-cross")){G=jQuery(this).attr("tournamentid");var t=jQuery(X.render("dialogs.embed",{tournamentId:G,roundId:ne[G],matchId:ie[G],gameId:oe[G]})),n=Q[G].views.video&&we&&!$(".contentContainer").hasClass("broadcastVideoTheaterMode"),i=!Q[G].views.video&&$(".contentContainer").hasClass("broadcastVideoTheaterMode");(n||i)&&(we=!we,$(".contentContainer").toggleClass("broadcastVideoTheaterMode")),($embedCCT||$mainBroadcast)&&(B(),P()),jQuery(document).trigger("chess24:embedurl",{html:t,events:{"chess24:show":{"*":function(){t.find(".copy").off("click").on("click",function(){var e=$(this),t=e.find(".copyTooltip"),n=t.data("timeout");clearTimeout(n),t.addClass("fixed").show(),n=setTimeout(function(){t.removeClass("fixed").hide()},2e3),t.data("timeout",n),Handler.KeyboardDispatcher.copy(e.siblings(".code").text())})}}}});var o="Round "+ne[G];"knockout"==Z.getAttribute(G,"eventType")&&(o+="."+oe[G]),I({title:Z.getTitle(G),logo:Z.getAttribute(G,"logo"),round:o}),ue.hide()}}).on("click",".tournamentTabs > .tabsList > li > div:first",function(){jQuery(document).trigger("chess24:embedurl",!1),I(!0),ue.show()}).on("click",".tournamentTabs > .tabsList > li > div > .icon-cross",function(){var e=jQuery(this).parent("[tournamentId]");delete Q[e.attr("tournamentId")];var t=e.parent("li");t.hasClass("active")&&t.prev().children("div").trigger("click"),t.remove()}),ue&&r(ue)},L.isEmbedded=function(){return z},L.showPrevGame=function(){var e=Q[G].current,t=e.matchNos.indexOf(e.matchNo),n=t-1;if(-1!==t&&void 0!==e.matchNos[n]){var i=e.matchNos[n];L.showGame(G,e.roundNo,i,e.gameNo)}},L.showNextGame=function(){var e=Q[G].current,t=e.matchNos.indexOf(e.matchNo),n=t+1;if(-1!==t&&void 0!==e.matchNos[n]){var i=e.matchNos[n];L.showGame(G,e.roundNo,i,e.gameNo)}};var be={};return L.getCurrentGamePath=function(){return{round:ne[G],match:ie[G],game:oe[G]}},L.showGame=function(e,t,i,o,r){t=t||1,i=i||1,o=o||1;var a=L.getGameUrl(e,t,i,o);if(n.norender)return void(window.location=a);me.hide(),G=e,ne[G]=parseInt(t||1,10),ie[G]=parseInt(i||1,10),oe[G]=parseInt(o||1,10),jQuery(".jTooltipBox").hide(),de&&de.reset(),ee[e]instanceof Chess.GameHandler||(ee[e]=new Chess.GameHandler);var s=Z.getRounds(e);if(void 0===s[t]||void 0===s[t].matches[i]||void 0===s[t].matches[i].games[o]){var l="fakeTemporaryGame";ee[e].hasGame(l)||ee[e].addGame(l,(new Chess.Game).setNoTimeout(!0).setCheckForGameEnd(!1)),de=function(){var n=Z.getAttribute(e,"rounds");n[t]&&n[t].matches[i]&&n[t].matches[i].games[o]&&(de.reset(),L.showGame(e,t,i,o,r),Q[e].views.navigation.setCurrentGame(e,t,i,o,!0))},de.reset=function(){Z.off("set."+e+":"+t+":"+i+":"+o,de),de=void 0},Z.on("set."+e+":"+t+":"+i+":"+o,de)}else{l=s[t].matches[i].games[o].fullGameRKey;var c={rkey:l}}var d=e;ne[G]&&(d+="/"+ne[G],ie[G]&&(d+="/"+ie[G],oe[G]&&(d+="/"+oe[G]))),Handler.tracking("broadcast","showGame",d),void 0===a||L.isEmbedded()||window.history.pushState({},"game",a);var u=Z.getAttribute(e,"eventType"),h=!!Z.getAttribute(e,"c24");if(h)return void y(e,t,i,o,u,a);if("dual"==se){if(!(ee[e]instanceof Chess.GameHandler)){var p=e==pe.id1?pe.id2:pe.id1;ee[p]instanceof Chess.GameHandler&&(ee[e]=ee[p])}}else if("single"==se&&!(ee[e]instanceof Chess.GameHandler))for(var p in ee){ee[e]=ee[p];break}var f=b(e,t,i,o,u);if(f.boardLink&&f.boardLink.updateUrl(L.getGameUrl(e,t,i,o,!0)),C(e),Z.off("set."+e+".video",m(e)).on("set."+e+".video",m(e)),ee[e].hasGame(l))jQuery("div.modalOverlay.loader").hide(),ee[e].setCurrentGame(l);else{jQuery("div.modalOverlay.loader").show();var g=new Record.ChessGameSocketPR(c,D,function(){g.get("chessGame").link(ee[e],l),ee[e].setCurrentGame(l),jQuery("div.modalOverlay.loader").hide()},notificationHandler.getTimeOffset())}if(Q[e].tab.nav.find("div").data("href",a).trigger("click"),Q[e].current.subRound!==t.toString()+"-"+o.toString()&&Z.emit("subRoundChanged",{roundNo:t,matchNo:i,gameNo:o}),Q[e].current={roundNo:t,matchNo:i,gameNo:o,subRound:t.toString()+"-"+o.toString(),matchNos:E(e,t,o)},H instanceof jQuery&&H.removeClass("currentGame"),H=jQuery(".tournamentId"+e+" .roundId"+t+" .matchId"+i+" .gameId"+o).addClass("currentGame"),"string"==typeof r){var v=Q[e].tab.content.find("div[data-tab-content-id="+r+e+"]");v.trigger("click")}var w=$(".gameControlsContainer .burgerMenu a.analysis");if(w){var k=Handler.Template.renderString(w.data("url"),{tournamentId:e,roundId:t,matchId:i,gameId:o});w.attr("href",k)}jQuery(document).trigger("onLoadAdvertisement")},L.showGameWhenReady=function(e,t,n,i){re[e]instanceof Record.TournamentSocketPR?(N.find(".tabsList li:first div").one("click",function(){setTimeout(function(){jQuery(window).trigger("scroll")})}),L.showGame(e,t,n,i),ae=void 0):ae=function(o){t=t||o.get("currentRound"),i=i||o.get("currentGame")||1,n=n||"knockout"===o.get("eventType")&&v(o,t,i)||1,L.showGameWhenReady(e,t,n,i)}},L.showOwnGame=function(e){if(re[e]instanceof Record.TournamentSocketPR){var t=Z.findPlayersGame(e,config.user().uuid);t&&t.gameId&&(L.showGame(e,t.roundId,t.matchId,t.gameId),ae=void 0)}else ae=function(){L.showOwnGame(e)}},L.jumpToDefaultGame=function(e,t){var n=Z.getAttribute(e,"c24");if(n){var i=Z.findPlayersGame(e,config.user().uuid,t);i?L.showGame(e,i.roundId,i.matchId,i.gameId):L.showGame(e,t)}else L.showGame(e,t)},L.showOverview=function(e){if(e&&window.history.pushState({},"overview",e),jQuery(document).trigger("chess24:embedurl",""),le&&le.length){if(N.is(":visible")&&!le.is(":visible"))return;le.hide().trigger("chess24:hide"),N.show().trigger("chess24:show")}else{var t=N.find(".tournamentTabs section:visible"),n=N.find(".tournamentTabs section:first");if(t.is(n))return;N.find(".tournamentTabs > ul.tabsList li:first div").trigger("click")}me.show(),w()},L.setSpecialMode=function(e,t){return"dual"===e?(se=e,pe=t,le=jQuery(".separateDisplayGame"),fe=!0):"single"===e?(se=e,pe=void 0,le=jQuery(".separateDisplayGame"),fe=!0):"multiBoardOnly"===e?se=e:(se=void 0,pe=void 0,le=void 0,fe=!1),L},L.shorterFirstName=function(e,t){if(!e)return"";t=t||13;var n=e.match(/^([^,]+),([-\w\u00C0-\u017F ]+)/);if(n){var i=n[1],o="";if(i.length>t)i=i.substr(0,t-1)+".",o="";else{for(var r=n[2].trim().split(" "),a=r.length-1;a>=0&&!((i+", "+r.join(" ")).length<=t);a--)r[a]=r[a].substr(0,1)+".";for(;r.length>0&&(i+", "+r.join(" ")).length>t;)r.pop();o=r.join(" ")}var s=e.substr(n[0].length,1);return i+(o?", "+o:"")+([".",","].contains(s)?"":" ")+e.substr(n[0].length)}if(n=e.match(/^([-\w\u00C0-\u017F ]+)/)){for(var l=n[1].trim().split(" "),a=l.length-2;a>=0&&!(l.join(" ").length<=t);a--)l[a]=l[a].substr(0,1)+".";for(;l.join(" ").length>t&&l.length>1;)l.splice(l.length-2,1);l.join(" ").length>t&&(l[0]=l[0].substr(0,t-1)+".");var s=e.substr(n[0].length,1);return l.join(" ")+([".",","].contains(s)?"":" ")+e.substr(n[0].length)}return e},L.renderLastMoves=function(e,t,n){var i="";if(!t)return i;n=n||2;for(var o=new Chess.Position({fen:e}),r=t.map(function(e){return o=o.move({dontCheckForInsufficentMaterial:!0,move:Chess.translate.canToMove(e)}),{nr:"b"===o.moveRight?o.moveCounter:o.moveCounter-1,san:o.getSan(),moveRight:o.moveRight}}),a=Math.max(r.length-n,0);a<r.length;a++)i+="w"===r[a].moveRight?i.length?" "+r[a].san:r[a].nr+"... "+r[a].san:(i.length?" ":"")+r[a].nr+". "+r[a].san;return i},L.getTemplates=function(){return X},L.getGameUrl=function(e,t,n,i,o){if($redesign)return window.location;if(o||!z)var r=ve;else r=ye;return j(r,e,t,n,i)},L.getEmbedUrl=function(e,t,n,i){return j(ye,e,t,n,i)},L.snapshotsAvailable=function(e,t,n,i){function o(e){return!!e&&!!(e.currentFen||e.earlierFen&&e.lastMoves||e.gameStatus&&"upcoming"===e.gameStatus.status)}var r=Z.getAttribute(e,"rounds");return t&&n&&i?r[t]&&r[t].matches[n]&&o(r[t].matches[n].games[i]):!!r[1].matches&&Object.every(r[1].matches,function(e){return Object.some(e.games,o)})},L.setNavigationView=function(e){var t=new View.RoundNavigation(e,G,ne[G],ie[G],oe[G]);Q[G].views.navigation=t,layout.dropDown(e)},L.renderVideoSelector=function(e){Q[G].views.video&&Q[G].views.video.renderSelector($(e))},L.switchGamePresenter=function(){var e=".gamePresenter",t=S(e);L.renderVideoSelector(t)},L.switchNavigation=function(){var e=".navigation",t=S(e);L.setNavigationView(t+" "+e)},me.length&&new View.TournamentSchedule(me,me.data("tournaments")),Controller.Broadcast.instance=L,n.norender||setTimeout(L.init),L.overrideVideo=function(e,t){if(Q[e]&&Q[e].views){var n=Q[e].views.video,i="model:"+J+Y,o=i+":"+e,r={rkey:o};new Record.TournamentSocketPR(r,D,function(){n?n.overrideVideo(t):Q[e].views.video=new View.VideoSimple(t,e,!q).link(Z)})}},L.resumeTournamentVideo=function(e){var t="model:"+J+Y,n=t+":"+e,i={rkey:n},o=new Record.TournamentSocketPR(i,D,function(){L.overrideVideo(e,o.get("video"))})},L},Controller.Broadcast.offsetCorrectedDateNow=function(){return Date.now()-Controller.Broadcast.getTimeOffset()},Controller.Broadcast.getTimeOffset=function(){var e=notificationHandler.getTimeOffset();return isNaN(e)&&(e=0),e},function(){var e;Controller.Broadcast.getOutcomePrediction=function(t){e=e||Math.Gaussian(0,Math.pow(60,2));var n=t.score||0;if(void 0!==t.mate&&("-0"===t.mate||t.mate<0?n=-(1/0):t.mate>=0&&(n=1/0)),n/=100,n>5)return[100,0,0];if(-5>n)return[0,0,100];var i=e.pdf(60*n),o=Math.pow(Math.ChiSquare(-1*n+5,2),2),r=Math.pow(Math.ChiSquare(n+5,2),2),a=[1e5*o,1e5*i,1e5*r];return Math.getPercentages(a)}}(),Controller.Broadcast.getPhraseForEvaluation=function(e,n){var i=[{abs:50,phrase:"Equal"},{abs:100,phrase:"{{color}} is slightly better"},{abs:200,phrase:"{{color}} is much better"},{abs:1/0,phrase:"{{color}} is winning"}];if(void 0===e&&void 0===n)return"";var o=0>e||0>n?"Black":"White";if(0===n)return t("Mate");if(n){var r=Math.abs(n),a=r>1?"s":"";return t(o+" can mate in {{mate}} move"+a,{"{{mate}}":r})}for(var s=Math.abs(e),l=0;l<i.length;l++)if(s<=i[l].abs)return t(i[l].phrase.replace(/{{color}}/g,o))},Controller.Broadcast.convertEvaluationToPercent=function(e,t){if(e){if(void 0!==e.score)return Math.min(100,Math.max(0,(t?1:-1)*e.score/8+50));if(void 0!==e.mate){var n;return n=0===e.mate?0:"-0"===e.mate?100:100*(e.mate>0?t:!t)}}return 50},Controller.Broadcast.scoreToString=function(e){return e%1!==0?(Math.floor(e)?Math.floor(e).toString():"")+"½":e},"undefined"==typeof Controller&&(Controller={}),Controller.BroadcastTournament=function(){var e=this;if(Controller.BroadcastTournament.instance)return Controller.BroadcastTournament.instance;Extend.Publisher(e);var t={},n=["teamRoundRobin"];e.add=function(n,i){void 0===t[i]&&(t[i]=n,e.emit("tournamentAdded",{id:i}),n.on("set",function(t,n){var o,r=i;if("rounds"===n.key)for(var a in n.diff){isNaN(a)&&errorHandler.msg("critical",new Error("non numeric index as roundId in tournament.rounds property"),!0,{tournamentPRId:r,roundId:a});var s=n.diff[a];for(var l in s)"matches"!==l&&(o="set."+r+":"+a+"."+l,e.emit(o,{key:l,tournamentId:r,roundId:a,value:n.value[a][l],full:n.value[a]}));if(s&&"object"==typeof s.matches)for(var c in s.matches){isNaN(c)&&errorHandler.msg("critical",new Error("non numeric index as matchId in tournament.rounds property"),!0,{tournamentPRId:r,roundId:a,matchId:c});var d=s.matches[c];for(var u in d)"games"!==u&&(o="set."+r+":"+a+":"+c+"."+u,e.emit(o,{key:u,tournamentId:r,roundId:a,matchId:c,value:n.value[a].matches[c][u],full:n.value[a].matches[c][u]}));if("object"==typeof d.games)for(var h in d.games){isNaN(c)&&errorHandler.msg("critical",new Error("non numeric index as gameId in tournament.rounds property"),!0,{tournamentPRId:r,roundId:a,matchId:c,gameId:c});var p=d.games[h];for(var f in p)o="set."+r+":"+a+":"+c+":"+h+"."+f,e.emit(o,{key:f,tournamentId:r,roundId:a,matchId:c,gameId:h,value:n.value[a].matches[c].games[h][f],full:n.value[a].matches[c].games[h]})}}}else n.tournamentId=r,e.emit("set."+r+"."+n.key,n)}))},e.getAttribute=function(e,n){return t[e].get(n)},e.getStartDate=function(t){var n=e.getRounds(t)[1];return new Date(n.startDate[1]||n.startDate)},e.getYear=function(t){return e.getStartDate().getFullYear()},e.getRounds=function(t){return e.getAttribute(t,"rounds")},e.getTitles=function(t){return e.getAttribute(t,"titles")},e.getTitle=function(t){var n=e.getAttribute(t,"titles");return n[config.language()]||n.en},e.getDescription=function(t){var n=e.getAttribute(t,"descriptions");return n&&(n[config.language()]||n.en)},e.getPlayer=function(t,n){var i=e.getAttribute(t,"players");return i[n]},e.getTournamentPR=function(e){return t[e]},e.isTeamEvent=function(t){return n.contains(e.getAttribute(t,"eventType"))},e.isKnockoutEvent=function(t){return"knockout"===e.getAttribute(t,"eventType")};var i=["teamRoundRobin","bunchOfGames","knockout"];return e.showPlayerScoreHistory=function(t){return!i.contains(e.getAttribute(t,"eventType"))},e.hasMatches=function(t){return e.isTeamEvent(t)||e.isKnockoutEvent(t)},e.getTeamResultsForRound=function(t,n,i){var o=e.getTeamResults(t,n,i),r=e.getTeamResults(t,n,i-1);return Object.map(o,function(e,t){return Math.max(0,e-r[t])})},e.getTeamResults=function(t,n,i){var o={wins:0,loses:0,draws:0,mp:0,bp:0},r=e.getAttribute(t,"teams");if(!r||!r[n])return o;if("live"===i)i=parseInt(e.getAttribute(t,"currentRound"),10);else if("round"===i&&(i=parseInt(e.getAttribute(t,"currentRound"),10)-1,0===i))return o;return r[n].results&&r[n].results.rounds[i]?r[n].results.rounds[i]:o},e.getAllGamesForAPlayer=function(t,n){var i=e.getRounds(t),o=[];return Object.forEach(i,function(e,t){Object.forEach(e.matches,function(i,r){Object.forEach(i.games,function(i,a){!i.player||i.player.white!=n&&i.player.black!=n||o.push(Object.extend({roundLabel:e.label,roundId:t,matchId:r,gameId:a},i))})})}),o},e.getPlayerResults=function(t,n,i){var o={games:0,p:0},r=e.getAttribute(t,"players");if(!r||!r[n])return o;if("live"===i)i=parseInt(e.getAttribute(t,"currentRound"),10);else if("round"===i&&(i=parseInt(e.getAttribute(t,"currentRound"),10)-1,0===i))return o;return r[n].results?r[n].results.rounds[i]?r[n].results.rounds[i]:r[n].results.rounds[Object.keys(r[n].results.rounds).pop()]||o:o},e.getAllPlayersPoints=function(t,n){var i=e.getAttribute(t,"players"),o=e.getAttribute(t,"rounds");return"live"===n?n=parseInt(e.getAttribute(t,"currentRound"),10):"round"===n&&(n=parseInt(e.getAttribute(t,"currentRound"),10)-1),o[n]?Object.map(i,function(e){if(e.results){if(e.results.rounds[n])return e.results.rounds[n].p;var t=Object.keys(e.results.rounds).pop();return e.results.rounds[t]&&e.results.rounds[t].p||0}return 0}):Object.map(i,function(){return 0})},e.findPlayersGame=function(n,i,o){if(t[n]&&(o||(o=e.getAttribute(n,"currentRound")))){var r=e.getAttribute(n,"rounds")[o];if(r)for(var a in r.matches)for(var s in r.matches[a].games)if(r.matches[a].games[s].player.white==i||r.matches[a].games[s].player.black==i)return r.matches[a].games[s].gameStatus.endedBy?r.matches[a].games[s].gameStatus.endedBy:{roundId:o,matchId:a,gameId:s}}},e.remove=function(e){},e.set=function(e){},e.unset=function(e){},Controller.BroadcastTournament.instance=e},"undefined"==typeof Controller)var Controller={};!function(){var e="/api/web/ChessDatabaseAPI/",t="move position.highlights position.glyph position.comment currentGameChanged meta replaceChessGame movedPositionPointer.start",n="movedPositionPointer",i="game-broadcast-engine",o=["timeGoneSinceLastMove","endOfMainlineMoveMadeAt"];Controller.ChessDB=function(r,a){function s(){if(D=new Chess.GameHandler,u(),B){var e=R&&window.location.hash.replace("#","")||void 0;d(Chess.couchToGame(B),e),B.meta&&B.meta.Black&&B.meta.Black.UUID==config.user().uuid&&D.emit("flipBoard")}else d();var t=$("#chessDatabaseIndexInitObjectId").attr("data-import-pgn"),n=!1,o=$("#chessDatabaseIndexInitObjectId").attr("data");if(o)try{n=JSON.parse(o).isNewPlayzoneGame}catch(r){}var a=n?R:"";return t&&l(t,a),window.settings.on("settings."+i,c),c(),N}function l(e,t){$.ajax({url:"/api/web/ChessDatabaseAPI/importPgn?pgn="+e}).done(function(e){var n=e.data.result,i=n[0].chessGame;t&&i.meta&&(i.meta.GameUUID=t,i.meta.isNewPlayzoneGame=!0),d(Chess.couchToGame(i)),i.meta&&i.meta.Black&&i.meta.Black.Name==config.user().name&&D.emit("flipBoard"),b()})}function c(){r.find(".chessDB").toggleClass("engineVisible",window.settings.getBoolean(i))}function d(e,t,n){e=e||new Chess.Game,void 0!==t?e.gotoId(parseInt(t,10)):e.gotoStart(),D.addGame(void 0,e),D.setCurrentGame(e),D.setMoveMode(ue).setDeleteMode(ue),se.meta.setTags(n||[]).refresh();var i=e.getMeta();i.Title||i.White&&i.White.Name&&i.Black&&i.Black.Name&&(i.Title=window.t("{white}{whiteelo} vs. {black}{blackelo}",{"{white}":i.White.Name,"{black}":i.Black.Name,"{whiteelo}":i.White.Elo?" ("+i.White.Elo+")":"","{blackelo}":i.Black.Elo?" ("+i.Black.Elo+")":""}),e.setMeta("Title",i.Title)),M(),ae.name.text(i.Title||""),w()}function u(){ae.tabs=r.find(".radioTabs"),ae.evalIndicator=r.find(".evalIndicator"),ae.evalIndicatorTooltip=r.find(".evalindicatorTooltip .cTooltipRight"),ae.chessBoard=r.find(".chessBoard"),ae.cursor=r.find(".cursor"),ae.notationArea=r.find(".notationTableMoveTreeSwitch .notationTable"),ae.moveTree=r.find(".notationTableMoveTreeSwitch .moveTree"),ae.settings=r.find(".gameControlsContainer .settings"),ae.downloadPgn=r.find(".gameControlsContainer .downloadPgn"),ae.downloadForm=r.find("form[name=pgn]"),ae.boardXLButton=r.find(".btnBiggerBoard"),ae.flipBoard=r.find(".gameControlsContainer .flipBoard"),ae.engineLines=r.find(".engineLines"),ae.playPosition=r.find(".playPosition"),ae.tabDatabaseMoves=r.find(".tabDatabaseMoves > .databaseMovesWithScroller"),ae.tabDatabaseGames=r.find(".tabDatabaseGames > .databaseGamesList"),ae.autoPlayButton=r.find(".btnAutoPlay"),ae.tabGamesEngine=r.find(".tabGamesEngine"),ae.tabFraud=r.find(".tabFraud"),ae.name=r.find(".analysisName"),ae.coachingSettings=r.find(".coachingSettings"),ae.coachingStart=r.find(".startCoaching"),ae.chat=r.find(".tabContainer.tabChat .chatContainer"),ae.chatTab=r.find(".tabContainer.tabChat").detach(),ae.upload=r.find(".uploadControls input:file"),ae.meta=r.find(".gameMeta");var e=r.find(".notationTableMoveTreeSwitch .tabContent");r.find(".notationTableMoveTreeSwitch input[type=radio]").on("change",function(){var t=jQuery(this).siblings(".tabContent"),n=e.not(t);t.trigger("chess24:show"),n.trigger("chess24:hide")}),h(),p(),v(),ae.chatTab.find("> label").on("click",function(){j.queue=[],I()}),f(),D.on(t,function(e,t){"move"===e.currentChannel&&t instanceof Chess.Position&&(t.timeUsage=0),ne.removeClass("disabled"),te.removeClass("disabled"),y()}),D.on(n,y)}function h(){if(ae.evalIndicator.length&&(se.evalIndicator=new View.EvalIndicator(ae.evalIndicator,ae.evalIndicatorTooltip).link(D)),ae.chessBoard.length&&(se.chessBoard=new View.ChessBoard(ae.chessBoard).link(D),se.chessBoard.attachKeyboardHandler(),Handler.KeyboardDispatcher.add(se.chessBoard.getKeyboardHandler(),r.find(".chessGame"))),ae.cursor.length&&(se.cursor=new View.Cursor(ae.cursor,!1,void 0,!0).link(D)),ae.notationArea.length&&(se.notationArea=new View.NotationArea(ae.notationArea,"analyse").link(D),ae.notationArea.suspendResume(se.notationArea)),ae.moveTree.length){var e=new View.ChessDBMoves(ae.moveTree,["move","count","avgEloPlayer","percent"]).link(D);ae.moveTree.suspendResume(e)}if(ae.meta.length&&(se.meta=new View.MetaEditor(ae.meta,!0).setTags([]).link(D),ae.meta.parent().suspendResume(se.meta),se.meta.on("change",function(){te.removeClass("disabled"),ne.removeClass("disabled")}),se.meta.on("click",function(e,t){C(t)})),ae.flipBoard.length&&(se.flipBoard=new View.FlipBoard(ae.flipBoard).link(D)),ae.engineLines.length&&(se.engineLines=new View.Engine(ae.engineLines).link(D)),ae.tabDatabaseMoves.length){var t=new View.ChessDBMovesWithSelector(ae.tabDatabaseMoves).link(D);ae.tabDatabaseMoves.parent().suspendResume(t)}if(ae.tabDatabaseGames.length){var n=new View.ChessDBGames(ae.tabDatabaseGames,t||void 0).link(D);ae.tabDatabaseGames.parent().suspendResume(n)}if(ae.autoPlayButton.length&&(se.autoPlay=new View.AutoPlay(ae.autoPlayButton).link(D).link(se.chessBoard.movementHandler)),ae.tabGamesEngine.length){var i=new View.EngineGroup(ae.tabGamesEngine,["Engine"]);ae.tabGamesEngine.suspendResume(i),i.link(D)}ae.tabFraud.length&&ae.tabFraud.suspendResume(new View.FraudReport(ae.tabFraud,void 0,R,L)),ae.boardXLButton.length&&(se.boardXL=new View.BoardXL(ae.boardXLButton))}function p(){ae.settings.length&&ae.settings.on("click",function(){new Dialog.PlayzoneSettings(void 0,"broadcast").getContent().modal("show")}),ae.downloadPgn.length&&ae.downloadPgn.on("click",function(){return config.level().isPremium?(ae.downloadForm.find("input[name=game]").val(JSON.stringify(Chess.gameToCouch(D.getCurrentGame()))),void ae.downloadForm.get(0).submit()):void Dialog.conversionGoPremium("pgnDownload")}),ae.playPosition.length&&ae.playPosition.on("click",function(){goToNewHousePlay()}),V=r.find(".setupPosition a"),U=r.find(".importPgn a"),z=r.find(".pastePgn a"),W=r.find(".importGame a"),q=r.find(".shareSession"),K=r.find("a.cIconCoaching.start"),Y=r.find("a.cIconCoaching.stop"),X=r.find("a.cIconCoachingActive"),J=r.find("a.stopViewing"),Z=r.find(".promoteMove a"),ee=r.find(".deleteMove a"),$btnReplace=r.find(".replaceMove a"),te=r.find(".newSession"),ne=r.find(".saveSession"),ie=r.find(".loadSessions"),te.on("click",function(){te.hasClass("disabled")||(ae.tabFraud.length&&ae.tabFraud.closest(".customTabs").trigger("chess24:remove",ae.tabFraud.attr("id")),he=void 0,pe=!1,G=void 0,d(),M(te.data("url")),te.addClass("disabled"))}),V.on("click",function(){Dialog.setupPosition(N.setCurrentGame,D.toString())}),U.on("click",function(){if(!config.level().isPremium)return void Dialog.conversionGoPremium("analysisMode");if(!U.is(".disabled"))return r.find(".uploadControls input:file").click(),!1}),z.on("click",function(){return config.level().isPremium?void(z.is(".disabled")||Dialog.prompt({title:window.t("Paste PGN"),message:window.t("Please paste the content of your PGN file into the box below"),input:"long"}).done(function(e){oe=new Dialog.Games({pgn:!0}),oe.loading(!0).show(),setTimeout(function(){var t=e.replace(/[\r\t]/g,"").split(/\n\n\[/g).map(function(e,t){try{return Chess.gameToCouch(Chess.pgnToGame((t&&"["||"")+e))}catch(n){return void 0}}).filter(function(e){return!!e});oe.loading(!1).addTags().addGames(t).selectAll().on("select",function(e,t){g(t.games||[],t.tags||[]),oe.hide()})},500)})):void Dialog.conversionGoPremium("analysisMode")}),W.on("click",function(){function e(e){oe.setupInfiniteLoading({url:"/api/web/ChessDatabaseAPI/getPlayzoneGames"+(e?"?username="+e:""),array:"games",onstart:function(){oe.loading(!0).emptyMessage(!1)},onerror:function(){oe.loading(!1).emptyMessage(!0)},onload:function(e){oe.loading(!1).addGames(e.data.games)}})}return config.level().isPremium?void(W.is(".disabled")||(oe=new Dialog.Games({playzone:!0}),oe.show().on("select",function(e,t){t.games&&t.games[0]&&jQuery.getJSON("/api/web/ChessDatabaseAPI/getPlayzoneGame",{gameSessionToken:t.games[0].gameSessionToken}).done(function(e){d(Chess.couchToGame(e.data.game)),oe.hide()})}).on("search",function(t,n){e(n.pattern)}),e())):void Dialog.conversionGoPremium("analysisMode")}),ne.on("click",function(){ne.hasClass("disabled")||b()&&ne.addClass("disabled")}),ie.on("click",function(){C()}),Z.on("click",function(){ce||Z.is(".disabled")||D.promote()}),ee.on("click",function(){ce||ee.is(".disabled")||D.deleteMove()}),$btnReplace.on("click",function(){var e=se.chessBoard.movementHandler.getReplaceMode();se.chessBoard.movementHandler.setReplaceMode(!e),$btnReplace.parent().toggleClass("active",!e)}),q.on("click",function(){he&&!pe&&new Dialog.AnalysisShare(he)}),jQuery.fn.shareButtons("filter",function(e){he&&!pe?Dialog.AnalysisShare.togglePublic(he,!0,function(){e&&e()}):e&&e()}),K.on("click",function(){if(!Q&&!K.is(".disabled")){if(!config.level().isPremium)return void Dialog.conversionGoPremium("analysisMode");H=Chess.gameToCouch(D.getCurrentGame(),o),notificationHandler.sendMessage("coaching.start",{chessGame:H,knotId:D.getCurrentPosition().knotId},function(e){if(N.subscribe(e,!0),e){var t=K.data("url");if(t){G=window.location.href;var n=Handler.Template.renderString(t,{username:config.user().permalink,uuid:e});window.history.pushState({},"coaching",n)}Dialog.alert({content:window.t("Coaching session started")}),K.hide(),Y.show()}})}}),Y.on("click",function(){Q&&le&&(notificationHandler.sendMessage("coaching.stop",{uuid:Q},T),K.show(),Y.hide())}),J.on("click",function(){Q&&!le&&T()}),X.on("click",function(){Q&&le&&_(Q,function(e){new Dialog.Coaching(Q,e)})});var e=r.find("a.draw").on("click",function(){var t=jQuery(this);if(!t.is(".disabled")){var n=t.data("mode");switch(t.parent().is(".active")&&["red","blue","green","yellow","erase"].contains(n)&&(t=e.filter("[data-mode=off]"),n="off"),n){case"red":case"blue":case"green":case"yellow":se.chessBoard.movementHandler.deactivate(),se.chessBoard.highlightHandler.startDrawing(n);break;case"erase":se.chessBoard.movementHandler.deactivate(),se.chessBoard.highlightHandler.startEraser();break;case"clear":return void D.setHighlights([]);case"off":se.chessBoard.highlightHandler.isDrawing()&&(se.chessBoard.highlightHandler.stopDrawing(),se.chessBoard.highlightHandler.stopEraser(),se.chessBoard.movementHandler.activate());break;default:return}e.parent().removeClass("active"),t.parent().addClass("active")}});$(document).on("keydown",function(e){var t="";switch(e.keyCode){case Handler.Keyboard.keys.VK_SHIFT:t="green";break;case Handler.Keyboard.keys.VK_CTRL:t="blue";break;case Handler.Keyboard.keys.VK_ALT:t="red";break;case Handler.Keyboard.keys.VK_CAPS:t="yellow";break;default:return}se.chessBoard.movementHandler.deactivate(),se.chessBoard.highlightHandler.startDrawing(t)}),$(document).on("keyup",function(){se.chessBoard.highlightHandler.isDrawing()&&(se.chessBoard.highlightHandler.stopDrawing(),se.chessBoard.highlightHandler.stopEraser(),se.chessBoard.movementHandler.activate())})}function f(){ae.upload.on("chess24:add",function(){U.addClass("disabled").data("label",U.html()).html(window.t("Importing...")),oe=new Dialog.Games({pgn:!0}),oe.loading(!0).show()}).on("chess24:done",function(e,t){U.removeClass("disabled").html(U.data("label"));var n=m(t),i=n&&[n]||void 0,o=t.result.data.result&&t.result.data.result.map(function(e,t){return e.chessGame});1==o.length?(oe.hide(),g(o,i)):oe.loading(!1).addTags(i).addGames(o).selectAll().on("select",function(e,t){oe.hide(),g(t.games||[],t.tags||[])})}).on("chess24:error",function(){U.removeClass("disabled").html(U.data("label")),oe.loading(!1).emptyMessage(!0)})}function g(t,n){var i={id:pe?void 0:he,csrf:config.csrf(),games:JSON.stringify(t),tags:n&&JSON.stringify(n)||null};jQuery.post(e+"saveSession",i).done(function(e){e.data.id?(he=e.data.id,pe=!1,d(Chess.couchToGame(t[0])),M(e.data.url)):Dialog.alert(window.t("Import is finished, you can find all imported games in the list of your sessions."))})}function m(e){if(e.result.data.result){var t=e.result.data.result.map(function(e){return e.chessGame&&e.chessGame.meta&&e.chessGame.meta.Event||""}).unique();if(1===t.length&&t[0])var n=t[0]}return!n&&e.files&&e.files[0]&&e.files[0].name&&(n=e.files[0].name),n}function v(){function e(e){ae.name.empty().append(e).removeClass("editing"),w(),n=!1,D.setMeta("Title",e)}function t(e){ae.name.empty().append(e).removeClass("editing"),w(),n=!1}var n=!1;w(),ae.name.on("click",function(){if(!n){n=!0;var i=ae.name.is(".placeholder")?"":ae.name.text(),o=jQuery('<input type="text" maxlength="100"/>').val(i).on("keyup",function(n){13===n.which?e(o.val().sanitize()):27===n.which&&t(i)}).on("blur",function(){e(o.val().sanitize())});ae.name.empty().append(o).addClass("editing"),o.focus()}}),ae.name.on("setname",function(t,n){e(n)})}function y(){var e=D.getCurrentPosition();ee.toggleClass("disabled",e===D.getStartPosition()),Z.toggleClass("disabled",e.isInMainline())}function w(){ae.name.text().trim()?ae.name.removeClass("placeholder"):ae.name.html(ae.name.data("placeholder")).addClass("placeholder")}function b(){if(config.level().isGuest)return Dialog.conversionRegister("analysis"),!1;var t=se.meta.getTags(),n={id:he&&pe?void 0:he,csrf:config.csrf(),game:JSON.stringify(Chess.gameToCouch(D.getCurrentGame())),tags:t&&JSON.stringify(t)||void 0};return jQuery.post(e+"saveSession",n).done(function(e){he=e.data.id,pe=!1,M(e.data.url)}),!0}function C(t){function n(n){r={},n&&(t=void 0,oe.setCurrentTag()),oe.switchToGames().setupInfiniteLoading({url:e+"getSessions"+(n?"?pattern="+n:"")+(t?"?tag="+t:""),array:"sessions",onstart:function(){oe.loading(!0).emptyMessage(!1)},onerror:function(){oe.loading(!1).emptyMessage(n?"search":"general")},onload:function(e){oe.loading(!1),i=e.data.url;var t=oe.countRendered(),o=e.data.sessions.map(function(e,n){return r[e.id]=e,{disabled:!config.level().isPremium&&t+n>2,date:e.gameStartedAt,name:e.meta.Title,fen:e.moves&&e.moves[e.moves.length-1].fen||void 0,"public":e["public"],id:e.id}});oe.addGames(o),oe.countRendered()||oe.emptyMessage(n?"search":"general")}})}var i,o="",r={};return config.level().isGuest?void Dialog.conversionRegister("analysis"):(oe=new Dialog.Games({sessions:!0}),oe.setCurrentTag(t).show().on("alltags",function(){jQuery.getJSON(e+"allTags",function(e){oe.switchToTags(e.data.tags)})}).on("allgames",function(){t=void 0,oe.setCurrentTag().switchToGames(),n()}).on("search",function(e,t){var i=t.pattern;i!=o&&(o=i,n(i))}).on("select",function(e,t){var n=t&&t.games&&t.games[0]&&r[t.games[0].id];if(n){if(t.games[0].disabled)return void Dialog.conversionGoPremium("analysisMode");he=n.id,pe=!1;var o=Handler.Template.renderString(i,{id:he});M(o),d(Chess.couchToGame(n),0,n.tags),oe.hide(),ne.addClass("disabled")}}).on("delete",function(t,n){var i={id:n.id,csrf:config.csrf()};jQuery.post(e+"deleteSession",i).done(function(){oe.deleteGame(n.id);
})}).on("newgame",function(){d(),oe.hide(),ne.removeClass("disabled"),te.addClass("disabled"),he=void 0,pe=!1}).on("tag",function(e,i){t=i&&i.tag||void 0,oe.switchToGames(),n()}),void n())}function k(e,t){function n(){var e=Chess.gameToCouch(D.getCurrentGame(),o),t=Object.diff(H,e);Object.getLength(t)>0&&(H=e,notificationHandler.sendMessage("coaching.update",{uuid:Q,data:t}))}le?setTimeout(n):_(Q,function(e){e.get("coaching").restrictions.game||n()})}function F(){function e(){_(Q,function(e){e.get("coaching").knotId!=D.getCurrentPosition().knotId&&notificationHandler.sendMessage("coaching.goto",{knotId:D.getCurrentPosition().knotId,uuid:Q})})}le?setTimeout(e):_(Q,function(t){t.get("coaching").restrictions.move||e()})}function x(e,t){clearTimeout(x.timeout),x.timeout=setTimeout(function(){var n=E(),i=Chess.chessGameDiff(D.getCurrentGame(),n.getCurrentGame());Chess.gamePatch(D,i),H=Chess.gameToCouch(D.getCurrentGame(),o),"meta"===e.currentChannel&&t.diff&&t.diff.Title&&ae.name.trigger("setname",t.diff.Title)})}function T(){D.off(t,k),D.off(n,F);var e=E();e.off(t,x),Q=void 0,le=!1,O({game:!1,engine:!1}),G&&window.history.replaceState({},"analysis",G),r.find(".chessDB").removeClass("coachingViewer coachingAuthor")}function _(e,t){if(_.instances=_.instances||{},_.instances[e])return void setTimeout(function(){t(_.instances[e])});var n={rkey:"model:CoachingChessGameRedisAR:"+e},i=Handler.socket.getSocket(Handler.socket.types.NOTIFICATION),o=new Record.ChessGameSocketPR(n,i,function(){_.instances[e]=o,t(o)},notificationHandler.getTimeOffset())}function E(){return E.instance||(E.instance=new Chess.GameHandler),E.instance}function S(e){e?(r.find(".chessDB").addClass("withChat"),ae.chatTab.prependTo(ae.tabs),chatHandler.addChat(ae.chat,e,{viewId:"coachingchat"}),notificationHandler.on("chat",j)):(ae.chat.is(":visible")&&ae.tabs.find(":radio:last").prop("checked",!0),r.find(".chessDB").removeClass("withChat"),chatHandler.removeChat(e,"coachingchat"),ae.chatTab.detach(),notificationHandler.off("chat",j))}function j(e,t){if(j.queue=j.queue||[],ae.chatTab.find("> input").is(":checked"))j.queue=[];else if("message"===t.content.type){var n=t.content.data.message.id;j.queue.contains(n)||(j.queue.push(n),I(j.queue.length))}}function I(e){var t=ae.chatTab.find("> label").removeClass("highlighted"),n=ae.chatTab.find("> input"),i=t.find("> span");i.find(".notiBox").remove(),e>0&&!n.is(":checked")&&(t.addClass("highlighted"),i.append(jQuery('<span class="notiBox">'+e+"</span>")))}function A(){O({premium:!1,whiteList:[],blackList:[],game:!1,position:!1,engine:!1})}function O(e){e&&Object.forEach(e,function(e,t){switch(t){case"annotations":e?$("div.notationTableInlineElement").hide():$("div.notationTableInlineElement").show();break;case"game":e&&!ce?(se.chessBoard.movementHandler.deactivate(),se.chessBoard.highlightHandler.stopDrawing(),se.chessBoard.highlightHandler.stopEraser(),se.notationArea.setUserCommentWritePermission(!1),se.meta.toggleEdit(!1),r.find(".draw, .promoteMove a, .deleteMove a").addClass("disabled"),r.find(".draw").parent().removeClass("active"),r.find(".promoteMove, .deleteMove").hide(),D.setMoveMode(de).setDeleteMode(de)):!e&&ce&&(se.chessBoard.highlightHandler.stopDrawing(),se.chessBoard.highlightHandler.stopEraser(),se.chessBoard.movementHandler.activate(),se.notationArea.setUserCommentWritePermission(!0),se.meta.toggleEdit(!0),r.find(".draw, .promoteMove a, .deleteMove a").removeClass("disabled"),r.find(".draw[data-mode=off]").parent().addClass("active"),y(),D.setMoveMode(ue).setDeleteMode(ue)),ce=!!e;break;case"engine":e?window.settings.setOverride(i,!e):window.settings.removeOverride(i);break;case"premium":e&&!config.level().isPremium&&T();break;case"whiteList":e&&e.length&&!e.contains(config.user().uuid)&&T();break;case"blackList":e&&e.contains(config.user().uuid)&&T()}})}function M(e){q.toggleClass("disabled",!he||pe),e&&(Q?replaceUrl=e:window.history.pushState({},"analysis",e))}function P(e){P.queue=P.queue||[],window.settings.getBoolean("analysis-list-mode")?P.queue.push(e):e()}var B=a.initialGame,R=a.gameSessionToken,L=a.isNewPlayzoneGame,N=this;r=jQuery(r);var D,Q,H,G,V,U,z,W,q,K,Y,J,X,Z,ee,te,ne,ie,oe,re=new Handler.Template("database").append(new Handler.Template),ae={},se={},le=!1,ce=!1,de={duringGame:{mainline:!1,sideline:!1},afterGame:{mainline:!1,sideline:!1}},ue={duringGame:{mainline:!0,sideline:!0},afterGame:{mainline:!0,sideline:!0}},he=a.analysisId,pe=he&&!a.own;return N.setCurrentGame=function(e){e instanceof Chess.Game&&d(new Chess.Game({fen:e.toString(),meta:{Title:D.getMeta().Title}}))},N.subscribe=function(e,i){var a=E();notificationHandler.sendMessage("coaching.listen",{uuid:e},function(i){return i?void _(e,function(i){Q=e;var s=i.get("coaching"),l=i.get("chessGame");return a.addGame(void 0,i.get("chessGame")),a.setCurrentGame(i.get("chessGame")),E.instance.on(t,x),d(Chess.couchToGame(Chess.gameToCouch(l,o))),D.gotoId(s.knotId||0),S(s.chatRoomId),s.closedAt?(T(),void Dialog.alert({content:window.t("Coaching session is over"),comment:window.t("If you want to be able to revisit it later, save it using the button on top")})):(i.on("set.coaching",function(e,t){t.diff&&(void 0!==t.diff.knotId&&D.getCurrentPosition().knotId!==t.diff.knotId&&D.gotoId(t.diff.knotId),void 0!==t.diff.chatRoomId&&S(t.diff.chatRoomId),le||(t.diff.closedAt&&(T(),A(),Dialog.alert({content:window.t("Coaching session is over"),comment:window.t("If you want to revisit it later, you can save it using the button on top")})),setTimeout(function(){O(i.get("coaching").restrictions)},50)))}),s.author.uuid===config.user().uuid?(le=!0,r.find(".chessDB").addClass("coachingAuthor"),se.meta.toggleEdit(!0)):(O(s.restrictions),$("div.notationTableInlineElement .deleteComment").hide(),r.find(".chessDB").addClass("coachingViewer"),r.find(".coachingViewerSettings .ownerInfo").html(re.render("coachingAuthor",s.author))),D.on(t,k),D.on(n,F),Y.show(),void K.hide())}):void Dialog.alert(window.t("This coaching session is not available"))})},window.settings.on("settings.analysis-list-mode.off",function(){for(;P.queue&&P.queue.length;)P.queue.shift()()}),s()}}(),"undefined"==typeof Controller&&(Controller={}),Controller.ELearning=function(e,t,n){function i(e){for(var t=0;t<d[e].length;t++)d[e][t].funcCall(c);return c}function o(){return g.show(),f.children(".startButton").click(r),f.centerScreen(),f.show(),c}function r(){return g.hide(),f.hide(),m.show(),c.stopWatch&&c.stopWatch.start(),i("start"),c}function a(e,t){function n(r){jQuery.post(y,t).done(function(t){if(clearTimeout(i),t=t.data.badges,Array.isArray(t)&&0!==t.length){o.empty(),o.css("background-image","none");for(var n=0;n<t.length;n++){var r=jQuery('<img src="'+t[n].img+'" alt="" />'),a=jQuery("<p>"+t[n].dscr+"</p>"),s=jQuery("<h3>"+t[n].title+"</h3>");o.append(jQuery("<div/>").append(s).append(r).append(a))}}else o.hide();e.children(".feedbackButton").show()}).fail(function(e,a,s){5>r?i=setTimeout(function(){n(++r)},5e3):o.hide(),errorHandler.msg("critical",new Error("save failed for exercise"),!1,{data:t,nr:r,textStatus:a,errorThrown:s})})}var i,o=e.children(".badgeAchieved");return n(0),c}function s(e,n,i){g.show(),e.children(".subLessonProgressBar").progressbar({value:Math.floor(t.progress.completed/t.progress.total*100)}),e.children(".pointsGained").text(n),c.stopWatch&&(e.children(".timeLeft").text(c.stopWatch.getCurrentValue(!0)),e.children(".timeRun").text(c.stopWatch.getTimeRun(!0)));for(var o=0;o<i.length;o++)i[o].show();return e.centerScreen(),e.show(),e.children(".badgeAchieved").show(),c}function l(e){function t(){return l=s.runDown?s.init+c-Date.now():s.init+Date.now()-c,void 0!==s.stop&&(s.runDown?l<s.stop&&(l=s.stop):l>=s.stop&&(l=s.stop)),f}function i(){return clearTimeout(h),t(),o(),h=setTimeout(i,100),void 0!==s.stop&&(s.runDown?l<=s.stop&&f.stop():l>=s.stop&&f.stop()),f}function o(){return v.html(r(l)),l<s.timeBonus?p!==!0&&(p=!0,v.addClass("stopWatchNegative")):p!==!1&&(p=!1,v.removeClass("stopWatchNegative")),f}function r(e){if(0>e){var t="-";e=-1*e}else t="";if(2e4>e){e=Math.floor(e/100);var n=Math.floor(e/10),i=e%10;return t+n+"."+i}e=Math.floor(e/1e3);var o=Math.floor(e/60);return n=e%60,t+o+":"+(10>n?"0":"")+n}var a=!0,s={runDown:!1,init:0,timeBonus:0,stop:void 0};void 0!==n&&jQuery.extend(s,e);var l,c,d,u,h,p,f=this;return f.start=function(){return c=Date.now(),i(),f},f.stop=function(){return a&&(a=!1,d=Date.now(),u=d-c,clearTimeout(h),t()),l},f.getCurrentValue=function(e){return e?r(l):l},f.getTimeRun=function(e){return e?r(u):u},f}var c=this;c.container=e,c.containerWithoutHash=e.substr(1),""==c.container&&errorHandler.msg("critical",new Error("no container given"),!0);var d={start:[]},u=jQuery(c.container+"_donePerfect"),h=jQuery(c.container+"_doneGood"),p=jQuery(c.container+"_doneBad"),f=jQuery(c.container+"_intro"),g=jQuery(c.container+"_overlay"),m=jQuery(c.container+"_introAfterStart"),v=jQuery(c.container+"_stopWatch"),y="/api/web/campusSchoolAPI/saveExerciseResult";return"object"!=typeof t&&errorHandler.msg("critical",new Error("exerciseData not given"),!0,{exerciseData:t}),void 0===t.id&&errorHandler.msg("critical",new Error("exerciseData.id not given"),!0,{exerciseData:t}),0==f.length&&errorHandler.msg("critical",new Error("exercises has no intro text"),!0),0==u.length&&errorHandler.msg("critical",new Error("exercises has no perfect feedback"),!0),c.removeListener=function(e,t){for(var n=0;n<d[e].length;n++)if(d[e][n].funcCall===t){d[e].splice(n,1);break}return c},c.addListener=function(e,t,n){var i={funcCall:n,instanceOfClass:t};return d[e].push(i),c},c.getRandomPiece=function(e,t){if(t=t||["R","r","N","n","B","b","Q","q","K","k"],e=e||1,1>e){for(var n=[];n.length<e;)n.push(t.splice(Math.floor(Math.random()*e),1)[0]);return n}var i=Math.floor(Math.random()*t.length);return t[i]},c.exerciseComplete=function(e,n,i){e=e||!1,n=n||!1,i=i||!1;var o=[],r=0,l={exerciseId:t.id,activity_points:e,bonus_time:n,bonus_perfect:i};if(e)if(n===t.timeBonus.possible&&i===t.perfectBonus.possible)var d=u;else d=h;else d=p;return e&&t.progress.completed++,(e||t.solved.reached)&&(r+=t.solved.ap),n||t.timeBonus.reached?(r+=t.timeBonus.ap,o.push(d.children(".hasTimeBonus"))):o.push(d.children(".hasNoTimeBonus")),i||t.perfectBonus.reached?(r+=t.perfectBonus.ap,o.push(d.children(".hasPerfectBonus"))):t.perfectBonus.possible&&o.push(d.children(".hasNoPerfectBonus")),(i||t.perfectBonus.reached||n||t.timeBonus.reached)&&o.push(d.children(".hasBonus")),s(d,r,o),a(d,l),c},c.getRandomSquares=function(e,t,n,i){e=e||1,t=t||[],n=n||[],void 0===i&&(i=!0),e+t.length>64&&(errorHandler.msg("error",new Error("there are not enough squares"),!0,{amount:e,doNotUseThisFields:t}),e=64-t.length);for(var o=[],r=[],a=0,s=0;8>s;s++)for(var l=0;8>l;l++){var c=Chess.getSquare(s,l);-1===t.indexOf(c)&&r.push(c)}for(s=0;e>s;s++){if(a<n.length){var d=n[a++],u=r.indexOf(d);-1===u&&errorHandler.msg("critical",new Error("square you want is not possible"),!0,{possibleSquares:r,mustContain:n,squareComingFromContain:d})}else u=Math.floor(Math.random()*r.length);o.push(r[u]);var h=[];if(i)h.push(u);else{for(var p=-1;2>p;p++)for(var f=-1;2>f;f++){var g=r.indexOf(r[u].getNewSquare(p,f));-1!==g&&h.push(g)}h.sort(function(e,t){return t-e})}for(p=0;p<h.length;p++)r.splice(h[p],1)}return o},0!==v.length&&(c.stopWatch=new l(n)),o(),c},"undefined"==typeof Controller&&(Controller={}),Controller.LiveVideo=function(e,t){function n(){if(!p.length||!h.length)return l;var e="live"===window.location.hash.substring(1),t=h.find("div.list ul > li.live");return e&&t.length?t.first().trigger("click"):h.find("div.list ul > li.active").trigger("click",{autoPlay:!1}),i(),r(),jQuery(window).on("resize",r),l}function i(){function e(e){e=e.split(","),jQuery("input.language").each(function(){var t=jQuery(this),n=t.val();e.contains(n)?t.prop("checked",!0):t.prop("checked",!1)})}function n(){var e=s.val(),t=i();return{query:e,languages:t}}function i(){var e=[];return c.each(function(t,n){var i=jQuery(n);i.prop("checked")&&e.push(i.val())}),e.join(",")}function r(e){if(e=e||{},e.query=e.query||"",e.languages=e.languages||i(),e.autoSelect=e.autoSelect||!1,!a||e.query!==a.query||e.languages!==a.languages){a=e;var n=h.find(".list .videoList");n.lazyload("reset").find("> ul").remove(),n.lazyload({url:w,data:{query:e.query,languages:e.languages,permalink:t,offset:0},distance:50,array:"liveVideos",onstart:function(){n.append(f)},onload:function(t){f.detach(),o(t.data,e.autoSelect),e.autoSelect=!1}})}}var a,s=h.find(".searchQuery"),l=h.find(".searchQueryClear"),c=h.find(".languageSelector input.language"),d=window.settings.get("live-video-languages");e(d);var u=Object.merge(n(),{autoSelect:!0});r(u),s.on("propertychange change click keyup input paste",function(){""===s.val().trim()?l.addClass("disabled"):l.removeClass("disabled");var e=n();r(e)}),c.on("change",function(){var e=n();window.settings.set("live-video-languages",e.languages),r(e)}),l.on("click",function(e){l.addClass("disabled"),s.val(""),r()})}function o(e,n){n=n||!1;var i=h.find(".list .videoList"),o=u.render("list",e),r=jQuery(o);r.find("li").add(r.filter("li")).on("click",function(){a(this)});var s=i.find("> ul");if(s.length?s.append(r.contents()):i.append(r),i.find(".showAge").showAge(),n){if(t)var l=!0,c=i.find("li.active");else l=!1,c=i.find("li").first();c.length&&a(c,{autoPlay:l})}}function r(){var t=jQuery(window).height()-200;e.css("min-height",t.toString()+"px").height(t)}function a(e,n){function i(){c=chatHandler.addChat(p.find("div.chat"),[v],{viewId:"liveVideo"}),d=v}if(e){n=n||{},n.autoPlay=n.autoPlay!==!1;var o=jQuery(e),r=o.data("title"),a=o.data("description"),l=o.data("provider-name"),f=o.data("account"),g=o.data("event");t=o.data("permalink");var m=o.data("video"),v=o.data("chatroom"),w=o.data("commentator"),b=o.data("commentator-user-uuid"),C=o.data("commentator-profile-url"),k=o.data("commentators-title"),F=o.data("language"),x=o.data("has-access"),T=!0;l!==y||g||(T=!1);var _=p.data("permalink");if(_!==t){var E=s(l,n.autoPlay);if(h.find("div.list ul > li.active span.active").hide(),h.find("div.list ul > li.active span.inactive").show(),o.find("div.startAt > span.inactive").hide(),o.find("div.startAt > span.active").show(),h.find("div.list ul > li").removeClass("active"),o.addClass("active"),p.data("permalink",t),p.find("div.details").html(u.render("details",{title:r,description:a,commentator:w,commentatorProfileUrl:C,commentatorUserUuid:b,language:F,commentatorsTitle:k})),p.find("div.description").html(u.render("description",{description:a})),History.pushState(null,"LiveVideo",u.render("url",{permalink:t})),!x)return p.find("div.premiumOverlay").show(),p.find("div.liveShowVideoModes").hide(),void p.find("div.iframe").hide();p.find("div.premiumOverlay").hide(),p.find("div.liveShowVideoModes").show(),p.find("div.iframe").show().html(u.render("iframe."+l,{account:f,event:g,video:m,autoPlay:E,isVideo:T})),d?chatHandler.removeChat(d,"liveVideo",i):i();var S=p.find(".cIconInfo"),j=p.find(".description");j.hide(),S.on("click",function(){j.slideToggle()}),layout.userMiniprofile(p)}}}function s(e,t){if("boolean"!=typeof t)switch(e){case g:return!0;case m:return"1";case v:return!0;case y:return!0}switch(e){case g:return t.toString();case m:return t?"1":"0";case v:return t.toString();case y:return t.toString()}}var l=this;e=jQuery(e),0===e.length&&errorHandler.error(new Error("container not found in Controller.LiveVideo"),{container:e});var c,d,u=new Handler.Template("liveVideo").append(new Handler.Template),h=jQuery(e.children("div.navigation")),p=jQuery(e.children("div.current")),f=jQuery(u.render("commonLoader")),g="livestream",m="youtube",v="vimeo",y="twitch",w="/api/web/LiveVideoAPI/getLiveVideos";return n()},function(){function e(){function e(){T=new Handler.Template("playZone").append(new Handler.Template("colorHeader")),E=new Chess.GameHandler,n=P,B&&s("noGame",d),jQuery(".bodyContainer.liveTournament").length||jQuery("body").removeClass("broadcast").addClass("playZone"),Extend.Suspendable(P);var e=["soundView","clockTop","clockBottom"];return P.onSuspend(function(){j&&j.views&&e.forEach(function(e){j.views[e]&&j.views[e].suspend()})}),P.onResume(function(){j&&j.views&&e.forEach(function(e){j.views[e]&&j.views[e].resume()})}),window.settings.on("settings.game-blindfold",k),P}function o(e,t){var n=e.gameSessionToken,i=e.playingHandler,o=e.gameHandler;conversationHandler.off("inGame."+n),"b"===e.role?(e.upperRole="w",e.lowerRole="b"):(e.upperRole="b",e.lowerRole="w"),L[e.gameSessionToken]=e,i.on("startGameSession",function(e,t){var n=t.game;n.setMoveMode({duringGame:{sideline:!1,mainline:!0},afterGame:{sideline:!0,mainline:!1}}),o.emit("startPlayZoneGame",n),Handler.tracking("playzone","gameStart",n.getType()),n.setCheckForGameEnd(!1).setCalcTimeSpendInThisMove(!0).setNoTimeout(!1),o.addGame("landing",n).setCurrentGame("landing"),n.link(o)}).on("selfDisconnected",function(e){o.emit(e.channel)}).on("selfReconnected",function(t){e.gameHandler.emit(t.channel)}).on("gameSessionResults",function(e,n){t(n)}).link(o)}function r(e){function t(e,t){var n=E.getCurrentGame(),i=t.game;"s"===t.role?i.setMoveMode({duringGame:{sideline:!0,mainline:!1},afterGame:{sideline:!0,mainline:!1}}):(i.setMoveMode({duringGame:{sideline:!1,mainline:!0},afterGame:{sideline:!0,mainline:!1}}),E.emit("startPlayZoneGame",i),C(t.role),Handler.tracking("playzone","gameStart",i.getType())),i.setCheckForGameEnd(!1).setCalcTimeSpendInThisMove(!0).setNoTimeout(!1),i.link(E),v(_),!i.isOver()&&i.getMeta().GameUUID===n.getMeta().GameUUID&&t.role===i.getEndOfMainlinePosition().moveRight&&i.getDepth()+1===n.getDepth()&&i.getEndOfMainlinePosition().isLegalMove(n.getEndOfMainlinePosition().moveCoords)&&i.move(n.getEndOfMainlinePosition().moveCoords,i.getEndOfMainlinePosition(),void 0,void 0,"local"),n.destroy(),jQuery(".btnBiggerBoard").parent().show(),View.PlayButton.isPlaying(y),M&&"s"===t.role?C(t.game.getMeta().White.UUID===M?"w":"b"):O&&"s"===t.role&&C("s"),O&&O.suspend(),F.role=t.role,k(),O||r||x(i.getMeta()),p(t,j.$containers)}function n(){E.emit("selfDisconnected")}function i(){E.emit("selfReconnected")}function o(e,t){if(t.gameSessionToken&&t.chessGame){var n=t.chessGame.moves&&Chess.couchToGame(t.chessGame)||new Chess.Game;n.setMeta(t.meta),n.setGameEndByPoints(t.whiteResult,t.blackResult,t.endedBy),n.link(E),E.setCurrentGame(n),j.views.board.setUserMoveRight(["b","w"]).attachKeyboardHandler(),n.setRules("analyse").setMoveMode({duringGame:{sideline:!0,mainline:!1},afterGame:{sideline:!0,mainline:!1}}),b(!n.getMeta().TournamentUUID,!0)}l("duringGame"),v(_),O&&O.resume()}if(void 0!==e&&void 0!==e.gameSessionToken&&void 0!==e.authToken){var r=!!e.broadcast;e.mode=e.mode||"analysis",e.role=e.role||"s",e.clock=e.clock||0,e.increment=e.increment||0,e.moveRight="s"!==e.role&&"analysis"!==e.mode?e.role:["w","b"],"b"===e.role?(e.upperRole="w",e.lowerRole="b"):(e.upperRole="b",e.lowerRole="w"),_&&conversationHandler.off("inGame."+_,w);var s=_=e.gameSessionToken;I&&s&&I.setGameSessionToken(s),conversationHandler.on("inGame."+_,w);var c=e.authToken;if(e.url=e.url||T.render("gameURL",{gameSessionToken:s}),L[e.gameSessionToken]=e,!O||e.stream)var d=e.container?jQuery(e.container):jQuery("div.contentContainer div.playZone");if(!d||0===d.length)return parseInt(jQuery("body").data("embed"),10)>0?(jQuery("<a/>").attr("href",e.url).css("display","none").attr("target","_blank").appendTo("body").get(0).click(),void setTimeout(function(){Dialog.alert(window.t('If the new window with the game did not open, please <a href="{url}" target="_blank">click here</a>',{"{url}":e.url}))},100)):window.location=e.url;if(void 0===j?j=u(d,e):(h(e),"human"!==e.mode||jQuery("body").data("embed")||O||History.pushState(null,"PlayZone",e.url)),e.stream&&g(e.stream,e),jQuery("body").data("embed")&&(jQuery("body").removeClass("initial"),jQuery(".playNowContainer .playNowButton").fadeOut()),void 0!==S&&(j.views.disconnected&&j.views.disconnected.unlink(S),j.views.SpectatorList&&j.views.SpectatorList.unlink(S),S.disconnect().unlink(E).off()),"human"===e.mode&&(S=new Handler.Playing(s,c,e.playingServer),S.on("startGameSession",t).on("selfDisconnected",n).on("selfReconnected",i).on("gameSessionOver",o).on("gameSessionResults",a).link(E),void 0!==j.views.SpectatorList&&j.views.SpectatorList.link(S),b("s"===e.role&&!E.getMeta().TournamentUUID,"s"===e.role)),"analysis"===e.mode){var m=e.chessGame;m=Chess.couchToGame(m),m.setRules("analyse").setMoveMode({duringGame:{sideline:!0,mainline:!1},afterGame:{sideline:!0,mainline:!1}}).setCheckForGameEnd(!1).setCalcTimeSpendInThisMove(!0).setNoTimeout(!1).link(E),M&&"s"===e.role&&C(M===m.getMeta().White.UUID?"w":"b"),b(!0,!0),O||r||x(m.getMeta())}if("standby"===e.mode?((new Chess.Game).link(E),b(!1,!1),O||r||x()):f(s),"human"!==e.mode||"w"!==e.role&&"b"!==e.role)j.$containers.drawResignButtons.hide(),y=!1;else{j.$containers.drawResignButtons.show();var y=!0}!j.views.disconnected&&j.$containers.disconnected.length&&("human"===e.mode||O)&&(j.views.disconnected=new View.Disconnected(j.$containers.disconnected).link(E)),j.views.board&&j.views.board.movementHandler&&j.views.board.movementHandler.setPremove(y?void 0:!1),R=e.role,v(_)}}function a(e,t){var n=t.getGameStatus(),i=L[_];if(i.chessGame=t,void 0!==n.endedBy&&(View.PlayButton.isPlaying(!1),j.views.board.attachKeyboardHandler(),t.hasEndedWithMove()?i.delay=1e3:i.delay=0,"w"===i.role||"b"===i.role?Dialog.playZone.afterTheGame(i):S.disconnect(),A&&A.modal("hide",!0),l("duringGame"),jQuery("body").data("embed")&&(jQuery(".poweredByChess24").attr("href",i.poweredByChess24),s("noGame",d),jQuery(".playNowContainer .playNowButton").fadeIn()),["w","b"].contains(i.role))){var o=n.result["w"===i.role?"white":"black"];o=1===o&&"won"||0===o&&"lost"||"draw",Handler.tracking("playzone","gameEnd",o)}return i.chessGame.setRules("analyse").setMoveMode({duringGame:{sideline:!0,mainline:!1},afterGame:{sideline:!0,mainline:!1}}),j.views.board.setUserMoveRight(["b","w"]),O&&O.resume(),b(j.$containers.spectatorList.is(":visible"),!0),P}function s(e,t){jQuery(document).on("click."+e,"a",t)}function l(e){jQuery(document).off("click."+e,"a")}function c(e){var n=this,i=jQuery(this),o=i.attr("href");return i.hasClass("noWarnOnLeave")?(e.preventDefault(),void d.apply(n,[e])):void(void 0!==o&&""!==o.trim()&&"#"!==o.trim()&&(e.preventDefault(),A=Dialog.confirmation(t("Are you sure you want to leave the game?"),function(){d.apply(n,[e])})))}function d(e){var t=jQuery(this),n=t.attr("href");void 0!==n&&""!==n.trim()&&"#"!==n.trim()&&(e.preventDefault(),jQuery("body").data("embed")?window.open(n):window.location.href=n)}function u(e,t){var n={},i={},o=t.template||"main";e.html(T.render(o,{isGuest:config.level().isGuest,permalink:config.user().permalink,stream:t.stream,broadcast:!!t.broadcast})),n.main=e,n.chessGame=e.find(".chessGame"),n.board=e.find(".chessBoard"),n.clockTop=e.find(".clocks .top"),n.clockBottom=e.find(".clocks .bottom"),n.capturedPiecesTop=e.find(".left .top .capturedPieces"),n.capturedPiecesBottom=e.find(".left .bottom .capturedPieces"),n.playerInfoTop=e.find(".top .playerInfo"),n.playerInfoBottom=e.find(".bottom .playerInfo"),n.gameInformation=e.find(".gameInformation"),n.notationTable=e.find(".notationTable"),n.cursor=e.find(".cursor"),n.disconnected=e.find(".disconnected"),n.spectatorList=e.find(".spectatorArea"),n.spectatorChat=e.find(".spectatorChat"),n.flipBoardButton=e.find(".burgerMenu .flipBoard"),n.settingsButton=e.find(".burgerMenu .settings"),n.playPositionButton=e.find(".burgerMenu .playPosition"),n.drawResignButtons=e.find(".drawResignButtons"),n.drawButton=e.find(".drawButton"),n.resignButton=e.find(".resignButton"),n.firstMoveTimeout=e.find(".secondsBeforeLosing"),n.afterGameControls=jQuery("<div/>"),n.reportGameButton=e.find(".reportGameButton"),n.autoPlayButton=e.find(".btnAutoPlay"),n.autoCommentator=e.find(".autoCommentator"),n.boardXLButton=e.find(".btnBiggerBoard"),n.bottomToggle=e.find(".bottomToggle"),n.chessGame.addClass(t.mode),n.chessGame.addClass(t.role);var r="b"!==t.role,a="s"===t.role||t.chessGame&&t.chessGame.gameStatus&&t.chessGame.gameStatus.endedBy,s=F();if(t.nonExclusiveView)i.board=new View.ChessBoard(n.board,!1,Handler.Highlight,!1).link(E);else{i.board=new View.ChessBoard(n.board,!0,Handler.Highlight,a).link(E).setUserMoveRight(t.moveRight).setBlindfold(s).flip(r);var l=i.board.getKeyboardHandler();l&&Handler.KeyboardDispatcher.add(l,e)}if(i.clockTop=new View.ChessClock(n.clockTop,t.upperRole).link(E),i.clockBottom=new View.ChessClock(n.clockBottom,t.lowerRole).link(E),n.capturedPiecesTop.length&&(i.capturedPiecesTop=new View.CapturedPieces(n.capturedPiecesTop,[t.lowerRole]).link(E)),n.capturedPiecesBottom.length&&(i.capturedPiecesBottom=new View.CapturedPieces(n.capturedPiecesBottom,[t.upperRole]).link(E)),i.playerInfoTop=new View.PlayerInfo(n.playerInfoTop,t.upperRole).link(E),i.playerInfoBottom=new View.PlayerInfo(n.playerInfoBottom,t.lowerRole).link(E),n.notationTable.length&&(i.notationArea=new View.NotationArea(n.notationTable,"playing").toggleExtension("PlayZoneChat",["w","b"].contains(t.role)).setBlindfold(s).link(E)),n.cursor.length&&(i.cursor=new View.Cursor(n.cursor,!1,void 0,!0).link(E)),n.flipBoardButton.length&&(i.flipBoardButton=new View.FlipBoard(n.flipBoardButton).link(E)),!t.nonExclusiveView&&(i.soundView=new View.Sound("playzone").setUserRole(t.role).link(E),n.autoCommentator.length)){var c=n.autoCommentator.find("input");c.prop("checked",window.settings.getBoolean("auto-commentator")),c.on("change",function(){window.settings.set("auto-commentator",c.prop("checked")?1:0)}),i.autoCommentator=(new View.AutoCommentator).link(E)}return t.nonExclusiveView||(i.pageTitle=(new View.PlayingPageTitle).setUserRole(t.role).link(E)),n.spectatorList.length&&(i.SpectatorList=new View.SpectatorList(n.spectatorList).link(E)),n.autoPlayButton.length&&i.board.movementHandler&&(i.autoPlay=new View.AutoPlay(n.autoPlayButton).link(E).link(i.board.movementHandler)),n.boardXLButton.length&&(i.boardXL=new View.BoardXL(n.boardXLButton)),n.settingsButton.on("click",function(){(new Dialog.PlayzoneSettings).getContent().modal("show")}),n.playPositionButton.on("click",function(){goToNewHousePlay()}),n.bottomToggle.on("click",function(){n.bottomToggle.is(".disabled")||b()}),n.drawButton.length&&(i.drawButton=new View.DrawButton(n.drawButton,function(){return R}).link(E)),n.resignButton.length&&(i.resignButton=new View.ResignButton(n.resignButton).link(E)),"human"!==t.mode||"w"!==t.role&&"b"!==t.role?n.drawResignButtons.show():n.drawResignButtons.hide(),n.firstMoveTimeout.length&&(i.firstMoveTimeout=new View.FirstMoveTimeout(n.firstMoveTimeout).link(E)),p(t,n),i.board.adjust(),{$containers:n,views:i}}function h(e){void 0!==j.views.board&&j.views.board.setUserMoveRight(e.moveRight),void 0!==j.views.pageTitle&&j.views.pageTitle.setUserRole(e.role),void 0!==j.views.soundView&&j.views.soundView.setUserRole(e.role),void 0!==j.views.notationArea&&j.views.notationArea.toggleExtension("PlayZoneChat",["w","b"].contains(e.role)),j.$containers.chessGame.removeClass("analysis human").addClass(e.mode),j.$containers.chessGame.removeClass("b w s").addClass(e.role),j.views.boardXL&&j.views.boardXL.update(),C(e.role),p(e,j.$containers)}function p(e,t){function n(e){function t(e){var t={};return t.uuid=e.UUID?e.UUID:e.uuid,t.name=e.Name?e.Name:e.name,t}var n=[],i={},o={};if(e.chessGame&&e.chessGame.meta)i=t(e.chessGame.meta.White),o=t(e.chessGame.meta.Black);else if(e.stream&&e.stream.buffer)for(var r in e.stream.buffer){var a=e.stream.buffer[r];a&&a.gameSessionToken==e.gameSessionToken&&(i=t(a.data.player.white),o=t(a.data.player.black))}else if(e.game){var s=e.game.getMeta();i=t(s.White),o=t(s.Black)}return i.uuid&&config.user().uuid!==i.uuid&&n.push({name:i.name,uuid:i.uuid}),o.uuid&&config.user().uuid!==o.uuid&&n.push({name:o.name,uuid:o.uuid}),n}"w"!==e.role&&"b"!==e.role||"human"!==e.mode||(l("noGame"),s("duringGame",c)),jQuery("body").data("embed")&&(e.poweredByChess24=jQuery(".poweredByChess24").attr("href"),jQuery(".poweredByChess24").attr("href",e.url)),users=n(e),t.reportGameButton.length&&t.reportGameButton.off("click.report").on("click.report",function(){Dialog.userReport({source:"playzone",referenceId:e.gameSessionToken,users:users})}),jQuery(document).trigger("onLoadAdvertisement")}function f(e){if(j.$containers.spectatorChat.length){var t=j.$containers.spectatorChat.data("roomId");t&&chatHandler.removeChat(t);var n="playzone."+e;j.$containers.spectatorChat.data("roomId",n),chatHandler.addChat(j.$containers.spectatorChat,n)}}function g(e,t){function n(e){var t=e.data("href-"+config.language());t&&j.$containers.main.find(".topGamesLink").attr("href",t)}if(e.user)O||(O=new Handler.Stream("channel:gameSession:add:"+e.user,e).link(notificationHandler)),M=e.user;else if("topgames"==e.filter){switch(e.type="classic",e.eloType){case"1":case 1:e.type="bullet";break;case"2":case 2:e.type="blitz"}if(!O){var i=["channel:gameSession:topgame:bullet","channel:gameSession:topgame:blitz","channel:gameSession:topgame:classic"];O=new Handler.Stream(i,e).link(notificationHandler),O.playzoneOption(Object.subset(t,["container","template","nonExclusiveView"]));var o=j.$containers.main.find(".playzoneStreamGameTypes li");o.length&&(o.removeClass("active").filter("."+e.type).addClass("active").end().find("a").on("click",function(){var e=jQuery(this),t=e.closest("li");if(!e.is(".active")){var i=t.attr("class"),r=3;switch(i){case"bullet":r=1;break;case"blitz":r=2}o.removeClass("active"),t.addClass("active"),O.option("eloType",r);var a=e.attr("href");return a&&History.pushState(null,null,a),n(e),!1}}),n(o.filter(".active").find("a")))}}}function m(){var e,t=E.getMeta(),n=config.user().uuid;return Chess.colors.both.metaData.some(function(i){return t[i].UUID&&t[i].UUID!==n?e=t[i].UUID:void 0}),e}function v(e){var t=m();e&&t&&(conversationHandler.blockInGameMessageNotificationsFrom(m()),conversationHandler.getConversationInGame(t,e,function(e){var t=e.messages;t&&t.forEach(y)}))}function y(e){E.addChat(e.user,e.content,e.timestamp,e.moveId)}function w(e,t){E.addChat(t.message.user.uuid,t.message.content,t.message.timestamp,t.context.moveId)}function b(e,t){void 0===e&&(e=!j.$containers.spectatorList.is(":visible")),void 0===t&&(t=!0),j.$containers.spectatorList.toggle(e),j.$containers.spectatorChat.toggle(e),j.$containers.bottomToggle.toggleClass("sortDesc",!e).toggleClass("sortAsc",e),j.$containers.bottomToggle.toggleClass("disabled",!t)}function C(e){("b"===e&&"b"!==R||"b"!==e&&"b"===R)&&(R="b"===R?"w":"b",jQuery(function(){E.emit("flipBoard")}))}function k(){var e=F();j.views.board.setBlindfold(e),j.views.notationArea&&j.views.notationArea.setBlindfold(e)}function F(){var e=window.settings.get("game-blindfold");return"own"===e?"b"===F.role?"black":"w"===F.role?"white":"none":e}function x(e){e=Object.copy(e),layout.safe(function(){jQuery(document).trigger("chess24:header",{template:"game",data:e})})}var T,_,E,S,j,I,A,O,M,P=this,B=jQuery("body").data("embed"),R="w",L={},N=!1;return P.getCurrentGameSessionToken=function(){return _},P.getCurrentGameSession=function(){return L[_]},P.getCurrentGame=function(){return E.getCurrentGame()},P.playNow=function(e){if(!N){N=!0;var t=config.user().authToken;View.PlayButton.isLoading(!0),jQuery.ajax({type:"GET",url:i+"?authToken="+t}).done(function(n){var i=n.data.openGameSessions;if(n.data.isAllowed){if(0===i.length)Dialog.playZone.playNow(n.data).show(),void 0!==n.data.nextTournamentStartsAt&&(new Dialog.PlayZone).setTimeWarning(n.data.nextTournamentStartsAt+notificationHandler.getTimeOffset(),!!n.data.nextTournamentRunning),"function"==typeof e&&e();else if(i.length>0){var o={gameSessionToken:i[0].token,authToken:t,role:i[0].role,mode:"human",playingServer:{host:i[0].host,port:i[0].port}};if(i[0].tournamentUuid){var a=T.render("playzoneTournamentURL",{tournamentId:i[0].tournamentUuid,play:!0});return void(window.location=a+"#play");
}r(o)}}else n.data.suspended?Dialog.alert(window.t("Playzone is temporarily disabled, please try again in a couple of minutes.")):Dialog.conversionRegister("playZone")}).always(function(){N=!1,View.PlayButton.isLoading(!1)})}},P.resetLayout=function(){if(!j)return P;for(var e in j.views)j.views[e].unlink&&j.views[e].unlink(E);return j=void 0,P},P.initGameSession=r,P.initRestrictedGameSession=o,e()}"undefined"==typeof Controller&&(Controller={});var n,i="/api/web/playzoneAPI/playNow",o={},r="/api/web/NodeServerAPI/getPlayingServer";Controller.getPlayZone=function(){return void 0!==n?n:new e},Controller.getPlayingServer=function(e){var t=new Helper.Deferred;return o[e]?(t.resolve(o[e]),t.promise):(jQuery.ajax({type:"GET",url:r+(e?"?gameSessionToken="+e:"")}).done(function(n){o[e]=n.data.server,t.resolve(o[e])}).fail(function(e,n,i){t.reject(new Error("No playing server available ("+i+")"))}),t.promise)}}(),"undefined"==typeof Controller&&(Controller={}),"undefined"==typeof Controller.Recommender&&(Controller.Recommender={}),Controller.Recommender.BASE_URL="/api/web/RecommenderAPI/",Controller.Recommender.URL_PLAYZONE_GAME=Controller.Recommender.BASE_URL+"getRecommendationForPlayzoneGame",Controller.Recommender.URL_BROADCAST_GAME=Controller.Recommender.BASE_URL+"getRecommendationForBroadcastGame",Controller.Recommender.RECOMMENDATION_KEY_PLAYZONE="game-recommendation-playzone",Controller.Recommender.RECOMMENDATION_KEY_BROADCAST="game-recommendation-broadcast",Controller.Recommender.addRecommendationForGame=function(e,t){function n(n){var i=n.data.recommendation;Controller.Recommender.clearRecommendation(e),i.url&&(t.recommendation=i,Controller.Recommender.renderRecommendation(e,i))}var i="";if(t instanceof Chess.GameHandler){var o=t.getCurrentGame();i=t.getKeyForGame(o),t=o}var r=Object.getLength(t.getAllPositions());if(1===r&&Controller.Recommender.renderEmptyRecommendation(e),Controller.Recommender.shouldShowRecommendation(t,i)){if(Controller.Recommender.getPlayzoneGameIdentifier(t))return void Controller.Recommender.getRecommendationForPlayzoneGame(t,n);Controller.Recommender.getRecommendationForBroadcastGame(t,i,n)}else Controller.Recommender.clearRecommendation(e)},Controller.Recommender.renderRecommendation=function(e,t){var n=new Handler.Template("notationTable");Controller.Recommender.clearRecommendation(e);var i="",o={render:null,recommendation:i};t.url&&(o.render=!0,o.recommendation=Controller.Recommender.getTemplateHtml(t));var r="extensions.recommendation",a=$(n.render(r,{render:o.render,headline:t.headline,recommendation:o.recommendation})),s=Controller.Recommender.getRecommendationContainer(e);0===s.length?e.append(a):s.replaceWith(a)},Controller.Recommender.getTemplateHtml=function(e){var t=Handler.Template("dashboard");return e.is_featured?Mustache.render(t.getTemplates()._featured_ad_item,{url:e.url,headline:e.headline,title:e.title,description:e.description,lang_code:e.lang_code,image_url:e.image_url}):Mustache.render(t.getTemplates()._learn_item,{link:e.url,author:e.author,author_title:e.author_title,headline:e.headline,title:e.title,author_multiple:e.author_multiple,lang_code:e.lang_code,image_url:e.image_url,items_count:e.items_count})},Controller.Recommender.getRecommendationForPlayzoneGame=function(e,t){if(e.recommendationRequested=!0,e&&e.recommendation)return t(e.recommendation);var n=Controller.Recommender.URL_PLAYZONE_GAME,i={gameSessionToken:Controller.Recommender.getPlayzoneGameIdentifier(e),lang:config.language()};$.getJSON(n,i,t)},Controller.Recommender.getRecommendationForBroadcastGame=function(e,t,n){if(e.recommendationRequested=!0,e.recommendation){var i={data:{recommendation:e.recommendation}};return n(i)}var o=Controller.Recommender.URL_BROADCAST_GAME;if("default"!==t){var r=e.getAllPositions(),a=$.map(r,function(e){return{fen:e.toString()}}),s={gameIdentifier:t,moves:a.slice(0,30),lang:config.language(),csrf:config.csrf()};$.post(o,s).done(n)}},Controller.Recommender.getRecommendationContainer=function(e){return e.find(".recommendationAfterTheGameNotation")},Controller.Recommender.clearRecommendation=function(e){var t=Controller.Recommender.getRecommendationContainer(e);t.find("h4").empty(),t.find("ul").empty()},Controller.Recommender.renderEmptyRecommendation=function(e){Controller.Recommender.renderRecommendation(e,{})},Controller.Recommender.getPlayzoneGameIdentifier=function(e){return e.getMeta().GameUUID},Controller.Recommender.shouldShowRecommendation=function(e,t){function n(){return 0!=settings.get(Controller.Recommender.RECOMMENDATION_KEY_BROADCAST)}function i(){return 0!=settings.get(Controller.Recommender.RECOMMENDATION_KEY_PLAYZONE)}var o=Object.getLength(e.getAllPositions()),r=31,a=10;return""===t?!1:Controller.Recommender.getPlayzoneGameIdentifier(e)?!e.getMeta().Result||a>=o?!1:i():e.getMeta().Result&&o>a||o>=r?n():!1},Controller.Recommender.setDefaultShowRecommendationPlayzone=function(){null===settings.get(Controller.Recommender.RECOMMENDATION_KEY_PLAYZONE)&&window.settings.set(Controller.Recommender.RECOMMENDATION_KEY_PLAYZONE,1)},Controller.Recommender.setDefaultShowRecommendationBroadcast=function(){null===settings.get(Controller.Recommender.RECOMMENDATION_KEY_BROADCAST)&&window.settings.set(Controller.Recommender.RECOMMENDATION_KEY_BROADCAST,1)},jQuery(function(){function e(e){e.each(function(e){var t=jQuery(this);setTimeout(function(){t.addClass("active")},200*e)})}jQuery("#c24LandingFullPage").fullpage({lockAnchors:!0,autoScrolling:!0,scrollBar:!0,controlArrows:!1,fitToSection:!1,lazyLoading:!0,scrollingSpeed:500,navigation:!0,bigSectionsDestination:"top",slidesNavigation:!0,responsiveHeight:760,afterRender:function(){jQuery(".preLoader").remove(),setInterval(function(){jQuery.fn.fullpage.moveSlideRight()},15e3)},afterLoad:function(t,n){if("sectionNews"===t){var i=jQuery(".sectionNews .imgHolder");i.removeClass("active"),e(i)}}}),jQuery(".slideDown").on("click",function(){jQuery.fn.fullpage.moveSectionDown()})}),jQuery(function(){function e(){function e(){c.on("movedPositionPointer.current",n),d.movementHandler.isActive()||d.movementHandler.activate()}function t(){c.off("movedPositionPointer.current",n),setTimeout(function(){d.movementHandler.isActive()&&d.movementHandler.deactivate()})}function n(e,n){var r=c.getCurrentPosition().getSan();jQuery(".userMove",o).val(r),u.removeClass("disabled"),t(),i(r===l?!0:!1)}function i(e){h.show(),h.find("> div").hide(),e===!0?jQuery(".solutionCorrect",o).show():jQuery(".solutionInorrect",o).show()}var o=jQuery("#landginPuzzleContainer");if(o.length){var r=[["3r3k/6p1/4Q1Bp/1p5P/1Pp5/p1P2b2/P2q1P2/4R1K1 w - - 0 36","Qe8+"],["1q1rrb1k/5p2/p4P1p/2p2P2/1pb1p1Q1/7P/P1P2R2/1R4BK w - - 1 32","Rg2"],["7k/3N4/7K/8/8/8/2q3BB/8 w - - 0 36","Be5+"],["7k/7P/7K/6P1/8/8/1p6/8 w - - 0 36","g6"],["8/8/R7/4rpk1/4b1p1/6PP/4NK2/8 w - - 3 53","h4+"]],a=r[Math.floor(Math.random()*r.length)],s=a[0],l=a[1],c=new Chess.Game({fen:s}),d=new View.ChessBoard(jQuery(".landingPuzzleBoard"),!0).link(c),u=jQuery(".cBtnFlexi.undo",o),h=jQuery(".puzzleSolution",o);jQuery(),c.getCurrentPosition().moveRight===Chess.colors.white.letter?(jQuery(".BWmoveContainer",o).show(),jQuery(".BWmove.white",o).show()):(jQuery(".BWmoveContainer",o).show(),jQuery(".BWmove.black",o).show(),d.flip()),h.on("click",function(){jQuery(this).hide()}),e(),u.on("click",function(){return u.is(".disabled")?!1:(c.deleteMove(void 0,!0),e(),u.addClass("disabled"),void h.find("> div").hide())})}}e()}),function(){function e(e,t,n){var i=Mustache.render(l,{items:t}),o=e.clone(!0,!0),a=o.find("li");return n||a.splice(a.length-f),a.remove(),o=o.append(jQuery(i)),r(o),e.replaceWith(o),o}function t(e){return e&&e.data?e.data.items:null}function n(e){return e.length*p}function i(e,t,i,o){e&&e.length>0&&setTimeout(function(){i.offset=i.offset+i.limit,i.limit=d,t(i,o)},n(e))}function o(e){return Object.assign({},u,{type:e,limit:d+f,wasAlternated:!0})}function r(e){var t=e.find("li").length,n=t?t*h:d*h;e.css("-webkit-animation-duration",n+"s").css("animation-duration",n+"s")}function a(){return jQuery("#activeTournamentsList").find("ul")}function s(){return jQuery("#allTournamentsList").find("ul")}Controller=Controller||{},Controller.LandingPage=Controller.LandingPage||{},Controller.LandingPage.Broadcast=Controller.LandingPage.Broadcast||{};var l='{{#items}}<li class="{{classes}}"><a href="{{url}}">{{title}}</a></li>{{/items}}',c="/api/web/broadcastAPI/getFilteredTournaments",d=1e3,u={limit:d,offset:0,type:"all"},h=2,p=1e3*h,f=20;Controller.LandingPage.Broadcast.renderActive=function(){function n(e){function a(e){return"live"===e?"upcoming":"live"}jQuery.get(c,e).done(function(s){var l=t(s);if(l&&0!==l.length)r(l,e.type,e.wasAlternated),e.wasAlternated=!1,i(l,n,e);else{var c=a(e.type);n(o(c))}})}function r(t,n,i){s=e(s,t,i);var o=jQuery(".liveTournaments");o.removeClass("fewTournaments"),"upcoming"===n?o.addClass("upcomingTournaments"):o.removeClass("upcomingTournaments"),s.find("li").length<3&&o.addClass("fewTournaments")}var s=a();n(o("live"))},Controller.LandingPage.Broadcast.renderAll=function(){function n(e,o){jQuery.get(c,e).done(function(a){var s=t(a),l=r(s,o);i(s,n,e,l)})}function r(t,n){function i(){var e=a.find("li.active").removeClass("active"),t=e.next();0===t.length&&(t=a.find("li:first-child")),a.find("li.active").removeClass("active"),t.addClass("active")}return a=e(a,t),i(),clearInterval(n),setInterval(function(){i()},p)}var a=s();n(o("all"))}}(),function(){Controller=Controller||{},Controller.LandingPage=Controller.LandingPage||{},Controller.LandingPage.News=Controller.LandingPage.News||{};var e=$("#language").attr("data-language");Controller.LandingPage.News.load=function(){var t=new Date;jQuery.get("/api/web/UserAPI/getLatestNews",{lang:e,offset:t.getTimezoneOffset()}).done(function(e){var t=new Handler.Template("landing");e.data.latestNewsInfo.news.splice(0,0,e.data.latestNewsInfo.topNews);var n=t.render("news",{news:e.data.latestNewsInfo.news.slice(0,3)});$(n).appendTo($("#landingNews"))})},Controller.LandingPage.News.loadBackgroundImages=function(){jQuery.get("/api/web/UserAPI/getLatestNewsImages",{lang:e,limit:20}).done(function(e){var t=new Handler.Template("landing"),n=t.render("newsImages",{newsImages:e.data.newsImages});$(n).appendTo($("#newsImages"))}).fail(function(e){errorHandler.warning("Failed to load background images",{error:e.responseText})})}}(),function(e,t){e.LandingPage=e.LandingPage||{},e.LandingPage.Play=e.LandingPage.Play||{},e.LandingPage.Play.renderChessBoard=function(){var t=new Chess.Game,n=new Chess.GameHandler;n.addGame("landing",t).setCurrentGame(t),t.gotoStart(),t.once("move",function(t){var i=t.publisher.getLastAddedPosition().toString();jQuery.getJSON("/api/web/playzoneAPI/playNow",{authToken:config.user().authToken}).then(function(e){var t=e.data;if(!t.isAllowed){var n=new Error("Not allowed to play");throw n}var o={engineUuid:"kZQfj_TWCcdGWwZ_IWqKXg",fen:i,rated:0,clock:0,increment:0,color:"w",csrf:config.csrf()};return jQuery.extend(t,o),t}).then(function(t){var i=e.getPlayZone(),o=new Handler.Pairing,r=jQuery(".bodyContainer.landing");o.off("initGameSession").on("initGameSession",function(e,t){r.find(".hintFirstMove").removeClass("show"),r.find(".gameMessage").addClass("show gameGreetings");var o=new Handler.Playing(t.gameSessionToken,t.authToken,t.playingServer);t.playingHandler=o,t.gameHandler=n,i.initRestrictedGameSession(t,function(e){jQuery("#chessGameResult").html(e.getGameEndDescription()+e.getGameStatusAsString()),r.find(".gameMessage").addClass("show gameResult")}),o.once("receivedMove",function(e,t){r.find(".gameMessage").removeClass("show gameGreetings")})}).on("informNotAllowed",function(e,t){jQuery(".sectionPlay #chessGameError").html("<span> "+t.reason+"</span>").show(),r.find(".hintFirstMove").removeClass("show"),r.find(".gameMessage").addClass("show gameError")}),o.play(t)})["catch"](function(e){jQuery(".sectionPlay .error").html("Not allowed to play. Reason: "+e.message)})}),new View.ChessBoard(this).link(n).attachKeyboardHandler()}}(Controller||{},jQuery),jQuery(function(){var e=jQuery("#chessQuotesHolder ul");setInterval(function(){var t=e.find("li.active").removeClass("active"),n=t.next();0===n.length&&(n=e.find("li:first-child")),n.addClass("active")},5e3)}),jQuery(function(){function e(e,t,n){var i=t?jQuery(t).parents(".userRegistrationLogin"):jQuery(".userRegistrationLogin");if(n=void 0!==n?n:!i.parent().hasClass("loginRegistrationPopup"),i&&!i.find("header a.active."+e).length){if(n){var o="chess24.com :: "+e.substring(0,1).toUpperCase()+e.substring(1);window.History.pushState({name:e},o,jQuery(t).attr("href"))}i.find("header a").removeClass("active"),i.find(".tabContent").removeClass("active"),i.find("form").validatable("clear"),i.find("header a."+e).addClass("active"),i.find(".tabContent."+e).addClass("active"),i.find(".tabContent.active input[type=text]:first").focus(),i.find('input[name="csrf"]').val(config.csrf())}}function t(e){lastReview=e?"":(new Date).toISOString();var t=jQuery("#DataConsentForm_hasSettingsConsent").prop("checked"),n=jQuery("#DataConsentForm_hasSocialMediaConsent").prop("checked"),i=jQuery("#DataConsentForm_hasPerformanceConsent").prop("checked"),o=jQuery("#DataConsentForm_hasMarketingConsent").prop("checked"),r=JSON.stringify({hasNecessaryConsent:!0,hasSettingsConsent:t,hasSocialMediaConsent:n,hasPerformanceConsent:i,hasMarketingConsent:o,lastConsentReview:lastReview});$.cookie(v,r,{path:"/",expires:t&&n&&i&&o?y:w}),config.consent(!0)}function n(){var e=JSON.stringify({hasNecessaryConsent:!0,hasSettingsConsent:!0,hasSocialMediaConsent:!0,hasPerformanceConsent:!0,hasMarketingConsent:!0,lastConsentReview:(new Date).toISOString()});$.cookie(v,e,{path:"/",expires:y}),config.consent(!0)}function i(){jQuery("#DataConsentForm_hasSettingsConsent").prop("checked")||$("#data-consent-form").find("input[name='DataConsentForm[hasSettingsConsent]']").trigger("click"),jQuery("#DataConsentForm_hasSocialMediaConsent").prop("checked")||$("#data-consent-form").find("input[name='DataConsentForm[hasSocialMediaConsent]']").trigger("click"),jQuery("#DataConsentForm_hasPerformanceConsent").prop("checked")||$("#data-consent-form").find("input[name='DataConsentForm[hasPerformanceConsent]']").trigger("click"),jQuery("#DataConsentForm_hasMarketingConsent").prop("checked")||$("#data-consent-form").find("input[name='DataConsentForm[hasMarketingConsent]']").trigger("click"),window.settings.set("lastConsentReview",(new Date).toISOString()),setTimeout(function(){config.consent(!0)},2e3)}function o(e,t){var n={showReminder:t};a(e,n)}function r(e){var t={showReminder:!0,lastReminder:(new Date).toISOString()};a(e,t)}function a(e,t){switch(e){case C:$.cookie(C,JSON.stringify(t),{path:"/",expires:y}),config.registerReminder(!0);break;case F:window.settings.set("showReminderUpgrade",t.showReminder.toString()),t.lastReminder&&window.settings.set("lastReminderUpgrade",t.lastReminder),config.upgradeReminder(!0)}}function s(e){var t;switch(e){case C:t=config.registerReminder();break;case F:t=config.upgradeReminder();break;default:return}const n=T[e],i=x[e];var r;return!Object.has(t,"showReminder")||null===t.showReminder||void 0===t.showReminder||0>=t.showReminder.length?(r=Math.random()<n,o(e,r)):r=t.showReminder,r&&(!Object.has(t,"lastReminder")||null===t.lastReminder||void 0===t.lastReminder||0>=t.lastReminder.length||(new Date).getTime()-new Date(t.lastReminder).getTime()>i)}function l(){jQuery("#data-consent-form").hide(),jQuery("#data-consent-details").show()}function c(){jQuery("#data-consent-details").hide(),jQuery("#data-consent-form").show()}function d(){jQuery("#data-consent-details").hide(),jQuery("#data-consent-show-options-link").hide(),jQuery("#data-consent-form-container").show(),jQuery("#data-consent-hide-options-link").show(),window.dispatchEvent(new Event("resize"))}function u(){jQuery("#data-consent-details").hide(),jQuery("#data-consent-form-container").hide(),jQuery("#data-consent-hide-options-link").hide(),jQuery("#data-consent-show-options-link").show(),window.dispatchEvent(new Event("resize"))}function h(){jQuery(".dataConsentPopup").length>0&&(jQuery("#DataConsentForm_hasNecessaryConsent").prop("checked",!0),jQuery("#DataConsentForm_hasSettingsConsent").prop("checked",config.consent().hasSettingsConsent),jQuery("#DataConsentForm_hasSocialMediaConsent").prop("checked",config.consent().hasSocialMediaConsent),jQuery("#DataConsentForm_hasPerformanceConsent").prop("checked",config.consent().hasPerformanceConsent),jQuery("#DataConsentForm_hasMarketingConsent").prop("checked",config.consent().hasMarketingConsent),config.level().isRegistered&&(jQuery("#DataConsentForm_hasSettingsConsent").prop("checked",!0),jQuery("#DataConsentForm_hasSettingsConsent").prop("disabled","disabled")),c(),jQuery(".dataConsentPopup").modal("show"))}var p=$(".userMenu .expandingMenu");$(".mainMenu .expandingMenu");if(p.find(".linkSupport."+config.language()).show(),config.level().isGuest)p.find(".linkLogout").hide(),p.find(".linkProfile").hide(),p.find(".linkLab").hide();else{var f=config.user();p.find(".linkLogin").hide(),p.find(".linkRegister").hide(),p.find(".profile img").attr("src",f.image),p.find("a.profile").attr("href",f.url),p.find("span.name").html(f.name);const g=config.level();(g.isLabTester||g.isAdmin)&&p.find(".linkLab").show()}p.find(".loader").hide(),p.find(".profile").css("display","block"),p.show(),jQuery(".userRegistrationLogin").length&&(jQuery(".userRegistrationLogin header a.login").on("click",function(){return e("login",this),!1}),jQuery(".userRegistrationLogin header a.registration").on("click",function(){return e("registration",this),!1}),jQuery(".userRegistrationLogin .lost-password-link").on("click",function(){return e("lost-password",this),!1}),jQuery(window).on("statechange",function(){var t=window.History.getState();t.data&&t.data.name&&e(t.data.name,null,!1)}),jQuery(".loginRegistrationPopup").modal({close:!0}),config.attachLoginLink(),jQuery("input.facebookLoginInput").on("click",function(e){config.redirectToLogin(e,!0)}),jQuery("body").on("click",".register-link",function(e){e.preventDefault();var t=$(e.target).attr("href");window.location=getTargetURL(t,{lang:window.config.language()})}));const m="2018-07-12T16:00",v="consent",y=360,w=3,b=31104e6,C="register",k=6e5,F="upgrade";var x={};x[C]=6048e5,x[F]=6048e5;var T={};if(T[C]=.5,T[F]=.3,jQuery(".userDataConsent").length){if(jQuery(".dataConsentPopup").modal({close:!1,classes:"dataConsentModal"}).setPersistent(),jQuery(".data-consent-link").on("click",function(){h()}),jQuery("#data-consent-details-link").on("click",function(){l()}),jQuery("#data-consent-back-link").on("click",function(){c()}),jQuery("#data-consent-show-options-link").on("click",function(){d()}),jQuery("#data-consent-hide-options-link").on("click",function(){u()}),jQuery("#data-consent-opt-in-all").on("click",function(){config.level().isGuest?n():i(),jQuery(".dataConsentPopup").modal("hide"),Handler.tracking("data-settings","all-in",config.level().isGuest?"guest":"registered")}),jQuery("#data-consent-close").on("click",function(){config.level().isGuest?t(!1):window.settings.set("lastConsentReview",(new Date).toISOString()),jQuery(".dataConsentPopup").modal("hide"),Handler.tracking("data-settings","save",config.level().isGuest?"guest":"registered")}),config.level().isGuest?jQuery("#data-consent-form").find("input").change(function(){t(!0)}):window.settings.attach(jQuery("#data-consent-form").find("input")),!Object.has(config.consent(),"lastConsentReview")||null===config.consent().lastConsentReview||0>=config.consent().lastConsentReview.length||(new Date).getTime()-new Date(config.consent().lastConsentReview).getTime()>b||config.consent().lastConsentReview<m)return void h();if(config.level().isGuest&&(new Date).getTime()-new Date(config.consent().lastConsentReview).getTime()>k&&s(C)){var _="reminder";return window.location.href.includes("live-tournaments/")&&(_+="Broadcast"),Dialog.conversionRegister(_,{featureTable:!1,extraClasses:"reminder",registerExtraParams:"/?utm_source=chess24_promo&utm_medium=popup&utm_campaign=popup"}),void r(C)}if(config.level().isRegistered&&!config.level().isPremium&&s(F)){var E="reminder",S="popup";const j="https://chess24.com/"+config.language()+"/premium/?utm_source=chess24_promo&utm_medium=popup&utm_campaign="+S;Dialog.conversionGoPremium(E,{featureTable:!1,extraClasses:E,premiumUrl:j}),r(F)}}}),function(){function e(e,t){return t?(t=$(t),t.find(e).add(t.filter(e))):$(e)}function t(e){return e&&(e=$(e)),t.tooltipOnClick(e),t.userMiniprofile(e),t.formatTimeAgo(e),t.formatDateTime(e),t.icons(e),t.buttons(e),t.suggestField(e),t.dateTimePickers(e),t.timePickers(e),t.datePickers(e),t.inputElements(e),t.tabs(e),t.scrollableTables(e),t.simpleSlideshow(e),t.dropDown(e),t.OLD_DEPRECATED(),t}function n(e){return jQuery(e).filter("[data-multiple]").each(function(){var e=jQuery(this);if(!e.data("pattern-flexi")&&!e.hasClass("dontWrap")){if(e.hasClass("flexiWidth"))var t=e.outerWidth();e.attr("data-pattern-flexi",!0),e.parent().hasClass("flexiWrapThis")||e.parent().closest(".flexiWrapThis").length||e.addClass("flexiInputWrapperMain").wrap('<div class="flexiInputWrapper" style="width:'+t+'px"/>').before('<div class="flexiInputWrapperTop">&nbsp;</div>').after('<div class="flexiInputWrapperBot">&nbsp;</div>').on("focus blur",function(t){e.closest(".flexiInputWrapper")["focus"===t.type?"addClass":"removeClass"]("onFocus")})}}).end()}window.layout=t;var i=new Helper.Deferred;t.safe=function(e){i.promise.done(e)},t.tooltipOnClick=function(n){return e(".cTooltipBox.onClick",n).each(function(){var e=$(this);if(!e.data("tooltiponClick")){var t;e.on("click.initTooltipClick",function(n){e.closest(".cTooltipBoxContainer").length||(e.addClass("show"),e.is(".onClickPersistent.show")&&(t=t||jQuery(document).add(e.children()),t.one("click.initTooltipClick",function(n){e.removeClass("show"),t.off("click.initTooltipClick"),n.stopPropagation()})),n.stopPropagation())}),e.is(".onClickPersistent")||e.on("mouseleave.initTooltipClick",function(){e.removeClass("show"),e.parents(".gamePresenter").length&&$(".contentContainer .colorHeader").css("z-index","")}),e.data("tooltiponClick",!0)}}),t},t.userMiniprofile=function(n){return e(".ofMiniProfile",n).addMiniprofile(),t},t.formatTimeAgo=function(n){return e(".formatTimeAgo[data-created]",n).showAge(),t},t.formatDateTime=function(n){return e(".formatDateTime[data-created]",n).showDateTime(),t},t.icons=function(n){return e(".cIcon.inactive",n).each(function(){var e=$(this);e.data("pattern-icon")||e.data("pattern-icon",!0).on("click.cIcon",function(e){e.preventDefault()})}),t},t.buttons=function(e){return jQuery("input.cBtn:button, input.cBtn:submit",e).each(function(){var e=jQuery(this);if(!e.data("pattern-button")){e.data("pattern-button",!0);var t=e.attr("class");e.removeClass(),e.attr("data-pattern-button",!0),e.wrap('<span class="inputButtonWrapper '+t+'"/>')}}),t},t.suggestField=function(i){return n(e(".cPattern[data-auto-suggest]",i)).suggestField(),t},t.dateTimePickers=function(n){return e("input[data-datetime]",n).each(function(){var e=$(this);if(!e.data("pattern-datetime")){e.data("pattern-datetime",!0);var n=0;e.data("timezone-offset-utc")&&(n=60*(parseInt(e.data("timezone-offset-utc"))+parseInt((new Date).getTimezoneOffset())));var i=$('<div class="cDatetimepickerWrapper"/>').insertBefore(e);e.next().data("field")===e.attr("name")&&i.append(e.next()),i.prepend(e);var o=$('<input data-date="true" class="cInputText" type="text"/>').insertAfter(e),r=$('<input data-time="true" class="cInputText" type="text"/>').insertAfter(o),a=parseInt(e.val());if(a){var s=new Date(1e3*(a+n)),l=s.getHours(),c=s.getMinutes();o.val(Math.round(s.getTime()/1e3)-3600*l-60*c),r.val(l+":"+(10>c?"0":"")+c)}t.datePickers(o),t.timePickers(r),r.add(o).on("changeTime changeDate change",function(){e.trigger("focus").trigger("change");var t=o.datepicker("getDate");if(!t)return void e.val("");var i=r.val().split(":"),a=2===i.length?3600*i[0]+60*i[1]:0;t=Math.round(t.getTime()/1e3),e.val(t+a-n)})}}),t},t.timePickers=function(n){return e("input[data-time]",n).each(function(){var e=$(this);if(!e.data("pattern-time")){e.attr("data-pattern-time",!0),e.addClass("cTimepicker"),e.wrap('<div class="cTimepickerWrapper" />'),$('<img class="cTimepickerIcon" src="'+config.assetDir()+'/images/img/icon_timepicker.png" alt="..." title="..." />').insertAfter(e),e.timepicker({timeFormat:"G:i"}),e.next("img.cTimepickerIcon").on("click",function(){e.timepicker("show")});var t=$("<a/>").addClass("cTimepickerClear").insertAfter(e).on("click",function(){e.val(""),t.hide(),e.trigger("changeTime")})[e.val()?"show":"hide"]();e.on("changeTime",function(){e.val()?t.show():t.hide()})}}),t},t.datePickers=function(n){return e("input[data-date]",n).each(function(){var e=$(this);if(!e.data("pattern-date")){e.attr("data-pattern-date",!0),e.wrap('<div class="cDatepickerWrapper"/>');var t=$('<input type="hidden"/>').attr("name",e.attr("name")).insertBefore(e),n=e.val();e.attr("name","").attr("autocomplete","off");for(var i=e.data("mysql"),o=e.attr("class").split(" "),r=0;r<o.length;r++)"validate["===o[r].substr(0,9)&&(e.removeClass(o[r]),t.addClass(o[r]));var a=$("<a/>").addClass("cDatepickerClear").insertAfter(e).on("click",function(){e.val(""),t.val("").trigger("change"),a.hide(),e.trigger("changeDate")})[e.val()?"show":"hide"]();$("nothing").validatable(),e.on("keyup change",function(){setTimeout(function(){var n=e.datepicker("getDate");n&&$.fn.validatable.validators.date({format:"dd/MM/yyyy"}).validateValue(e.val())?(n=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate())),e.parent().removeClass("inputError"),i?t.val($.datepicker.formatDate($.datepicker.ATOM,n)):t.val(n.getTime()/1e3),t.trigger("change"),a.show()):e.val()?(e.parent().addClass("inputError"),t.val(""),a.show()):a.hide(),e.trigger("changeDate",n.getTime()/1e3)},1)}),e.datepicker({dateFormat:"dd/mm/yy",changeMonth:!0,changeYear:!0,altField:t,showOn:"button",buttonImage:config.assetDir()+"/images/img/icon_datepicker.png",buttonImageOnly:!0,altFormat:$.datepicker.TIMESTAMP}),e.datepicker("setDate",e.val()?new Date(parseInt(e.val()+"000")):""),t.val(n)}}),t};var o=0;t.inputElements=function(n){return e("input.cPattern:text, input.cPattern:password, input.cPattern:file",n).each(function(){var e=$(this);if(!e.data("pattern-input")&&(e.data("pattern-input",!0),!e.closest("div[data-auto-suggest]").length)){var t="";"undefined"!=typeof e.attr("class")&&(t=" "+e.attr("class"));var n=$("<span/>").addClass(t).insertBefore(e).append(e).append(e.prevAll("input:hidden"));if(!e.closest("span").hasClass("inputTextWrapper"))if(e.hasClass("inputTextWithBtn")||e.is(":file")){var i=e.attr("data-inputbtn-class"),o="";"undefined"!=typeof e.attr("data-inputbtn-id")&&(o=e.attr("data-inputbtn-id"));var r=e.attr("title");if(n.addClass("inputTextWrapper inputTextWithBtn"),e.is(":file"))n.addClass("inputFileUpload"),n.append('<a class="cBtn cBtnWhite cBtnIconFileUpload">'+window.t("Upload")+"</a>"),e.styleFileUpload();else{var a;n.append(a=$('<a class="cBtn '+i+'" id="'+o+'">'+r+"</a>").on("click",function(){if(!e.hasClass("cNoFollow")){var t=window.location.href;t=t.replace(new RegExp(e.attr("name")+"=[^&]*"),"").replace("&&","&").replace(/&$/,"").replace(/\?&?$/,"").replace("?&","?"),e.val()&&(t+=(-1!=t.indexOf("?")?"&":"?")+e.attr("name")+"="+e.val()),this.href=t}})),e.on("keydown",function(e){e.keyCode===Handler.Keyboard.keys.VK_RETURN&&a.trigger("click")})}}else n.addClass("inputTextWrapper");if(e.hasClass("inputTextWithReset")){var s=$("<a/>").addClass("cTextInputClear").on("click",function(t){t.stopPropagation(),s.hide(),e.val(""),e.trigger("blur"),e.focus(),n.find(".cBtn").get(0).click()})[e.val()?"show":"hide"]().appendTo(n);e.on("keyup keypress change",function(){setTimeout(function(){s[e.val()?"show":"hide"]()},3)})}e.is(":text,:password")&&e.on("focus blur",function(t){e.closest("span")["focus"==t.type?"addClass":"removeClass"]("onFocus")})}}),e("input.cPattern:radio, input.cPattern:checkbox",n).each(function(){var e=$(this),t=e.next("span").addClass("crLabel"),n="radioButton";if(e.is(":checkbox")&&(n="checkBox"),!e.data("pattern-checkbox")){e.attr("data-pattern-checkbox",!0);var i=e.attr("id");i||(i="pattern"+e.attr("type")+ ++o,e.attr("id",i)),e.wrap($('<label class="crContainer '+n+'" for="'+i+'"></label>')),e.closest(".crContainer").append(t),e.after($("<label/>").addClass("crImg").attr("for",i))}}),e("input.cPatternSlider").each(function(){var e=$(this);if(!e.data("pattern-slider")){e.data("pattern-slider",!0);var t=$("<div/>").addClass("cPatternSlider"),n=e.data("slider")||{};t.insertBefore(e).append(e),t.slider({value:e.val(),range:n.range||void 0,min:n.min||0,max:n.max||100,step:n.step,change:function(t,n){e.val(n.value).trigger("change")}})}}),e("div.cPatternSlider").each(function(){var e=$(this);e.children("input.cPatternSlider").length||e.slider({value:e.data("value")})}),e("input.cPattern[data-watermark-label], textarea.cTextarea[data-watermark-label]").each(function(){$(this).waterLabel()}),e("select.cPattern").off("update").on("update",function(){$(this).selectBox("refresh")}).selectBox(),e("select.autoSubmit").on("change",function(){var e=$(this);if(!e.data("pattern-autosubmit")){e.attr("data-pattern-autosubmit",!0);var t=window.location.href;t=t.replace(new RegExp(e.attr("name")+"=[^&]*"),"").replace("&&","&").replace(/&$/,"").replace(/\?&?$/,"").replace("?&","?"),e.val()&&(t+=(-1!=t.indexOf("?")?"&":"?")+e.attr("name")+"="+e.val()),$(".autoSubmit-selectBox-dropdown-menu a[rel="+e.val()+"]").attr("href",t).get(0).click()}}),e("form.cPattern").validatable(),t},t.tabs=function(n){function i(e){if(!($('*[data-tab-content-id="'+e+'"]').length<=0)){var t=$('*[data-tab-content-id="'+e+'"]'),n=t.closest(".customTabs");if(!t.closest("li").hasClass("disabled")){n.find(" > section").hide(),$(" > section",n).removeClass("active"),$(" > .tabsList li",n).removeClass("active"),t.closest("li").addClass("active"),$(" > section",n).hide();var i=n.find("#"+t.data("tab-content-id"));i.show().addClass("active").trigger("chess24:show"),i.find(".customTabs section.active, .tabContentWrap > div:not(.hide)").trigger("chess24:show");var o=n.find("> section").not(i);return o.trigger("chess24:hide"),o.find(".customTabs section.active, .tabContentWrap > div:not(.hide)").trigger("chess24:hide"),!1}}}return e(".customTabs",n).each(function(){function e(){var e=$(this);e.prepend('<div class="disabledTabContentOverlay">&nbsp;</div>');var n=$("<div>").html(e.data("tab-title")).attr("data-tab-content-id",e.attr("id"));e.data("href")&&n.attr("data-href",e.data("href")),$("<li>").addClass(e.data("tab-class")).append(n).toggleClass("active",e.hasClass("active")).appendTo(t.find(".tabsList"))}var t=$(this);if(!($(".tabsList",t).length>0)){t.hasClass("tab-position-bottom")?t.append('<ul class="tabsList" />'):t.prepend('<ul class="tabsList" />'),$(" > section",t).each(e);var n=$(".tabsList > li:first",t).find("div").data("tab-content-id");$(".tabsList > li",t).each(function(){var e=$(this).find("div").data("tab-content-id");$(this).hasClass("disabled")||$(this).hasClass("active")&&($(".tabsList > li",t).removeClass("active"),$(this).addClass("active"),n=e)}),i(n),$(t).on("click",".tabsList > li div",function(){var e=$(this);i(e.data("tab-content-id")),e.data("href")&&1!=$("body").data("embed")&&window.history.pushState({},"game",e.data("href"))}),t.on("chess24:add",function(n,i){i=$(i),i.length&&($(i).hide(),t.append(i),e.call(i))}),t.on("chess24:remove",function(e,n){var o=t.find("> section#"+n),r=t.find("ul.tabsList [data-tab-content-id="+n+"]").closest("li");o.is(".active")&&(o.removeClass("active"),r.removeClass("active"),i(t.find("> section").not("#"+n).first().attr("id"))),o.remove(),r.remove()})}}),t},t.scrollableTables=function(n){function i(){var e=$(this);if(!e.is(":visible"))return void e.closest(".singleDisplay, .customTabs > section, .tabContent, .modal").one("chess24:show",function(){
i.apply(e)});if(!e.data("scrollable-table")){e.data("scrollable-table",!0);var t=e.find("thead"),n=e.find("tfoot"),o=e.closest(".nativeScroll"),r={};t.find("th").each(function(e){$(this).css("width",$(this).width()),r[e]=$(this).outerWidth()}),e.find("tbody tr.gameContainer:first td").each(function(e){$(this).css("width",r[e]-parseInt($(this).css("padding-left"))-parseInt($(this).css("padding-right"))-1)}),e.find("tbody tr:first td.matchSeparator").closest("tr").remove(),0===t.length&&(t=$('<thead class="empty"><tr><th></th></tr></thead>').appendTo(e)),0===n.length&&(n=$('<tfoot class="empty"><tr><th></th></tr></tfoot>').appendTo(e)),e.hasClass("tHead")&&(t.clone(!0).insertBefore(o).wrap('<div class="gridView fixedHead"><table></table></div>'),t.remove()),e.hasClass("tFoot")&&(n.clone(!0).insertAfter(o).wrap('<div class="gridView fixedFoot"><table></table></div>'),n.remove())}}return e(".gridView.fixed",n).each(function(){i.call(this)}),t},t.simpleSlideshow=function(n){return e(".cPattern.addSimpleSlideshow",n).simpleSlideshow(),t},t.dropDown=function(n){return e(".dropdownFilter",n).each(function(){function e(e){t.find(e.target).length||($(document).off("touchstart.dropdownfilter"),t.removeClass("active"),t.trigger("chess24:hide"))}var t=$(this);if(!t.data("pattern-dropdown")){t.on("chess24:hide chess24:show",function(e){e.stopPropagation()}),t.data("pattern-dropdown",!0);t.find(".dropdownFilterContainer");t.hasClass("showOnlyOnClick")&&(t.find(".dropdownFilterTitle").off("click.dropdownfilter").on("click.dropdownfilter",function(n){t.hasClass("disabled")||($(".dropdownFilter").not(t).each(function(){$(this).removeClass("active")}),t.toggleClass("active"),t.hasClass("active")?(t.trigger("chess24:show"),$(document).on(("ontouchstart"in window?"touchstart.dropdownfilter ":"")+"click.dropdownfilter",e)):t.trigger("chess24:hide"),n.stopPropagation())}),t.hasClass("active")?(t.trigger("chess24:show"),$(document).on(("ontouchstart"in window?"touchstart.dropdownfilter ":"")+"click.dropdownfilter",e)):t.trigger("chess24:hide")),t.find(".likeSelectbox input:radio").on("change",function(e){var n=$(this),i=n.closest(".dropdownFilter").find(".dropdownFilterTitle"),o=n.siblings(".crLabel").text();n.is(":checked")&&!t.hasClass("staticLabel")&&i.text(o),t.removeClass("active")})}}),t},t.oneTime=function(){t.oneTime.stickyBroadcastVideo(),t.oneTime.liveShowVideoModes(),t.oneTime.colorHeader(),t.oneTime.csrfForCachedPages(),t.oneTime.initSharingIcons(),t.oneTime.preventScrolling(),t.oneTime.searchAnimation(),t.oneTime.openCloseResponsiveMenu(),t.oneTime.showMorePaymentPlans(),t.oneTime.OLD_DEPRECATED()},t.oneTime.stickyBroadcastVideo=function(){function e(e){function t(){$(".contentContainer").toggleClass("nowStickyBroadcastVideo"),$redesign&&Controller.Broadcast().switchGamePresenter()}function n(){$(".contentContainer").toggleClass("broadcastVideoTheaterMode"),$redesign&&Controller.Broadcast().switchNavigation()}function i(){var e=a.width();a.height(e*(9/16))}e.preventDefault();var o=e.currentTarget,r=$(".videoContainerPosition"),a=$(".videoContainerWrapper");switch($(o).attr("id")){case"triggerStickyVideo":$(".contentContainer").hasClass("broadcastVideoTheaterMode")&&n(),$(function(){t(),$mainBroadcast&&(r.hasClass("stickyVideoMinimized")&&$(".contentContainer").hasClass("nowStickyBroadcastVideo")?a.height(0):i())});break;case"triggerTheaterMode":$(".contentContainer").hasClass("nowStickyBroadcastVideo")&&t(),$mainBroadcast&&$(function(){i()}),n();break;case"minimizeStickyVideo":r.toggleClass("stickyVideoMinimized"),$mainBroadcast&&$(function(){r.hasClass("stickyVideoMinimized")?a.height(0):i()});break;case"positionStickyVideo":r.toggleClass("stickyVideoPositionLeft");break;case"triggerAttachedMode":$(".contentContainer").hasClass("nowStickyBroadcastVideo")?t():$(".contentContainer").hasClass("broadcastVideoTheaterMode")&&n()}}$(".contentContainer").on("click",".stickyVideoHeaderBar a",e)},t.oneTime.liveShowVideoModes=function(){function e(e){e.preventDefault();var t=e.currentTarget,n=$(".liveVideoContainer");switch($(t).attr("id")){case"liveShowVideoTheaterMode":n.toggleClass("theaterMode");break;case"liveShowVideoStickyMode":n.toggleClass("stickyMode")}}$(".contentContainer").on("click",".liveShowVideoModes a",e)},t.oneTime.colorHeader=function(){function e(){return o&&o.length?!0:(o=jQuery(".colorHeader"),o.length?(r=o.closest(".contentContainerInsider"),!0):!1)}function t(){var e,t;if($redesign)e="Live Tournaments",t="Live broadcasts from top events",a="mmenuTournaments active";else{var o=jQuery(".mainMenu .secondaryMenuWrapper li.active").eq(0);if(!o.length)return void n();e=o.find("a").clone().children().remove().end().text(),t=o.find("a").contents().filter("p").text(),a=o.attr("class")}var r=s.render("defaultHeader",{title:e,subtitle:t});i(r,a)}function n(){r.removeClass("showColorHeader")}function i(e,t,n){function i(e,t){var n=$(e+" .navigation")[0];Controller.Broadcast().setNavigationView(n),t&&Controller.Broadcast().renderVideoSelector(t)}if(r.addClass("showColorHeader"),o.empty().append(e),$redesign&&!t){var s,l=$(".contentContainer")[0].classList,c=!1,d=".colorHeader";if($("#tabTournament"+n+" .withVideo").length){s=".colorHeader";var u="#tabTournament"+n+" .video";l.forEach(function(e){switch(e){case"broadcastVideoTheaterMode":c=!0,d=u;break;case"nowStickyBroadcastVideo":c=!0,s=u}})}c&&!$("#tabTournament"+n+" .videoContainer").length?$(document).on("chess24:videoRendered",function(){$(document).off("chess24:videoRendered"),i(d,s)}):i(d,s)}a&&o.removeClass(a),t?o.addClass(t):a&&(a=void 0)}var o,r,a,s=Handler.Template("colorHeader");e()&&(o.hasClass("custom")?o.text().trim()||n():t()),jQuery(document).off("chess24:header").on("chess24:header",function(o,r){if(e())if(r)if(r===!0)t();else{var a=s.render(r.template+"Header",r.data);a&&i(a,void 0,r.currentTournamentId)}else n()})},t.oneTime.csrfForCachedPages=function(){$("form input[name=csrf]").val($.cookie("csrf"))},t.oneTime.initSharingIcons=function(){function e(){var e=$(".contentWrap").offset();e&&n.css("left",e.left+"px")}function t(e,t){"string"==typeof t?o.attr("href",t):i.data("embed-data",t),i.toggleClass("withEmbed",!!t)}var n=$(".stickyQuickies"),i=$(".globalSharing"),o=$("head > link[rel=embed-url]");i.shareButtons({plain:!0,noIcons:!0,noLabel:!0,facebook:!0,twitter:$(".oneNews h1").text()||$('head > meta[property="og:title"]').attr("content")||!0,google:!1,embed:!0,mail:!1}),$(window).on("resize",e),$(document).on("chess24:embedurl",t),e(),t()},t.oneTime.preventScrolling=function(){$(document).on("mousewheel DOMMouseScroll",'.deltaScroll, ul[class^="selectBox-"], ul[class*=" selectBox-"]',function(e){var t=e.originalEvent,n=t.wheelDelta||-t.detail;this.scrollTop+=30*(0>n?1:-1),e.preventDefault()})},t.oneTime.searchAnimation=function(){var e=!1;$("#search-bar > a").on("click mouseover",function(t){if(e)return void("click"===t.type);var n=$(this),i=$("#search-bar > div"),o=$("#search-bar").width()+2;e=!0,$(this).toggleClass("active"),i.css({width:"0px",left:o+"px"}).animate({width:o+"px",left:"0px"},200,function(){$("#search-bar > div input").focus()}),n.animate({right:o-n.width()+10+"px"},200),$("#search-bar").off("click touchend").on("click touchend",function(e){try{e.stopPropagation()}catch(t){e.cancelBubble=!0}}),$(document).one("click",function(){e&&(i.animate({width:"0px",left:o+"px"},200,function(){n.toggleClass("active"),e=!1}),n.animate({right:"0px"},200))})})},t.oneTime.openCloseResponsiveMenu=function(){$(".navContainerWrapper > .menuBurgerButton[data-class-setter-on-click]").classSetterOnClick()},t.oneTime.showMorePaymentPlans=function(){jQuery(".morePlans[data-class-setter-on-click]").classSetterOnClick()},t.OLD_DEPRECATED=function(){$(".tabsContainer").each(function(){var e=$(this);if(!e.data("pattern-tab")){e.attr("data-pattern-tab",!0);var t;window.location.hash&&(t=e.find(".tabNav").find('a[data-tab-content-id="'+window.location.hash.replace("#","")+'"]'),t.length>0&&(e.find(".tabNav > li").removeClass("current"),t.parent().addClass("current"))),e.find(".tabContentWrap > div").addClass("hide");var n=e.find(".tabNav li.current a").attr("data-tab-content-id");$(".tabContentWrap #"+n).removeClass("hide"),e.wrapTabs(),e.hasClass("userProfileTabs")&&e.ajaxTabs(),t&&t.length>0&&t.parents(".tabsContainer").find("#"+t.attr("data-tab-content-id")).trigger("chess24:show")}}),$(".stepSlider").each(function(){var e=$(this),t=e.data("slider")||{},n=t.step||4,i=e.find(".sliderValues");i.addClass("items-"+n)})},t.oneTime.OLD_DEPRECATED=function(){$(".language-change-link").on("click",function(){var e=$(this),t={language:e.data("lang"),csrf:config.csrf()};return $.ajax({url:"/api/web/UserAPI/setLanguage",type:"POST",data:t,dataType:"json",success:function(t){t&&0===t.status&&(window.location=e.attr("href"))},error:function(e,t,n){var i,o=window.t("Failed to change the language");try{i=$.parseJSON(e.responseText);var r;for(r in i.errors){o=i.errors[r][0];break}}catch(a){}errorHandler.msg("error",new Error(o),!1)}}),!1}),setTimeout(function(){if(window.editors&&window.editors.length){for(var e=!0,t=0;t<window.editors.length;t++)if(window.editors[t].is(".comment")){e=!1;break}e&&$(document).off("keydown.backspace").on("keydown.backspace",function(e){var t=!1;if(8===e.keyCode){var n=e.srcElement||e.target,i=$(n),o=n.tagName.toLowerCase(),r=(n.type||"").toLowerCase();t="input"==o&&["text","password","file","email"].contains(r)||"textarea"==o||i.is(".editor")||i.closest(".editor").length>0?n.readOnly||n.disabled:!0}t&&e.preventDefault()})}})},$(document).ready(function(){t.oneTime(),t(),i.resolve()}),$(document).on("newhtml",function(){t()})}(),jQuery(function(){function e(e){jQuery.ajax({url:"/api/web/UserAPI/getGTMData?uuid="+config.user().uuid,dataType:"json",type:"GET"}).done(function(t){e(t.data.gtm)})}function t(e){e.userCountry=config.user().countryIso3,dataLayer.push(e)}"object"==typeof dataLayer&&e(t)}),"undefined"==typeof View&&(View={}),function(){var e={};View.AutoCommentator=function(){function t(){w&&void 0===e[b]&&(e[b]=null,$.getJSON(y+"/"+b+".json").done(function(t){e[b]=t}))}function n(t){return function(){w&&e[b]&&t.apply(this,arguments)}}function i(e){return function(){g.isOver()||e.apply(this,arguments)}}function o(t,n){e[b].check&&n.isCheck()&&!n.isCheckMate()?d(e[b].check):r(n)}function r(t){if(e[b].move){var n=t.getSan().replace("#","").replace("+","");if(e[b].move[n])return void d(e[b].move[n]);if(e[b].capture&&t.hasTakenPiece){var i=n.substr(n.indexOf("x"));if(e[b].capture[i])return void d(e[b].capture[i]);e[b].capture.x&&d(e[b].capture.x)}}}function a(t){if(v=!1,e[b].result&&t.publisher.isOver()){var n,i=t.publisher,o=i.getGameStatus(),r=i.getMeta().White.UUID==config.user().uuid,a=o.result.white==(r?1:0),s=o.endedBy;switch(s){case"RESIGN":n=a?e[b].result.win:e[b].result.loss;break;case"CHECKMATE":n=a?e[b].result.checkmate.win:e[b].result.checkmate.loss;break;case"CLOCKFLAG":case"CLOCKFLAG_VS_INSUFFICENT_MATERIAL":n=a?e[b].result.flag.win:e[b].result.flag.loss;break;case"DISCONNECT_VS_INSUFFICENT_MATERIAL":case"DRAW_AGREED":case"INSUFFICENT_MATERIAL":case"REPETITION":case"NO_ACTION":case"STALEMATE":case"BOTH_FLAGS_DOWN":n=e[b].result.draw}d(n,!0)}}function s(t,n){v=!0,n.getStartPosition().countChildrenMoves()||d(e[b].start)}function l(e){soundManager.getSoundById(b+e)||c(b+e,{"audio/mp3":"mp3/"+e+".mp3","audio/ogg":"ogg/"+e+".ogg"})}function c(e,t){var n=[];for(var i in t)t.hasOwnProperty(i)&&n.push({type:i,url:y+"/"+b+"/"+t[i]});soundManager.destroySound(e),soundManager.createSound({id:e,url:n,autoLoad:!0,autoPlay:!1})}function d(e,t){"undefined"==typeof t&&(t=!1),Array.isArray(e)&&f(e.random(),t)}function u(){return C=!1,k.length?void f(k.shift(),!1):void h()}function h(){clearTimeout(h.timeout),h.timeout=setTimeout(n(i(p)),2e4+2e4*Math.random())}function p(){d(e[b].misc)}function f(e,t){if(w){if(C)return void(1==t&&k.push(e));l(e),C=!0,soundManager.play(b+e,{volume:window.settings.getNumber("game-sounds-volume"),onfinish:u})}}var g,m=this,v=!0,y=assetsBasePath+"/sounds/autoCommentator/"+config.language(),w=window.settings.getBoolean("auto-commentator"),b=window.settings.get("auto-commentator-theme")||"pepeCuenca",C=!1,k=[];return window.settings.on("settings.auto-commentator",function(e,n){w=!!n.value,t()}),window.settings.on("settings.auto-commentator-theme",function(e,n){b=n.value,t()}),Extend.Suspendable(m),Extend.Subscriber(m,{"move.mainline.add":m.delegate(n(o)),gameStatusChanged:m.delegate(n(a)),startPlayZoneGame:m.delegate(n(s))},{afterLink:function(e){g=e.publisher,t()}}),m}}();var View=View||{};!function(){var e=1e3;View.AutoPlay=function(t){function n(){return c}function i(){d.off("click").on("click",o),d.removeClass("play").addClass("pause"),clearInterval(l),s.isEndOfMainline()&&s.gotoStart(),l=setInterval(r,e)}function o(){u||(d.off("click").on("click",i),d.removeClass("pause").addClass("play"),clearInterval(l))}function r(){u=!0,s.gotoNextPosition(!0),u=!1,s.isEndOfLine()&&o()}function a(){d.removeClass("inactive"),o()}var s,l,c=this,d=jQuery(t),u=!1;return Extend.Subscriber(c,{pieceSelected:o,gameStatusChanged:a,currentGameChanged:a,movedPositionPointer:o},{afterLink:function(e){(e.publisher instanceof Chess.Game||e.publisher instanceof Chess.GameHandler)&&(s=e.publisher,a())}}),n()}}(),"undefined"==typeof View&&(View={}),View.BoardLink=function(e){var t=this;return e=jQuery(e),0===e.length&&errorHandler.error(new Error("container not found in View.BoardLink"),{container:e}),t.updateUrl=function(t){jQuery(".chess24RefLink > a").attr("href",t),e.wrap('<a href="'+t+'" target="_blank" />')},t};var View=View||{};!function(e){View.BoardXL=function(t){function n(){return o(),c.on("click",i),window.settings.on("settings."+s,o),a}function i(){window.settings.set(s,r())}function o(){var t=window.settings.getBoolean(s);t?(e("body").addClass(l),c.switchClass("cIconFullscreenOn","cIconFullscreenOff"),e(".pageSidebar").trigger("sticky_kit:detach")):(e("body").removeClass(l),c.switchClass("cIconFullscreenOff","cIconFullscreenOn"))}function r(){return window.settings.getBoolean(s)?0:1}var a=this,s="play-board-xl",l="boardXL",c=e(t);return a.update=o,n()}}(jQuery),"undefined"==typeof View&&(View={}),View.BroadcastPageTitle=function(e){function t(t){var n=t.publisher.getMeta();n.White.Name&&n.Black.Name&&Handler.pageTitle.set(n.White.Name+" vs. "+n.Black.Name+" | "+i.getTitle(e)+" | "+i.getYear(e)+" | chess24.com")}var n=this,i=new Controller.BroadcastTournament;return Extend.Subscriber(n,{currentGameChanged:t},{afterLink:t}),n},"undefined"==typeof View&&(View={}),View.Dual=function(e,t,n,i,o,r,a){function s(){l(e),p=new View.TeamRoundRobin(k,n,o).switchNavigation(!1).resume(),e.on("set."+n+".currentRound",u.delegate(function(t,n){c(e,n.value)}))}function l(e){var n=t.find(".dualNavigation"),a=n.find(v),s=n.find(y),l=C.data(w)||window.t("Section one"),d=C.data(b)||window.t("Section two");a.html(l).on("click",function(){u.emit("switch",0),F.hide(),k.show(),a.addClass("active"),s.removeClass("active"),p.resume(),f&&f.suspend()}).addClass("active"),s.html(d).on("click",function(){function e(){f=f||new View.TeamRoundRobin(F,i,o).switchNavigation(!1),u.emit("switch",1),k.hide(),F.show(),s.addClass("active"),a.removeClass("active"),p.suspend(),f.resume()}return f?e():void r(i,e)}),c(e,h)}function c(e,n){var i=d(m,n),o=parseInt(Object.keys(m).pop(),10);h=n;var r=g.render("dual.pagination",{rounds:i});t.find(".cPagination").html(r),t.find(".cPagination a").on("click",function(){var t,n=jQuery(this),i=n.parent();t=i.hasClass("goFirst")?1:i.hasClass("goLast")?o:i.hasClass("goPrev")?Math.max(1,h-1):i.hasClass("goNext")?Math.min(o,h+1):n.data("round"),c(e,t),p.setCurrentRound(t),f&&f.setCurrentRound(t)}),t.find(".cPagination .goFirst, .cPagination .goPrev")[1==n?"addClass":"removeClass"]("inactive"),t.find(".cPagination .goLast, .cPagination .goNext")[n==o?"addClass":"removeClass"]("inactive")}function d(e,t){var n=[];for(var i in e)n.push(parseInt(i,10));var o=n.indexOf(t),r=o-3,a=o+3;0>r&&(a-=r,r=0),a>=n.length&&(r-=a-n.length+1,a=n.length-1),0>r&&(r=0);for(var s=[],l=r;a>=l;l++)s.push({round:n[l],current:n[l]==t});return r>0&&(s.left=!0),a<n.length-1&&(s.right=!0),s}var u=Extend.Publisher(this);t=jQuery(t);var h=o;0===t.length&&errorHandler.msg("error",new Error("container not found"),!0,{container:t});var p,f,g=new Handler.Template("broadcast"),m=e.getAttribute(n,"rounds");if(a)var v=".switchRight",y=".switchLeft",w="label2",b="label1";else v=".switchLeft",y=".switchRight",w="label1",b="label12";var C=t.closest(".liveTournamentContainer");Extend.Suspendable(u),t.html(g.render("dual.main"));var k=t.find(".dualTournament1").show(),F=t.find(".dualTournament2").hide();return u.onSuspend(function(){p.suspend(),f&&f.suspend()}),u.onResume(function(){p.resume(),f&&f.resume(),c(e,h||e.getAttribute(n,"currentRound"))}),u.showTournament=function(e){return e===n?t.find(".dualNavigation .switchLeft").trigger("click"):e===i&&t.find(".dualNavigation .switchRight").trigger("click"),u},s(),u},"undefined"==typeof View&&(View={}),View.EnrollButton=function(e,t,n){function i(e){r=e.publisher;var s=jQuery.extend({},r.getAttribute(t,"players"));delete s.unknown;var h=Object.keys(s).length,p=r.getAttribute(t,"playersMax"),f=r.getAttribute(t,"enrollingFrom"),g=r.getRounds(t),m=g[1]?g[1].startDate<=Controller.Broadcast.offsetCorrectedDateNow():!1,v="finished"===r.getAttribute(t,"status"),y=g[1]?g[1].startDate-f<=Controller.Broadcast.offsetCorrectedDateNow():!1,w="cancelled"===r.getAttribute(t,"status"),b=Math.max(0,p-h);if(config.level().isGuest)return m||w?(c.hide(),d.empty()):(c.html(window.t("Enroll")).removeClass("disabled").on("click",function(){new Dialog.conversionRegister("playzoneTournament")}),d.empty()),a;var C=r.getAttribute(t,"restrictLevel"),k=r.getAttribute(t,"restrictEloMin"),F=r.getAttribute(t,"restrictEloMax"),x=r.getAttribute(t,"restrictGeo"),T=r.getAttribute(t,"whitelist");if(C&&!config.level().isPremium)return m||w?(c.hide(),d.empty()):(c.html(window.t("Enroll")).removeClass("disabled").on("click",function(){new Dialog.conversionGoPremium("enroll")}),d.html(window.t('<span class="cPremiumLabel">Premium</span> tournament. Enrollment to this tournament is only available to premium users'))),a;if(x&&Array.isArray(x)&&!x.contains(config.user().country))return c.html(window.t("Enroll")).addClass("disabled"),d.html(window.t("This tournament is not available in your country")),a;if(T&&T.length&&!T.contains(config.user().uuid)&&(!C||!config.level().isPremium))return c.html(window.t("Enroll")).addClass("disabled"),d.html(window.t("Limited tournament")),a;if(F||k){var _,E;for(var S in g){_=g[S].timeControl.base,E=g[S].timeControl.incrementPerMove;break}var j=_+40*E,I="classical";j>0&&18e4>j?I="bullet":9e5>j&&(I="blitz");var A=config.user().elo[I],O=F&&A>F||k&&k>A;if(O){if(m||w)c.hide(),d.empty();else{if(c.html(window.t("Enroll")).addClass("disabled"),F&&k)var M=window.t("Enrollment is only available to users with Elo in the range between {from} and {to}",{"{from}":k,"{to}":F});else F?M=window.t("Enrollment is only available to users with Elo below {to}",{"{to}":F}):k&&(M=window.t("Enrollment is only available to users with Elo above {from}",{"{from}":k}));d.html(M)}return a}}if(c.show().off("click").removeClass("disabled"),s[n]&&!s[n].removed)if(v)c.html(window.t("Withdraw")).addClass("disabled").hide(),d.html(window.t("The tournament is over!"));else if(w)c.html(window.t("Withdraw")).addClass("disabled").hide(),d.html(window.t("The tournament has been cancelled, not enough users enrolled"));else if(m){var P={content:window.t("Do you really want to withdraw?")};parseInt(r.getAttribute(t,"punishWithdrawers"),10)&&(P.comment=window.t("You will be no longer able to join the tournament and <strong>will be banned from playing tournaments for another week</strong>.<br/>Do you want to proceed?")),c.html(window.t("Withdraw")).on("click",function(){new Dialog.confirmation(P,function(){var e=jQuery.extend({},u,{tournament:t});jQuery.post(l+"withdraw",e).done(function(){}).fail(function(e){try{var t=jQuery.parseJSON(e.responseText);for(var n in t.errors)if(t.errors[n]&&t.errors[n][0]){new Dialog.alert(t.errors[n][0]);break}}catch(i){}})})}),d.empty()}else c.html(window.t("Withdraw")).on("click",function(){new Dialog.confirmation(window.t("Do you really want to leave the tournament?"),function(){var e=jQuery.extend({},u,{tournament:t});jQuery.post(l+"withdraw",e).done(function(){}).fail(function(e){try{var t=jQuery.parseJSON(e.responseText);for(var n in t.errors)if(t.errors[n]&&t.errors[n][0]){new Dialog.alert(t.errors[n][0]);break}}catch(i){}})})}),d.empty();else if(v)c.html(window.t("Enroll")).addClass("disabled").hide(),d.html(window.t("The tournament is over!"));else if(w)c.html(window.t("Enroll")).addClass("disabled").hide(),d.html(window.t("The tournament has been cancelled, not enough users enrolled"));else if(m)c.html(window.t("Enroll")).addClass("disabled").hide(),d.html(window.t("The tournament has already started, you can't enroll"));else if(y)if(b){if(c.html(window.t("Enroll")).on("click",function(){o(t)}),C)var B=window.t('<span class="cPremiumLabel">Premium</span> tournament')+". ";1===b?d.html((B||"")+window.t("There is still one place free!")):d.html((B||"")+window.t("There are still {slots} places free!",{"{slots}":b}))}else c.html(window.t("Enroll")).addClass("disabled"),d.html(window.t("Sorry, no more places left, check later!"));else c.html(window.t("Enroll")).addClass("disabled"),d.html(window.t("Enrolling to the tournament is not yet open"));return m&&e.publisher.off("set."+t+":1:1",i),a}function o(e,t){var n=jQuery.extend({},u,{tournament:e});t&&(n.force=1),jQuery.post(l+"enroll",n).done(function(t){t.data&&t.data.alreadyEnrolled?new Dialog.confirmation(window.t("You are already enrolled to {title} and will be automatically withdrawn from it. Do you want to proceed?",{"{title}":t.data.alreadyEnrolled.title}),function(){o(e,!0)}):new Dialog.Enroll(e,!0).link(r).getContent().modal("show")}).fail(function(t){try{var n=jQuery.parseJSON(t.responseText);for(var i in n.errors)if(n.errors[i][0]){var o=n.errors[i][0];break}}catch(a){}"blocked"===i||"restricted-elo"===i?new Dialog.alert(o):"restricted-premium"===i?new Dialog.conversionGoPremium("enroll"):new Dialog.Enroll(e,!1,o).link(r).getContent().modal("show")})}var r,a=this;n=n||config.user().uuid;var s=jQuery(e),l="/api/web/playzoneTournamentAPI/";0===s.length&&errorHandler.msg("error",new Error("container not found"),!0,{container:s}),s.find(".enroll-withdraw").remove();var c=jQuery("<a/>").addClass("cBtnFlexi cBtnBlue enroll-withdraw").appendTo(s).after("<br/>"),d=jQuery("<span/>").addClass("message enroll-withdraw").appendTo(s),u={csrf:config.csrf()};return Extend.Subscriber(a,{},{afterLink:function(e){r=e.publisher,i(e),e.publisher.on("set."+t+".playersMax",i),e.publisher.on("set."+t+".players",i),e.publisher.on("set."+t+":1.startDate",i),e.publisher.on("set."+t+":1:1",i),e.publisher.on("set."+t+".status",i)}}),a},"undefined"==typeof View&&(View={}),View.EvalIndicator=function(e,t,n,i){function o(){e.parent().show(w,{direction:"right"},"fast")}function r(){e.parent().hide(w,{direction:"right"},"fast")}function a(e){return y=!y,l(e,e.publisher.getCurrentPosition(),!0)}function s(e,t){l(e,t.getCurrentPosition(),!0)}function l(e,t,n){clearTimeout(b),b=setTimeout(function(){c(e,t,n)},0)}function c(e,t,n){for(u&&Handler.engine.off(u+":numerical",d);t&&t.isNullMove();)t=t.parentMove;u=t.getEngineFen(),h=t,Handler.engine.on(u+":numerical",d),d(e,Handler.engine.get(t,"numerical",!0,!0),n)}function d(t,n,i){return Handler.engine.shouldInvert(h,n)&&(n=Handler.engine.invert(n)),e.toggleClass("reverse",y).toggleClass("inactive",!!n.approximated).toggleClass("loader",!!n.approximated&&h.isInMainline()),f.setValue(n,i,n.approximated)}var u,h,p,f=this,g=new Handler.Template("broadcast"),m=window.settings.getBoolean("game-broadcast-engine");void 0===i&&(i=1e3),n=["horizontal","vertical"].contains(n)?n:"vertical",e=jQuery(e),t=jQuery(t);var v=e.find(".level");e.length||errorHandler.error(new Error("container not found"),{container:e});var y=e.hasClass("reverse");e.removeClass().addClass("evalIndicator"+(y?" reverse":"")),Extend.Suspendable(f),Extend.Subscriber(f,{currentGameChanged:f.delegate(s),"movedPositionPointer.current":f.delegate(l),flipBoard:f.delegate(a)},{afterLink:function(e){m?o():r(),p=e.publisher,l(e,e.publisher.getCurrentPosition())}}),window.settings.on("settings.game-broadcast-engine.on",o),window.settings.on("settings.game-broadcast-engine.off",r),f.onResume(function(e){e&&p&&(m?o():r(),l({publisher:p},p.getCurrentPosition()))});var w="slide";$redesign&&(w="fade");var b;return f.setValue=function(e,o,r){var a=Controller.Broadcast.convertEvaluationToPercent(e,y),s={};return s["horizontal"===n?"width":"height"]=a+"%",t.length&&t.attr("data-tooltip",g.render("game.engineTooltip",{value:Handler.engine.formatEngine(e.score,e.mate),phrase:Controller.Broadcast.getPhraseForEvaluation(e.score,e.mate),outdated:r})),v.stop(!0),!i||o?void v.css(s):void v.animate(s,o?0:i)},f},"undefined"==typeof View&&(View={}),function(){function e(){i=(new Chess.Game).setCheckForGameEnd(!1).setClockStartMove(2).setMoveMode({duringGame:{sideline:!0,mainline:!0},afterGame:{sideline:!0,mainline:!0}}),d=new Controller.BroadcastTournament;var e=new Handler.Template("broadcast");n=jQuery(e.render("tooltip"+$redesignSuffix,{}));var l=n.children(".clock");return n.children(".board").addClass("noInfo"),o=new View.ChessBoard(n.children(".board"),!1).link(i),$redesign?(a=new View.ChessClockRedesign(l.children(".clockWhite"),"w",!0).link(i),s=new View.ChessClockRedesign(l.children(".clockBlack"),"b",!0).link(i)):(a=new View.ChessClock(l.children(".clockWhite"),"w",!0).link(i),s=new View.ChessClock(l.children(".clockBlack"),"b",!0).link(i)),r=new View.NotationArea(n.children(".notation"),"tooltip").link(i),window.settings.on("settings.game-broadcast-engine",t),t(),n}function t(e){!e&&window.settings.getBoolean("game-broadcast-engine")?l=l||new View.EvalIndicator(n.children(".evalIndicator").show(),void 0,"vertical",0):(l=void 0,n.children(".evalIndicator").hide(),n.addClass("noEval"))}var n,i,o,r,a,s,l,c,d,u={};View.GameTooltip=function(o,a){function s(e,t){d.on(e,t),u[e]=t}function h(){for(var e in u)d.off(e,u[e])}function p(){n.detach()}function f(e){"finished"===e.status&&e.result?(i.setGameEndByPoints(e.result.white,e.result.black,void 0,!0),setTimeout(function(){var t=0;1==e.result.white?t=1e3:1==e.result.black&&(t=-1e3),m(null,null,{score:t})},100)):i.reOpen()}function g(e){var t=d.getRounds(a)[e.roundId].matches[e.matchId].games[e.gameId],o=d.getAttribute(a,"fen")||void 0;if(!t)return void i.setStartPosition(new Chess.Position({fen:o}));if(t.earlierFen){if(r.isSuspended()&&(r.resume(),n.children(".notation").show(),n.removeClass("simple")),i.setStartPosition(new Chess.Position({fen:t.earlierFen})),t.lastMoves){for(var s=0;s<t.lastMoves.length;s++)i.move(t.lastMoves[s],void 0,!0,void 0,void 0,!0);Object.forEach(i.getAllPositions(),function(e){i.setTimeUsage(0,e)})}}else r.isSuspended()||(r.suspend(),n.children(".notation").hide(),n.addClass("simple")),i.setStartPosition(new Chess.Position({fen:t.currentFen||o}));f(t.gameStatus),v(e,t),m(e)}function m(e,t,n){l&&(n=n||(t||d.getRounds(a)[e.roundId].matches[e.matchId].games[e.gameId]).engine,n&&l.setValue(n))}function v(e,t){t||(t=d.getRounds(a)[e.roundId].matches[e.matchId].games[e.gameId]);var n=i.getMoveRight(),o=Controller.Broadcast.getTimeOffset(),r=Object.map({white:"w"===n,black:"b"===n},function(e,n){return"running"===t.gameStatus.status?{base:Math.max(1,t.clock[n]-(e?Date.now()-o-t.clock.now:0))}:{timeLeft:t.clock[n]}});i.setClockInformation(r)}var y=this;return o=jQuery(o),c=new Controller.Broadcast,o.each(function(){var i=jQuery(this),o=i.data("gamePath");if(o&&c.snapshotsAvailable(a,o.roundId,o.matchId,o.gameId)){var r=i.find(".tScore");r.length||(r=i);var l=r.children("div:first-child");l.length||(l=i);var u,y,w,b,C;r.off("mouseenter.gametooltip").on("mouseenter.gametooltip",function(){n=n||e(),p(),t(!!d.getAttribute(a,"c24")),g(o),h(),u=function(){g(o)},y=function(e,t){f(t.value),v(o)},w=function(e,t){m(o,void 0,t.value)},b=function(){v(o)},C="set."+a+":"+o.roundId+":"+o.matchId+":"+o.gameId,s(C+".currentFen",u),s(C+".gameStatus",y),s(C+".engine",w),s(C+".clock",b)}).off("chess24:tooltip:hide").on("chess24:tooltip:hide",function(){d.off(C+".currentFen",u),d.off(C+".gameStatus",y),d.off(C+".engine",w),d.off(C+".clock",b)}),l.tooltip({side:"horizontal",SHOW_DELAY:200,HIDE_DELAY:1,invalidate:!0},function(t,i){n=n||e(),i(n)})}}),y}}(),"undefined"==typeof View&&(View={}),View.Header=function(e,t,n){function i(e,t){L?o(e,t):r(e,t)}function o(e,t){g();var n=C.find(".playzoneTournamentIcon");switch(n.removeClass("statePending stateCancelled stateRunning"),t.value){case"upcoming":n.addClass("statePending");break;case"running":n.addClass("stateRunning"),f();break;case"cancelled":p(),n.addClass("stateCancelled");break;case"finished":}}function r(e,t){switch(t.value){case"running":f();break;default:g()}}function a(e,n){return n.value?A.removeClass("liveBroadcast").html(k.render("tournament.live",{tournamentUrl:y,languages:n.value.map(function(e){return e.language}).unique()})).show():"running"===b.getAttribute(t,"status")?f():g(),w}function s(e,t){var n=t&&t.value&&(t.value[config.language()]||t.value.en);return n?(C.find(".tournamentTitle").text(n),w):w}function l(e,t){return B.empty(),t.value&&B.append(jQuery('<img src="'+t.value+'" />')),w}function c(e){if(n=b.getAttribute(t,"currentRound"),"undefined"!=typeof n){var i=b.getAttribute(t,"currentGame"),o=b.getRounds(t)&&b.getRounds(t)[n]&&b.getRounds(t)[n].startDate&&b.getRounds(t)[n].startDate[i]||b.getRounds(t)[n].startDate;return isNaN(o)?void 0:d(e,{value:o})}}function d(e,t){return m=t.value,p(),w}function u(e,t){return O.html(t.value),w}function h(e,t){return M.html(t.value),w}function p(){clearTimeout(v);var e=Controller.Broadcast.offsetCorrectedDateNow(),i=m-e,o=!1;if(L){var r=b.getAttribute(t,"status");"cancelled"===r&&(o=!0)}if(o)T.hide(),x.hide(),_.show();else if(e>=m)T.hide(),_.hide(),x.show(),P.html(n),u(void 0,{value:b.getAttribute(t,"runningGames")}),h(void 0,{value:b.getAttribute(t,"finishedGames")});else{x.hide(),_.hide(),T.show(),void 0===i&&(i=m-e);var a=Date.getSplitedTime(i);E.text(a.days),S.text(a.hours),j.text(a.minutes),I.text(a.seconds),v=setTimeout(p,1e3-e%1e3)}return w}function f(){b.getAttribute(t,"video")||A.show().addClass("liveBroadcast")}function g(){b.getAttribute(t,"video")||A.hide().removeClass("liveBroadcast")}var m,v,y,w=this,b=new Controller.BroadcastTournament,C=jQuery(e),k=new Handler.Template("broadcast");C.length||errorHandler.error(new Error("container not found in View.Header"));var F=C.find(".tournamentTimeBox"),x=F.children(".ongoing"),T=F.children(".pending"),_=F.children(".cancelled"),E=T.find(".days"),S=T.find(".hours"),j=T.find(".minutes"),I=T.find(".seconds"),A=C.find(".liveTournamentIcon"),O=x.find(".gamesRunning"),M=x.find(".gamesFinished"),P=x.find(".currentRound"),B=C.find(".tournamentLogo"),R=C.find(".pgnLink"),L=!!b.getAttribute(t,"c24");config.level().isPremium||R.removeAttr("href"),R.on("click",function(e){return config.level().isPremium?(Handler.tracking("pgn","tournament"),!0):(Handler.tracking("pgn","tournamentConversion"),Dialog.conversionGoPremium("pgnDownload"),!1)}),C.on("click",function(e){if(e.target!==R.get(0)){var n=b.getAttribute(t,"currentRound"),i=new Controller.Broadcast;return i.showGameWhenReady(t,n),!1}}),Extend.Suspendable(w);var N={};return N["set."+t+".runningGames"]=w.delegate(u),N["set."+t+".finishedGames"]=w.delegate(h),N["set."+t+".currentRound"]=w.delegate(c),N["set."+t+".currentGame"]=w.delegate(c),N["set."+t+".logo"]=w.delegate(l),N["set."+t+".video"]=w.delegate(a),N["set."+t+".titles"]=w.delegate(s),N["set."+t+".status"]=w.delegate(i),
N["set."+t+":"+n+".startDate"]=w.delegate(d),Extend.Subscriber(w,N,{afterLink:function(e){a(e,{value:b.getAttribute(t,"video")}),s(e,{value:b.getAttribute(t,"titles")}),l(e,{value:b.getAttribute(t,"logo")}),i(e,{value:b.getAttribute(t,"status")}),c(e)}}),w.onResume(function(e){e&&(a(void 0,{value:b.getAttribute(t,"video")}),s(void 0,{value:b.getAttribute(t,"titles")}),l(void 0,{value:b.getAttribute(t,"logo")}),i(void 0,{value:b.getAttribute(t,"status")}),c(void 0))}),w.setTournamentUrl=function(e){return y=e,C.find(".tournamentLink").attr("href",y),w},w},"undefined"==typeof View&&(View={}),View.Intro=function(e,t){function n(n,i){function o(e,t){e.show().find("img").attr("src",t.picture).end().find("span").html(t.name).add(e.find("img")).addClass("ofMiniProfile position-top").data("uuid",t.id).addMiniprofile().end().attr("href",t.link)}if(s.getAttribute(t,"c24")){var r=s.getAttribute(t,"status");if(e.find(".introTeaser > div").hide().filter("."+r).show(),"finished"===r){e.find(".gold, .silver, .bronze").hide();var a=s.getAttribute(t,"standings").live,l=s.getAttribute(t,"players");if(!a)return;a[0]?o(e.find(".gold"),l[a[0]]):e.find(".gold").hide(),a[1]?o(e.find(".silver"),l[a[1]]):e.find(".silver").hide(),a[2]?o(e.find(".bronze"),l[a[2]]):e.find(".bronze").hide(),e.find(".tournamentEnrollButton").hide()}else e.find(".tournamentEnrollButton").show()}}function i(n){var i=n&&(n[config.language()]||n.en),o=!!s.getAttribute(t,"c24");if(o){e.find(".playzoneTournamentType span").html("Open");var l=e.find(".tournamentIntro"),c=l.find(".learnMore").detach();l.html(i+" ").append(c);var d=e.find(".playzoneTournamentTime");new View.TournamentTime(d,t).link(s);var h=e.find(".tournamentEnrollButton");new View.EnrollButton(h,t).link(s)}else{if(!i)return a;for(var p=r(i,u),f=0;f<p.length;f++)p[f]&&p[f].trim().length?jQuery(e[f]).show().html(p[f]):jQuery(e[f]).hide();for(var f=p.length;f<e.length;f++)jQuery(e[f]).hide()}return a}function o(e){var n=e.publisher.getAttribute(t,"fen"),i=e.publisher.getAttribute(t,"unrated");n?(p.show(),l=l||jQuery('<div class="chessBoardViewBubbleContainer" />'),l.bubble({align:p.find("a"),side:"bottom",point:"precise",offset_y:-10,noanimation:!0}),p.find("a").on("mouseover",function(){l.bubble("show")}).on("mouseout",function(){l.bubble("hide")}),c||(c=(new Chess.Game).setNoTimeout(!0)),c.setStartPosition(new Chess.Position({fen:n})),d||(d=new View.ChessBoard(l,!1),d.link(c))):(p.hide(),l&&l.hide()),i?f.show():f.hide(),n||i?h.show():h.hide()}function r(e,t){if(!e)return[];if(e.contains("\n"))return e.split("\n");var n=[],i=Math.floor(e.length/t),o=0;do{for(var r=i;" "!==e.charAt(r+o)&&r+o<e.length;)r++;n.push(e.substr(o,r)),o=o+r+1}while(o<e.length);return n}var a=this;e=jQuery(e),0===e.length&&errorHandler.msg("error",new Error("container not found"),!0,{container:e});var s,l,c,d,u=e.length,h=e.find(".customProperties"),p=h.find(".customFen"),f=h.find(".unrated");Extend.Suspendable(a);var g={};return g["set."+t+".descriptions"]=a.delegate(function(e,t){i(e,t.value)}),g["set."+t+".status"]=a.delegate(function(e,t){n(e,t.value)}),g["set."+t+".fen set."+t+".unrated"]=a.delegate(function(e,t){o(e)}),Extend.Subscriber(a,g,{afterLink:function(e){s=e.publisher,i(e.publisher.getAttribute(t,"descriptions")),n(e.publisher.getAttribute(t,"status")),o(e)}}),a.onResume(function(e){e&&(i(s.getAttribute(t,"descriptions")),n({publisher:s},s.getAttribute(t,"status")))}),a},"undefined"==typeof View&&(View={}),View.KnockoutTreeGroup=function(e,t,n){function i(){f={},m=[],h=new Controller.Broadcast,p=h.getTemplates();var e=v.getAttribute(n,"currentRound"),t=e%2!==0;y=t?(e+1)/2:e/2,o(y)}function o(e){y=e,g=l(e),f[e]=p.render("knockoutTree.slide",g.slide),d.html(p.render("knockoutTree.main",g));var t=d.find(".slides");t.empty().html(f[e]),r(e),a(g.pages,o)}function r(e){for(var t=g.slide;m.length>0;){var i=m.pop();i instanceof View.KnockoutTreeMatch&&i.unlink(v)}for(var o=0;o<t.matches.left.length;o++){var r=t.matches.left[o],a=r.roundNo,s=r.matchNo,l=r.gamesPerMatch,c=d.find(".slideNo"+e+" .knockoutTournamentRoundLeft .matchNo"+s);m.push(new View.KnockoutTreeMatch(c,n,a,s,l).link(v))}for(var u=0;u<t.matches.right.length;u++){var h=t.matches.right[u],p=h.roundNo,f=h.matchNo,y=h.gamesPerMatch,w=d.find(".slideNo"+e+" .knockoutTournamentRoundRight .matchNo"+f);m.push(new View.KnockoutTreeMatch(w,n,p,f,y).link(v))}}function a(e,t){var i=Object.values(Object.map(e,function(e){return e.slideNo})),o=Object.find(e,function(e){return e.current}),r=v.getAttribute(n,"currentRound");d.find(".pager").pager({live:Math.ceil(r/2),current:o&&o.slideNo||i[0]||0,margin:3,values:i,labels:i},t)}function s(e,t){var n=e[t];return n?Object.extend({id:t},n):{}}function l(e){function t(e,t){var n=[];for(var i in e){i=parseInt(i,10);var o=i%2!==0,r=o?(i+1)/2:i/2;o&&n.push({slideNo:r,current:r==t})}return n}var i,o={},r=v.getAttribute(n,"rounds"),a=v.getAttribute(n,"matchGroups"),l=v.getAttribute(n,"gamesPerMatch"),c=v.getAttribute(n,"players");o.shortList=Object.getLength(r)<=2;for(var d in r){d=parseInt(d,10);var u=d%2!==0,h=u?"left":"right",p=u?(d+1)/2:d/2;if(p===e){void 0===i&&(i={slideNo:p,rounds:{left:{},right:{}},matches:{left:[],right:[]}}),r[d].label&&(i.rounds[h].label=r[d].label[config.language()]||r[d].label),i.rounds[h].no=d;var f=r[d].matches;for(var g in f){var m={running:0,finished:0,upcoming:0};g=parseInt(g,10);var w=g-1,b=f[g];void 0===i.matches[h][w]&&(i.matches[h][w]={roundNo:d,slideId:p,side:h,matchNo:g,gamesPerMatch:l[d],games:[]});var C=b.games[1];C&&(i.matches[h][w].upper=s(c,C.player.white),i.matches[h][w].lower=s(c,C.player.black));for(var k={upper:0,lower:0},F=b.games,x=1;x<=l[d];x++){var T=x-1;void 0===i.matches[h][w].games[T]&&(i.matches[h][w].games[T]={gameId:x});var _=F[x];if(void 0!==_){if(m[_.gameStatus.status]=++m[_.gameStatus.status]||1,C.player.white===_.player.white&&C.player.black===_.player.black)var E="white",S="black";else C.player.white===_.player.black&&C.player.black===_.player.white&&(E="black",S="white");var j=_.gameStatus.result&&void 0!==_.gameStatus.result[E]&&1===parseInt(_.gameStatus.result[E],10),I=_.gameStatus.result&&void 0!==_.gameStatus.result[S]&&1===parseInt(_.gameStatus.result[S],10),A=_.gameStatus.result&&(void 0!==_.gameStatus.result[E]&&"0.5"===_.gameStatus.result[E].toString()?"&frac12;":_.gameStatus.result[E]),O=_.gameStatus.result&&(void 0!==_.gameStatus.result[S]&&"0.5"===_.gameStatus.result[S].toString()?"&frac12;":_.gameStatus.result[S]);if(void 0!==_.engine)var M=Controller.Broadcast.convertEvaluationToPercent(_.engine,"white"===E);else M=50;i.matches[h][w].games[T]={gameId:x,fen:_.currentFen,showEngine:window.settings.getBoolean("game-broadcast-engine"),finished:"finished"===_.gameStatus.status,running:"running"===_.gameStatus.status,upcoming:"upcoming"===_.gameStatus.status,reverseEvaluationIndicator:"white"===E,evaluation:M,upper:{winner:j,score:A,color:E},lower:{winner:I,score:O,color:S}},_.gameStatus.result&&!isNaN(_.gameStatus.result[E])&&(k.upper+=_.gameStatus.result[E]),_.gameStatus.result&&!isNaN(_.gameStatus.result[S])&&(k.lower+=_.gameStatus.result[S])}else i.matches[h][w].games[T].upcoming=!0}var P=0===m.running&&a[d].contains(m.finished);i.matches[h][w].finalResult={upper:{winner:k.upper>k.lower&&P,score:Controller.Broadcast.scoreToString(k.upper)},lower:{winner:k.lower>k.upper&&P,score:Controller.Broadcast.scoreToString(k.lower)}}}}}return o.slide=i,o.pages=t(r,y),o}var c=this,d=jQuery(e),u=[];0===d.length&&errorHandler.msg("error",new Error("container not found"),!0,{container:d});var h,p,f,g,m,v,y;return Extend.Suspendable(c),Extend.Subscriber(c,{},{afterLink:function(e){for(var t=0;t<u.length;t++)u[t].link(e.publisher);v=e.publisher,i()},afterUnlink:function(e){for(var t=0;t<u.length;t++)u[t].unlink(e.publisher)}}),c},"undefined"==typeof View&&(View={}),View.KnockoutTreeMatch=function(e,t,n,i,o){function r(e,r){C=!!r.value;for(var a=h.getRounds(t),s=a[n].matches[i],l=1;o>=l;l++)s.games[l]&&c(l,s.games[l].gameStatus,s.games[1])}function a(e,o,r){switch(r.key){case"gameStatus":var a=e.publisher.getRounds(t)[n].matches[i].games[1];c(o,r.value,a),s(t,n,i);break;case"currentFen":d(o,r.value);break;case"player":u(o,r.value);break;case"engine":l(o,r.value)}return f}function s(e,t,n){var i=h.getAttribute(e,"matchGroups"),o=h.getAttribute(e,"rounds"),r={upper:0,lower:0},a={running:0,finished:0,upcoming:0},s=o[t].matches[n].games[1];for(var l in o[t].matches[n].games){var c=o[t].matches[n].games[l];if(a[c.gameStatus.status]=++a[c.gameStatus.status],s.player.white===c.player.white&&s.player.black===c.player.black)var d="white",u="black";else{if(s.player.white!==c.player.black||s.player.black!==c.player.white)continue;d="black",u="white"}c.gameStatus.result&&!isNaN(c.gameStatus.result[d])&&(r.upper+=c.gameStatus.result[d]),c.gameStatus.result&&!isNaN(c.gameStatus.result[u])&&(r.lower+=c.gameStatus.result[u])}var p=0===a.running&&i[t].contains(a.finished),f={upper:r.upper>r.lower&&p,lower:r.lower>r.upper&&p};y.removeClass("winnerPlayer").removeClass("loserPlayer"),w.removeClass("winnerPlayer").removeClass("loserPlayer"),f.upper&&!f.lower?(y.addClass("winnerPlayer"),w.addClass("loserPlayer")):!f.upper&&f.lower&&(y.addClass("loserPlayer"),w.addClass("winnerPlayer"))}function l(e,t){if(t){var n=v.find("div.gameId"+e).find("span.evalIndicator");n.children("span").stop(!0).animate({height:Controller.Broadcast.convertEvaluationToPercent(t,n.hasClass("reverse"))+"%"})}}function c(e,o,r){var a,s,l,c=v.find("div.gameId"+e);if("upcoming"===o.status)a={},l="knockoutTree_games_upcoming";else if("running"===o.status){var d=h.getRounds(t)[n].matches[i].games[e],u=r.player.white===d.player.white;if(void 0!==d.engine)var p=Controller.Broadcast.convertEvaluationToPercent(d.engine,u);else p=50;a={reverseEvaluationIndicator:u,evaluation:p,showEngine:C},l="knockoutTree_games_running"}else if("finished"===o.status){var d=h.getRounds(t)[n].matches[i].games[e];if(r.player.white===d.player.white&&r.player.black===d.player.black)var g="white",y="black";else r.player.white===d.player.black&&r.player.black===d.player.white&&(g="black",y="white");var w=Controller.Broadcast.scoreToString(o.result[g]),b=Controller.Broadcast.scoreToString(o.result[y]);a={upper:{winner:1===o.result[g],score:w,color:g},lower:{winner:1===o.result[y],score:b,color:y}},l="knockoutTree_games_finished"}s=m.render(l,a),c.html(s);var k=v.find("div.matchContainerInsider div.gameTable div.gameContainer dl > dt"),F=v.find("div.matchContainerInsider div.gameTable div.gameContainer dl > dd"),x=0,T=0;k.each(function(){var e=jQuery(this).html().trim();"1"===e?e=1:"0"===e?e=0:"½"===e?e=.5:"—"===e&&(e=0),x+=e}),F.each(function(){var e=jQuery(this).html().trim();"1"===e?e=1:"0"===e?e=0:"½"===e?e=.5:"—"===e&&(e=0),T+=e}),x=x%1!==0?(0===Math.floor(x)?"":Math.floor(x).toString())+" &frac12;":x,T=T%1!==0?(0===Math.floor(T)?"":Math.floor(T).toString())+" &frac12;":T;var _=v.find("div.finalResult"),E=_.find("dl > dt"),S=_.find("dl > dd");return E.html(x),S.html(T),f}function d(e,t){if(p instanceof Chess.Game){var n=new Chess.Position({fen:t});p.setStartPosition(n)}return f}function u(e,n){if(1===e){var i="knockoutTree_player",o=v.find("div.upperPlayer"),r=v.find("div.lowerPlayer");for(var a in n){var s=m.render(i,Object.extend({id:n[a]},h.getPlayer(t,n[a])));switch(a){case"white":o.html(s).find("> h6 > span").addPlayerTournamentStatistics(t);break;case"black":r.html(s).find("> h6 > span").addPlayerTournamentStatistics(t)}}return f}}var h,p,f=this,g=new Controller.Broadcast,m=g.getTemplates(),v=jQuery(e);0===v.length&&errorHandler.msg("error",new Error("container not found"),!0,{container:v}),void 0===t&&errorHandler.msg("error",new Error("no tournamentId given"),!0),(void 0===n||isNaN(n))&&errorHandler.msg("error",new Error("no roundId given"),!0),(void 0===i||isNaN(i))&&errorHandler.msg("error",new Error("no matchId given"),!0),(void 0===o||isNaN(o)||1>o)&&errorHandler.msg("error",new Error("invalid gamesPerMatch given"),!0);var y=v.find(".upperPlayer"),w=v.find(".lowerPlayer"),b=v.find(".gameContainer"),C=window.settings.getBoolean("game-broadcast-engine");y.find("> h6 > span").addPlayerTournamentStatistics(t),w.find("> h6 > span").addPlayerTournamentStatistics(t),b.each(function(e){var o=e+1;if(!jQuery(this).hasClass("gameId"+o))return!1;var r=jQuery(this);r.data("gamePath",{roundId:n,matchId:i,gameId:o}),r.on("click",function(){var e=h.getRounds(t);if(e[n].matches[i].games[o]){try{hideChessBoardBubble()}catch(r){}return g.showGame(t,n,i,o),!1}})}),new View.GameTooltip(b,t);for(var k={},F=1;o>=F;F++)!function(e){k["set."+t+":"+n+":"+i+":"+e]=function(t,n){a(t,e,n)}}(F);return Extend.Suspendable(f),Extend.Subscriber(f,k,{afterLink:function(e){h=e.publisher}}),window.settings.on("settings.game-broadcast-engine",r),f},"undefined"==typeof View&&(View={}),View.MultiBoard=function(e,t,n,i,o){function r(e,t){b=!!t.value,d(i)}function a(e){return k.shorterFirstName(e,15)}function s(){for(;R.length;)R.shift()()}function l(e){var n=e.publisher.getAttribute(t,"currentRound");T.setCurrentRound(n,1)}function c(e){var n=new Handler.Template,i=C.getAttribute(t,"players")[e],o={Name:i.name,Title:i.title,Elo:i.elo,Country:i.country,Link:i.link,FideId:e,Picture:i.picture||n.render("playerImageUrl",{fideId:e})},r=C.getAttribute(t,"c24");return r&&(o.UUID=e),o}function d(e){if(void 0!==e){if(i!=e){var o=k.getCurrentGamePath();e==o.match?(m=o.match,g=o.game):(m=void 0,g=void 0)}i=e}0===j.length&&Object.forEach(C.getAttribute(t,"rounds")[n].matches[i].games,function(e,t){j.push({matchId:i,gameId:t})}),P=f(),d.delegate=d.delegate||function(){d()};var r=C.getTournamentPR(t);r.off("set.rounds",d.delegate),P.games.length||r.on("set.rounds",d.delegate),y=Math.ceil(P.games.length/_),v=0,w||(F&&!I&&C.on("set."+t+".teams",h),x&&C.on("set."+t+".currentRound",l),w=!0),u()}function u(){S.html(M.render("multiboard.main"+$redesignSuffix,Object.merge(P,{games:P.games.slice(v*_,(v+1)*_),renderLinks:!!O}))),layout(S),s();for(var e=v*_;e<P.games.length&&(v+1)*_>e;e++)!function(e){function i(){var e=C.getRounds(t),i=e[n].matches[u].games[h];if(!i)return B[p].setStartPosition(new Chess.Position),void(v&&v.setValue(B[p].getEngine()));if(i.earlierFen||i.lastMoves){if(B[p].setStartPosition(new Chess.Position({fen:i.earlierFen})),i.lastMoves)for(var o=0;o<i.lastMoves.length;o++)B[p].move(i.lastMoves[o],void 0,void 0,void 0,void 0,!0)}else B[p].setStartPosition(new Chess.Position({fen:i.currentFen}));void 0!==i.engine&&v&&v.setValue(i.engine)}function r(){if(v){var e=C.getRounds(t),i=e[n].matches[u].games[h];i&&void 0!==i.engine&&v.setValue(i.engine)}}function s(){var e=C.getRounds(t),i=e[n].matches[u].games[h],o=B[p].getMoveRight(),r=Controller.Broadcast.getTimeOffset();return Object.map({white:"w"===o,black:"b"===o},function(e,t){return"running"===i.gameStatus.status?{base:Math.max(1,i.clock[t]-(e?Date.now()-r-i.clock.now:0))}:{timeLeft:i.clock[t]}})}function l(e,t){t.value.result?B[p].setGameEndByPoints(t.value.result.white,t.value.result.black,void 0,!0):B[p].setGameStatus("OPEN",void 0,!0)}function d(e,t){B[p].setClockInformation(s())}var u=e.matchId,h=e.gameId,p=u+"-"+h,f=S.find(".gameId"+p);if(B[p]=new Chess.Game({fen:e.fen}).setMoveMode(E).setNoTimeout(!1),!x&&b)var v=new View.EvalIndicator(f.find(".evalIndicator"),void 0,"vertical");else f.find(".evalIndicator").remove(),f.addClass("noEval");B[p].setMeta("White",c(e.reverse?e.playerA:e.playerB)),B[p].setMeta("Black",c(e.reverse?e.playerB:e.playerA));var y=[new View.PlayerInfo(f.find(".playerAMeta"),e.reverse?"w":"b",a,t).link(B[p]),new View.PlayerInfo(f.find(".playerBMeta"),e.reverse?"b":"w",a,t).link(B[p]),new View.ChessBoard(f.find(".board"),!1).link(B[p])];if($redesign&&y[2].hideBorder(),e.reverse&&y[2].flip(),B[p].setClockInformation(s()),e.lastMoves)for(var w=0;w<e.lastMoves.length;w++)B[p].move(e.lastMoves[w],void 0,void 0,void 0,void 0,!0);void 0!==e.engine&&v&&v.setValue(e.engine,!0),"finished"===e.gameStatus.status&&e.gameStatus.result&&B[p].setGameEndByPoints(e.gameStatus.result.white,e.gameStatus.result.black,void 0,!0);var k=T.delegate(i),F=T.delegate(r),_=T.delegate(l),j=T.delegate(d);C.on("set."+t+":"+n+":"+u+":"+h+".currentFen",k),C.on("set."+t+":"+n+":"+u+":"+h+".engine",F),C.on("set."+t+":"+n+":"+u+":"+h+".gameStatus",_),C.on("set."+t+":"+n+":"+u+":"+h+".clock",j),R.push(function(e,i){return function(){for(var o=0;o<e.length;o++)e[o].unlink(i);C.off("set."+t+":"+n+":"+u+":"+h+".currentFen",k),C.off("set."+t+":"+n+":"+u+":"+h+".engine",F),C.off("set."+t+":"+n+":"+u+":"+h+".gameStatus",_),C.off("set."+t+":"+n+":"+u+":"+h+".clock",j)}}(y,B[p])),o&&S.find(".gameId"+p+", .gameTrigger"+p).on("click",function(){var e=S.find(".gameId"+p);if(!e.hasClass("active")){m=u,g=h;var t=S.find(".gameTrigger"+p);S.find(".gameContainer.active, .gameTrigger.active").removeClass("active"),e.add(t).addClass("active"),o(n,u,h)}})}(P.games[e]);y-1>v?S.find(".nextPage").show().on("click",function(){v++,u()}):S.find(".nextPage").hide(),v>0?S.find(".previousPage").show().on("click",function(){v--,u()}):S.find(".previousPage").hide(),S.find(".gameContainer").length<=_/2?S.find(".previousPage, .nextPage").addClass("halfHeight"):S.find(".previousPage, .nextPage").removeClass("halfHeight"),m&&g&&T.setCurrentGame(m,g),F&&p(),S.find(".customize").on("click",function(){return config.level().isPremium?void new Dialog.GameSelector(t,n,j,function(e){j=e,v=0,I=j.length>0&&!!j.find(function(e,t){return t>0&&e.matchId!=j[0].matchId}),!I&&j.length&&(m=j[0].matchId);var o=C.getAttribute(t,"gamesPerMatch")||Object.getLength(C.getAttribute(t,"rounds")[n].matches[1].games);A=I||j.length!=o,d(i)}):void new Dialog.conversionGoPremium("multiboard")}),S.find(".reset").toggleClass("hidden",!A).on("click",function(){config.level().isPremium&&(j=[],v=0,I=!1,A=!1,d(i))})}function h(){var e=M.render("multiboardTeamHeader",f());e&&jQuery("div.teamMultigameView > header",S).replaceWith(e),p(),layout(S)}function p(){S.find(".dropdownFilter").off("chess24:show").on("chess24:show",function(e){return e.stopPropagation(),!1}).off("chess24:hide").on("chess24:hide",function(e){return e.stopPropagation(),!1}).find("input:radio").off("change").on("change",function(){j=[],d(jQuery(this).val())})}function f(){function e(e){if("undefined"!=typeof l[e])return l[e];for(var t in r)for(var n in r[t].rooster)if(r[t].rooster[n]==e)return l[e]=t,t}var o=C.getAttribute(t,"rounds"),r=C.getAttribute(t,"teams"),a=C.getAttribute(t,"players"),s=C.getAttribute(t,"standings"),l={},c=o[n].matches[i];if(!c)return void errorHandler.msg("error",new Error("there is no match to display"),!0,{round:o[n],matchId:i});var d={id:i,games:[],matches:[],multiMatch:I};F&&!I&&jQuery.extend(d,{teamEvent:!0,teamA:r[c.teams[1]].name,teamB:r[c.teams[2]].name,scoreA:0,scoreB:0,eloA:0,eloB:0,standingA:s.round.indexOf(c.teams[1])+1,standingB:s.round.indexOf(c.teams[2])+1,resultsA:C.getTeamResults(t,c.teams[1],n-1),resultsB:C.getTeamResults(t,c.teams[2],n-1)});var u=0,h=0;if(j.forEach(function(i){if(k.snapshotsAvailable(t,n,i.matchId,i.gameId)){var r=o[n].matches[i.matchId].games[i.gameId];if(F&&!I){var s={white:e(r.player.white),black:e(r.player.black)},l=s.white===c.teams[1],p=l?"white":"black",f=l?"black":"white";d.eloA+=a[r.player[p]].elo||0,d.eloB+=a[r.player[f]].elo||0,u+=a[r.player[p]].elo?1:0,h+=a[r.player[f]].elo?1:0,d.scoreA+=r.gameStatus.result&&r.gameStatus.result[p]||0,d.scoreB+=r.gameStatus.result&&r.gameStatus.result[f]||0}else l=!1,p="black",f="white";d.games.push({matchId:i.matchId,gameId:i.gameId,fen:r.earlierFen||r.lastMoves&&Chess.defaultFen||r.currentFen,lastMoves:r.lastMoves,gameKey:r.fullGameRKey,reverse:l,playerA:r.player[p],playerB:r.player[f],clock:r.clock,engine:r.engine,gameStatus:r.gameStatus,own:[r.player.white,r.player.black].contains(config.user().uuid),url:O?Handler.Template.renderString(O,{tournamentId:t,roundId:n,matchId:i.matchId,gameId:i.gameId}):null})}}),F&&!I){d.eloA=u?Math.round(d.eloA/u):0,d.eloB=h?Math.round(d.eloB/h):0,d.scoreA=Controller.Broadcast.scoreToString(d.scoreA),d.scoreB=Controller.Broadcast.scoreToString(d.scoreB);for(var p in o[n].matches)if(o[n].matches[p].teams&&o[n].matches[p].teams[1]&&o[n].matches[p].teams[2]){var f=F?r[o[n].matches[p].teams[1]]:void 0,g=F?r[o[n].matches[p].teams[2]]:void 0,m=C.getTeamResultsForRound(t,o[n].matches[p].teams[1],n),v=C.getTeamResultsForRound(t,o[n].matches[p].teams[2],n);d.matches.push({id:p,active:p==i,teamA:f?f.name:void 0,teamB:g?g.name:void 0,pointsA:Controller.Broadcast.scoreToString(m.bp),pointsB:Controller.Broadcast.scoreToString(v.bp)})}}else for(var p in o[n].matches)d.matches.push({id:p});return d}var g,m,v,y,w,b=window.settings.getBoolean("game-broadcast-engine"),C=new Controller.BroadcastTournament,k=new Controller.Broadcast,F=C.isTeamEvent(t),x=!!C.getAttribute(t,"c24"),T=this,_=8,E={mainline:!0,sideline:!0};E={duringGame:E,afterGame:E};var S=jQuery(e),j=[],I=!1,A=!1,O=S.data("game-url");S.length||errorHandler.error(new Error("container not found"),{container:S}),t&&n&&i||errorHandler.error(new Error("missing information about match to be displayed"),{container:S,tournamentId:t,roundId:n,matchId:i});var M=new Handler.Template("broadcast"),P={},B={},R=[];return Extend.Suspendable(T,!0),T.onResume(function(e){e&&(b=window.settings.getBoolean("game-broadcast-engine"),d())}),window.settings.on("settings.game-broadcast-engine",T.delegate(r)),T.setCurrentGame=function(e,t){m=e,g=t;var n=e+"-"+t;S.find(".gameContainer.active, .gameTrigger.active").removeClass("active");var i=S.find(".gameId"+n);return i.length&&i.add(S.find(".gameTrigger"+n)).addClass("active"),T},T.setCurrentRound=function(e,t){return A?T:(n!==e&&(j=[],n=e,d(t)),T)},T.setItemsPerPage=function(e){return _=e,T.isSuspended()||d(),T},T},"undefined"==typeof View&&(View={}),View.OpenGames=function(e,t,n,i){function o(e,t){M=!!t.value,r(A)}function r(e){a(e),w(e)}function a(n){A=n;var o=x.getAttribute(t,"rounds"),r=l(n);r.header=i,e.html(_.render("open."+(r.totalGames?"games":"nogames")+$redesignSuffix,r));var c,d=Object.reduce(o,function(e,t,n){return e.push(t.label&&t.label[config.language()]||t.label||n),e},[]),u=d.reduce(function(e,t){return Math.max(e,(""+t).length)},0);if(c=$redesign?5>u?5:5>u?2:1:3>u?3:5>u?2:1,e.find(".pager").pager({live:x.getAttribute(t,"currentRound"),current:n,margin:c,values:Object.keys(o),labels:d},a),!x.getAttribute(t,"unpredictableSchedule"))if(r.roundStartCountdown){e.find(".noGamesSimple, .noGamesCurrent, .roundStarted").hide(),e.find(".noGamesCounter, .futureGameCountdown").show();var h=e.find(".noGamesCounter .time, .futureGameCountdown .time");s(r.startDate,h.filter(".hours"),h.filter(".minutes"),h.filter(".seconds"),function(){e.find(".noGamesCounter").hide(),e.find(".noGamesSimple").toggle(!r.roundIsCurrentlyRunning),e.find(".noGamesCurrent").toggle(r.roundIsCurrentlyRunning),e.find(".roundStarted").show(),e.find(".futureGameCountdown").hide()})}else e.find(".noGamesSimple").toggle(!r.roundIsCurrentlyRunning),e.find(".noGamesCurrent").toggle(r.roundIsCurrentlyRunning),e.find(".roundStarted").show(),e.find(".futureGameCountdown").hide();layout.scrollableTables(e),layout.inputElements(e),layout.userMiniprofile(e),b(n)}function s(e,t,n,i,o){clearTimeout(j);var r=e-Controller.Broadcast.offsetCorrectedDateNow();if(0>=r)return n.html("0"),i.html("00"),void o();var a=Math.floor(r/1e3)%60,l=Math.floor(r/6e4)%60,c=Math.floor(r/36e5);c>0?t.html(c).add(t.next()).show():t.add(t.next()).hide(),l>0?n.html(l).add(n.next()).show():n.add(n.next()).hide(),i.html(a),j=setTimeout(function(){s(e,t,n,i,o)},1e3-Controller.Broadcast.offsetCorrectedDateNow()%1e3)}function l(e){e=e||1;var n=x.getRounds(t),i=x.getAttribute(t,"currentRound")||1,o="finished"===x.getAttribute(t,"status")||i>e,r=!["finished","cancelled"].contains(x.getAttribute(t,"status"))&&e==i,a=n[e],s=x.isKnockoutEvent(t),l={games:[],startDate:a.startDate,playzoneTournament:!!x.getAttribute(t,"c24"),totalGames:0,runningGames:0,unpredictableSchedule:x.getAttribute(t,"unpredictableSchedule"),tournamentFinished:"finished"==x.getAttribute(t,"status"),showOnlyRunningGames:B,roundIsCurrentlyRunning:r},d=Controller.Broadcast.offsetCorrectedDateNow();a.startDate>d&&(l.roundStartCountdown=a.startDate-d),l.roundStart=Helper.getFormatedLocalDateTime(a.startDate),O=x.getAllPlayersPoints(t,e-1);for(var u in a.matches){u=parseInt(u);var h=a.matches[u];for(var p in h.games){p=parseInt(p);var f=c(e,u,p,h.games[p],o);f&&(f.drawLine=s&&u>1&&1==p,l.games.push(f),l.runningGames+=f.status.finished?0:1),l.totalGames++}}return l}function c(e,n,i,o,r){if(r||!B||!o.gameStatus||"finished"!==o.gameStatus.status){var a=u(t,o.player.white),s=u(t,o.player.black),l=T.getGameUrl(t,e,n,i);return Object.extend({showIndex:!0,tournamentId:t,roundNo:e,matchNo:n,gameNo:i,embedUrl:T.isEmbedded(),player:{white:a,black:s},url:l,own:[o.player.white,o.player.black].contains(config.user().uuid),bye:o.gameStatus&&"TOURNAMENT_BYE"===o.gameStatus.endedBy},d(o))}}function d(e){var n=M&&!x.getAttribute(t,"c24");if(n)var i=Controller.Broadcast.convertEvaluationToPercent(e.engine,!0);return{showEngine:n,engine:i,status:h(e)}}function u(e,t){var n=Object.merge(x.getPlayer(e,t));return P||(n.name=T.shorterFirstName(n.name)),n.id=t,n.score=Controller.Broadcast.scoreToString(O[t]||0),n.showScore=E,n}function h(e,n){n=n||!1;var i={};if("upcoming"===e.gameStatus.status)i={upcoming:!0,reverse:n};else if("running"===e.gameStatus.status){if(x.getAttribute(t,"c24"))return i={upcoming:!0,reverse:n};var o=Controller.Broadcast.convertEvaluationToPercent(e.engine,n);i={running:!0,reverse:n,evaluation:o}}else if("finished"===e.gameStatus.status){var r=n?"black":"white",a=n?"white":"black",s=e.gameStatus.result&&e.gameStatus.result[r]||0,l=e.gameStatus.result&&e.gameStatus.result[a]||0,c={color:r,score:Controller.Broadcast.scoreToString(s),won:1===s},d={color:a,score:Controller.Broadcast.scoreToString(l),won:1===l};i={finished:!0,reverse:n,playerA:c,playerB:d}}return i}function p(){for(;R.length>0;){var e=R.pop();e.publisher.off(e.channel,e.callback)}}function f(){if(B&&"finished"===x.getAttribute(t,"status"))return B=!1,void r(A);var e=x.getRounds(t),n=0,i=e[A];for(var o in i.matches)"object"==typeof i.matches[o].games&&(n+=Object.getLength(i.matches[o].games));n!==S&&r(A)}function g(t,i){n&&A!==n?e.find(".pager").pager({update:{live:i.value}}):I=setTimeout(function(){n=A=i.value,r(A)})}function m(n,i){var o=c(i.roundId,i.matchId,i.gameId,i.full),r=e.find(".gameId"+i.gameId+".gameOfMatch"+i.matchId);if(r.length){var a=jQuery(_.render("open.game",o));r.find("td").each(function(e){jQuery(this).empty().html(jQuery(a.find("td")[e]).html())}),new View.GameTooltip(r,t),r.find("td > h6 > a").addPlayerTournamentStatistics(t)}}function v(n,i){var o=e.find(".roundNo"+i.roundId+".gameId"+i.gameId+".gameOfMatch"+i.matchId+" > .tScore");o.length&&(o.html(_.render("open.games.entry",d(i.full))),new View.GameTooltip(o.parent(),t))}function y(n,i){C();var o=e.find(".gameId"+i.gameId+".gameOfMatch"+i.matchId);if(B&&"finished"===i.value.status)return o.prev().is("tr")||k(o),void o.remove();var r=o.children(".tScore");r.html(_.render("open.games.entry",d(i.full))),new View.GameTooltip(r.parent(),t)}function w(e){p();var n=x.getRounds(t),i=n[e];clearTimeout(I),x.on("set."+t+".status set."+t+".totalNumberOfGames",f.delegate),R.push({publisher:x,channel:"set."+t+".status",callback:f.delegate}),R.push({publisher:x,channel:"set."+t+".totalNumberOfGames",callback:f.delegate}),x.on("set."+t+".currentRound",g.delegate),R.push({publisher:x,channel:"set."+t+".currentRound",callback:g.delegate});for(var o in i.matches){var r=i.matches[o];for(var a in r.games){var s="set."+t+":"+e+":"+o+":"+a,l=s+".player";x.on(l,m.delegate),R.push({publisher:x,channel:l,callback:m.delegate}),l=s+".engine",x.on(l,v.delegate),R.push({publisher:x,channel:l,callback:v.delegate}),l=s+".gameStatus",x.on(l,y.delegate),R.push({publisher:x,channel:l,callback:y.delegate})}}}function b(n){function i(t,i,r,a){var l=o[n].matches[s].games[c].gameStatus;if(!l||"TOURNAMENT_BYE"!==l.endedBy){var d=e.find(".gameContainer.gameId"+a+".gameOfMatch"+r);d.data("gamePath",{roundId:i,matchId:r,gameId:a}),d.on("click.game",function(){return T.showGame(t,n,r,a),!1})}}n=n||1;var o=x.getRounds(t),a=o[n];for(var s in a.matches){var l=a.matches[s];for(var c in l.games)i(t,n,s,c)}var d=e.find(".gameContainer");new View.GameTooltip(d,t),d.find("td > h6 > a").addPlayerTournamentStatistics(t),e.find(".runningGames input:checkbox").on("click",function(){B=jQuery(this).is(":checked"),r(A)})}function C(){var n=x.getAttribute(t,"rounds")[A],i=Object.reduce(n.matches,function(e,t){return e+Object.reduce(t.games,function(e,t){return e+(t.gameStatus&&"finished"===t.gameStatus.status?0:1)},0)},0);Number.isFinite(i)&&i>=0&&e.find(".runningGames span.counter").html(i)}function k(e){var t=e.next("tr:visible");if(t.length){var n=e.find("td"),i=t.find("td");n.each(function(e){i.eq(e).css("width",jQuery(this).css("width"))})}}var F=this;n=n||1;var x,T=new Controller.Broadcast,_=T.getTemplates();e=jQuery(e);var E,S,j,I,A=n,O={},M=window.settings.getBoolean("game-broadcast-engine"),P=e.hasClass("fullWidth"),B=!1,R=[];return 0===e.length&&errorHandler.error(new Error("container not found in OpenGames view")),Extend.Subscriber(F,{},{afterLink:function(e){x=e.publisher,E=x.showPlayerScoreHistory(t),F.isSuspended()||r(n||x.getAttribute(t,"currentRound"))}}),Extend.Suspendable(F,!0),F.onResume(function(e){e&&(M=window.settings.getBoolean("game-broadcast-engine"),r(A||x.getAttribute(t,"currentRound")))}),o.delegate=F.delegate(o),f.delegate=F.delegate(f),g.delegate=F.delegate(g),m.delegate=F.delegate(m),y.delegate=F.delegate(y),v.delegate=F.delegate(v),window.settings.on("settings.game-broadcast-engine",o.delegate),F},"undefined"==typeof View&&(View={}),View.OpenStandings=function(e,t){function n(e){return k[e]&&k[e].length||(k[e]=C.find("tr.player"+e)),k[e]}function i(e){n(e).remove(),delete k[e]}function o(e,t){if(!t.value||!t.value.live||!t.value.live.length)return m=void 0,clearTimeout(a.timer),void(a.timer=setTimeout(a));if(m&&!a.timer){var n=l(t.value.live,m);if(!n)return;s(n),m=t.value.live}else clearTimeout(a.timer),a.timer=setTimeout(a)}function r(e,i){i.diff&&!a.timer?(Object.forEach(i.diff,function(e,i){var o=n(i);if(e&&o.length){var r=$(y.render("open.standingsPlayer",u(i)));o.replaceWith(r),k[i]=r,r.find(".ofMiniProfile").addMiniprofile(),r.children(".playerStatistics").addPlayerTournamentStatistics(t)}}),h()):(clearTimeout(a.timer),a.timer=setTimeout(a))}function a(){a.timer=null;var e=f.getAttribute(t,"standings");c(d(e)),e&&e.live&&e.live.length&&(m=e.live)}function s(o){var r=f.getAttribute(t,"standings"),a=r.live.reduce(function(e,t,n){return e[t]=n,e},{});o.removed.forEach(i),o.added.forEach(function(n){var i=$(y.render("open.standingsPlayer",Object.merge(u(n),{playzoneTournament:g}))),o=a[n],r=C.find("tr.player:eq("+o+")");r.length?r.before(i):e.find(".items tbody").append(i),i.find(".ofMiniProfile").addMiniprofile(),i.children(".playerStatistics").addPlayerTournamentStatistics(t)}),(o.added||o.removed)&&p(r.live.length),o.moved.sort(function(e,t){return a[t]-a[e]}),o.moved.forEach(function(e){var t=n(e),i=a[e],o=C.find("tr.player:eq("+i+")");t.insertBefore(o),t.find(".rank:first").html(i+1)})}function l(e,t){var n=t.reduce(function(e,t,n){return e[t]=n,e},{}),i=e.reduce(function(e,t,n){return e[t]=n,e},{}),o={added:[],removed:[],moved:[]};return t.forEach(function(e){void 0===i[e]?o.removed.push(e):i[e]!==n[e]&&o.moved.push(e)}),e.forEach(function(e){void 0===n[e]&&o.added.push(e)}),o.added.length||o.removed.length||o.moved.length?o:!1}function c(n){n&&n.players.length?(e.html(y.render("open.standings"+$redesignSuffix,n)),e.find(".playerStatistics").addPlayerTournamentStatistics(t)):e.html(y.render("open.nostandings",n)),layout.scrollableTables(e),layout.userMiniprofile(e),w=e.find(".avgElo"),b=e.find(".playerCount"),
C=e.find(".tournamentTable .items"),k={},h()}function d(e){if(e&&e.live){e.live instanceof Array||"object"!=typeof e.live||(e.live=Object.values(e.live));for(var t={players:[],playzoneTournament:g},n=0;n<e.live.length;n++){var i=e.live[n],o=u(i);o&&t.players.push(o)}return t.noOfPlayers=t.players.length,t}}function u(e,n){if("unknown"!==e){var i=f.getPlayer(t,e);if(i){if(void 0===n){var o=f.getAttribute(t,"standings");n=parseInt(Object.findKey(o.live,function(t,n){return t===e}),10)}var r=f.getPlayerResults(t,e,"live");return{playzoneTournament:g,id:e,rank:n+1,score:Controller.Broadcast.scoreToString(r.p||0),games:r.games||0,name:i.name,url:i.link,country:i.country,elo:i.elo,attributes:g&&{title:i.title&&{code:i.title,name:i.titleName},moderator:1==i.moderator,fraud:1==i.fraud,cop:1==i.cop,staff:1==i.staff,premium:1==i.premium},removed:i.removed,own:e===config.user().uuid}}}}function h(){var e=f.getAttribute(t,"players");if(e){var n=Object.reduce(e,function(e,t){var n=parseInt(t.elo,10);return n&&(e.elo+=n,e.count++),e},{elo:0,count:0});n.count>0&&w.html(Math.round(n.elo/n.count))}}function p(e){b.html(e)}var f,g,m,v=this,y=new Handler.Template("broadcast").append(new Handler.Template);e=jQuery(e);var w,b,C,k={};e.length||errorHandler.error("container not found in View.OpenStandings"),Extend.Suspendable(v,!0);var F=v.delegate(function(e,t){_.add(function(){o.call(v,e,t)})}),x=v.delegate(function(e,t){_.add(function(){r.call(v,e,t)})}),T={};T["set."+t+".standings"]=F,T["set."+t+".players"]=x,T["set."+t+".currentRound"]=F,Extend.Subscriber(v,T,{afterLink:function(e){f=e.publisher,F(e,{value:e.publisher.getAttribute(t,"standings")}),g=!!f.getAttribute(t,"c24")}}),v.onResume(function(e){e&&f&&a()});var _=rateLimit.createQueue({interval:50});return v},"undefined"==typeof View&&(View={}),View.OverviewButton=function(e,t,n,i,o){function r(){s();var e=u.getAttribute(t,"c24");if(e){var n=l();n&&(a(n.roundId,n.matchId,n.gameId),c(n.roundId,n.matchId,n.gameId))}}function a(r,a,l){return r==n&&a==i&&l==o?void s():void(r&&a&&l&&e.addClass("goToMyGame").off("click.overviewbutton").on("click.overviewbutton",function(){return h.showGameWhenReady(t,r,a,l),!1}))}function s(){d(),e.removeClass("goToMyGame"),e.off("click.overviewbutton").on("click.overviewbutton",function(){return h.showOverview(jQuery(this).attr("href")),jQuery("body").removeClass("boardXL"),!1})}function l(){var e=u.getAttribute(t,"rounds");for(var r in e)for(var a in e[r].matches)for(var s in e[r].matches[a].games){var l=e[r].matches[a].games[s];if((l.player.white==config.user().uuid||l.player.black==config.user().uuid)&&"running"==l.gameStatus.status){if(r==n&&i==a&&o==s)return;return{roundId:r,matchId:a,gameId:s}}}}function c(e,n,i){d(),c.current={event:"set."+t+":"+e+":"+n+":"+i+".currentFen",handler:function(){a(e,n,i)}},u.on(c.current.event,c.current.handler)}function d(){c.current&&(u.off(c.current.event,c.current.handler),c.current=void 0)}var u=new Controller.BroadcastTournament,h=new Controller.Broadcast,e=jQuery(e);0===e.length&&errorHandler.msg("error",new Error("container not found"),!0,{container:e});return self.switchGame=function(e,a,s,l){t=e,n=a,i=s,o=l,r()},r(),self},"undefined"==typeof View&&(View={}),View.PgnDownload=function(e,t,n,i,o){function r(){s=s||new Handler.Template("broadcast"),l=l||new Controller.BroadcastTournament;var r=config.level().isPremium,a=l.getAttribute(t,"pgnDownload");if(a){var c=Date.parse(a.freeUntil);c&&c>Date.now()&&(r=!0)}e.html(s.render("game.pgnDownload",{tournamentId:t,roundId:n,matchId:i,gameId:o,isPremium:r,showMatch:l.hasMatches(t)}));var d=e.find("a");d.on("click",function(){return r?(Handler.tracking("pgn","broadcast"),!0):(Handler.tracking("pgn","broadcastConversion"),Dialog.conversionGoPremium("pgnDownload"),!1)})}var a=this;e=jQuery(e),e.length||errorHandler.error(new Error("container not found in View.PgnDownload")),Extend.Suspendable(a,!0),a.onResume(r);var s,l,c=a.delegate(r);return a.changeGame=function(e,r,a,s){t=e,n=r,i=a,o=s,c()},e.data("view",a),a},"undefined"==typeof View&&(View={}),View.RoundNavigation=function(e,t,n,i,o){function r(){var o=e.find("a.previous"),r=e.find("a.next"),l=g.getAttribute(t,"rounds"),c=m.getCurrentGamePath(),d=l[c.round].matches[c.match].games[c.game]&&l[c.round].matches[c.match].games[c.game].player;if(d){e.find(".dropdownFilterTitle").html(v.render("navigation.current"+$embedCCTSuffix,{active:e.find(".dropdownFilter").hasClass("active"),current:{white:g.getPlayer(t,d.white),black:g.getPlayer(t,d.black)}})).on("click",function(){f.removeClass("new")});var u=a(c);o.off("click"),u.previous?o.removeClass("disabled").attr("href",m.getGameUrl(t,c.round,u.previous.matchId,u.previous.gameId)).on("click",function(){return m.showGame(t,c.round,u.previous.matchId,u.previous.gameId),n=c.round,i=u.previous.matchId,s(),!1}):o.addClass("disabled").removeAttr("href"),r.off("click"),u.next?r.removeClass("disabled").attr("href",m.getGameUrl(t,c.round,u.next.matchId,u.next.gameId)).on("click",function(){return m.showGame(t,c.round,u.next.matchId,u.next.gameId),n=c.round,i=u.next.matchId,s(),!1}):r.addClass("disabled").removeAttr("href")}}function a(e){var o=g.getAttribute(t,"rounds"),r=Object.keys(o[e.round].matches),a=r.shift(),s=r.pop(),l=parseInt(e.match,10),c=Object.keys(o[n].matches[i].games),d=c.shift(),u=c.pop();if(parseInt(e.game,10)>d)var h={matchId:e.match,gameId:e.game-1};else if(parseInt(e.match,10)>a){var p=Object.keys(o[e.round].matches[l-1].games).pop();h={matchId:e.match-1,gameId:p}}else h=void 0;if(e.game<u)var f={matchId:e.match,gameId:parseInt(e.game,10)+1};else if(e.match<s){var m=Object.keys(o[e.round].matches[l+1].games).shift();f={matchId:parseInt(e.match,10)+1,gameId:m}}else f=void 0;return{previous:h,next:f}}function s(i){u=g.getAllPlayersPoints(t,n-1),y=l(),y.active=i,e.find(".dropdownFilterTitle").html(v.render("navigation.current"+$embedCCTSuffix,y)),e.find(".prevGame").html(v.render("navigation.prev"+$embedCCTSuffix,y)),e.find(".nextGame").html(v.render("navigation.next"+$embedCCTSuffix,y)),f=e.find(".dropdownFilterNotification"),f.html(v.render("navigation.notification",y)),p=f.find("span");var o=e.find(".gameContainer");new View.GameTooltip(o,t),o.find("td h6").addPlayerTournamentStatistics(t),r()}function l(){var e=g.getAttribute(t,"rounds"),i=g.getAttribute(t,"players"),o=m.getCurrentGamePath(),r=e[o.round]&&e[o.round].matches[o.match]&&e[o.round].matches[o.match].games[o.game],s=a(o),l={tournamentIdPrevious:t,roundNoPrevious:n,matchNoPrevious:s.previous?s.previous.matchId:void 0,gameNoPrevious:s.previous?s.previous.gameId:void 0,tournamentIdNext:t,roundNoNext:n,matchNoNext:s.next?s.next.matchId:void 0,gameNoNext:s.next?s.next.gameId:void 0,embedUrl:m.isEmbedded()};return r&&r.player&&(l.current={white:i[r.player.white],black:i[r.player.black]}),l}function c(){var e=g.getAttribute(t,"currentRound"),n=p.data("template");p.attr("data-tooltip",Handler.Template.renderString(n,{round:e})),f.addClass("new")}function d(){g.on("set."+t+".players",h.delegate(function(t,n){Object.some(n.diff,function(e){return!e||Object.getLength(e)>2||!e.results})&&s(e.find(".dropdownFilter").hasClass("active"))})),g.on("set."+t+".currentRound",h.delegate(function(e,t){c()}))}var u,h=this;e=jQuery(e),e.length||errorHandler.error("container not found for View.RoundNavigation"),t&&n||errorHandler.error("missing information about match to be displayed in View.RoundNavigation");var p,f,g=new Controller.BroadcastTournament,m=new Controller.Broadcast,v=m.getTemplates(),y={};e.html(v.render("navigation.main"+$suffix));var w,b=e.find(".gamesList");return w=g.isTeamEvent(t)?new View.TeamRoundRobin(b,t,n):new View.OpenGames(b,t,n,!1).link(g),Extend.Suspendable(h),h.onSuspend(function(){w.suspend()}),h.onResume(function(t){t&&s(t),e.find(".dropdownFilter").hasClass("active")&&w.resume(t)}),e.find(".dropdownFilter").on("chess24:hide",function(){$redesign&&e.parents(".colorHeader.colorWatch").css("z-index",""),w.suspend()}),e.find(".dropdownFilter").on("chess24:show",function(){$redesign&&e.parents(".colorHeader.colorWatch").css("z-index","23"),w.resume()}),h.setCurrentGame=function(e,a,l,c,d){return d||i!=l||o!=c||t!=e||n!=a?d||t!=e||n!=a?(t=e,n=parseInt(a,10),i=parseInt(l,10),o=parseInt(c,10),s(),h):(i=parseInt(l,10),o=parseInt(c,10),r(),jQuery(document).trigger("click"),h):h},d(),s(),h},"undefined"==typeof View&&(View={}),View.StandingsBetting=function(e,t){function n(){var n=g.getAttribute(t,"betting");if(n.standings){var i=n.standings&&n.standings.description;"object"==typeof i&&(i=i[config.language()]||i[Object.keys(i)[0]]),e.html(m.render("betting.standings",{description:i,tournamentFinished:b})),v=e.find(".bet"),jQuery.getJSON("/api/web/broadcastAPI/getStandingsBet",{id:t}).done(function(e){var n=e.data&&e.data.bet,i=n&&n.standings||g.getAttribute(t,"standings").live,o=n&&n.roundId||g.getAttribute(t,"currentRound"),a=n&&n.date||!1;r(i,o,a)}),b&&a(0)}}function i(){var e,t=dummy;v.find(".standings li").draggable({helper:"clone",addClasses:!1,zIndex:100,axis:"y",start:function(t,n){e=jQuery(this),n.helper.css("width",e.width()),e.addClass("currently-dragged")},stop:function(n,i){i.helper.remove(),e.removeClass("currently-dragged"),t=dummy,c()},drag:function(){t()}}).droppable({over:function(n,i){var o=jQuery(this),r=i.helper;t=function(){var t=o.position(),n=r.position();t.top>n.top?e.insertBefore(o):e.insertAfter(o)}}})}function o(){v.find("a.clear").on("click",function(){u()}),v.find("a.reset").on("click",function(){var e=g.getAttribute(t,"standings").live;d(e)}),v.find(".date").showAge()}function r(e,n,a){r.lastCall=arguments;var s=g.getAttribute(t,"betting"),c=!s.standings.closed&&(!s.standings.closeAt||s.standings.closeAt>Controller.Broadcast.offsetCorrectedDateNow());c&&s.standings.closeAt&&(clearTimeout(r.closeTimeout),r.closeTimeout=setTimeout(function(){l()},Math.max(0,s.standings.closeAt-Controller.Broadcast.offsetCorrectedDateNow())));var d=g.getAttribute(t,"players"),u=g.getAttribute(t,"standings").live,h=0,p=!1,f=e.map(function(e,t){var n=Object.merge(d[e],{index:t+1,id:e});return b&&(p?(n.betResult="wrong",u[t]!=e&&(n.correctName=d[u[t]].name)):u[t]==e?(n.betResult="correct",h++):(p=!0,n.betResult="wrong",n.correctName=d[u[t]].name)),n});v.empty().append(m.render("betting.standingsBet",{players:f,roundId:n,date:a,open:c,openUntil:s.standings.closeAt,correctBets:h,amountOfPlayers:u.length,tournamentFinished:b})),c&&i(),o()}function a(e,n){jQuery.getJSON("/api/web/broadcastAPI/getBettingLeaderboard",{id:t,page:e,highlight:!!n}).done(function(t){var n=t.data&&t.data.bet;e=t.data&&t.data.bet.page,s(n,e)})}function s(t,n){s.lastCall=arguments;var i=t.players,o=t.pages,r=e.find(".bettingLeaderboard .leaderboardList"),l=m.render("betting.list",{list:i});r.removeClass("loading").html(l),jQuery(document).trigger("newhtml");var c=jQuery(".bettingLeaderboard  .cPagination");o>0&&(n>0?(c.find(".goFirst").removeClass("inactive").find("a").off("click").on("click",function(){a(0)}),c.find(".goPrev").removeClass("inactive").find("a").off("click").on("click",function(){a(n-1)})):c.find(".goFirst, .goPrev").addClass("inactive").find("a").off("click"),o-1>n?(c.find(".goLast").removeClass("inactive").find("a").off("click").on("click",function(){a(o-1)}),c.find(".goNext").removeClass("inactive").find("a").off("click").on("click",function(){a(n+1)})):c.find(".goLast, .goNext").addClass("inactive").find("a").off("click"),e.find(".cBtn").removeClass("cBtnInactive").off("click").on("click",function(){a(0,!0)}))}function l(){r.lastCall&&r.apply(null,r.lastCall),s.lastCall&&s.apply(null,s.lastCall)}function c(){var e=v.find(".standings li").map(function(){return jQuery(this).data("id")}).toArray();d(e)}function d(e){e.compare(y)||(h(),y=e,jQuery.post("/api/web/broadcastAPI/setStandingsBet",{csrf:config.csrf(),id:t,standings:JSON.stringify(e)}).done(function(){var n=g.getAttribute(t,"currentRound"),i=Controller.Broadcast.offsetCorrectedDateNow();p(),r(e,n,i)}))}function u(){h(),y=void 0,jQuery.post("/api/web/broadcastAPI/clearStandingsBet",{csrf:config.csrf(),id:t}).done(function(){var e=g.getAttribute(t,"standings").live,n=g.getAttribute(t,"currentRound");p(),r(e,n,!1)})}function h(){v.find("ul").addClass("disabled"),v.find("li").draggable("disable")}function p(){v.find("ul").removeClass("disabled"),v.find("li").draggable("enable")}var f=this,g=new Controller.BroadcastTournament,m=new Handler.Template("broadcast");e=jQuery(e);var v,y;0===e.length&&errorHandler.error(new Error("container not found"),{container:e}),g.on("set."+t+".betting",l);var w=g.getAttribute(t,"status"),b="finished"===w;return Extend.Suspendable(f,!0),f.onResume(function(e){e&&n()}),f},"undefined"==typeof View&&(View={}),View.StandingsTable=function(e,t,n){function i(){"teamRoundRobin"===s.getAttribute(t,"eventType")?o():r(),a()}function o(){var i=s.getAttribute(t,"rounds"),o=s.getAttribute(t,"teams"),r=s.getAttribute(t,"standings").live||[],a=s.getAttribute(t,"currentRound"),l=s.getAttribute(t,"gamesPerMatch")/2,c=s.getAttribute(t,"manualTeamStandings");c&&(c.live&&(r=c.live),c.pointsNeededToBeConsideredAsPlayed&&(l=c.pointsNeededToBeConsideredAsPlayed));var u=r.reduce(function(e,t,n){return e[t]=parseInt(n,10),e},{}),h=r.map(function(){return r.map(function(){return{played:!1,bp:0}})}),p=r.map(function(){return 0});Object.forEach(i,function(e,t){e.unrated||n&&t>n||Object.forEach(e.matches,function(e,n){var i=e.teams[1],r=e.teams[2],a=u[i],s=u[r],d=o[i].results.rounds[t],f=o[i].results.rounds[t-1];c&&c[i]&&c[i].rounds&&(c[i].rounds[t]&&(d=c[i].rounds[t]),c[i].rounds[t-1]&&(f=c[i].rounds[t-1]));var g=o[r].results.rounds[t],m=o[r].results.rounds[t-1];if(c&&c[r]&&c[r].rounds&&(c[r].rounds[t]&&(g=c[r].rounds[t]),c[r].rounds[t-1]&&(m=c[r].rounds[t-1])),void 0!==a&&void 0!==s&&d&&g){var v=d.bp,y=t>1?f.bp:0,w=g.bp,b=t>1?m.bp:0,C=v-y,k=w-b;if(v||w){var F=C>=l||k>=l;h[a][s].played=F,h[a][s].opponent=o[r],h[a][s].bp=(h[a][s].bp||0)+C,h[a][s].game={roundId:t,matchId:n,gameId:1},h[s][a].played=F,h[s][a].opponent=o[i],h[s][a].bp=(h[s][a].bp||0)+k,h[s][a].game={roundId:t,matchId:n,gameId:1},F&&(p[a]++,p[s]++)}}})});var f=h.map(function(e,t){var n=o[r[t]],i=e.map(function(e,n){var i=o[r[n]];return t===n?{self:!0}:{played:e.played,opponent:i,bp:Controller.Broadcast.scoreToString(e.bp),game:e.game}}),s=n.results&&n.results.rounds&&n.results.rounds[a]||{mp:0,bp:0};if(c&&c[r[t]]&&c[r[t]].rounds)if(c[r[t]].rounds[a])s=c[r[t]].rounds[a];else{var l=c[r[t]].rounds,d=1;try{for(var u in l)d=d<parseInt(u)?parseInt(u):d;c[r[t]].rounds[d]&&(s=c[r[t]].rounds[d])}catch(h){errorHandler.warning("Error getting last round from manual standing ",{rounds:l})}}return{i:t+1,team:n,matches:i,results:{bp:Controller.Broadcast.scoreToString(s.bp),mp:Controller.Broadcast.scoreToString(s.mp),games:p[t]}}});e.html(d.render("standings.teams",{results:f,reduced:f.length>View.StandingsTable.MAX_TEAMS}))}function r(){var i=s.getAttribute(t,"rounds"),o=s.getAttribute(t,"players"),r=s.getAttribute(t,"standings").live||{},a=s.getAttribute(t,"currentRound");o=Object.map(o,function(e,t){return Object.merge({id:t},e)});var l=r.reduce(function(e,t,n){return e[t]=parseInt(n,10),e},{}),c=r.map(function(){return r.map(function(){return{games:[]}})}),h=r.map(function(){return 0}),p=!1;Object.forEach(i,function(e,t){e.unrated||n&&t>n||Object.forEach(e.matches,function(e,n){Object.forEach(e.games,function(e,i){var r=l[e.player.white],a=l[e.player.black];if(void 0!==r&&void 0!==a){var s=e.gameStatus&&"finished"===e.gameStatus.status,d=e.gameStatus&&"running"===e.gameStatus.status;if(s||d){if(p=p||!!c[r][a].games.length||!!c[r][a].games.length,s){var u=o[e.player.white].results.rounds[t].p,f=t>1?o[e.player.white].results.rounds[t-1].p:0,g=o[e.player.black].results.rounds[t].p,m=t>1?o[e.player.black].results.rounds[t-1].p:0,v=u-f,y=g-m,w={p:Controller.Broadcast.scoreToString(v),played:!0},b={p:Controller.Broadcast.scoreToString(y),played:!0};h[r]++,h[a]++}else w={reverse:!1,evaluation:Controller.Broadcast.convertEvaluationToPercent(e.engine,!0)},b={reverse:!0,evaluation:Controller.Broadcast.convertEvaluationToPercent(e.engine,!1)};w.game=b.game={roundId:t,matchId:n,gameId:i},w.played=b.played=s,w.running=b.running=!s,c[r][a].games.push(w),c[a][r].games.push(b)}}})})});var f=c.map(function(e,t){var i=o[r[t]],s=e.map(function(e,n){return t===n?{self:!0}:e}),l=i.results&&i.results.rounds&&i.results.rounds[n||a]||{games:0,p:0};return{i:t+1,player:i,matches:s,results:{games:h[t],p:Controller.Broadcast.scoreToString(l.p)}}});e.html(d.render("standings.players",{results:f,tournamentId:t,reduced:u,doubleRoundRobin:p}))}function a(){e.find(".gameLink").off("click").on("click",function(){var e=jQuery(this);return l=l||new Controller.Broadcast,l.showGame(t,e.data("round"),e.data("match"),e.data("game")),!1});var n=e.find(".running .evalIndicator").each(function(){var e=jQuery(this),n=e.data("round"),i=e.data("match"),o=e.data("game"),r=new View.EvalIndicator(e,void 0,"horizontal");s.on("set."+t+":"+n+":"+i+":"+o+".engine",function(e,t){t.value&&r.setValue(t.value)}),e.data("gamePath",{roundId:n,matchId:i,gameId:o})});new View.GameTooltip(n,t),e.find("span.player").addPlayerTournamentStatistics(t)}var s,l,c=this,d=new Handler.Template("broadcast");e=jQuery(e),e.length||errorHandler.error(new Error("container not found in View.StandingsTable"));var u=!!e.data("reduced");Extend.Suspendable(c,!0);var h=c.delegate(i),p={};return p["set."+t+".standings set."+t+".teams set."+t+".players"]=h,Extend.Subscriber(c,p,{afterLink:function(e){s=e.publisher,h()}}),c.onResume(function(e){e&&s&&h()}),c},View.StandingsTable.MAX_PLAYERS=20,View.StandingsTable.MAX_TEAMS=20,"undefined"==typeof View&&(View={}),View.TeamRoundRobin=function(e,t,n){function i(e,t){M=!!t.value,r()}function o(e){S=S||new Controller.Broadcast,j=j||new Controller.BroadcastTournament,E=j.showPlayerScoreHistory(t);var n=p(e);r(),m(n)}function r(){var t=p(A);t.navigationVisible=P,t.compactView=B,e.html(R.render("teamRoundRobin.main",t)),layout.scrollableTables(e),g()}function a(n,i){if(i.diff){var o=n.publisher.getAttribute(t,"teams");for(var a in i.diff){var s=i.diff[a];if(s.results){var l=s.results.rounds&&s.results.rounds[A]&&s.results.rounds[A].bp||void 0;if(void 0!==l){var c=o[a].results&&(o[a].results.rounds&&o[a].results.rounds[A-1]&&o[a].results.rounds[A-1].bp||0);if(void 0!==c){l-=c;var d=e.find(".teamScore"+a).html(Controller.Broadcast.scoreToString(l)),u=d.prev(".tScore");if(u.length)var h=u.prev(),p=d.next();else u=d.next(".tScore"),h=u.next(),p=d.prev();var f=u.text();f=parseInt(f,10)+(f.match(/(frac12|½)/)?.5:0),d.add(p).toggleClass("winner",l>f),u.add(h).toggleClass("winner",f>l)}}}s.name&&e.find(".teamId"+a).html(s.name)}}else r()}function s(n,i){if(i.diff){x=j.getAttribute(t,"players");for(var o in i.diff){var a=e.find(".playerId"+o),s=a.closest(".gameContainer").data("gamePath");if(s){var l=Object.merge(x[o]);l.name=S.shorterFirstName(l.name),l.id=o,l.country=l.country||"",l.showScore=E,l.historyScore=l.results&&l.results.round&&l.results.round.p||l.results&&l.results.rounds&&l.results.rounds[s.roundId-1]&&l.results.rounds[s.roundId-1].p||void 0,l.url=S.getGameUrl(t,s.roundId,s.matchId,s.gameId),a.html(R.render("teamRoundRobin.player",Object.merge(l,s,{tournamentId:t})))}}}else r()}function l(e,t){n&&n!==A||t.value!=A&&(n=A=t.value,o(A))}function c(n,i){return function(o){var r=p(n,i),a=Object.merge(r.matches[0],{tournamentId:r.tournamentId,roundId:r.roundId}),s=R.render("teamRoundRobin.match",a);e.find(".matchId"+i).replaceWith(jQuery(s).find(".matchId"+i)),g(i),w("set."+t+":"+n+":"+i+".teams")}}function d(t,n,i){if(i&&M){var o=e.find(".matchId"+t+" .gameId"+n).data("evalIndicator");o&&o.setValue(i)}}function u(n,i,o,r){var a=j.getAttribute(t,"rounds")[n].matches[i];if(a){var s=v(a.games[1].player.white),l=s!==a.teams[1],c=e.find(".matchContainer.matchId"+i+" .gameContainer.gameId"+o);l&&o++;var d=o%2?r.white:r.black,u=o%2?r.black:r.white,h=Object.extend({id:d},j.getPlayer(t,d)),p=Object.extend({id:u},j.getPlayer(t,u));h.name=S.shorterFirstName(h.name),p.name=S.shorterFirstName(p.name),jQuery("td.playerA > h6",c).replaceWith(R.render("teamRoundRobin.player",h)),jQuery("td.playerB > h6",c).replaceWith(R.render("teamRoundRobin.player",p)),c.find("td.playerA > h6 > a, td.playerB > h6 > a").addPlayerTournamentStatistics(t)}}function h(n,i,o,r){var a=e.find(".matchContainer.matchId"+i+" .gameContainer.gameId"+o),s=k[n].matches[i];if(s){var l=r.gameStatus,c=v(r.player.white),d=c===s.teams[2],u={reverse:d,tournamentId:t,roundId:n,matchId:i,gameId:o};if("upcoming"!==l.status&&M){if("running"===l.status){if(void 0!==r.engine)var h=Controller.Broadcast.convertEvaluationToPercent(r.engine,!d);else h=50;u.evaluation=h,y="teamRoundRobin.games.running"}else if("finished"===l.status){var p=d?"black":"white",f=d?"white":"black",g={color:p,score:Controller.Broadcast.scoreToString(l.result[p]),won:1===l.result[p]},m={color:f,score:Controller.Broadcast.scoreToString(l.result[f]),won:1===l.result[f]};u.playerA=g,u.playerB=m,y="teamRoundRobin.games.finished"}}else var y="teamRoundRobin.games.upcoming";if(a.find(".tScore").html(R.render(y,u)),new View.GameTooltip(a,t),"running"===l.status){var w=new View.EvalIndicator(a.find(".evalIndicator"),void 0,"horizontal",_);a.data("evalIndicator",w)}}}function p(e,n){var i={};k=j.getAttribute(t,"rounds"),F=j.getAttribute(t,"teams"),x=j.getAttribute(t,"players");var o=j.getAttribute(t,"gamesPerMatch");i.tournamentId=t,i.roundId=e||j.getAttribute(t,"currentRound"),T=j.getAllPlayersPoints(t,i.roundId-1);var r=k[i.roundId];if(A=i.roundId,r){i.matches=[];var a=0;if(n){var s={};s[n]=""}else s=r.matches;for(var l in s){for(var c=r.matches[l],d={matchId:l,teamIdA:c.teams[1],teamIdB:c.teams[2],teamA:F[c.teams[1]]&&F[c.teams[1]].name||"",teamB:F[c.teams[2]]&&F[c.teams[2]].name||"",scoreA:0,scoreB:0,games:[],compactView:B},u=0;o>u;u++){var h=c.games[u+1];if(h&&h.player){var p={white:v(h.player.white),black:v(h.player.black)},g=p.white===c.teams[2];if(void 0!==h.engine)var m=Controller.Broadcast.convertEvaluationToPercent(h.engine,!g);else m=50;var y=f(p.white===c.teams[1]?"white":"black",h,e,l,u+1),w=f(p.white===c.teams[1]?"black":"white",h,e,l,u+1);h.gameStatus.result&&(h.gameStatus.result[y.color]&&(d.scoreA+=h.gameStatus.result[y.color]),h.gameStatus.result[w.color]&&(d.scoreB+=h.gameStatus.result[w.color])),d.games.push({gameId:u+1,playerA:y,playerB:w,finished:"finished"===h.gameStatus.status,running:"running"===h.gameStatus.status,upcoming:"upcoming"===h.gameStatus.status,evaluation:m,fen:h.currentFen,reverse:g})}else d.games.push({gameId:u+1,empty:!0,embedded:S.isEmbedded(),playerA:{name:"&mdash;"},playerB:{name:"&mdash;"},finished:!1,running:!1,upcoming:!0,evaluation:0,fen:""})}d.winnerA=d.scoreA>d.scoreB&&d.scoreA>o/2,d.winnerB=d.scoreB>d.scoreA&&d.scoreB>o/2,d.scoreA=Controller.Broadcast.scoreToString(d.scoreA),d.scoreB=Controller.Broadcast.scoreToString(d.scoreB),d.odd=a,i.matches.push(d),a=1-a}return 1==i.matches.length&&(B=!0),i.showEngine=M,i}}function f(e,n,i,o,r){var a=Object.merge(x[n.player[e]]),s=n.gameStatus.result&&n.gameStatus.result[e];return a.name=S.shorterFirstName(a.name),a.color=e,a.score=Controller.Broadcast.scoreToString(s),a.historyScore=Controller.Broadcast.scoreToString(T[n.player[e]]),a.url=S.getGameUrl(t,i,o,r),a.id=n.player[e],a}function g(n){var i=void 0===n?e.find(".matchContainer"):e.find(".matchId"+n);if(i.find(".teamHeader .tScore").on("click",function(){var e=jQuery(this).closest(".matchContainer").find(".gameContainer:first"),n=e.data("gamePath");S.showGame(t,A,n.matchId,n.gameId,"tabMultiboard")}),i.find(".gameContainer").on("click",function(){var e=jQuery(this),n=e.data("gamePath");return S.showGame(t,A,n.matchId,n.gameId),!1}).each(function(){var e=jQuery(this),t=e.attr("class").match(/gameId(\w+)/)[1],n=e.closest(".matchContainer").attr("class").match(/matchId(\w+)/)[1];e.data("gamePath",{roundId:A,matchId:n,gameId:t});var i=e.find(".evalIndicator");if(i.length){var o=new View.EvalIndicator(i,void 0,"horizontal",_);e.data("evalIndicator",o)}}),void 0===n){var r=Object.keys(k);e.find(".pager").pager({live:j.getAttribute(t,"currentRound"),current:A,margin:3,values:r,labels:r},o)}var a=i.find(".gameContainer");new View.GameTooltip(a,t),a.find(".playerA h6 a, .playerB h6 a").addPlayerTournamentStatistics(t)}function m(e){b();var n=e.roundId,i=j.getAttribute(t,"rounds")[n]||{};y("set."+t+".teams",C.delegate(a)),y("set."+t+".players",C.delegate(s)),y("set."+t+".currentRound",C.delegate(l));for(var o=0;o<e.matches.length;o++){var r=e.matches[o].matchId;i.matches[r]&&i.matches[r].teams&&i.matches[r].teams[1]&&i.matches[r].teams[2]||y("set."+t+":"+n+":"+r+".teams",C.delegate(c(n,r)));for(var p=0,f=j.getAttribute(t,"gamesPerMatch");f>p;p++){var g=e.matches[o].games[p].gameId;y("set."+t+":"+n+":"+r+":"+g+".gameStatus",function(e,t){return C.delegate(function(i,o){h(n,e,t,o.full)})}(r,g)),y("set."+t+":"+n+":"+r+":"+g+".player",function(e,t){return C.delegate(function(i,o){u(n,e,t,o.value)})}(r,g)),y("set."+t+":"+n+":"+r+":"+g+".engine",function(e,t){return C.delegate(function(n,i){d(e,t,i.value)})}(r,g))}}}function v(e){if(I[e])return I[e];for(var t in F)for(var n in F[t].rooster)if(F[t].rooster[n]==e)return I[e]=t}function y(e,t){j.on(e,t),O[e]=t}function w(e){O[e]&&(j.off(e,O[e]),delete O[e])}function b(e){for(var e in O)j.off(e,O[e]);O={}}var C=this;e=jQuery(e),e.length||errorHandler.error(new Error("container not found"),{container:e});var k,F,x,T,_,E,S,j,I={},A=n,O={},M=window.settings.getBoolean("game-broadcast-engine"),P=!0,B=e.width()<900,R=new Handler.Template("broadcast");return Extend.Suspendable(C,!0),C.onResume(function(e){(e||M!==window.settings.getBoolean("game-broadcast-engine"))&&(M=window.settings.getBoolean("game-broadcast-engine"),o(A))}),window.settings.on("settings.game-broadcast-engine",C.delegate(i)),C.setCurrentRound=function(e){return o(e),C},C.switchNavigation=function(e){return P=!!e,C},C},"undefined"==typeof View&&(View={}),View.TournamentAttribute=function(e,t,n){function i(){if(n.predicate)var i=n.predicate();else{if(!n.attribute)return;i=a.getAttribute(t,n.attribute);var o="object"==typeof i&&config.language()in i;i=o?i[config.language()]:i}switch(n.action){case"toggleClass":e.toggleClass(n.classname,!!i);break;case"classname":i?(e.addClass(i),r=i):r&&(e.removeClass(r),r=void 0);break;case"content":e.html(i),n.hideOnEmpty&&(n.hideOnEmpty instanceof jQuery?n.hideOnEmpty.toggle(!!i):e.toggle(!!i))}}var o=this;e=jQuery(e),e.length||errorHandler.error(new Error("container not found"),{container:e});var r,a=new Controller.BroadcastTournament;return Extend.Suspendable(o),o.onResume(function(e){e&&i()}),n.attribute&&a.on("set."+t+"."+n.attribute,o.delegate(i)),i(),o},"undefined"==typeof View&&(View={}),View.TournamentInformation=function(e,t){function n(){var n=a.getAttribute(t,"tieRules");e.html(r.render("tabInformation",{c24:a.getAttribute(t,"c24"),description:a.getDescription(t),title:a.getTitle(t),tieRules:n&&n.map(window.t),showTieRules:n&&n.length,tournamentId:t,rounds:i(),isKnockout:"knockout"===a.getAttribute(t,"eventType"),unpredictableSchedule:a.getAttribute(t,"unpredictableSchedule")}));var o=e.find("td.pgn a");config.level().isPremium||o.removeAttr("href"),o.on("click",function(e){return config.level().isPremium?(Handler.tracking("pgn","broadcast"),!0):(Handler.tracking("pgn","broadcastConversion"),Dialog.conversionGoPremium("pgnDownload"),!1)});var l=e.find("td.showGame a");l.on("click",function(){return s.showGame(t,jQuery(this).data("round")),!1})}function i(){var e=[],n=a.getAttribute(t,"rounds");return Object.forEach(n,function(t,n){var i=t.label&&t.label[config.language()]||t.label||n;return"object"==typeof t.startDate?void Object.forEach(t.startDate,function(o,r){e.push({roundLabel:i,roundId:n,gameNo:r,startDate:Helper.getFormatedLocalDateTimeSeperated(o),hasGames:t.matches&&t.matches[1]&&t.matches[1].games&&t.matches[1].games[1]})}):void e.push({roundLabel:i,roundId:n,startDate:Helper.getFormatedLocalDateTimeSeperated(t.startDate),hasGames:t.matches&&t.matches[1]&&t.matches[1].games&&t.matches[1].games[1]})}),e}var o=this;e=jQuery(e),e.length||errorHandler.error(new Error("container not found"),{container:e});var r=new Handler.Template("broadcast"),a=new Controller.BroadcastTournament,s=new Controller.Broadcast;Extend.Suspendable(o,!0);var l=o.delegate(n);o.onResume(function(e){e&&n()});var c=["set."+t+".descriptions","set."+t+".titles","set."+t+".tieRules","set."+t+".unpredictableSchedule"];return a.on(c.join(" "),l),o.outdate(),o},"undefined"==typeof View&&(View={}),View.TournamentTime=function(e,t){function n(e){var n,i,o=e.publisher.getRounds(t),r=e.publisher.getAttribute(t,"pairingSystem");for(var c in o){n=o[c].timeControl.base,i=o[c].timeControl.incrementPerMove;break}var d=e.publisher.getAttribute(t,"clockWhite"),u=e.publisher.getAttribute(t,"clockBlack");if(d&&u)var h=Math.max(d,u)+40*i,p=Math.floor(d/6e4),f=Math.floor(d%6e4/1e3),g=Math.floor(u/6e4),m=Math.floor(u%6e4/1e3),v=window.t("{minwhite}m "+(f?"{secwhite}s ":"")+" vs. {minblack}m "+(m?"{secblack}s ":"")+(i?" + {increment}s":""),{"{minwhite}":p,"{secwhite}":f,"{minblack}":g,"{secblack}":m,"{increment}":i/1e3});else{h=n+40*i;var y=Math.floor(n/6e4),w=Math.floor(n%6e4/1e3);v=w?window.t("{min}m {sec}s"+(i?" + {increment}s":""),{"{min}":y,"{sec}":w,"{increment}":i/1e3}):window.t(i?"{min} min + {sec} sec":"{min} min",{"{min}":n/1e3/60,"{sec}":i/1e3})}var b="Classic";if(0===h)var b="Classic";else 18e4>h?b="Bullet":9e5>h&&(b="Blitz");l.addClass("cIcon cIcon"+b+"GameActive").html(v);var C=e.publisher.getAttribute(t,"players"),k=C&&Object.getLength(Object.without(C,["unknown"]))||0;if(2>k)F=0;else if("swiss"==r)var F=Math.round((Math.log(k)+Math.log(2))/Math.log(2));else F=Math.max(2*Math.ceil(k/2)-1,1);var x=2*h*F/1e3;if(x){var T=Math.floor(x/3600),_=Math.floor(x%3600/60);s.html(window.t("{hours} h : {minutes} min",{"{hours}":(""+T).lpad("0",2),"{minutes}":(""+_).lpad("0",2)})),a.show()}else a.hide()}var i=this;e=jQuery(e),0===e.length&&errorHandler.msg("error",new Error("container not found"),!0,{container:e});var o=e.find("#gameTimeContainer"),r=e.find(".gameTime"),a=e.find(".tournamentTime"),s=a.find("> span").first(),l=r.find("> span").first();return s.length||(s=a),l||(l=r),Extend.Subscriber(i,{},{afterLink:function(e){n(e);var i=e.publisher.getRounds(t);for(var r in i)e.publisher.on("set."+t+":"+r+".timeControl",n);o.length>0&&e.publisher.on("set."+t+".players",n)}}),i},"undefined"==typeof View&&(View={}),View.VideoSimple=function(e,t,n){function i(e,t){h=t.value,v.updateView()}function o(e,t){function n(e){return t?(e.title?e.title+" ":"")+e.name:$redesign?e.link?'<a href="'+e.link+'">'+(e.title?' <span class="commentatorTitle">'+e.title+" </span>":"")+e.name+"</a>":"<span>"+(e.title?' <span class="commentatorTitle">'+e.title+" </span>":"")+e.name+"</span>":e.link?"<a "+(e.title?'data-fide-title-before="'+e.title+'" ':"")+'href="'+e.link+'">'+e.name+"</a>":"<span"+(e.title?' data-fide-title-before="'+e.title+'" ':"")+">"+e.name+"</span>"}for(var i="",o=0;o<e.length;o++){var r=n(e[o]);i+=0===o?r:o+1===e.length?" & "+r:", "+r}return i}function r(t){var n=e.find(".videoContainer"),i=t.html,o=t.premiumRestriction;if(f!==i)if(f=i,!config.level().isPremium&&o){var r=o.freeTimeAfterRoundStart,s=o.freePlayTime,c=l(u),d=60*s-c;_+60*r*1e3<(new Date).getTime()||0>=d?n.html(y.render("game.premiumShow",{minutes:r||s})):a(i,s,d,t.autoPlay)}else n.html(i);return v}function a(t,n,i,o){var r=e.find(".videoContainer"),a='<div class="playButton">&#9658;</div>';r.html(a),r.on("click",function(){g=Date.now()/1e3,r.html(t),setTimeout(function(){r.html(y.render("game.premiumShow",{minutes:n})),r.off("click"),s(u,60*n)},1e3*i)}),o&&r.trigger("click")}function s(e,n){for(var i=c(),o=!1,r=0;r<i.length;r++)if(i[r].videoId==e){i[r].seconds=n,o=!0;break}return o||i.push({videoId:e,
seconds:n}),$.cookie(t,JSON.stringify(i),{expires:30,path:"/"})}function l(e){for(var t=c(),n=0;n<t.length;n++)if(t[n].videoId==e)return t[n].seconds;return 0}function c(){var e=$.cookie(t);return e=e?JSON.parse(e):[]}function d(){jQuery.getJSON("/api/web/advertisementAPI/getVideo",{language:config.language(),id:t,level:config.level().toString()}).done(function(e){e.data&&e.data.video?v.setPromoVideo(e.data):v.resumeToVideo()}).fail(v.resumeToVideo)}var u,h,p,f,g,m,v=this,y=new Handler.Template("broadcast"),w=!!n,b=438,C=252,k=16/9;e=jQuery(e),0===e.length&&errorHandler.error(new Error("container not found in View.VideoSimple "));var F=new Controller.BroadcastTournament,x=F.getAttribute(t,"rounds"),T=F.getAttribute(t,"currentRound"),_=x[T].startDate,E=F.getAttribute(t,"titles")[config.language()];Extend.Suspendable(v);var S={};S["set."+t+".video"]=v.delegate(i),Extend.Subscriber(v,S,{afterLink:function(e){p=e.publisher,n?d():i(e,{value:e.publisher.getAttribute(t,"video")})}}),v.onResume(function(e){e&&p&&i({publisher:p},{value:p.getAttribute(t,"video")})});var j=jQuery(".liveTournamentContainer").data("force-video-language");return v.updateView=function(t){function n(e){var t=!0;return e.forEach(function(e){$._data($(document)[0],"events")[e]&&($(document).trigger(e),t=!1)}),t}if(!h||!h.length)return e.empty();h[u]||(u=h.findIndex(function(e){return e.language===config.language()}),-1===u&&(u=h.findIndex(function(e){return"en"===e.language})),j&&(u=h.findIndex(function(e){return e.language===j})),-1===u&&(u=0));var i=e.find(".videoContainer");0===i.length&&(m&&m.detach(),e.html(y.render("game.video"+$redesignSuffix,{tournamentTitle:E})),m&&m.prependTo(e),i=e.find(".videoContainer"));var o=e.find(".videoContainerWrapper"),a=o.width(),s=o.height();a||s||(a=b,s=C,o.width(a),o.height(s)),a||(a=Math.round(s*k),o.width(a)),s||(s=Math.round(a/k),o.height(s));var l=h.map(function(e){var t=e.autoPlay;switch(e.premiumRestriction&&!config.level().isPremium&&(t=1),e.type){case"livestream":return Object.merge(e,{html:'<iframe width="'+a+'" height="'+s+'" src="//new.livestream.com/accounts/'+e.account+"/events/"+e.event+(e.video?"/videos/"+e.video:"")+"/player?height="+s+"&width="+a+"&autoPlay="+!!t+'" scrolling="no" frameborder="0" allowfullscreen></iframe>'});case"youtube":return Object.merge(e,{html:'<iframe src="//www.youtube.com/embed/'+e.event+"?autohide=1&modestbranding=1&playsinline=1"+(t?"&autoplay=true":"")+'" height="'+s+'" width="'+a+'" scrolling="no" frameborder="0" allowfullscreen></iframe>'});case"youplay.se":return Object.merge(e,{html:'<script async defer src="//content.youplay.se/players/single/'+e.event+".js?ap="+!!t+"&yot="+(e.title?"1":"0")+"&yod="+(e.description?"1":"0")+"&yos="+(e.social?"1":"0")+'"></script>'});case"ustream":return Object.merge(e,{html:'<iframe width="'+a+'" height="'+s+'" src="//www.ustream.tv/embed/'+e.event+"?v=3&amp;wmode=direct"+(t?"&amp;autoplay=true":"")+'" scrolling="no" frameborder="0" allowfullscreen></iframe>'});case"iframe":return t&&(e.src.indexOf("?")>-1?e.src+="&autoplay=1":e.src+="?autoplay=1"),Object.merge(e,{html:'<iframe width="'+a+'" height="'+s+'" src="'+e.src+'" scrolling="no" frameborder="0" allowfullscreen></iframe>'})}});r(l[u]),$redesign?n(["chess24:currentVideoObject","chess24:videoRendered"])&&v.renderSelector(t):v.renderSelector(t)},v.renderSelector=function(t){function n(t){var n=h[u],i={label:n.label||o(n.commentators)},r=$(".colorHeader.colorWatch");$redesign?(t&&(r=t),i.languages=h.map(function(e,t){return{idx:t,active:t===u,language:"gb"===e.language?"EN":e.language.toUpperCase(),commentators:e.label||o(e.commentators)}}),i.selectedLanguage=n.language.toUpperCase(),"gb"===n.language&&(i.selectedLanguage="EN")):(r=e,i.languages=h.map(function(e,t){return{idx:t,lang:e.language,active:t===u,promote:e.promote,label:e.label||o(e.commentators,!0)}}));var a=y.render("game.videoSelector"+$redesignSuffix,i),l=r.find(".gamePresenter").html(a),c=$redesign?"div[data-idx]":".cTooltip";l.find(c).on("click",function(){var e=Date.now()/1e3;s(u,e-g),u=parseInt(jQuery(this).data("idx"),10),v.updateView(r)}),$redesign&&layout.dropDown($(".liveTournamentContainer"))}return $redesign&&!h?void $(document).on("chess24:currentVideoObject",function(){$(document).off("chess24:currentVideoObject"),n(t)}):void n(t)},v.attachOverlay=function(t){return w?!1:(v.removeOverlay(!0),m=t,e.prepend(m.hide()),m.css("height",0).prependTo(e).show().animate({height:"45px"},500,function(){m.css("height","")}),!0)},v.removeOverlay=function(e){m&&(e?(m.remove(),m=void 0):m.animate({height:0},500,function(){m.remove(),m=void 0}))},v.setPromoVideo=function(t){function n(e){e?(o.find(".pane .seconds").html(e),setTimeout(function(){n(e-1)},1e3)):o.find(".pane .info").hide()}var i=new Handler.Template("advertisement"),o=jQuery(i.render("video",t)).appendTo(e),r=o.find(".promoVideo"),a=o.find("a.overlay");return r.flowplayer({playlist:[t.video],cuepoints:[{time:t.timeout||10}],fullscreen:!1,embed:!1}).on("ready",function(){var e=r.data("flowplayer");a.removeClass("overlay"),Handler.tracking("advertisement","videoView",t.title),o.find(".cPatternSlider").on("change",function(){e.volume(jQuery("#ad-volume").val()/100)})}).on("resume",function(){var e=r.data("flowplayer");a.addClass("overlay"),o.find(".pane").css("display","block"),e.disable(!0),n(t.timeout||10)}).on("cuepoint",function(){o.find(".cTooltipBox, .info, .cPatternSlider").hide(),o.find(".pane").addClass("skip"),o.find(".pane, .cBtnFlexi").show().on("click",function(){v.resumeToVideo(),Handler.tracking("advertisement","videoSkip",t.title)})}).on("finish",function(){v.resumeToVideo(),Handler.tracking("advertisement","videoComplete",t.title)}).on("error",function(){v.resumeToVideo(),Handler.tracking("advertisement","videoError",t.title)}),r.hasClass("is-splash")||r.hasClass("is-error")?void v.resumeToVideo():(o.find(".cTooltipBox").show(),o.find(".cBtnFlexi").hide(),o.find(".pane").appendTo(r),void o.find(".cTooltipBoxContainer").html(t.title))},v.resumeToVideo=function(){w=!1,i(p,{value:p.getAttribute(t,"video")})},v.overrideVideo=function(e){i({},{value:e})},v},"undefined"==typeof View&&(View={}),function(){function e(e){return e===e.toUpperCase()}function t(t){var n=Object.without(t.getCurrentPosition().countPiecesOnBoard(),i),o={};for(var r in n){if(e(r))var a=r.toUpperCase(),s=r.toLowerCase();else a=r.toLowerCase(),s=r.toUpperCase();o[r]=n[a]-n[s]}return o}function n(e){var t={},n=e.getCurrentPosition().countPiecesOnBoard(),o=Object.without(a,i);for(var r in o)t[r]=o[r]-n[r];return t}var i=["white","black","total"],o={b:["q","r","b","n","p"],w:["Q","R","B","N","P"]},r={Q:"q",q:"w",K:"k",k:"l",B:"b",b:"n",N:"h",n:"j",R:"r",r:"t",P:"p",p:"a"},a=(new Chess.Position).countPiecesOnBoard();View.CapturedPieces=function(i,a,s){function l(){a.contains("w")&&a.contains("b")||(a.contains("b")?d.setColors(["w"]):a.contains("w")&&d.setColors(["b"]))}function c(l){var c=l.publisher,d=(s?t:n)(c),u="";a.forEach(function(t){for(var n=0;n<o[t].length;n++)for(var i=o[t][n],a=0;a<d[i];a++)(h&&e(i)||p&&!e(i))&&(u+=r[i])}),i.html(u)}var d=this;s=s||!1,a=a||["w","b"];var u,h=a.contains("w"),p=a.contains("b");i=jQuery(i),0===i.length&&errorHandler.error(new Error("container not found in View.CapturedPieces")),Extend.Suspendable(d);var f=d.delegate(c);return Extend.Subscriber(d,{currentGameChanged:f,"movedPositionPointer.current":f,flipBoard:l},{afterLink:function(e){u=e,f(e)}}),d.onResume(function(e){e&&u&&c(u)}),d.setColors=function(e){return a=e,h=a.contains("w"),p=a.contains("b"),f(u),d},d.setDiff=function(e){return s=!!e,f(u),d},d}}(),View=View||{},View.Chat=View.Chat||{},View.Chat.ChatHandler=function(e,n,i,o){function r(){he=!0,pe.emit("initialized")}function a(e){pe.emit("newMessage",e)}function s(){$(this).parent("dd").toggleClass("showAll")}function l(e){13!==e.keyCode||e.shiftKey||(C.apply(this),e.preventDefault())}function c(e){13!==e.keyCode||e.shiftKey||(C.apply(this),e.preventDefault());var t=$(this).closest("[group]"),n=(t.attr("group"),t.find(".specialMessageInput")),i=n.val().trim(),o=t.find(".btnSendSpecialMessage");i.length?(o.removeClass("disabled"),o.removeAttr("disabled")):(o.addClass("disabled"),o.attr("disabled","disabled"))}function d(e){if(ge.length&&le===te&&we.chatbox.scrollTop()<150){le=ne;var t=ge[0].data;chatHandler.getPreviousMessages(de,i,t.id,t.timestamp),k()}}function u(e){if(config.level().isModerator&&de){e=e.replace(/ +(?= )/g,"");var t=e.split(" ");switch(t[0]){case"/?":case"/help":B(ye.render("chatModeratorHelp"));break;case"/block":if(t.length<2)return void B('missing username (usage: "/block username [timeout in seconds]", default timeout: 10 minutes)');h(t[1],function(e){void 0===e?B('user "'+t[1]+'" cannot be found'):t[2]?chatHandler.moderator.user.block(e,Math.max(15,+t[2]),de,i):chatHandler.moderator.user.block(e,void 0,de,i)});break;case"/ban":if(t.length<2)return void B('missing username (usage: "/ban username")');h(t[1],function(e){void 0===e?B('user "'+t[1]+'" cannot be found'):chatHandler.moderator.user.ban(e,de,i)});break;case"/unban":if(t.length<2)return void B('missing username (usage: "/unban username")');h(t[1],function(e){void 0===e?B('user "'+t[1]+'" cannot be found'):chatHandler.moderator.user.unban(e,de,i)});break;case"/clear":if(t.length<2)return void B('missing username (usage: "/clear username")');h(t[1],function(e){void 0===e?B('user "'+t[1]+'" cannot be found'):chatHandler.moderator.user.deleteMessages(e,de)});break;default:B("unknown command:"+t[0])}}}function h(e,t){var n=me[e.toLowerCase()];if(n)return void t(n);var i="/api/web/UserAPI/getUuidFromNick";$.get(i,{nick:e},function(n){me[e]=n,ve[n]=e,t(n)}).fail(function(){t()})}function p(){if(de&&!$(this).hasClass("disabled")){var e=we.editor.editor("text").trim();if($redesign&&(e=we.inputContainer.val()),e.length)if(we.editor.editor("reset"),we.inputContainer.val(""),we.inputContainer.trigger("input"),"/"===e[0])u(e);else if($redesign&&(we.btnSendMessage.hide(),we.charCount.html("0/"+Z)),chatHandler.sendMessage(de,e,void 0,f),!config.level().isPremium){var t=J[de].config?J[de].config.cooldown:Handler.ChatHandler.COOLDOWN_DEFAULTVALUE;g(t,"cooldown",!0)}we.editor.focus()}}function f(e){if(e&&!e.sent&&e.data.content.data){var t=e.data.content.data;switch(t.code){case oe:g(t.cooldown,"cooldown",!0);break;case ie:t.cooldown===se?g(1/0,"banned"):g(t.cooldown,"blocked")}}}function g(e,t,n){if(0!==e&&(W=Date.now()+1e3*(e-.5),$redesign?(we.btnSendMessage.hide(),we.inputContainer.prop("disabled",!0),K=we.templates.attr(t+"template"),we.inputContainer.val(K)):(K=we.editorOverlay.attr(t+"template"),we.inputContainer.attr("disabled","disabled"),we.btnSendMessage.addClass("disabled"),we.chatToolbar.hide(),we.editor.hide(),we.editorOverlay.text(K),we.editorOverlay.show()),m(),n))switch(we.editor.parent().off("click.cooldownConversion"),t){case"premiumOnly":we.editor.parent().on("click.cooldownConversion",y);break;default:we.editor.parent().on("click.cooldownConversion",w)}}function m(){clearTimeout(q);var e=Date.now();return e>=W?v():($redesign?we.inputContainer.val(Handler.Template.renderString(K,{n:Math.ceil((W-e)/1e3)})):we.editorOverlay.text(Handler.Template.renderString(K,{n:Math.ceil((W-e)/1e3)})),void(q=setTimeout(m,1e3-e%1e3)))}function v(){clearTimeout(q),we.editorOverlay.text(""),we.editorOverlay.hide(),we.editor.show(),we.chatToolbar.show(),we.inputContainer.removeAttr("disabled"),we.inputContainer.val(""),we.charCount.html("0/"+Z),we.btnSendMessage.removeClass("disabled"),we.editor.parent().off("click.cooldownConversion"),W=void 0,we.inputContainer.focus()}function y(){Dialog.conversionGoPremium("chatPremiumOnly")}function w(){var e=J[de].config?J[de].config.cooldown:Handler.ChatHandler.COOLDOWN_DEFAULTVALUE;Dialog.conversionGoPremium("chatCooldown",{},{cooldown:e})}function b(t){e.empty().append(ye.render("loadError",{message:window.t(t)}))}function C(){if(de){var e=$(this).closest("[group]"),t=e.attr("group"),n=e.find(".specialMessageInput"),i=n.val().trim();if(!i.length)return void n.focus();var o,r=e.find(".teaserLinkUrl"),a=r.val().trim(),s=e.find(".teaserImageUrl"),l=s.val().trim(),c=e.find(".teaserLinkText"),d=c.val().trim();a||l?(i=JSON.stringify({img:l,url:a,linkText:d,message:i}),o=t+"Teaser"):o=t,chatHandler.sendMessage(de,i,o),n.val(""),r.val(""),s.val(""),c.val(""),n.focus()}}function k(){e.find(".messages-scroll-loader").show()}function F(){e.find(".messages-scroll-loader").hide()}function x(e){var t=we.chatbox,n=t.find(".chatList"),i=t.scrollTop()>0&&t.prop("scrollHeight")-t.scrollTop()-t.outerHeight()<100||0==t.scrollTop()&&t.outerHeight()>n.outerHeight();return e(),ce&&i&&t.scrollTop(t.prop("scrollHeight")),pe}function T(e,t){blockedUserHandler.isBlocked(e.user.uuid)||(me[e.user.nick.toLowerCase()]=e.user.uuid,ve[e.user.uuid]=e.user.nick,e.type?P(e,t):M(e,t),E())}function _(){return we.chatMessages.find("dd").length+we.chatMessages.find(".info").length}function E(){for(le!==ee&&_()>=X&&(le=ee);_()>X;){var e=we.chatMessages.children(":first-child");e.hasClass("chatBoxEntry")?Q(ge.shift()):e.remove()}}function S(){var e=$(this).closest("[user-id]").attr("user-id"),n=ve[e];Dialog.confirmation(t('Block user "{{userName}}"?',{"{{userName}}":n}),function(){chatHandler.moderator.user.block(e,void 0,de,i)})}function j(){var e=$(this).closest("[user-id]").attr("user-id"),t=ve[e];Dialog.Chat.banUser(t,function(t){chatHandler.moderator.user.ban(e,de,i),t&&chatHandler.moderator.user.deleteMessages(e,de)})}function I(){x(function(){$(".chatMessages dl:not(.premiumMessage)").each(function(e,t){$(t).toggleClass("hidden",$("#premiumOnly").prop("checked"))})})}function A(){var e=$(this).closest("[msg-id]").attr("msg-id");if(e){var n,i,o;for(o=ge.length,i=0;o>i;i++)ge[i].data.id===e&&(n=ge[i].data);if(n){var r=n.content;switch(n.type){case"chess24Teaser":r=JSON.parse(n.content).message}var a=Handler.Template.escape(r.substr(0,100));r.length>100&&(a+="..."),Dialog.confirmation(t('Delete message "{{message}}"?',{"{{message}}":a}),function(){chatHandler.moderator.deleteMessage(de,n.id,n.timestamp)})}}}function O(){$(".menuChat").show()}function M(e,t){var n,i=ge.length,o=null;if(i)if(t)for(n=0,o=ge[n];i>n&&!o.msg.hasClass("chatBoxEntry");)n++,o=ge[n];else for(n=i-1,o=ge[n];n>=0&&!o.msg.hasClass("chatBoxEntry");)n--,o=ge[n];var r,a=null!==o&&o.data.user?o.data.user.uuid:"";if(t){var s=we.chatMessages.find(":first-child");r=s.hasClass("info")||s.hasClass("special")||a!==e.user.uuid?"message":"continuedMessage"}else{var l=we.chatMessages.find(">dl:last");r=l.hasClass("info")||l.hasClass("special")||a!==e.user.uuid?"message":"continuedMessage"}var c=e.content.split("\n").map(function(e){return e.trim()}).filter(function(e){return e.length>0}).map(function(e){return{line:e}}),d=ye.render("messageContent",{lines:c}),u=$(ye.render(r,{uuid:e.user.uuid,user:e.user.nick,permalink:e.user.permalink,attributes:e.user.attributes,profileImage:e.user.profileImageUrl,isPremium:e.user.attributes.premium,nick:e.user.nick,messageId:e.id,message:d,isModerator:config.level().isModerator}));u.find(".messageContent").expandEmoticons().expandLinks();var h={data:e,msg:u};if("continuedMessage"===r)if(t){var p=o.msg.find("dt").next();p.before(u),p.attr("msg-id",o.msg.attr("msg-id")),o.msg.attr("msg-id",u.attr("msg-id")),u.attr("msg-id",null),u.find(".messageTime").after(p.find(".messageUser"))}else o.msg.append(u);else we.chatMessages[t?"prepend":"append"](u);ge[t?"unshift":"push"](h);var f=48;if(u.find(".messageContent").height()>f&&("continuedMessage"===r?u.addClass("longMessage"):u.find("dd").addClass("longMessage")),u.find(".messageTime").showAge(e.timestamp,!0),""!==e.user.uuid){var g=u.find(".messageUser > a");g.length&&(g.data("uuid",e.user.uuid),g.addMiniprofile())}return $("#premiumOnly").prop("checked")&&!e.user.attributes.premium&&u.addClass("hidden"),u}function P(e,t){switch(delete e.user,e.type){case"chess24":case"chess24Teaser":var n="chess24",i="chess24"}var o;switch(e.type){case"chess24Teaser":var r=JSON.parse(e.content);r.url&&!r.linkText&&(r.linkText=r.url),o=(r.img?ye.render("messageContentTeaserImage",r):"")+"<div>"+r.message+(r.url?ye.render("messageContentTeaserLink",r):"")+"</div>";break;default:o=e.content.replace(/\n/g,"<br>")}var a=$(ye.render("messageSpecial",{messageId:e.id,nick:i,message:o,type:n,isModerator:config.level().isModerator}));return a.find("img").error(function(){$(this).parent().parent().remove()}),we.chatMessages[t?"prepend":"append"](a),ge[t?"unshift":"push"]({data:e,msg:a}),a}function B(e){we.chatMessages.append(ye.render("info",{message:e})),we.chatbox.scrollTop(we.chatbox.prop("scrollHeight"))}function R(){return!J[de]||!J[de].config||!J[de].config.advertisement||J[de].config.advertisement.enabled}function L(e){if(Ce&&R()&&(e||!we.chatMessages.find(">dl:last").hasClass("advertisement"))){var t=Ce.getNextAd();t&&we.chatMessages[e?"prepend":"append"](ye.render("advertisement",t)),e?ke=0:Fe=0,E()}}function N(e){if(Ce&&R()){for(;we.chatMessages.find(">dl:last").is(".announcement."+e.item);)we.chatMessages.find(">dl:last").remove();we.chatMessages.append(ye.render("announcement",e)),E()}}function D(e){e?L(e):x(L)}function Q(e){if(e.msg.hasClass("special"))e.msg.remove();else{var t=e.msg.find("dd");if(t.length>1){var n=e.msg.find(".messageUser");n.remove(),$(t[1]).prepend(n),$(t[0]).remove();var i=$(t[1]).attr("msg-id");$(t[1]).removeAttr("msg-id"),e.msg.attr("msg-id",i);var o,r=ge.length;for(o=0;r>o;o++){var a=ge[o];if(a.data.id===i){a.msg=e.msg;break}}}else e.msg.remove()}}function H(){if(!config.level().isGuest){var e=J[de],t=!0,n=!0,i=!1;if(e&&e.config&&e.config.permissions){switch(e.config.permissions.write){case"premium":case"premium1":t=config.level().isPremium;break;case"registered":t=config.level().isRegistered;break;case"none":i=!0,t=!1;break;default:t=!1}switch(e.config.permissions.read){case"premium":case"premium1":n=config.level().isPremium;break;case"registered":n=config.level().isRegistered;break;default:n=!0}}if(i){if(!we.inputArea.find(".closedRoomOverlay").length){var o=$(ye.render("closedRoomOverlay"));we.inputArea.append(o)}}else if(n||t)we.inputArea.find(".closedRoomOverlay").remove(),we.inputArea.find(".premiumConversionOverlay").remove();else if(!we.inputArea.find(".premiumConversionOverlay").length){var r=$(ye.render("premiumConversionOverlay"));we.inputArea.append(r)}}}function G(){var t=n.map(function(e){return{roomId:e,title:J[e]?J[e].title:e}}),i=$(ye.render("roomSelector"+$redesignSuffix,{rooms:t}));e.find(".roomSelector:first").append(i);var o=e.find(".chatRoomSelector .cTooltipBoxContainer");o.find("span").on("click",function(){o.find("span").removeClass("active");var e=$(this);e.addClass("active"),pe.selectChatRoom(e.attr("value"))}),o.find("[value="+de+"]").addClass("active")}function V(){$(".chatRoomList").toggle()}function U(){pe.selectChatRoom($(this).attr("value")),V()}function z(){function e(e){e[0].originalOverflowY||(e[0].originalOverflowY=e.css("overflow-y"));var t=e.css("max-width");n.text(e.text()).css("max-width","none"===t?e.width()+"px":t).css("font",e.css("font")).css("overflow-y",e.css("overflow-y")).css("max-height",e.css("max-height")).css("min-height",e.css("min-height")).css("min-width",e.css("min-width")).css("padding",e.css("padding")).css("border",e.css("border")).css("box-sizing",e.css("box-sizing"))}function t(e){var t=e.height()+$(".chatBox").height();e.height(n.height()),$(".chatBox").height(t-n.height());var i=n.width();if("auto"===e[0].originalOverflowY){var o=e.css("max-width");"none"!==o&&(i===parseInt(o)?e.css("overflow-y","auto"):e.css("overflow-y","hidden"))}e.width(i+2)}var n=$("<span>",{style:"display:inline-block;word-break:break-word;visibility:hidden;white-space:pre-wrap;"}).appendTo("body");$("textarea.autofit").on({input:function(){var e=$(this).val();void 0===$(this).attr("preventEnter")&&(e=e.replace(/[\n]/g,"<br>&#8203;")),n.html(e),t($(this))},focus:function(){e($(this))},keypress:function(e){13===e.which&&void 0!==$(this).attr("preventEnter")&&e.preventDefault()}})}o.preSelectRoom=o.preSelectRoom!==!1;var W,q,K,Y,J,X=1e3,Z=1500,ee=0,te=1,ne=2,ie=801,oe=802,re=403,ae=902,se=-1,le=ee,ce=void 0===o.autoscroll?!0:o.autoscroll,de=o.defaultChatRoom||(o.preSelectRoom?n[0]:null),ue=!1,he=!1,pe=Extend.Publisher(this);e=$(e),e.length||errorHandler.error("container not found in View.Chat.ChatHandler");var fe,ge=[],me={},ve={},ye=new Handler.Template("chat").append(new Handler.Template),we={},be=setTimeout(function(){b("Chat system is not working at the moment, please come back later...")},3e4),Ce=null;e.empty().append(ye.render("loader")),chatHandler.getInitData(n,i);var ke=0,Fe=0;$(document).mouseup(function(e){var t=$(".menuChat");t.is(e.target)||0!==t.has(e.target).length||t.hide()}),pe.mixinAdvertisements=function(){if(he&&Ce&&Ce.isInitialized()&&R()){var e=Ce.getMessagesThreshold(),t=0;$(we.chatMessages.children().get().reverse()).each(function(n,i){if(t++%e===0){ke=0;var o=Ce.getNextAd();if(o){var r=ye.render("advertisement",o);$(i).after(r)}}else ke++})}},pe.renderAdvertisement=function(e){D(e)},pe.renderAnnouncement=function(e){x(function(){N(e)})},pe.isInitialized=function(){return he},pe.handleInitData=function(t){if(clearTimeout(be),J=t.rooms,!ue){ue=!0,e.empty();var i=n.map(function(e){return{roomId:e,title:J[e]?J[e].title:e}});we.chat=$(ye.render("chat"+$redesignSuffix,{isAdmin:config.level().isAdmin,isPremium:config.level().isPremium,isAdmin:config.level().isAdmin,isGuest:config.level().isGuest,roomId:de,rooms:i})),we.title=we.chat.find(".title"),we.header=we.chat.find(".chatHeader"),we.countTotal=we.chat.find(".countTotal"),we.countMasters=we.chat.find(".countMasters"),we.chatbox=we.chat.find(".chatBox"),we.chatMessages=we.chatbox.find(".chatMessages"),we.chatRoomSelector=we.chat.find(".chatRoomSelector"),o.header&&we.header&&we.header.html(o.header),we.chat.on("click",".labelShowComplete",s),we.chat.on("click",".btnDeleteMessage",A),we.chat.on("click",".btnModBlockUser",S),we.chat.on("click",".btnModBanUser",j),we.chat.on("click",".btnMenuChat",O),we.chat.on("click","#premiumOnly",I),we.chatRoomSelector.on("click",V),we.chat.on("click",".room",U),e.on("click",".btnSendMessage",p),e.on("click",".btnSendSpecialMessage",C),e.on("keydown",".specialMessageInput",l),e.on("input",".specialMessageInput",c),we.chatbox.on("scroll",d),e.append(we.chat),Y=t.user;var a=we.chat.find(".inputAreaContainer");a.empty(),config.level().isGuest&&a.append(ye.render("unregisteredUser"+$redesignSuffix,{embedded:o.embedded})),config.level().isPremium||(Ce=new View.Chat.AdvertisementHandler(pe,o.tournamentId).run()),fe=new View.Chat.AnnouncementHandler(pe);var u=$(ye.render("inputArea"+$redesignSuffix,{maxLength:Z,profileImage:Y.profileImageUrl,showModViewLink:(config.level().isModerator||config.level().isAdmin)&&"/chat/showRoom"!==window.location.pathname,roomIds:de}));if(o.showSpecialInput&&Array.isArray&&Array.isArray(Y.groups)&&Y.groups.length>0){var h=$('<div class="customTabs">');h.append($('<section id="chatInputTabChat" data-tab-title="Chat">').append(u)),$(".inputAreaContainer").addClass("specialMessages"),Y.groups.forEach(function(e){h.append(ye.render("inputAreaSpecial",{imageUrl:e.imageUrl,group:e.name}))}),a.append(h)}else a.append(u);return n.length>1?G():e.addClass("singleRoom"),we.btnSendMessage=a.find(".btnSendMessage"),we.inputArea=a,we.editorOverlay=a.find(".editorOverlay"),we.chatToolbar=a.find(".chatToolbar"),we.charCount=a.find(".charCount"),$redesign?(we.inputContainer=a.find("#message"),we.templates=a.find(".templates"),we.editor=a.find("#message"),we.btnEmoticons=a.find(".btnEmoticons"),we.btnSendMessage.on("click",function(){p()})):(we.inputContainer=a.find(".inputContainer"),we.editor=we.inputContainer.find(".editor")),config.level().isGuest||($editor=we.editor.editor({language:config.language(),height:22,maxLength:Z,hideToolbar:!0,extensions:["emoticons"],toolbar:{left:[],right:[]},extensionConfig:{emoticons:{dialogContainer:u.find(".btnChatExtension .cTooltipBoxContainer")}},watermark:we.inputContainer.attr("placeholder"),dialogConfig:{emoticons:{showAsPopup:!0}},removeLineBreaks:!0}),we.editor.on("keydown",function(e){switch(e.keyCode){case 13:e.shiftKey?e.preventDefault():(p(),e.preventDefault())}}).on("keyup change",function(e){if($redesign){var t=we.inputContainer.val();we.charCount.html(t.length+"/"+Z),0===t.length?we.btnSendMessage.hide():we.btnSendMessage.show()}else we.editor.editor("isEmpty")?(we.btnSendMessage.addClass("disabled"),we.btnSendMessage.attr("disabled","disabled")):(we.btnSendMessage.removeClass("disabled"),we.btnSendMessage.removeAttr("disabled"))})),layout.tabs(e),pe.selectChatRoom(de),z(),r(),$redesign&&(we.btnSendMessage.hide(),we.inputContainer.emojiPicker({button:!1}),we.btnEmoticons.click(function(e){e.preventDefault(),we.inputContainer.emojiPicker("toggle")})),F(),pe}},pe.enterChatRoom=function(e){if(e.messages){for(var t=e.messages.length,n=t-1;n>=0;n--)T(e.messages[n]);le=t<o.getMessagesLimit?ee:te}pe.mixinAdvertisements(),e.counts&&pe.updateCounts(e.counts);var i=J[de];return!config.level().isPremium&&i&&i.config&&i.config.permissions&&"premium1"===i.config.permissions.write?g(1/0,"premiumOnly",!0):-1===e.blocked?g(1/0,"banned"):e.blocked?g(e.blocked,"blocked"):e.cooldown?g(e.cooldown,"cooldown",!0):v(),we.chatbox.scrollTop(we.chatbox.prop("scrollHeight")),setTimeout(function(){we.chatbox.scrollTop(we.chatbox.prop("scrollHeight"))},200),pe},pe.selectChatRoom=function(e){n.contains(e)||errorHandler.warning("room is not in list of available rooms: ",{roomId:e}),chatHandler.leaveChatRoom(de),we.chatMessages.empty(),ge=[],de=e,$(".chatModViewLink").attr("href","/chat/showRoom?rooms="+e),chatHandler.enterChatRoom(e,i);var t=J[e];return $(".selectedRoom").html(t.languageCode),H(),pe},pe.enterChatRoomFailed=function(t){switch(t.code){case re:var n=J[t.roomId];if(n.config&&n.config.permissions)switch(n.config.permissions.read){case"premium":case"premium1":B(window.t("You must be a premium member to access this chat!"));break;case"registered":B(window.t("Please register to access this chat!"))}break;case ae:g(1/0,"roomNotExists"),B($redesign?e.find(".templates").attr("roomNotExiststemplate"):e.find(".editorOverlay").attr("roomNotExiststemplate"))}return F(),pe},pe.addNewMessage=function(e){return x(function(){a(e),T(e),Ce&&++Fe>=Ce.getMessagesThreshold()&&D(!1)}),pe},pe.updateCounts=function(e){return we.countTotal.text(e.total),we.countMasters.text(e.gm+e.im),pe},pe.updateMetadata=function(e){return J[e.roomId]=JSON.parse(e.metadata),pe.selectChatRoom(de),pe},pe.addPreviousMessages=function(e){F();for(var t=we.chatbox,n=t.prop("scrollHeight"),i=e.length,o=0;i>o;o++)T(e[o],!0),Ce&&++ke>=Ce.getMessagesThreshold()&&D(!0);return le!==ee&&(le=0===i?ee:te),t.scrollTop(t.prop("scrollHeight")-n),pe},pe.deleteMessage=function(e){var t,n=ge.length;for(t=0;n>t;t++){var i=ge[t];if(i.data.id===e)return Q(i),void ge.splice(t,1)}return pe},pe.deleteMessages=function(e){for(var t=0;t<ge.length;t++){var n=ge[t];n.data.user&&n.data.user.uuid===e&&(Q(n),ge.splice(t,1),t--)}return pe},pe.clear=function(){return e.empty(),Ce&&Ce.stop(),fe&&fe.stop(),pe},pe.handleUserBlocked=function(e){var t=ve[e.uuid];return B('user "'+t+'" has been blocked for '+e.timeout+" seconds"),pe},pe.handleUserBanned=function(e){var t=ve[e.uuid];return B('user "'+t+'" has been banned'),pe},pe.handleUserUnbanned=function(e){var t=ve[e.uuid];return B('user "'+t+'" has been unbanned'),pe}},View=View||{},View.Chat=View.Chat||{},View.Chat.AdvertisementHandler=function(e,t){function n(){i&&clearTimeout(i),c||(i=setTimeout(function(){e.renderAdvertisement(),n()},1e3*o))}var i,o=600,r=50,a=this,s=[],l=[],c=!1,d=!1;return a.run=function(){return jQuery.getJSON("/api/web/advertisementAPI/getOverlays",{language:config.language(),id:t,level:config.level().toString()}).done(function(t){t&&t.data&&t.data.advertisements&&t.data.advertisements.forEach(function(e){var t=e.nextShow;(!t||t<Date.now())&&s.push(e)}),d=!0,e.mixinAdvertisements(),n()}),a},a.isInitialized=function(){return d},a.stop=function(){return c=!0,i&&(clearTimeout(i),i=null),a},a.getNextAd=function(){if(0===s.length)return null;0===l.length&&s.forEach(function(e,t){l.push(t)}),n();var e=l[Math.randomBetween(0,l.length-1)];return l.splice(l.indexOf(e),1),s[e]},a.getMessagesThreshold=function(){return r},a},"undefined"==typeof View&&(View={}),View.Chat=View.Chat||{},View.Chat.AnnouncementHandler=function(e){function t(t,n){if(n&&n.content&&n.content.data&&i.contains(n.content.data.item)){var o=Object.map(n.content.data,function(e){return"object"==typeof e&&config.language()in e?e[config.language()]:e});e.renderAnnouncement(o)}}var n=this,i=["playzoneTournament"],o="channel:announcement";return notificationHandler.subscribe(o),notificationHandler.on(o,t),n.stop=function(){notificationHandler.off("channel",t),notificationHandler.unsubscribe(o)},n},$(function(){$.fn.emojiPicker.emojis=[{name:"grinning",unicode:{apple:"1F600",google:"1F600",twitter:"1F600"},shortcode:"grinning",description:"GRINNING FACE",category:"people"},{name:"grin",unicode:{apple:"1F601",google:"1F601",twitter:"1F601"},shortcode:"grin",description:"GRINNING FACE WITH SMILING EYES",category:"people"},{name:"grimacing",unicode:{apple:"1F62C",google:"1F62C",twitter:"1F62C"},shortcode:"grimacing",description:"GRIMACING FACE",category:"people"},{name:"joy",unicode:{apple:"1F602",google:"1F602",twitter:"1F602"},shortcode:"joy",description:"FACE WITH TEARS OF JOY",category:"people"},{name:"smiley",unicode:{apple:"1F603",google:"1F603",twitter:"1F603"},shortcode:"smiley",description:"SMILING FACE WITH OPEN MOUTH",category:"people"},{name:"smile",unicode:{apple:"1F604",google:"1F604",twitter:"1F604"},shortcode:"smile",description:"SMILING FACE WITH OPEN MOUTH AND SMILING EYES",category:"people"},{name:"sweat_smile",unicode:{apple:"1F605",google:"1F605",twitter:"1F605"},shortcode:"sweat_smile",description:"SMILING FACE WITH OPEN MOUTH AND COLD SWEAT",category:"people"},{name:"laughing",unicode:{apple:"1F606",google:"1F606",twitter:"1F606"},shortcode:"laughing",description:"SMILING FACE WITH OPEN MOUTH AND TIGHTLY-CLOSED EYES",category:"people"},{name:"innocent",unicode:{apple:"1F607",google:"1F607",twitter:"1F607"},shortcode:"innocent",description:"SMILING FACE WITH HALO",category:"people"},{name:"wink",unicode:{apple:"1F609",google:"1F609",twitter:"1F609"},shortcode:"wink",description:"WINKING FACE",category:"people"},{name:"blush",unicode:{apple:"1F60A",google:"1F60A",twitter:"1F60A"},shortcode:"blush",description:"SMILING FACE WITH SMILING EYES",category:"people"},{name:"slightly_smiling_face",unicode:{apple:"1F642",google:"1F642",twitter:"1F642"},shortcode:"slightly_smiling_face",description:"slightly smiling face",category:"people"},{name:"upside_down_face",unicode:{apple:"1F643",google:"1F643",twitter:"1F643"},shortcode:"upside_down_face",description:"upside-down face",category:"people"},{name:"relaxed",unicode:{apple:"263A",google:"263A",twitter:"263A"},shortcode:"relaxed",description:"WHITE SMILING FACE",category:"people"},{name:"yum",unicode:{apple:"1F60B",google:"1F60B",twitter:"1F60B"},shortcode:"yum",description:"FACE SAVOURING DELICIOUS FOOD",category:"people"},{name:"relieved",unicode:{apple:"1F60C",google:"1F60C",twitter:"1F60C"},shortcode:"relieved",description:"RELIEVED FACE",category:"people"},{name:"heart_eyes",unicode:{apple:"1F60D",google:"1F60D",twitter:"1F60D"},shortcode:"heart_eyes",description:"SMILING FACE WITH HEART-SHAPED EYES",category:"people"},{name:"kissing_heart",unicode:{apple:"1F618",google:"1F618",twitter:"1F618"},shortcode:"kissing_heart",description:"FACE THROWING A KISS",category:"people"},{name:"kissing",unicode:{apple:"1F617",google:"1F617",twitter:"1F617"},shortcode:"kissing",description:"KISSING FACE",category:"people"},{name:"kissing_smiling_eyes",unicode:{apple:"1F619",google:"1F619",twitter:"1F619"
},shortcode:"kissing_smiling_eyes",description:"KISSING FACE WITH SMILING EYES",category:"people"},{name:"kissing_closed_eyes",unicode:{apple:"1F61A",google:"1F61A",twitter:"1F61A"},shortcode:"kissing_closed_eyes",description:"KISSING FACE WITH CLOSED EYES",category:"people"},{name:"stuck_out_tongue_winking_eye",unicode:{apple:"1F61C",google:"1F61C",twitter:"1F61C"},shortcode:"stuck_out_tongue_winking_eye",description:"FACE WITH STUCK-OUT TONGUE AND WINKING EYE",category:"people"},{name:"stuck_out_tongue_closed_eyes",unicode:{apple:"1F61D",google:"1F61D",twitter:"1F61D"},shortcode:"stuck_out_tongue_closed_eyes",description:"FACE WITH STUCK-OUT TONGUE AND TIGHTLY-CLOSED EYES",category:"people"},{name:"stuck_out_tongue",unicode:{apple:"1F61B",google:"1F61B",twitter:"1F61B"},shortcode:"stuck_out_tongue",description:"FACE WITH STUCK-OUT TONGUE",category:"people"},{name:"money_mouth_face",unicode:{apple:"1F911",google:"1F911",twitter:"1F911"},shortcode:"money_mouth_face",description:"Money-Mouth Face",category:"people"},{name:"nerd_face",unicode:{apple:"1F913",google:"1F913",twitter:"1F913"},shortcode:"nerd_face",description:"Nerd Face",category:"people"},{name:"sunglasses",unicode:{apple:"",google:"",twitter:"1F60E"},shortcode:"sunglasses",description:"SMILING FACE WITH SUNGLASSES",category:"people"},{name:"hugging_face",unicode:{apple:"1F917",google:"1F917",twitter:"1F917"},shortcode:"hugging_face",description:"Hugging Face",category:"people"},{name:"smirk",unicode:{apple:"1F60F",google:"1F60F",twitter:"1F60F"},shortcode:"smirk",description:"SMIRKING FACE",category:"people"},{name:"no_mouth",unicode:{apple:"1F636",google:"1F636",twitter:"1F636"},shortcode:"no_mouth",description:"FACE WITHOUT MOUTH",category:"people"},{name:"neutral_face",unicode:{apple:"1F610",google:"1F610",twitter:"1F610"},shortcode:"neutral_face",description:"NEUTRAL FACE",category:"people"},{name:"expressionless",unicode:{apple:"1F611",google:"1F611",twitter:"1F611"},shortcode:"expressionless",description:"EXPRESSIONLESS FACE",category:"people"},{name:"unamused",unicode:{apple:"1F612",google:"1F612",twitter:"1F612"},shortcode:"unamused",description:"UNAMUSED FACE",category:"people"},{name:"face_with_rolling_eyes",unicode:{apple:"1F644",google:"1F644",twitter:"1F644"},shortcode:"face_with_rolling_eyes",description:"Face With Rolling Eyes",category:"people"},{name:"thinking_face",unicode:{apple:"1F914",google:"1F914",twitter:"1F914"},shortcode:"thinking_face",description:"Thinking Face",category:"people"},{name:"flushed",unicode:{apple:"1F633",google:"1F633",twitter:"1F633"},shortcode:"flushed",description:"FLUSHED FACE",category:"people"},{name:"disappointed",unicode:{apple:"1F61E",google:"1F61E",twitter:"1F61E"},shortcode:"disappointed",description:"DISAPPOINTED FACE",category:"people"},{name:"worried",unicode:{apple:"1F61F",google:"1F61F",twitter:"1F61F"},shortcode:"worried",description:"WORRIED FACE",category:"people"},{name:"angry",unicode:{apple:"1F620",google:"1F620",twitter:"1F620"},shortcode:"angry",description:"ANGRY FACE",category:"people"},{name:"rage",unicode:{apple:"1F621",google:"1F621",twitter:"1F621"},shortcode:"rage",description:"POUTING FACE",category:"people"},{name:"pensive",unicode:{apple:"1F614",google:"1F614",twitter:"1F614"},shortcode:"pensive",description:"PENSIVE FACE",category:"people"},{name:"confused",unicode:{apple:"1F615",google:"1F615",twitter:"1F615"},shortcode:"confused",description:"CONFUSED FACE",category:"people"},{name:"slightly_frowning_face",unicode:{apple:"1F641",google:"1F641",twitter:"1F641"},shortcode:"slightly_frowning_face",description:"slightly frowning face",category:"people"},{name:"white_frowning_face",unicode:{apple:"2639",google:"2639",twitter:"2639"},shortcode:"white_frowning_face",description:"white frowning face",category:"people"},{name:"persevere",unicode:{apple:"1F623",google:"1F623",twitter:"1F623"},shortcode:"persevere",description:"PERSEVERING FACE",category:"people"},{name:"confounded",unicode:{apple:"1F616",google:"1F616",twitter:"1F616"},shortcode:"confounded",description:"CONFOUNDED FACE",category:"people"},{name:"tired_face",unicode:{apple:"1F62B",google:"1F62B",twitter:"1F62B"},shortcode:"tired_face",description:"TIRED FACE",category:"people"},{name:"weary",unicode:{apple:"1F629",google:"1F629",twitter:"1F629"},shortcode:"weary",description:"WEARY FACE",category:"people"},{name:"triumph",unicode:{apple:"1F624",google:"1F624",twitter:"1F624"},shortcode:"triumph",description:"FACE WITH LOOK OF TRIUMPH",category:"people"},{name:"open_mouth",unicode:{apple:"1F62E",google:"1F62E",twitter:"1F62E"},shortcode:"open_mouth",description:"FACE WITH OPEN MOUTH",category:"people"},{name:"scream",unicode:{apple:"1F631",google:"1F631",twitter:"1F631"},shortcode:"scream",description:"FACE SCREAMING IN FEAR",category:"people"},{name:"fearful",unicode:{apple:"1F628",google:"1F628",twitter:"1F628"},shortcode:"fearful",description:"FEARFUL FACE",category:"people"},{name:"cold_sweat",unicode:{apple:"1F630",google:"1F630",twitter:"1F630"},shortcode:"cold_sweat",description:"FACE WITH OPEN MOUTH AND COLD SWEAT",category:"people"},{name:"hushed",unicode:{apple:"1F62F",google:"1F62F",twitter:"1F62F"},shortcode:"hushed",description:"HUSHED FACE",category:"people"},{name:"frowning",unicode:{apple:"1F626",google:"1F626",twitter:"1F626"},shortcode:"frowning",description:"FROWNING FACE WITH OPEN MOUTH",category:"people"},{name:"anguished",unicode:{apple:"1F627",google:"1F627",twitter:"1F627"},shortcode:"anguished",description:"ANGUISHED FACE",category:"people"},{name:"cry",unicode:{apple:"1F622",google:"1F622",twitter:"1F622"},shortcode:"cry",description:"CRYING FACE",category:"people"},{name:"disappointed_relieved",unicode:{apple:"1F625",google:"1F625",twitter:"1F625"},shortcode:"disappointed_relieved",description:"DISAPPOINTED BUT RELIEVED FACE",category:"people"},{name:"sleepy",unicode:{apple:"1F62A",google:"1F62A",twitter:"1F62A"},shortcode:"sleepy",description:"SLEEPY FACE",category:"people"},{name:"sweat",unicode:{apple:"1F613",google:"1F613",twitter:"1F613"},shortcode:"sweat",description:"FACE WITH COLD SWEAT",category:"people"},{name:"sob",unicode:{apple:"1F62D",google:"1F62D",twitter:"1F62D"},shortcode:"sob",description:"LOUDLY CRYING FACE",category:"people"},{name:"dizzy_face",unicode:{apple:"1F635",google:"1F635",twitter:"1F635"},shortcode:"dizzy_face",description:"DIZZY FACE",category:"people"},{name:"astonished",unicode:{apple:"1F632",google:"1F632",twitter:"1F632"},shortcode:"astonished",description:"ASTONISHED FACE",category:"people"},{name:"zipper_mouth_face",unicode:{apple:"1F910",google:"1F910",twitter:"1F910"},shortcode:"zipper_mouth_face",description:"Zipper-Mouth Face",category:"people"},{name:"mask",unicode:{apple:"1F637",google:"1F637",twitter:"1F637"},shortcode:"mask",description:"FACE WITH MEDICAL MASK",category:"people"},{name:"face_with_thermometer",unicode:{apple:"1F912",google:"1F912",twitter:"1F912"},shortcode:"face_with_thermometer",description:"Face With Thermometer",category:"people"},{name:"face_with_head_bandage",unicode:{apple:"1F915",google:"1F915",twitter:"1F915"},shortcode:"face_with_head_bandage",description:"Face With Head-Bandage",category:"people"},{name:"sleeping",unicode:{apple:"1F634",google:"1F634",twitter:"1F634"},shortcode:"sleeping",description:"SLEEPING FACE",category:"people"},{name:"zzz",unicode:{apple:"1F4A4",google:"1F4A4",twitter:"1F4A4"},shortcode:"zzz",description:"SLEEPING SYMBOL",category:"people"},{name:"hankey",keywords:["poop","poo"],unicode:{apple:"1F4A9",google:"1F4A9",twitter:"1F4A9"},shortcode:"hankey",description:"PILE OF POO",category:"people"},{name:"smiling_imp",unicode:{apple:"1F608",google:"1F608",twitter:"1F608"},shortcode:"smiling_imp",description:"SMILING FACE WITH HORNS",category:"people"},{name:"imp",unicode:{apple:"1F47F",google:"1F47F",twitter:"1F47F"},shortcode:"imp",description:"IMP",category:"people"},{name:"japanese_ogre",unicode:{apple:"1F479",google:"1F479",twitter:"1F479"},shortcode:"japanese_ogre",description:"JAPANESE OGRE",category:"people"},{name:"japanese_goblin",unicode:{apple:"1F47A",google:"1F47A",twitter:"1F47A"},shortcode:"japanese_goblin",description:"JAPANESE GOBLIN",category:"people"},{name:"skull",unicode:{apple:"1F480",google:"1F480",twitter:"1F480"},shortcode:"skull",description:"SKULL",category:"people"},{name:"ghost",unicode:{apple:"1F47B",google:"1F47B",twitter:"1F47B"},shortcode:"ghost",description:"GHOST",category:"people"},{name:"alien",unicode:{apple:"1F47D",google:"1F47D",twitter:"1F47D"},shortcode:"alien",description:"EXTRATERRESTRIAL ALIEN",category:"people"},{name:"robot_face",unicode:{apple:"1F916",google:"1F916",twitter:"1F916"},shortcode:"robot_face",description:"Robot Face",category:"people"},{name:"smiley_cat",unicode:{apple:"1F63A",google:"1F63A",twitter:"1F63A"},shortcode:"smiley_cat",description:"SMILING CAT FACE WITH OPEN MOUTH",category:"people"},{name:"smile_cat",unicode:{apple:"1F638",google:"1F638",twitter:"1F638"},shortcode:"smile_cat",description:"GRINNING CAT FACE WITH SMILING EYES",category:"people"},{name:"joy_cat",unicode:{apple:"1F639",google:"1F639",twitter:"1F639"},shortcode:"joy_cat",description:"CAT FACE WITH TEARS OF JOY",category:"people"},{name:"heart_eyes_cat",unicode:{apple:"1F63B",google:"1F63B",twitter:"1F63B"},shortcode:"heart_eyes_cat",description:"SMILING CAT FACE WITH HEART-SHAPED EYES",category:"people"},{name:"smirk_cat",unicode:{apple:"1F63C",google:"1F63C",twitter:"1F63C"},shortcode:"smirk_cat",description:"CAT FACE WITH WRY SMILE",category:"people"},{name:"kissing_cat",unicode:{apple:"1F63D",google:"1F63D",twitter:"1F63D"},shortcode:"kissing_cat",description:"KISSING CAT FACE WITH CLOSED EYES",category:"people"},{name:"scream_cat",unicode:{apple:"1F640",google:"1F640",twitter:"1F640"},shortcode:"scream_cat",description:"WEARY CAT FACE",category:"people"},{name:"crying_cat_face",unicode:{apple:"1F63F",google:"1F63F",twitter:"1F63F"},shortcode:"crying_cat_face",description:"CRYING CAT FACE",category:"people"},{name:"pouting_cat",unicode:{apple:"1F63E",google:"1F63E",twitter:"1F63E"},shortcode:"pouting_cat",description:"POUTING CAT FACE",category:"people"},{name:"raised_hands",unicode:{apple:"1F64C",google:"1F64C",twitter:"1F64C"},shortcode:"raised_hands",description:"PERSON RAISING BOTH HANDS IN CELEBRATION",category:"people"},{name:"clap",unicode:{apple:"1F44F",google:"1F44F",twitter:"1F44F"},shortcode:"clap",description:"CLAPPING HANDS SIGN",category:"people"},{name:"wave",unicode:{apple:"1F44B",google:"1F44B",twitter:"1F44B"},shortcode:"wave",description:"WAVING HAND SIGN",category:"people"},{name:"+1",keywords:["thumbsup"],unicode:{apple:"1F44D",google:"1F44D",twitter:"1F44D"},shortcode:"plus1",description:"THUMBS UP SIGN",category:"people"},{name:"-1",keywords:["thumbsdown"],unicode:{apple:"1F44E",google:"1F44E",twitter:"1F44E"},shortcode:"-1",description:"THUMBS DOWN SIGN",category:"people"},{name:"facepunch",unicode:{apple:"1F44A",google:"1F44A",twitter:"1F44A"},shortcode:"facepunch",description:"FISTED HAND SIGN",category:"people"},{name:"fist",unicode:{apple:"270A",google:"270A",twitter:"270A"},shortcode:"fist",description:"RAISED FIST",category:"people"},{name:"v",unicode:{apple:"270C",google:"270C",twitter:"270C"},shortcode:"v",description:"VICTORY HAND",category:"people"},{name:"ok_hand",unicode:{apple:"1F44C",google:"1F44C",twitter:"1F44C"},shortcode:"ok_hand",description:"OK HAND SIGN",category:"people"},{name:"hand",unicode:{apple:"270B",google:"270B",twitter:"270B"},shortcode:"hand",description:"RAISED HAND",category:"people"},{name:"open_hands",unicode:{apple:"1F450",google:"1F450",twitter:"1F450"},shortcode:"open_hands",description:"OPEN HANDS SIGN",category:"people"},{name:"muscle",unicode:{apple:"1F4AA",google:"1F4AA",twitter:"1F4AA"},shortcode:"muscle",description:"FLEXED BICEPS",category:"people"},{name:"pray",unicode:{apple:"1F64F",google:"1F64F",twitter:"1F64F"},shortcode:"pray",description:"PERSON WITH FOLDED HANDS",category:"people"},{name:"point_up",unicode:{apple:"261D",google:"261D",twitter:"261D"},shortcode:"point_up",description:"WHITE UP POINTING INDEX",category:"people"},{name:"point_up_2",unicode:{apple:"1F446",google:"1F446",twitter:"1F446"},shortcode:"point_up_2",description:"WHITE UP POINTING BACKHAND INDEX",category:"people"},{name:"point_down",unicode:{apple:"1F447",google:"1F447",twitter:"1F447"},shortcode:"point_down",description:"WHITE DOWN POINTING BACKHAND INDEX",category:"people"},{name:"point_left",unicode:{apple:"1F448",google:"1F448",twitter:"1F448"},shortcode:"point_left",description:"WHITE LEFT POINTING BACKHAND INDEX",category:"people"},{name:"point_right",unicode:{apple:"1F449",google:"1F449",twitter:"1F449"},shortcode:"point_right",description:"WHITE RIGHT POINTING BACKHAND INDEX",category:"people"},{name:"middle_finger",keywords:["reversed_hand_with_middle_finger_extended"],unicode:{apple:"1F595",google:"1F595",twitter:"1F595"},shortcode:"middle_finger",description:"Reversed Hand With Middle Finger Extended",category:"people"},{name:"raised_hand_with_fingers_splayed",unicode:{apple:"1F590",google:"1F590",twitter:"1F590"},shortcode:"raised_hand_with_fingers_splayed",description:"Raised Hand With Fingers Splayed",category:"people"},{name:"the_horns",keywords:["sign_of_the_horns"],unicode:{apple:"1F918",google:"1F918",twitter:"1F918"},shortcode:"the_horns",description:"Sign of the Horns",category:"people"},{name:"spock-hand",unicode:{apple:"1F596",google:"1F596",twitter:"1F596"},shortcode:"spock-hand",description:"Raised Hand With Part Between Middle and Ring Fingers",category:"people"},{name:"writing_hand",unicode:{apple:"270D",google:"270D",twitter:"270D"},shortcode:"writing_hand",description:"Writing Hand",category:"people"},{name:"nail_care",unicode:{apple:"1F485",google:"1F485",twitter:"1F485"},shortcode:"nail_care",description:"NAIL POLISH",category:"people"},{name:"lips",unicode:{apple:"1F444",google:"1F444",twitter:"1F444"},shortcode:"lips",description:"MOUTH",category:"people"},{name:"tongue",unicode:{apple:"1F445",google:"1F445",twitter:"1F445"},shortcode:"tongue",description:"TONGUE",category:"people"},{name:"ear",unicode:{apple:"1F442",google:"1F442",twitter:"1F442"},shortcode:"ear",description:"EAR",category:"people"},{name:"nose",unicode:{apple:"1F443",google:"1F443",twitter:"1F443"},shortcode:"nose",description:"NOSE",category:"people"},{name:"eye",unicode:{apple:"1F441",google:"1F441",twitter:"1F441"},shortcode:"eye",description:"EYE",category:"people"},{name:"eyes",unicode:{apple:"",google:"",twitter:"1F440"},shortcode:"eyes",description:"EYES",category:"people"},{name:"bust_in_silhouette",unicode:{apple:"1F464",google:"1F464",twitter:"1F464"},shortcode:"bust_in_silhouette",description:"BUST IN SILHOUETTE",category:"people"},{name:"busts_in_silhouette",unicode:{apple:"1F465",google:"1F465",twitter:"1F465"},shortcode:"busts_in_silhouette",description:"BUSTS IN SILHOUETTE",category:"people"},{name:"speaking_head_in_silhouette",unicode:{apple:"1F5E3",google:"1F5E3",twitter:"1F5E3"},shortcode:"speaking_head_in_silhouette",description:" Speaking Head in Silhouette",category:"people"},{name:"baby",unicode:{apple:"1F476",google:"1F476",twitter:"1F476"},shortcode:"baby",description:"BABY",category:"people"},{name:"boy",unicode:{apple:"1F466",google:"1F466",twitter:"1F466"},shortcode:"boy",description:"BOY",category:"people"},{name:"girl",unicode:{apple:"1F467",google:"1F467",twitter:"1F467"},shortcode:"girl",description:"GIRL",category:"people"},{name:"man",unicode:{apple:"1F468",google:"1F468",twitter:"1F468"},shortcode:"man",description:"MAN",category:"people"},{name:"woman",unicode:{apple:"1F469",google:"1F469",twitter:"1F469"},shortcode:"woman",description:"WOMAN",category:"people"},{name:"person_with_blond_hair",unicode:{apple:"1F471",google:"1F471",twitter:"1F471"},shortcode:"person_with_blond_hair",description:"PERSON WITH BLOND HAIR",category:"people"},{name:"older_man",unicode:{apple:"1F474",google:"1F474",twitter:"1F474"},shortcode:"older_man",description:"OLDER MAN",category:"people"},{name:"older_woman",unicode:{apple:"1F475",google:"1F475",twitter:"1F475"},shortcode:"older_woman",description:"OLDER WOMAN",category:"people"},{name:"man_with_gua_pi_mao",unicode:{apple:"1F472",google:"1F472",twitter:"1F472"},shortcode:"man_with_gua_pi_mao",description:"MAN WITH GUA PI MAO",category:"people"},{name:"man_with_turban",unicode:{apple:"1F473",google:"1F473",twitter:"1F473"},shortcode:"man_with_turban",description:"MAN WITH TURBAN",category:"people"},{name:"cop",unicode:{apple:"1F46E",google:"1F46E",twitter:"1F46E"},shortcode:"cop",description:"POLICE OFFICER",category:"people"},{name:"construction_worker",unicode:{apple:"1F477",google:"1F477",twitter:"1F477"},shortcode:"construction_worker",description:"CONSTRUCTION WORKER",category:"people"},{name:"guardsman",unicode:{apple:"1F482",google:"1F482",twitter:"1F482"},shortcode:"guardsman",description:"GUARDSMAN",category:"people"},{name:"sleuth_or_spy",unicode:{apple:"1F575",google:"1F575",twitter:"1F575"},shortcode:"sleuth_or_spy",description:"Sleuth Or Spy",category:"people"},{name:"santa",unicode:{apple:"1F385",google:"1F385",twitter:"1F385"},shortcode:"santa",description:"FATHER CHRISTMAS",category:"people"},{name:"angel",unicode:{apple:"1F47C",google:"1F47C",twitter:"1F47C"},shortcode:"angel",description:"BABY ANGEL",category:"people"},{name:"princess",unicode:{apple:"1F478",google:"1F478",twitter:"1F478"},shortcode:"princess",description:"PRINCESS",category:"people"},{name:"bride_with_veil",unicode:{apple:"1F470",google:"1F470",twitter:"1F470"},shortcode:"bride_with_veil",description:"BRIDE WITH VEIL",category:"people"},{name:"walking",unicode:{apple:"1F6B6",google:"1F6B6",twitter:"1F6B6"},shortcode:"walking",description:"PEDESTRIAN",category:"people"},{name:"runner",unicode:{apple:"1F3C3",google:"1F3C3",twitter:"1F3C3"},shortcode:"runner",description:"RUNNER",category:"people"},{name:"dancer",unicode:{apple:"1F483",google:"1F483",twitter:"1F483"},shortcode:"dancer",description:"DANCER",category:"people"},{name:"dancers",unicode:{apple:"1F46F",google:"1F46F",twitter:"1F46F"},shortcode:"dancers",description:"WOMAN WITH BUNNY EARS",category:"people"},{name:"couple",unicode:{apple:"1F46B",google:"1F46B",twitter:"1F46B"},shortcode:"couple",description:"MAN AND WOMAN HOLDING HANDS",category:"people"},{name:"two_men_holding_hands",unicode:{apple:"1F46C",google:"1F46C",twitter:"1F46C"},shortcode:"two_men_holding_hands",description:"TWO MEN HOLDING HANDS",category:"people"},{name:"two_women_holding_hands",unicode:{apple:"1F46D",google:"1F46D",twitter:"1F46D"},shortcode:"two_women_holding_hands",description:"TWO WOMEN HOLDING HANDS",category:"people"},{name:"bow",unicode:{apple:"1F647",google:"1F647",twitter:"1F647"},shortcode:"bow",description:"PERSON BOWING DEEPLY",category:"people"},{name:"information_desk_person",unicode:{apple:"1F481",google:"1F481",twitter:"1F481"},shortcode:"information_desk_person",description:"INFORMATION DESK PERSON",category:"people"},{name:"no_good",unicode:{apple:"1F645",google:"1F645",twitter:"1F645"},shortcode:"no_good",description:"FACE WITH NO GOOD GESTURE",category:"people"},{name:"ok_woman",unicode:{apple:"1F646",google:"1F646",twitter:"1F646"},shortcode:"ok_woman",description:"FACE WITH OK GESTURE",category:"people"},{name:"raising_hand",unicode:{apple:"1F64B",google:"1F64B",twitter:"1F64B"},shortcode:"raising_hand",description:"HAPPY PERSON RAISING ONE HAND",category:"people"},{name:"person_with_pouting_face",unicode:{apple:"1F64E",google:"1F64E",twitter:"1F64E"},shortcode:"person_with_pouting_face",description:"PERSON WITH POUTING FACE",category:"people"},{name:"person_frowning",unicode:{apple:"1F64D",google:"1F64D",twitter:"1F64D"},shortcode:"person_frowning",description:"PERSON FROWNING",category:"people"},{name:"haircut",unicode:{apple:"1F487",google:"1F487",twitter:"1F487"},shortcode:"haircut",description:"HAIRCUT",category:"people"},{name:"massage",unicode:{apple:"1F486",google:"1F486",twitter:"1F486"},shortcode:"massage",description:"FACE MASSAGE",category:"people"},{name:"couple_with_heart",unicode:{apple:"1F491",google:"1F491",twitter:"1F491"},shortcode:"couple_with_heart",description:"COUPLE WITH HEART",category:"people"},{name:"couplekiss",unicode:{apple:"1F48F",google:"1F48F",twitter:"1F48F"},shortcode:"couplekiss",description:"KISS",category:"people"},{name:"family",unicode:{apple:"1F46A",google:"1F46A",twitter:"1F46A"},shortcode:"family",description:"FAMILY",category:"people"},{name:"womans_clothes",unicode:{apple:"1F45A",google:"1F45A",twitter:"1F45A"},shortcode:"womans_clothes",description:"WOMANS CLOTHES",category:"people"},{name:"shirt",unicode:{apple:"1F455",google:"1F455",twitter:"1F455"},shortcode:"shirt",description:"T-SHIRT",category:"people"},{name:"jeans",unicode:{apple:"1F456",google:"1F456",twitter:"1F456"},shortcode:"jeans",description:"JEANS",category:"people"},{name:"necktie",unicode:{apple:"1F454",google:"1F454",twitter:"1F454"},shortcode:"necktie",description:"NECKTIE",category:"people"},{name:"dress",unicode:{apple:"1F457",google:"1F457",twitter:"1F457"},shortcode:"dress",description:"DRESS",category:"people"},{name:"bikini",unicode:{apple:"1F459",google:"1F459",twitter:"1F459"},shortcode:"bikini",description:"BIKINI",category:"people"},{name:"kimono",unicode:{apple:"1F458",google:"1F458",twitter:"1F458"},shortcode:"kimono",description:"KIMONO",category:"people"},{name:"lipstick",unicode:{apple:"1F484",google:"1F484",twitter:"1F484"},shortcode:"lipstick",description:"LIPSTICK",category:"people"},{name:"kiss",unicode:{apple:"1F48B",google:"1F48B",twitter:"1F48B"},shortcode:"kiss",description:"KISS MARK",category:"people"},{name:"footprints",unicode:{apple:"1F463",google:"1F463",twitter:"1F463"},shortcode:"footprints",description:"FOOTPRINTS",category:"people"},{name:"high_heel",unicode:{apple:"1F460",google:"1F460",twitter:"1F460"},shortcode:"high_heel",description:"HIGH-HEELED SHOE",category:"people"},{name:"sandal",unicode:{apple:"1F461",google:"1F461",twitter:"1F461"},shortcode:"sandal",description:"WOMANS SANDAL",category:"people"},{name:"boot",unicode:{apple:"1F462",google:"1F462",twitter:"1F462"},shortcode:"boot",description:"WOMANS BOOTS",category:"people"},{name:"mans_shoe",unicode:{apple:"1F45E",google:"1F45E",twitter:"1F45E"},shortcode:"mans_shoe",description:"MANS SHOE",category:"people"},{name:"athletic_shoe",unicode:{apple:"1F45F",google:"1F45F",twitter:"1F45F"},shortcode:"athletic_shoe",description:"ATHLETIC SHOE",category:"people"},{name:"womans_hat",unicode:{apple:"1F452",google:"1F452",twitter:"1F452"},shortcode:"womans_hat",description:"WOMANS HAT",category:"people"},{name:"tophat",unicode:{apple:"1F3A9",google:"1F3A9",twitter:"1F3A9"},shortcode:"tophat",description:"TOP HAT",category:"people"},{name:"helmet_with_white_cross",unicode:{apple:"26D1",google:"26D1",twitter:"26D1"},shortcode:"helmet_with_white_cross",description:"Helmet With White Cross",category:"people"},{name:"mortar_board",unicode:{apple:"1F393",google:"1F393",twitter:"1F393"},shortcode:"mortar_board",description:"GRADUATION CAP",category:"people"},{name:"crown",unicode:{apple:"1F451",google:"1F451",twitter:"1F451"},shortcode:"crown",description:"CROWN",category:"people"},{name:"school_satchel",unicode:{apple:"1F392",google:"1F392",twitter:"1F392"},shortcode:"school_satchel",description:"SCHOOL SATCHEL",category:"people"},{name:"pouch",unicode:{apple:"1F45D",google:"1F45D",twitter:"1F45D"},shortcode:"pouch",description:"POUCH",category:"people"},{name:"purse",unicode:{apple:"1F45B",google:"1F45B",twitter:"1F45B"},shortcode:"purse",description:"PURSE",category:"people"},{name:"handbag",unicode:{apple:"1F45C",google:"1F45C",twitter:"1F45C"},shortcode:"handbag",description:"HANDBAG",category:"people"},{name:"briefcase",unicode:{apple:"1F4BC",google:"1F4BC",twitter:"1F4BC"},shortcode:"briefcase",description:"BRIEFCASE",category:"people"},{name:"eyeglasses",unicode:{apple:"1F453",google:"1F453",twitter:"1F453"},shortcode:"eyeglasses",description:"EYEGLASSES",category:"people"},{name:"dark_sunglasses",unicode:{apple:"1F576",google:"1F576",twitter:"1F576"},shortcode:"dark_sunglasses",description:"Dark Sunglasses",category:"people"},{name:"ring",unicode:{apple:"1F48D",google:"1F48D",twitter:"1F48D"},shortcode:"ring",description:"RING",category:"people"},{name:"closed_umbrella",unicode:{apple:"1F302",google:"1F302",twitter:"1F302"},shortcode:"closed_umbrella",description:"CLOSED UMBRELLA",category:"people"},{name:"dog",unicode:{apple:"1F436",google:"1F436",twitter:"1F436"},shortcode:"dog",description:"DOG FACE",category:"animal"},{name:"cat",unicode:{apple:"1F431",google:"1F431",twitter:"1F431"},shortcode:"cat",description:"CAT FACE",category:"animal"},{name:"mouse",unicode:{apple:"1F42D",google:"1F42D",twitter:"1F42D"},shortcode:"mouse",description:"MOUSE FACE",category:"animal"},{name:"hamster",unicode:{apple:"1F439",google:"1F439",twitter:"1F439"},shortcode:"hamster",description:"HAMSTER FACE",category:"animal"},{name:"rabbit",unicode:{apple:"1F430",google:"1F430",twitter:"1F430"},shortcode:"rabbit",description:"RABBIT FACE",category:"animal"},{name:"bear",unicode:{apple:"1F43B",google:"1F43B",twitter:"1F43B"},shortcode:"bear",description:"BEAR FACE",category:"animal"},{name:"panda_face",unicode:{apple:"1F43C",google:"1F43C",twitter:"1F43C"},shortcode:"panda_face",description:"PANDA FACE",category:"animal"},{name:"koala",unicode:{apple:"1F428",google:"1F428",twitter:"1F428"},shortcode:"koala",description:"KOALA",category:"animal"},{name:"tiger",unicode:{apple:"1F42F",google:"1F42F",twitter:"1F42F"},shortcode:"tiger",description:"TIGER FACE",category:"animal"},{name:"lion",keywords:["lion_face"],unicode:{apple:"1F981",google:"1F981",twitter:"1F981"},shortcode:"lion",description:"Lion Face",category:"animal"},{name:"cow",unicode:{apple:"1F42E",google:"1F42E",twitter:"1F42E"},shortcode:"cow",description:"COW FACE",category:"animal"},{name:"pig",unicode:{apple:"1F437",google:"1F437",twitter:"1F437"},shortcode:"pig",description:"PIG FACE",category:"animal"},{name:"pig_nose",unicode:{apple:"1F43D",google:"1F43D",twitter:"1F43D"},shortcode:"pig_nose",description:"PIG NOSE",category:"animal"},{name:"frog",unicode:{apple:"1F438",google:"1F438",twitter:"1F438"},shortcode:"frog",description:"FROG FACE",category:"animal"},{name:"octopus",unicode:{apple:"1F419",google:"1F419",twitter:"1F419"},shortcode:"octopus",description:"OCTOPUS",category:"animal"},{name:"monkey_face",unicode:{apple:"1F435",google:"1F435",twitter:"1F435"},shortcode:"monkey_face",description:"MONKEY FACE",category:"animal"},{name:"see_no_evil",unicode:{apple:"1F648",google:"1F648",twitter:"1F648"},shortcode:"see_no_evil",description:"SEE-NO-EVIL MONKEY",category:"nature"},{name:"hear_no_evil",unicode:{apple:"1F649",google:"1F649",twitter:"1F649"},shortcode:"hear_no_evil",description:"HEAR-NO-EVIL MONKEY",category:"nature"},{name:"speak_no_evil",unicode:{apple:"1F64A",google:"1F64A",twitter:"1F64A"},shortcode:"speak_no_evil",description:"SPEAK-NO-EVIL MONKEY",category:"nature"},{name:"monkey",unicode:{apple:"1F412",google:"1F412",twitter:"1F412"},shortcode:"monkey",description:"MONKEY",category:"animal"},{name:"chicken",unicode:{apple:"1F414",google:"1F414",twitter:"1F414"},shortcode:"chicken",description:"CHICKEN",category:"animal"},{name:"penguin",unicode:{apple:"1F427",google:"1F427",twitter:"1F427"},shortcode:"penguin",description:"PENGUIN",category:"animal"},{name:"bird",unicode:{apple:"1F426",google:"1F426",twitter:"1F426"},shortcode:"bird",description:"BIRD",category:"animal"},{name:"baby_chick",unicode:{apple:"1F424",google:"1F424",twitter:"1F424"},shortcode:"baby_chick",description:"BABY CHICK",category:"animal"},{name:"hatching_chick",unicode:{apple:"1F423",google:"1F423",twitter:"1F423"},shortcode:"hatching_chick",description:"HATCHING CHICK",category:"animal"},{name:"hatched_chick",unicode:{apple:"1F425",google:"1F425",twitter:"1F425"},shortcode:"hatched_chick",description:"FRONT-FACING BABY CHICK",category:"animal"},{name:"wolf",unicode:{apple:"1F43A",google:"1F43A",twitter:"1F43A"},shortcode:"wolf",description:"WOLF FACE",category:"animal"},{name:"boar",unicode:{apple:"1F417",google:"1F417",twitter:"1F417"},shortcode:"boar",description:"BOAR",category:"animal"},{name:"horse",unicode:{apple:"1F434",google:"1F434",twitter:"1F434"},shortcode:"horse",description:"HORSE FACE",category:"animal"},{name:"unicorn",unicode:{apple:"1F984",google:"1F984",twitter:"1F984"},shortcode:"unicorn",description:"Unicorn Face",category:"animal"},{name:"bee",unicode:{apple:"1F41D",google:"1F41D",twitter:"1F41D"},shortcode:"bee",description:"HONEYBEE",category:"animal"},{name:"bug",unicode:{apple:"1F41B",google:"1F41B",twitter:"1F41B"},shortcode:"bug",description:"BUG",category:"animal"},{name:"snail",unicode:{apple:"1F40C",google:"1F40C",twitter:"1F40C"},shortcode:"snail",description:"SNAIL",category:"animal"},{name:"beetle",unicode:{apple:"1F41E",google:"1F41E",twitter:"1F41E"},shortcode:"beetle",description:"LADY BEETLE",category:"animal"},{name:"ant",unicode:{apple:"1F41C",google:"1F41C",twitter:"1F41C"},shortcode:"ant",description:"ANT",category:"animal"},{name:"spider",unicode:{apple:"1F577",google:"1F577",twitter:"1F577"},shortcode:"spider",description:"Spider",category:"animal"},{name:"scorpion",unicode:{apple:"1F982",google:"1F982",twitter:"1F982"},shortcode:"scorpion",description:"Scorpion",category:"animal"},{name:"crab",unicode:{apple:"1F980",google:"1F980",twitter:"1F980"},shortcode:"crab",description:"Crab",category:"animal"},{name:"snake",unicode:{apple:"1F40D",google:"1F40D",twitter:"1F40D"},shortcode:"snake",description:"SNAKE",category:"animal"},{name:"turtle",unicode:{apple:"1F422",google:"1F422",twitter:"1F422"},shortcode:"turtle",description:"TURTLE",category:"animal"},{name:"tropical_fish",unicode:{apple:"1F420",google:"1F420",twitter:"1F420"},shortcode:"tropical_fish",description:"TROPICAL FISH",category:"animal"},{name:"fish",unicode:{apple:"1F41F",google:"1F41F",twitter:"1F41F"},shortcode:"fish",description:"FISH",category:"animal"},{name:"blowfish",unicode:{apple:"1F421",google:"1F421",twitter:"1F421"},shortcode:"blowfish",description:"BLOWFISH",category:"animal"},{name:"dolphin",unicode:{apple:"1F42C",google:"1F42C",twitter:"1F42C"},shortcode:"dolphin",description:"DOLPHIN",category:"animal"},{name:"whale",unicode:{apple:"1F433",google:"1F433",twitter:"1F433"},shortcode:"whale",description:"SPOUTING WHALE",category:"animal"},{name:"whale2",unicode:{apple:"1F40B",google:"1F40B",twitter:"1F40B"},shortcode:"whale2",description:"WHALE",category:"animal"},{name:"crocodile",unicode:{apple:"1F40A",google:"1F40A",twitter:"1F40A"},shortcode:"crocodile",description:"CROCODILE",category:"animal"},{name:"leopard",unicode:{apple:"1F406",google:"1F406",twitter:"1F406"},shortcode:"leopard",description:"LEOPARD",category:"animal"},{name:"tiger2",unicode:{apple:"1F405",google:"1F405",twitter:"1F405"},shortcode:"tiger2",description:"TIGER",category:"animal"},{name:"water_buffalo",unicode:{apple:"1F403",google:"1F403",twitter:"1F403"},shortcode:"water_buffalo",description:"WATER BUFFALO",category:"animal"},{name:"ox",unicode:{apple:"1F402",google:"1F402",twitter:"1F402"},shortcode:"ox",description:"OX",category:"animal"},{name:"cow2",unicode:{apple:"1F404",google:"1F404",twitter:"1F404"},shortcode:"cow2",description:"COW",category:"animal"},{name:"dromedary_camel",unicode:{apple:"1F42A",google:"1F42A",twitter:"1F42A"},shortcode:"dromedary_camel",description:"DROMEDARY CAMEL",category:"animal"},{name:"camel",unicode:{apple:"1F42B",google:"1F42B",twitter:"1F42B"},shortcode:"camel",description:"BACTRIAN CAMEL",category:"animal"},{name:"elephant",unicode:{apple:"1F418",google:"1F418",twitter:"1F418"},shortcode:"elephant",description:"ELEPHANT",category:"animal"},{name:"goat",unicode:{apple:"1F410",google:"1F410",twitter:"1F410"
},shortcode:"goat",description:"GOAT",category:"animal"},{name:"ram",unicode:{apple:"1F40F",google:"1F40F",twitter:"1F40F"},shortcode:"ram",description:"RAM",category:"animal"},{name:"sheep",unicode:{apple:"1F411",google:"1F411",twitter:"1F411"},shortcode:"sheep",description:"SHEEP",category:"animal"},{name:"racehorse",unicode:{apple:"1F40E",google:"1F40E",twitter:"1F40E"},shortcode:"racehorse",description:"HORSE",category:"animal"},{name:"pig2",unicode:{apple:"1F416",google:"1F416",twitter:"1F416"},shortcode:"pig2",description:"PIG",category:"animal"},{name:"rat",unicode:{apple:"1F400",google:"1F400",twitter:"1F400"},shortcode:"rat",description:"RAT",category:"animal"},{name:"mouse2",unicode:{apple:"1F401",google:"1F401",twitter:"1F401"},shortcode:"mouse2",description:"MOUSE",category:"animal"},{name:"rooster",unicode:{apple:"1F413",google:"1F413",twitter:"1F413"},shortcode:"rooster",description:"ROOSTER",category:"animal"},{name:"turkey",unicode:{apple:"1F983",google:"1F983",twitter:"1F983"},shortcode:"turkey",description:"Turkey",category:"animal"},{name:"dove_of_peace",unicode:{apple:"1F54A",google:"1F54A",twitter:"1F54A"},shortcode:"dove_of_peace",description:"Dove Of Peace",category:"animal"},{name:"dog2",unicode:{apple:"1F415",google:"1F415",twitter:"1F415"},shortcode:"dog2",description:"DOG",category:"animal"},{name:"poodle",unicode:{apple:"1F429",google:"1F429",twitter:"1F429"},shortcode:"poodle",description:"POODLE",category:"animal"},{name:"cat2",unicode:{apple:"1F408",google:"1F408",twitter:"1F408"},shortcode:"cat2",description:"CAT",category:"animal"},{name:"rabbit2",unicode:{apple:"1F407",google:"1F407",twitter:"1F407"},shortcode:"rabbit2",description:"RABBIT",category:"animal"},{name:"chipmunk",unicode:{apple:"1F43F",google:"1F43F",twitter:"1F43F"},shortcode:"chipmunk",description:"Chipmunk",category:"animal"},{name:"feet",unicode:{apple:"1F43E",google:"1F43E",twitter:"1F43E"},shortcode:"feet",description:"PAW PRINTS",category:"animal"},{name:"dragon",unicode:{apple:"1F409",google:"1F409",twitter:"1F409"},shortcode:"dragon",description:"DRAGON",category:"animal"},{name:"dragon_face",unicode:{apple:"1F432",google:"1F432",twitter:"1F432"},shortcode:"dragon_face",description:"DRAGON FACE",category:"animal"},{name:"cactus",unicode:{apple:"1F335",google:"1F335",twitter:"1F335"},shortcode:"cactus",description:"CACTUS",category:"animal"},{name:"christmas_tree",unicode:{apple:"1F384",google:"1F384",twitter:"1F384"},shortcode:"christmas_tree",description:"CHRISTMAS TREE",category:"nature"},{name:"evergreen_tree",unicode:{apple:"1F332",google:"1F332",twitter:"1F332"},shortcode:"evergreen_tree",description:"EVERGREEN TREE",category:"nature"},{name:"deciduous_tree",unicode:{apple:"1F333",google:"1F333",twitter:"1F333"},shortcode:"deciduous_tree",description:"DECIDUOUS TREE",category:"nature"},{name:"palm_tree",unicode:{apple:"1F334",google:"1F334",twitter:"1F334"},shortcode:"palm_tree",description:"PALM TREE",category:"nature"},{name:"seedling",unicode:{apple:"1F331",google:"1F331",twitter:"1F331"},shortcode:"seedling",description:"SEEDLING",category:"nature"},{name:"herb",unicode:{apple:"1F33F",google:"1F33F",twitter:"1F33F"},shortcode:"herb",description:"HERB",category:"nature"},{name:"shamrock",unicode:{apple:"2618",google:"2618",twitter:"2618"},shortcode:"shamrock",description:"Shamrock",category:"nature"},{name:"four_leaf_clover",unicode:{apple:"1F340",google:"1F340",twitter:"1F340"},shortcode:"four_leaf_clover",description:"FOUR LEAF CLOVER",category:"nature"},{name:"bamboo",unicode:{apple:"1F38D",google:"1F38D",twitter:"1F38D"},shortcode:"bamboo",description:"PINE DECORATION",category:"nature"},{name:"tanabata_tree",unicode:{apple:"1F38B",google:"1F38B",twitter:"1F38B"},shortcode:"tanabata_tree",description:"TANABATA TREE",category:"nature"},{name:"leaves",unicode:{apple:"1F343",google:"1F343",twitter:"1F343"},shortcode:"leaves",description:"LEAF FLUTTERING IN WIND",category:"nature"},{name:"fallen_leaf",unicode:{apple:"1F342",google:"1F342",twitter:"1F342"},shortcode:"fallen_leaf",description:"FALLEN LEAF",category:"nature"},{name:"maple_leaf",unicode:{apple:"1F341",google:"1F341",twitter:"1F341"},shortcode:"maple_leaf",description:"MAPLE LEAF",category:"nature"},{name:"ear_of_rice",unicode:{apple:"1F33E",google:"1F33E",twitter:"1F33E"},shortcode:"ear_of_rice",description:"EAR OF RICE",category:"nature"},{name:"hibiscus",unicode:{apple:"1F33A",google:"1F33A",twitter:"1F33A"},shortcode:"hibiscus",description:"HIBISCUS",category:"nature"},{name:"sunflower",unicode:{apple:"1F33B",google:"1F33B",twitter:"1F33B"},shortcode:"sunflower",description:"SUNFLOWER",category:"nature"},{name:"rose",unicode:{apple:"1F339",google:"1F339",twitter:"1F339"},shortcode:"rose",description:"ROSE",category:"nature"},{name:"tulip",unicode:{apple:"1F337",google:"1F337",twitter:"1F337"},shortcode:"tulip",description:"TULIP",category:"nature"},{name:"blossom",unicode:{apple:"1F33C",google:"1F33C",twitter:"1F33C"},shortcode:"blossom",description:"BLOSSOM",category:"nature"},{name:"cherry_blossom",unicode:{apple:"1F338",google:"1F338",twitter:"1F338"},shortcode:"cherry_blossom",description:"CHERRY BLOSSOM",category:"nature"},{name:"bouquet",unicode:{apple:"1F490",google:"1F490",twitter:"1F490"},shortcode:"bouquet",description:"BOUQUET",category:"nature"},{name:"mushroom",unicode:{apple:"1F344",google:"1F344",twitter:"1F344"},shortcode:"mushroom",description:"MUSHROOM",category:"nature"},{name:"chestnut",unicode:{apple:"1F330",google:"1F330",twitter:"1F330"},shortcode:"chestnut",description:"CHESTNUT",category:"nature"},{name:"jack_o_lantern",unicode:{apple:"1F383",google:"1F383",twitter:"1F383"},shortcode:"jack_o_lantern",description:"JACK-O-LANTERN",category:"nature"},{name:"shell",unicode:{apple:"1F41A",google:"1F41A",twitter:"1F41A"},shortcode:"shell",description:"SPIRAL SHELL",category:"nature"},{name:"spider_web",unicode:{apple:"1F578",google:"1F578",twitter:"1F578"},shortcode:"spider_web",description:"Spider Web",category:"nature"},{name:"earth_americas",unicode:{apple:"1F30E",google:"1F30E",twitter:"1F30E"},shortcode:"earth_americas",description:"EARTH GLOBE AMERICAS",category:"nature"},{name:"earth_africa",unicode:{apple:"1F30D",google:"1F30D",twitter:"1F30D"},shortcode:"earth_africa",description:"EARTH GLOBE EUROPE-AFRICA",category:"nature"},{name:"earth_asia",unicode:{apple:"1F30F",google:"1F30F",twitter:"1F30F"},shortcode:"earth_asia",description:"EARTH GLOBE ASIA-AUSTRALIA",category:"nature"},{name:"full_moon",unicode:{apple:"1F315",google:"1F315",twitter:"1F315"},shortcode:"full_moon",description:"FULL MOON SYMBOL",category:"nature"},{name:"waning_gibbous_moon",unicode:{apple:"1F316",google:"1F316",twitter:"1F316"},shortcode:"waning_gibbous_moon",description:"WANING GIBBOUS MOON SYMBOL",category:"nature"},{name:"last_quarter_moon",unicode:{apple:"1F317",google:"1F317",twitter:"1F317"},shortcode:"last_quarter_moon",description:"LAST QUARTER MOON SYMBOL",category:"nature"},{name:"waning_crescent_moon",unicode:{apple:"1F318",google:"1F318",twitter:"1F318"},shortcode:"waning_crescent_moon",description:"WANING CRESCENT MOON SYMBOL",category:"nature"},{name:"new_moon",unicode:{apple:"1F311",google:"1F311",twitter:"1F311"},shortcode:"new_moon",description:"NEW MOON SYMBOL",category:"nature"},{name:"waxing_crescent_moon",unicode:{apple:"1F312",google:"1F312",twitter:"1F312"},shortcode:"waxing_crescent_moon",description:"WAXING CRESCENT MOON SYMBOL",category:"nature"},{name:"first_quarter_moon",unicode:{apple:"1F313",google:"1F313",twitter:"1F313"},shortcode:"first_quarter_moon",description:"FIRST QUARTER MOON SYMBOL",category:"nature"},{name:"moon",unicode:{apple:"1F314",google:"1F314",twitter:"1F314"},shortcode:"moon",description:"WAXING GIBBOUS MOON SYMBOL",category:"nature"},{name:"new_moon_with_face",unicode:{apple:"",google:"1F31A",twitter:"1F31A"},shortcode:"new_moon_with_face",description:"NEW MOON WITH FACE",category:"nature"},{name:"first_quarter_moon_with_face",unicode:{apple:"1F31B",google:"1F31B",twitter:"1F31B"},shortcode:"first_quarter_moon_with_face",description:"FIRST QUARTER MOON WITH FACE",category:"nature"},{name:"last_quarter_moon_with_face",unicode:{apple:"1F31C",google:"1F31C",twitter:"1F31C"},shortcode:"last_quarter_moon_with_face",description:"LAST QUARTER MOON WITH FACE",category:"nature"},{name:"full_moon_with_face",unicode:{apple:"1F31D",google:"1F31D",twitter:"1F31D"},shortcode:"full_moon_with_face",description:"FULL MOON WITH FACE",category:"nature"},{name:"crescent_moon",unicode:{apple:"1F319",google:"1F319",twitter:"1F319"},shortcode:"crescent_moon",description:"CRESCENT MOON",category:"nature"},{name:"sun_with_face",unicode:{apple:"1F31E",google:"1F31E",twitter:"1F31E"},shortcode:"sun_with_face",description:"SUN WITH FACE",category:"nature"},{name:"star",unicode:{apple:"2B50",google:"2B50",twitter:"2B50"},shortcode:"star",description:"WHITE MEDIUM STAR",category:"nature"},{name:"star2",unicode:{apple:"1F31F",google:"1F31F",twitter:"1F31F"},shortcode:"star2",description:"GLOWING STAR",category:"nature"},{name:"dizzy",unicode:{apple:"1F4AB",google:"1F4AB",twitter:"1F4AB"},shortcode:"dizzy",description:"DIZZY SYMBOL",category:"nature"},{name:"sparkles",unicode:{apple:"2728",google:"2728",twitter:"2728"},shortcode:"sparkles",description:"SPARKLES",category:"nature"},{name:"comet",unicode:{apple:"2604",google:"2604",twitter:"2604"},shortcode:"comet",description:"Comet",category:"nature"},{name:"sunny",unicode:{apple:"2600",google:"2600",twitter:"2600"},shortcode:"sunny",description:"BLACK SUN WITH RAYS",category:"nature"},{name:"mostly_sunny",unicode:{apple:"1F324",google:"1F324",twitter:"1F324"},shortcode:"mostly_sunny",description:"White Sun With Small Cloud",category:"nature"},{name:"partly_sunny",unicode:{apple:"26C5",google:"26C5",twitter:"26C5"},shortcode:"partly_sunny",description:"SUN BEHIND CLOUD",category:"nature"},{name:"barely_sunny",unicode:{apple:"1F325",google:"1F325",twitter:"1F325"},shortcode:"barely_sunny",description:"White Sun Behind Cloud",category:"nature"},{name:"partly_sunny_rain",unicode:{apple:"1F326",google:"1F326",twitter:"1F326"},shortcode:"partly_sunny_rain",description:"White Sun Behind Cloud With Rain",category:"nature"},{name:"cloud",unicode:{apple:"2601",google:"2601",twitter:"2601"},shortcode:"cloud",description:"CLOUD",category:"nature"},{name:"rain_cloud",unicode:{apple:"1F327",google:"1F327",twitter:"1F327"},shortcode:"rain_cloud",description:"Cloud With Rain",category:"nature"},{name:"thunder_cloud_and_rain",unicode:{apple:"26C8",google:"26C8",twitter:"26C8"},shortcode:"thunder_cloud_and_rain",description:"Thunder Cloud and Rain",category:"nature"},{name:"lightning",unicode:{apple:"1F329",google:"1F329",twitter:"1F329"},shortcode:"lightning",description:"Cloud With Lightning",category:"nature"},{name:"zap",unicode:{apple:"26A1",google:"26A1",twitter:"26A1"},shortcode:"zap",description:"HIGH VOLTAGE SIGN",category:"nature"},{name:"fire",unicode:{apple:"1F525",google:"1F525",twitter:"1F525"},shortcode:"fire",description:"FIRE",category:"nature"},{name:"boom",unicode:{apple:"1F4A5",google:"1F4A5",twitter:"1F4A5"},shortcode:"boom",description:"COLLISION SYMBOL",category:"nature"},{name:"snowflake",unicode:{apple:"2744",google:"2744",twitter:"2744"},shortcode:"snowflake",description:"SNOWFLAKE",category:"nature"},{name:"snow_cloud",unicode:{apple:"1F328",google:"1F328",twitter:"1F328"},shortcode:"snow_cloud",description:"Cloud With Snow",category:"nature"},{name:"snowman",unicode:{apple:"26C4",google:"26C4",twitter:"26C4"},shortcode:"snowman",description:"SNOWMAN WITHOUT SNOW",category:"nature"},{name:"wind_blowing_face",unicode:{apple:"1F32C",google:"1F32C",twitter:"1F32C"},shortcode:"wind_blowing_face",description:"Wind Blowing Face",category:"nature"},{name:"dash",unicode:{apple:"1F4A8",google:"1F4A8",twitter:"1F4A8"},shortcode:"dash",description:"DASH SYMBOL",category:"nature"},{name:"tornado",unicode:{apple:"1F32A",google:"1F32A",twitter:"1F32A"},shortcode:"tornado",description:"Cloud With Tornado",category:"nature"},{name:"fog",unicode:{apple:"1F32B",google:"1F32B",twitter:"1F32B"},shortcode:"fog",description:"Fog",category:"nature"},{name:"umbrella",unicode:{apple:"2614",google:"2614",twitter:"2614"},shortcode:"umbrella",description:"UMBRELLA WITH RAIN DROPS",category:"nature"},{name:"droplet",unicode:{apple:"1F4A7",google:"1F4A7",twitter:"1F4A7"},shortcode:"droplet",description:"DROPLET",category:"nature"},{name:"sweat_drops",unicode:{apple:"1F4A6",google:"1F4A6",twitter:"1F4A6"},shortcode:"sweat_drops",description:"SPLASHING SWEAT SYMBOL",category:"nature"},{name:"ocean",unicode:{apple:"1F30A",google:"1F30A",twitter:"1F30A"},shortcode:"ocean",description:"WATER WAVE",category:"nature"},{name:"green_apple",unicode:{apple:"1F34F",google:"1F34F",twitter:"1F34F"},shortcode:"green_apple",description:"GREEN APPLE",category:"food"},{name:"apple",unicode:{apple:"1F34E",google:"1F34E",twitter:"1F34E"},shortcode:"apple",description:"RED APPLE",category:"food"},{name:"pear",unicode:{apple:"1F350",google:"1F350",twitter:"1F350"},shortcode:"pear",description:"PEAR",category:"food"},{name:"tangerine",unicode:{apple:"1F34A",google:"1F34A",twitter:"1F34A"},shortcode:"tangerine",description:"TANGERINE",category:"food"},{name:"lemon",unicode:{apple:"1F34B",google:"1F34B",twitter:"1F34B"},shortcode:"lemon",description:"LEMON",category:"food"},{name:"banana",unicode:{apple:"1F34C",google:"1F34C",twitter:"1F34C"},shortcode:"banana",description:"BANANA",category:"food"},{name:"watermelon",unicode:{apple:"1F349",google:"1F349",twitter:"1F349"},shortcode:"watermelon",description:"WATERMELON",category:"food"},{name:"grapes",unicode:{apple:"1F347",google:"1F347",twitter:"1F347"},shortcode:"grapes",description:"GRAPES",category:"food"},{name:"strawberry",unicode:{apple:"1F353",google:"1F353",twitter:"1F353"},shortcode:"strawberry",description:"STRAWBERRY",category:"food"},{name:"melon",unicode:{apple:"1F348",google:"1F348",twitter:"1F348"},shortcode:"melon",description:"MELON",category:"food"},{name:"cherries",unicode:{apple:"1F352",google:"1F352",twitter:"1F352"},shortcode:"cherries",description:"CHERRIES",category:"food"},{name:"peach",unicode:{apple:"1F351",google:"1F351",twitter:"1F351"},shortcode:"peach",description:"PEACH",category:"food"},{name:"pineapple",unicode:{apple:"1F34D",google:"1F34D",twitter:"1F34D"},shortcode:"pineapple",description:"PINEAPPLE",category:"food"},{name:"tomato",unicode:{apple:"1F345",google:"1F345",twitter:"1F345"},shortcode:"tomato",description:"TOMATO",category:"food"},{name:"eggplant",unicode:{apple:"1F346",google:"1F346",twitter:"1F346"},shortcode:"eggplant",description:"AUBERGINE",category:"food"},{name:"hot_pepper",unicode:{apple:"1F336",google:"1F336",twitter:"1F336"},shortcode:"hot_pepper",description:"Hot Pepper",category:"food"},{name:"corn",unicode:{apple:"1F33D",google:"1F33D",twitter:"1F33D"},shortcode:"corn",description:"EAR OF MAIZE",category:"thing"},{name:"sweet_potato",unicode:{apple:"1F360",google:"1F360",twitter:"1F360"},shortcode:"sweet_potato",description:"ROASTED SWEET POTATO",category:"food"},{name:"honey_pot",unicode:{apple:"1F36F",google:"1F36F",twitter:"1F36F"},shortcode:"honey_pot",description:"HONEY POT",category:"food"},{name:"bread",unicode:{apple:"1F35E",google:"1F35E",twitter:"1F35E"},shortcode:"bread",description:"BREAD",category:"food"},{name:"cheese_wedge",unicode:{apple:"1F9C0",google:"1F9C0",twitter:"1F9C0"},shortcode:"cheese_wedge",description:"Cheese Wedge",category:"food"},{name:"poultry_leg",unicode:{apple:"1F357",google:"1F357",twitter:"1F357"},shortcode:"poultry_leg",description:"POULTRY LEG",category:"food"},{name:"meat_on_bone",unicode:{apple:"1F356",google:"1F356",twitter:"1F356"},shortcode:"meat_on_bone",description:"MEAT ON BONE",category:"food"},{name:"fried_shrimp",unicode:{apple:"1F364",google:"1F364",twitter:"1F364"},shortcode:"fried_shrimp",description:"FRIED SHRIMP",category:"food"},{name:"egg",unicode:{apple:"1F373",google:"1F373",twitter:"1F373"},shortcode:"egg",description:"COOKING",category:"food"},{name:"hamburger",unicode:{apple:"1F354",google:"1F354",twitter:"1F354"},shortcode:"hamburger",description:"HAMBURGER",category:"food"},{name:"fries",unicode:{apple:"1F35F",google:"1F35F",twitter:"1F35F"},shortcode:"fries",description:"FRENCH FRIES",category:"food"},{name:"hotdog",unicode:{apple:"1F32D",google:"1F32D",twitter:"1F32D"},shortcode:"hotdog",description:"Hot Dog",category:"food"},{name:"pizza",unicode:{apple:"1F355",google:"1F355",twitter:"1F355"},shortcode:"pizza",description:"SLICE OF PIZZA",category:"food"},{name:"spaghetti",unicode:{apple:"1F35D",google:"1F35D",twitter:"1F35D"},shortcode:"spaghetti",description:"SPAGHETTI",category:"food"},{name:"taco",unicode:{apple:"1F32E",google:"1F32E",twitter:"1F32E"},shortcode:"taco",description:"Taco",category:"food"},{name:"burrito",unicode:{apple:"1F32F",google:"1F32F",twitter:"1F32F"},shortcode:"burrito",description:"Burrito",category:"food"},{name:"ramen",unicode:{apple:"1F35C",google:"1F35C",twitter:"1F35C"},shortcode:"ramen",description:"STEAMING BOWL",category:"food"},{name:"stew",unicode:{apple:"1F372",google:"1F372",twitter:"1F372"},shortcode:"stew",description:"POT OF FOOD",category:"food"},{name:"fish_cake",unicode:{apple:"1F365",google:"1F365",twitter:"1F365"},shortcode:"fish_cake",description:"FISH CAKE WITH SWIRL DESIGN",category:"food"},{name:"sushi",unicode:{apple:"1F363",google:"1F363",twitter:"1F363"},shortcode:"sushi",description:"SUSHI",category:"food"},{name:"bento",unicode:{apple:"1F371",google:"1F371",twitter:"1F371"},shortcode:"bento",description:"BENTO BOX",category:"food"},{name:"curry",unicode:{apple:"1F35B",google:"1F35B",twitter:"1F35B"},shortcode:"curry",description:"CURRY AND RICE",category:"food"},{name:"rice_ball",unicode:{apple:"1F359",google:"1F359",twitter:"1F359"},shortcode:"rice_ball",description:"RICE BALL",category:"food"},{name:"rice",unicode:{apple:"1F35A",google:"1F35A",twitter:"1F35A"},shortcode:"rice",description:"COOKED RICE",category:"food"},{name:"rice_cracker",unicode:{apple:"1F358",google:"1F358",twitter:"1F358"},shortcode:"rice_cracker",description:"RICE CRACKER",category:"food"},{name:"oden",unicode:{apple:"1F362",google:"1F362",twitter:"1F362"},shortcode:"oden",description:"ODEN",category:"food"},{name:"dango",unicode:{apple:"1F361",google:"1F361",twitter:"1F361"},shortcode:"dango",description:"DANGO",category:"food"},{name:"shaved_ice",unicode:{apple:"1F367",google:"1F367",twitter:"1F367"},shortcode:"shaved_ice",description:"SHAVED ICE",category:"food"},{name:"ice_cream",unicode:{apple:"1F368",google:"1F368",twitter:"1F368"},shortcode:"ice_cream",description:"ICE CREAM",category:"food"},{name:"icecream",unicode:{apple:"1F366",google:"1F366",twitter:"1F366"},shortcode:"icecream",description:"SOFT ICE CREAM",category:"food"},{name:"cake",unicode:{apple:"1F370",google:"1F370",twitter:"1F370"},shortcode:"cake",description:"SHORTCAKE",category:"food"},{name:"birthday",unicode:{apple:"1F382",google:"1F382",twitter:"1F382"},shortcode:"birthday",description:"BIRTHDAY CAKE",category:"food"},{name:"custard",unicode:{apple:"1F36E",google:"1F36E",twitter:"1F36E"},shortcode:"custard",description:"CUSTARD",category:"food"},{name:"candy",unicode:{apple:"1F36C",google:"1F36C",twitter:"1F36C"},shortcode:"candy",description:"CANDY",category:"food"},{name:"lollipop",unicode:{apple:"1F36D",google:"1F36D",twitter:"1F36D"},shortcode:"lollipop",description:"LOLLIPOP",category:"food"},{name:"chocolate_bar",unicode:{apple:"1F36B",google:"1F36B",twitter:"1F36B"},shortcode:"chocolate_bar",description:"CHOCOLATE BAR",category:"food"},{name:"popcorn",unicode:{apple:"1F37F",google:"1F37F",twitter:"1F37F"},shortcode:"popcorn",description:"Popcorn",category:"food"},{name:"cookie",unicode:{apple:"1F36A",google:"1F36A",twitter:"1F36A"},shortcode:"cookie",description:"COOKIE",category:"food"},{name:"doughnut",unicode:{apple:"1F369",google:"1F369",twitter:"1F369"},shortcode:"doughnut",description:"DOUGHNUT",category:"food"},{name:"beer",unicode:{apple:"1F37A",google:"1F37A",twitter:"1F37A"},shortcode:"beer",description:"BEER MUG",category:"food"},{name:"beers",unicode:{apple:"1F37B",google:"1F37B",twitter:"1F37B"},shortcode:"beers",description:"CLINKING BEER MUGS",category:"food"},{name:"wine_glass",unicode:{apple:"1F377",google:"1F377",twitter:"1F377"},shortcode:"wine_glass",description:"WINE GLASS",category:"food"},{name:"cocktail",unicode:{apple:"1F378",google:"1F378",twitter:"1F378"},shortcode:"cocktail",description:"COCKTAIL GLASS",category:"food"},{name:"champagne",unicode:{apple:"1F379",google:"1F379",twitter:"1F379"},shortcode:"tropical_drink",description:"TROPICAL DRINK",category:"food"},{name:"champagne",unicode:{apple:"1F37E",google:"1F37E",twitter:"1F37E"},shortcode:"champagne",description:"Bottle With Popping Cork",category:"food"},{name:"sake",unicode:{apple:"1F376",google:"1F376",twitter:"1F376"},shortcode:"sake",description:"SAKE BOTTLE AND CUP",category:"food"},{name:"tea",unicode:{apple:"1F375",google:"1F375",twitter:"1F375"},shortcode:"tea",description:"TEACUP WITHOUT HANDLE",category:"food"},{name:"coffee",unicode:{apple:"2615",google:"2615",twitter:"2615"},shortcode:"coffee",description:"HOT BEVERAGE",category:"food"},{name:"baby_bottle",unicode:{apple:"1F37C",google:"1F37C",twitter:"1F37C"},shortcode:"baby_bottle",description:"BABY BOTTLE",category:"food"},{name:"fork_and_knife",unicode:{apple:"1F374",google:"1F374",twitter:"1F374"},shortcode:"fork_and_knife",description:"FORK AND KNIFE",category:"food"},{name:"knife_fork_plate",unicode:{apple:"1F37D",google:"1F37D",twitter:"1F37D"},shortcode:"knife_fork_plate",description:"Fork and Knife With Plate",category:"food"},{name:"soccer",unicode:{apple:"26BD",google:"26BD",twitter:"26BD"},shortcode:"soccer",description:"SOCCER BALL",category:"activity"},{name:"basketball",unicode:{apple:"1F3C0",google:"1F3C0",twitter:"1F3C0"},shortcode:"basketball",description:"BASKETBALL AND HOOP",category:"activity"},{name:"football",unicode:{apple:"1F3C8",google:"1F3C8",twitter:"1F3C8"},shortcode:"football",description:"AMERICAN FOOTBALL",category:"activity"},{name:"baseball",unicode:{apple:"26BE",google:"26BE",twitter:"26BE"},shortcode:"baseball",description:"BASEBALL",category:"activity"},{name:"tennis",unicode:{apple:"1F3BE",google:"1F3BE",twitter:"1F3BE"},shortcode:"tennis",description:"TENNIS RACQUET AND BALL",category:"activity"},{name:"volleyball",unicode:{apple:"1F3D0",google:"1F3D0",twitter:"1F3D0"},shortcode:"volleyball",description:"Volleyball",category:"activity"},{name:"rugby_football",unicode:{apple:"1F3C9",google:"1F3C9",twitter:"1F3C9"},shortcode:"rugby_football",description:"RUGBY FOOTBALL",category:"activity"},{name:"8ball",unicode:{apple:"1F3B1",google:"1F3B1",twitter:"1F3B1"},shortcode:"8ball",description:"BILLIARDS",category:"activity"},{name:"golf",unicode:{apple:"26F3",google:"26F3",twitter:"26F3"},shortcode:"golf",description:"FLAG IN HOLE",category:"activity"},{name:"golfer",unicode:{apple:"1F3CC",google:"1F3CC",twitter:"1F3CC"},shortcode:"golfer",description:"Golfer",category:"activity"},{name:"table_tennis_paddle_and_ball",unicode:{apple:"1F3D3",google:"1F3D3",twitter:"1F3D3"},shortcode:"table_tennis_paddle_and_ball",description:"Table Tennis Paddle and Ball",category:"activity"},{name:"badminton_racquet_and_shuttlecock",unicode:{apple:"1F3F8",google:"1F3F8",twitter:"1F3F8"},shortcode:"badminton_racquet_and_shuttlecock",description:"Badminton Racquet and Shuttlecock",category:"activity"},{name:"ice_hockey_stick_and_puck",unicode:{apple:"1F3D2",google:"1F3D2",twitter:"1F3D2"},shortcode:"ice_hockey_stick_and_puck",description:"Ice Hockey Stick and Puck",category:"activity"},{name:"field_hockey_stick_and_ball",unicode:{apple:"1F3D1",google:"1F3D1",twitter:"1F3D1"},shortcode:"field_hockey_stick_and_ball",description:"Field Hockey Stick and Ball",category:"activity"},{name:"cricket_bat_and_ball",unicode:{apple:"1F3CF",google:"1F3CF",twitter:"1F3CF"},shortcode:"cricket_bat_and_ball",description:"Cricket Bat and Ball",category:"activity"},{name:"ski",unicode:{apple:"1F3BF",google:"1F3BF",twitter:"1F3BF"},shortcode:"ski",description:"SKI AND SKI BOOT",category:"activity"},{name:"skier",unicode:{apple:"26F7",google:"26F7",twitter:"26F7"},shortcode:"skier",description:"Skier",category:"activity"},{name:"snowboarder",unicode:{apple:"1F3C2",google:"1F3C2",twitter:"1F3C2"},shortcode:"snowboarder",description:"SNOWBOARDER",category:"activity"},{name:"ice_skate",unicode:{apple:"26F8",google:"26F8",twitter:"26F8"},shortcode:"ice_skate",description:"Ice Skate",category:"activity"},{name:"bow_and_arrow",unicode:{apple:"1F3F9",google:"1F3F9",twitter:"1F3F9"},shortcode:"bow_and_arrow",description:"Bow and Arrow",category:"activity"},{name:"fishing_pole_and_fish",unicode:{apple:"1F3A3",google:"1F3A3",twitter:"1F3A3"},shortcode:"fishing_pole_and_fish",description:"FISHING POLE AND FISH",category:"activity"},{name:"rowboat",unicode:{apple:"1F6A3",google:"1F6A3",twitter:"1F6A3"},shortcode:"rowboat",description:"ROWBOAT",category:"activity"},{name:"swimmer",unicode:{apple:"1F3CA",google:"1F3CA",twitter:"1F3CA"},shortcode:"swimmer",description:"SWIMMER",category:"activity"},{name:"surfer",unicode:{apple:"1F3C4",google:"1F3C4",twitter:"1F3C4"},shortcode:"surfer",description:"SURFER",category:"activity"},{name:"bath",unicode:{apple:"1F6C0",google:"1F6C0",twitter:"1F6C0"},shortcode:"bath",description:"BATH",category:"activity"},{name:"person_with_ball",unicode:{apple:"26F9",google:"26F9",twitter:"26F9"},shortcode:"person_with_ball",description:"Person With Ball",category:"activity"},{name:"weight_lifter",unicode:{apple:"1F3CB",google:"1F3CB",twitter:"1F3CB"},shortcode:"weight_lifter",description:"Weight Lifter",category:"activity"},{name:"bicyclist",unicode:{apple:"1F6B4",google:"1F6B4",twitter:"1F6B4"},shortcode:"bicyclist",description:"BICYCLIST",category:"activity"},{name:"mountain_bicyclist",unicode:{apple:"1F6B5",google:"1F6B5",twitter:"1F6B5"},shortcode:"mountain_bicyclist",description:"MOUNTAIN BICYCLIST",category:"activity"},{name:"horse_racing",unicode:{apple:"1F3C7",google:"1F3C7",twitter:"1F3C7"},shortcode:"horse_racing",description:"HORSE RACING",category:"activity"},{name:"man_in_business_suit_levitating",unicode:{apple:"1F574",google:"1F574",twitter:"1F574"},shortcode:"man_in_business_suit_levitating",description:"Man in Business Suit Levitating",category:"activity"},{name:"trophy",unicode:{apple:"1F3C6",google:"1F3C6",twitter:"1F3C6"},shortcode:"trophy",description:"TROPHY",category:"activity"},{name:"running_shirt_with_sash",unicode:{apple:"1F3BD",google:"1F3BD",twitter:"1F3BD"},shortcode:"running_shirt_with_sash",description:"RUNNING SHIRT WITH SASH",category:"activity"},{name:"sports_medal",unicode:{apple:"1F3C5",google:"1F3C5",twitter:"1F3C5"},shortcode:"sports_medal",description:"Sports Medal",category:"activity"},{name:"medal",unicode:{apple:"1F396",google:"1F396",twitter:"1F396"},shortcode:"medal",description:"Military Medal",category:"activity"},{name:"reminder_ribbon",unicode:{apple:"1F397",google:"1F397",twitter:"1F397"},shortcode:"reminder_ribbon",description:"Reminder Ribbon",category:"activity"},{name:"rosette",unicode:{apple:"1F3F5",google:"1F3F5",twitter:"1F3F5"},shortcode:"rosette",description:"Rosette",category:"activity"},{name:"ticket",unicode:{apple:"1F3AB",google:"1F3AB",twitter:"1F3AB"},shortcode:"ticket",description:"TICKET",category:"activity"},{name:"admission_tickets",unicode:{apple:"1F39F",google:"1F39F",twitter:"1F39F"},shortcode:"admission_tickets",description:"Admission Tickets",category:"activity"},{name:"performing_arts",unicode:{apple:"1F3AD",google:"1F3AD",twitter:"1F3AD"},shortcode:"performing_arts",description:"PERFORMING ARTS",category:"activity"},{name:"art",unicode:{apple:"1F3A8",google:"1F3A8",twitter:"1F3A8"},shortcode:"art",description:"ARTIST PALETTE",category:"activity"},{name:"circus_tent",unicode:{apple:"1F3AA",google:"1F3AA",twitter:"1F3AA"},shortcode:"circus_tent",description:"CIRCUS TENT",category:"activity"},{name:"microphone",unicode:{apple:"1F3A4",google:"1F3A4",twitter:"1F3A4"},shortcode:"microphone",description:"MICROPHONE",category:"activity"},{name:"headphones",unicode:{apple:"1F3A7",google:"1F3A7",twitter:"1F3A7"},shortcode:"headphones",description:"HEADPHONE",category:"activity"},{name:"musical_score",unicode:{apple:"1F3BC",google:"1F3BC",twitter:"1F3BC"},shortcode:"musical_score",description:"MUSICAL SCORE",category:"activity"},{name:"musical_keyboard",unicode:{apple:"1F3B9",google:"1F3B9",twitter:"1F3B9"},shortcode:"musical_keyboard",description:"MUSICAL KEYBOARD",category:"activity"},{name:"saxophone",unicode:{apple:"1F3B7",google:"1F3B7",twitter:"1F3B7"},shortcode:"saxophone",description:"SAXOPHONE",category:"activity"},{name:"trumpet",unicode:{apple:"1F3BA",google:"1F3BA",twitter:"1F3BA"},shortcode:"trumpet",description:"TRUMPET",category:"activity"},{name:"guitar",unicode:{apple:"1F3B8",google:"1F3B8",twitter:"1F3B8"},shortcode:"guitar",description:"GUITAR",category:"activity"},{name:"violin",unicode:{apple:"1F3BB",google:"1F3BB",twitter:"1F3BB"},shortcode:"violin",description:"VIOLIN",category:"activity"},{name:"clapper",unicode:{apple:"1F3AC",google:"1F3AC",twitter:"1F3AC"},shortcode:"clapper",description:"CLAPPER BOARD",category:"activity"},{name:"video_game",unicode:{apple:"1F3AE",google:"1F3AE",twitter:"1F3AE"},shortcode:"video_game",description:"VIDEO GAME",category:"activity"},{name:"space_invader",unicode:{apple:"1F47E",google:"1F47E",twitter:"1F47E"},shortcode:"space_invader",description:"ALIEN MONSTER",category:"activity"},{name:"dart",unicode:{apple:"1F3AF",google:"1F3AF",twitter:"1F3AF"},shortcode:"dart",description:"DIRECT HIT",category:"activity"},{name:"game_die",unicode:{apple:"1F3B2",google:"1F3B2",twitter:"1F3B2"},shortcode:"game_die",description:"GAME DIE",category:"activity"},{name:"slot_machine",unicode:{apple:"1F3B0",google:"1F3B0",twitter:"1F3B0"},shortcode:"slot_machine",description:"SLOT MACHINE",category:"activity"},{name:"bowling",unicode:{apple:"1F3B3",google:"1F3B3",twitter:"1F3B3"},shortcode:"bowling",description:"BOWLING",category:"activity"},{name:"car",unicode:{apple:"1F697",google:"1F697",twitter:"1F697"},shortcode:"car",description:"AUTOMOBILE",category:"travel"},{name:"taxi",unicode:{apple:"1F695",google:"1F695",twitter:"1F695"},shortcode:"taxi",description:"TAXI",category:"travel"},{name:"blue_car",unicode:{apple:"1F699",google:"1F699",twitter:"1F699"},shortcode:"blue_car",description:"RECREATIONAL VEHICLE",category:"travel"},{name:"bus",unicode:{apple:"1F68C",google:"1F68C",twitter:"1F68C"},shortcode:"bus",description:"BUS",category:"travel"},{name:"trolleybus",unicode:{apple:"1F68E",google:"1F68E",twitter:"1F68E"},shortcode:"trolleybus",description:"TROLLEYBUS",category:"travel"},{name:"racing_car",unicode:{apple:"1F3CE",google:"1F3CE",twitter:"1F3CE"},shortcode:"racing_car",description:"Racing Car",category:"travel"},{name:"police_car",unicode:{apple:"1F693",google:"1F693",twitter:"1F693"},shortcode:"police_car",description:"POLICE CAR",category:"travel"},{name:"ambulance",unicode:{apple:"1F691",google:"1F691",twitter:"1F691"},shortcode:"ambulance",description:"AMBULANCE",category:"travel"},{name:"fire_engine",unicode:{apple:"1F692",google:"1F692",twitter:"1F692"},shortcode:"fire_engine",description:"FIRE ENGINE",category:"travel"},{name:"minibus",unicode:{apple:"1F690",google:"1F690",twitter:"1F690"},shortcode:"minibus",description:"MINIBUS",category:"travel"},{name:"truck",unicode:{apple:"1F69A",google:"1F69A",twitter:"1F69A"},shortcode:"truck",description:"DELIVERY TRUCK",category:"travel"},{name:"articulated_lorry",unicode:{apple:"1F69B",google:"1F69B",twitter:"1F69B"},shortcode:"articulated_lorry",description:"ARTICULATED LORRY",category:"travel"},{name:"tractor",unicode:{apple:"1F69C",google:"1F69C",twitter:"1F69C"},shortcode:"tractor",
description:"TRACTOR",category:"travel"},{name:"racing_motorcycle",unicode:{apple:"1F3CD",google:"1F3CD",twitter:"1F3CD"},shortcode:"racing_motorcycle",description:"Racing Motorcycle",category:"travel"},{name:"bike",unicode:{apple:"1F6B2",google:"1F6B2",twitter:"1F6B2"},shortcode:"bike",description:"BICYCLE",category:"travel"},{name:"rotating_light",unicode:{apple:"1F6A8",google:"1F6A8",twitter:"1F6A8"},shortcode:"rotating_light",description:"POLICE CARS REVOLVING LIGHT",category:"travel"},{name:"oncoming_police_car",unicode:{apple:"1F694",google:"1F694",twitter:"1F694"},shortcode:"oncoming_police_car",description:"ONCOMING POLICE CAR",category:"travel"},{name:"oncoming_bus",unicode:{apple:"1F68D",google:"1F68D",twitter:"1F68D"},shortcode:"oncoming_bus",description:"ONCOMING BUS",category:"travel"},{name:"oncoming_automobile",unicode:{apple:"1F698",google:"1F698",twitter:"1F698"},shortcode:"oncoming_automobile",description:"ONCOMING AUTOMOBILE",category:"travel"},{name:"oncoming_taxi",unicode:{apple:"1F696",google:"1F696",twitter:"1F696"},shortcode:"oncoming_taxi",description:"ONCOMING TAXI",category:"travel"},{name:"aerial_tramway",unicode:{apple:"1F6A1",google:"1F6A1",twitter:"1F6A1"},shortcode:"aerial_tramway",description:"AERIAL TRAMWAY",category:"travel"},{name:"mountain_cableway",unicode:{apple:"1F6A0",google:"1F6A0",twitter:"1F6A0"},shortcode:"mountain_cableway",description:"MOUNTAIN CABLEWAY",category:"travel"},{name:"suspension_railway",unicode:{apple:"1F69F",google:"1F69F",twitter:"1F69F"},shortcode:"suspension_railway",description:"SUSPENSION RAILWAY",category:"travel"},{name:"railway_car",unicode:{apple:"1F683",google:"1F683",twitter:"1F683"},shortcode:"railway_car",description:"RAILWAY CAR",category:"travel"},{name:"train",unicode:{apple:"1F68B",google:"1F68B",twitter:"1F68B"},shortcode:"train",description:"TRAM CAR",category:"travel"},{name:"monorail",unicode:{apple:"1F69D",google:"1F69D",twitter:"1F69D"},shortcode:"monorail",description:"MONORAIL",category:"travel"},{name:"bullettrain_side",unicode:{apple:"1F684",google:"1F684",twitter:"1F684"},shortcode:"bullettrain_side",description:"HIGH-SPEED TRAIN",category:"travel"},{name:"bullettrain_front",unicode:{apple:"1F685",google:"1F685",twitter:"1F685"},shortcode:"bullettrain_front",description:"HIGH-SPEED TRAIN WITH BULLET NOSE",category:"travel"},{name:"light_rail",unicode:{apple:"1F688",google:"1F688",twitter:"1F688"},shortcode:"light_rail",description:"LIGHT RAIL",category:"travel"},{name:"mountain_railway",unicode:{apple:"1F69E",google:"1F69E",twitter:"1F69E"},shortcode:"mountain_railway",description:"MOUNTAIN RAILWAY",category:"travel"},{name:"steam_locomotive",unicode:{apple:"1F682",google:"1F682",twitter:"1F682"},shortcode:"steam_locomotive",description:"STEAM LOCOMOTIVE",category:"travel"},{name:"train2",unicode:{apple:"1F686",google:"1F686",twitter:"1F686"},shortcode:"train2",description:"TRAIN",category:"travel"},{name:"metro",unicode:{apple:"1F687",google:"1F687",twitter:"1F687"},shortcode:"metro",description:"METRO",category:"travel"},{name:"tram",unicode:{apple:"1F68A",google:"1F68A",twitter:"1F68A"},shortcode:"tram",description:"TRAM",category:"travel"},{name:"station",unicode:{apple:"1F689",google:"1F689",twitter:"1F689"},shortcode:"station",description:"STATION",category:"travel"},{name:"helicopter",unicode:{apple:"1F681",google:"1F681",twitter:"1F681"},shortcode:"helicopter",description:"HELICOPTER",category:"travel"},{name:"small_airplane",unicode:{apple:"1F6E9",google:"1F6E9",twitter:"1F6E9"},shortcode:"small_airplane",description:"Small Airplane",category:"travel"},{name:"airplane",unicode:{apple:"2708",google:"2708",twitter:"2708"},shortcode:"airplane",description:"AIRPLANE",category:"travel"},{name:"airplane_departure",unicode:{apple:"1F6EB",google:"1F6EB",twitter:"1F6EB"},shortcode:"airplane_departure",description:"Airplane Departure",category:"travel"},{name:"airplane_arriving",unicode:{apple:"1F6EC",google:"1F6EC",twitter:"1F6EC"},shortcode:"airplane_arriving",description:"Airplane Arriving",category:"travel"},{name:"boat",unicode:{apple:"26F5",google:"26F5",twitter:"26F5"},shortcode:"boat",description:"SAILBOAT",category:"travel"},{name:"motor_boat",unicode:{apple:"1F6E5",google:"1F6E5",twitter:"1F6E5"},shortcode:"motor_boat",description:"Motor Boat",category:"travel"},{name:"speedboat",unicode:{apple:"1F6A4",google:"1F6A4",twitter:"1F6A4"},shortcode:"speedboat",description:"SPEEDBOAT",category:"travel"},{name:"ferry",unicode:{apple:"26F4",google:"26F4",twitter:"26F4"},shortcode:"ferry",description:"Ferry",category:"travel"},{name:"passenger_ship",unicode:{apple:"1F6F3",google:"1F6F3",twitter:"1F6F3"},shortcode:"passenger_ship",description:"Passenger Ship",category:"travel"},{name:"rocket",unicode:{apple:"1F680",google:"1F680",twitter:"1F680"},shortcode:"rocket",description:"ROCKET",category:"travel"},{name:"satellite",unicode:{apple:"1F4E1",google:"1F4E1",twitter:"1F4E1"},shortcode:"satellite",description:"SATELLITE ANTENNA",category:"travel"},{name:"seat",unicode:{apple:"1F4BA",google:"1F4BA",twitter:"1F4BA"},shortcode:"seat",description:"SEAT",category:"travel"},{name:"anchor",unicode:{apple:"2693",google:"2693",twitter:"2693"},shortcode:"anchor",description:"ANCHOR",category:"travel"},{name:"construction",unicode:{apple:"1F6A7",google:"1F6A7",twitter:"1F6A7"},shortcode:"construction",description:"CONSTRUCTION SIGN",category:"travel"},{name:"fuelpump",unicode:{apple:"26FD",google:"26FD",twitter:"26FD"},shortcode:"fuelpump",description:"FUEL PUMP",category:"travel"},{name:"busstop",unicode:{apple:"1F68F",google:"1F68F",twitter:"1F68F"},shortcode:"busstop",description:"BUS STOP",category:"travel"},{name:"vertical_traffic_light",unicode:{apple:"1F6A6",google:"1F6A6",twitter:"1F6A6"},shortcode:"vertical_traffic_light",description:"VERTICAL TRAFFIC LIGHT",category:"travel"},{name:"traffic_light",unicode:{apple:"1F6A5",google:"1F6A5",twitter:"1F6A5"},shortcode:"traffic_light",description:"HORIZONTAL TRAFFIC LIGHT",category:"travel"},{name:"checkered_flag",unicode:{apple:"1F3C1",google:"1F3C1",twitter:"1F3C1"},shortcode:"checkered_flag",description:"CHEQUERED FLAG",category:"travel"},{name:"ship",unicode:{apple:"1F6A2",google:"1F6A2",twitter:"1F6A2"},shortcode:"ship",description:"SHIP",category:"travel"},{name:"ferris_wheel",unicode:{apple:"1F3A1",google:"1F3A1",twitter:"1F3A1"},shortcode:"ferris_wheel",description:"FERRIS WHEEL",category:"travel"},{name:"roller_coaster",unicode:{apple:"1F3A2",google:"1F3A2",twitter:"1F3A2"},shortcode:"roller_coaster",description:"ROLLER COASTER",category:"travel"},{name:"carousel_horse",unicode:{apple:"1F3A0",google:"1F3A0",twitter:"1F3A0"},shortcode:"carousel_horse",description:"CAROUSEL HORSE",category:"travel"},{name:"building_construction",unicode:{apple:"1F3D7",google:"1F3D7",twitter:"1F3D7"},shortcode:"building_construction",description:"Building Construction",category:"travel"},{name:"foggy",unicode:{apple:"1F301",google:"1F301",twitter:"1F301"},shortcode:"foggy",description:"FOGGY",category:"travel"},{name:"tokyo_tower",unicode:{apple:"1F5FC",google:"1F5FC",twitter:"1F5FC"},shortcode:"tokyo_tower",description:"TOKYO TOWER",category:"travel"},{name:"factory",unicode:{apple:"1F3ED",google:"1F3ED",twitter:"1F3ED"},shortcode:"factory",description:"FACTORY",category:"travel"},{name:"fountain",unicode:{apple:"26F2",google:"26F2",twitter:"26F2"},shortcode:"fountain",description:"FOUNTAIN",category:"travel"},{name:"rice_scene",unicode:{apple:"1F391",google:"1F391",twitter:"1F391"},shortcode:"rice_scene",description:"MOON VIEWING CEREMONY",category:"travel"},{name:"mountain",unicode:{apple:"26F0",google:"26F0",twitter:"26F0"},shortcode:"mountain",description:"Mountain",category:"travel"},{name:"snow_capped_mountain",unicode:{apple:"1F3D4",google:"1F3D4",twitter:"1F3D4"},shortcode:"snow_capped_mountain",description:"Snow Capped Mountain",category:"travel"},{name:"mount_fuji",unicode:{apple:"1F5FB",google:"1F5FB",twitter:"1F5FB"},shortcode:"mount_fuji",description:"MOUNT FUJI",category:"travel"},{name:"volcano",unicode:{apple:"1F30B",google:"1F30B",twitter:"1F30B"},shortcode:"volcano",description:"VOLCANO",category:"travel"},{name:"japan",unicode:{apple:"1F5FE",google:"1F5FE",twitter:"1F5FE"},shortcode:"japan",description:"SILHOUETTE OF JAPAN",category:"travel"},{name:"camping",unicode:{apple:"1F3D5",google:"1F3D5",twitter:"1F3D5"},shortcode:"camping",description:"Camping",category:"travel"},{name:"tent",unicode:{apple:"26FA",google:"26FA",twitter:"26FA"},shortcode:"tent",description:"TENT",category:"travel"},{name:"national_park",unicode:{apple:"1F3DE",google:"1F3DE",twitter:"1F3DE"},shortcode:"national_park",description:"National Park",category:"travel"},{name:"motorway",unicode:{apple:"1F6E3",google:"1F6E3",twitter:"1F6E3"},shortcode:"motorway",description:"Motorway",category:"travel"},{name:"railway_track",unicode:{apple:"1F6E4",google:"1F6E4",twitter:"1F6E4"},shortcode:"railway_track",description:"Railway Track",category:"travel"},{name:"sunrise",unicode:{apple:"1F305",google:"1F305",twitter:"1F305"},shortcode:"sunrise",description:"SUNRISE",category:"travel"},{name:"sunrise_over_mountains",unicode:{apple:"1F304",google:"1F304",twitter:"1F304"},shortcode:"sunrise_over_mountains",description:"SUNRISE OVER MOUNTAINS",category:"travel"},{name:"desert",unicode:{apple:"1F3DC",google:"1F3DC",twitter:"1F3DC"},shortcode:"desert",description:"Desert",category:"travel"},{name:"beach_with_umbrella",unicode:{apple:"1F3D6",google:"1F3D6",twitter:"1F3D6"},shortcode:"beach_with_umbrella",description:"Beach With Umbrella",category:"travel"},{name:"desert_island",unicode:{apple:"1F3DD",google:"1F3DD",twitter:"1F3DD"},shortcode:"desert_island",description:"Desert Island",category:"travel"},{name:"city_sunrise",unicode:{apple:"1F307",google:"1F307",twitter:"1F307"},shortcode:"city_sunrise",description:"SUNSET OVER BUILDINGS",category:"travel"},{name:"city_sunset",unicode:{apple:"1F306",google:"1F306",twitter:"1F306"},shortcode:"city_sunset",description:"CITYSCAPE AT DUSK",category:"travel"},{name:"cityscape",unicode:{apple:"1F3D9",google:"1F3D9",twitter:"1F3D9"},shortcode:"cityscape",description:"CITYSCAPE",category:"travel"},{name:"night_with_stars",unicode:{apple:"1F303",google:"1F303",twitter:"1F303"},shortcode:"night_with_stars",description:"NIGHT WITH STARS",category:"travel"},{name:"bridge_at_night",unicode:{apple:"1F309",google:"1F309",twitter:"1F309"},shortcode:"bridge_at_night",description:"BRIDGE AT NIGHT",category:"travel"},{name:"milky_way",unicode:{apple:"1F30C",google:"1F30C",twitter:"1F30C"},shortcode:"milky_way",description:"MILKY WAY",category:"travel"},{name:"stars",unicode:{apple:"1F320",google:"1F320",twitter:"1F320"},shortcode:"stars",description:"SHOOTING STAR",category:"travel"},{name:"sparkler",unicode:{apple:"1F387",google:"1F387",twitter:"1F387"},shortcode:"sparkler",description:"FIREWORK SPARKLER",category:"travel"},{name:"fireworks",unicode:{apple:"1F386",google:"1F386",twitter:"1F386"},shortcode:"fireworks",description:"FIREWORKS",category:"travel"},{name:"rainbow",unicode:{apple:"1F308",google:"1F308",twitter:"1F308"},shortcode:"rainbow",description:"RAINBOW",category:"travel"},{name:"house_buildings",unicode:{apple:"1F3D8",google:"1F3D8",twitter:"1F3D8"},shortcode:"house_buildings",description:"EUROPEAN CASTLE",category:"travel"},{name:"european_castle",unicode:{apple:"1F3F0",google:"1F3F0",twitter:"1F3F0"},shortcode:"european_castle",description:"EUROPEAN CASTLE",category:"travel"},{name:"japanese_castle",unicode:{apple:"1F3EF",google:"1F3EF",twitter:"1F3EF"},shortcode:"japanese_castle",description:"JAPANESE CASTLE",category:"travel"},{name:"stadium",unicode:{apple:"1F3DF",google:"1F3DF",twitter:"1F3DF"},shortcode:"stadium",description:"Stadium",category:"travel"},{name:"statue_of_liberty",unicode:{apple:"1F5FD",google:"1F5FD",twitter:"1F5FD"},shortcode:"statue_of_liberty",description:"STATUE OF LIBERTY",category:"travel"},{name:"house",unicode:{apple:"1F3E0",google:"1F3E0",twitter:"1F3E0"},shortcode:"house",description:"HOUSE BUILDING",category:"travel"},{name:"house_with_garden",unicode:{apple:"1F3E1",google:"1F3E1",twitter:"1F3E1"},shortcode:"house_with_garden",description:"HOUSE WITH GARDEN",category:"travel"},{name:"derelict_house_building",unicode:{apple:"1F3DA",google:"1F3DA",twitter:"1F3DA"},shortcode:"derelict_house_building",description:"Derelict House Building",category:"travel"},{name:"office",unicode:{apple:"1F3E2",google:"1F3E2",twitter:"1F3E2"},shortcode:"office",description:"OFFICE BUILDING",category:"travel"},{name:"department_store",unicode:{apple:"1F3EC",google:"1F3EC",twitter:"1F3EC"},shortcode:"department_store",description:"DEPARTMENT STORE",category:"travel"},{name:"post_office",unicode:{apple:"1F3E3",google:"1F3E3",twitter:"1F3E3"},shortcode:"post_office",description:"JAPANESE POST OFFICE",category:"travel"},{name:"european_post_office",unicode:{apple:"1F3E4",google:"1F3E4",twitter:"1F3E4"},shortcode:"european_post_office",description:"EUROPEAN POST OFFICE",category:"travel"},{name:"hospital",unicode:{apple:"1F3E5",google:"1F3E5",twitter:"1F3E5"},shortcode:"hospital",description:"HOSPITAL",category:"travel"},{name:"bank",unicode:{apple:"1F3E6",google:"1F3E6",twitter:"1F3E6"},shortcode:"bank",description:"BANK",category:"travel"},{name:"hotel",unicode:{apple:"1F3E8",google:"1F3E8",twitter:"1F3E8"},shortcode:"hotel",description:"HOTEL",category:"travel"},{name:"convenience_store",unicode:{apple:"1F3EA",google:"1F3EA",twitter:"1F3EA"},shortcode:"convenience_store",description:"CONVENIENCE STORE",category:"travel"},{name:"school",unicode:{apple:"1F3EB",google:"1F3EB",twitter:"1F3EB"},shortcode:"school",description:"SCHOOL",category:"travel"},{name:"love_hotel",unicode:{apple:"1F3E9",google:"1F3E9",twitter:"1F3E9"},shortcode:"love_hotel",description:"LOVE HOTEL",category:"travel"},{name:"wedding",unicode:{apple:"1F492",google:"1F492",twitter:"1F492"},shortcode:"wedding",description:"WEDDING",category:"travel"},{name:"classical_building",unicode:{apple:"1F3DB",google:"1F3DB",twitter:"1F3DB"},shortcode:"classical_building",description:"Classical Building",category:"travel"},{name:"church",unicode:{apple:"26EA",google:"26EA",twitter:"26EA"},shortcode:"church",description:"CHURCH",category:"travel"},{name:"mosque",unicode:{apple:"1F54C",google:"1F54C",twitter:"1F54C"},shortcode:"mosque",description:"Mosque",category:"travel"},{name:"synagogue",unicode:{apple:"1F54D",google:"1F54D",twitter:"1F54D"},shortcode:"synagogue",description:"Synagogue",category:"travel"},{name:"kaaba",unicode:{apple:"1F54B",google:"1F54B",twitter:"1F54B"},shortcode:"kaaba",description:"Kaaba",category:"travel"},{name:"shinto_shrine",unicode:{apple:"26E9",google:"26E9",twitter:"26E9"},shortcode:"shinto_shrine",description:"Shinto Shrine",category:"travel"},{name:"watch",unicode:{apple:"231A",google:"231A",twitter:"231A"},shortcode:"watch",description:"WATCH",category:"object"},{name:"iphone",unicode:{apple:"1F4F1",google:"1F4F1",twitter:"1F4F1"},shortcode:"iphone",description:"MOBILE PHONE",category:"object"},{name:"calling",unicode:{apple:"1F4F2",google:"1F4F2",twitter:"1F4F2"},shortcode:"calling",description:"MOBILE PHONE WITH RIGHTWARDS ARROW AT LEFT",category:"object"},{name:"computer",unicode:{apple:"1F4BB",google:"1F4BB",twitter:"1F4BB"},shortcode:"computer",description:"PERSONAL COMPUTER",category:"object"},{name:"keyboard",unicode:{apple:"2328",google:"2328",twitter:"2328"},shortcode:"keyboard",description:"KEYBOARD",category:"object"},{name:"desktop_computer",unicode:{apple:"1F5A5",google:"1F5A5",twitter:"1F5A5"},shortcode:"desktop_computer",description:"DESKTOP COMPUTER",category:"object"},{name:"printer",unicode:{apple:"1F5A8",google:"1F5A8",twitter:"1F5A8"},shortcode:"printer",description:"PRINTER",category:"object"},{name:"three_button_mouse",unicode:{apple:"1F5B1",google:"1F5B1",twitter:"1F5B1"},shortcode:"three_button_mouse",description:"THREE BUTTON MOUSE",category:"object"},{name:"trackball",unicode:{apple:"1F5B2",google:"1F5B2",twitter:"1F5B2"},shortcode:"trackball",description:"TRACKBALL",category:"object"},{name:"joystick",unicode:{apple:"1F579",google:"1F579",twitter:"1F579"},shortcode:"joystick",description:"JOYSTICK",category:"object"},{name:"compression",unicode:{apple:"1F5DC",google:"1F5DC",twitter:"1F5DC"},shortcode:"compression",description:"COMPRESSION",category:"object"},{name:"minidisc",unicode:{apple:"1F4BD",google:"1F4BD",twitter:"1F4BD"},shortcode:"minidisc",description:"MINIDISC",category:"object"},{name:"floppy_disk",unicode:{apple:"1F4BE",google:"1F4BE",twitter:"1F4BE"},shortcode:"floppy_disk",description:"FLOPPY DISK",category:"object"},{name:"cd",unicode:{apple:"1F4BF",google:"1F4BF",twitter:"1F4BF"},shortcode:"cd",description:"OPTICAL DISC",category:"object"},{name:"dvd",unicode:{apple:"1F4C0",google:"1F4C0",twitter:"1F4C0"},shortcode:"dvd",description:"DVD",category:"object"},{name:"vhs",unicode:{apple:"1F4FC",google:"1F4FC",twitter:"1F4FC"},shortcode:"vhs",description:"VIDEOCASSETTE",category:"object"},{name:"camera",unicode:{apple:"1F4F7",google:"1F4F7",twitter:"1F4F7"},shortcode:"camera",description:"CAMERA",category:"object"},{name:"camera_with_flash",unicode:{apple:"1F4F8",google:"1F4F8",twitter:"1F4F8"},shortcode:"camera_with_flash",description:"CAMERA WITH FLASH",category:"object"},{name:"video_camera",unicode:{apple:"1F4F9",google:"1F4F9",twitter:"1F4F9"},shortcode:"video_camera",description:"VIDEO CAMERA",category:"object"},{name:"movie_camera",unicode:{apple:"1F3A5",google:"1F3A5",twitter:"1F3A5"},shortcode:"movie_camera",description:"MOVIE CAMERA",category:"object"},{name:"film_projector",unicode:{apple:"1F4FD",google:"1F4FD",twitter:"1F4FD"},shortcode:"film_projector",description:"FILM PROJECTOR",category:"object"},{name:"film_frames",unicode:{apple:"1F39E",google:"1F39E",twitter:"1F39E"},shortcode:"film_frames",description:"FILM FRAMES",category:"object"},{name:"telephone_receiver",unicode:{apple:"1F4DE",google:"1F4DE",twitter:"1F4DE"},shortcode:"telephone_receiver",description:"TELEPHONE RECEIVER",category:"object"},{name:"phone",unicode:{apple:"260E",google:"260E",twitter:"260E"},shortcode:"phone",description:"BLACK TELEPHONE",category:"object"},{name:"pager",unicode:{apple:"1F4DF",google:"1F4DF",twitter:"1F4DF"},shortcode:"pager",description:"PAGER",category:"object"},{name:"fax",unicode:{apple:"1F4E0",google:"1F4E0",twitter:"1F4E0"},shortcode:"fax",description:"FAX MACHINE",category:"object"},{name:"tv",unicode:{apple:"1F4FA",google:"1F4FA",twitter:"1F4FA"},shortcode:"tv",description:"TELEVISION",category:"object"},{name:"radio",unicode:{apple:"1F4FB",google:"1F4FB",twitter:"1F4FB"},shortcode:"radio",description:"RADIO",category:"object"},{name:"studio_microphone",unicode:{apple:"1F399",google:"1F399",twitter:"1F399"},shortcode:"studio_microphone",description:"STUDIO MICROPHONE",category:"object"},{name:"level_slider",unicode:{apple:"1F39A",google:"1F39A",twitter:"1F39A"},shortcode:"level_slider",description:"LEVEL SLIDER",category:"object"},{name:"control_knobs",unicode:{apple:"1F39B",google:"1F39B",twitter:"1F39B"},shortcode:"control_knobs",description:"CONTROL KNOBS",category:"object"},{name:"stopwatch",unicode:{apple:"23F1",google:"23F1",twitter:"23F1"},shortcode:"stopwatch",description:"STOPWATCH",category:"object"},{name:"timer_clock",unicode:{apple:"23F2",google:"23F2",twitter:"23F2"},shortcode:"timer_clock",description:"TIMER CLOCK",category:"object"},{name:"alarm_clock",unicode:{apple:"23F0",google:"23F0",twitter:"23F0"},shortcode:"alarm_clock",description:"ALARM CLOCK",category:"object"},{name:"mantelpiece_clock",unicode:{apple:"1F570",google:"1F570",twitter:"1F570"},shortcode:"mantelpiece_clock",description:"MANTELPIECE CLOCK",category:"object"},{name:"hourglass_flowing_sand",unicode:{apple:"23F3",google:"23F3",twitter:"23F3"},shortcode:"hourglass_flowing_sand",description:"HOURGLASS WITH FLOWING SAND",category:"object"},{name:"hourglass",unicode:{apple:"231B",google:"231B",twitter:"231B"},shortcode:"hourglass",description:"HOURGLASS",category:"object"},{name:"satellite",unicode:{apple:"1F6F0",google:"1F6F0",twitter:"1F6F0"},shortcode:"satellite",description:"SATELLITE",category:"object"},{name:"battery",unicode:{apple:"1F50B",google:"1F50B",twitter:"1F50B"},shortcode:"battery",description:"BATTERY",category:"object"},{name:"electric_plug",unicode:{apple:"1F50C",google:"1F50C",twitter:"1F50C"},shortcode:"electric_plug",description:"ELECTRIC PLUG",category:"object"},{name:"bulb",unicode:{apple:"1F4A1",google:"1F4A1",twitter:"1F4A1"},shortcode:"bulb",description:"ELECTRIC LIGHT BULB",category:"object"},{name:"flashlight",unicode:{apple:"1F526",google:"1F526",twitter:"1F526"},shortcode:"flashlight",description:"ELECTRIC TORCH",category:"object"},{name:"candle",unicode:{apple:"1F56F",google:"1F56F",twitter:"1F56F"},shortcode:"candle",description:"CANDLE",category:"object"},{name:"wastebasket",unicode:{apple:"1F5D1",google:"1F5D1",twitter:"1F5D1"},shortcode:"wastebasket",description:"WASTEBASKET",category:"object"},{name:"oil_drum",unicode:{apple:"1F6E2",google:"1F6E2",twitter:"1F6E2"},shortcode:"oil_drum",description:"OIL DRUM",category:"object"},{name:"money_with_wings",unicode:{apple:"1F4B8",google:"1F4B8",twitter:"1F4B8"},shortcode:"money_with_wings",description:"MONEY WITH WINGS",category:"object"},{name:"dollar",unicode:{apple:"1F4B5",google:"1F4B5",twitter:"1F4B5"},shortcode:"dollar",description:"BANKNOTE WITH DOLLAR SIGN",category:"object"},{name:"yen",unicode:{apple:"1F4B4",google:"1F4B4",twitter:"1F4B4"},shortcode:"yen",description:"BANKNOTE WITH YEN SIGN",category:"object"},{name:"euro",unicode:{apple:"1F4B6",google:"1F4B6",twitter:"1F4B6"},shortcode:"euro",description:"BANKNOTE WITH EURO SIGN",category:"object"},{name:"pound",unicode:{apple:"1F4B7",google:"1F4B7",twitter:"1F4B7"},shortcode:"pound",description:"BANKNOTE WITH POUND SIGN",category:"object"},{name:"moneybag",unicode:{apple:"1F4B0",google:"1F4B0",twitter:"1F4B0"},shortcode:"moneybag",description:"MONEY BAG",category:"object"},{name:"credit_card",unicode:{apple:"1F4B3",google:"1F4B3",twitter:"1F4B3"},shortcode:"credit_card",description:"CREDIT CARD",category:"object"},{name:"gem",unicode:{apple:"1F48E",google:"1F48E",twitter:"1F48E"},shortcode:"gem",description:"GEM STONE",category:"object"},{name:"scales",unicode:{apple:"2696",google:"2696",twitter:"2696"},shortcode:"scales",description:"SCALES",category:"object"},{name:"wrench",unicode:{apple:"1F527",google:"1F527",twitter:"1F527"},shortcode:"wrench",description:"WRENCH",category:"object"},{name:"hammer",unicode:{apple:"1F528",google:"1F528",twitter:"1F528"},shortcode:"hammer",description:"HAMMER",category:"object"},{name:"hammer_and_pick",unicode:{apple:"2692",google:"2692",twitter:"2692"},shortcode:"hammer_and_pick",description:"HAMMER AND PICK",category:"object"},{name:"hammer_and_wrench",unicode:{apple:"1F6E0",google:"1F6E0",twitter:"1F6E0"},shortcode:"hammer_and_wrench",description:"HAMMER AND WRENCH",category:"object"},{name:"pick",unicode:{apple:"26CF",google:"26CF",twitter:"26CF"},shortcode:"pick",description:"PICK",category:"object"},{name:"nut_and_bolt",unicode:{apple:"1F529",google:"1F529",twitter:"1F529"},shortcode:"nut_and_bolt",description:"NUT AND BOLT",category:"object"},{name:"gear",unicode:{apple:"2699",google:"2699",twitter:"2699"},shortcode:"gear",description:"GEAR",category:"object"},{name:"chains",unicode:{apple:"26D3",google:"26D3",twitter:"26D3"},shortcode:"chains",description:"CHAINS",category:"object"},{name:"gun",unicode:{apple:"1F52B",google:"1F52B",twitter:"1F52B"},shortcode:"gun",description:"PISTOL",category:"object"},{name:"bomb",unicode:{apple:"1F4A3",google:"1F4A3",twitter:"1F4A3"},shortcode:"bomb",description:"BOMB",category:"object"},{name:"hocho",unicode:{apple:"1F52A",google:"1F52A",twitter:"1F52A"},shortcode:"hocho",description:"HOCHO",category:"object"},{name:"dagger_knife",unicode:{apple:"1F5E1",google:"1F5E1",twitter:"1F5E1"},shortcode:"dagger_knife",description:"DAGGER KNIFE",category:"object"},{name:"crossed_swords",unicode:{apple:"2694",google:"2694",twitter:"2694"},shortcode:"crossed_swords",description:"CROSSED SWORDS",category:"object"},{name:"shield",unicode:{apple:"1F6E1",google:"1F6E1",twitter:"1F6E1"},shortcode:"shield",description:"SHIELD",category:"object"},{name:"smoking",unicode:{apple:"1F6AC",google:"1F6AC",twitter:"1F6AC"},shortcode:"smoking",description:"SMOKING SYMBOL",category:"object"},{name:"skull_and_crossbones",unicode:{apple:"2620",google:"2620",twitter:"2620"},shortcode:"skull_and_crossbones",description:"SKULL AND CROSSBONES",category:"object"},{name:"coffin",unicode:{apple:"26B0",google:"26B0",twitter:"26B0"},shortcode:"coffin",description:"COFFIN",category:"object"},{name:"funeral_urn",unicode:{apple:"26B1",google:"26B1",twitter:"26B1"},shortcode:"funeral_urn",description:"FUNERAL URN",category:"object"},{name:"amphora",unicode:{apple:"1F3FA",google:"1F3FA",twitter:"1F3FA"},shortcode:"amphora",description:"AMPHORA",category:"object"},{name:"crystal_ball",unicode:{apple:"1F52E",google:"1F52E",twitter:"1F52E"},shortcode:"crystal_ball",description:"CRYSTAL BALL",category:"object"},{name:"prayer_beads",unicode:{apple:"1F4FF",google:"1F4FF",twitter:"1F4FF"},shortcode:"prayer_beads",description:"PRAYER BEADS",category:"object"},{name:"barber",unicode:{apple:"1F488",google:"1F488",twitter:"1F488"},shortcode:"barber",description:"BARBER POLE",category:"object"},{name:"alembic",unicode:{apple:"2697",google:"2697",twitter:"2697"},shortcode:"alembic",description:"ALEMBIC",category:"object"},{name:"telescope",unicode:{apple:"1F52D",google:"1F52D",twitter:"1F52D"},shortcode:"telescope",description:"TELESCOPE",category:"object"},{name:"microscope",unicode:{apple:"1F52C",google:"1F52C",twitter:"1F52C"},shortcode:"microscope",description:"MICROSCOPE",category:"object"},{name:"hole",unicode:{apple:"1F573",google:"1F573",twitter:"1F573"},shortcode:"hole",description:"HOLE",category:"object"},{name:"pill",unicode:{apple:"1F48A",google:"1F48A",twitter:"1F48A"},shortcode:"pill",description:"PILL",category:"object"},{name:"syringe",unicode:{apple:"1F489",google:"1F489",twitter:"1F489"},shortcode:"syringe",description:"SYRINGE",category:"object"},{name:"thermometer",unicode:{apple:"1F321",google:"1F321",twitter:"1F321"},shortcode:"thermometer",description:"THERMOMETER",category:"object"},{name:"label",unicode:{apple:"1F3F7",google:"1F3F7",twitter:"1F3F7"},shortcode:"label",description:"LABEL",category:"object"},{name:"bookmark",unicode:{apple:"1F516",google:"1F516",twitter:"1F516"},shortcode:"bookmark",description:"BOOKMARK",category:"object"},{name:"toilet",unicode:{apple:"1F6BD",google:"1F6BD",twitter:"1F6BD"},shortcode:"toilet",description:"TOILET",category:"object"},{name:"shower",unicode:{apple:"1F6BF",google:"1F6BF",twitter:"1F6BF"},shortcode:"shower",description:"SHOWER",category:"object"},{name:"bathtub",unicode:{apple:"1F6C1",google:"1F6C1",twitter:"1F6C1"},shortcode:"bathtub",description:"BATHTUB",category:"object"},{name:"key",unicode:{apple:"1F511",google:"1F511",twitter:"1F511"},shortcode:"key",description:"KEY",category:"object"},{name:"old_key",unicode:{apple:"1F5DD",google:"1F5DD",twitter:"1F5DD"},shortcode:"old_key",description:"OLD KEY",category:"object"},{name:"couch_and_lamp",unicode:{apple:"1F6CB",google:"1F6CB",twitter:"1F6CB"},shortcode:"couch_and_lamp",description:"COUCH AND LAMP",category:"object"},{name:"sleeping_accommodation",unicode:{apple:"1F6CC",google:"1F6CC",twitter:"1F6CC"},shortcode:"sleeping_accommodation",description:"SLEEPING ACCOMMODATION",category:"object"},{name:"bed",unicode:{apple:"1F6CF",google:"1F6CF",twitter:"1F6CF"},shortcode:"bed",description:"BED",category:"object"},{name:"door",unicode:{apple:"1F6AA",google:"1F6AA",twitter:"1F6AA"},shortcode:"door",description:"DOOR",category:"object"},{name:"bellhop_bell",unicode:{apple:"1F6CE",google:"1F6CE",twitter:"1F6CE"},shortcode:"bellhop_bell",description:"BELLHOP BELL",category:"object"},{name:"frame_with_picture",unicode:{apple:"1F5BC",google:"1F5BC",twitter:"1F5BC"},shortcode:"frame_with_picture",description:"FRAME WITH PICTURE",category:"object"},{name:"world_map",unicode:{apple:"1F5FA",google:"1F5FA",twitter:"1F5FA"},shortcode:"world_map",description:"WORLD MAP",category:"object"},{name:"umbrella_on_ground",unicode:{apple:"26F1",google:"26F1",twitter:"26F1"},shortcode:"umbrella_on_ground",description:"UMBRELLA ON GROUND",category:"object"},{name:"moyai",unicode:{apple:"1F5FF",google:"1F5FF",twitter:"1F5FF"},shortcode:"moyai",description:"MOYAI",category:"object"},{name:"shopping_bags",unicode:{apple:"1F6CD",google:"1F6CD",twitter:"1F6CD"},shortcode:"shopping_bags",description:"SHOPPING BAGS",category:"object"},{name:"balloon",unicode:{apple:"1F388",google:"1F388",twitter:"1F388"},shortcode:"balloon",description:"BALLOON",category:"object"},{name:"flags",unicode:{apple:"1F38F",google:"1F38F",twitter:"1F38F"},shortcode:"flags",description:"CARP STREAMER",category:"object"},{name:"ribbon",unicode:{apple:"1F380",google:"1F380",twitter:"1F380"},shortcode:"ribbon",description:"RIBBON",category:"object"},{name:"gift",unicode:{apple:"1F381",google:"1F381",twitter:"1F381"},shortcode:"gift",description:"WRAPPED PRESENT",category:"object"},{name:"confetti_ball",unicode:{apple:"1F38A",google:"1F38A",twitter:"1F38A"},shortcode:"confetti_ball",description:"CONFETTI BALL",category:"object"},{name:"tada",unicode:{apple:"1F389",google:"1F389",twitter:"1F389"},shortcode:"tada",description:"PARTY POPPER",category:"object"},{name:"dolls",unicode:{apple:"1F38E",google:"1F38E",twitter:"1F38E"},shortcode:"dolls",description:"JAPANESE DOLLS",category:"object"},{name:"wind_chime",unicode:{apple:"1F390",google:"1F390",twitter:"1F390"},shortcode:"wind_chime",description:"WIND CHIME",category:"object"},{name:"crossed_flags",unicode:{apple:"1F38C",google:"1F38C",twitter:"1F38C"},shortcode:"crossed_flags",description:"CROSSED FLAGS",category:"object"},{name:"izakaya_lantern",unicode:{apple:"1F3EE",google:"1F3EE",twitter:"1F3EE"},shortcode:"izakaya_lantern",description:"IZAKAYA LANTERN",category:"object"},{name:"email",unicode:{apple:"2709",google:"2709",twitter:"2709"},shortcode:"email",description:"ENVELOPE",category:"object"},{name:"envelope_with_arrow",unicode:{apple:"1F4E9",google:"1F4E9",twitter:"1F4E9"},shortcode:"envelope_with_arrow",description:"ENVELOPE WITH DOWNWARDS ARROW ABOVE",category:"object"},{name:"incoming_envelope",unicode:{apple:"1F4E8",google:"1F4E8",twitter:"1F4E8"},shortcode:"incoming_envelope",description:"INCOMING ENVELOPE",category:"object"},{name:"e-mail",unicode:{apple:"1F4E7",google:"1F4E7",twitter:"1F4E7"},shortcode:"e-mail",description:"E-MAIL SYMBOL",category:"object"},{name:"love_letter",unicode:{apple:"1F48C",google:"1F48C",twitter:"1F48C"},shortcode:"love_letter",description:"LOVE LETTER",category:"object"},{name:"postbox",unicode:{apple:"1F4EE",google:"1F4EE",twitter:"1F4EE"},shortcode:"postbox",description:"POSTBOX",category:"object"},{name:"mailbox_closed",unicode:{apple:"1F4EA",google:"1F4EA",twitter:"1F4EA"},shortcode:"mailbox_closed",description:"CLOSED MAILBOX WITH LOWERED FLAG",category:"object"},{name:"mailbox",unicode:{apple:"1F4EB",google:"1F4EB",twitter:"1F4EB"},shortcode:"mailbox",description:"CLOSED MAILBOX WITH RAISED FLAG",category:"object"},{name:"mailbox_with_mail",unicode:{apple:"1F4EC",google:"1F4EC",twitter:"1F4EC"},shortcode:"mailbox_with_mail",description:"OPEN MAILBOX WITH RAISED FLAG",category:"object"},{name:"mailbox_with_no_mail",unicode:{apple:"1F4ED",google:"1F4ED",twitter:"1F4ED"},shortcode:"mailbox_with_no_mail",description:"OPEN MAILBOX WITH LOWERED FLAG",category:"object"},{name:"package",unicode:{apple:"1F4E6",google:"1F4E6",twitter:"1F4E6"},shortcode:"package",description:"PACKAGE",category:"object"},{name:"postal_horn",unicode:{apple:"1F4EF",google:"1F4EF",twitter:"1F4EF"},shortcode:"postal_horn",
description:"POSTAL HORN",category:"object"},{name:"inbox_tray",unicode:{apple:"1F4E5",google:"1F4E5",twitter:"1F4E5"},shortcode:"inbox_tray",description:"INBOX TRAY",category:"object"},{name:"outbox_tray",unicode:{apple:"1F4E4",google:"1F4E4",twitter:"1F4E4"},shortcode:"outbox_tray",description:"OUTBOX TRAY",category:"object"},{name:"scroll",unicode:{apple:"1F4DC",google:"1F4DC",twitter:"1F4DC"},shortcode:"scroll",description:"SCROLL",category:"object"},{name:"page_with_curl",unicode:{apple:"1F4C3",google:"1F4C3",twitter:"1F4C3"},shortcode:"page_with_curl",description:"PAGE WITH CURL",category:"object"},{name:"bookmark_tabs",unicode:{apple:"1F4D1",google:"1F4D1",twitter:"1F4D1"},shortcode:"bookmark_tabs",description:"BOOKMARK TABS",category:"object"},{name:"bar_chart",unicode:{apple:"1F4CA",google:"1F4CA",twitter:"1F4CA"},shortcode:"bar_chart",description:"BAR CHART",category:"object"},{name:"chart_with_upwards_trend",unicode:{apple:"1F4C8",google:"1F4C8",twitter:"1F4C8"},shortcode:"chart_with_upwards_trend",description:"CHART WITH UPWARDS TREND",category:"object"},{name:"chart_with_downwards_trend",unicode:{apple:"1F4C9",google:"1F4C9",twitter:"1F4C9"},shortcode:"chart_with_downwards_trend",description:"CHART WITH DOWNWARDS TREND",category:"object"},{name:"page_facing_up",unicode:{apple:"1F4C4",google:"1F4C4",twitter:"1F4C4"},shortcode:"page_facing_up",description:"PAGE FACING UP",category:"object"},{name:"date",unicode:{apple:"1F4C5",google:"1F4C5",twitter:"1F4C5"},shortcode:"date",description:"CALENDAR",category:"object"},{name:"calendar",unicode:{apple:"1F4C6",google:"1F4C6",twitter:"1F4C6"},shortcode:"calendar",description:"TEAR-OFF CALENDAR",category:"object"},{name:"spiral_calendar_pad",unicode:{apple:"1F5D3",google:"1F5D3",twitter:"1F5D3"},shortcode:"spiral_calendar_pad",description:"SPIRAL CALENDAR PAD",category:"object"},{name:"card_index",unicode:{apple:"1F4C7",google:"1F4C7",twitter:"1F4C7"},shortcode:"card_index",description:"CARD INDEX",category:"object"},{name:"card_file_box",unicode:{apple:"1F5C3",google:"1F5C3",twitter:"1F5C3"},shortcode:"card_file_box",description:"CARD FILE BOX",category:"object"},{name:"ballot_box_with_check",unicode:{apple:"2611-FE0F",google:"2611-FE0F",twitter:"2611-FE0F"},shortcode:"ballot_box_with_check",description:"BALLOT BOX WITH CHECK",category:"object"},{name:"file_cabinet",unicode:{apple:"1F5C4",google:"1F5C4",twitter:"1F5C4"},shortcode:"file_cabinet",description:"FILE CABINET",category:"object"},{name:"clipboard",unicode:{apple:"1F4CB",google:"1F4CB",twitter:"1F4CB"},shortcode:"clipboard",description:"CLIPBOARD",category:"object"},{name:"spiral_note_pad",unicode:{apple:"1F5D2",google:"1F5D2",twitter:"1F5D2"},shortcode:"spiral_note_pad",description:"SPIRAL NOTE PAD",category:"object"},{name:"file_folder",unicode:{apple:"1F4C1",google:"1F4C1",twitter:"1F4C1"},shortcode:"file_folder",description:"FILE FOLDER",category:"object"},{name:"open_file_folder",unicode:{apple:"1F4C2",google:"1F4C2",twitter:"1F4C2"},shortcode:"open_file_folder",description:"OPEN FILE FOLDER",category:"object"},{name:"card_index_dividers",unicode:{apple:"1F5C2",google:"1F5C2",twitter:"1F5C2"},shortcode:"card_index_dividers",description:"CARD INDEX DIVIDERS",category:"object"},{name:"rolled_up_newspaper",unicode:{apple:"1F5DE",google:"1F5DE",twitter:"1F5DE"},shortcode:"rolled_up_newspaper",description:"ROLLED-UP NEWSPAPER",category:"object"},{name:"newspaper",unicode:{apple:"1F4F0",google:"1F4F0",twitter:"1F4F0"},shortcode:"newspaper",description:"NEWSPAPER",category:"object"},{name:"notebook",unicode:{apple:"1F4D3",google:"1F4D3",twitter:"1F4D3"},shortcode:"notebook",description:"NOTEBOOK",category:"object"},{name:"closed_book",unicode:{apple:"1F4D5",google:"1F4D5",twitter:"1F4D5"},shortcode:"closed_book",description:"CLOSED BOOK",category:"object"},{name:"green_book",unicode:{apple:"1F4D7",google:"1F4D7",twitter:"1F4D7"},shortcode:"green_book",description:"GREEN BOOK",category:"object"},{name:"blue_book",unicode:{apple:"1F4D8",google:"1F4D8",twitter:"1F4D8"},shortcode:"blue_book",description:"BLUE BOOK",category:"object"},{name:"orange_book",unicode:{apple:"1F4D9",google:"1F4D9",twitter:"1F4D9"},shortcode:"orange_book",description:"ORANGE BOOK",category:"object"},{name:"notebook_with_decorative_cover",unicode:{apple:"1F4D4",google:"1F4D4",twitter:"1F4D4"},shortcode:"notebook_with_decorative_cover",description:"NOTEBOOK WITH DECORATIVE COVER",category:"object"},{name:"ledger",unicode:{apple:"1F4D2",google:"1F4D2",twitter:"1F4D2"},shortcode:"ledger",description:"LEDGER",category:"object"},{name:"books",unicode:{apple:"1F4DA",google:"1F4DA",twitter:"1F4DA"},shortcode:"books",description:"BOOKS",category:"object"},{name:"book",unicode:{apple:"1F4D6",google:"1F4D6",twitter:"1F4D6"},shortcode:"book",description:"OPEN BOOK",category:"object"},{name:"link",unicode:{apple:"1F517",google:"1F517",twitter:"1F517"},shortcode:"link",description:"LINK SYMBOL",category:"object"},{name:"paperclip",unicode:{apple:"1F4CE",google:"1F4CE",twitter:"1F4CE"},shortcode:"paperclip",description:"PAPERCLIP",category:"object"},{name:"linked_paperclips",unicode:{apple:"1F587",google:"1F587",twitter:"1F587"},shortcode:"linked_paperclips",description:"LINKED PAPERCLIPS",category:"object"},{name:"scissors",unicode:{apple:"2702",google:"2702",twitter:"2702"},shortcode:"scissors",description:"BLACK SCISSORS",category:"object"},{name:"triangular_ruler",unicode:{apple:"1F4D0",google:"1F4D0",twitter:"1F4D0"},shortcode:"triangular_ruler",description:"TRIANGULAR RULER",category:"object"},{name:"straight_ruler",unicode:{apple:"1F4CF",google:"1F4CF",twitter:"1F4CF"},shortcode:"straight_ruler",description:"STRAIGHT RULER",category:"object"},{name:"pushpin",unicode:{apple:"1F4CC",google:"1F4CC",twitter:"1F4CC"},shortcode:"pushpin",description:"PUSHPIN",category:"object"},{name:"round_pushpin",unicode:{apple:"1F4CD",google:"1F4CD",twitter:"1F4CD"},shortcode:"round_pushpin",description:"ROUND PUSHPIN",category:"object"},{name:"triangular_flag_on_post",unicode:{apple:"1F6A9",google:"1F6A9",twitter:"1F6A9"},shortcode:"triangular_flag_on_post",description:"TRIANGULAR FLAG ON POST",category:"object"},{name:"waving_white_flag",unicode:{apple:"1F3F3",google:"1F3F3",twitter:"1F3F3"},shortcode:"waving_white_flag",description:"WAVING WHITE FLAG",category:"object"},{name:"waving_black_flag",unicode:{apple:"1F3F4",google:"1F3F4",twitter:"1F3F4"},shortcode:"waving_black_flag",description:"WAVING BLACK FLAG",category:"object"},{name:"closed_lock_with_key",unicode:{apple:"1F510",google:"1F510",twitter:"1F510"},shortcode:"closed_lock_with_key",description:"CLOSED LOCK WITH KEY",category:"object"},{name:"lock",unicode:{apple:"1F512",google:"1F512",twitter:"1F512"},shortcode:"lock",description:"LOCK",category:"object"},{name:"unlock",unicode:{apple:"1F513",google:"1F513",twitter:"1F513"},shortcode:"unlock",description:"OPEN LOCK",category:"object"},{name:"lock_with_ink_pen",unicode:{apple:"1F50F",google:"1F50F",twitter:"1F50F"},shortcode:"lock_with_ink_pen",description:"LOCK WITH INK PEN",category:"object"},{name:"lower_left_ballpoint_pen",unicode:{apple:"1F58A",google:"1F58A",twitter:"1F58A"},shortcode:"lower_left_ballpoint_pen",description:"LOWER LEFT BALLPOINT PEN",category:"object"},{name:"lower_left_fountain_pen",unicode:{apple:"1F58B",google:"1F58B",twitter:"1F58B"},shortcode:"lower_left_fountain_pen",description:"LOWER LEFT FOUNTAIN PEN",category:"object"},{name:"black_nib",unicode:{apple:"2712",google:"2712",twitter:"2712"},shortcode:"black_nib",description:"BLACK NIB",category:"folderol"},{name:"memo",unicode:{apple:"1F4DD",google:"1F4DD",twitter:"1F4DD"},shortcode:"memo",description:"MEMO",category:"object"},{name:"pencil2",unicode:{apple:"270F-FE0F",google:"270F-FE0F",twitter:"270F-FE0F"},shortcode:"pencil2",description:"PENCIL",category:"object"},{name:"lower_left_crayon",unicode:{apple:"1F58D",google:"1F58D",twitter:"1F58D"},shortcode:"lower_left_crayon",description:"LOWER LEFT CRAYON",category:"object"},{name:"lower_left_paintbrush",unicode:{apple:"1F58C",google:"1F58C",twitter:"1F58C"},shortcode:"lower_left_paintbrush",description:"LOWER LEFT PAINTBRUSH",category:"object"},{name:"mag",unicode:{apple:"1F50D",google:"1F50D",twitter:"1F50D"},shortcode:"mag",description:"LEFT-POINTING MAGNIFYING GLASS",category:"object"},{name:"mag_right",unicode:{apple:"1F50E",google:"1F50E",twitter:"1F50E"},shortcode:"mag_right",description:"RIGHT-POINTING MAGNIFYING GLASS",category:"object"},{name:"heart",unicode:{apple:"2764",google:"2764",twitter:"2764"},shortcode:"heart",description:"HEAVY BLACK HEART",category:"symbol"},{name:"yellow_heart",unicode:{apple:"1F49B",google:"1F49B",twitter:"1F49B"},shortcode:"yellow_heart",description:"YELLOW HEART",category:"symbol"},{name:"green_heart",unicode:{apple:"1F49A",google:"1F49A",twitter:"1F49A"},shortcode:"green_heart",description:"GREEN HEART",category:"symbol"},{name:"blue_heart",unicode:{apple:"1F499",google:"1F499",twitter:"1F499"},shortcode:"blue_heart",description:"BLUE HEART",category:"symbol"},{name:"purple_heart",unicode:{apple:"1F49C",google:"1F49C",twitter:"1F49C"},shortcode:"purple_heart",description:"PURPLE HEART",category:"symbol"},{name:"broken_heart",unicode:{apple:"1F494",google:"1F494",twitter:"1F494"},shortcode:"broken_heart",description:"BROKEN HEART",category:"symbol"},{name:"heavy_heart_exclamation_mark_ornament",unicode:{apple:"2763",google:"2763",twitter:"2763"},shortcode:"heavy_heart_exclamation_mark_ornament",description:"HEAVY HEART EXCLAMATION MARK ORNAMENT",category:"symbol"},{name:"two_hearts",unicode:{apple:"1F495",google:"1F495",twitter:"1F495"},shortcode:"two_hearts",description:"TWO HEARTS",category:"symbol"},{name:"revolving_hearts",unicode:{apple:"1F49E",google:"1F49E",twitter:"1F49E"},shortcode:"revolving_hearts",description:"REVOLVING HEARTS",category:"symbol"},{name:"heartbeat",unicode:{apple:"1F493",google:"1F493",twitter:"1F493"},shortcode:"heartbeat",description:"BEATING HEART",category:"symbol"},{name:"heartpulse",unicode:{apple:"1F497",google:"1F497",twitter:"1F497"},shortcode:"heartpulse",description:"GROWING HEART",category:"symbol"},{name:"sparkling_heart",unicode:{apple:"1F496",google:"1F496",twitter:"1F496"},shortcode:"sparkling_heart",description:"SPARKLING HEART",category:"symbol"},{name:"cupid",unicode:{apple:"1F498",google:"1F498",twitter:"1F498"},shortcode:"cupid",description:"HEART WITH ARROW",category:"symbol"},{name:"gift_heart",unicode:{apple:"1F49D",google:"1F49D",twitter:"1F49D"},shortcode:"gift_heart",description:"HEART WITH RIBBON",category:"symbol"},{name:"heart_decoration",unicode:{apple:"1F49F",google:"1F49F",twitter:"1F49F"},shortcode:"heart_decoration",description:"HEART DECORATION",category:"symbol"},{name:"peace_symbol",unicode:{apple:"262E",google:"262E",twitter:"262E"},shortcode:"peace_symbol",description:"PEACE SYMBOL",category:"symbol"},{name:"latin_cross",unicode:{apple:"271D",google:"271D",twitter:"271D"},shortcode:"latin_cross",description:"LATIN CROSS",category:"symbol"},{name:"star_and_crescent",unicode:{apple:"262A",google:"262A",twitter:"262A"},shortcode:"star_and_crescent",description:"STAR AND CRESCENT",category:"symbol"},{name:"om_symbol",unicode:{apple:"1F549",google:"1F549",twitter:"1F549"},shortcode:"om_symbol",description:"OM SYMBOL",category:"symbol"},{name:"wheel_of_dharma",unicode:{apple:"2638",google:"2638",twitter:"2638"},shortcode:"wheel_of_dharma",description:"WHEEL OF DHARMA",category:"symbol"},{name:"star_of_david",unicode:{apple:"2721",google:"2721",twitter:"2721"},shortcode:"star_of_david",description:"STAR OF DAVID",category:"symbol"},{name:"six_pointed_star",unicode:{apple:"1F52F",google:"1F52F",twitter:"1F52F"},shortcode:"six_pointed_star",description:"SIX POINTED STAR WITH MIDDLE DOT",category:"symbol"},{name:"menorah_with_nine_branches",unicode:{apple:"1F54E",google:"1F54E",twitter:"1F54E"},shortcode:"menorah_with_nine_branches",description:"MENORAH WITH NINE BRANCHES",category:"symbol"},{name:"yin_yang",unicode:{apple:"262F",google:"262F",twitter:"262F"},shortcode:"yin_yang",description:"YIN YANG",category:"symbol"},{name:"orthodox_cross",unicode:{apple:"2626",google:"2626",twitter:"2626"},shortcode:"orthodox_cross",description:"ORTHODOX CROSS",category:"symbol"},{name:"place_of_worship",unicode:{apple:"1F6D0",google:"1F6D0",twitter:"1F6D0"},shortcode:"place_of_worship",description:"PLACE OF WORSHIP",category:"symbol"},{name:"ophiuchus",unicode:{apple:"26CE",google:"26CE",twitter:"26CE"},shortcode:"ophiuchus",description:"OPHIUCHUS",category:"symbol"},{name:"aries",unicode:{apple:"2648",google:"2648",twitter:"2648"},shortcode:"aries",description:"ARIES",category:"symbol"},{name:"taurus",unicode:{apple:"2649",google:"2649",twitter:"2649"},shortcode:"taurus",description:"TAURUS",category:"symbol"},{name:"gemini",unicode:{apple:"264A",google:"264A",twitter:"264A"},shortcode:"gemini",description:"GEMINI",category:"symbol"},{name:"cancer",unicode:{apple:"264B",google:"264B",twitter:"264B"},shortcode:"cancer",description:"CANCER",category:"symbol"},{name:"leo",unicode:{apple:"264C",google:"264C",twitter:"264C"},shortcode:"leo",description:"LEO",category:"symbol"},{name:"virgo",unicode:{apple:"264D",google:"264D",twitter:"264D"},shortcode:"virgo",description:"VIRGO",category:"symbol"},{name:"libra",unicode:{apple:"264E",google:"264E",twitter:"264E"},shortcode:"libra",description:"LIBRA",category:"symbol"},{name:"scorpius",unicode:{apple:"264F",google:"264F",twitter:"264F"},shortcode:"scorpius",description:"SCORPIUS",category:"symbol"},{name:"sagittarius",unicode:{apple:"2650",google:"2650",twitter:"2650"},shortcode:"sagittarius",description:"SAGITTARIUS",category:"symbol"},{name:"capricorn",unicode:{apple:"2651",google:"2651",twitter:"2651"},shortcode:"capricorn",description:"CAPRICORN",category:"symbol"},{name:"aquarius",unicode:{apple:"2652",google:"2652",twitter:"2652"},shortcode:"aquarius",description:"AQUARIUS",category:"symbol"},{name:"pisces",unicode:{apple:"2653",google:"2653",twitter:"2653"},shortcode:"pisces",description:"PISCES",category:"symbol"},{name:"id",unicode:{apple:"1F194",google:"1F194",twitter:"1F194"},shortcode:"id",description:"SQUARED ID",category:"symbol"},{name:"atom_symbol",unicode:{apple:"269B",google:"269B",twitter:"269B"},shortcode:"atom_symbol",description:"ATOM SYMBOL",category:"symbol"},{name:"u7a7a",unicode:{apple:"1F233",google:"1F233",twitter:"1F233"},shortcode:"u7a7a",description:"SQUARED CJK UNIFIED IDEOGRAPH-7A7A",category:"symbol"},{name:"u5272",unicode:{apple:"1F239",google:"1F239",twitter:"1F239"},shortcode:"u5272",description:"SQUARED CJK UNIFIED IDEOGRAPH-5272",category:"symbol"},{name:"radioactive_sign",unicode:{apple:"2622",google:"2622",twitter:"2622"},shortcode:"radioactive_sign",description:"RADIOACTIVE SIGN",category:"symbol"},{name:"biohazard_sign",unicode:{apple:"2623",google:"2623",twitter:"2623"},shortcode:"biohazard_sign",description:"BIOHAZARD SIGN",category:"symbol"},{name:"mobile_phone_off",unicode:{apple:"1F4F4",google:"1F4F4",twitter:"1F4F4"},shortcode:"mobile_phone_off",description:"MOBILE PHONE OFF",category:"symbol"},{name:"vibration_mode",unicode:{apple:"1F4F3",google:"1F4F3",twitter:"1F4F3"},shortcode:"vibration_mode",description:"VIBRATION MODE",category:"symbol"},{name:"u6709",unicode:{apple:"1F236",google:"1F236",twitter:"1F236"},shortcode:"u6709",description:"SQUARED CJK UNIFIED IDEOGRAPH-6709",category:"symbol"},{name:"u7121",unicode:{apple:"1F21A",google:"1F21A",twitter:"1F21A"},shortcode:"u7121",description:"SQUARED CJK UNIFIED IDEOGRAPH-7121",category:"symbol"},{name:"u7533",unicode:{apple:"1F238",google:"1F238",twitter:"1F238"},shortcode:"u7533",description:"SQUARED CJK UNIFIED IDEOGRAPH-7533",category:"symbol"},{name:"u55b6",unicode:{apple:"1F23A",google:"1F23A",twitter:"1F23A"},shortcode:"u55b6",description:"SQUARED CJK UNIFIED IDEOGRAPH-55B6",category:"symbol"},{name:"u6708",unicode:{apple:"1F237",google:"1F237",twitter:"1F237"},shortcode:"u6708",description:"SQUARED CJK UNIFIED IDEOGRAPH-6708",category:"symbol"},{name:"eight_pointed_black_star",unicode:{apple:"2734",google:"2734",twitter:"2734"},shortcode:"eight_pointed_black_star",description:"EIGHT POINTED BLACK STAR",category:"symbol"},{name:"vs",unicode:{apple:"1F19A",google:"1F19A",twitter:"1F19A"},shortcode:"vs",description:"SQUARED VS",category:"symbol"},{name:"accept",unicode:{apple:"1F251",google:"1F251",twitter:"1F251"},shortcode:"accept",description:"CIRCLED IDEOGRAPH ACCEPT",category:"symbol"},{name:"white_flower",unicode:{apple:"1F4AE",google:"1F4AE",twitter:"1F4AE"},shortcode:"white_flower",description:"WHITE FLOWER",category:"symbol"},{name:"ideograph_advantage",unicode:{apple:"1F250",google:"1F250",twitter:"1F250"},shortcode:"ideograph_advantage",description:"CIRCLED IDEOGRAPH ADVANTAGE",category:"symbol"},{name:"secret",unicode:{apple:"3299",google:"3299",twitter:"3299"},shortcode:"secret",description:"CIRCLED IDEOGRAPH SECRET",category:"symbol"},{name:"congratulations",unicode:{apple:"3297",google:"3297",twitter:"3297"},shortcode:"congratulations",description:"CIRCLED IDEOGRAPH CONGRATULATION",category:"symbol"},{name:"u5408",unicode:{apple:"1F234",google:"1F234",twitter:"1F234"},shortcode:"u5408",description:"SQUARED CJK UNIFIED IDEOGRAPH-5408",category:"symbol"},{name:"u6e80",unicode:{apple:"1F235",google:"1F235",twitter:"1F235"},shortcode:"u6e80",description:"SQUARED CJK UNIFIED IDEOGRAPH-6E80",category:"symbol"},{name:"u7981",unicode:{apple:"1F232",google:"1F232",twitter:"1F232"},shortcode:"u7981",description:"SQUARED CJK UNIFIED IDEOGRAPH-7981",category:"symbol"},{name:"a",unicode:{apple:"1F170",google:"1F170",twitter:"1F170"},shortcode:"a",description:"NEGATIVE SQUARED LATIN CAPITAL LETTER A",category:"symbol"},{name:"b",unicode:{apple:"1F171",google:"1F171",twitter:"1F171"},shortcode:"b",description:"NEGATIVE SQUARED LATIN CAPITAL LETTER B",category:"symbol"},{name:"ab",unicode:{apple:"1F18E",google:"1F18E",twitter:"1F18E"},shortcode:"ab",description:"NEGATIVE SQUARED AB",category:"symbol"},{name:"cl",unicode:{apple:"1F191",google:"1F191",twitter:"1F191"},shortcode:"cl",description:"SQUARED CL",category:"symbol"},{name:"o2",unicode:{apple:"1F17E",google:"1F17E",twitter:"1F17E"},shortcode:"o2",description:"NEGATIVE SQUARED LATIN CAPITAL LETTER O",category:"symbol"},{name:"sos",unicode:{apple:"1F198",google:"1F198",twitter:"1F198"},shortcode:"sos",description:"SQUARED SOS",category:"symbol"},{name:"no_entry",unicode:{apple:"26D4",google:"26D4",twitter:"26D4"},shortcode:"no_entry",description:"NO ENTRY",category:"symbol"},{name:"name_badge",unicode:{apple:"1F4DB",google:"1F4DB",twitter:"1F4DB"},shortcode:"name_badge",description:"NAME BADGE",category:"symbol"},{name:"no_entry_sign",unicode:{apple:"1F6AB",google:"1F6AB",twitter:"1F6AB"},shortcode:"no_entry_sign",description:"NO ENTRY SIGN",category:"symbol"},{name:"x",unicode:{apple:"274C",google:"274C",twitter:"274C"},shortcode:"x",description:"CROSS MARK",category:"symbol"},{name:"o",unicode:{apple:"2B55",google:"2B55",twitter:"2B55"},shortcode:"o",description:"HEAVY LARGE CIRCLE",category:"symbol"},{name:"anger",unicode:{apple:"1F4A2",google:"1F4A2",twitter:"1F4A2"},shortcode:"anger",description:"ANGER SYMBOL",category:"symbol"},{name:"hotsprings",unicode:{apple:"2668",google:"2668",twitter:"2668"},shortcode:"hotsprings",description:"HOT SPRINGS",category:"symbol"},{name:"no_pedestrians",unicode:{apple:"1F6B7",google:"1F6B7",twitter:"1F6B7"},shortcode:"no_pedestrians",description:"NO PEDESTRIANS",category:"symbol"},{name:"do_not_litter",unicode:{apple:"1F6AF",google:"1F6AF",twitter:"1F6AF"},shortcode:"do_not_litter",description:"DO NOT LITTER SYMBOL",category:"symbol"},{name:"no_bicycles",unicode:{apple:"1F6B3",google:"1F6B3",twitter:"1F6B3"},shortcode:"no_bicycles",description:"NO BICYCLES",category:"symbol"},{name:"non-potable_water",unicode:{apple:"1F6B1",google:"1F6B1",twitter:"1F6B1"},shortcode:"non-potable_water",description:"NON-POTABLE WATER SYMBOL",category:"symbol"},{name:"underage",unicode:{apple:"1F51E",google:"1F51E",twitter:"1F51E"},shortcode:"underage",description:"NO ONE UNDER EIGHTEEN SYMBOL",category:"symbol"},{name:"no_mobile_phones",unicode:{apple:"1F4F5",google:"1F4F5",twitter:"1F4F5"},shortcode:"no_mobile_phones",description:"NO MOBILE PHONES",category:"symbol"},{name:"no_smoking",unicode:{apple:"1F6AD",google:"1F6AD",twitter:"1F6AD"},shortcode:"no_smoking",description:"NO SMOKING SYMBOL",category:"symbol"},{name:"exclamation",unicode:{apple:"2757",google:"2757",twitter:"2757"},shortcode:"exclamation",description:"HEAVY EXCLAMATION MARK SYMBOL",category:"symbol"},{name:"grey_exclamation",unicode:{apple:"2755",google:"2755",twitter:"2755"},shortcode:"grey_exclamation",description:"WHITE EXCLAMATION MARK ORNAMENT",category:"symbol"},{name:"question",unicode:{apple:"2753",google:"2753",twitter:"2753"},shortcode:"question",description:"BLACK QUESTION MARK ORNAMENT",category:"symbol"},{name:"grey_question",unicode:{apple:"2754",google:"2754",twitter:"2754"},shortcode:"grey_question",description:"WHITE QUESTION MARK ORNAMENT",category:"symbol"},{name:"bangbang",unicode:{apple:"203C",google:"203C",twitter:"203C"},shortcode:"bangbang",description:"DOUBLE EXCLAMATION MARK",category:"symbol"},{name:"interrobang",unicode:{apple:"2049",google:"2049",twitter:"2049"},shortcode:"interrobang",description:"EXCLAMATION QUESTION MARK",category:"symbol"},{name:"100",unicode:{apple:"1F4AF",google:"1F4AF",twitter:"1F4AF"},shortcode:"100",description:"HUNDRED POINTS SYMBOL",category:"symbol"},{name:"low_brightness",unicode:{apple:"1F505",google:"1F505",twitter:"1F505"},shortcode:"low_brightness",description:"LOW BRIGHTNESS SYMBOL",category:"symbol"},{name:"high_brightness",unicode:{apple:"1F506",google:"1F506",twitter:"1F506"},shortcode:"high_brightness",description:"HIGH BRIGHTNESS SYMBOL",category:"symbol"},{name:"trident",unicode:{apple:"1F531",google:"1F531",twitter:"1F531"},shortcode:"trident",description:"TRIDENT EMBLEM",category:"symbol"},{name:"fleur_de_lis",unicode:{apple:"269C",google:"269C",twitter:"269C"},shortcode:"fleur_de_lis",description:"FLEUR-DE-LIS",category:"symbol"},{name:"part_alternation_mark",unicode:{apple:"303D",google:"303D",twitter:"303D"},shortcode:"part_alternation_mark",description:"PART ALTERNATION MARK",category:"symbol"},{name:"warning",unicode:{apple:"26A0",google:"26A0",twitter:"26A0"},shortcode:"warning",description:"WARNING SIGN",category:"symbol"},{name:"children_crossing",unicode:{apple:"1F6B8",google:"1F6B8",twitter:"1F6B8"},shortcode:"children_crossing",description:"CHILDREN CROSSING",category:"symbol"},{name:"beginner",unicode:{apple:"1F530",google:"1F530",twitter:"1F530"},shortcode:"beginner",description:"JAPANESE SYMBOL FOR BEGINNER",category:"symbol"},{name:"recycle",unicode:{apple:"267B",google:"267B",twitter:"267B"},shortcode:"recycle",description:"BLACK UNIVERSAL RECYCLING SYMBOL",category:"symbol"},{name:"u6307",unicode:{apple:"1F22F",google:"1F22F",twitter:"1F22F"},shortcode:"u6307",description:"SQUARED CJK UNIFIED IDEOGRAPH-6307",category:"symbol"},{name:"chart",unicode:{apple:"1F4B9",google:"1F4B9",twitter:"1F4B9"},shortcode:"chart",description:"CHART WITH UPWARDS TREND AND YEN SIGN",category:"symbol"},{name:"sparkle",unicode:{apple:"2747",google:"2747",twitter:"2747"},shortcode:"sparkle",description:"SPARKLE",category:"symbol"},{name:"eight_spoked_asterisk",unicode:{apple:"2733-FE0F",google:"2733-FE0F",twitter:"2733-FE0F"},shortcode:"eight_spoked_asterisk",description:"EIGHT SPOKED ASTERISK",category:"symbol"},{name:"negative_squared_cross_mark",unicode:{apple:"274E",google:"274E",twitter:"274E"},shortcode:"negative_squared_cross_mark",description:"NEGATIVE SQUARED CROSS MARK",category:"symbol"},{name:"white_check_mark",unicode:{apple:"2705",google:"2705",twitter:"2705"},shortcode:"white_check_mark",description:"WHITE HEAVY CHECK MARK",category:"symbol"},{name:"diamond_shape_with_a_dot_inside",unicode:{apple:"1F4A0",google:"1F4A0",twitter:"1F4A0"},shortcode:"diamond_shape_with_a_dot_inside",description:"DIAMOND SHAPE WITH A DOT INSIDE",category:"symbol"},{name:"cyclone",unicode:{apple:"1F300",google:"1F300",twitter:"1F300"},shortcode:"cyclone",description:"CYCLONE",category:"symbol"},{name:"loop",unicode:{apple:"27BF",google:"27BF",twitter:"27BF"},shortcode:"loop",description:"DOUBLE CURLY LOOP",category:"symbol"},{name:"globe_with_meridians",unicode:{apple:"1F310",google:"1F310",twitter:"1F310"},shortcode:"globe_with_meridians",description:"GLOBE WITH MERIDIANS",category:"symbol"},{name:"m",unicode:{apple:"24C2",google:"24C2",twitter:"24C2"},shortcode:"m",description:"CIRCLED LATIN CAPITAL LETTER M",category:"symbol"},{name:"atm",unicode:{apple:"1F3E7",google:"1F3E7",twitter:"1F3E7"},shortcode:"atm",description:"AUTOMATED TELLER MACHINE",category:"symbol"},{name:"sa",unicode:{apple:"1F202",google:"1F202",twitter:"1F202"},shortcode:"sa",description:"SQUARED KATAKANA SA",category:"symbol"},{name:"passport_control",unicode:{apple:"1F6C2",google:"1F6C2",twitter:"1F6C2"},shortcode:"passport_control",description:"PASSPORT CONTROL",category:"symbol"},{name:"customs",unicode:{apple:"1F6C3",google:"1F6C3",twitter:"1F6C3"},shortcode:"customs",description:"CUSTOMS",category:"symbol"},{name:"baggage_claim",unicode:{apple:"1F6C4",google:"1F6C4",twitter:"1F6C4"},shortcode:"baggage_claim",description:"BAGGAGE CLAIM",category:"symbol"},{name:"left_luggage",unicode:{apple:"1F6C5",google:"1F6C5",twitter:"1F6C5"},shortcode:"left_luggage",description:"LEFT LUGGAGE",category:"symbol"},{name:"wheelchair",unicode:{apple:"267F",google:"267F",twitter:"267F"},shortcode:"wheelchair",description:"WHEELCHAIR SYMBOL",category:"symbol"},{name:"wc",unicode:{apple:"1F6BE",google:"1F6BE",twitter:"1F6BE"},shortcode:"wc",description:"WATER CLOSET",category:"symbol"},{name:"parking",unicode:{apple:"1F17F",google:"1F17F",twitter:"1F17F"},shortcode:"parking",description:"NEGATIVE SQUARED LATIN CAPITAL LETTER P",category:"symbol"},{name:"potable_water",unicode:{apple:"1F6B0",google:"1F6B0",twitter:"1F6B0"},shortcode:"potable_water",description:"POTABLE WATER SYMBOL",category:"symbol"},{name:"mens",unicode:{apple:"1F6B9",google:"1F6B9",twitter:"1F6B9"},shortcode:"mens",description:"MENS SYMBOL",category:"symbol"},{name:"womens",unicode:{apple:"1F6BA",google:"1F6BA",twitter:"1F6BA"},shortcode:"womens",description:"WOMENS SYMBOL",category:"symbol"},{name:"baby_symbol",unicode:{apple:"1F6BC",google:"1F6BC",twitter:"1F6BC"},shortcode:"baby_symbol",description:"BABY SYMBOL",category:"symbol"},{name:"restroom",unicode:{apple:"",google:"1F6BB",twitter:"1F6BB"},shortcode:"restroom",description:"RESTROOM",category:"symbol"},{name:"put_litter_in_its_place",unicode:{apple:"1F6AE",google:"1F6AE",twitter:"1F6AE"},shortcode:"put_litter_in_its_place",description:"PUT LITTER IN ITS PLACE SYMBOL",category:"symbol"},{name:"cinema",unicode:{apple:"1F3A6",google:"1F3A6",twitter:"1F3A6"},shortcode:"cinema",description:"CINEMA",category:"symbol"},{name:"signal_strength",unicode:{apple:"1F4F6",google:"1F4F6",twitter:"1F4F6"},shortcode:"signal_strength",description:"ANTENNA WITH BARS",category:"symbol"},{name:"koko",unicode:{apple:"",google:"1F201",twitter:"1F201"},shortcode:"koko",description:"SQUARED KATAKANA KOKO",category:"symbol"},{name:"ng",unicode:{apple:"1F196",google:"1F196",twitter:"1F196"},shortcode:"ng",description:"SQUARED NG",category:"symbol"},{name:"ok",unicode:{apple:"1F197",google:"1F197",twitter:"1F197"},shortcode:"ok",description:"SQUARED OK",category:"symbol"},{name:"up",unicode:{apple:"1F199",google:"1F199",twitter:"1F199"},shortcode:"up",description:"SQUARED UP WITH EXCLAMATION MARK",category:"symbol"},{name:"cool",unicode:{apple:"1F192",google:"1F192",twitter:"1F192"},shortcode:"cool",description:"SQUARED COOL",category:"symbol"},{name:"new",unicode:{apple:"1F195",google:"1F195",twitter:"1F195"},shortcode:"new",description:"SQUARED NEW",category:"symbol"},{name:"free",unicode:{apple:"1F193",google:"1F193",twitter:"1F193"},shortcode:"free",description:"SQUARED FREE",category:"symbol"},{name:"zero",unicode:{apple:"0030-20E3",google:"0030-20E3",twitter:"0030-20E3"},shortcode:"zero",description:"KEYCAP 0",category:"symbol"},{name:"one",unicode:{apple:"0031-20E3",google:"0031-20E3",twitter:"0031-20E3"},shortcode:"one",description:"KEYCAP 1",category:"symbol"},{name:"two",unicode:{apple:"0032-20E3",google:"0032-20E3",twitter:"0032-20E3"},shortcode:"two",description:"KEYCAP 2",category:"symbol"},{name:"three",unicode:{apple:"0033-20E3",google:"0033-20E3",twitter:"0033-20E3"},shortcode:"three",description:"KEYCAP 3",category:"symbol"},{name:"four",unicode:{apple:"0034-20E3",google:"0034-20E3",twitter:"0034-20E3"},shortcode:"four",description:"KEYCAP 4",category:"symbol"},{name:"five",unicode:{apple:"0035-20E3",google:"0035-20E3",twitter:"0035-20E3"},shortcode:"five",description:"KEYCAP 5",category:"symbol"},{name:"six",unicode:{apple:"0036-20E3",google:"0036-20E3",twitter:"0036-20E3"},shortcode:"six",description:"KEYCAP 6",category:"symbol"},{name:"seven",unicode:{apple:"0037-20E3",google:"0037-20E3",twitter:"0037-20E3"},shortcode:"seven",description:"KEYCAP 7",category:"symbol"},{name:"eight",unicode:{apple:"0038-20E3",google:"0038-20E3",twitter:"0038-20E3"},shortcode:"eight",description:"KEYCAP 8",category:"symbol"},{name:"nine",unicode:{apple:"0039-20E3",google:"0039-20E3",twitter:"0039-20E3"},shortcode:"nine",description:"KEYCAP 9",category:"symbol"},{name:"keycap_ten",unicode:{apple:"1F51F",google:"1F51F",twitter:"1F51F"},shortcode:"keycap_ten",description:"KEYCAP TEN",category:"symbol"},{name:"1234",unicode:{apple:"1F522",google:"1F522",twitter:"1F522"},shortcode:"1234",description:"INPUT SYMBOL FOR NUMBERS",category:"symbol"},{name:"arrow_forward",unicode:{apple:"25B6",google:"25B6",twitter:"25B6"},shortcode:"arrow_forward",description:"BLACK RIGHT-POINTING TRIANGLE",category:"symbol"},{name:"double_vertical_bar",unicode:{apple:"23F8",google:"23F8",twitter:"23F8"},shortcode:"double_vertical_bar",description:"DOUBLE VERTICAL BAR"},{name:"black_right_pointing_triangle_with_double_vertical_bar",unicode:{apple:"23EF",google:"23EF",twitter:"23EF"},shortcode:"black_right_pointing_triangle_with_double_vertical_bar",description:"BLACK RIGHT-POINTING TRIANGLE WITH DOUBLE VERTICAL BAR"},{name:"black_square_for_stop",unicode:{apple:"23F9",google:"23F9",twitter:"23F9"},shortcode:"black_square_for_stop",description:"BLACK SQUARE FOR STOP"},{name:"black_circle_for_record",unicode:{apple:"23FA",google:"23FA",twitter:"23FA"},shortcode:"black_circle_for_record",description:"BLACK CIRCLE FOR RECORD"},{name:"black_right_pointing_double_triangle_with_vertical_bar",unicode:{apple:"23ED",google:"23ED",twitter:"23ED"},shortcode:"black_right_pointing_double_triangle_with_vertical_bar",description:"BLACK RIGHT-POINTING DOUBLE TRIANGLE WITH VERTICAL BAR"},{name:"black_left_pointing_double_triangle_with_vertical_bar",unicode:{apple:"23EE",google:"23EE",twitter:"23EE"},shortcode:"black_left_pointing_double_triangle_with_vertical_bar",description:"BLACK LEFT-POINTING DOUBLE TRIANGLE WITH VERTICAL BAR"},{name:"fast_forward",unicode:{apple:"23E9",google:"23E9",twitter:"23E9"},shortcode:"fast_forward",description:"BLACK RIGHT-POINTING DOUBLE TRIANGLE"},{name:"rewind",unicode:{apple:"23EA",google:"23EA",twitter:"23EA"},shortcode:"rewind",description:"BLACK LEFT-POINTING DOUBLE TRIANGLE",category:"symbol"},{name:"twisted_rightwards_arrows",unicode:{apple:"1F500",google:"1F500",twitter:"1F500"},shortcode:"twisted_rightwards_arrows",description:"TWISTED RIGHTWARDS ARROWS",category:"symbol"},{name:"repeat",unicode:{apple:"1F501",google:"1F501",twitter:"1F501"},shortcode:"repeat",description:"CLOCKWISE RIGHTWARDS AND LEFTWARDS OPEN CIRCLE ARROWS",category:"symbol"},{name:"repeat_one",unicode:{apple:"1F502",google:"1F502",twitter:"1F502"},shortcode:"repeat_one",description:"CLOCKWISE RIGHTWARDS AND LEFTWARDS OPEN CIRCLE ARROWS WITH CIRCLED ONE OVERLAY",
category:"symbol"},{name:"arrow_backward",unicode:{apple:"25C0",google:"25C0",twitter:"25C0"},shortcode:"arrow_backward",description:"BLACK LEFT-POINTING TRIANGLE",category:"symbol"},{name:"arrow_up_small",unicode:{apple:"1F53C",google:"1F53C",twitter:"1F53C"},shortcode:"arrow_up_small",description:"UP-POINTING SMALL RED TRIANGLE",category:"symbol"},{name:"arrow_down_small",unicode:{apple:"1F53D",google:"1F53D",twitter:"1F53D"},shortcode:"arrow_down_small",description:"DOWN-POINTING SMALL RED TRIANGLE",category:"symbol"},{name:"arrow_double_up",unicode:{apple:"23EB",google:"23EB",twitter:"23EB"},shortcode:"arrow_double_up",description:"BLACK UP-POINTING DOUBLE TRIANGLE",category:"symbol"},{name:"arrow_double_down",unicode:{apple:"23EC",google:"23EC",twitter:"23EC"},shortcode:"arrow_double_down",description:"BLACK DOWN-POINTING DOUBLE TRIANGLE",category:"symbol"},{name:"arrow_right",unicode:{apple:"27A1",google:"27A1",twitter:"27A1"},shortcode:"arrow_right",description:"BLACK RIGHTWARDS ARROW",category:"symbol"},{name:"arrow_left",unicode:{apple:"2B05",google:"2B05",twitter:"2B05"},shortcode:"arrow_left",description:"LEFTWARDS BLACK ARROW",category:"symbol"},{name:"arrow_up",unicode:{apple:"2B06",google:"2B06",twitter:"2B06"},shortcode:"arrow_up",description:"UPWARDS BLACK ARROW",category:"symbol"},{name:"arrow_down",unicode:{apple:"2B07",google:"2B07",twitter:"2B07"},shortcode:"arrow_down",description:"DOWNWARDS BLACK ARROW",category:"symbol"},{name:"arrow_upper_right",unicode:{apple:"2197",google:"2197",twitter:"2197"},shortcode:"arrow_upper_right",description:"NORTH EAST ARROW",category:"symbol"},{name:"arrow_lower_right",unicode:{apple:"2198",google:"2198",twitter:"2198"},shortcode:"arrow_lower_right",description:"SOUTH EAST ARROW",category:"symbol"},{name:"arrow_lower_left",unicode:{apple:"2199",google:"2199",twitter:"2199"},shortcode:"arrow_lower_left",description:"SOUTH WEST ARROW",category:"symbol"},{name:"arrow_upper_left",unicode:{apple:"2196",google:"2196",twitter:"2196"},shortcode:"arrow_upper_left",description:"NORTH WEST ARROW",category:"symbol"},{name:"arrow_up_down",unicode:{apple:"2195",google:"2195",twitter:"2195"},shortcode:"arrow_up_down",description:"UP DOWN ARROW",category:"symbol"},{name:"left_right_arrow",unicode:{apple:"2194",google:"2194",twitter:"2194"},shortcode:"left_right_arrow",description:"LEFT RIGHT ARROW",category:"symbol"},{name:"arrows_counterclockwise",unicode:{apple:"1F504",google:"1F504",twitter:"1F504"},shortcode:"arrows_counterclockwise",description:"ANTICLOCKWISE DOWNWARDS AND UPWARDS OPEN CIRCLE ARROWS",category:"symbol"},{name:"arrow_right_hook",unicode:{apple:"21AA",google:"21AA",twitter:"21AA"},shortcode:"arrow_right_hook",description:"RIGHTWARDS ARROW WITH HOOK",category:"symbol"},{name:"leftwards_arrow_with_hook",unicode:{apple:"21A9",google:"21A9",twitter:"21A9"},shortcode:"leftwards_arrow_with_hook",description:"LEFTWARDS ARROW WITH HOOK",category:"symbol"},{name:"arrow_heading_up",unicode:{apple:"2934",google:"2934",twitter:"2934"},shortcode:"arrow_heading_up",description:"ARROW POINTING RIGHTWARDS THEN CURVING UPWARDS",category:"symbol"},{name:"arrow_heading_down",unicode:{apple:"2935",google:"2935",twitter:"2935"},shortcode:"arrow_heading_down",description:"ARROW POINTING RIGHTWARDS THEN CURVING DOWNWARDS",category:"symbol"},{name:"arrows_clockwise",unicode:{apple:"1F503",google:"1F503",twitter:"1F503"},shortcode:"arrows_clockwise",description:"CLOCKWISE DOWNWARDS AND UPWARDS OPEN CIRCLE ARROWS",category:"symbol"},{name:"hash",unicode:{apple:"0023-20E3",google:"0023-20E3",twitter:"0023-20E3"},shortcode:"hash",description:"HASH KEY",category:"symbol"},{name:"information_source",unicode:{apple:"2139",google:"2139",twitter:"2139"},shortcode:"information_source",description:"INFORMATION SOURCE",category:"symbol"},{name:"abc",unicode:{apple:"1F524",google:"1F524",twitter:"1F524"},shortcode:"abc",description:"INPUT SYMBOL FOR LATIN LETTERS",category:"symbol"},{name:"abcd",unicode:{apple:"1F521",google:"1F521",twitter:"1F521"},shortcode:"abcd",description:"INPUT SYMBOL FOR LATIN SMALL LETTERS",category:"symbol"},{name:"capital_abcd",unicode:{apple:"1F520",google:"1F520",twitter:"1F520"},shortcode:"capital_abcd",description:"INPUT SYMBOL FOR LATIN CAPITAL LETTERS",category:"symbol"},{name:"symbols",unicode:{apple:"1F523",google:"1F523",twitter:"1F523"},shortcode:"symbols",description:"INPUT SYMBOL FOR SYMBOLS",category:"symbol"},{name:"musical_note",unicode:{apple:"1F3B5",google:"1F3B5",twitter:"1F3B5"},shortcode:"musical_note",description:"MUSICAL NOTE",category:"symbol"},{name:"notes",unicode:{apple:"1F3B6",google:"1F3B6",twitter:"1F3B6"},shortcode:"notes",description:"MULTIPLE MUSICAL NOTES",category:"symbol"},{name:"wavy_dash",unicode:{apple:"3030",google:"3030",twitter:"3030"},shortcode:"wavy_dash",description:"WAVY DASH",category:"symbol"},{name:"curly_loop",unicode:{apple:"27B0",google:"27B0",twitter:"27B0"},shortcode:"curly_loop",description:"CURLY LOOP",category:"symbol"},{name:"heavy_check_mark",unicode:{apple:"2714",google:"2714",twitter:"2714"},shortcode:"heavy_check_mark",description:"HEAVY CHECK MARK",category:"symbol"},{name:"heavy_plus_sign",unicode:{apple:"2795",google:"2795",twitter:"2795"},shortcode:"heavy_plus_sign",description:"HEAVY PLUS SIGN",category:"symbol"},{name:"heavy_minus_sign",unicode:{apple:"2796",google:"2796",twitter:"2796"},shortcode:"heavy_minus_sign",description:"HEAVY MINUS SIGN",category:"symbol"},{name:"heavy_multiplication_x",unicode:{apple:"2716",google:"2716",twitter:"2716"},shortcode:"heavy_multiplication_x",description:"HEAVY MULTIPLICATION X",category:"symbol"},{name:"heavy_division_sign",unicode:{apple:"2797",google:"2797",twitter:"2797"},shortcode:"heavy_division_sign",description:"HEAVY DIVISION SIGN",category:"symbol"},{name:"heavy_dollar_sign",unicode:{apple:"1F4B2",google:"1F4B2",twitter:"1F4B2"},shortcode:"heavy_dollar_sign",description:"HEAVY DOLLAR SIGN",category:"symbol"},{name:"copyright",unicode:{apple:"00A9",google:"00A9-FE0F",twitter:"00A9-FE0F"},shortcode:"copyright",description:"COPYRIGHT SIGN",category:"symbol"},{name:"registered",unicode:{apple:"00AE",google:"00AE-FE0F",twitter:"00AE-FE0F"},shortcode:"registered",description:"REGISTERED SIGN",category:"symbol"},{name:"tm",unicode:{apple:"2122",google:"2122",twitter:"2122"},shortcode:"tm",description:"TRADE MARK SIGN",category:"symbol"},{name:"end",unicode:{apple:"1F51A",google:"1F51A",twitter:"1F51A"},shortcode:"end",description:"END WITH LEFTWARDS ARROW ABOVE",category:"symbol"},{name:"back",unicode:{apple:"1F519",google:"1F519",twitter:"1F519"},shortcode:"back",description:"BACK WITH LEFTWARDS ARROW ABOVE",category:"symbol"},{name:"on",unicode:{apple:"1F51B",google:"1F51B",twitter:"1F51B"},shortcode:"on",description:"ON WITH EXCLAMATION MARK WITH LEFT RIGHT ARROW ABOVE",category:"symbol"},{name:"top",unicode:{apple:"1F51D",google:"1F51D",twitter:"1F51D"},shortcode:"top",description:"TOP WITH UPWARDS ARROW ABOVE",category:"symbol"},{name:"soon",unicode:{apple:"1F51C",google:"1F51C",twitter:"1F51C"},shortcode:"soon",description:"SOON WITH RIGHTWARDS ARROW ABOVE",category:"symbol"},{name:"ballot_box_with_check",unicode:{apple:"2611",google:"2611",twitter:"2611"},shortcode:"ballot_box_with_check",description:"BALLOT BOX WITH CHECK",category:"symbol"},{name:"radio_button",unicode:{apple:"1F518",google:"1F518",twitter:"1F518"},shortcode:"radio_button",description:"RADIO BUTTON",category:"symbol"},{name:"white_circle",unicode:{apple:"26AA",google:"26AA",twitter:"26AA"},shortcode:"white_circle",description:"MEDIUM WHITE CIRCLE",category:"symbol"},{name:"black_circle",unicode:{apple:"26AB",google:"26AB",twitter:"26AB"},shortcode:"black_circle",description:"MEDIUM BLACK CIRCLE",category:"symbol"},{name:"red_circle",unicode:{apple:"1F534",google:"1F534",twitter:"1F534"},shortcode:"red_circle",description:"LARGE RED CIRCLE",category:"symbol"},{name:"large_blue_circle",unicode:{apple:"1F535",google:"1F535",twitter:"1F535"},shortcode:"large_blue_circle",description:"LARGE BLUE CIRCLE",category:"symbol"},{name:"small_orange_diamond",unicode:{apple:"1F538",google:"1F538",twitter:"1F538"},shortcode:"small_orange_diamond",description:"SMALL ORANGE DIAMOND",category:"symbol"},{name:"small_blue_diamond",unicode:{apple:"1F539",google:"1F539",twitter:"1F539"},shortcode:"small_blue_diamond",description:"SMALL BLUE DIAMOND",category:"symbol"},{name:"large_orange_diamond",unicode:{apple:"1F536",google:"1F536",twitter:"1F536"},shortcode:"large_orange_diamond",description:"LARGE ORANGE DIAMOND",category:"symbol"},{name:"large_blue_diamond",unicode:{apple:"1F537",google:"1F537",twitter:"1F537"},shortcode:"large_blue_diamond",description:"LARGE BLUE DIAMOND",category:"symbol"},{name:"small_red_triangle",unicode:{apple:"1F53A",google:"1F53A",twitter:"1F53A"},shortcode:"small_red_triangle",description:"UP-POINTING RED TRIANGLE",category:"symbol"},{name:"black_small_square",unicode:{apple:"25AA",google:"25AA",twitter:"25AA"},shortcode:"black_small_square",description:"BLACK SMALL SQUARE",category:"symbol"},{name:"white_small_square",unicode:{apple:"25AB",google:"25AB",twitter:"25AB"},shortcode:"white_small_square",description:"WHITE SMALL SQUARE",category:"symbol"},{name:"black_large_square",unicode:{apple:"2B1B",google:"2B1B",twitter:"2B1B"},shortcode:"black_large_square",description:"BLACK LARGE SQUARE",category:"symbol"},{name:"white_large_square",unicode:{apple:"2B1C",google:"2B1C",twitter:"2B1C"},shortcode:"white_large_square",description:"WHITE LARGE SQUARE",category:"symbol"},{name:"small_red_triangle_down",unicode:{apple:"1F53B",google:"1F53B",twitter:"1F53B"},shortcode:"small_red_triangle_down",description:"DOWN-POINTING RED TRIANGLE",category:"symbol"},{name:"black_medium_square",unicode:{apple:"25FC",google:"25FC",twitter:"25FC"},shortcode:"black_medium_square",description:"BLACK MEDIUM SQUARE",category:"symbol"},{name:"white_medium_square",unicode:{apple:"25FB",google:"25FB",twitter:"25FB"},shortcode:"white_medium_square",description:"WHITE MEDIUM SQUARE",category:"symbol"},{name:"black_medium_small_square",unicode:{apple:"25FE",google:"25FE",twitter:"25FE"},shortcode:"black_medium_small_square",description:"BLACK MEDIUM SMALL SQUARE",category:"symbol"},{name:"white_medium_small_square",unicode:{apple:"25FD",google:"25FD",twitter:"25FD"},shortcode:"white_medium_small_square",description:"WHITE MEDIUM SMALL SQUARE",category:"symbol"},{name:"black_square_button",unicode:{apple:"1F532",google:"1F532",twitter:"1F532"},shortcode:"black_square_button",description:"BLACK SQUARE BUTTON",category:"symbol"},{name:"white_square_button",unicode:{apple:"1F533",google:"1F533",twitter:"1F533"},shortcode:"white_square_button",description:"WHITE SQUARE BUTTON",category:"symbol"},{name:"speaker",unicode:{apple:"1F508",google:"1F508",twitter:"1F508"},shortcode:"speaker",description:"SPEAKER",category:"symbol"},{name:"sound",unicode:{apple:"1F509",google:"1F509",twitter:"1F509"},shortcode:"sound",description:"SPEAKER WITH ONE SOUND WAVE",category:"symbol"},{name:"loud_sound",unicode:{apple:"1F50A",google:"1F50A",twitter:"1F50A"},shortcode:"loud_sound",description:"SPEAKER WITH THREE SOUND WAVES",category:"symbol"},{name:"mute",unicode:{apple:"1F507",google:"1F507",twitter:"1F507"},shortcode:"mute",description:"SPEAKER WITH CANCELLATION STROKE",category:"symbol"},{name:"mega",unicode:{apple:"1F4E3",google:"1F4E3",twitter:"1F4E3"},shortcode:"mega",description:"CHEERING MEGAPHONE",category:"symbol"},{name:"loudspeaker",unicode:{apple:"1F4E2",google:"1F4E2",twitter:"1F4E2"},shortcode:"loudspeaker",description:"PUBLIC ADDRESS LOUDSPEAKER",category:"symbol"},{name:"bell",unicode:{apple:"1F514",google:"1F514",twitter:"1F514"},shortcode:"bell",description:"BELL",category:"symbol"},{name:"no_bell",unicode:{apple:"1F515",google:"1F515",twitter:"1F515"},shortcode:"no_bell",description:"BELL WITH CANCELLATION STROKE",category:"symbol"},{name:"black_joker",unicode:{apple:"1F0CF",google:"1F0CF",twitter:"1F0CF"},shortcode:"black_joker",description:"PLAYING CARD BLACK JOKER",category:"symbol"},{name:"mahjong",unicode:{apple:"1F004",google:"1F004",twitter:"1F004"},shortcode:"mahjong",description:"MAHJONG TILE RED DRAGON",category:"symbol"},{name:"spades",unicode:{apple:"2660",google:"2660",twitter:"2660"},shortcode:"spades",description:"BLACK SPADE SUIT",category:"symbol"},{name:"clubs",unicode:{apple:"2663",google:"2663",twitter:"2663"},shortcode:"clubs",description:"BLACK CLUB SUIT",category:"symbol"},{name:"hearts",unicode:{apple:"2665",google:"2665",twitter:"2665"},shortcode:"hearts",description:"BLACK HEART SUIT",category:"symbol"},{name:"diamonds",unicode:{apple:"2666",google:"2666",twitter:"2666"},shortcode:"diamonds",description:"BLACK DIAMOND SUIT",category:"symbol"},{name:"flower_playing_cards",unicode:{apple:"1F3B4",google:"1F3B4",twitter:"1F3B4"},shortcode:"flower_playing_cards",description:"FLOWER PLAYING CARDS",category:"symbol"},{name:"thought_balloon",unicode:{apple:"1F4AD",google:"1F4AD",twitter:"1F4AD"},shortcode:"thought_balloon",description:"THOUGHT BALLOON",category:"symbol"},{name:"right_anger_bubble",unicode:{apple:"1F5EF",google:"1F5EF",twitter:"1F5EF"},shortcode:"right_anger_bubble",description:"RIGHT ANGER BUBBLE"},{name:"speech_balloon",unicode:{apple:"1F4AC",google:"1F4AC",twitter:"1F4AC"},shortcode:"speech_balloon",description:"SPEECH BALLOON",category:"symbol"},{name:"left_speech_bubble",unicode:{apple:"1F5E8",google:"1F5E8",twitter:"1F5E8"},shortcode:"left_speech_bubble",description:"LEFT SPEECH BUBBLE"},{name:"clock1",unicode:{apple:"1F550",google:"1F550",twitter:"1F550"},shortcode:"clock1",description:"CLOCK FACE ONE OCLOCK",category:"symbol"},{name:"clock2",unicode:{apple:"1F551",google:"1F551",twitter:"1F551"},shortcode:"clock2",description:"CLOCK FACE TWO OCLOCK",category:"symbol"},{name:"clock3",unicode:{apple:"1F552",google:"1F552",twitter:"1F552"},shortcode:"clock3",description:"CLOCK FACE THREE OCLOCK",category:"symbol"},{name:"clock4",unicode:{apple:"1F553",google:"1F553",twitter:"1F553"},shortcode:"clock4",description:"CLOCK FACE FOUR OCLOCK",category:"symbol"},{name:"clock5",unicode:{apple:"1F554",google:"1F554",twitter:"1F554"},shortcode:"clock5",description:"CLOCK FACE FIVE OCLOCK",category:"symbol"},{name:"clock6",unicode:{apple:"1F555",google:"1F555",twitter:"1F555"},shortcode:"clock6",description:"CLOCK FACE SIX OCLOCK",category:"symbol"},{name:"clock7",unicode:{apple:"1F556",google:"1F556",twitter:"1F556"},shortcode:"clock7",description:"CLOCK FACE SEVEN OCLOCK",category:"symbol"},{name:"clock8",unicode:{apple:"1F557",google:"1F557",twitter:"1F557"},shortcode:"clock8",description:"CLOCK FACE EIGHT OCLOCK",category:"symbol"},{name:"clock9",unicode:{apple:"1F558",google:"1F558",twitter:"1F558"},shortcode:"clock9",description:"CLOCK FACE NINE OCLOCK",category:"symbol"},{name:"clock10",unicode:{apple:"1F559",google:"1F559",twitter:"1F559"},shortcode:"clock10",description:"CLOCK FACE TEN OCLOCK",category:"symbol"},{name:"clock11",unicode:{apple:"1F55A",google:"1F55A",twitter:"1F55A"},shortcode:"clock11",description:"CLOCK FACE ELEVEN OCLOCK",category:"symbol"},{name:"clock12",unicode:{apple:"1F55B",google:"1F55B",twitter:"1F55B"},shortcode:"clock12",description:"CLOCK FACE TWELVE OCLOCK",category:"symbol"},{name:"clock130",unicode:{apple:"1F55C",google:"1F55C",twitter:"1F55C"},shortcode:"clock130",description:"CLOCK FACE ONE-THIRTY",category:"symbol"},{name:"clock230",unicode:{apple:"1F55D",google:"1F55D",twitter:"1F55D"},shortcode:"clock230",description:"CLOCK FACE TWO-THIRTY",category:"symbol"},{name:"clock330",unicode:{apple:"1F55E",google:"1F55E",twitter:"1F55E"},shortcode:"clock330",description:"CLOCK FACE THREE-THIRTY",category:"symbol"},{name:"clock430",unicode:{apple:"1F55F",google:"1F55F",twitter:"1F55F"},shortcode:"clock430",description:"CLOCK FACE FOUR-THIRTY",category:"symbol"},{name:"clock530",unicode:{apple:"1F560",google:"1F560",twitter:"1F560"},shortcode:"clock530",description:"CLOCK FACE FIVE-THIRTY",category:"symbol"},{name:"clock630",unicode:{apple:"1F561",google:"1F561",twitter:"1F561"},shortcode:"clock630",description:"CLOCK FACE SIX-THIRTY",category:"symbol"},{name:"clock730",unicode:{apple:"1F562",google:"1F562",twitter:"1F562"},shortcode:"clock730",description:"CLOCK FACE SEVEN-THIRTY",category:"symbol"},{name:"clock830",unicode:{apple:"1F563",google:"1F563",twitter:"1F563"},shortcode:"clock830",description:"CLOCK FACE EIGHT-THIRTY",category:"symbol"},{name:"clock930",unicode:{apple:"1F564",google:"1F564",twitter:"1F564"},shortcode:"clock930",description:"CLOCK FACE NINE-THIRTY",category:"symbol"},{name:"clock1030",unicode:{apple:"1F565",google:"1F565",twitter:"1F565"},shortcode:"clock1030",description:"CLOCK FACE TEN-THIRTY",category:"symbol"},{name:"clock1130",unicode:{apple:"1F566",google:"1F566",twitter:"1F566"},shortcode:"clock1130",description:"CLOCK FACE ELEVEN-THIRTY",category:"symbol"},{name:"clock1230",unicode:{apple:"1F567",google:"1F567",twitter:"1F567"},shortcode:"clock1230",description:"CLOCK FACE TWELVE-THIRTY",category:"symbol"},{name:"flag-ac",unicode:{apple:"1F1E6-1F1E8",google:"1F1E6-1F1E8",twitter:"1F1E6-1F1E8"},shortcode:"flag-ac",description:"REGIONAL INDICATOR SYMBOL LETTERS AC",category:"flag"},{name:"flag-ad",unicode:{apple:"1F1E6-1F1E9",google:"1F1E6-1F1E9",twitter:"1F1E6-1F1E9"},shortcode:"flag-ad",description:"REGIONAL INDICATOR SYMBOL LETTERS AD",category:"flag"},{name:"flag-ae",unicode:{apple:"1F1E6-1F1EA",google:"1F1E6-1F1EA",twitter:"1F1E6-1F1EA"},shortcode:"flag-ae",description:"REGIONAL INDICATOR SYMBOL LETTERS AE",category:"folderol",category:"flag"},{name:"flag-af",unicode:{apple:"1F1E6-1F1EB",google:"1F1E6-1F1EB",twitter:"1F1E6-1F1EB"},shortcode:"flag-af",description:"REGIONAL INDICATOR SYMBOL LETTERS AF",category:"flag"},{name:"flag-ag",unicode:{apple:"1F1E6-1F1EC",google:"1F1E6-1F1EC",twitter:"1F1E6-1F1EC"},shortcode:"flag-ag",description:"REGIONAL INDICATOR SYMBOL LETTERS AG",category:"flag"},{name:"flag-ai",unicode:{apple:"1F1E6-1F1EE",google:"1F1E6-1F1EE",twitter:"1F1E6-1F1EE"},shortcode:"flag-ai",description:"REGIONAL INDICATOR SYMBOL LETTERS AI",category:"flag"},{name:"flag-al",unicode:{apple:"1F1E6-1F1F1",google:"1F1E6-1F1F1",twitter:"1F1E6-1F1F1"},shortcode:"flag-al",description:"REGIONAL INDICATOR SYMBOL LETTERS AL",category:"flag"},{name:"flag-am",unicode:{apple:"1F1E6-1F1F2",google:"1F1E6-1F1F2",twitter:"1F1E6-1F1F2"},shortcode:"flag-am",description:"REGIONAL INDICATOR SYMBOL LETTERS AM",category:"flag"},{name:"flag-ao",unicode:{apple:"1F1E6-1F1F4",google:"1F1E6-1F1F4",twitter:"1F1E6-1F1F4"},shortcode:"flag-ao",description:"REGIONAL INDICATOR SYMBOL LETTERS AO",category:"flag"},{name:"flag-aq",unicode:{apple:"1F1E6-1F1F6",google:"1F1E6-1F1F6",twitter:"1F1E6-1F1F6"},shortcode:"flag-aq",description:"REGIONAL INDICATOR SYMBOL LETTERS AQ",category:"flag"},{name:"flag-ar",unicode:{apple:"1F1E6-1F1F7",google:"1F1E6-1F1F7",twitter:"1F1E6-1F1F7"},shortcode:"flag-ar",description:"REGIONAL INDICATOR SYMBOL LETTERS AR",category:"flag"},{name:"flag-as",unicode:{apple:"1F1E6-1F1F8",google:"1F1E6-1F1F8",twitter:"1F1E6-1F1F8"},shortcode:"flag-as",description:"REGIONAL INDICATOR SYMBOL LETTERS AS",category:"flag"},{name:"flag-at",unicode:{apple:"1F1E6-1F1F9",google:"1F1E6-1F1F9",twitter:"1F1E6-1F1F9"},shortcode:"flag-at",description:"REGIONAL INDICATOR SYMBOL LETTERS AT",category:"folderol",category:"flag"},{name:"flag-au",unicode:{apple:"1F1E6-1F1FA",google:"1F1E6-1F1FA",twitter:"1F1E6-1F1FA"},shortcode:"flag-au",description:"REGIONAL INDICATOR SYMBOL LETTERS AU",category:"folderol",category:"flag"},{name:"flag-aw",unicode:{apple:"1F1E6-1F1FC",google:"1F1E6-1F1FC",twitter:"1F1E6-1F1FC"},shortcode:"flag-aw",description:"REGIONAL INDICATOR SYMBOL LETTERS AW",category:"flag"},{name:"flag-ax",unicode:{apple:"1F1E6-1F1FD",google:"1F1E6-1F1FD",twitter:"1F1E6-1F1FD"},shortcode:"flag-ax",description:"REGIONAL INDICATOR SYMBOL LETTERS AX",category:"flag"},{name:"flag-az",unicode:{apple:"1F1E6-1F1FF",google:"1F1E6-1F1FF",twitter:"1F1E6-1F1FF"},shortcode:"flag-az",description:"REGIONAL INDICATOR SYMBOL LETTERS AZ",category:"flag"},{name:"flag-ba",unicode:{apple:"1F1E7-1F1E6",google:"1F1E7-1F1E6",twitter:"1F1E7-1F1E6"},shortcode:"flag-ba",description:"REGIONAL INDICATOR SYMBOL LETTERS BA",category:"flag"},{name:"flag-bb",unicode:{apple:"1F1E7-1F1E7",google:"1F1E7-1F1E7",twitter:"1F1E7-1F1E7"},shortcode:"flag-bb",description:"REGIONAL INDICATOR SYMBOL LETTERS BB",category:"flag"},{name:"flag-bd",unicode:{apple:"1F1E7-1F1E9",google:"1F1E7-1F1E9",twitter:"1F1E7-1F1E9"},shortcode:"flag-bd",description:"REGIONAL INDICATOR SYMBOL LETTERS BD",category:"flag"},{name:"flag-be",unicode:{apple:"1F1E7-1F1EA",google:"1F1E7-1F1EA",twitter:"1F1E7-1F1EA"},shortcode:"flag-be",description:"REGIONAL INDICATOR SYMBOL LETTERS BE",category:"folderol",category:"flag"},{name:"flag-bf",unicode:{apple:"1F1E7-1F1EB",google:"1F1E7-1F1EB",twitter:"1F1E7-1F1EB"},shortcode:"flag-bf",description:"REGIONAL INDICATOR SYMBOL LETTERS BF",category:"flag"},{name:"flag-bg",unicode:{apple:"1F1E7-1F1EC",google:"1F1E7-1F1EC",twitter:"1F1E7-1F1EC"},shortcode:"flag-bg",description:"REGIONAL INDICATOR SYMBOL LETTERS BG",category:"flag"},{name:"flag-bh",unicode:{apple:"1F1E7-1F1ED",google:"1F1E7-1F1ED",twitter:"1F1E7-1F1ED"},shortcode:"flag-bh",description:"REGIONAL INDICATOR SYMBOL LETTERS BH",category:"flag"},{name:"flag-bi",unicode:{apple:"1F1E7-1F1EE",google:"1F1E7-1F1EE",twitter:"1F1E7-1F1EE"},shortcode:"flag-bi",description:"REGIONAL INDICATOR SYMBOL LETTERS BI",category:"flag"},{name:"flag-bj",unicode:{apple:"1F1E7-1F1EF",google:"1F1E7-1F1EF",twitter:"1F1E7-1F1EF"},shortcode:"flag-bj",description:"REGIONAL INDICATOR SYMBOL LETTERS BJ",category:"flag"},{name:"flag-bl",unicode:{apple:"1F1E7-1F1F1",google:"1F1E7-1F1F1",twitter:"1F1E7-1F1F1"},shortcode:"flag-bl",description:"REGIONAL INDICATOR SYMBOL LETTERS BL",category:"flag"},{name:"flag-bm",unicode:{apple:"1F1E7-1F1F2",google:"1F1E7-1F1F2",twitter:"1F1E7-1F1F2"},shortcode:"flag-bm",description:"REGIONAL INDICATOR SYMBOL LETTERS BM",category:"flag"},{name:"flag-bn",unicode:{apple:"1F1E7-1F1F3",google:"1F1E7-1F1F3",twitter:"1F1E7-1F1F3"},shortcode:"flag-bn",description:"REGIONAL INDICATOR SYMBOL LETTERS BN",category:"flag"},{name:"flag-bo",unicode:{apple:"1F1E7-1F1F4",google:"1F1E7-1F1F4",twitter:"1F1E7-1F1F4"},shortcode:"flag-bo",description:"REGIONAL INDICATOR SYMBOL LETTERS BO",category:"flag"},{name:"flag-bq",unicode:{apple:"1F1E7-1F1F6",google:"1F1E7-1F1F6",twitter:"1F1E7-1F1F6"},shortcode:"flag-bq",description:"REGIONAL INDICATOR SYMBOL LETTERS BQ",category:"flag"},{name:"flag-br",unicode:{apple:"1F1E7-1F1F7",google:"1F1E7-1F1F7",twitter:"1F1E7-1F1F7"},shortcode:"flag-br",description:"REGIONAL INDICATOR SYMBOL LETTERS BR",category:"folderol",category:"flag"},{name:"flag-bs",unicode:{apple:"1F1E7-1F1F8",google:"1F1E7-1F1F8",twitter:"1F1E7-1F1F8"},shortcode:"flag-bs",description:"REGIONAL INDICATOR SYMBOL LETTERS BS",category:"flag"},{name:"flag-bt",unicode:{apple:"1F1E7-1F1F9",google:"1F1E7-1F1F9",twitter:"1F1E7-1F1F9"},shortcode:"flag-bt",description:"REGIONAL INDICATOR SYMBOL LETTERS BT",category:"flag"},{name:"flag-bv",unicode:{apple:"1F1E7-1F1FB",google:"1F1E7-1F1FB",twitter:"1F1E7-1F1FB"},shortcode:"flag-bv",description:"REGIONAL INDICATOR SYMBOL LETTERS BV",category:"flag"},{name:"flag-bw",unicode:{apple:"1F1E7-1F1FC",google:"1F1E7-1F1FC",twitter:"1F1E7-1F1FC"},shortcode:"flag-bw",description:"REGIONAL INDICATOR SYMBOL LETTERS BW",category:"flag"},{name:"flag-by",unicode:{apple:"1F1E7-1F1FE",google:"1F1E7-1F1FE",twitter:"1F1E7-1F1FE"},shortcode:"flag-by",description:"REGIONAL INDICATOR SYMBOL LETTERS BY",category:"flag"},{name:"flag-bz",unicode:{apple:"1F1E7-1F1FF",google:"1F1E7-1F1FF",twitter:"1F1E7-1F1FF"},shortcode:"flag-bz",description:"REGIONAL INDICATOR SYMBOL LETTERS BZ",category:"flag"},{name:"flag-ca",unicode:{apple:"1F1E8-1F1E6",google:"1F1E8-1F1E6",twitter:"1F1E8-1F1E6"},shortcode:"flag-ca",description:"REGIONAL INDICATOR SYMBOL LETTERS CA",category:"folderol",category:"flag"},{name:"flag-cc",unicode:{apple:"1F1E8-1F1E8",google:"1F1E8-1F1E8",twitter:"1F1E8-1F1E8"},shortcode:"flag-cc",description:"REGIONAL INDICATOR SYMBOL LETTERS CC",category:"flag"},{name:"flag-cd",unicode:{apple:"1F1E8-1F1E9",google:"1F1E8-1F1E9",twitter:"1F1E8-1F1E9"},shortcode:"flag-cd",description:"REGIONAL INDICATOR SYMBOL LETTERS CD",category:"flag"},{name:"flag-cf",unicode:{apple:"1F1E8-1F1EB",google:"1F1E8-1F1EB",twitter:"1F1E8-1F1EB"},shortcode:"flag-cf",description:"REGIONAL INDICATOR SYMBOL LETTERS CF",category:"flag"},{name:"flag-cg",unicode:{apple:"1F1E8-1F1EC",google:"1F1E8-1F1EC",twitter:"1F1E8-1F1EC"},shortcode:"flag-cg",description:"REGIONAL INDICATOR SYMBOL LETTERS CG",category:"flag"},{name:"flag-ch",unicode:{apple:"1F1E8-1F1ED",google:"1F1E8-1F1ED",twitter:"1F1E8-1F1ED"},shortcode:"flag-ch",description:"REGIONAL INDICATOR SYMBOL LETTERS CH",category:"folderol",category:"flag"},{name:"flag-ci",unicode:{apple:"1F1E8-1F1EE",google:"1F1E8-1F1EE",twitter:"1F1E8-1F1EE"},shortcode:"flag-ci",description:"REGIONAL INDICATOR SYMBOL LETTERS CI",category:"flag"},{name:"flag-ck",unicode:{apple:"1F1E8-1F1F0",google:"1F1E8-1F1F0",twitter:"1F1E8-1F1F0"},shortcode:"flag-ck",description:"REGIONAL INDICATOR SYMBOL LETTERS CK",category:"flag"},{name:"flag-cl",unicode:{apple:"1F1E8-1F1F1",google:"1F1E8-1F1F1",twitter:"1F1E8-1F1F1"},shortcode:"flag-cl",description:"REGIONAL INDICATOR SYMBOL LETTERS CL",category:"folderol",category:"flag"},{name:"flag-cm",unicode:{apple:"1F1E8-1F1F2",google:"1F1E8-1F1F2",twitter:"1F1E8-1F1F2"},shortcode:"flag-cm",description:"REGIONAL INDICATOR SYMBOL LETTERS CM",category:"flag"},{name:"flag-cn",unicode:{apple:"1F1E8-1F1F3",google:"1F1E8-1F1F3",twitter:"1F1E8-1F1F3"},shortcode:"flag-cn",description:"REGIONAL INDICATOR SYMBOL LETTERS CN",category:"folderol",category:"flag"},{name:"flag-co",unicode:{apple:"1F1E8-1F1F4",google:"1F1E8-1F1F4",twitter:"1F1E8-1F1F4"},shortcode:"flag-co",description:"REGIONAL INDICATOR SYMBOL LETTERS CO",category:"folderol",category:"flag"},{name:"flag-cp",unicode:{apple:"1F1E8-1F1F5",google:"1F1E8-1F1F5",twitter:"1F1E8-1F1F5"},shortcode:"flag-cp",description:"REGIONAL INDICATOR SYMBOL LETTERS CP",category:"flag"},{name:"flag-cr",unicode:{apple:"1F1E8-1F1F7",google:"1F1E8-1F1F7",twitter:"1F1E8-1F1F7"},shortcode:"flag-cr",description:"REGIONAL INDICATOR SYMBOL LETTERS CR",category:"flag"},{name:"flag-cu",unicode:{apple:"1F1E8-1F1FA",google:"1F1E8-1F1FA",twitter:"1F1E8-1F1FA"},shortcode:"flag-cu",description:"REGIONAL INDICATOR SYMBOL LETTERS CU",category:"flag"},{name:"flag-cv",unicode:{apple:"1F1E8-1F1FB",google:"1F1E8-1F1FB",twitter:"1F1E8-1F1FB"},shortcode:"flag-cv",description:"REGIONAL INDICATOR SYMBOL LETTERS CV",category:"flag"},{name:"flag-cw",unicode:{apple:"1F1E8-1F1FC",google:"1F1E8-1F1FC",twitter:"1F1E8-1F1FC"},shortcode:"flag-cw",description:"REGIONAL INDICATOR SYMBOL LETTERS CW",category:"flag"},{name:"flag-cx",unicode:{apple:"1F1E8-1F1FD",google:"1F1E8-1F1FD",twitter:"1F1E8-1F1FD"},shortcode:"flag-cx",description:"REGIONAL INDICATOR SYMBOL LETTERS CX",category:"flag"},{name:"flag-cy",unicode:{apple:"1F1E8-1F1FE",google:"1F1E8-1F1FE",twitter:"1F1E8-1F1FE"},shortcode:"flag-cy",description:"REGIONAL INDICATOR SYMBOL LETTERS CY",category:"flag"},{name:"flag-cz",unicode:{apple:"1F1E8-1F1FF",google:"1F1E8-1F1FF",twitter:"1F1E8-1F1FF"},shortcode:"flag-cz",description:"REGIONAL INDICATOR SYMBOL LETTERS CZ",category:"flag"},{name:"flag-de",unicode:{apple:"1F1E9-1F1EA",google:"1F1E9-1F1EA",twitter:"1F1E9-1F1EA"},shortcode:"flag-de",description:"REGIONAL INDICATOR SYMBOL LETTERS DE",category:"folderol",category:"flag"},{name:"flag-dg",unicode:{apple:"1F1E9-1F1EC",google:"1F1E9-1F1EC",twitter:"1F1E9-1F1EC"},shortcode:"flag-dg",description:"REGIONAL INDICATOR SYMBOL LETTERS DG",category:"flag"},{name:"flag-dj",unicode:{apple:"1F1E9-1F1EF",google:"1F1E9-1F1EF",twitter:"1F1E9-1F1EF"},shortcode:"flag-dj",description:"REGIONAL INDICATOR SYMBOL LETTERS DJ",category:"flag"},{name:"flag-dk",unicode:{apple:"1F1E9-1F1F0",google:"1F1E9-1F1F0",twitter:"1F1E9-1F1F0"},shortcode:"flag-dk",description:"REGIONAL INDICATOR SYMBOL LETTERS DK",category:"folderol",category:"flag"},{name:"flag-dm",unicode:{apple:"1F1E9-1F1F2",google:"1F1E9-1F1F2",twitter:"1F1E9-1F1F2"},shortcode:"flag-dm",description:"REGIONAL INDICATOR SYMBOL LETTERS DM",category:"flag"},{name:"flag-do",unicode:{apple:"1F1E9-1F1F4",google:"1F1E9-1F1F4",twitter:"1F1E9-1F1F4"},shortcode:"flag-do",description:"REGIONAL INDICATOR SYMBOL LETTERS DO",category:"flag"},{name:"flag-dz",unicode:{apple:"1F1E9-1F1FF",google:"1F1E9-1F1FF",twitter:"1F1E9-1F1FF"},shortcode:"flag-dz",description:"REGIONAL INDICATOR SYMBOL LETTERS DZ",category:"flag"},{name:"flag-ea",unicode:{apple:"1F1EA-1F1E6",google:"1F1EA-1F1E6",twitter:"1F1EA-1F1E6"},shortcode:"flag-ea",description:"REGIONAL INDICATOR SYMBOL LETTERS EA",category:"flag"},{name:"flag-ec",unicode:{apple:"1F1EA-1F1E8",google:"1F1EA-1F1E8",twitter:"1F1EA-1F1E8"},shortcode:"flag-ec",description:"REGIONAL INDICATOR SYMBOL LETTERS EC",category:"flag"},{name:"flag-ee",unicode:{apple:"1F1EA-1F1EA",google:"1F1EA-1F1EA",twitter:"1F1EA-1F1EA"},shortcode:"flag-ee",description:"REGIONAL INDICATOR SYMBOL LETTERS EE",category:"flag"},{name:"flag-eg",unicode:{apple:"1F1EA-1F1EC",google:"1F1EA-1F1EC",twitter:"1F1EA-1F1EC"},shortcode:"flag-eg",description:"REGIONAL INDICATOR SYMBOL LETTERS EG",category:"flag"},{name:"flag-eh",unicode:{apple:"1F1EA-1F1ED",google:"1F1EA-1F1ED",twitter:"1F1EA-1F1ED"},shortcode:"flag-eh",description:"REGIONAL INDICATOR SYMBOL LETTERS EH",category:"flag"},{name:"flag-er",unicode:{apple:"1F1EA-1F1F7",google:"1F1EA-1F1F7",twitter:"1F1EA-1F1F7"},shortcode:"flag-er",description:"REGIONAL INDICATOR SYMBOL LETTERS ER",category:"flag"},{name:"flag-es",unicode:{apple:"1F1EA-1F1F8",google:"1F1EA-1F1F8",twitter:"1F1EA-1F1F8"},shortcode:"flag-es",description:"REGIONAL INDICATOR SYMBOL LETTERS ES",category:"folderol",category:"flag"},{name:"flag-et",unicode:{apple:"1F1EA-1F1F9",google:"1F1EA-1F1F9",twitter:"1F1EA-1F1F9"},shortcode:"flag-et",description:"REGIONAL INDICATOR SYMBOL LETTERS ET",category:"flag"},{name:"flag-eu",unicode:{apple:"1F1EA-1F1FA",google:"1F1EA-1F1FA",twitter:"1F1EA-1F1FA"},shortcode:"flag-eu",description:"REGIONAL INDICATOR SYMBOL LETTERS EU",category:"flag"},{name:"flag-fi",unicode:{apple:"1F1EB-1F1EE",google:"1F1EB-1F1EE",twitter:"1F1EB-1F1EE"},shortcode:"flag-fi",description:"REGIONAL INDICATOR SYMBOL LETTERS FI",category:"folderol",category:"flag"},{name:"flag-fj",unicode:{apple:"1F1EB-1F1EF",google:"1F1EB-1F1EF",twitter:"1F1EB-1F1EF"},shortcode:"flag-fj",description:"REGIONAL INDICATOR SYMBOL LETTERS FJ",category:"flag"},{name:"flag-fk",unicode:{apple:"1F1EB-1F1F0",google:"1F1EB-1F1F0",twitter:"1F1EB-1F1F0"},shortcode:"flag-fk",description:"REGIONAL INDICATOR SYMBOL LETTERS FK",category:"flag"},{name:"flag-fm",unicode:{apple:"1F1EB-1F1F2",google:"1F1EB-1F1F2",twitter:"1F1EB-1F1F2"},shortcode:"flag-fm",description:"REGIONAL INDICATOR SYMBOL LETTERS FM",category:"flag"},{name:"flag-fo",unicode:{apple:"1F1EB-1F1F4",google:"1F1EB-1F1F4",twitter:"1F1EB-1F1F4"},shortcode:"flag-fo",description:"REGIONAL INDICATOR SYMBOL LETTERS FO",category:"flag"},{name:"flag-fr",unicode:{apple:"1F1EB-1F1F7",google:"1F1EB-1F1F7",twitter:"1F1EB-1F1F7"},shortcode:"flag-fr",description:"REGIONAL INDICATOR SYMBOL LETTERS FR",category:"folderol",category:"flag"},{name:"flag-ga",unicode:{apple:"1F1EC-1F1E6",google:"1F1EC-1F1E6",twitter:"1F1EC-1F1E6"},shortcode:"flag-ga",description:"REGIONAL INDICATOR SYMBOL LETTERS GA",category:"flag"},{name:"flag-gb",unicode:{apple:"1F1EC-1F1E7",google:"1F1EC-1F1E7",twitter:"1F1EC-1F1E7"},shortcode:"flag-gb",description:"REGIONAL INDICATOR SYMBOL LETTERS GB",category:"folderol",category:"flag"},{name:"flag-gd",unicode:{
apple:"1F1EC-1F1E9",google:"1F1EC-1F1E9",twitter:"1F1EC-1F1E9"},shortcode:"flag-gd",description:"REGIONAL INDICATOR SYMBOL LETTERS GD",category:"flag"},{name:"flag-ge",unicode:{apple:"1F1EC-1F1EA",google:"1F1EC-1F1EA",twitter:"1F1EC-1F1EA"},shortcode:"flag-ge",description:"REGIONAL INDICATOR SYMBOL LETTERS GE",category:"flag"},{name:"flag-gf",unicode:{apple:"1F1EC-1F1EB",google:"1F1EC-1F1EB",twitter:"1F1EC-1F1EB"},shortcode:"flag-gf",description:"REGIONAL INDICATOR SYMBOL LETTERS GF",category:"flag"},{name:"flag-gg",unicode:{apple:"1F1EC-1F1EC",google:"1F1EC-1F1EC",twitter:"1F1EC-1F1EC"},shortcode:"flag-gg",description:"REGIONAL INDICATOR SYMBOL LETTERS GG",category:"flag"},{name:"flag-gh",unicode:{apple:"1F1EC-1F1ED",google:"1F1EC-1F1ED",twitter:"1F1EC-1F1ED"},shortcode:"flag-gh",description:"REGIONAL INDICATOR SYMBOL LETTERS GH",category:"flag"},{name:"flag-gi",unicode:{apple:"1F1EC-1F1EE",google:"1F1EC-1F1EE",twitter:"1F1EC-1F1EE"},shortcode:"flag-gi",description:"REGIONAL INDICATOR SYMBOL LETTERS GI",category:"flag"},{name:"flag-gl",unicode:{apple:"1F1EC-1F1F1",google:"1F1EC-1F1F1",twitter:"1F1EC-1F1F1"},shortcode:"flag-gl",description:"REGIONAL INDICATOR SYMBOL LETTERS GL",category:"flag"},{name:"flag-gm",unicode:{apple:"1F1EC-1F1F2",google:"1F1EC-1F1F2",twitter:"1F1EC-1F1F2"},shortcode:"flag-gm",description:"REGIONAL INDICATOR SYMBOL LETTERS GM",category:"flag"},{name:"flag-gn",unicode:{apple:"1F1EC-1F1F3",google:"1F1EC-1F1F3",twitter:"1F1EC-1F1F3"},shortcode:"flag-gn",description:"REGIONAL INDICATOR SYMBOL LETTERS GN",category:"flag"},{name:"flag-gp",unicode:{apple:"1F1EC-1F1F5",google:"1F1EC-1F1F5",twitter:"1F1EC-1F1F5"},shortcode:"flag-gp",description:"REGIONAL INDICATOR SYMBOL LETTERS GP",category:"flag"},{name:"flag-gq",unicode:{apple:"1F1EC-1F1F6",google:"1F1EC-1F1F6",twitter:"1F1EC-1F1F6"},shortcode:"flag-gq",description:"REGIONAL INDICATOR SYMBOL LETTERS GQ",category:"flag"},{name:"flag-gr",unicode:{apple:"1F1EC-1F1F7",google:"1F1EC-1F1F7",twitter:"1F1EC-1F1F7"},shortcode:"flag-gr",description:"REGIONAL INDICATOR SYMBOL LETTERS GR",category:"flag"},{name:"flag-gs",unicode:{apple:"1F1EC-1F1F8",google:"1F1EC-1F1F8",twitter:"1F1EC-1F1F8"},shortcode:"flag-gs",description:"REGIONAL INDICATOR SYMBOL LETTERS GS",category:"flag"},{name:"flag-gt",unicode:{apple:"1F1EC-1F1F9",google:"1F1EC-1F1F9",twitter:"1F1EC-1F1F9"},shortcode:"flag-gt",description:"REGIONAL INDICATOR SYMBOL LETTERS GT",category:"flag"},{name:"flag-gu",unicode:{apple:"1F1EC-1F1FA",google:"1F1EC-1F1FA",twitter:"1F1EC-1F1FA"},shortcode:"flag-gu",description:"REGIONAL INDICATOR SYMBOL LETTERS GU",category:"flag"},{name:"flag-gw",unicode:{apple:"1F1EC-1F1FC",google:"1F1EC-1F1FC",twitter:"1F1EC-1F1FC"},shortcode:"flag-gw",description:"REGIONAL INDICATOR SYMBOL LETTERS GW",category:"flag"},{name:"flag-gy",unicode:{apple:"1F1EC-1F1FE",google:"1F1EC-1F1FE",twitter:"1F1EC-1F1FE"},shortcode:"flag-gy",description:"REGIONAL INDICATOR SYMBOL LETTERS GY",category:"flag"},{name:"flag-hk",unicode:{apple:"1F1ED-1F1F0",google:"1F1ED-1F1F0",twitter:"1F1ED-1F1F0"},shortcode:"flag-hk",description:"REGIONAL INDICATOR SYMBOL LETTERS HK",category:"folderol",category:"flag"},{name:"flag-hm",unicode:{apple:"1F1ED-1F1F2",google:"1F1ED-1F1F2",twitter:"1F1ED-1F1F2"},shortcode:"flag-hm",description:"REGIONAL INDICATOR SYMBOL LETTERS HM",category:"flag"},{name:"flag-hn",unicode:{apple:"1F1ED-1F1F3",google:"1F1ED-1F1F3",twitter:"1F1ED-1F1F3"},shortcode:"flag-hn",description:"REGIONAL INDICATOR SYMBOL LETTERS HN",category:"flag"},{name:"flag-hr",unicode:{apple:"1F1ED-1F1F7",google:"1F1ED-1F1F7",twitter:"1F1ED-1F1F7"},shortcode:"flag-hr",description:"REGIONAL INDICATOR SYMBOL LETTERS HR",category:"flag"},{name:"flag-ht",unicode:{apple:"1F1ED-1F1F9",google:"1F1ED-1F1F9",twitter:"1F1ED-1F1F9"},shortcode:"flag-ht",description:"REGIONAL INDICATOR SYMBOL LETTERS HT",category:"flag"},{name:"flag-hu",unicode:{apple:"1F1ED-1F1FA",google:"1F1ED-1F1FA",twitter:"1F1ED-1F1FA"},shortcode:"flag-hu",description:"REGIONAL INDICATOR SYMBOL LETTERS HU",category:"flag"},{name:"flag-ic",unicode:{apple:"1F1EE-1F1E8",google:"1F1EE-1F1E8",twitter:"1F1EE-1F1E8"},shortcode:"flag-ic",description:"REGIONAL INDICATOR SYMBOL LETTERS IC",category:"flag"},{name:"flag-id",unicode:{apple:"1F1EE-1F1E9",google:"1F1EE-1F1E9",twitter:"1F1EE-1F1E9"},shortcode:"flag-id",description:"REGIONAL INDICATOR SYMBOL LETTERS ID",category:"folderol",category:"flag"},{name:"flag-ie",unicode:{apple:"1F1EE-1F1EA",google:"1F1EE-1F1EA",twitter:"1F1EE-1F1EA"},shortcode:"flag-ie",description:"REGIONAL INDICATOR SYMBOL LETTERS IE",category:"folderol",category:"flag"},{name:"flag-il",unicode:{apple:"1F1EE-1F1F1",google:"1F1EE-1F1F1",twitter:"1F1EE-1F1F1"},shortcode:"flag-il",description:"REGIONAL INDICATOR SYMBOL LETTERS IL",category:"folderol",category:"flag"},{name:"flag-im",unicode:{apple:"1F1EE-1F1F2",google:"1F1EE-1F1F2",twitter:"1F1EE-1F1F2"},shortcode:"flag-im",description:"REGIONAL INDICATOR SYMBOL LETTERS IM",category:"flag"},{name:"flag-in",unicode:{apple:"1F1EE-1F1F3",google:"1F1EE-1F1F3",twitter:"1F1EE-1F1F3"},shortcode:"flag-in",description:"REGIONAL INDICATOR SYMBOL LETTERS IN",category:"folderol",category:"flag"},{name:"flag-io",unicode:{apple:"1F1EE-1F1F4",google:"1F1EE-1F1F4",twitter:"1F1EE-1F1F4"},shortcode:"flag-io",description:"REGIONAL INDICATOR SYMBOL LETTERS IO",category:"flag"},{name:"flag-iq",unicode:{apple:"1F1EE-1F1F6",google:"1F1EE-1F1F6",twitter:"1F1EE-1F1F6"},shortcode:"flag-iq",description:"REGIONAL INDICATOR SYMBOL LETTERS IQ",category:"flag"},{name:"flag-ir",unicode:{apple:"1F1EE-1F1F7",google:"1F1EE-1F1F7",twitter:"1F1EE-1F1F7"},shortcode:"flag-ir",description:"REGIONAL INDICATOR SYMBOL LETTERS IR",category:"flag"},{name:"flag-is",unicode:{apple:"1F1EE-1F1F8",google:"1F1EE-1F1F8",twitter:"1F1EE-1F1F8"},shortcode:"flag-is",description:"REGIONAL INDICATOR SYMBOL LETTERS IS",category:"flag"},{name:"flag-it",unicode:{apple:"1F1EE-1F1F9",google:"1F1EE-1F1F9",twitter:"1F1EE-1F1F9"},shortcode:"flag-it",description:"REGIONAL INDICATOR SYMBOL LETTERS IT",category:"folderol",category:"flag"},{name:"flag-je",unicode:{apple:"1F1EF-1F1EA",google:"1F1EF-1F1EA",twitter:"1F1EF-1F1EA"},shortcode:"flag-je",description:"REGIONAL INDICATOR SYMBOL LETTERS JE",category:"flag"},{name:"flag-jm",unicode:{apple:"1F1EF-1F1F2",google:"1F1EF-1F1F2",twitter:"1F1EF-1F1F2"},shortcode:"flag-jm",description:"REGIONAL INDICATOR SYMBOL LETTERS JM",category:"flag"},{name:"flag-jo",unicode:{apple:"1F1EF-1F1F4",google:"1F1EF-1F1F4",twitter:"1F1EF-1F1F4"},shortcode:"flag-jo",description:"REGIONAL INDICATOR SYMBOL LETTERS JO",category:"flag"},{name:"flag-jp",unicode:{apple:"1F1EF-1F1F5",google:"1F1EF-1F1F5",twitter:"1F1EF-1F1F5"},shortcode:"flag-jp",description:"REGIONAL INDICATOR SYMBOL LETTERS JP",category:"folderol",category:"flag"},{name:"flag-ke",unicode:{apple:"1F1F0-1F1EA",google:"1F1F0-1F1EA",twitter:"1F1F0-1F1EA"},shortcode:"flag-ke",description:"REGIONAL INDICATOR SYMBOL LETTERS KE",category:"flag"},{name:"flag-kg",unicode:{apple:"1F1F0-1F1EC",google:"1F1F0-1F1EC",twitter:"1F1F0-1F1EC"},shortcode:"flag-kg",description:"REGIONAL INDICATOR SYMBOL LETTERS KG",category:"flag"},{name:"flag-kh",unicode:{apple:"1F1F0-1F1ED",google:"1F1F0-1F1ED",twitter:"1F1F0-1F1ED"},shortcode:"flag-kh",description:"REGIONAL INDICATOR SYMBOL LETTERS KH",category:"flag"},{name:"flag-ki",unicode:{apple:"1F1F0-1F1EE",google:"1F1F0-1F1EE",twitter:"1F1F0-1F1EE"},shortcode:"flag-ki",description:"REGIONAL INDICATOR SYMBOL LETTERS KI",category:"flag"},{name:"flag-km",unicode:{apple:"1F1F0-1F1F2",google:"1F1F0-1F1F2",twitter:"1F1F0-1F1F2"},shortcode:"flag-km",description:"REGIONAL INDICATOR SYMBOL LETTERS KM",category:"flag"},{name:"flag-kn",unicode:{apple:"1F1F0-1F1F3",google:"1F1F0-1F1F3",twitter:"1F1F0-1F1F3"},shortcode:"flag-kn",description:"REGIONAL INDICATOR SYMBOL LETTERS KN",category:"flag"},{name:"flag-kp",unicode:{apple:"1F1F0-1F1F5",google:"1F1F0-1F1F5",twitter:"1F1F0-1F1F5"},shortcode:"flag-kp",description:"REGIONAL INDICATOR SYMBOL LETTERS KP",category:"flag"},{name:"flag-kr",unicode:{apple:"1F1F0-1F1F7",google:"1F1F0-1F1F7",twitter:"1F1F0-1F1F7"},shortcode:"flag-kr",description:"REGIONAL INDICATOR SYMBOL LETTERS KR",category:"folderol",category:"flag"},{name:"flag-kw",unicode:{apple:"1F1F0-1F1FC",google:"1F1F0-1F1FC",twitter:"1F1F0-1F1FC"},shortcode:"flag-kw",description:"REGIONAL INDICATOR SYMBOL LETTERS KW",category:"flag"},{name:"flag-ky",unicode:{apple:"1F1F0-1F1FE",google:"1F1F0-1F1FE",twitter:"1F1F0-1F1FE"},shortcode:"flag-ky",description:"REGIONAL INDICATOR SYMBOL LETTERS KY",category:"flag"},{name:"flag-kz",unicode:{apple:"1F1F0-1F1FF",google:"1F1F0-1F1FF",twitter:"1F1F0-1F1FF"},shortcode:"flag-kz",description:"REGIONAL INDICATOR SYMBOL LETTERS KZ",category:"flag"},{name:"flag-la",unicode:{apple:"1F1F1-1F1E6",google:"1F1F1-1F1E6",twitter:"1F1F1-1F1E6"},shortcode:"flag-la",description:"REGIONAL INDICATOR SYMBOL LETTERS LA",category:"flag"},{name:"flag-lb",unicode:{apple:"1F1F1-1F1E7",google:"1F1F1-1F1E7",twitter:"1F1F1-1F1E7"},shortcode:"flag-lb",description:"REGIONAL INDICATOR SYMBOL LETTERS LB",category:"flag"},{name:"flag-lc",unicode:{apple:"1F1F1-1F1E8",google:"1F1F1-1F1E8",twitter:"1F1F1-1F1E8"},shortcode:"flag-lc",description:"REGIONAL INDICATOR SYMBOL LETTERS LC",category:"flag"},{name:"flag-li",unicode:{apple:"1F1F1-1F1EE",google:"1F1F1-1F1EE",twitter:"1F1F1-1F1EE"},shortcode:"flag-li",description:"REGIONAL INDICATOR SYMBOL LETTERS LI",category:"flag"},{name:"flag-lk",unicode:{apple:"1F1F1-1F1F0",google:"1F1F1-1F1F0",twitter:"1F1F1-1F1F0"},shortcode:"flag-lk",description:"REGIONAL INDICATOR SYMBOL LETTERS LK",category:"flag"},{name:"flag-lr",unicode:{apple:"1F1F1-1F1F7",google:"1F1F1-1F1F7",twitter:"1F1F1-1F1F7"},shortcode:"flag-lr",description:"REGIONAL INDICATOR SYMBOL LETTERS LR",category:"flag"},{name:"flag-ls",unicode:{apple:"1F1F1-1F1F8",google:"1F1F1-1F1F8",twitter:"1F1F1-1F1F8"},shortcode:"flag-ls",description:"REGIONAL INDICATOR SYMBOL LETTERS LS",category:"flag"},{name:"flag-lt",unicode:{apple:"1F1F1-1F1F9",google:"1F1F1-1F1F9",twitter:"1F1F1-1F1F9"},shortcode:"flag-lt",description:"REGIONAL INDICATOR SYMBOL LETTERS LT",category:"flag"},{name:"flag-lu",unicode:{apple:"1F1F1-1F1FA",google:"1F1F1-1F1FA",twitter:"1F1F1-1F1FA"},shortcode:"flag-lu",description:"REGIONAL INDICATOR SYMBOL LETTERS LU",category:"flag"},{name:"flag-lv",unicode:{apple:"1F1F1-1F1FB",google:"1F1F1-1F1FB",twitter:"1F1F1-1F1FB"},shortcode:"flag-lv",description:"REGIONAL INDICATOR SYMBOL LETTERS LV",category:"flag"},{name:"flag-ly",unicode:{apple:"1F1F1-1F1FE",google:"1F1F1-1F1FE",twitter:"1F1F1-1F1FE"},shortcode:"flag-ly",description:"REGIONAL INDICATOR SYMBOL LETTERS LY",category:"flag"},{name:"flag-ma",unicode:{apple:"1F1F2-1F1E6",google:"1F1F2-1F1E6",twitter:"1F1F2-1F1E6"},shortcode:"flag-ma",description:"REGIONAL INDICATOR SYMBOL LETTERS MA",category:"flag"},{name:"flag-mc",unicode:{apple:"1F1F2-1F1E8",google:"1F1F2-1F1E8",twitter:"1F1F2-1F1E8"},shortcode:"flag-mc",description:"REGIONAL INDICATOR SYMBOL LETTERS MC",category:"flag"},{name:"flag-md",unicode:{apple:"1F1F2-1F1E9",google:"1F1F2-1F1E9",twitter:"1F1F2-1F1E9"},shortcode:"flag-md",description:"REGIONAL INDICATOR SYMBOL LETTERS MD",category:"flag"},{name:"flag-me",unicode:{apple:"1F1F2-1F1EA",google:"1F1F2-1F1EA",twitter:"1F1F2-1F1EA"},shortcode:"flag-me",description:"REGIONAL INDICATOR SYMBOL LETTERS ME",category:"flag"},{name:"flag-mf",unicode:{apple:"1F1F2-1F1EB",google:"1F1F2-1F1EB",twitter:"1F1F2-1F1EB"},shortcode:"flag-mf",description:"REGIONAL INDICATOR SYMBOL LETTERS MF",category:"flag"},{name:"flag-mg",unicode:{apple:"1F1F2-1F1EC",google:"1F1F2-1F1EC",twitter:"1F1F2-1F1EC"},shortcode:"flag-mg",description:"REGIONAL INDICATOR SYMBOL LETTERS MG",category:"flag"},{name:"flag-mh",unicode:{apple:"1F1F2-1F1ED",google:"1F1F2-1F1ED",twitter:"1F1F2-1F1ED"},shortcode:"flag-mh",description:"REGIONAL INDICATOR SYMBOL LETTERS MH",category:"flag"},{name:"flag-mk",unicode:{apple:"1F1F2-1F1F0",google:"1F1F2-1F1F0",twitter:"1F1F2-1F1F0"},shortcode:"flag-mk",description:"REGIONAL INDICATOR SYMBOL LETTERS MK",category:"flag"},{name:"flag-ml",unicode:{apple:"1F1F2-1F1F1",google:"1F1F2-1F1F1",twitter:"1F1F2-1F1F1"},shortcode:"flag-ml",description:"REGIONAL INDICATOR SYMBOL LETTERS ML",category:"flag"},{name:"flag-mm",unicode:{apple:"1F1F2-1F1F2",google:"1F1F2-1F1F2",twitter:"1F1F2-1F1F2"},shortcode:"flag-mm",description:"REGIONAL INDICATOR SYMBOL LETTERS MM",category:"flag"},{name:"flag-mn",unicode:{apple:"1F1F2-1F1F3",google:"1F1F2-1F1F3",twitter:"1F1F2-1F1F3"},shortcode:"flag-mn",description:"REGIONAL INDICATOR SYMBOL LETTERS MN",category:"flag"},{name:"flag-mo",unicode:{apple:"1F1F2-1F1F4",google:"1F1F2-1F1F4",twitter:"1F1F2-1F1F4"},shortcode:"flag-mo",description:"REGIONAL INDICATOR SYMBOL LETTERS MO",category:"folderol",category:"flag"},{name:"flag-mp",unicode:{apple:"1F1F2-1F1F5",google:"1F1F2-1F1F5",twitter:"1F1F2-1F1F5"},shortcode:"flag-mp",description:"REGIONAL INDICATOR SYMBOL LETTERS MP",category:"flag"},{name:"flag-mq",unicode:{apple:"1F1F2-1F1F6",google:"1F1F2-1F1F6",twitter:"1F1F2-1F1F6"},shortcode:"flag-mq",description:"REGIONAL INDICATOR SYMBOL LETTERS MQ",category:"flag"},{name:"flag-mr",unicode:{apple:"1F1F2-1F1F7",google:"1F1F2-1F1F7",twitter:"1F1F2-1F1F7"},shortcode:"flag-mr",description:"REGIONAL INDICATOR SYMBOL LETTERS MR",category:"flag"},{name:"flag-ms",unicode:{apple:"1F1F2-1F1F8",google:"1F1F2-1F1F8",twitter:"1F1F2-1F1F8"},shortcode:"flag-ms",description:"REGIONAL INDICATOR SYMBOL LETTERS MS",category:"flag"},{name:"flag-mt",unicode:{apple:"1F1F2-1F1F9",google:"1F1F2-1F1F9",twitter:"1F1F2-1F1F9"},shortcode:"flag-mt",description:"REGIONAL INDICATOR SYMBOL LETTERS MT",category:"flag"},{name:"flag-mu",unicode:{apple:"1F1F2-1F1FA",google:"1F1F2-1F1FA",twitter:"1F1F2-1F1FA"},shortcode:"flag-mu",description:"REGIONAL INDICATOR SYMBOL LETTERS MU",category:"flag"},{name:"flag-mv",unicode:{apple:"1F1F2-1F1FB",google:"1F1F2-1F1FB",twitter:"1F1F2-1F1FB"},shortcode:"flag-mv",description:"REGIONAL INDICATOR SYMBOL LETTERS MV",category:"flag"},{name:"flag-mw",unicode:{apple:"1F1F2-1F1FC",google:"1F1F2-1F1FC",twitter:"1F1F2-1F1FC"},shortcode:"flag-mw",description:"REGIONAL INDICATOR SYMBOL LETTERS MW",category:"flag"},{name:"flag-mx",unicode:{apple:"1F1F2-1F1FD",google:"1F1F2-1F1FD",twitter:"1F1F2-1F1FD"},shortcode:"flag-mx",description:"REGIONAL INDICATOR SYMBOL LETTERS MX",category:"folderol",category:"flag"},{name:"flag-my",unicode:{apple:"1F1F2-1F1FE",google:"1F1F2-1F1FE",twitter:"1F1F2-1F1FE"},shortcode:"flag-my",description:"REGIONAL INDICATOR SYMBOL LETTERS MY",category:"folderol",category:"flag"},{name:"flag-mz",unicode:{apple:"1F1F2-1F1FF",google:"1F1F2-1F1FF",twitter:"1F1F2-1F1FF"},shortcode:"flag-mz",description:"REGIONAL INDICATOR SYMBOL LETTERS MZ",category:"flag"},{name:"flag-na",unicode:{apple:"1F1F3-1F1E6",google:"1F1F3-1F1E6",twitter:"1F1F3-1F1E6"},shortcode:"flag-na",description:"REGIONAL INDICATOR SYMBOL LETTERS NA",category:"flag"},{name:"flag-nc",unicode:{apple:"1F1F3-1F1E8",google:"1F1F3-1F1E8",twitter:"1F1F3-1F1E8"},shortcode:"flag-nc",description:"REGIONAL INDICATOR SYMBOL LETTERS NC",category:"flag"},{name:"flag-ne",unicode:{apple:"1F1F3-1F1EA",google:"1F1F3-1F1EA",twitter:"1F1F3-1F1EA"},shortcode:"flag-ne",description:"REGIONAL INDICATOR SYMBOL LETTERS NE",category:"flag"},{name:"flag-nf",unicode:{apple:"1F1F3-1F1EB",google:"1F1F3-1F1EB",twitter:"1F1F3-1F1EB"},shortcode:"flag-nf",description:"REGIONAL INDICATOR SYMBOL LETTERS NF",category:"flag"},{name:"flag-ng",unicode:{apple:"1F1F3-1F1EC",google:"1F1F3-1F1EC",twitter:"1F1F3-1F1EC"},shortcode:"flag-ng",description:"REGIONAL INDICATOR SYMBOL LETTERS NG",category:"flag"},{name:"flag-ni",unicode:{apple:"1F1F3-1F1EE",google:"1F1F3-1F1EE",twitter:"1F1F3-1F1EE"},shortcode:"flag-ni",description:"REGIONAL INDICATOR SYMBOL LETTERS NI",category:"flag"},{name:"flag-nl",unicode:{apple:"1F1F3-1F1F1",google:"1F1F3-1F1F1",twitter:"1F1F3-1F1F1"},shortcode:"flag-nl",description:"REGIONAL INDICATOR SYMBOL LETTERS NL",category:"folderol",category:"flag"},{name:"flag-no",unicode:{apple:"1F1F3-1F1F4",google:"1F1F3-1F1F4",twitter:"1F1F3-1F1F4"},shortcode:"flag-no",description:"REGIONAL INDICATOR SYMBOL LETTERS NO",category:"folderol",category:"flag"},{name:"flag-np",unicode:{apple:"1F1F3-1F1F5",google:"1F1F3-1F1F5",twitter:"1F1F3-1F1F5"},shortcode:"flag-np",description:"REGIONAL INDICATOR SYMBOL LETTERS NP",category:"flag"},{name:"flag-nr",unicode:{apple:"1F1F3-1F1F7",google:"1F1F3-1F1F7",twitter:"1F1F3-1F1F7"},shortcode:"flag-nr",description:"REGIONAL INDICATOR SYMBOL LETTERS NR",category:"flag"},{name:"flag-nu",unicode:{apple:"1F1F3-1F1FA",google:"1F1F3-1F1FA",twitter:"1F1F3-1F1FA"},shortcode:"flag-nu",description:"REGIONAL INDICATOR SYMBOL LETTERS NU",category:"flag"},{name:"flag-nz",unicode:{apple:"1F1F3-1F1FF",google:"1F1F3-1F1FF",twitter:"1F1F3-1F1FF"},shortcode:"flag-nz",description:"REGIONAL INDICATOR SYMBOL LETTERS NZ",category:"folderol",category:"flag"},{name:"flag-om",unicode:{apple:"1F1F4-1F1F2",google:"1F1F4-1F1F2",twitter:"1F1F4-1F1F2"},shortcode:"flag-om",description:"REGIONAL INDICATOR SYMBOL LETTERS OM",category:"flag"},{name:"flag-pa",unicode:{apple:"1F1F5-1F1E6",google:"1F1F5-1F1E6",twitter:"1F1F5-1F1E6"},shortcode:"flag-pa",description:"REGIONAL INDICATOR SYMBOL LETTERS PA",category:"flag"},{name:"flag-pe",unicode:{apple:"1F1F5-1F1EA",google:"1F1F5-1F1EA",twitter:"1F1F5-1F1EA"},shortcode:"flag-pe",description:"REGIONAL INDICATOR SYMBOL LETTERS PE",category:"flag"},{name:"flag-pf",unicode:{apple:"1F1F5-1F1EB",google:"1F1F5-1F1EB",twitter:"1F1F5-1F1EB"},shortcode:"flag-pf",description:"REGIONAL INDICATOR SYMBOL LETTERS PF",category:"flag"},{name:"flag-pg",unicode:{apple:"1F1F5-1F1EC",google:"1F1F5-1F1EC",twitter:"1F1F5-1F1EC"},shortcode:"flag-pg",description:"REGIONAL INDICATOR SYMBOL LETTERS PG",category:"flag"},{name:"flag-ph",unicode:{apple:"1F1F5-1F1ED",google:"1F1F5-1F1ED",twitter:"1F1F5-1F1ED"},shortcode:"flag-ph",description:"REGIONAL INDICATOR SYMBOL LETTERS PH",category:"folderol",category:"flag"},{name:"flag-pk",unicode:{apple:"1F1F5-1F1F0",google:"1F1F5-1F1F0",twitter:"1F1F5-1F1F0"},shortcode:"flag-pk",description:"REGIONAL INDICATOR SYMBOL LETTERS PK",category:"flag"},{name:"flag-pl",unicode:{apple:"1F1F5-1F1F1",google:"1F1F5-1F1F1",twitter:"1F1F5-1F1F1"},shortcode:"flag-pl",description:"REGIONAL INDICATOR SYMBOL LETTERS PL",category:"folderol",category:"flag"},{name:"flag-pm",unicode:{apple:"1F1F5-1F1F2",google:"1F1F5-1F1F2",twitter:"1F1F5-1F1F2"},shortcode:"flag-pm",description:"REGIONAL INDICATOR SYMBOL LETTERS PM",category:"flag"},{name:"flag-pn",unicode:{apple:"1F1F5-1F1F3",google:"1F1F5-1F1F3",twitter:"1F1F5-1F1F3"},shortcode:"flag-pn",description:"REGIONAL INDICATOR SYMBOL LETTERS PN",category:"flag"},{name:"flag-pr",unicode:{apple:"1F1F5-1F1F7",google:"1F1F5-1F1F7",twitter:"1F1F5-1F1F7"},shortcode:"flag-pr",description:"REGIONAL INDICATOR SYMBOL LETTERS PR",category:"folderol",category:"flag"},{name:"flag-ps",unicode:{apple:"1F1F5-1F1F8",google:"1F1F5-1F1F8",twitter:"1F1F5-1F1F8"},shortcode:"flag-ps",description:"REGIONAL INDICATOR SYMBOL LETTERS PS",category:"flag"},{name:"flag-pt",unicode:{apple:"1F1F5-1F1F9",google:"1F1F5-1F1F9",twitter:"1F1F5-1F1F9"},shortcode:"flag-pt",description:"REGIONAL INDICATOR SYMBOL LETTERS PT",category:"folderol",category:"flag"},{name:"flag-pw",unicode:{apple:"1F1F5-1F1FC",google:"1F1F5-1F1FC",twitter:"1F1F5-1F1FC"},shortcode:"flag-pw",description:"REGIONAL INDICATOR SYMBOL LETTERS PW",category:"flag"},{name:"flag-py",unicode:{apple:"1F1F5-1F1FE",google:"1F1F5-1F1FE",twitter:"1F1F5-1F1FE"},shortcode:"flag-py",description:"REGIONAL INDICATOR SYMBOL LETTERS PY",category:"flag"},{name:"flag-qa",unicode:{apple:"1F1F6-1F1E6",google:"1F1F6-1F1E6",twitter:"1F1F6-1F1E6"},shortcode:"flag-qa",description:"REGIONAL INDICATOR SYMBOL LETTERS QA",category:"flag"},{name:"flag-re",unicode:{apple:"1F1F7-1F1EA",google:"1F1F7-1F1EA",twitter:"1F1F7-1F1EA"},shortcode:"flag-re",description:"REGIONAL INDICATOR SYMBOL LETTERS RE",category:"flag"},{name:"flag-ro",unicode:{apple:"1F1F7-1F1F4",google:"1F1F7-1F1F4",twitter:"1F1F7-1F1F4"},shortcode:"flag-ro",description:"REGIONAL INDICATOR SYMBOL LETTERS RO",category:"flag"},{name:"flag-rs",unicode:{apple:"1F1F7-1F1F8",google:"1F1F7-1F1F8",twitter:"1F1F7-1F1F8"},shortcode:"flag-rs",description:"REGIONAL INDICATOR SYMBOL LETTERS RS",category:"flag"},{name:"flag-ru",unicode:{apple:"1F1F7-1F1FA",google:"1F1F7-1F1FA",twitter:"1F1F7-1F1FA"},shortcode:"flag-ru",description:"REGIONAL INDICATOR SYMBOL LETTERS RU",category:"folderol",category:"flag"},{name:"flag-rw",unicode:{apple:"1F1F7-1F1FC",google:"1F1F7-1F1FC",twitter:"1F1F7-1F1FC"},shortcode:"flag-rw",description:"REGIONAL INDICATOR SYMBOL LETTERS RW",category:"flag"},{name:"flag-sa",unicode:{apple:"1F1F8-1F1E6",google:"1F1F8-1F1E6",twitter:"1F1F8-1F1E6"},shortcode:"flag-sa",description:"REGIONAL INDICATOR SYMBOL LETTERS SA",category:"folderol",category:"flag"},{name:"flag-sb",unicode:{apple:"1F1F8-1F1E7",google:"1F1F8-1F1E7",twitter:"1F1F8-1F1E7"},shortcode:"flag-sb",description:"REGIONAL INDICATOR SYMBOL LETTERS SB",category:"flag"},{name:"flag-sc",unicode:{apple:"1F1F8-1F1E8",google:"1F1F8-1F1E8",twitter:"1F1F8-1F1E8"},shortcode:"flag-sc",description:"REGIONAL INDICATOR SYMBOL LETTERS SC",category:"flag"},{name:"flag-sd",unicode:{apple:"1F1F8-1F1E9",google:"1F1F8-1F1E9",twitter:"1F1F8-1F1E9"},shortcode:"flag-sd",description:"REGIONAL INDICATOR SYMBOL LETTERS SD",category:"flag"},{name:"flag-se",unicode:{apple:"1F1F8-1F1EA",google:"1F1F8-1F1EA",twitter:"1F1F8-1F1EA"},shortcode:"flag-se",description:"REGIONAL INDICATOR SYMBOL LETTERS SE",category:"folderol",category:"flag"},{name:"flag-sg",unicode:{apple:"1F1F8-1F1EC",google:"1F1F8-1F1EC",twitter:"1F1F8-1F1EC"},shortcode:"flag-sg",description:"REGIONAL INDICATOR SYMBOL LETTERS SG",category:"folderol",category:"flag"},{name:"flag-sh",unicode:{apple:"1F1F8-1F1ED",google:"1F1F8-1F1ED",twitter:"1F1F8-1F1ED"},shortcode:"flag-sh",description:"REGIONAL INDICATOR SYMBOL LETTERS SH",category:"flag"},{name:"flag-si",unicode:{apple:"1F1F8-1F1EE",google:"1F1F8-1F1EE",twitter:"1F1F8-1F1EE"},shortcode:"flag-si",description:"REGIONAL INDICATOR SYMBOL LETTERS SI",category:"flag"},{name:"flag-sj",unicode:{apple:"1F1F8-1F1EF",google:"1F1F8-1F1EF",twitter:"1F1F8-1F1EF"},shortcode:"flag-sj",description:"REGIONAL INDICATOR SYMBOL LETTERS SJ",category:"flag"},{name:"flag-sk",unicode:{apple:"1F1F8-1F1F0",google:"1F1F8-1F1F0",twitter:"1F1F8-1F1F0"},shortcode:"flag-sk",description:"REGIONAL INDICATOR SYMBOL LETTERS SK",category:"flag"},{name:"flag-sl",unicode:{apple:"1F1F8-1F1F1",google:"1F1F8-1F1F1",twitter:"1F1F8-1F1F1"},shortcode:"flag-sl",description:"REGIONAL INDICATOR SYMBOL LETTERS SL",category:"flag"},{name:"flag-sm",unicode:{apple:"1F1F8-1F1F2",google:"1F1F8-1F1F2",twitter:"1F1F8-1F1F2"},shortcode:"flag-sm",description:"REGIONAL INDICATOR SYMBOL LETTERS SM",category:"flag"},{name:"flag-sn",unicode:{apple:"1F1F8-1F1F3",google:"1F1F8-1F1F3",twitter:"1F1F8-1F1F3"},shortcode:"flag-sn",description:"REGIONAL INDICATOR SYMBOL LETTERS SN",category:"flag"},{name:"flag-so",unicode:{apple:"1F1F8-1F1F4",google:"1F1F8-1F1F4",twitter:"1F1F8-1F1F4"},shortcode:"flag-so",description:"REGIONAL INDICATOR SYMBOL LETTERS SO",category:"flag"},{name:"flag-sr",unicode:{apple:"1F1F8-1F1F7",google:"1F1F8-1F1F7",twitter:"1F1F8-1F1F7"},shortcode:"flag-sr",description:"REGIONAL INDICATOR SYMBOL LETTERS SR",category:"flag"},{name:"flag-ss",unicode:{apple:"1F1F8-1F1F8",google:"1F1F8-1F1F8",twitter:"1F1F8-1F1F8"},shortcode:"flag-ss",description:"REGIONAL INDICATOR SYMBOL LETTERS SS",category:"flag"},{name:"flag-st",unicode:{apple:"1F1F8-1F1F9",google:"1F1F8-1F1F9",twitter:"1F1F8-1F1F9"},shortcode:"flag-st",description:"REGIONAL INDICATOR SYMBOL LETTERS ST",category:"flag"},{name:"flag-sv",unicode:{apple:"1F1F8-1F1FB",google:"1F1F8-1F1FB",twitter:"1F1F8-1F1FB"},shortcode:"flag-sv",description:"REGIONAL INDICATOR SYMBOL LETTERS SV",category:"flag"},{name:"flag-sx",unicode:{apple:"1F1F8-1F1FD",google:"1F1F8-1F1FD",twitter:"1F1F8-1F1FD"},shortcode:"flag-sx",description:"REGIONAL INDICATOR SYMBOL LETTERS SX",category:"flag"},{name:"flag-sy",unicode:{apple:"1F1F8-1F1FE",google:"1F1F8-1F1FE",twitter:"1F1F8-1F1FE"},shortcode:"flag-sy",description:"REGIONAL INDICATOR SYMBOL LETTERS SY",category:"flag"},{name:"flag-sz",unicode:{apple:"1F1F8-1F1FF",google:"1F1F8-1F1FF",twitter:"1F1F8-1F1FF"},shortcode:"flag-sz",description:"REGIONAL INDICATOR SYMBOL LETTERS SZ",category:"flag"},{name:"flag-ta",unicode:{apple:"1F1F9-1F1E6",google:"1F1F9-1F1E6",twitter:"1F1F9-1F1E6"},shortcode:"flag-ta",description:"REGIONAL INDICATOR SYMBOL LETTERS TA",category:"flag"},{name:"flag-tc",unicode:{apple:"1F1F9-1F1E8",google:"1F1F9-1F1E8",twitter:"1F1F9-1F1E8"},shortcode:"flag-tc",description:"REGIONAL INDICATOR SYMBOL LETTERS TC",category:"flag"},{name:"flag-td",unicode:{apple:"1F1F9-1F1E9",google:"1F1F9-1F1E9",twitter:"1F1F9-1F1E9"},shortcode:"flag-td",description:"REGIONAL INDICATOR SYMBOL LETTERS TD",category:"flag"},{name:"flag-tf",unicode:{apple:"1F1F9-1F1EB",google:"1F1F9-1F1EB",twitter:"1F1F9-1F1EB"},shortcode:"flag-tf",description:"REGIONAL INDICATOR SYMBOL LETTERS TF",category:"flag"},{name:"flag-tg",unicode:{apple:"1F1F9-1F1EC",google:"1F1F9-1F1EC",twitter:"1F1F9-1F1EC"},shortcode:"flag-tg",description:"REGIONAL INDICATOR SYMBOL LETTERS TG",category:"flag"},{name:"flag-th",unicode:{apple:"1F1F9-1F1ED",google:"1F1F9-1F1ED",twitter:"1F1F9-1F1ED"},shortcode:"flag-th",description:"REGIONAL INDICATOR SYMBOL LETTERS TH",category:"flag"},{name:"flag-tj",unicode:{apple:"1F1F9-1F1EF",google:"1F1F9-1F1EF",twitter:"1F1F9-1F1EF"},shortcode:"flag-tj",description:"REGIONAL INDICATOR SYMBOL LETTERS TJ",category:"flag"},{name:"flag-tk",unicode:{apple:"1F1F9-1F1F0",google:"1F1F9-1F1F0",twitter:"1F1F9-1F1F0"},shortcode:"flag-tk",description:"REGIONAL INDICATOR SYMBOL LETTERS TK",category:"flag"},{name:"flag-tl",unicode:{apple:"1F1F9-1F1F1",google:"1F1F9-1F1F1",twitter:"1F1F9-1F1F1"},shortcode:"flag-tl",description:"REGIONAL INDICATOR SYMBOL LETTERS TL",category:"flag"},{name:"flag-tm",unicode:{apple:"1F1F9-1F1F2",google:"1F1F9-1F1F2",twitter:"1F1F9-1F1F2"},shortcode:"flag-tm",description:"REGIONAL INDICATOR SYMBOL LETTERS TM",category:"flag"},{name:"flag-tn",unicode:{apple:"1F1F9-1F1F3",google:"1F1F9-1F1F3",twitter:"1F1F9-1F1F3"},shortcode:"flag-tn",description:"REGIONAL INDICATOR SYMBOL LETTERS TN",category:"flag"},{name:"flag-to",unicode:{apple:"1F1F9-1F1F4",google:"1F1F9-1F1F4",twitter:"1F1F9-1F1F4"},shortcode:"flag-to",description:"REGIONAL INDICATOR SYMBOL LETTERS TO",category:"flag"},{name:"flag-tr",unicode:{apple:"1F1F9-1F1F7",google:"1F1F9-1F1F7",twitter:"1F1F9-1F1F7"},shortcode:"flag-tr",description:"REGIONAL INDICATOR SYMBOL LETTERS TR",category:"folderol",category:"flag"},{name:"flag-tt",unicode:{apple:"1F1F9-1F1F9",google:"1F1F9-1F1F9",twitter:"1F1F9-1F1F9"},shortcode:"flag-tt",description:"REGIONAL INDICATOR SYMBOL LETTERS TT",category:"flag"},{name:"flag-tv",unicode:{apple:"1F1F9-1F1FB",google:"1F1F9-1F1FB",twitter:"1F1F9-1F1FB"},shortcode:"flag-tv",description:"REGIONAL INDICATOR SYMBOL LETTERS TV",category:"flag"},{name:"flag-tw",unicode:{apple:"1F1F9-1F1FC",google:"1F1F9-1F1FC",twitter:"1F1F9-1F1FC"},shortcode:"flag-tw",description:"REGIONAL INDICATOR SYMBOL LETTERS TW",category:"flag"},{name:"flag-tz",unicode:{apple:"1F1F9-1F1FF",google:"1F1F9-1F1FF",twitter:"1F1F9-1F1FF"},shortcode:"flag-tz",description:"REGIONAL INDICATOR SYMBOL LETTERS TZ",category:"flag"},{name:"flag-ua",unicode:{apple:"1F1FA-1F1E6",google:"1F1FA-1F1E6",twitter:"1F1FA-1F1E6"},shortcode:"flag-ua",description:"REGIONAL INDICATOR SYMBOL LETTERS UA",category:"flag"},{name:"flag-ug",unicode:{apple:"1F1FA-1F1EC",google:"1F1FA-1F1EC",twitter:"1F1FA-1F1EC"},shortcode:"flag-ug",description:"REGIONAL INDICATOR SYMBOL LETTERS UG",category:"flag"},{name:"flag-um",unicode:{apple:"1F1FA-1F1F2",google:"1F1FA-1F1F2",twitter:"1F1FA-1F1F2"},shortcode:"flag-um",description:"REGIONAL INDICATOR SYMBOL LETTERS UM",category:"flag"},{name:"flag-us",unicode:{apple:"1F1FA-1F1F8",google:"1F1FA-1F1F8",twitter:"1F1FA-1F1F8"},shortcode:"flag-us",description:"REGIONAL INDICATOR SYMBOL LETTERS US",category:"folderol",category:"flag"},{name:"flag-uy",unicode:{apple:"1F1FA-1F1FE",google:"1F1FA-1F1FE",twitter:"1F1FA-1F1FE"},shortcode:"flag-uy",description:"REGIONAL INDICATOR SYMBOL LETTERS UY",category:"flag"},{name:"flag-uz",unicode:{apple:"1F1FA-1F1FF",google:"1F1FA-1F1FF",twitter:"1F1FA-1F1FF"},shortcode:"flag-uz",description:"REGIONAL INDICATOR SYMBOL LETTERS UZ",category:"flag"},{name:"flag-va",unicode:{apple:"1F1FB-1F1E6",google:"1F1FB-1F1E6",twitter:"1F1FB-1F1E6"},shortcode:"flag-va",description:"REGIONAL INDICATOR SYMBOL LETTERS VA",category:"flag"},{name:"flag-vc",unicode:{apple:"1F1FB-1F1E8",google:"1F1FB-1F1E8",twitter:"1F1FB-1F1E8"},shortcode:"flag-vc",description:"REGIONAL INDICATOR SYMBOL LETTERS VC",category:"flag"},{name:"flag-ve",unicode:{apple:"1F1FB-1F1EA",google:"1F1FB-1F1EA",twitter:"1F1FB-1F1EA"},shortcode:"flag-ve",description:"REGIONAL INDICATOR SYMBOL LETTERS VE",category:"flag"},{name:"flag-vg",unicode:{apple:"1F1FB-1F1EC",google:"1F1FB-1F1EC",twitter:"1F1FB-1F1EC"},shortcode:"flag-vg",description:"REGIONAL INDICATOR SYMBOL LETTERS VG",category:"flag"},{name:"flag-vi",unicode:{apple:"1F1FB-1F1EE",google:"1F1FB-1F1EE",twitter:"1F1FB-1F1EE"},shortcode:"flag-vi",description:"REGIONAL INDICATOR SYMBOL LETTERS VI",category:"flag"},{name:"flag-vn",unicode:{apple:"1F1FB-1F1F3",google:"1F1FB-1F1F3",twitter:"1F1FB-1F1F3"},shortcode:"flag-vn",description:"REGIONAL INDICATOR SYMBOL LETTERS VN",category:"folderol",category:"flag"},{name:"flag-vu",unicode:{apple:"1F1FB-1F1FA",google:"1F1FB-1F1FA",twitter:"1F1FB-1F1FA"},shortcode:"flag-vu",description:"REGIONAL INDICATOR SYMBOL LETTERS VU",category:"flag"},{name:"flag-wf",unicode:{apple:"1F1FC-1F1EB",google:"1F1FC-1F1EB",twitter:"1F1FC-1F1EB"},shortcode:"flag-wf",description:"REGIONAL INDICATOR SYMBOL LETTERS WF",category:"flag"},{name:"flag-ws",unicode:{apple:"1F1FC-1F1F8",google:"1F1FC-1F1F8",twitter:"1F1FC-1F1F8"},shortcode:"flag-ws",description:"REGIONAL INDICATOR SYMBOL LETTERS WS",category:"flag"},{name:"flag-xk",unicode:{apple:"1F1FD-1F1F0",google:"1F1FD-1F1F0",twitter:"1F1FD-1F1F0"},shortcode:"flag-xk",description:"REGIONAL INDICATOR SYMBOL LETTERS XK",category:"flag"},{name:"flag-ye",unicode:{apple:"1F1FE-1F1EA",google:"1F1FE-1F1EA",twitter:"1F1FE-1F1EA"},shortcode:"flag-ye",description:"REGIONAL INDICATOR SYMBOL LETTERS YE",category:"flag"},{name:"flag-yt",unicode:{apple:"1F1FE-1F1F9",google:"1F1FE-1F1F9",twitter:"1F1FE-1F1F9"},shortcode:"flag-yt",description:"REGIONAL INDICATOR SYMBOL LETTERS YT",category:"flag"},{name:"flag-za",unicode:{apple:"1F1FF-1F1E6",google:"1F1FF-1F1E6",twitter:"1F1FF-1F1E6"},shortcode:"flag-za",description:"REGIONAL INDICATOR SYMBOL LETTERS ZA",category:"folderol",category:"flag"},{name:"flag-zm",unicode:{apple:"1F1FF-1F1F2",google:"1F1FF-1F1F2",twitter:"1F1FF-1F1F2"},shortcode:"flag-zm",description:"REGIONAL INDICATOR SYMBOL LETTERS ZM",category:"flag"},{name:"flag-zw",unicode:{apple:"1F1FF-1F1FC",google:"1F1FF-1F1FC",twitter:"1F1FF-1F1FC"},shortcode:"flag-zw",description:"REGIONAL INDICATOR SYMBOL LETTERS ZW",category:"flag"}]}),function(e){function t(t,n){this.element=t,this.$el=e(t),this.settings=e.extend({},c,n),this.$container=e(this.settings.container),this.settings.width=parseInt(this.settings.width),this.settings.height=parseInt(this.settings.height),this.settings.width>=u?this.settings.width=u:this.settings.width<d&&(this.settings.width=d),this.settings.height>=p?this.settings.height=p:this.settings.height<h&&(this.settings.height=h);var i=["left","right"];-1==e.inArray(this.settings.position,i)&&(this.settings.position=c.position),/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?this.isMobile=!0:this.init();
}function n(){var t=[],n={undefined:"object"},i={},o="undefined"!=typeof Storage?!0:!1;e.each(e.fn.emojiPicker.emojis,function(e,t){var o=n[t.category]||t.category;i[o]=i[o]||[],i[o].push(t)}),t.push('<div class="emojiPicker">'),t.push("<nav>"),o&&t.push('<div class="tab active" data-tab="recent"><div class="emoji emoji-tab-recent"></div></div>');for(var r=g.length,a=0;r>a;a++)t.push('<div class="tab'+(o||0!=a?"":" active")+'" data-tab="'+g[a].name+'"><div class="emoji emoji-tab-'+g[a].name+'"></div></div>');if(t.push("</nav>"),t.push('<div class="sections">'),t.push('<section class="search">'),t.push('<input type="search" placeholder="Search...">'),t.push('<div class="wrap" style="display:none;"><h1>Search Results</h1></div>'),t.push("</section>"),o){var s=[],l=0,c=' style="display:none;"';localStorage.emojis&&(s=JSON.parse(localStorage.emojis),l=s.length,c=' style="display:block;"'),t.push('<section class="recent" data-count="'+s.length+'"'+c+">"),t.push('<h1>Recently Used</h1><div class="wrap">');for(var a=s.length-1;a>-1;a--)t.push('<em><span class="emoji emoji-'+s[a]+'"></span></em>');t.push("</div></section>")}for(var a=0;r>a;a++){var d=i[g[a].name].length;t.push('<section class="'+g[a].name+'" data-count="'+d+'">'),t.push("<h1>"+g[a].label+'</h1><div class="wrap">');for(var u=0;d>u;u++){var h=i[g[a].name][u];t.push('<em><span class="emoji emoji-'+h.shortcode+'"></span></em>')}t.push("</div></section>")}return t.push("</div>"),t.push("</div>"),t.join("\n")}function i(t){for(var n=e.fn.emojiPicker.emojis,i=0;i<n.length;i++)if(n[i].shortcode==t)return n[i]}function o(e,t){if(document.selection){e.focus();var n=document.selection.createRange();n.text=t,e.focus()}else if(e.selectionStart||"0"==e.selectionStart){var i=e.selectionStart,o=e.selectionEnd,r=e.scrollTop;e.value=e.value.substring(0,i)+t+e.value.substring(o,e.value.length),e.focus(),e.selectionStart=i+t.length,e.selectionEnd=i+t.length,e.scrollTop=r}else e.focus(),e.value+=t}function r(e){var t=e.split("-").map(function(e,t){return parseInt(e,16)});return String.fromCodePoint.apply(null,t)}function a(e){var t=[];localStorage.emojis&&(t=JSON.parse(localStorage.emojis));var n=t.indexOf(e);n>-1&&t.splice(n,1),t.push(e),t.length>c.recentCount&&t.shift(),localStorage.emojis=JSON.stringify(t)}function s(t){for(var n=JSON.parse(localStorage.emojis),i=[],o=e("section.recent"),r=n.length-1;r>=0;r--)i.push('<em><span class="emoji emoji-'+n[r]+'"></span></em>');var a=o.outerHeight();e("section.recent .wrap").html(i.join(""));var s=e(".sections").scrollTop(),l=o.outerHeight(),c=0;e("section.recent").is(":visible")?a!=l&&(c=l-a):(o.show(),c=l),e(".sections").animate({scrollTop:s+c},0)}var l="emojiPicker",c={width:"200",height:"350",position:"right",fadeTime:100,iconColor:"black",iconBackgroundColor:"#eee",recentCount:36,emojiSet:"apple",container:"body",button:!0},d=280,u=600,h=100,p=350,f=50,g=[{name:"people",label:"People"},{name:"nature",label:"Nature"},{name:"food",label:"Food"},{name:"activity",label:"Activities"},{name:"travel",label:"Travel & Places"},{name:"object",label:"Objects"},{name:"symbol",label:"Symbols"},{name:"flag",label:"Flags"}];e.extend(t.prototype,{init:function(){this.active=!1,this.addPickerIcon(),this.createPicker(),this.updatePosition(),this.listen()},addPickerIcon:function(){if(this.settings.button){var t=this.$el.outerHeight(),n=t>f?f:t,i=this.$el.width();this.$el.width(i),this.$wrapper=this.$el.wrap("<div class='emojiPickerIconWrap'></div>").parent(),this.$icon=e('<div class="emojiPickerIcon"></div>').height(n).width(n).addClass(this.settings.iconColor).css("backgroundColor",this.settings.iconBackgroundColor),this.$wrapper.append(this.$icon)}},createPicker:function(){this.$picker=e(n()).appendTo(this.$container).width(this.settings.width).height(this.settings.height).css("z-index",1e4),this.$picker.find(".sections").height(parseInt(this.settings.height)-40),this.settings.width<240&&this.$picker.find(".emoji").css({width:"1em",height:"1em"})},destroyPicker:function(){return this.isMobile?this:(this.$picker.unbind("mouseover"),this.$picker.unbind("mouseout"),this.$picker.unbind("click"),this.$picker.remove(),e.removeData(this.$el.get(0),"emojiPicker"),this)},listen:function(){this.settings.button&&this.$wrapper.find(".emojiPickerIcon").click(e.proxy(this.iconClicked,this)),this.$picker.on("click","em",e.proxy(this.emojiClicked,this)),this.$picker.on("mouseover","em",e.proxy(this.emojiMouseover,this)),this.$picker.on("mouseout","em",e.proxy(this.emojiMouseout,this)),this.$picker.find("nav .tab").click(e.proxy(this.emojiCategoryClicked,this)).mouseover(e.proxy(this.emojiTabMouseover,this)).mouseout(e.proxy(this.emojiMouseout,this)),this.$picker.find(".sections").scroll(e.proxy(this.emojiScroll,this)),this.$picker.click(e.proxy(this.pickerClicked,this)),this.$picker.find("section.search input").on("keyup search",e.proxy(this.searchCharEntered,this)),this.$picker.find(".shortcode").mouseover(function(e){e.stopPropagation()}),e(document.body).click(e.proxy(this.clickOutside,this)),e(window).resize(e.proxy(this.updatePosition,this))},updatePosition:function(){var e=this.$picker.offsetParent(),t=e.offset(),n=this.$el.offset();"right"==this.settings.position&&(n.left+=this.$el.outerWidth()-this.settings.width),n.top+=this.$el.outerHeight();var i={top:n.top-t.top,left:n.left-t.top};return this.$picker.css({top:i.top,left:i.left}),this},hide:function(){this.$picker.hide(this.settings.fadeTime,"linear",function(){this.active=!1,this.settings.onHide&&this.settings.onHide(this.$picker,this.settings,this.active)}.bind(this))},show:function(){this.$el.focus(),this.updatePosition(),this.$picker.show(this.settings.fadeTime,"linear",function(){this.active=!0,this.settings.onShow&&this.settings.onShow(this.$picker,this.settings,this.active)}.bind(this))},iconClicked:function(){this.$picker.is(":hidden")?(this.show(),this.$picker.find(".search input").length>0&&this.$picker.find(".search input").focus()):this.hide()},emojiClicked:function(t){var n,l=e(t.target);n=l.is("em")?l.find("span"):l.parent().find(".emoji");var d=n.attr("class").split("emoji-")[1],u=r(i(d).unicode[c.emojiSet]);o(this.element,u),a(d),s(d),e(this.element).trigger("keyup");var h=document.createEvent("HTMLEvents");h.initEvent("input",!0,!0),this.element.dispatchEvent(h)},emojiMouseover:function(t){var n=e(t.target).parent().find(".emoji").attr("class").split("emoji-")[1],i=e(t.target).parents(".emojiPicker").find(".shortcode");i.find(".random").hide(),i.find(".info").show().html('<div class="emoji emoji-'+n+'"></div><em>'+n+"</em>")},emojiMouseout:function(t){e(t.target).parents(".emojiPicker").find(".shortcode .info").empty().hide(),e(t.target).parents(".emojiPicker").find(".shortcode .random").show()},emojiCategoryClicked:function(t){var n="";this.$picker.find("nav .tab").removeClass("active"),e(t.target).parent().hasClass("tab")?(n=e(t.target).parent().attr("data-tab"),e(t.target).parent(".tab").addClass("active")):(n=e(t.target).attr("data-tab"),e(t.target).addClass("active"));var i=this.$picker.find("section."+n),o=i.parent().scrollTop(),r=i.offset().top,a=i.parent().offset().top,s=o+r-a;e(".sections").off("scroll");var l=this;e(".sections").animate({scrollTop:s},250,function(){l.$picker.find(".sections").on("scroll",e.proxy(l.emojiScroll,l))})},emojiTabMouseover:function(t){var n="";n=e(t.target).parent().hasClass("tab")?e(t.target).parent().attr("data-tab"):e(t.target).attr("data-tab");for(var i="",o=0;o<g.length;o++)g[o].name==n&&(i=g[o].label);""==i&&(i="Recently Used");var r=e("section."+n).attr("data-count"),a='<em class="tabTitle">'+i+' <span class="count">('+r+" emojis)</span></em>",s=e(t.target).parents(".emojiPicker").find(".shortcode");s.find(".random").hide(),s.find(".info").show().html(a)},emojiScroll:function(t){var n=e("section");e.each(n,function(t,i){var o=n[t],r=e(o).position().top;return"search"==o.className||"people"==o.className&&r>0?void e(o).parents(".emojiPicker").find("nav tab.recent").addClass("active"):void(0>=r&&(e(o).parents(".emojiPicker").find("nav .tab").removeClass("active"),e(o).parents(".emojiPicker").find("nav .tab[data-tab="+o.className+"]").addClass("active")))})},pickerClicked:function(e){e.stopPropagation()},clickOutside:function(e){this.active&&this.hide()},searchCharEntered:function(t){var n=e(t.target).val(),i=e(t.target).parents(".sections").find("section.search"),o=i.find(".wrap"),r=e(t.target).parents(".sections").find("section");if(""==n&&(r.show(),o.hide()),n.length>0){r.hide(),i.show(),o.show();var a=[];o.find("em").remove(),e.each(e.fn.emojiPicker.emojis,function(e,t){var i=t.shortcode;i.indexOf(n)>-1&&a.push('<em><div class="emoji emoji-'+i+'"></div></em>')}),o.append(a.join(""))}else r.show(),o.hide()}}),e.fn[l]=function(n){return"string"==typeof n?(this.each(function(){var t=e.data(this,l);switch(n){case"toggle":t.iconClicked();break;case"destroy":t.destroyPicker()}}),this):(this.each(function(){e.data(this,l)||e.data(this,l,new t(this,n))}),this)},String.fromCodePoint||(String.fromCodePoint=function(){var e,t,n,i,o=[];for(i=0;i<arguments.length;++i)e=arguments[i],t=e-65536,n=e>65535?[55296+(t>>10),56320+(1023&t)]:[e],o.push(String.fromCharCode.apply(null,n));return o.join("")})}(jQuery),"undefined"==typeof View&&(View={}),View.ChatTournament=function(e,t,n){function i(t,n){return n&&n.length?void(s||o(n)):(e.empty().removeClass("gameSlidingTabs").addClass("notationTable"),void(l.notationTable=new View.NotationArea(e)))}function o(e){p.on("click",function(){$gameSlidingTabs=$(".gameSlidingTabs"),h.hasClass("active")?(g.trigger("click"),$gameSlidingTabs.addClass("collapse")):(m.trigger("click"),$gameSlidingTabs.removeClass("collapse"))}),f.on("click",function(){var e=jQuery(this),t=jQuery(".slidingTabTournamentChat");f.removeClass("active"),v.removeClass("active"),e.addClass("active");var n=jQuery(".jsClone.chatRoomSelector");e.hasClass("notation")?(h.addClass("active"),p.addClass("up"),n.hide(),window.settings.set("broadcast-chat-selected",0)):(t.addClass("active"),p.removeClass("up"),n.show(),window.settings.set("broadcast-chat-selected",1),t.one("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",function(e){n.offset(jQuery(".selectChatRoom").offset())})),n.css("z-index",t.hasClass("active")?32:0)}),(!window.settings.getBoolean("broadcast-chat-selected")||window.config.isMobileView())&&m.trigger("click"),$(document).ready(function(){setTimeout(function(){if(0===$(".move").length){$(".gameSlidingTabs").addClass("collapse"),p.removeClass("up");var e=jQuery(".slidingTabTournamentChat");h.removeClass("active"),e.addClass("active"),window.settings.set("broadcast-chat-selected",1)}},100)});var i=new RegExp("_"+config.language()+"$"),o=e.find(function(e){return i.test(e)})||e[0];chatHandler.addChat(u,e,{showSpecialInput:!1,defaultChatRoom:o,embedded:n,tournamentId:t}),l.InlineNotation=new View.InlineNotation(d),l.notationTable=new View.NotationArea(c,"broadcast"),$redesign&&(d.hide(),p.hide()),s=!0}var r=this,a=new Controller.BroadcastTournament;e=jQuery(e),0===e.length&&errorHandler.error(new Error("container not found"),{container:e});var s,l={},c=e.find(".notationTable"),d=e.find(".notationTableInline > div"),u=e.find(".tournamentChat"),h=e.find(".slidingTabNotationTable"),p=e.find(".toggleNotationTable"),f=e.find(".slidingTabTrigger"),g=e.find(".slidingTabTrigger.chat"),m=e.find(".slidingTabTrigger.notation"),v=e.find(".slidingTabContent");Extend.Suspendable(r),r.onResume(function(){Object.forEach(l,function(e){e.resume(!0)})}).onSuspend(function(){Object.forEach(l,function(e){e.suspend()})});var y={};return y["set."+t+".chatRooms"]=r.delegate(i),Extend.Subscriber(r,y,{afterLink:function(e){i(e,a.getAttribute(t,"chatRooms")),Object.forEach(l,function(t){t.link(e.publisher)})},afterUnlink:function(e){Object.forEach(l,function(t){t.unlink(e.publisher)})}}),r},"undefined"==typeof View&&(View={}),View.ChessBoard=function(e,n,i,o){function r(e){return e=void 0!==e?e:!B,B&&e||!B&&!e?k:(B=e,k.reDraw(),k)}function a(){var e=P.getBoardMargin(S),t=P.getBoardMargin(j),n=M?e:0,i=M?t:0,o=P.getBoardSize(S),r=P.getBoardSize(j);if(O=jQuery("<img />").addClass("boardImage").attr("src",P.getBoardUrl(s())).css({position:"absolute",left:"0px",top:"0px"}).appendTo(R),k.boardOffset=O.position(),I=jQuery("<div />").addClass("svg").attr("style","opacity:0.6; position:absolute; left:"+(n+k.boardOffset.left)+"px; top:"+(i+k.boardOffset.top)+"px; height:"+(r-2*i)+"px; width:"+(o-2*n)+"px;").appendTo(R),A=jQuery("<div />").addClass("popupInsider").addClass("piecePromotionDialog").appendTo(F),$redesign&&!F.hasClass("noInfo"))for(var a=0;7>=a;a++)B?(infoHTMLLeft=8-a,infoHTMLBottom=String.fromCharCode(97+a)):(infoHTMLLeft=1+a,infoHTMLBottom=String.fromCharCode(104-a)),jQuery("<div>").addClass("infoLeft"+a).addClass("infoBoard").html(infoHTMLLeft).attr("style","position:absolute;").appendTo(R),jQuery("<div>").addClass("infoBottom"+a).addClass("infoBoard").html(infoHTMLBottom).attr("style","position:absolute;").appendTo(R);for(var l=0;8>l;l++)for(var c=7;c>=0;c--){var d=jQuery("<div />").addClass("_"+c+l).addClass("cell").data("coordinates",c.toString()+l.toString()).attr("style","position:absolute;");R.append(d),(c+l)%2!=0&&d.addClass(P.getWhiteSquareColor());var u=jQuery("<img />").addClass("highlight_"+c+l).addClass("highlight").data("coordinates",c.toString()+l.toString()).attr("src",P.getHighlightUrl()).attr("style","position:absolute; top:auto; left:auto; z-index:2;");d.append(u)}return L=Raphael(I.get(0),o-2*e,r-2*t),I.children().css({left:"0px",top:"0px"}),C(),k}function s(){return B?"white":"black"}function l(){for(Q={additionalArrow:[]},c();D.length>0;){var e=D.pop();jQuery(e).stop(!0,!0)}return k}function c(){return L.clear(),k}function d(e,t,n){function i(e,t,n,i,o){var r=jQuery(F).find("._"+t.y+t.x),a=jQuery(F).find("._"+n.y+n.x),s=r.position().top,l=r.position().left,c=a.position().top,d=a.position().left,u=d-l,h=c-s;return e.zIndex(i),D.push(e),e.animate({left:u,top:h},E||1,function(){F.find("._"+n.y+n.x+" .piece").remove(),e.data("coordinates",n.y.toString()+n.x.toString()),F.find("._"+n.y+n.x).append(e),e.css({top:"auto",left:"auto"}).zIndex(3),o&&o()}),k}var o=e.startSquare,r=e.endSquare;e.castleInfo.isCastle&&(r=e.castleInfo.endSquare),t=t||{};var a=F.find("._"+o.y+o.x).find(".piece").not(".ui-draggable-dragging");if(window.settings.getBoolean("game-highlight-last-move")&&k.addArrow(e.x1,e.y1,e.x2,e.y2),i(a,o,r,30,function(){if(t.removePiece&&F.find("._"+t.removePiece.y+t.removePiece.x+" .piece").remove(),e.promotion){var i=e.promotion;"w"===n&&(i=i.toUpperCase())}else i=N.getPiece(r);var a=P.getPieceUrl(i);F.find("._"+r.y+r.x+" .piece").attr("src",a),Q.move&&Q.move.y1===o.y&&Q.move.y2===r.y&&Q.move.x1===o.x&&Q.move.x2===r.x&&k.addArrow(o.x,o.y,r.x,r.y)}),t.additionalMove){var s=t.additionalMove.startSquare,l=t.additionalMove.endSquare,c=F.find("._"+s.y+s.x).find(".piece").not(".ui-draggable-dragging");i(c,s,l,29)}return k}function u(e,t){var n=e.publisher;return void 0!==k.highlightHandler&&(k.highlightHandler.anyMovesAllowed=n.getMoveMode(void 0,!0)||n.getMoveMode(void 0,!1)),l(),v(t),d(t.moveCoords,t.additionalMoveInformation,t.parentMove.moveRight),p(e,n.getHighlights()),void 0!==k.highlightHandler&&(p(e,n.getHighlights()),k.markKingInCheck()),k}function h(e){var t=e.publisher;E=y(),l(),void 0!==k.highlightHandler&&(k.highlightHandler.anyMovesAllowed=t.getMoveMode(void 0,!0)||t.getMoveMode(void 0,!1));var n=t.getCurrentPosition();if(N===n)return k;F.find(" .cell .piece").remove();for(var i=P.getSquareSize(),o=0;8>o;o++)for(var r=0;8>r;r++){var a=n.getPiece(o,r);if("-"!==a){var s=P.getPieceUrl(a),c=a.toLowerCase()===a?"black":"white",d=jQuery('<img src="'+s+'" width="'+i+'" height="'+i+'" style="position : relative;" />').zIndex(2);d.data("coordinates",o.toString()+r.toString()),d.addClass("piece "+c),F.find("._"+o+r).append(d)}}return k.movementHandler&&k.movementHandler.cancelPremove(),v(n),k.movementHandler&&k.movementHandler.initEvents(),k.highlightHandler&&(p(e,t.getHighlights()),k.markKingInCheck()),n.isRootPosition()||k.addArrow(n.moveCoords.x1,n.moveCoords.y1,n.moveCoords.x2,n.moveCoords.y2).drawArrow(),k}function p(e,t){k.highlightHandler.unHighlightAll(),w();for(var n=0;n<t.length;n++){var i=t[n];i.square?g(e,i):i.frame?g(e,i,!0):i.line&&f(e,i)}return k}function f(e,t){return Q.additionalArrow.push(t),k.drawArrow(),k}function g(e,t,n){if(t.frame)var i="take",o=t.frame;else"-"===N.getPiece(t.square)?(i="",o=t.square):(i="take",o=t.square);return k.highlightHandler&&k.highlightHandler.highlightCell(o.y.toString()+o.x.toString(),t.color,i),k}function m(e,t){if(N===t)return k;if(void 0!==k.movementHandler){var n=k.movementHandler.getSelectedPiece();k.highlightHandler.unHighlightAll()}return t.parentMove!==N?h(e):(u(e,t),void 0!==k.highlightHandler&&void 0!==n&&(k.highlightHandler.highlightCell(n.y.toString()+n.x.toString(),"green","select"),window.settings.getBoolean("game-highlight-possible-square")&&k.highlightHandler.highlightTargetSquares(n)),k)}function v(e){return N=e,k.movementHandler&&k.movementHandler.setCurrentPosition(e),k}function y(){var e=window.settings.getNumber("game-board-speed");if("object"==typeof _[e]){var t=T&&T.getType()||"Blitz";return _[e][t]}return _[e]}function w(){Q.additionalArrow=[],k.drawArrow()}function b(e){F.toggleClass("coordinatesOnBoard",e&&F.width()>300)}function C(){setTimeout(function(){var e=F.width();P.setContainerWidth(e),k.reDraw(),L.setSize(e,e)})}var k=this,F=jQuery(e);if(0===F.length&&errorHandler.msg("error",new Error("container not found"),!0,{container:F}),o)var x=new Handler.Keyboard;i=i||Handler.Highlight;var T,_={0:5,1:50,2:200,3:500,4:{Bullet:5,Blitz:50,Classical:200}},E=y(),S="x",j="y";void 0===n&&(n=!0),Extend.Suspendable(k),Extend.Subscriber(k,{currentGameChanged:k.delegate(h),"movedPositionPointer.current":k.delegate(m),"position.highlights.current":k.delegate(p),flipBoard:k.delegate(function(){return k.flip()})},{afterLink:function(e){return T=e.publisher,h(e),n&&(k.movementHandler&&k.movementHandler.isActive()&&k.movementHandler.deactivate(),k.movementHandler=new Handler.Movement(e.publisher,F,N,k,k.highlightHandler)),o&&x.link(T),k.highlightHandler&&k.highlightHandler.link(T),k},afterUnlink:function(){return o&&x.unlink(T),n&&k.movementHandler&&k.movementHandler.isActive()&&k.movementHandler.deactivate(),k.highlightHandler&&T&&k.highlightHandler.unlink(T),k}}),k.onResume(function(e){e&&T&&h({publisher:T})});var I,A,O,M=!0,P=new Handler.Theme(F.width()),B=!0,R=jQuery("<div/>").css({position:"relative",overflow:"hidden"}).addClass("chess-board");F.addClass("board").append(R),b(window.settings.getBoolean("game-coordinates-on-board"));var L,N,D=[],Q={additionalArrow:[]};return k.setUserMoveRight=function(){return k.movementHandler&&k.movementHandler.setUserMoveRight.apply(k.movementHandler,arguments),k},k.getJQueryBoard=function(){return R},k.hideBorder=function(){M=!1;var e=P.getBoardMargin(S),t=P.getBoardMargin(j);return O.css({top:-t+"px",left:-e+"px"}),k.reDraw(),k},k.showBorder=function(){return M=!0,O.css("clip",""),O.css({top:"0px",left:"0px"}),k.reDraw(),k},k.isFlipped=function(){return!B},k.flip=r,k.rotate=r,k.reDraw=function(){var e=P.getSquareSize(),t=P.getBoardSize(S),n=P.getBoardSize(j),i=P.getBoardMargin(S),o=P.getBoardMargin(j);M||(i=0,o=0,e=t/8),M?R.css({width:t+"px",height:n+"px"}):R.css({width:t-2*i+"px",height:n-2*o+"px",margin:o+"px "+i+"px"}),F.find(".piece").width(e).height(e),F.find(".highlight").width(e).height(e),$redesign?O.remove():O.width(P.getBoardSize(S)).height(P.getBoardSize(j)).attr("src",P.getBoardUrl(s())),k.boardOffset=O.position(),k.boardOffset.top=0,k.boardOffset.left=0,I.css({width:t-2*i+"px",height:n-2*o+"px",left:i+k.boardOffset.left+"px",top:o+k.boardOffset.top+"px"});var r=k.getCurrentPosition();if($redesign)for(var a=0;7>=a;a++){var l=F.find(".infoLeft"+a),c=F.find(".infoBottom"+a);B?(l.html(8-a),c.html(String.fromCharCode(97+a))):(l.html(1+a),c.html(String.fromCharCode(104-a))),l.css({width:"10px",height:e+"px",top:o+k.boardOffset.top+e*a+"px",left:"5px","line-height":e+"px"}),c.css({width:e+"px",height:"10px",top:n-o+"px",left:i+k.boardOffset.left+e*a+"px","text-align":"center"})}for(var d=7;d>=0;d--)for(var u=0;8>u;u++){if(B)var h=u,p=Math.abs(7-d);else h=Math.abs(7-u),p=d;var f=F.find("._"+d+u);if(f.css({width:e+"px",height:e+"px",top:o+k.boardOffset.top+e*p+"px",left:i+k.boardOffset.left+e*h+"px"}),f.removeClass("bright"),f.removeClass("dark"),(d+u)%2!=0&&f.addClass(P.getWhiteSquareColor()),r){var g=r.getPiece(d,u);"-"!==g&&F.find("._"+d+u+" .piece").attr("src",P.getPieceUrl(g))}}return k.drawArrow(),k},k.showPromotionDialog=function(e,n,i,r){function a(t){var n=Chess.getMove(e.y1,e.x1,e.y2,e.x2,t);return function(){return i(n),A.modal("hide"),jQuery(document).off("keydown.promotion"),o&&x.setActive(!0),!1}}var s=3;r="undefined"==typeof r?!0:r,A.html("<h3>"+t("Choose your piece")+':</h3><div class="piecesSelection clearFloats"><ul></ul></div>');var l=A.find("ul");if("w"===n)var c=["R","N","B","Q"];else"b"===n?c=["r","n","b","q"]:errorHandler.msg("error",new Error("illegal color"),!0,{color:n});for(var d=0;d<c.length;d++){var u=jQuery("<li/>"),h=jQuery('<a class="promotionPiece promotionPiece'+d+'" href="?promoteTo='+c[d]+'" />'),p=jQuery('<img src="'+P.getPieceUrl(c[d])+'" />');d===s&&u.addClass("selected"),function(e){u.on("mouseenter",function(){$(this).parent().children("li.selected").removeClass("selected"),$(this).addClass("selected"),s=e})}(d),h.on("click",a(c[d])),h.append(p),u.append(h),l.append(u)}return r&&(jQuery('<input type="checkbox"/>').addClass("cPattern").attr("data-setting","game-autopromote-queen").on("change",function(){this.checked&&a(c[c.length-1])()}).appendTo(A),A.append("<span>"+t("Always automatically promote to queen")+"</span>")),window.settings.attach(A),A.modal({align:O,classes:"defaultPopup",persistent:!0}).modal("show"),o&&x.setActive(!1),jQuery(document).on("keydown.promotion",function(e){switch(e.which){case 13:A.find("a.promotionPiece"+s).trigger("click"),e.stopPropagation(),e.preventDefault();break;case 37:s--<=0&&(s=3),e.stopPropagation(),e.preventDefault();break;case 39:s++>=3&&(s=0),e.stopPropagation(),e.preventDefault()}A.find("li.selected").removeClass("selected"),A.find("a.promotionPiece"+s).parent().addClass("selected")}),k},k.resize=function(e){return P.setContainerWidth(e),k.reDraw(),k.getCurrentPosition()&&p(void 0,k.getCurrentPosition().getHighlights()),k},k.clearArrow=function(e){return e?(Q.premove&&(delete Q.premove,k.drawArrow()),k):(k.drawArrow(),k)},k.drawArrow=function(){function e(e,t,n){if(n=n||P.getArrowColor(t),B)var i=e.x1,o=7-e.y1,r=e.x2,a=7-e.y2;else i=7-e.x1,o=e.y1,r=7-e.x2,a=e.y2;var s=P.getSquareSize();M||(s=P.getBoardSize(S)/8);var l=o*s+s/2,c=i*s+s/2,d=a*s+s/2,u=r*s+s/2;L.arrow(s,c,l,u,d,s/3,n)}c(),Q.premove&&e(Q.premove,!0),Q.move&&!Q.move.isNullMove()&&e(Q.move);for(var t=0;t<Q.additionalArrow.length;t++)e(Q.additionalArrow[t].line,void 0,Q.additionalArrow[t].color);return k},k.addArrow=function(e,t,n,i,o){return o?Q.premove=Chess.getMove(t,e,i,n):window.settings.getBoolean("game-highlight-last-move")&&(Q.move=Chess.getMove(t,e,i,n)),k.drawArrow(),k},k.markKingInCheck=function(){if(window.settings.getBoolean("game-highlight-check")&&k.highlightHandler&&N.isCheck()){var e=N.kingPos[N.moveRight];k.highlightHandler.highlightCell(e.y.toString()+e.x.toString(),"red","take")}return k},k.getCurrentPosition=function(){return N},k.getThemeHandler=function(){return P},k.attachPositionHandler=function(t,n){return k.positionHandler=new Handler.Position(e,t,n),k.movementHandler.deactivate("click"),k},k.attachKeyboardHandler=function(){return o||(o=!0,x=new Handler.Keyboard,T&&x.link(T)),k},k.getKeyboardHandler=function(){return x},k.highlightHandler=new i(F,k.getThemeHandler(),function(){return N.getMoveList.apply(this,arguments)},function(){return N}),k.setBlindfold=function(e){return F.removeClass("blindfoldAll blindfoldBlack blindfoldWhite"),"none"!==e&&F.addClass("blindfold"+e.toLowerCase().capitalize()),k},a(),window.settings.on("settings.game-board-theme",function(e,t){P.setBoardTheme(t.value),k.reDraw()}),window.settings.on("settings.game-piece-theme",function(e,t){P.setPieceTheme(t.value),k.reDraw()}),window.settings.on("settings.game-coordinates-on-board",function(e,t){b(t.value)}),window.settings.on("settings.game-board-speed",function(){E=y()}),window.settings.on("settings.play-board-xl",function(){C()}),k.adjust=C,k},"undefined"==typeof View&&(View={}),View.ChessClock=function(e,t){function n(e){d=e.publisher,u.setColor(Chess.colors.invert(t))}function i(){switch(t){case"w":e.removeClass("black").addClass("white");break;case"b":e.removeClass("white").addClass("black")}o(void 0,d.getClockInformation()),r()}function o(e,t){if(t.runningUp)var n="usage";else n="timeLeft";return l!==t[g][n]&&(l=t[g][n],a(t[g][n],t.runningUp)),u}function r(){var n=d.getEndOfMainlinePosition(!0),i=n&&t===n.moveRight&&!d.isOver()&&d.getClockStartMove()<=d.getDepth();e.toggleClass("active",i)}function a(e,t){var n,i,o=Date.getSplitedTime(e);return o.hours>0?(s(!0,!0),n=o.hours,i=o.minutes.toString().lpad("0",2)):t||o.minutes>0||o.seconds>19?(s(!1,!0),n=o.minutes,i=o.seconds.toString().lpad("0",2)):(s(!1,!1),n=(o.seconds+o.milliseconds/1e3).toFixed(1),i=""),n!==a.valueFirst&&p.html(a.valueFirst=n),i!==a.valueLast&&f.html(a.valueLast=i),u}function s(t,n){if(t)var i="hour";else i=n?"min":"sec";i!==c&&(c=i,e.toggleClass("hours","hour"===c).toggleClass("minutes","min"===c).toggleClass("seconds","sec"===c))}var l,c,d,u=this,h=new Handler.Template("playZone");"w"!==t&&"b"!==t&&errorHandler.error(new Error("illegal color in View.ChessClock"),{color:t}),e=jQuery(e),0===e.length&&errorHandler.error(new Error("container not found in View.ChessClock"),{container:e}),e.html(h.render("clock"));var p=e.find(".first"),f=e.find(".last"),g=Chess.colors.letter2full(t);return Extend.Suspendable(u),r.delegate=u.delegate(r),i.delegate=u.delegate(i),o.delegate=u.delegate(o),Extend.Subscriber(u,{clock:o.delegate,"movedPositionPointer.endOfMainline":r.delegate,gameStatusChanged:r.delegate,currentGameChanged:i.delegate,flipBoard:n},{afterLink:function(e){d=e.publisher,i.delegate()}}),u.onResume(function(e){e&&i()}),u.setColor=function(e){return t=e,c=void 0,l=void 0,g=Chess.colors.letter2full(e),i.delegate(),u},u},View.ChessClockRedesign=function(e,t){function n(e){l=e.publisher}function i(){o(void 0,l.getClockInformation()),r()}function o(e,t){if(t.runningUp)var n="usage";else n="timeLeft";return s!==t[d][n]&&(s=t[d][n],a(t[d][n],t.runningUp)),c}function r(){var n=l.getEndOfMainlinePosition(!0),i=n&&t===n.moveRight&&!l.isOver()&&l.getClockStartMove()<=l.getDepth();e.toggleClass("active",i)}function a(t,n){e.html(formatTime(t))}var s,l,c=this;"w"!==t&&"b"!==t&&errorHandler.error(new Error("illegal color in View.ChessClock"),{color:t}),0===e.length&&errorHandler.error(new Error("container not found in View.ChessClock"),{container:e});var d=Chess.colors.letter2full(t);return Extend.Suspendable(c),r.delegate=c.delegate(r),i.delegate=c.delegate(i),o.delegate=c.delegate(o),Extend.Subscriber(c,{clock:o.delegate,"movedPositionPointer.endOfMainline":r.delegate,gameStatusChanged:r.delegate,currentGameChanged:i.delegate,flipBoard:n},{afterLink:function(e){l=e.publisher,i.delegate()}}),c.onResume(function(e){e&&i()}),c},"undefined"==typeof View&&(View={}),function(e){var n,i={},o="/api/web/ChessDatabaseAPI/getGamesList",r="/api/web/ChessDatabaseAPI/getGame";View.ChessDBGames=function(a,s){function l(){l.called=!0,a.html(Q.render("chessDBgames")),w(),b(),k(),F(),x(),T(),N=a.find(".filteredOpeningTreeButton"),layout(a.find(".databaseGamesSummary"))}function c(e){clearTimeout(B),B=setTimeout(function(){d(e)})}function d(e){l.called||l();var t=e.publisher.getCurrentPosition();R=t.getEngineFen(),u(g())}function u(t,n,r){s&&s.setFilterValues(z);var l=0;z.elo&&(l=parseInt(z.elo.split(",")[0],10)),z.playerName?_(l):E(),t=t||0,G=t,V=n=n||V,U=r=r||U;var c=R+t.toString()+n+r+JSON.stringify(z);return i[c]?void y(i[c],n,r,z):void(D.cacheKey!==c&&(D.ajax&&D.ajax.abort(),a.addClass("loading"),D.cacheKey=c,D.ajax=e.getJSON(o+"?level="+config.level().toString(),{fen:R,offset:t.toString(),sortBy:n,sortOrder:r,playerName:z.playerName,color:z.color,result:z.result,timespan:z.timespan,elo:z.elo,eloType:z.eloType,opponentName:z.opponentName}).done(function(e){e.data.gameList=h(e.data.gameList),i[c]=e.data,i[c].gameCount<=1e4&&_(),y(e.data,n,r,z)})))}function h(e){return e.map(function(e){var t=e._id,n=e.gameStartedAt,i=Helper.getFormatedLocalDateTimeSeperated(n).date,o=e.meta.White.Name,r=e.meta.Black.Name,a=e.meta.White.Elo,s=e.meta.Black.Elo,l=e.meta.AvgElo;return{id:t,date:i,dateValue:n,whiteName:o,blackName:r,whiteElo:a,blackElo:s,avgElo:l,result:e.meta.Result.replace(/1\/2/g,"&frac12;")}})}function p(){var t=e(this),n=t.closest("tr").data("chess_game_id");return i[n]?void v(i[n]):(f(),void e.getJSON(r,{id:n}).done(function(e){i[n]=e,v(e)}))}function f(){W[m()]=G}function g(){return W[m()]||0}function m(){return JSON.stringify(Object.reduce(z,function(e,t){return e.concat(t)},R))}function v(e){for(var t=Chess.couchToGame(e.data.game),n=t.getStartPosition(),i=L.getStartPosition();!n.isEndOfLine();)n=n.getChildrenMoveById(0),L.move(n.moveCoords,i,!1,void 0,"local",!0),i=i.getChildrenMoveByMove(n.moveCoords);var o=Q.render("chessDBgamesComment",t.getMeta());L.setComment(o,i),t.destroy()}function y(t,i,o){var r=t.gameList,s=t.gameCount,l=t.additionalData;switch(o){case 1:var c="sortAsc";break;case-1:c="sortDesc"}var d={gameStartedAt:"gameStartedAt"===i,metaWhiteName:"meta.White.Name"===i,metaBlackName:"meta.Black.Name"===i,metaWhiteElo:"meta.White.Elo"===i,metaBlackElo:"meta.Black.Elo"===i,metaAvgElo:"meta.AvgElo"===i,metaResult:"meta.Result"===i},u=a.find(".databaseGames");if(n){var h=n.getActive();Handler.KeyboardDispatcher.remove(n)}var f=jQuery(Q.render("chessDBGamesTable",{isAdmin:config.level().isAdmin,games:r,sortByCols:d,sortOrder:c}));u.empty().append(f),n=new Handler.TableKeyboard(f).link(L),Handler.KeyboardDispatcher.add(n,u),h&&Handler.KeyboardDispatcher.select(n),f.on("chess24:select",function(e,t){t.element&&p.call(t.element,e)});var g=a.find(".databaseGamesInfo");if(g.replaceWith(Q.render("chessDBGamesCount",{gameCount:Number.addThousandSeparators(s)})),r.length&&u.find("tr.chessGame > td").not(".admin").on("click.chessdbGames",p),j(),I(),A(s),u.removeClass("loading"),l>0){var m;config.level(!0).isGuest?m=e(Dialog.conversionRegister("analysis",{returnHTML:!0})):config.level().isPremium||(m=e(Dialog.conversionGoPremium("analysis",{returnHTML:!0})));var v=e('<div class="customPopup"/>').append(m.addClass("conversionInPage")).wrap('<div class="conversionOverlayWrapper"/>'),y=e('<div class="conversionOverlay"/>');u.addClass("premiumOnly").append(y).append(v.parent())}}function w(){C(a.find(".playerNameSearch"),a.find(".databaseGamesSearchPattern .searchDBgame"),a.find(".databaseGamesFiltered .resetPlayerSearch"),a.find(".searchPlayerClear"),"playerName")}function b(){C(a.find(".opponentNameSearch"),a.find(".databaseGamesSearchPattern .searchOpponentInput"),a.find(".databaseGamesFiltered .resetOpponentSearch"),a.find(".searchOpponentClear"),"opponentName")}function C(e,t,n,i,o){function r(){e.toggle(O(t))}function a(){z[o]=t.val(),n.text(s+z[o]).show(),t.val(""),r(),u()}var s=t.data("filter-prefix");s&&(s+=": "),t.on("input",r),e.on("click",a),t.on("chess24:select",a),n.on("click",function(){n.hide(),delete z[o],u()})}function k(){function n(){o.hide(),i.filter(".default").prop("checked",!0),delete z.color,u()}var i=a.find(".GameColorSearch input"),o=a.find(".databaseGamesFiltered .resetColorSearch");i.on("change",function(){var i=e(this);return i.hasClass("default")?void n():(z.color=i.data("value"),o.text(t(z.color)).show(),void u())}),o.on("click",n)}function F(){var n=a.find(".GameResultSearch input"),i=a.find(".databaseGamesFiltered .resetResultSearch");
n.on("change",function(){z.result=e(this).closest("ul").find("input:checked").map(function(t,n){return e(n).data("value")}).toArray().join(","),z.result?i.text(t(z.result)).show():i.hide(),u()}),i.on("click",function(){i.hide(),n.prop("checked",!1),delete z.result,u()})}function x(){var e=a.find(".TimespanSearch"),t=a.find(".databaseGamesFiltered .resetTimespanSearch");S(e,t,"timespan")}function T(){var e=a.find(".EloTypeSearch input"),t=a.find(".RatingSearch"),n=a.find(".databaseGamesFiltered .resetEloSearch");S(t,n,"elo",e,"eloType")}function _(t){N.removeClass("disabled"),N.on("click",function(){config.level().isPremium?(s&&(t?s.setSelectElementByElo(t):s.setSelectElementFiltered()),e("li.tabDatabaseMoves div").click(),e("a[data-tab-content-id=videoTabDatabaseMoves]").click()):config.level().isGuest?Dialog.conversionRegister("customOpeningTree"):Dialog.conversionGoPremium("customOpeningTree",config.level().isGuest?"register":"goPremium")})}function E(){N.addClass("disabled"),N.unbind("click")}function S(t,n,i,o,r){function a(){return o?o.filter(":checked").siblings("span").text()+": ":""}function s(){z[i]?n.text(a()+z[i].replace(","," - ")).show():n.hide()}t.styleRangeSlider(),o&&r&&o.on("change",function(){var t=e(this);z[r]=t.data("value"),s(),u()});var l=t.children(".cPatternSlider"),c=l.slider("option","min"),d=l.slider("option","max");t.on("slidestop",function(e,t){var n=t.values.map(function(e){return Math.round(e)});c<n[0]||d>n[1]?z[i]=n.join(","):delete z[i],s(),u()}),n.on("click",function(){delete z[i],l.slider("values",[c,d]),s(),u()})}function j(){a.find("a.delete").on("click",function(e){var t="/api/web/chessDatabaseAPI/deleteGame/",n=jQuery(this).data("chess_game_id");n&&Dialog.confirmation("Really delete the game?",function(){jQuery.get(t,{id:n}).done(function(){Dialog.alert("Game was deleted successfully"),u()}).fail(function(e){var t=e&&e.responseJSON&&e.responseJSON.data&&e.responseJSON.data.error||"";Dialog.alert("Failed to delete the game. <br>"+t)})})}),a.find("a.edit").on("click",function(){var t=e(this),n=t.data("chess_game_id");return i[n]?void Dialog.editChessGame(i[n].data.game,function(e){M(n,Object.patch(i[n].data.game,e))}):void e.getJSON(r,{id:n}).done(function(e){i[n]=e,Dialog.editChessGame(i[n].data.game,function(e){M(n,Object.patch(i[n].data.game,e))})})})}function I(){new Handler.Sorting(a,function(e,t){u(G,e,t)})}function A(e){var t=a.find("tfoot .cPagination > ul"),n={first:t.find(".goFirst"),prev:t.find(".goPrev"),next:t.find(".goNext")},i={offset:G,total:e,limit:t.data("limit"),noOfPagesToShow:9};new Handler.Pagination(n,i,function(e){u(e,V,U)})}function O(e){return!!e.val().trim().length}function M(e,t){var n="/api/web/chessDatabaseAPI/saveGame";jQuery.post(n,{id:e,csrf:config.csrf(),game:t}).done(function(){u()}).fail(function(){Dialog.alert("Failed to save chessgame")})}var P=Extend.Suspendable(this,!0);a=e(a),a||errorHandler.error("container not found in View.ChessDBGames");var B,R,L,N,D={},Q=new Handler.Template("database"),H=P.delegate(c),G=0,V="gameStartedAt",U=-1,z={};Extend.Subscriber(P,{currentGameChanged:H,"movedPositionPointer.current":H},{afterLink:function(e){n&&n.unlink(L).link(e.publisher),L=e.publisher,H(e)}}),P.onResume(function(e){e&&L&&c({publisher:L})});var W={};return P}}(jQuery),"undefined"==typeof View&&(View={}),function(e){var t,n,i,o={},r=["move","count","date","avgEloPlayer","maxEloPlayer","avgEloOpponent","percent","performance"],a=["move","count","date","avgEloPlayer","maxEloPlayer","avgEloOpponent","percent","performance"],s="/api/web/ChessDatabaseAPI/getMovesList",l="/api/web/ChessDatabaseAPI/getFilteredOpeningTree",c={1:"sortDesc"};View.ChessDBMovesWithSelector=function(t,o){function r(){var t=e(this);t.hasClass("filtered")||i.html(Handler.Template.renderString(i.data("template"),{games:Number.addThousandSeparators(t.data("games")),positions:Number.addThousandSeparators(t.data("positions"))})),l.setCurrentCollection(t.attr("id"))}t=e(t);var a=new Handler.Template("database");t.html(a.render("chessDBmovesWithSelector",config.level())),i=t.find(".databaseSizeInfo");var s=t.find(".dropdownFilter");n=s.find("input"),layout.dropDown(s),n.on("change",r);var l=new View.ChessDBMoves(t.children(".databaseMoves"),o);return r.apply(n.get(0)),l},View.ChessDBMoves=function(d,u){function h(){return n.filter(function(){return e(this).hasClass("filtered")})}function p(t){return t-=t%100,n.filter(function(){return e(this).attr("id")=="openingTreeOnePlayerAtLeast"+t})}function f(e){clearTimeout(C),C=setTimeout(function(){g(e)})}function g(t){var n=(t&&t.publisher||F).getCurrentPosition(),i=n.moveRight,r=n.getEngineFen(),a=r+x+JSON.stringify(T),c=n.moveCounter;if(o[a])return void w(o[a]);if(_.fen!==r||_.collection!==x||JSON.stringify(_.filters)!==JSON.stringify(T)){_.ajax&&_.ajax.abort(),d.addClass("loading"),_.fen=r,_.collection=x;var u={fen:r,filters:T};x&&(u.collection=x);var h="databaseFilter"==x?l:s;_.ajax=e.getJSON(h+"?level="+config.level().toString(),u).done(function(e){delete e.data.moveList.positions,e.data.moveList=m(e.data.moveList,r,i,c),o[a]=e.data,w(e.data)})}}function m(e,t,n,i){t=Chess.translate.engineFenToLongFen(t,"b"===n);var o=new Chess.Position({fen:t}),r=[];return Object.forEach(e,function(e,t){var a="b"===n?Chess.translate.whiteToBlackMove(t):t,s="w"===n?"Player":"Opponent",l="b"===n?"Player":"Opponent",c=o.move({move:Chess.translate.canToMove(a),dontCheckForInsufficentMaterial:!0}).getSan(),d=Math.round(e.averageRatingPlayer),u=Math.round(e.averageRatingOpponent),h=e["point"+s]||0,p=e.draw||0,f=e["point"+l]||0,g=Math.getPercentages([h,p,f]),m={white:g[0],draw:g[1],black:g[2]};r.push({can:a,san:i+("w"===n?". ":"... ")+c,count:e.count,date:Helper.getFormatedLocalDateTimeSeperated(e.lastPlayedDate).date,dateValue:e.lastPlayedDate,avgEloPlayer:d,avgEloOpponent:u,avgElo:Math.round(d,u),maxEloPlayer:e.highestRatedPlayer,maxEloOpponent:e.highestRatedOpponent,maxElo:Math.max(e.highestRatedPlayer,e.highestRatedOpponent),performance:v(u,g,"w"===n),percent:m,resultValue:g[0]+.5*g[1]})}),r}function v(e,t,n){var i=0;return i=n?t[0]:t[2],t[1]>0&&(i+=t[1]/2),Math.round(e+850*(i/100-.5))}function y(){var t=e(this).data("can");F.move(t,k,!0,void 0,"local")}function w(n){var o=n&&n.moveList||[],r=n&&n.additionalItems||0,a=d.find("table.sortable");if(t){var s=t.getActive();Handler.KeyboardDispatcher.remove(t)}if(d.html(E.render("chessDBmoves",{sort:a.data("pattern-sortable")&&a.sortableTable("getCurrentSort")||c,moves:o,columnsToShow:u})),o.length){var l=d.find("table.sortable");l.sortableTable(),t=new Handler.TableKeyboard(l).link(F),Handler.KeyboardDispatcher.add(t,d),s&&(Handler.KeyboardDispatcher.select(t),t.selectDefault()),e("> table tr table tr",d).one("click.openingDB",y),l.on("chess24:select",function(e,t){t.element&&y.call(t.element,e)})}if(n&&n.games&&n.positions&&i.html(Handler.Template.renderString(i.data("template"),{games:Number.addThousandSeparators(n.games),positions:Number.addThousandSeparators(n.positions)})),d.removeClass("loading"),!config.level().isPremium&&r>0){var h=e('<div class="customPopup"/>').append(e(Dialog.conversionGoPremium("analysis",{returnHTML:!0})).addClass("conversionInPage")).wrap('<div class="conversionOverlayWrapper"/>'),p=e('<div class="conversionOverlay"/>');d.append(p).append(h.parent()),d.addClass("premiumOnly")}}u=u||a,u=r.reduce(function(e,t){return e[t]=u.contains(t),e},{});var b=Extend.Suspendable(this,!0);d=e(d).empty(),d.length||errorHandler.error("container not found in ChessDBMoves",{container:d});var C,k,F,x,T,_={},E=new Handler.Template("database"),S=b.delegate(f);return Extend.Subscriber(b,{currentGameChanged:S,"movedPositionPointer.current":S},{afterLink:function(e){return t&&(F&&t.unlink(),t.link(e.publisher)),F=e.publisher,b.isSuspended()?w():void f(e)}}),b.onResume(function(e){e&&F&&f({publisher:F})}),b.setCurrentCollection=function(e){return x=e,f(),b},b.setFilterValues=function(e){T=e,config.level().isPremium&&(Object.getLength(e)?(h().prop("disabled",!1),f()):(h().prop("disabled",!0),n[0].click()))},b.setSelectElementFiltered=function(){h().click()},b.setSelectElementByElo=function(e){h().prop("disabled",!0),p(e).click()},b}}(jQuery),"undefined"==typeof View&&(View={}),View.Color=function(e,t){function n(n){var i=n.publisher,o=i.getEndOfMainlinePosition(!0);e.toggleClass("active",o.moveRight===t&&!i.isOver())}var i=this;return e=jQuery(e),0===e.length&&errorHandler.error(new Error("container not found"),{container:e}),Extend.Subscriber(i,{currentGameChanged:n,"movedPositionPointer.endOfMainline":n},{afterLink:function(e){n(e)}}),i},"undefined"==typeof View&&(View={}),"undefined"==typeof View.Conversation&&(View.Conversation={}),View.Conversation.Conversation=function(e){function t(){var e=jQuery(".conversationContainer"),t=jQuery(window).height()-450;e.css("min-height",t.toString()+"px").height(t)}var n=jQuery(e);0===n.length&&errorHandler.msg("error",new Error("container not found"),!0,{container:n});var i,o=this,r=new Handler.Template("conversation").append(new Handler.Template);n.html(r.render("conversation"));var a,s=n.find(".selectedConversationContainer"),l=new View.Conversation.ConversationList(n.find(".conversationList")),c={};return l.on("selectedConversationChanged",function(e,n){if(i&&(clearTimeout(i),i=null),!c[n.id]){var o=jQuery("<div>");c[n.id]=new View.Conversation.ConversationChat(o,n),s.append(o),t()}null!=a&&a.hide(),a=c[n.id],a.show(),l.getSelectedConversation().hasUnreadMessages()&&(i=setTimeout(function(){l.getSelectedConversation().resetHasUnreadMessages(),a.updateLastReadMessageTimestamp(),notificationHandler.triggerNotificationDeleted("messageReceived",l.getSelectedConversation().data.users[0].uuid)},1e3))}),l.on("removedItem",function(e,t){null!=a&&a.getId()===t.id&&(a=null),c[t.id]&&(c[t.id].remove(),delete c[t.id])}),jQuery(window).resize(t),o},"undefined"==typeof View&&(View={}),"undefined"==typeof View.Conversation&&(View.Conversation={}),View.Conversation.ConversationChat=function(e,n){function i(e){var t,n=F.length;for(t=0;n>t;t++){var i=F[t];if(i.data.id===e)return i.msg.remove(),void F.splice(t,1)}return y}function o(){var e=jQuery(this).closest("[msg-id]").attr("msg-id");if(e){var o,r,a;for(a=F.length,r=0;a>r;r++)F[r].data.id===e&&(o=F[r].data);if(o){var s=o.content,l=Handler.Template.escape(s.substr(0,100));s.length>100&&(l+="..."),Dialog.confirmation(t('Delete message "{{message}}"?',{"{{message}}":l}),function(){conversationHandler.deleteMessage(n.id,o.id,o.timestamp,function(){i(o.id)})})}}}function r(e){if(F.length&&x===m&&k.chatBox.scrollTop()<150){k.loader.show(),x=v;var t=F[0].data;conversationHandler.getPreviousMessages(n.id,t.id,t.timestamp,function(e){k.loader.hide();for(var t=(k.chatBox.prop("scrollHeight"),e.length),n=0;t>n;n++)l(e[n],!0);x=0===t?g:m})}}function a(){var e=k.editor.editor("text").trim();e.length&&(k.editor.editor("reset"),1!==n.type||n.users.length?conversationHandler.sendMessage(n.id,e,void 0,s):conversationHandler.sendPrivateMessage(n.deletedFrom[0].uuid,e,void 0)),k.editor.focus()}function s(e){}function l(e,t){blockedUserHandler.isBlocked(e.user.uuid)||c(e,t)}function c(e,t){var n=F.length,i=null;if(n)if(t)i=F[0];else{var o=n-1;for(i=F[o];o>=0&&!i.msg.hasClass("chatBoxEntry");)o--,i=F[o]}var r=(null!==i&&i.data.user?i.data.user.uuid:"",e.content.split("\n").map(function(e){return e.trim()}).filter(function(e){return e.length>0}).map(function(e){return{line:e}})),a=jQuery(C.render("message",{uuid:e.user.uuid,user:e.user.nick,permalink:e.user.permalink,title:e.user.title,profileImage:e.user.profileImageUrl,nick:e.user.nick,messageId:e.id,gameUuid:e.context&&e.context.gameUuid,message:C.render("messageContent",{lines:r}),placeOnRightSide:e.user.uuid===config.user().uuid})).expandEmoticons().expandLinks();if(t?(k.messages.prepend(a),F.unshift({data:e,msg:a})):(k.messages.append(a),F.push({data:e,msg:a})),a.find(".messageTime").showAge(e.timestamp),""!==e.user.uuid){var s=a.find(".messageUser > a");s.length&&(s.data("uuid",e.user.uuid),s.addMiniprofile())}return a}function d(){b&&F.length>0&&conversationHandler.setLastReadMessageTimestamp(n.id,F[F.length-1].data.timestamp)}function u(e){var t=k.chatBox.scrollTop()>0&&k.chatBox.prop("scrollHeight")-k.chatBox.scrollTop()-k.chatBox.outerHeight()<100;return l(e),(t||e.user.uuid===config.user().uuid)&&(p=k.chatBox.prop("scrollHeight"),k.chatBox.scrollTop(p)),d(),y}function h(){w.find(".conversationInput").addClass("closedConversation")}var p,f=1e5,g=0,m=1,v=2,y=this,w=jQuery(e),b=!1;0===w.length&&errorHandler.msg("error",new Error("container not found"),!0,{container:w});var C=new Handler.Template("conversation");w.html(C.render("chat"));var k={chatBox:w.find(".conversationMessagesContainer"),inputContainer:w.find(".inputContainer"),messages:w.find(".conversationMessages"),btnSendMessage:w.find(".btnSendMessage"),loader:w.find(".messages-scroll-loader"),editor:w.find(".editor.conversation"),chatToolbar:w.find(".chatToolbar")};k.editor.editor({language:config.language(),height:80,maxLength:f,hideToolbar:!0,extensions:["emoticons"],toolbar:{left:[],right:[]},extensionConfig:{emoticons:{dialogContainer:k.inputContainer.find(".btnChatExtension .cTooltipBoxContainer")}},watermark:k.inputContainer.attr("placeholder"),dialogConfig:{emoticons:{showAsPopup:!0}}});k.btnSendMessage.on("click",a),k.messages.on("click",".btnDeleteMessage",o),k.editor.on("keydown",function(e){switch(e.keyCode){case 13:e.shiftKey||(a(),e.preventDefault())}}).on("keyup change",function(e){k.editor.editor("isEmpty")?(k.btnSendMessage.addClass("disabled"),k.btnSendMessage.attr("disabled","disabled")):(k.btnSendMessage.removeClass("disabled"),k.btnSendMessage.removeAttr("disabled")),k.editor.prop("scrollHeight")>k.editor.outerHeight()?k.chatToolbar.css("margin-right","13px"):k.chatToolbar.css("margin-right","0")});var F=[];conversationHandler.on("newMessage."+n.id,function(e,t){u(t.message)}),conversationHandler.conversationListHandler.on("user-left."+n.id,function(e,t){h()}),function(){function e(e){if(k.loader.hide(),t=g,!i&&(i=!0,e.messages)){for(var n=e.messages.length,o=n-1;o>=0;o--)l(e.messages[o]);p=k.chatBox.prop("scrollHeight"),k.chatBox.scrollTop(p),n>0&&(t=m)}}var t,i=!1;k.chatBox.on("scroll",r),setTimeout(function(){k.loader.show(),t=v,conversationHandler.enterConversation(n.id,e)},0),Array.isArray(n.deletedFrom)&&n.deletedFrom.length&&h()}();var x=m;y.getContainer=function(){return w},y.hide=function(){p=k.chatBox.scrollTop(),w.hide(),b=!1},y.show=function(){w.show(),b=!0,k.chatBox.scrollTop(p),layout.tabs(e)},y.getId=function(){return n.id},y.remove=function(){w.remove()},y.updateLastReadMessageTimestamp=d},"undefined"==typeof View&&(View={}),"undefined"==typeof View.Conversation&&(View.Conversation={}),View.Conversation.ConversationList=function(e){function t(){return p}function n(e){p&&e&&p.data.id===e.data.id||(p&&(p.resetIsSelected(),h&&conversationHandler.unblockMessagesNotificationsForConversation(p.getId())),p=e,p&&(p.setIsSelected(),h&&conversationHandler.blockMessagesNotificationsForConversation(p.getId()),d.emit("selectedConversationChanged",e.data)))}function i(e){for(var t=window.location.search.substring(1).split("&"),n=0;n<t.length;n++){var i=t[n].split("=");if(i[0]==e)return i[1]}return null}function o(){f||(f=!0,conversationHandler.conversationListHandler.getConversations()&&r(conversationHandler.conversationListHandler.getConversations()))}function r(e){g=[],u.empty(),e.forEach(function(e){c(e)}),g.length?a():jQuery(".conversationNoMessages").show()}function a(){var e=i("conversationId");if(e){for(var t=0;t<g.length;t++)if(g[t].getId()===e)return void n(g[t]);n(g[0])}else n(g[0])}function s(e){return e=new View.Conversation.ConversationListItem(e),e.$item.on("click",function(){n(e)}),e}function l(e){e=s(e),u.prepend(e.$item),g.unshift(e),e.setLastReadMessageTimestamp()}function c(e){e=s(e),e.$item.on("click",function(){n(e)}),u.append(e.$item),g.push(e),e.setLastReadMessageTimestamp()}var d=Extend.Publisher(this),u=jQuery(e);0===u.length&&errorHandler.msg("error",new Error("container not found"),!0,{container:u});var h,p,f=!1,g=[],m=conversationHandler.conversationListHandler;return function(){m.on("conversationListChanged",function(e,t){f&&r(t)}),m.on("movedItemToStart",function(e,t){if(t>0){var n=g[t];u.prepend(n.$item),g.splice(t,1),g.unshift(n)}}),m.on("newItem",function(e,t){var i=t.index,o=t.converesation;0==i?(l(o),g[0].setHasUnreadMessages()):(c(o),g[g.length-1]||g[g.length-1].setHasUnreadMessages()),p||(jQuery(".conversationNoMessages").hide(),n(g[0]))}),m.on("updateConversation",function(e,t){var n=t.index,i=t.message,o=t.timestamp,r=g[n],a=r.$item.find(".conversationTeaserText");t.isOwnMessage?a.find("span:nth-child(1)").show():a.find("span:nth-child(1)").hide(),a.find("span:nth-child(2)").text(i).expandEmoticons(),r.$item.find(".conversationLastUpdate").showAge(o,!0),p.getId()!==r.getId()&&g[n].setHasUnreadMessages()}),m.on("removedItem",function(e,t){var i=t.index,o=g[i];o.$item.remove(),g.splice(i,1),p.getId()==o.getId()&&(0===g.length?(n(null),jQuery(".conversationNoMessages").show()):n(i>0?g[i-1]:g[i])),d.emit("removedItem",o.data)});var e=jQuery(".userProfileTabs");e.find("#tabMessages").on("chess24:show",function(e){h=!0,p&&conversationHandler.blockMessagesNotificationsForConversation(p.getId()),f||o()}).on("chess24:hide",function(e){h=!1,p&&conversationHandler.unblockMessagesNotificationsForConversation(p.getId())}),"tabMessages"==e.find(".current a").attr("data-tab-content-id")&&(h=!0,o())}(),d.getSelectedConversation=t,d.setSelectedConversation=n,d},"undefined"==typeof View&&(View={}),"undefined"==typeof View.Conversation&&(View.Conversation={}),View.Conversation.ConversationListItem=function(e){function t(e){switch(e.type){case 1:n(e);break;default:errorHandler.warning("unhandled conversation type: "+e.type)}}function n(e){var t=e.users.length>0,n=t?e.users[0]:e.deletedFrom[0];i=jQuery(s.render("conversationListItem",{titleImageUrl:n.profileImageUrl,nick:n.nick,uuid:n.uuid,attributes:n.attributes,permalink:n.permalink,teaserText:e.lastMessage,isOwnMessage:e.lastMessageFrom===config.user().uuid,isClosed:t})).expandEmoticons(),new View.Online(i,n.isOnline,n.uuid).link(notificationHandler),e.lastReadMessageTimestamp<e.lastMessageTimestamp&&a.setHasUnreadMessages();var o=i.find(".conversationUser > a");o.length&&(o.data("uuid",n.uuid),o.addMiniprofile()),i.hover(function(){i.find(".buttons").show()},function(){i.find(".buttons").hide()})}var i,o=902,r=999,a=this,s=new Handler.Template("conversation"),l=!1,c=!1;return conversationHandler.conversationListHandler.on("user-left."+e.id,function(t,n){for(var o=0;o<e.users.length;o++)if(e.users[o].uuid===n){e.deletedFrom.push(e.users.splice(o,1)[0]);break}i.find(".conversationLastUpdate").addClass("closedConversation"),i.find(".userPic").addClass("closedConversation"),i.find(".conversationUser").addClass("closedConversation"),i.find(".conversationTeaserText").addClass("closedConversation"),$buttons=i.find(".buttons"),$buttons.addClass("visible"),$buttons.find(".btnDeleteConversation").removeClass("cIconClose").addClass("cIconDeleteConversation")}),a.setIsSelected=function(){i.addClass("selected"),c=!0},a.resetIsSelected=function(){i.removeClass("selected"),c=!1},a.setHasUnreadMessages=function(){i.addClass("hasNewMessages"),l=!0},a.resetHasUnreadMessages=function(){i.removeClass("hasNewMessages"),l=!1},a.setLastReadMessageTimestamp=function(){i.find(".conversationLastUpdate").showAge(e.lastMessageTimestamp,!0)},a.hasUnreadMessages=function(){return l},a.getId=function(){return e.id},function(){t(e),a.data=e,a.$item=i,i.find(".btnDeleteConversation").on("click",function(){Dialog.confirmation(window.t("Would you like to delete the conversation?"),function(){conversationHandler.deleteConversation(e.id,function(e){if(e.error){var t=window.t("Failed to delete conversation")+":<br>";switch(e.error.code){case o:t+=window.t("Conversation not found");break;case r:t+=window.t("Internal server error")}Dialog.alert(t)}})})})}(),a},"undefined"==typeof View&&(View={}),View.Cursor=function(e,t,n,i,o){function r(e,n){return function(){if(!F[0])return!1;var i=F[0].getCurrentGameKey();return g[i]?!1:t||!n?void jQuery(document).trigger(e,i):void F.forEach(function(e){n(e,i)})}}function a(){i&&k.addClass("styleFlexi");var e="cursor";o&&(e+="Broadcast"+$embedCCTSuffix),k.html(C.render(e,{live:!!i,flip:!!n})),i&&(v.live=k.find(".current"),u=v.live.children("span"),h=v.live.find(".notiBox")),o&&!$embedCCT&&(p=k.find(".notification >"),p.hide()),"function"==typeof n&&k.find(".rotate").on(w,n);var t=k.find(".start");v.start=t.on(w,r("chess24:firstmove",function(e,t){m[t]&&m[t].start?e.gotoId(t,m[t].start):e.gotoStart()}));var a=k.find(".prev");v.prev=a.on(w,r("chess24:previousmove",function(e,t){(!m[t]||m[t]&&(void 0===m[t].start||e.getCurrentPosition().knotId>m[t].start))&&e.gotoParentPosition()}));var s=k.find(".next");v.next=s.on(w,r("chess24:nextmove",function(e,t){(!m[t]||m[t]&&(void 0===m[t].end||e.getCurrentPosition().knotId<m[t].end))&&e.gotoNextPosition(!0)}));var l=k.find(".last, .last-rotate");v.last=l.on(w,r("chess24:lastmove",function(e,t){m[t]&&m[t].end?e.gotoId(t,m[t].end):e.gotoEndOfLine(!0)})),v.tprev=k.find(".textPrev"),v.tnext=k.find(".textNext")}function s(e,t,n){clearTimeout(d);var i=Date.getSplitedTime(t-n);delete i.milliseconds;var o=k;$embedCCT&&(o=k.find(".current"),v.start.add(v.prev).add(v.last).add(v.next).addClass("disabled")),k.find(".time").length||(o.html(C.render("cursorBroadcastTime",{})),Object.keys(i).forEach(function(e){y[e]=k.find("."+e)})),Object.keys(i).forEach(function(e){var t=1===i[e].toString().length;if(t){switch(e){case"days":t=i.days;break;case"hours":t=i.hours||i.days}t&&(i[e]="0"+i[e])}i[e]?(("days"===e||"hours"===e)&&(i[e]+=":"),y[e].text(i[e])):y[e].empty()}),d=setTimeout(function(){l(e)},1e3-n%1e3)}function l(e){function n(){var e=y.moveRight===Chess.colors.black.letter?y.moveCounter:y.moveCounter-1,t=y.getSan(),n=t?e+(y.moveRight===Chess.colors.white.letter?"... ":". ")+t:"";u.html(n)}function i(n){n.on(w,function(){t?jQuery(document).trigger("chess24:golive",r):e.publisher.setCurrentPosition(e.publisher.getEndOfMainlinePosition(!0))})}var r;if(F[0]&&!g[r=e.publisher.getCurrentGameKey()]){if(o){var l=e.publisher.currentKey,c=e.publisher.games[l].gameStartedAt,d=e.publisher.games[l].getGameStatus().status,f=Controller.Broadcast.offsetCorrectedDateNow();if("upcoming"===d&&c>f)return void s(e,c,f);k.find('[data-live="Live"]').length||a()}var m=e.publisher.getEndOfMainlinePosition(!0),y=e.publisher.getCurrentPosition();v.live.off(w);var C=m.knotId<=y.knotId,x=C||e.publisher.isOver();0===y.knotId?v.start.add(v.prev).addClass("disabled"):v.start.add(v.prev).removeClass("disabled"),C?v.last.add(v.next).addClass("disabled"):v.last.add(v.next).removeClass("disabled"),$redesign?(n(),x?p.hide():(p.show(),i(p))):x?(n(),b=0,v.live.removeClass("liveGrey liveBlue")):(i(v.live),u.html(u.data("live")),b?(v.live.removeClass("liveGrey").addClass("liveBlue"),h.html(b)):v.live.removeClass("liveBlue").addClass("liveGrey"))}}function c(e,t){t.isNullMove()||b++}var d,u,h,p,f=this,g={},m={},v={},y={},w="click.cursor",b=0,C=new Handler.Template("playZone"),k=jQuery(e);k.length||errorHandler.error(new Error("container not found in View.Cursor"));var F=[];Extend.Subscriber(f,i?{currentGameChanged:l,gameStatusChanged:l,"movedPositionPointer.current":l,"movedPositionPointer.endOfMainline":l,"move.mainline.add":c}:{},{afterLink:function(e){F.push(e.publisher),i&&l(e)},afterUnlink:function(e){F.removeByValue(e.publisher)}}),f.switchEventBased=function(e){return t=e,f},f.isEventBased=function(){return!!t},f.addEventButtons=function(){return v.tprev.show().on(w,r("chess24:previouslink")),v.tnext.show().on(w,r("chess24:nextlink")),f},f.deactivate=function(){if(!F[0])return f;var e=F[0].getCurrentGameKey();return g[e]=!0,jQuery(document).trigger("chess24:suspendmoves",e),f},f.activate=function(){if(!F[0])return f;var e=F[0].getCurrentGameKey();return g[e]=!1,jQuery(document).trigger("chess24:resumemoves",e),f},f.setRange=function(e,t,n){return m[e]={start:t,end:n},f},f.takeOverEvents=function(e){f.eventTarget=!!e,f[e?"setupEvents":"unsetEvents"]()},f.setupEvents=function(){return f.unsetEvents(),jQuery(document).on("chess24:nextmove",x.next).on("chess24:previousmove",x.prev).on("chess24:firstmove",x.first).on("chess24:lastmove",x.last),f},f.unsetEvents=function(){return jQuery(document).off("chess24:nextmove",x.next).off("chess24:previousmove",x.prev).off("chess24:firstmove",x.first).off("chess24:lastmove",x.last),f},a();var x=Object.map(v,function(e,n){return function(){t||v[n].trigger(w)}});return f},"undefined"==typeof View&&(View={}),View.Disconnected=function(e){function n(e,n){var i,o=n.timeout||2e4,r=n.win||!1,d=n.itsMe||!1;return d===!0?(c.html(t("You disconnected")),i="loose"):(l.addClass("blue"),c.html(t("Opponent disconnected")),i="win"),r===!0?u.html(t("seconds to "+i)):u.html(t("seconds to abort")),l.addClass("active"),jQuery("#disconnectTimeout").html(Math.max(0,o/1e3).toString()),a=setInterval(function(){o-=1e3,jQuery("#disconnectTimeout").html(Math.max(0,o/1e3).toString()),0>=o&&clearInterval(a)},1e3),s}function i(e){var n=e.itsMe||!1,i="";i=n===!0?t("You reconnected"):t("Your opponent reconnected"),r(i)}function o(e){var t=e.publisher;return t.getGameStatus().result!==t.getListOfGameResults().OPEN&&r(),s}function r(e){var t=void 0===e?0:3e3;return e=e||"",clearInterval(a),setTimeout(function(){c.html(e),d.html(""),u.html(""),l.removeClass("active blue")},t),s}var a,s=this,l=jQuery(e);0===l.length&&errorHandler.msg("error",new Error("container not found"),!0,{container:l}),Extend.Subscriber(s,{playerDisconnected:n,playerReconnected:i,selfDisconnected:n,selfReconnected:i,gameStatusChanged:o,abortOrResign:r,currentGameChanged:r});var c=jQuery("<span/>").attr("id","disconnectedPrefix"),d=jQuery("<div/>").addClass("digiTime").attr("id","disconnectTimeout"),u=jQuery("<span/>").attr("id","disconnectedSuffix");return l.append(c).append(d).append(u),s},"undefined"==typeof View&&(View={}),View.DrawButton=function(e,n){function i(t){var i=t.publisher;return n()!==i.getCurrentPosition().moveRight&&(u=!0),e.addClass("open"),h.off("click.drawOffer"),e.removeClass("active"),p.on("click.acceptDraw",function(){s(i)}),f.on("click.declineDraw",function(){l(i)}),c}function o(t){return e.removeClass("open active"),p.off("click.acceptDraw"),f.off("click.declineDraw"),r(t),c}function r(t,n){var i=t.publisher;return i.getDepth()<3||i.isOver()?(e.removeClass("active"),h.off("click.drawOffer")):u||(e.addClass("active"),e.removeClass("open"),h.off("click.drawOffer").on("click.drawOffer",function(){a(i)})),colorThatOfferedDraw=void 0,c}function a(t){n()===t.getCurrentPosition().moveRight&&(u=!0),e.removeClass("active"),t.emit("drawOffer")}function s(t){e.removeClass("open"),t.emit("acceptDraw")}function l(t){h.off("click.drawOffer").on("click.drawOffer",function(){a(t)}),e.removeClass("open")}var c=this,d=new Handler.Template("playZone");e=jQuery(e),0===e.length&&errorHandler.msg("error",new Error("container not found"),!0,{container:e});var u=!1;Extend.Subscriber(c,{drawOffered:i,"movedPositionPointer.endOfMainline":function(e){r(e),u=!1},gameStatusChanged:r,currentGameChanged:o},{afterLink:function(e){r(e)}}),e.html(d.render("drawButton"));var h=e.find(".offer"),p=e.find(".accept"),f=e.find(".decline");return h.html(t("Draw")),p.html(t("Accept")),f.html(t("Decline")),c},"undefined"==typeof View&&(View={}),View.EloChange=function(e,t){function n(e){switch(e){case"w":case"white":case"White":t="w",a="White",r="white";break;case"b":case"black":case"Black":t="b",a="Black",r="black"}}function i(e,t){o(e,{meta:t.getMeta()})}function o(t,n){var n=n.meta[a][c];e.removeClass("white black").addClass(r).removeClass(d),void 0!==n?e.addClass(d="dif"+n).html(Math.abs(n)):e.empty()}var r,a,s,l=this,c="EloChange",d="";e=jQuery(e),e.length||errorHandler.error(new Error("container not found in View.EloChange"),{container:e}),Extend.Suspendable(l);var u=l.delegate(o);return Extend.Subscriber(l,{currentGameChanged:l.delegate(i),meta:u,flipBoard:function(e){"b"===t?n("w"):"w"===t&&n("b"),u(e,{meta:e.publisher.getMeta()})}},{afterLink:function(e){s=e.publisher,u(e,{meta:e.publisher.getMeta()})}}),l.onResume(function(e){e&&s&&o({publisher:s},{meta:s.getMeta()})}),n(t),l},"undefined"==typeof View&&(View={}),View.EngineDiagram=function(e){function t(){u=!0,e.slideDown()}function n(){u=!1,e.slideUp()}function i(t,n){return clearTimeout(l),l=setTimeout(function(){for(var n=t.publisher.getStartPosition(),o=[];n=n.getChildrenMoveById(0);){c.contains(n.getEngineFen())||(Handler.engine.on(n.getEngineFen()+":numerical",function(){i(t)}),c.push(n.getEngineFen()));var r=n.getEngine("numerical",!0,!1);if(r&&r.score)isNaN(r.score)||(d.min=Math.max(Math.min(r.score,d.min),-400),d.max=Math.min(Math.max(r.score,d.max),400)),o.push(r.score);else if(r&&void 0!==r.mate)if(0===r.mate){var a="w"==n.moveRight;o.push("#"+(a?"-":"")+"0")}else o.push("#"+r.mate);else o.push(0)}for(var l=0;l<o.length;l++)isNaN(o[l])?"#"===o[l].substr(0,1)&&("-"===o[l].substr(1,1)?o[l]=d.min/100:o[l]=d.max/100):(o[l]>d.max&&(o[l]=d.max),o[l]<d.min&&(o[l]=d.min),o[l]=o[l]/100);for(var l=0;l<o.length;l++)"#"!=(""+o[l]).substr(0,1)&&(o[l]=o[l].toFixed(2));e.barChart(o),s=o},0),r}function o(){s&&setTimeout(function(){e.barChart(s)})}var r=this;e=jQuery(e);var a,s,l,c=[],d={min:-400,max:400},u=window.settings.getBoolean("game-broadcast-engine");Extend.Suspendable(r);var h=r.delegate(i);return Extend.Subscriber(r,{currentGameChanged:h,move:h},{afterLink:function(i){a=i.publisher,h(i);var o=jQuery("<a/>").addClass("barChartMarker cTooltipBox").appendTo("body"),r=jQuery("<span/>").addClass("cTooltipBoxContainer").appendTo(o);e.on("chartover",function(e,t){for(var n=i.publisher.getStartPosition(),a=-1;a<t.index;a++)n=n.getChildrenMoveById(0);var s=t.bar.offset(),l=n.getEngine("numerical",!0,!1);if(l){var c=Handler.engine.formatEngine(l.score);r.html("<h2>"+("w"===n.moveRight?n.moveCounter-1:n.moveCounter)+("w"===n.moveRight?". ... ":". ")+n.getSan()+"<br/>"+c+"</h2>"),o.css({left:s.left+"px",top:s.top+"px",width:t.bar.outerWidth(),height:t.bar.outerHeight()}),c>=0?o.removeClass("position-top").addClass("position-bottom"):o.removeClass("position-bottom").addClass("position-top"),o.off("click").on("click",function(){i.publisher.setCurrentPosition(n)})}}),u?t():n()}}),r.onResume(function(e){u?t():n(),e&&a&&i({publisher:a})}),window.settings.on("settings.game-broadcast-engine.on",t),window.settings.on("settings.game-broadcast-engine.off",n),window.settings.on("settings.play-board-xl",o),r},"undefined"==typeof View&&(View={}),View.EngineGroup=function(e,t){var n=this,i=new Handler.Template("broadcast");e=jQuery(e),t=t||[];var o=[];return 0===e.length&&errorHandler.msg("error",new Error("container not found"),!0,{container:e}),e.html(i.render("game.engine"+$embedCCTSuffix)),t.contains("Engine")?e.find(".engineLines").remove():o.push(new View.Engine(e.find(".engineLines"))),o.push(new View.OutcomePrediction(e.find(".tabEnginePredictionView"))),o.push(new View.EngineDiagram(e.find(".tabEngineDiagrammView"))),o.push(new View.CapturedPieces(e.find(".tabEngineMaterialBalanceView").find(".upper"),["b"],!0)),o.push(new View.CapturedPieces(e.find(".tabEngineMaterialBalanceView").find(".lower"),["w"],!0)),o.push(new View.FenView(e.find(".tabEngineFenView"))),Extend.Subscriber(n,{},{afterLink:function(e){for(var t=0;t<o.length;t++)o[t].link(e.publisher)},afterUnlink:function(e){for(var t=0;t<o.length;t++)o[t].unlink(e.publisher)}}),Extend.Suspendable(n),n.onSuspend(function(){o.forEach(function(e){e.suspend()})}),n.onResume(function(){o.forEach(function(e){e.resume()})}),n};var View=View||{};!function(){View.EngineToggle=function(e){function t(){return a.on("click",o),s?n():i(),r}function n(){a.removeClass("off").addClass("on");
}function i(){a.removeClass("on").addClass("off")}function o(){var e=window.settings.getBoolean("game-broadcast-engine");window.settings.set("game-broadcast-engine",e?0:1)}var r=this,a=jQuery(e),s=window.settings.getBoolean("game-broadcast-engine");return $redesign&&s&&e.trigger("click"),window.settings.on("settings.game-broadcast-engine.on",n),window.settings.on("settings.game-broadcast-engine.off",i),t()}}(),"undefined"==typeof View&&(View={}),View.Engine=function(e){function t(){return Handler.engine.formatEngine(this.score,this.mate)}function n(){e.slideDown()}function i(){e.slideUp()}function o(){v="w"==v?"b":"w"}function r(e){e.find(".linkRegister").on("click.engineConversion",function(){return Dialog.conversionRegister(f),!1}),e.find(".linkPremium").on("click.engineConversion",function(){return Dialog.conversionGoPremium(f),!1}),e.find(".linkSettings").on("click",function(){return(new Dialog.PlayzoneSettings).getContent().modal("show"),!1})}function a(n){for(u();n.evaluations.length<3;)n.evaluations.push({});n.score=n.evaluations[0].score,n.mate=n.evaluations[0].mate,n.source&&(n.sourceSwitch={},n.sourceSwitch[n.source]=!0),n.formatScore=t,n.showRegisterConversion=x,n.showPremiumConversion=T,n.isPremium=F.isPremium,n.showInfo=void 0!==n.depth,n.settingsPhrase=!n.source&&!window.settings.getBoolean("game-broadcast-engine-local"),n.phrase=Controller.Broadcast.getPhraseForEvaluation(n.score,n.mate);var i=jQuery(m.render(window.settings.getBoolean(g)?"collapsed"+$embedCCTSuffix:"main"+$suffix,n));return r(i),i.find(".toggleCollapseExpand").on("click",function(){window.settings.set(g,+!window.settings.getBoolean(g))}),e.empty().append(i),i.find(".engine")}function s(e,t){l(e,t.getCurrentPosition())}function l(e,t){clearTimeout(_),_=setTimeout(function(){c(e,t)})}function c(e,t){y&&Handler.engine.off(y+":detailed",d),y=t.getEngineFen(),w=t,Handler.engine.on(y+":detailed",d),Handler.localEngine.newTask(y),d(e,Handler.engine.get(t,"detailed"))}function d(e,t){if(!(t&&t.depth<4)){!k&&Handler.engine.isLocalEvaluation(t)?t=C:t&&t.evaluations&&w.nextMoveIsBlack()&&Handler.engine.shouldInvert(w,t.evaluations[0])&&(t=Handler.engine.invert(t));var n=a(Object.merge(C,t));if(t&&t.evaluations)for(var i=new Chess.Position({fen:w.toString(),validators:[{moveValidator:Chess.Game.validators.freeMove}]}),o=Math.min(t.evaluations.length,n.length),r=0;o>r;r++)if(t.evaluations[r].moves){var s=t.evaluations[r].moves,l=[],c=i,d=[];"b"===i.moveRight&&d.push(i.moveCounter+". ... ");for(var f=0;f<s.length;f++)try{var g=Chess.translate.canToMove(s[f]);c=c.move({move:g,dontCheckForInsufficentMaterial:!0}),l.push(c.getSan());var m="w"===i.moveRight?0:1;f%2===m&&d.push((f+m)/2+i.moveCounter+". ");var v=jQuery("<a/>").html(l[f]).on("click",function(e,t){return function(){u();for(var n=0;n<e.length;n++){b.move(e[n],i,void 0,void 0,"local");var i=b.getLastAddedPosition();if(n===t)var o=i}b.setCurrentPosition(o)}}(s,f));d.push(v),f!==s.length-1&&d.push(" "),h(v,c)}catch(y){errorHandler.warning(new Error("parsing moves for engineView failed"),{lineAsCan:s,lineAsSan:l,move:s[f],position:c.toString()})}jQuery(n[r]).children(".engineLine").append(d)}return p}}function u(e){var t=jQuery(".chessBoardViewBubbleContainer");t.find(".chess-board").length||!e?t.bubble("hide"):setTimeout(u,10)}function h(e,t){return e.on("mouseenter",function(){j=j||jQuery('<div class="chessBoardViewBubbleContainer" />'),j.addClass("noInfo"),jQuery(".bubble").remove(),j.bubble({align:e,side:"bottom",point:"precise",offset_y:-10,offset_x:-document.body.getBoundingClientRect().x,noanimation:!0}),E||(E=(new Chess.Game).setNoTimeout(!0)),E.setCurrentPosition(t),S||(S=new View.ChessBoard(j,!1),S.link(E)),"b"==v!=S.isFlipped()&&S.flip(),j.bubble("show")}).on("mouseleave",function(){u(!0)}),p}var p=this,f="engine",g="engine-lines-collapsed";e=jQuery(e);var m=new Handler.Template("engine"),v="w";window.settings.getBoolean("game-broadcast-engine")||e.hide();var y,w,b,C={evaluations:[]},k=window.settings.getBoolean("game-broadcast-engine-local"),F=config.level(),x=F.isGuest,T=!x&&!F.isPremium;Extend.Suspendable(p),Extend.Subscriber(p,{currentGameChanged:p.delegate(s),"movedPositionPointer.current":p.delegate(l),flipBoard:o},{afterLink:p.delegate(function(e){b=e.publisher,l(e,e.publisher.getCurrentPosition())})}),window.settings.on("settings.game-broadcast-engine.on",n),window.settings.on("settings.game-broadcast-engine.off",i),window.settings.on("settings.game-broadcast-engine-local",function(e,t){k=!!t.value,b&&l({publisher:b},b.getCurrentPosition())}),window.settings.on("settings."+g,function(){b&&l({publisher:b},b.getCurrentPosition())}),p.onResume(function(e){e&&b&&l({publisher:b},b.getCurrentPosition())});var _,E,S,j},"undefined"==typeof View&&(View={}),View.FenView=function(e){function t(){clearTimeout(d),s.addClass("fixed").show(),d=setTimeout(function(){s.removeClass("fixed").hide()},2e3)}function n(e){!a.data(l)&&a.is(":visible")&&a.off("click").on("click",function(){t(),Handler.KeyboardDispatcher.copy(r.html())}),r.html(e.publisher.toString())}var i,o=this;e=jQuery(e);var r=e.find(".fen"),a=e.find("a.cBtnWhite"),s=a.children("span"),l="clipboardApplied";r.length&&a.length||errorHandler.error("container not found in View.FenView"),Extend.Suspendable(o);var c=o.delegate(n);Extend.Subscriber(o,{currentGameChanged:c,"movedPositionPointer.current":c},{afterLink:function(e){i=e,c(e)}}),o.onResume(function(e){e&&i&&n(i)});var d;return o},"undefined"==typeof View&&(View={}),View.FirstMoveTimeout=function(e){function t(e){if(e.publisher.getGameStatus().endedBy)return void n();var t=e.publisher.getMeta();if(!t.TournamentUUID)return void n();var o={w:2,b:3},r=l.getAttribute(t.TournamentUUID,"fen"),a=l.getAttribute(t.TournamentUUID,"forfeit_time")/1e3||60;if(r){var s=r.split(" ");s.length>0&&"b"==s[1]&&(o={w:3,b:2})}if([t.White.UUID,t.Black.UUID].contains(config.user().uuid)){var c=t.White.UUID===config.user().uuid?"w":"b";if(e.publisher.getMoveRight()===c)if(e.publisher.getDepth()>=o[c])n();else{if("w"===c)var d=a-Math.round((Controller.Broadcast.offsetCorrectedDateNow()-t.CreatedAt)/1e3);else d=a-Math.round((Controller.Broadcast.offsetCorrectedDateNow()-t.CreatedAt-e.publisher.getCurrentPosition().timeUsage)/1e3);i(d)}else n()}else n()}function n(){clearTimeout(a),a=setTimeout(function(){d.hide("slide",c)}),clearTimeout(o.timer)}function i(e){clearTimeout(a),a=setTimeout(function(){d.show("slide",c)}),o(e)}function o(e){u.html(e),e--,clearTimeout(o.timer),o.timer=setTimeout(function(){u.html(e),e>0?o(e):n()},1e3)}var r,a,s=this,l=new Controller.BroadcastTournament,c={direction:"left"},d=jQuery(e),u=d.find(".digiTime");return 0===d.length&&errorHandler.msg("error",new Error("container not found"),!0,{container:d}),Extend.Subscriber(s,{"movedPositionPointer.current":t,gameStatusChanged:t,currentGameChanged:t},{afterLink:function(e){r=e.publisher,t(e)}}),s},"undefined"==typeof View&&(View={}),View.FlipBoard=function(e){var t=this;return e=jQuery(e),0===e.length&&errorHandler.error(new Error("container not found in View.FlipBoard"),{container:e}),Extend.Subscriber(t,{},{afterLink:function(t){e.on("click.flipBoard",function(){t.publisher.emit("flipBoard")})},afterUnlink:function(){e.off("click.flipBoard")}}),t},"undefined"==typeof View&&(View={}),View.FloatingNotation=function(e){function t(e){return g=!0,n(e),r(),s}function n(e){var t=e.publisher,n=t.getCurrentPosition().knotId;return u.find(".highlighted").removeClass("highlighted"),u.find(".moveId_"+n).addClass("highlighted"),s}function i(){var e=u.find(".highlighted"),t=e.parent();return t.index()}function o(e){var t=d-e;return f||0===t||(0>t?(f=!0,u.cycle("next")):t>0&&(f=!0,u.cycle("prev"))),s}function r(){return c=void 0,o(i()),s}function a(e){function t(e){var n=[],i=e.countChildrenMoves();if(0===i)return n;var o="",r="";if("w"===e.moveRight?o=e.moveCounter+". ":r=e.moveCounter+"... ",C&&n.push(r),e===v.getStartPosition()){var s=jQuery("<a/>");s.text(o.trim()),s.addClass("moveBlock moveId_"+e.knotId),s.on("click",function(){return v.setCurrentPosition(v.getStartPosition()),!1}),n.push(s),n.push(" ")}else n.push(o);if(n.push(a(e.getChildrenMoveById(0))),n.push(" "),C=!1,i>1)for(var l=1;i>l;l++){n.push(" "),n.push(b.openSideline),n.push(r),n.push(o),n.push(a(e.getChildrenMoveById(l))),n.push(t(e.getChildrenMoveById(l)));var c=n.last();" "===c.last()&&c.pop(),n.push(b.closeSideline),n.push(" "),C=!0}n=n.concat(t(e.getChildrenMoveById(0)));for(var l=0;l<n.length;l++)n[l]instanceof jQuery||!Array.isArray(n[l])||n.splice.apply(n,[l,1].concat(n[l]));return n}function a(e){if(void 0===e.comment)var t="";else t=e.comment;t.length>0&&(t=" {"+t+"} ");var n=jQuery("<a/>");return n.text(e.getSan()+t),n.addClass("moveBlock moveId_"+e.knotId),function(e){n.on("click",function(){return v.setCurrentPosition(e),!1})}(e),n}function l(){y=jQuery('<div class="floatingNotationSlider"></div>').appendTo(u);var e=w.push(y);if(e>1){var t=jQuery('<a class="floatingNotationPrevButton cIcon cIconArrowL" href="?prevSlider">&nbsp;&nbsp;</a>');t.on("click",function(){return u.cycle("prev"),c=void 0,g=!1,!1}),y.append(t)}var n=jQuery('<a class="floatingNotationNextButton cIcon cIconArrowR" href="?nextSlider">&nbsp;&nbsp;</a>');return n.on("click",function(){return u.cycle("next"),c=void 0,g=!1,!1}),y.append(n),y}function m(e){0==p&&(p=Math.min(100,u.outerHeight()));var t=y.children(".floatingNotationNextButton");t.before(e);var n=y.outerHeight();for(n>p&&l();n>p;)m(" "),m(t.prev()),m(" "),n=y.outerHeight();return u}var v=e.publisher;u.empty(),h.empty();var y,w;w=[],l();for(var b={openSideline:"(",closeSideline:")"},C=!0,k=t(v.getStartPosition()),F=0;F<k.length;F++)m(k[F]);return m(document.createTextNode(v.getGameStatusAsString())),y.children(".floatingNotationNextButton").remove(),n(e),w.length>1&&u.cycle({fx:"scrollHorz",timeout:0,cleartype:!1,startingSlide:i(),autostop:w.length-1,pager:h,speed:800,pagerAnchorBuilder:function(e,t){return"<li></li>"},onPagerEvent:function(e,t){return g=!1,c=e,o(e),!1},after:function(e,t,n,i){d=jQuery(t).index(),f=!1,g?r():void 0!==c&&o(c)}}),s}var s=this,l=jQuery(e);0===l.length&&errorHandler.msg("error",new Error("container not found"),!0,{container:l}),l.addClass("floatingNotation");var c,d,u=jQuery('<div class="floatingNotationSliderContainer"></div>').appendTo(l),h=jQuery('<div class="floatingNotationPagerContainer"></div>').appendTo(l),p=u.outerHeight(),f=!1,g=!0;return Extend.Subscriber(s,{currentGameChanged:a,"movedPositionPointer.current":t,move:a},{afterLink:function(e){a(e)}}),s},"undefined"==typeof View&&(View={}),View.FraudReport=function(e,t,n,i){function o(){if(c!==!0){var e=(new Helper.UUID).getShort();notificationHandler.subscribe("fraud:report:"+e).once("fraud:report:"+e,r);var o=i?"checkNewPlayzoneGame":"checkGame";jQuery.get("/api/web/fraudAPI/"+o,{gameSessionToken:n||t.getCurrentGameSessionToken(),requestId:e}),c=!0}}function r(t,n){n=a(n.content),e.html(d.render("report",n))}function a(e){return e.connectionsSplitByPlayer&&(e.connectionsSplitByPlayer=s(e.connectionsSplitByPlayer,!0)),e=Object.map(e,function(e){return s(e)}),Object.extend(e,{formatTime:function(){return Helper.getFormatedLocalDateTime(this.time,Helper.getFormatedLocalDateTimeSeperated.phrases.dateTimeSeconds)}})}function s(e,t){return"object"!=typeof e||Array.isArray(e)?e:Object.reduce(e,function(e,n,i){return e.push({key:i,item:t?s(n,t):n}),e},[])}var l=Extend.Suspendable(this,!0);e=jQuery(e),e.length||errorHandler.error("container not found in View.FraudReport");var c,d=new Handler.Template("fraud");return l.onResume(o),l.onResume(o),l},function(e){"undefined"==typeof View&&(View={});var t={},n="/api/web/UserFriendAPI";View.FriendshipButton=function(){function i(){return e(document).on("click",".friend-button",o),r}function o(){var t=e(this),n=t.data("related-user"),i=t.data("relation"),o={csrf:config.csrf(),relationType:i,relatedUser:n};r.showLoader(n),e.post(a,o).always(function(){r.hideLoader(n)})}if(t.friendshipButton instanceof View.FriendshipButton)return t.friendshipButton;var r=this,a=n+"/UpdateFriendshipRelation";return r.createLoader=function(){var t=e("<img>").attr("src",config.assetDir()+"/images/img/icon_searching_large.gif").css("display","none").addClass("friend-button-loader");return t},r.showLoader=function(t){var n=e(".friend-buttons-for-"+t);n.each(function(){var t=e(this),n=e(".friend-button-loader",t);n.length||(n=r.createLoader(),t.append(n)),n.show(),e(".friend-button",t).hide()})},r.hideLoader=function(t){var n=e(".friend-buttons-for-"+t);n.each(function(){var t=e(this);e(".friend-button-loader",t).hide(),e(".friend-button",t).show()})},t.friendshipButton=i()},View.FriendshipSidebar=function(){function n(){return Extend.Subscriber(C,{friendship:r}),C.link(notificationHandler),Handler.pageTitle.updateNotification(w.html()),C}function i(){e(".sidebarMenu .myFriends > a").data("friends-initialized")||(e(".sidebarMenu .myFriends > a").data("friends-initialized",!0),C.status=m,e(".sidebarMenu .myFriends > a").click(function(){C.status===m&&(C.status=v,w.length&&w.get(0).innerHTML>0&&e("#myfriends-sidebar-incoming-section").show(),o())}))}function o(){e.ajax({url:"/api/web/UserFriendAPI/LoadSidebar",type:"GET",dataType:"json",success:function(t){t&&0===t.status&&t.data?(C.status=y,t.data.aIncomingUsers&&t.data.aIncomingUsers.length>0?(e("#myfriends-sidebar-incoming-content").html(""),e.each(t.data.aIncomingUsers,function(t,n){var i=p(n.sProfileImgSrc,n.sNick,n.sUUID,n.aButtons,n.sLinkToProfile,n.sTitle,n.bIsOnline);e("#myfriends-sidebar-incoming-content").append(i)})):e("#myfriends-sidebar-incoming-content .contentLoader").remove(),e("#myfriends-sidebar-confirmed-content .contentLoader").remove(),t.data.aConfirmedUsers&&t.data.aConfirmedUsers.length>0?(e("#sidebar-confirmed-friends").html(""),e.each(t.data.aConfirmedUsers,function(t,n){var i=f(n.sProfileImgSrc,n.sNick,n.sUUID,n.sLinkToProfile,n.sTitle,n.bIsOnline);e("#sidebar-confirmed-friends").append(i)}),e("#sidebar-confirmed-friends").show()):e("#sidebar-confirmed-friends-empty").show(),e(document).trigger("newhtml")):C.status=m},error:function(t,n,i){C.status=m;var o=window.t("Failed to change load my friends sidebar");try{var r=e.parseJSON(t.responseText);for(var a in r.errors){o=r.errors[a][0];break}}catch(s){}errorHandler.msg("error",new Error(o),!1)}})}function r(e,t){switch(t.content.sAction){case"action_incoming_request_add":a(t.content);break;case"action_incoming_request_remove":s(t.content);break;case"action_outgoing_request_add":break;case"action_outgoing_request_remove":break;case"action_friend_add":l(t.content);break;case"action_friend_remove":c(t.content);break;case"action_blocked_add":break;case"action_blocked_remove":break;case"action_update_buttons":h(t.content)}}function a(t){if(d(),C.status==y){var n=p(t.sShownUserImageSrc,t.sShownUserName,t.sShownUserUuid,t.aButtons,t.sLinkToShownUserProfile,t.sTitle,!0);0===e("#myfriends-sidebar-incoming-content").children().length?(e("#myfriends-sidebar-incoming-content").html(n),e("#myfriends-sidebar-incoming-section").show()):e("#myfriends-sidebar-incoming-content").prepend(n),e("#myfriends-sidebar-incoming-content").trigger("newhtml")}}function s(t){u(),C.status==y&&(e("#sidebar-friend-incoming-"+t.sShownUserUuid).remove(),0===e("#myfriends-sidebar-incoming-content").children().length&&e("#myfriends-sidebar-incoming-section").hide())}function l(t){if(C.status==y){var n=f(t.sShownUserImageSrc,t.sShownUserName,t.sShownUserUuid,t.sLinkToShownUserProfile,t.sTitle,t.bIsOnline);0===e("#sidebar-confirmed-friends").children().length&&(e("#sidebar-confirmed-friends-empty").hide(),e("#sidebar-confirmed-friends").show()),e("#sidebar-confirmed-friends").prepend(n),e("#sidebar-confirmed-friends").trigger("newhtml")}}function c(t){C.status==y&&(e("#sidebar-friend-confirmed-"+t.sShownUserUuid).remove(),0===e("#sidebar-confirmed-friends").children().length&&(e("#sidebar-confirmed-friends").hide(),e("#sidebar-confirmed-friends-empty").show()))}function d(){var e=parseInt(w.html());e=e?e+1:1,w.html(e).show(),Handler.pageTitle.updateNotification(1)}function u(){var e=parseInt(w.html());e=e?e-1:0,w.html(e),e||w.hide(),Handler.pageTitle.updateNotification(-1)}function h(t){var n=e(".friend-buttons-for-"+t.sShownUserUuid);n.each(function(){var n=e(this);e(".friend-button",n).remove(),e(".friend-buttons-for-"+t.sShownUserUuid+" .friend-button-loader").hide(),e.each(t.aButtons,function(e,t){if("Block"===t.sButtonRelation&&!n.data("withblockbtn"))return!1;var i=g(t.sButtonRelation,t.sUUID,t.sButtonTitle,t.sButtonClass);n.append(i)})})}function p(t,n,i,o,r,a,s){for(var l=0;l<o.length;l++)o[l].sButtonTitle=window.t(o[l].sButtonTitle);var c=b.render("sidebarFriendIncoming",{sProfileImgSrc:t,sNick:n,sUUID:i,aButtons:o,sTitle:a,sLinkToProfile:r});return $node=e(c),new View.Online($node,s,i).link(notificationHandler),$node}function f(t,n,i,o,r,a){var s=b.render("sidebarFriendConfirmed",{sProfileImgSrc:t,sNick:n,sUUID:i,sTitle:r,sLinkToProfile:o});return $node=e(s),new View.Online($node,a,i).link(notificationHandler),$node}function g(e,t,n,i){var o=b.render("friendButton",{sUUID:t,sButtonClass:i,sButtonRelation:e,sButtonTitle:window.t(n)});return o}var m=0,v=1,y=2,w=e("#count-incoming-friends"),b=new Handler.Template("friendship");if(t.friendshipSidebar instanceof View.FriendshipSidebar)return t.friendshipSidebar;var C=this;return i(),t.friendshipSidebar=n()},View.FriendshipProfile=function(n){function i(t){return _.reInit(t),e(window).scroll(_.checkAndLoad),_}function o(){clearTimeout(g),g=setTimeout(function(){a()},b)}function r(e,t){return t!==!0&&f==F?!1:(clearTimeout(g),a(),!1)}function a(){f=F,u(),m&&(m.abort(),m=null),v&&(v.abort(),v=null),m=e.ajax({url:E,data:{permalink:p,filter:e("#profile_friend_filter").val(),sort_by:e("#profile_friend_sort_by").val(),sort_order:e("#profile_friend_sort_order").val(),lang:config.language()},type:"GET",dataType:"json",success:function(t){h(),e(T).each(function(){_.removeOnlineAndChallengeLinks(e(this))}),e(T).remove();var n=null;t&&0===t.status&&t.data&&(t.data.aFriends&&t.data.aFriends.length?(e("#profile-friends-empty-list").hide(),e("#profile-friends-list").show(),e.each(t.data.aFriends,function(t,i){var o=s(i);n?n=o.insertAfter(n):(n=o,e("#profile-friends-list").prepend(o)),_.addOnlineAndChallengeLinks(o,i)})):(e("#profile-friends-empty-list").show(),e("#profile-friends-list").hide())),f=C},error:function(t,n,i){(0!==t.readyState||0!==t.status)&&(f=C,h(),e("#profile-friends-empty-list").show(),e("#profile-friends-list").hide())}})}function s(e){var t=parseInt(e.myData.score.me,10)||parseInt(e.myData.score.him,10);return e.myData.score.me=Controller.Broadcast.scoreToString(e.myData.score.me),e.myData.score.him=Controller.Broadcast.scoreToString(e.myData.score.him),jQuery(y.render("profileFriend",{me:e.me,user:e.user,label:e.label,myData:e.myData,showScore:t},"miniProfile"))}function l(t){var n=e(window).scrollTop(),i=n+e(window).height(),o=t.offset().top;return i+w>o}function c(){e("#profile-friends-scroll-loader").show()}function d(){e("#profile-friends-scroll-loader").hide()}function u(){e("#profile-friends-sortandfilter-loader").show()}function h(){e("#profile-friends-sortandfilter-loader").hide()}if(t.friendshipProfile instanceof View.FriendshipProfile)return t.friendshipProfile.reInit(n),t.friendshipProfile;var p,f,g,m,v,y=new Handler.Template("friendship").append(new Handler.Template),w=150,b=500,C=1,k=2,F=3,x=4,T=".profile-friend",_=this,E="/api/web/UserFriendAPI/LoadMoreFriends";return _.reInit=function(t){return e("#tabFriends").on("click","#profile-friend-btn-trigger-filtration",null,r),e("#tabFriends").on("change","#profile_friend_sort_by, #profile_friend_sort_order",null,function(e){r(e,!0)}),e("#tabFriends").on("keyup","#profile_friend_filter",null,o),f=C,p=t||"",e("#tabFriends").data("friendshipProfileView",_),_},_.addOnlineAndChallengeLinks=function(e,t){t&&(t.user&&void 0!==t.user.online&&(e.data("ViewOnline",new View.Online(e,t.user.online,t.user.uuid)),e.data("ViewOnline").link(notificationHandler)),t.me||(e.data("ViewChallengeButton",new View.ChallengeButton(e.find(".challenges"),t.user.uuid,t)),e.data("ViewChallengeButton").link(notificationHandler),config.level().isGuest?e.find(".sendUserMessage").hide():e.find(".sendUserMessage").on("click",function(e){e.preventDefault(),new Dialog.UserMessage(t.user.uuid)})))},_.removeOnlineAndChallengeLinks=function(e){e.data("ViewOnline")&&e.data("ViewOnline").unlink(notificationHandler),e.data("ViewChallengeButton")&&e.data("ViewChallengeButton").unlink(notificationHandler)},_.checkAndLoad=function(){var t=e(T).last();f==C&&t.is(":visible")&&l(t)&&(f=k,c(),v=e.ajax({url:E,data:{offset:e(T).length,permalink:p,filter:e("#profile_friend_filter").val(),sort_by:e("#profile_friend_sort_by").val(),sort_order:e("#profile_friend_sort_order").val(),lang:config.language()},type:"GET",dataType:"json",success:function(n){f=C,d(),n&&0===n.status&&n.data&&(n.data.aFriends&&n.data.aFriends.length?(e.each(n.data.aFriends,function(e,n){t=s(n).insertAfter(t),_.addOnlineAndChallengeLinks(t,n)}),_.checkAndLoad()):f=x)},error:function(e,t,n){d(),(0!==e.readyState||0!==e.status)&&(f=C)}}))},t.friendshipProfile=i(n)}}(jQuery),"undefined"==typeof View&&(View={}),View.Highlight=function(e){function t(t){jQuery("."+t+":first").addClass(e).trigger("highlight"),o=t}function n(t){jQuery("."+t).removeClass(e)}function i(e){var i=e.publisher;if("function"!=typeof i.getCurrentGameKey)return r;var a=i.getCurrentGameKey()+"_"+i.getCurrentPosition().knotId;return void 0!==o&&n(o),t(a),r}var o,r=this;return e=e||"highlight",Extend.Subscriber(r,{"movedPositionPointer.current":i,currentGameChanged:i},{afterLink:function(e){i(e)}}),r},"undefined"==typeof View&&(View={}),View.initialPopup=function(e,t){function n(){var n=jQuery(o.render(e,t));n.appendTo("body");var i=n.modal({classes:"customPopup",close:!0});i.modal("show"),n.find(".initialPopupCloseBtn").on("click",function(){i.modal("hide")})}var i=this,o=new Handler.Template("initialPopup");return n(),i},"undefined"==typeof View&&(View={}),View.InlineNotation=function(e){function t(e){var t=e.publisher,i=t.getEndOfMainlinePosition(!0),a=0,s=[];for(t.isOver()&&s.unshift(" "+t.getGameStatusAsString());r>a&&i.parentMove;)a>0&&(i.lastMoveWasBlack()?s.unshift(" "+i.moveCounter+". "):s.unshift(" ")),s.unshift(n(t,i)),i=i.parentMove,a++;o.empty().append(s)}function n(e,t){var n=jQuery('<a href="?gotoId'+t.knotId+'"/>');return n.text(t.getSan()),n.addClass("moveId_"+t.knotId),function(t){n.on("click",function(){return e.setCurrentPosition(t),!1})}(t),n}var i=this,o=jQuery(e);0===o.length&&errorHandler.msg("error",new Error("container not found"),!0,{container:o}),Extend.Subscriber(i,{currentGameChanged:t,"movedPositionPointer.endOfMainline":t,gameStatusChanged:t},{afterLink:function(e){t(e)}});var r=15;return i},"undefined"==typeof View&&(View={}),View.LessonPages=function(e,t,n,i,o,r,a,s,l,c,d,u){function h(){p(),N.on("resize",function(){L.stop(!0,!0),v()})}function p(){var e=window.location.hash.replace("#",""),t=parseInt(e);if(isNaN(t)||1>t||t>A)if(r===!0)t=1;else for(var n=0;n<a.length&&(t=n+1,void 0!==s[a[n]]);n++);I.showPage(t)}function f(e,t){var n=g(e);if(0===n.length)return!0;x&&x.abort();for(var i=[],d=0;d<n.length;d++)i.push(a[n[d]-1]);x=jQuery.ajax({url:l,data:{pages:i,lessonId:o},type:"GET",dataType:"json",success:function(e){e&&0===e.status&&e.data&&e.data.pages&&jQuery.each(e.data.pages,function(e,t){for(var n in a)if(a[n]===t.pageId){var i=parseInt(n)+1;break}M[i]=new View.SchoolPage(t,c,1==i,i==A,s[t.pageId],r,u,Q,H),M[i].on("back",function(){I.showPreviousPage()}),M[i].on("next",function(){I.showNextPage()}),M[i].on("stateUpdated",function(e,n){s[t.pageId]=n,b()}),i==A&&r!==!0&&(M[i].on("canBeFinished",function(){R=!0}),M[i].on("finish",function(){I.finishLesson()}))}),"function"==typeof t&&t(),x=null},error:function(e,t,n){return x=null,e&&"abort"===e.statusText?!0:void 0},cache:!1})}function g(e){var t=null,n=null;if(null===O)1===e?(t=1,n=T):(t=e-Math.floor(T/2),n=e+Math.ceil(T/2));else if(e>O){for(var i=e;e+_>=i;i++)if(!M[i]){t=i,n=i+_;break}}else for(var i=e;i>=e-_;i--)if(!M[i]){t=i-_,n=i;break}var o=[];if(t&&n){t=1>t?1:t,n=n>A?A:n;for(var i=t;n>=i;i++)M[i]||o.push(i)}return o}function m(e,t){if(null===O)F||(F=y(),N.html(F)),F.html(t),F.trigger("onLessonPageLoaded",F),F.trigger("newhtml"),L.height(N.height());else if(e>O){var n=y();n.html(t),n.insertAfter(F),n.trigger("onLessonPageLoaded",n),n.trigger("newhtml"),v(),L.find(".lessonPageButtons").css("visibility","hidden"),P=!0,function(e,t){N.stop(!1,!1).animate({left:"-"+E+"px"},S,function(){M[e].detachContent(),t.remove(),N.css("left","0px"),v(function(){L.find(".lessonPageButtons").css("visibility","visible"),P=!1})})}(O,F),F=n}else{var n=y();n.html(t),n.insertBefore(F),n.trigger("newhtml"),N.css("left","-"+E+"px"),v(),L.find(".lessonPageButtons").css("visibility","hidden"),P=!0,function(e,t){N.stop(!1,!1).animate({left:"0px"},S,function(){M[e].detachContent(),t.remove(),v(function(){L.find(".lessonPageButtons").css("visibility","visible"),P=!1})})}(O,F),F=n}}function v(e){L.animate({height:N.height()},S/2,e)}function y(){return jQuery("<div>").addClass("lessonPage")}function w(){var e=0,t=0,n=0;for(var i in s)n++,("success"===s[i].status||"failed"===s[i].status)&&(e++,"success"===s[i].status&&t++);return A>n?!1:0===e?!0:t/e>=2/3?!0:!1}function b(){jQuery.each(a,function(e,t){void 0!==s[t]&&D.find("li").eq(e).addClass("completed")})}function C(e){D.find("li").removeClass("current"),D.find("li").eq(e-1).addClass("current")}function k(){N.hide(),L.find(".illegalPage").show(),L.height(L.find(".illegalPage").height())}var F,x,T=3,_=2,E=980,S=500,j=new Handler.Template("schoolLesson").append(new Handler.Template),I=this,A=a.length,O=null,M={},P=!1,B=!1,R=!1,L=jQuery(e);0===L.length&&errorHandler.msg("error",new Error("container not found"),!0,{container:L});var N=L.find(".lessonPagesCarriage"),D=jQuery(i),Q="csrf",H=config.csrf();return I.showNextPage=function(){return P===!0?!1:null===O?!1:O+1>A?!1:void I.showPage(O+1)},I.showPreviousPage=function(){return P===!0?!1:null===O?!1:2>O?!1:void I.showPage(O-1)},I.showPage=function(e){if(e===O)return!1;if(window.location.hash=e,C(e),M[e]){if(e>1&&void 0===s[a[e-2]])return k(),!1;var t=M[e].getContent();m(e,t),M[e].isExercise()?jQuery(n).addClass("training"):jQuery(n).removeClass("training"),f(e),O=e}else{var i=j.render("lessonPageLoader");m(e,i),O=null,f(e,function(){M[e]?I.showPage(e):k()})}},I.finishLesson=function(){if(R===!0&&B===!1){B=!0;var e={lesson:o};e[Q]=H,jQuery.ajax({url:d,data:e,type:"POST",dataType:"json",success:function(e){},error:function(t,n,i){errorHandler.msg("error",new Error("Failed to finish the lesson in the school"),!1,{textStatus:n,requestData:e})},cache:!1});var n=jQuery(t).modal({classes:"customPopup",persistent:!0,close:!1});w()===!0?(n.find(".lessonFailed").remove(),n.find(".restartLessonBtn").remove()):n.find(".lessonFinished").remove(),n.show(),window.location.hash=""}},h(),I},View.SchoolPage=function(e,t,n,i,o,r,a,s,l){function c(e,t,n){e.find(".pageExerciseContainer").find(".styleWrapper").addClass(n?"correct":"incorrect"),t.stop(),e.find(".schoolPageCheckExerciseBtn").remove(),e.find(".schoolNextPageBtn").show(),i===!0&&e.find(".schoolFinishLessonBtn").show(),e.trigger("resize"),d(n?"success":"failed",t.getAnswer())}function d(n,o){if(null===p.status){p.status=n,p.state=o,p.emit("stateUpdated",{status:p.status,state:p.state});var r={page:e.pageId,status:p.status,data:p.state};r[s]=l,jQuery.post(t,r,"json").done(function(e){i===!0&&u()}).fail(function(e,t,n){errorHandler.msg("error",new Error("Failed to set page state in the lesson of the school"),!1,{textStatus:t,requestData:r})})}}function u(){p.emit("canBeFinished"),h.find(".schoolFinishLessonBtn").removeClass("disabled")}var h,p=this,f=!1;p.status=o&&o.status?o.status:null,p.state=o&&o.state?o.state:null,Extend.Publisher(this);var g=new Handler.Template("schoolLesson").append(new Handler.Template);p.detachContent=function(){h.detach()},p.getContent=function(){if(!f){switch(f=!0,e.type){case"content":h=g.render("schoolContentPage",e),h=jQuery(h),setTimeout(function(){h.find(".widgetcontainer.chessbubble").trigger("chess24:lock")},1),h.find(".schoolPageCheckExerciseBtn").remove();break;case"exercise":h=g.render("schoolExercisePage",e),h=jQuery(h),h.find(".schoolNextPageBtn").hide();var t=h.find(".pageExerciseContainer"),o=PuzzleFactory(t,e.contentData);o.start(),o.setSubmitBtn(h.find(".schoolPageCheckExerciseBtn")),o.on("success",function(e){c(h,o,!0)}),o.on("failure",function(e){c(h,o,!1)}),("success"===p.status||"failed"===p.status)&&setTimeout(function(){o.giveAnswer(p.state)},1);break;case"video":h=g.render("schoolVideoPage",e),h=jQuery(h),h.find(".schoolPageCheckExerciseBtn").remove(),h.find(".interactiveVideoChess").videoDisplay(e.contentData.ids,e.contentData.videoUrls,e.contentData.imageUrl)}if(n===!0&&h.find(".schoolBackPageBtn").remove(),i===!0)if(h.find(".schoolNextPageBtn").remove(),r!==!0)null!==p.status?u():"exercise"===e.type?h.find(".schoolFinishLessonBtn").hide():n===!0?d("completed"):setTimeout(function(){d("completed")},1500),h.find(".schoolFinishLessonBtn").on("click",function(e){return jQuery(this).hasClass("disabled")||p.emit("finish"),e.preventDefault(),!1});else{h.find(".schoolFinishLessonBtn").remove();var s=g.render("courseOverviewPageButton",{courseOverviewUrl:a});h.find(".lessonPageButtons").append(s)}else h.find(".schoolFinishLessonBtn").remove();h.find(".schoolBackPageBtn").on("click",function(e){return p.emit("back"),e.preventDefault(),!1}),h.find(".schoolNextPageBtn").on("click",function(e){return d("completed"),p.emit("next"),e.preventDefault(),!1})}return h},p.isExercise=function(){return"exercise"===e.type}},"undefined"==typeof View&&(View={}),View.MetaEditor=function(e,t){function n(n){var r={edit:!!t,tags:t&&!!f||f&&f.length,tag:f?0===f.length?f:f:!1,meta:i(n.publisher.getMeta())};e.html(u.render("meta",r)),t?(o(),f&&f.length&&f.forEach(function(t){e.find("div.suggestField").suggestField("add",{name:t.replace(/</g,"&lt;"),value:t})}),a(e.find(".metaEditor li"))):f&&f.length&&e.find(".tags span").on("click",function(e){d.emit("click",jQuery(this).text())})}function i(e){return Object.keys(p).map(function(t){for(var n=t.split("."),i=e;"object"==typeof e[n[0]]&&null!==e[n[0]];)i=e[n[0]],n.shift();return{name:t,value:i[n[0]],label:window.t(t.replace(/\./g," "))}})}function o(){e.find("div.suggestField").suggestField().suggestField("filter",function(e){return(""+e).sanitize()}).suggestField("clickable",function(e){d.emit("click",e)}).on("chess24:select",function(){d.emit("change",jQuery(this).suggestField("values",!0).map(function(e){return e.sanitize()}))}),e.find("input.suggestField").on("blur",function(){this.value=""}),e.find("[data-attribute]").each(function(){var t=jQuery(this),n=t.data("attribute"),i=p[n];if(i){var o=t.find("span");o.on("click",function(){if(!t.is(".editing")){var r=e.find(".editing[data-attribute]");r.length&&l(r.find("span"));var a=t.is(".empty")?"":o.html();if(o.data("original-value",a).empty(),"string"===i){var c=jQuery('<input type="text"/>').val(a).data("restore",a).appendTo(o).focus();c.css("width",t.width()-o.position().left+"px");var d=c,u=!1,h="blur"}else if("number"===i)c=jQuery('<input type="number"/>').val(a).data("restore",a).appendTo(o).focus(),d=c,u=!1,h="blur";else if("date"===i){c=jQuery("<span/>").appendTo(o);for(var p=a.split("."),f=jQuery('<select class="day"/>').appendTo(c).data("restore",p[2]).append('<option value="">'+window.t("day")+"</option>"),g=1;31>=g;g++)f.append(jQuery("<option/>").val(g).html(g).attr("selected",g==p[2]));for(var m=jQuery('<select class="month"/>').appendTo(c).data("restore",p[1]).append('<option value="">'+window.t("month")+"</option>"),g=1;12>=g;g++)m.append(jQuery("<option/>").val(g).html(g).attr("selected",g==p[1]));
f.add(m).on("change",function(){jQuery(this).toggleClass("novalue",0===this.selectedIndex)}).trigger("change"),d=jQuery('<input type="text" class="year" maxlength="4" placeholder="'+window.t("year")+'"/>').data("restore",p[0]).val(p[0]||"").appendTo(c).on("keypress keyup",function(){setTimeout(function(){d.val(d.val().replace(/\D/,""))})}),u=!0}else"time"===i?(c=jQuery('<input type="text" data-time="true"/>').addClass("cPattern").val(a).data("restore",a).appendTo(o),layout.timePickers(c),h="changeTime",u=!1):i instanceof Array&&(c=jQuery('<select class="cPattern"/>').appendTo(o).data("restore",a),i.forEach(function(e){c.append(jQuery("<option/>").val(e).html(e).attr("selected",e==a))}),layout.dropDown(c),h="change",u=!1);h&&c.on(h,function(){clearTimeout(s.timeout),s.timeout=setTimeout(function(){s(n,c)},100)}),d&&d.on("keyup",function(e){switch(e.which){case 27:return l(o),!1;case 13:return s(n,c),!1}}),t.addClass("editing"),u&&t.append(jQuery('<a class="save"/>').on("click",function(){s(n,c)})),t.append(jQuery('<a class="cancel"/>').on("click",function(){l(o)}))}})}})}function r(e,t){if("date"===p[t]){var n=e.find(".year").val()||"????",i=e.find(".month").val()||"??",o=e.find(".day").val()||"??";return"????"===n&&"??"===i&&"??"===o?"":(""+n.substr(0,4)).lpad("0",4)+"."+(""+i).lpad("0",2)+"."+(""+o).lpad("0",2)}return e.val().sanitize()}function a(e){var t=e.parent("ul").data("empty");e.each(function(){var e=jQuery(this),n=e.find("span");n.text().trim()?e.removeClass("empty"):(e.addClass("empty"),n.html(t))})}function s(e,t){for(var n=r(t,e),i=c.getMeta(),o=i,a=e.split("."),s=0;o[a[s]]&&"object"==typeof o[a[s]];)o=o[a[s++]];o[a[s]]=n,c.setMeta(i)}function l(e){clearTimeout(s.timeout);var t=e.closest("li");e.empty().html(e.data("original-value")),a(t.removeClass("editing")),t.find(".cancel, .save").remove()}var c,d=this,u=new Handler.Template("database"),h=[void 0,"GM","IM","FM","CM","WGM","WIM","WFM","WCM"],p={Site:"string",Event:"string",Date:"date",Time:"time",Round:"number",Board:"number",Result:["1-0","0-1","1/2-1/2","*"],"White.Name":"string","White.Elo":"number","White.Title":h,"White.Country":"string","Black.Name":"string","Black.Title":h,"Black.Elo":"number","Black.Country":"string"},f=!1;return e=jQuery(e),e.length||errorHandler.error("container not found in View.MetaEditor"),Extend.Suspendable(d),n.delegate=d.delegate(n),Extend.Subscriber(d,{currentGameChanged:n.delegate,meta:n.delegate},{afterLink:function(e){c=e.publisher,n.delegate(e)}}),Extend.Publisher(d),d.onResume(function(e){e&&c&&n({publisher:c})}),d.refresh=function(){c&&n.delegate({publisher:c})},d.toggleEdit=function(e){e=!!e,t!==e&&c&&(t=e,n.delegate({publisher:c}))},d.setTags=function(e){return f=e,d},d.getTags=function(){return e.find(".suggestField").suggestField("values",!0)},d},"undefined"==typeof View&&(View={}),function(){var e={name:"Name",title:"Title",titleName:"TitleName",staff:"Staff",moderator:"Moderator",fraud:"Fraud",cop:"Cop",elo:"Elo",country:"Country",premium:"Premium"};View.Meta=function(t,n,i,o,r){function a(e){switch(e){case"w":case"white":case"White":n="w",d="White",c="white";break;case"b":case"black":case"Black":n="b",d="Black",c="black"}}function s(e,t){l(e,{meta:t.getMeta()})}function l(n,a){var a=a.meta[d][e[i]||i];t.removeClass("white black"),r||t.empty(),a?(t.addClass(c).addClass(i),r||t.html(f+a+g),o&&t.show()):o&&t.hide(),h&&h(t,a)}var c,d,u,h,p=this,f="",g="";t=jQuery(t),0===t.length&&errorHandler.error(new Error("container not found in View.Meta"),{container:t}),p.setPrefix=function(e){return f=e,p},p.setSuffix=function(e){return g=e,p},Extend.Suspendable(p);var m=p.delegate(l);return Extend.Subscriber(p,{currentGameChanged:p.delegate(s),meta:m,flipBoard:function(e){"b"===n?a("w"):"w"===n&&a("b"),m(e,{meta:e.publisher.getMeta()})}},{afterLink:function(e){u=e.publisher,m(e,{meta:e.publisher.getMeta()})}}),p.onResume(function(e){e&&u&&l({publisher:u},{meta:u.getMeta()})}),p.setCustomUpdate=function(e){return h="function"==typeof e?e:void 0,p},a(n),p}}(),"undefined"==typeof View&&(View={}),View.NotationArea.registerExtension("AfterGameControls","after",function(e){function t(e){if(!e.publisher.isOver())return a=!1,void l.empty();a=!0,l.html(s.render("extensions.afterGameControls",i(e))),l.find(".newGame").on("click",function(){return Controller.getPlayZone().playNow(),!1}),l.find(".pgnDownload").on("click",function(){return config.level().isPremium?(Handler.tracking("pgn","game"),!0):(Handler.tracking("pgn","gameConversion"),Dialog.conversionGoPremium("pgnDownload"),!1)}),config.level().isPremium||l.find(".analyze").on("click",function(){return Dialog.conversionGoPremium("analysisMode"),!1}),l.find(".share").shareButtons({noLabel:!0,noIcon:!0,facebook:!0,google:!1,embed:!1,twitter:$('meta[property="og:title"]').attr("content")||!0});var t=l.closest(".nativeScroll");t.length&&t.animate({scrollTop:t.prop("scrollHeight")+"px"})}function n(e){a&&config.level().isPremium&&l.find(".analyze").replaceWith(s.render("extensions.analysisLink",i(e)))}function i(e){var t=e.publisher.getMeta();return{knotId:e.publisher.getCurrentPosition().knotId,isPremium:config.level().isPremium,GameUUID:t.GameUUID,showNewGame:!t.TournamentUUID}}var o,r=this,a=!0;Extend.Suspendable(r),t.delegate=r.delegate(t),n.delegate=r.delegate(n),Extend.Subscriber(r,{movedPositionPointer:n.delegate,currentGameChanged:t.delegate,gameStatusChanged:t.delegate},{afterLink:function(e){o=e.publisher,t(e)}}),r.onResume(function(e){e&&o&&t({publisher:o})});var s=new Handler.Template("notationTable"),l=$("<div/>");return r.getContent=function(){return l},r}),View.NotationArea.registerExtension("Comment","bottom",function(e){function t(){n(void 0,l.getCurrentPosition())}function n(e,t){r(t.getGlyphes()),a(t.comment)}function i(e,t){a(t.value)}function o(e,t){r(t.value)}function r(e){y.removeClass("active"),e.forEach(function(e){y.filter(".glyphId-"+e).addClass("active")})}function a(e){w.editor("setValue",e&&Handler.Template.escape(e)||"",!0)}function s(){l&&d&&l.setComment(w.editor("text").trim())}var l,c=this,d=!0;Extend.Suspendable(c),Extend.Subscriber(c,{"movedPositionPointer.current":c.delegate(n),currentGameChanged:c.delegate(t),"position.comment.current":c.delegate(i),"position.glyph.current":c.delegate(o)},{afterLink:function(e){l=e.publisher,t(e)},afterUnlink:function(e){l=void 0}}),c.onResume(function(e){e&&l&&t()});var u=new Handler.Template("notationTable"),h=Chess.Glyphes.getByCategory(),p=$(u.render("extensions.comment",{glyphes:h,glyphCategories:Object.keys(h),getUUID:function(){return(new Helper.UUID).getShort()},getGlyphCategory:function(){return Object.reduce(h[this],function(e,t,n){return e.push({value:t,key:n}),e},[])}}));c.getContent=function(){return p},c.setUserCommentWritePermission=function(e){return d=e,m.toggleClass("disabled",!e),f.toggleClass("inactive",!e),w.toggle(e),c};var f=p.find(".inputContainer"),g=f.find(".editor"),m=p.find(".addComment"),v=f.find(".customTabs"),y=f.find(".glyphItem"),w=g.editor({language:config.language(),height:22,maxLength:e.maxLength||5e4,hideToolbar:!0,toolbar:{left:[],right:[]},watermark:f.attr("placeholder"),removeLineBreaks:!0});return m.on("click",function(){return s(),!1}),w.on("keypress",function(e){13===e.which&&(s(),e.preventDefault())}),v.on("chess24:hide chess24:show",function(e){e.stopPropagation()}),y.on("click.glyphToggle",function(){if(l&&d){var e=parseInt(jQuery(this).data("glyphId"),10),t=l.hasGlyph(e);if(t)return void l.removeGlyph(e);var n=l.getGlyphes(),i=Chess.Glyphes.getByCategory(),o=Object.findKey(i,function(t){return t[e]});if(!o||!Chess.Glyphes.isSinleItemCategory(o))return void l.addGlyph(e);var r=i[o],a=n.filter(function(e){return!r[e]});a.push(e),l.setGlyphes(a)}}),c}),View.NotationArea.registerExtension("GameEnd","after",function(e){function t(){r.html(o.render("extensions.result",{withScore:e.score,gameEndDescription:e.description&&n&&n.getGameEndDescription(),result:Object.map(n.getGameStatus().result,function(e){return"1/2"===e?"½":e})}))}var n,i=this;e=Object.extend({score:!0,description:!0},e||{}),Extend.Suspendable(i),t.delegate=i.delegate(t),Extend.Subscriber(i,{currentGameChanged:t.delegate,gameStatusChanged:t.delegate},{afterLink:function(e){n=e.publisher,t()},afterUnlink:function(e){n=void 0}}),i.onResume(function(e){e&&n&&t(void 0,n)});var o=new Handler.Template("notationTable"),r=$("<div/>");return i.getContent=function(){return r},i}),View.NotationArea.registerExtension("Moves","main",function(e){function t(e){switch(e){case"all":return{w:!1,b:!1};case"black":return{w:!0,b:!1};case"white":return{w:!1,b:!0}}return{w:!0,b:!0}}function n(){return e.engine&&window.settings.getBoolean("game-broadcast-engine")}function i(e,t){var n=t.parentMove;if(n){if(n&&n.parentMove&&!n.comment&&t.lastMoveWasBlack()&&n.parentMove.countChildrenMoves()<2&&!n.getChat().length){var i=m(n.knotId),o=$(Y.render(J,R(t)));return _(o),void y(v(i).removeClass(K)).replaceWith(o)}n&&!n.parentMove&&n.comment&&v(m(n.knotId)).remove();var r=$(Y.render(X,u(t.lastMoveWasWhite()&&t,t.lastMoveWasBlack()&&t,n.isRootPosition()&&n)));E(r),j(r),S(r),me.append(r),e&&e.publisher&&"function"==typeof e.publisher.getCurrentGame&&O(me,e.publisher),t.comment&&f(t)}}function o(e,t){if(t.parentMove.isInMainline()){if(C(t).length)return;var n=H(t,t.getPositionInChildrenArray());n.color=Chess.colors.invert(Chess.colors.letter2full(t.moveRight));var i=$(Y.render(Z,n));S(i),E(i);var o=t.parentMove.getChildrenMoveById(0),r=v(m(o.knotId));return t.lastMoveWasWhite()&&!t.parentMove.isEndOfLine()&&c(r,t.moveCounter),void r.append(i)}if(t.getPositionInChildrenArray()){if(t.lastMoveWasWhite())var a=t.moveCounter+". ";else a=t.moveCounter-1+"... ";var d=Y.render(ee,{elements:[Q(" "+se),Q(a),D(t),Q(le)]});if(2===t.parentMove.countChildrenMoves()){var u=m(t.parentMove.getChildrenMoveById(0).knotId);u.after(d),E(u.parent())}return void l(s(t))}if(1===t.parentMove.parentMove.countChildrenMoves()||t.parentMove.getPositionInChildrenArray()||t.parentMove.parentMove.isInMainline()){var d=Y.render(ee,{elements:[Q(t.lastMoveWasWhite()?" "+t.moveCounter+". ":" "),D(t)]}),h=w(t.parentMove),p=h.length&&h||m(t.parentMove.knotId);return p.after(d),void _(p.nextAll(".moveBlock"))}l(s(t))}function r(e,t){var n=s(t);return t===n?(C(t).remove(),void d(t.parentMove.getChildrenMoveById(0))):void l(n)}function a(e,t){var n=t.getDistanceToMainline();return n>1?void l(s(t)):void x()}function s(e){for(;!e.parentMove.isInMainline();)e=e.parentMove;return e}function l(e){var t=H(e,e.getPositionInChildrenArray()),n=C(e);n.children("span").html(Y.render(ee,t)),E(n)}function c(e,t){if(!e.hasClass(K)){var n=$(Y.render(X,{moveNumber:t,moves:[void 0,void 0]})),i=y(e),o=i.parent();y(n).replaceWith(i),o.html(Y.render(te)),n.append(e.find(".notationTableInlineElement.black")),e.after(n),e.addClass(K)}}function d(e){if(!(!e||e.comment||e.parentMove&&e.parentMove.countChildrenMoves()>1||e.lastMoveWasBlack()||e.isEndOfLine()||e.getChat().length)){var t=e.knotId,n=e.getChildrenMoveById(0).knotId,i=v(m(t)),o=m(n),r=v(o),a=y(i);a.replaceWith(o),r.find(".notationTableInlineElement").appendTo(i),r.remove(),i.removeClass(K)}}function u(e,t,n){return{moveNumber:e&&e.moveCounter||t&&t.moveCounter-1||n.moveCounter,startPosition:n,moves:[e&&R(e),t&&R(t)]}}function h(e,t){clearTimeout(h.aggregated),h.aggregated=setTimeout(function(){k(t)})}function p(t,n){switch(n.key){case"comment":return f(n.position);case"chat":return g(n.position,n.value)}if(n&&n.position&&(e.time||"timeUsage"!==n.key)){var i=m(n.position.knotId);if(i.length&&!n.position.isRootPosition())return n.position.isInMainline()?void i.html(Y.render(ne,R(n.position))):void i.html(D(n.position).moveText)}}function f(e){var t=w(e);if(!e.isInMainline()){var n=$(Y.render(ie,D(e)));if(t.length)return void t.replaceWith(n);var i=m(e.knotId);return void i.after(n)}if(!e.comment)return d(e),e.isRootPosition()&&!e.countChildrenMoves()&&v(m(e.knotId)).remove(),void t.remove();if(t.length)return void t.find("span").html(Handler.Template.escape(e.comment));n=$(Y.render(oe,R(e))),j(n);var o=v(m(e.knotId));if(e.lastMoveWasWhite()&&!e.isEndOfLine()&&c(o,e.moveCounter),e.isRootPosition()){if(o.length)return void o.prepend(n);var r=$(Y.render(X,u(void 0,void 0,e)));return E(r),j(r),void me.append(r)}o.children("dl").after(n)}function g(e,t){if(ve){var n=b(e);if(n.length)return i=$(Y.render(ae,L(t))),I(i),n.append(i),void F(e);var i=$(Y.render(re,R(e)));I(i);var o=v(m(e.knotId));if(e.lastMoveWasWhite()&&!e.isEndOfLine()&&c(o,e.moveCounter),e.isRootPosition()){if(o.length)return void o.prepend(i);var r=$(Y.render(X,u(void 0,void 0,e)));return E(r),void me.append(r)}o.children("dl").after(i),F(e)}}function m(e,t){return ge[e]||(ge[e]=(t||me).find(".notation-"+e))}function v(e){return e.closest("li")}function y(e){return e.find("dd:nth-of-type(2) > span")}function w(e){return me.find(".comment-"+e.knotId)}function b(e){return me.find(".chat-"+e.knotId)}function C(e){return me.find(".sideline-"+e.knotId)}function k(e){var t=m(e.knotId);de!==t&&t.length&&(de&&de.removeClass(q),de=t.addClass(q),F(e))}function F(e){var t=b(e);if(!ue){var n=m(e.knotId),i=n.parent().height();i>0&&(ue=3*i)}if(ue){if(t.length)var o=t.position().top+t.children().last().position().top-ue;else{n=n||m(e.knotId),o=n.position().top-ue;var r=n.parent().parent();r.hasClass("notationTableInlineElement")&&(o+=r.position().top)}he.stop(!0).animate({scrollTop:o+"px"})}}function x(){if(ce){G(),de=null,ge={};for(var e,t,n=[],i=ce.getStartPosition(),o=i;o=o.getChildrenMoveById(0);)o.lastMoveWasWhite()?e=o:t=o,(t||e.comment||e.isEndOfLine()||e.parentMove&&e.parentMove.countChildrenMoves()>1||ve&&e.getChat().length)&&(n.push(u(e,t,i)),e=!1,t=!1,i=!1);i&&i.comment&&n.push(u(e,t,i)),me.html(Y.render("extensions.moves",n)),T(),E(),j(),A(),S(),"function"==typeof ce.getCurrentGame&&O(me,ce),k(ce.getCurrentPosition())}}function T(){me.toggleClass("noPermissionDeleteSideline",!ce.getDeleteMode(void 0,!1))}function _(e){return e.length?(e.each(function(e,t){t=$(t),ge[t.data("knotId")]=t}),e.off("click.moveBlock",M).on("click.moveBlock",M)):void 0}function E(e){return _((e||me).find(".moveBlock"))}function S(e){return(e||me).find(".deleteSideline").off("click.deleteSideline",M).one("click.deleteSideline",P)}function j(e){return(e||me).find(".deleteComment").off("click.deleteComment",B).one("click.deleteComment",B)}function I(e){e.expandEmoticons().expandLinks()}function A(e){I((e||me).find(".chatLine"))}function O(e,t){var n=e.closest(".nativeScroll");Controller.Recommender.addRecommendationForGame(n,t)}function M(){return ce.gotoId(jQuery(this).data("knotId")),!1}function P(){return ce.deleteMove(jQuery(this).data("knotId"),!0),!1}function B(){return ce.setComment(void 0,jQuery(this).data("knotId")),!1}function R(t){if(n()){var i=t.getEngine("numerical",!0,!1);V(t.getEngineFen())}var o=ve&&t.getChat();return{additionalMoveInformation:e.time||e.engine,knotId:t.knotId,chat:o&&o.length&&L(o),showTimeUsage:e.time,showEngine:e.engine,timeUsage:e.time&&!t.isNullMove()&&t.isAtLeastAwayFromRoot(ce.getClockStartMove())&&Helper.formatTimeUsage(t.timeUsage,e.ms)||"",moveText:pe[t.moveRight]?t.getMove("san",!0):"...",comment:t.comment,engineFen:t.getEngineFen(),color:t.isRootPosition()?"start":Chess.colors.invert(Chess.colors.letter2full(t.moveRight)),engine:i&&Handler.engine.formatEngine(i.score,i.mate),sideline:t&&t.parentMove&&N(t.parentMove)}}function L(e){if(!Array.isArray(e))return L([e])[0];var t=ce.getMeta(),n=Chess.colors.both.metaData.reduce(function(e,n){return t[n].UUID&&(e[t[n].UUID]=n.toLowerCase()),e},{});return e.map(function(e){return{message:e.message,color:n[e.id]}})}function N(e){for(var t=[],n=e.countChildrenMoves(),i=1;n>i;i++)t.push(H(e.childrenMoves[i],i));return t}function D(e){return{knotId:e.knotId,moveText:e.getMove("san",!0),comment:e.comment||!1,plainText:!1}}function Q(e){return{plainText:e,moveText:!1}}function H(e,t){function n(e){var t=[],o=e.countChildrenMoves();if(!o)return t;var r="",a="";if(e.lastMoveWasBlack()?(r=e.moveCounter+". ",t.push(" "+r)):(a=e.moveCounter+"... ",i&&t.push(a)),t.push(" ",D(e.getChildrenMoveById(0))," "),i=!1,o>1)for(var s=1;o>s;s++){t.push(" "+se+a+r,D(e.getChildrenMoveById(s)),n(e.getChildrenMoveById(s)));var l=t.last();" "===l.last()&&l.pop(),t.push(le+" "),i=!0}t=t.concat(n(e.getChildrenMoveById(0)));for(var s=0;s<t.length;s++)Array.isArray(t[s])&&t.splice.apply(t,[s,1].concat(t[s]));return t}var i=!1,o=n(e);if(e.lastMoveWasWhite())var r=e.moveCounter+". ";else r=e.moveCounter-1+"... ";o.unshift(W[--t%W.length]+") "+r,D(e)," ");for(var a=[],s="",l=o.length-1;l>=0;l--)""!==o[l]&&("string"!=typeof o[l]?(s&&(a.unshift(Q(s)),s=""),a.unshift(o[l])):s=o[l]+s);return s&&a.unshift(Q(s)),{knotId:e.knotId,elements:a}}function G(){Object.isEmpty(fe)||(Handler.engine.off(Object.keys(fe).map(function(e){return e+":numerical"}).join(" "),U),fe={})}function V(e){fe[e]||(Handler.engine.on(e+":numerical",U),fe[e]=!0)}function U(e,t){if(window.settings.getBoolean("game-broadcast-engine")){var n=e.channel.split(":")[0],i=me.find(".fen-"+n.replace(/\//g,"\\/"));if(i.length){if(ce){var o=ce.getPositionByKnotId(i.parent().data("knot-id"));o.lastMoveWasWhite()&&Handler.engine.shouldInvert(o,t)&&(t=Handler.engine.invert(t))}i.html(Handler.engine.formatEngine(t.score,t.mate))}}}var z=this,W="abcdefghijklmnopqrstuvwxyz",q="highlighted jump-to-link",K="incomplete",Y=new Handler.Template("notationTable"),J="extensions.move",X="extensions.moveLine",Z="extensions.sideLine",ee="extensions.sideLineElements",te="extensions.noMove",ne="extensions.moveProperties",ie="extensions.sideLineComment",oe="extensions.commentBlock",re="extensions.chatBlock",ae="extensions.chatMessage",se="(",le=")";e=Object.extend({time:!0,ms:!0,engine:!0},e||{});var ce,de,ue,he,pe=t(e.blindfold),fe={},ge={},me=$(Y.render("extensions.movesContainer"));Extend.Suspendable(z).onResume(function(e){e&&ce&&x()}),x.delegate=z.delegate(x),Extend.Subscriber(z,{currentGameChanged:x.delegate,"movedPositionPointer.start":x.delegate,"move.mainline.add":z.delegate(i),"move.sideline.add":z.delegate(o),"move.mainline.delete":x.delegate,"move.sideline.delete":z.delegate(r),"move.promote":z.delegate(a),position:z.delegate(p),"movedPositionPointer.current":z.delegate(h),"permission.delete":z.delegate(T)},{afterLink:function(e){ce=e.publisher,he=me.closest(".nativeScroll"),x()},afterUnlink:function(){ce=void 0}});var ve=window.settings.getBoolean("game-chat");return window.settings.on("settings.game-chat",function(e,t){ve=!!t.value,x()}),window.settings.on("settings.game-broadcast-engine",x),z.getContent=function(){return me},z.setBlindfold=function(e){return pe=t(e),x(),z},z.setUserCommentWritePermission=function(e){return me.toggleClass("readonlyUserComments",!e),z},z}),View.NotationArea.registerExtension("PlayZoneChat","bottom",function(e){function t(e){g.addClass("inactive"),f.addClass("disabled"),C.hide(),y.hide(),v.text(e||"").show(),e&&p.hide(),l=!1}function n(){l||(g.removeClass("inactive"),C.show(),y.show(),v.hide(),p.show(),f.removeClass("disabled"),C.focus(),l=!0)}function i(){var e=s.getMeta();return window.settings.getBoolean("game-chat")&&e.GameUUID?config.level().isGuest?void t(b):e.White.Guest||e.Black.Guest?void t(w):void n():void t()}function o(){var e,t=s.getMeta(),n=config.user().uuid;return Chess.colors.both.metaData.some(function(i){return t[i].UUID&&t[i].UUID!==n?e=t[i].UUID:void 0}),e}function r(){if(l&&!jQuery(this).hasClass("disabled")){var e=C.editor("text").trim();a(e),C.editor("reset"),C.focus()}}function a(e){var t=o(),n=s.getMeta();if(t&&n.GameUUID){var i={gameUuid:n.GameUUID,moveId:s.getEndOfMainlinePosition().knotId};conversationHandler.sendPrivateMessageInGame(t,i,e)}}var s,l,c=this;Extend.Suspendable(c),Extend.Subscriber(c,{currentGameChanged:c.delegate(i)},{afterLink:function(e){s=e.publisher,i()},afterUnlink:function(e){s=void 0}}),c.onResume(function(e){e&&s&&i(void 0,s)}),window.settings.on("settings.game-chat",i);var d=new Handler.Template("notationTable"),u=$(d.render("extensions.playZoneChat")),h=u.find(".chatElements"),p=u.find(".notationTableChatSettings"),f=h.find("a.sendChat"),g=h.find(".inputContainer"),m=h.find(".editor.chat"),v=h.find(".editorOverlay"),y=h.find(".chatToolbar"),w=v.attr("playzoneopponentisguesttemplate"),b=v.attr("playzoneyouareguesttemplate"),C=m.editor({language:config.language(),height:22,maxLength:250,hideToolbar:!0,extensions:["emoticons"],toolbar:{left:[],right:[]},extensionConfig:{emoticons:{dialogContainer:g.find(".btnChatExtension .cTooltipBoxContainer")}},watermark:g.attr("placeholder"),dialogConfig:{emoticons:{showAsPopup:!0}},removeLineBreaks:!0});return f.on("click",function(){return r(),!1}),C.on("keypress",function(e){13===e.which&&(r(),e.preventDefault())}).on("keyup change",function(e){C.editor("isEmpty")?(f.addClass("disabled"),f.attr("disabled","disabled")):(f.removeClass("disabled"),f.removeAttr("disabled"))}),window.settings.attach(p),c.getContent=function(){return u},c}),View.NotationArea.registerExtension("PlayingVsGuest","before",function(e){function t(){if(!i||config.level().isGuest)return void l.empty();var e=i.getMeta();return!e.White||!e.Black||e.White.UUID!==r&&e.Black.UUID!==r||!e.White.Guest&&!e.Black.Guest||settings.getBoolean("pair-registered-only")?void l.empty():void l.html(s.render(a+config.level().toString())).find("a.settings").on("click.settings",n)}function n(){(new Dialog.PlayzoneSettings).getContent().modal("show")}var i,o=this,r=config.user().uuid,a="extensions.playingVsGuest.";Extend.Suspendable(o),t.delegate=o.delegate(t),Extend.Subscriber(o,{currentGameChanged:t.delegate},{afterLink:function(e){i=e.publisher,t()},afterUnlink:function(e){i=void 0}}),o.onResume(function(e){e&&i&&t(void 0,i)});var s=new Handler.Template("notationTable"),l=$(s.render(a+"main"));return o.getContent=function(){return l},o}),"undefined"==typeof View&&(View={}),View.OutcomePrediction=function(e){function t(){e.slideDown()}function n(){e.slideUp()}function i(t,n){var i=Object.merge(n.getMeta(),p);o(i,"White"),o(i,"Black"),e.html(g.render("predictedOutcome.main",i)),layout.userMiniprofile(e),f=jQuery(".predictionScale > span",e),r(t,n.getCurrentPosition(),!0)}function o(e,t){e[t]&&e[t].Picture&&"/"===e[t].Picture.substr(0,1)&&"//"!==e[t].Picture.substr(0,2)&&(e[t].Picture=config.assetDir()+e[t].Picture)}function r(e,t,n){clearTimeout(y),y=setTimeout(function(){a(e,t,n)})}function a(e,t,n){for(d&&Handler.engine.off(d+":numerical",s);t&&t.isNullMove();)t=t.parentMove;d=t.getEngineFen(),u=t,Handler.engine.on(d+":numerical",s),s(e,Handler.engine.get(t,"numerical",!0,!0),n)}function s(e,t,n){return Handler.engine.shouldInvert(u,t)&&(t=Handler.engine.invert(t)),l(t)}function l(t){var n=Controller.Broadcast.getOutcomePrediction(t);n.forEach(function(e,t){var n=e+"%";jQuery(f[t]).css("width",e+"%").attr("data-prediction",n)}),p={percentWhite:n[0],percentDraw:n[1],percentBlack:n[2]},e.find(".cTooltipBoxContainer").replaceWith(g.render("predictedOutcome.tooltip",Object.extend({eval:Handler.engine.formatEngine(t.score,t.mate),phrase:Controller.Broadcast.getPhraseForEvaluation(t.score,t.mate)},p)))}function c(){var t=jQuery(".predictionScale > span",e);t.parent().append(t[0]),t.parent().prepend(t[2]);var n=jQuery(".player.fLt",e),i=jQuery(".player.fRt",e);n.removeClass("fLt").addClass("fRt"),i.removeClass("fRt").addClass("fLt")}var d,u,h,p,f,g=new Handler.Template("broadcast"),m=window.settings.getBoolean("game-broadcast-engine");e=jQuery(e),e.length||errorHandler.error(new Error("container not found in View.OutcomePrediction"),{container:e});var v=Extend.Suspendable(this);Extend.Subscriber(v,{currentGameChanged:v.delegate(i),"movedPositionPointer.current":v.delegate(r),flipBoard:c},{afterLink:function(e){h=e.publisher,m?t():n(),i(e,e.publisher)}}),v.onResume(function(e){e&&h&&(m?t():n(),i({publisher:h},h))}),window.settings.on("settings.game-broadcast-engine.on",t),window.settings.on("settings.game-broadcast-engine.off",n);var y;return v},"undefined"==typeof View&&(View={}),View.PlayButton=function(e,n){function i(n,i){function o(){function t(e){if(clearTimeout(r),void 0===e&&(e=i.content.tournamentStartsAt-Controller.Broadcast.offsetCorrectedDateNow()),!(0>=e)){var a=Date.getSplitedTime(e);n.html(""+a.minutes),o.html((""+a.seconds).lpad("0",2)),r=setTimeout(function(){t(e-1e3)},1e3-Controller.Broadcast.offsetCorrectedDateNow()%1e3)}}if(e.removeClass(),i.content.gameSessionToken?l?v():m():h(),!jQuery(".tournament.tournamentId"+i.content.tournamentUuid).length){p.css("cursor","pointer"),void 0!==d&&d.remove(),d=jQuery(s.render("tooltipTournamentSoon",{tournamentName:i.content.tournamentName,tournamentUrl:i.content.tournamentUrl})),e.append(d).addClass("navTournamentSoon cTooltipBox position-bottom-fixed");var n=d.find("span.minutes"),o=d.find("span.seconds"),r=setTimeout(t,1e3-Controller.Broadcast.offsetCorrectedDateNow()%1e3);i.content.tournamentStartsAt=i.content.tournamentStartsAt||Controller.Broadcast.offsetCorrectedDateNow()}}function r(e){}function a(e){new Dialog.PlayzoneTournamentGame(e.tournamentUuid,e.gameUrl)}function u(n){e.removeClass().addClass("navPlayOn cTooltipBox position-bottom-fixed"),p.css("cursor","pointer"),p.off("click.playNow").on("click.playNow",function(){var e=new Controller.Broadcast;e.showGame(n.tournamentId,n.roundId,n.matchId,n.gameId)}),p.html(t("Back to the game"))}function h(){var n=e.is(".cTooltipBox");e.removeClass().addClass("navPlayNow"),n&&e.addClass("cTooltipBox position-bottom-fixed"),p.css("cursor","pointer"),p.html(t("Play Now")),p.off("click.playNow").on("click.playNow",g)}function g(){goToNewHousePlay()}function m(){e.removeClass().addClass("navPlayOn cTooltipBox position-bottom-fixed"),p.css("cursor","pointer"),p.off("click.playNow").on("click.playNow",g),p.html(t("Back to the game"))}function v(){e.removeClass().addClass("navPlaying"),p.css("cursor","default"),p.off("click.playNow"),p.html(t("Currently playing..."))}function y(n){return 1==n.immediate?void(l?v():m()):(p.data("challenge",n.challenge),e.removeClass().addClass("navChallengeAccepted cTooltipBox position-bottom-fixed"),p.css("cursor","pointer"),p.html(t("Start the challenge")),void p.off("click.playNow").on("click.playNow",function(){jQuery.post("/api/web/challengeAPI/gameResolve",jQuery.extend({challenge:n.challenge},f)).done(Controller.getPlayZone().playNow)}))}switch(c=i.mode,i.mode){case"tournamentSoon":o();break;case"tournamentStart":r(i.content);break;case"tournamentRoundStart":a(i.content);break;case"touramentPlaying":u(i.content);break;case"playNow":h();break;case"playOn":m();break;case"playing":v();break;case"challengeAccepted":y(i.content)}}function o(n,i){function o(e){e=Math.round(e/1e3),u.html(Handler.Template.renderString(d,{ttl:e}))}if(void 0!==i.content.expireAt){var a=i.content.expireAt,s=Date.now(),l=n.publisher.getTimeOffset(),c=a-s-l;if(i.content.win)var d=t('You will loose your game in <span class="dsDigitalFont">{{ttl}}</span> seconds');else d=t('Your game will be aborted in <span class="dsDigitalFont">{{ttl}}</span> seconds');var p=Math.ceil(c/1e3);u=jQuery("<div/>").addClass("cTooltipBoxContainer").html(Handler.Template.renderString(d,{ttl:p})),e.append(u),h=new Helper.timer.Countdown(c,1e3,o,r)}}function r(){h&&h.stop(),u&&u.remove()}if(View.PlayButton.instance instanceof View.PlayButton)return View.PlayButton.instance;var a=this,s=new Handler.Template("playButton"),l=!1,c="playNow";e=jQuery(e);var d,u,h,p=e.find("a.playNowLink");(0===e.length||0===p.length)&&errorHandler.msg("error",new Error("View.PlayButton: container not found"),!0,{container:e});var f={csrf:config.csrf()};return Extend.Subscriber(a,{game_challenge:function(e,t){t.content&&"accept"===t.content.action&&(t.mode="challengeAccepted",i(e,t))},playerDisconnected:function(e,t){"playOn"===c&&o(e,t)},playerConnected:function(e,t){l?t.mode="playing":t.mode="playOn",i(e,t),r()},"channel:gameSession:add:self":function(e,t){l?t.mode="playing":t.mode="playOn",i(e,t)},"channel:gameSession:remove:self":function(e,t){t.mode="playNow",i(e,t)},playzone_tournament:function(e,t){t.content&&(t.mode="start"==t.content.action&&"tournamentStart"||"soon"==t.content.action&&"tournamentSoon"||"round"==t.content.action&&"tournamentRoundStart"||"playing"==t.content.action&&"touramentPlaying",i(e,t))}},{afterLink:i(void 0,n)}),a.isPlaying=function(e){void 0===e&&(e=!0),l=e,l&&i(void 0,{mode:"playing"})},a.isLoading=function(t){t?e.addClass("loading"):setTimeout(function(){e.removeClass("loading")},300)},View.PlayButton.instance=a,a},View.PlayButton.isPlaying=function(e){View.PlayButton.instance instanceof View.PlayButton&&View.PlayButton.instance.isPlaying(e)},View.PlayButton.isLoading=function(e){View.PlayButton.instance instanceof View.PlayButton&&View.PlayButton.instance.isLoading(e)},"undefined"==typeof View&&(View={}),View.PlayShortcuts=function(e,t){function n(){t?i():o()}function i(){e.removeClass("inactive"),e.find("a").off("click.play").on("click.play",r)}function o(){e.addClass("inactive"),e.find("a").off("click.play")}function r(){goToNewHousePool(jQuery(this).attr("settings"))}var a=this;e=jQuery(e),Extend.Subscriber(a,{"channel:gameSession:add:self":o,"channel:gameSession:remove:self":i},{afterLink:n})},"undefined"==typeof View&&(View={}),View.PlayerCountry=function(e,t,n){function i(e){var t=e.publisher.getMeta();t&&r(e,{meta:t})}function o(e){"b"===t?t="w":"w"===t&&(t="b"),r(e,{meta:e.publisher.getMeta()})}function r(e,n){var i=n.meta[d[t]].Country;return i?void a(i,window.t.country(i)):a()}function a(t,n){if(t!==l){if(l&&u.removeClass("flag-"+l),l=t,!t)return void e.remove();e.attr("data-tooltip",n),u.addClass("flag-"+t),e.show()}}n=n||"Bottom";var s,l,c=this,d={w:"White",b:"Black"};e=jQuery(e),e.addClass("cTooltip"+n);var u=e.children("span").addClass("icoFlag");return 0===e.length&&errorHandler.msg("error",new Error("container not found"),!0,{container:e}),Extend.Suspendable(c),Extend.Subscriber(c,{meta:c.delegate(r),currentGameChanged:c.delegate(i),flipBoard:c.delegate(o)},{afterLink:function(e){s=e.publisher,i(e)}}),c.onResume(function(e){e&&s&&i({publisher:s})}),c},"undefined"==typeof View&&(View={}),View.PlayerInfo=function(e,t,n,i){function o(){return s.hasClass("white")?s.removeClass("white").addClass("black"):s.hasClass("black")&&s.removeClass("black").addClass("white"),r}var r=this,a=new Handler.Template("playZone"),s=jQuery(e);s.addClass("b"===t?"black":"white");var l=[];0===s.length&&errorHandler.msg("error",new Error("container not found"),!0,{container:s}),s.html(a.render("playerInfo"+$suffix));var c=s.find(".player .name"),d=s.find(".player .level .attributeTitle"),u=s.find(".player .level .attributePremium"),h=s.find(".player .level .attributeStaff"),p=s.find(".player .level .attributeModerator"),f=s.find(".player .level .attributeFraud"),g=s.find(".player .level .attributeCop"),m=s.find(".player .level .elo"),v=s.find(".player .level .eloChange"),y=s.find(".player .country"),w=s.find(".player .pic"),b=s.find(".score"),C=s.find(".thinking"),k=s.find(".clock");return l.push(new View.PlayerName(c,t,n,i)),l.push(new View.Meta(d.find("span"),t,"title",!0,!0).setCustomUpdate(function(e,t){e.attr("data-tlabel",t||""),d.toggle(!!t)})),l.push(new View.Meta(d,t,"titleName",!1,!0).setCustomUpdate(function(e,t){t?e.attr("data-tooltip",t).addClass("cTooltip"):e.removeAttr("data-tooltip").removeClass("cTooltip")})),u.length&&l.push(new View.Meta(u,t,"premium",!0,!0)),h.length&&l.push(new View.Meta(h,t,"staff",!0,!0)),p.length&&l.push(new View.Meta(p,t,"moderator",!0,!0)),f.length&&l.push(new View.Meta(f,t,"fraud",!0,!0)),g.length&&l.push(new View.Meta(g,t,"cop",!0,!0)),k.length&&l.push(new View.ChessClockRedesign(k,t)),l.push(new View.Meta(m,t,"elo")),l.push(new View.EloChange(v,t)),l.push(new View.PlayerCountry(y,t,"Right")),l.push(new View.PlayerPicture(w,t)),l.push(new View.Score(b,t)),l.push(new View.PlayerThinking(C,s,t)),
Extend.Subscriber(r,{flipBoard:o},{afterLink:function(e){for(var t=0;t<l.length;t++)l[t].link(e.publisher)},afterUnlink:function(e){for(var t=0;t<l.length;t++)l[t].unlink(e.publisher)}}),Extend.Suspendable(r),r.onSuspend(function(){for(var e=0;e<l.length;e++)l[e].suspend()}),r.onResume(function(){for(var e=0;e<l.length;e++)l[e].resume()}),r},"undefined"==typeof View&&(View={}),View.PlayerName=function(e,t,n,i){function o(e){"b"===t?t="w":"w"===t&&(t="b"),c(e)}function r(e){var t=e.publisher.getMeta();t&&a(e,{meta:t})}function a(o,r){var a="w"===t?"White":"Black";r=r.meta[a];var s=r.Link,l=r.Name,c=r.UUID;if(l&&n&&(l=n(l)),e.tooltip("reset").removeClass("ofMiniProfile position-left position-right position-top position-bottom"),void 0!==s&&""!==s.trim()){var d=jQuery("<a />").attr("href",s.replace("/en/profile/","/"+config.language()+"/profile/")),u=d.append(l);c&&e.addClass("ofMiniProfile position-horizontal").data("uuid",c)}else u=l;e.empty().append(u),s&&c?e.addMiniprofile(!0):i&&r.FideId&&e.addPlayerTournamentStatistics(i,r.FideId)}var s=this;e=jQuery(e),0===e.length&&errorHandler.error(new Error("container not found"));var l;Extend.Suspendable(s);var c=s.delegate(r);return Extend.Subscriber(s,{meta:s.delegate(a),currentGameChanged:c,flipBoard:o},{afterLink:function(e){l=e.publisher,r(e)}}),s.onResume(function(e){e&&l&&r({publisher:l})}),s},"undefined"==typeof View&&(View={}),View.PlayerPicture=function(e,t){function n(e){"b"===t?t="w":"w"===t&&(t="b"),i(e)}function i(e){var t=e.publisher.getMeta();return t&&o(e,{meta:t}),a}function o(n,i){var o=i.meta[l[t]].Picture;if(o&&("/"===o.substr(0,1)&&"//"!==o.substr(0,2)&&(o=config.assetDir()+o),o!==s)){if(!o)return void e.hide();c.attr("src",o),e.show()}}var r,a=this;e=jQuery(e);var s,l={w:"White",b:"Black"};0===e.length&&errorHandler.error(new Error("container not found"),{container:e});var c=e.children("img");c.length||(c=jQuery("<img />").appendTo(e)),Extend.Suspendable(a);var d=a.delegate(i);return Extend.Subscriber(a,{meta:a.delegate(o),currentGameChanged:d,flipBoard:a.delegate(n)},{afterLink:function(e){r=e.publisher,d(e)}}),a.onResume(function(e){e&&r&&i({publisher:r})}),a},"undefined"==typeof View&&(View={}),View.PlayerThinking=function(e,t,n){function i(e){n=Chess.colors.invert(n),d(e)}function o(e){a=e.publisher,r(e,e.publisher.getClockInformation())}function r(e,i){var o=void 0!==i.timeSpendInThisMove&&!e.publisher.isOver()&&n===e.publisher.getEndOfMainlinePosition(!0).moveRight;o&&c.html(formatTime(i.timeSpendInThisMove)),t.toggleClass("active",o)}var a,s=this;e=jQuery(e),e.length&&t.length||errorHandler.error(new Error("container not found for View.PlayerThinking"));var l=jQuery((new Handler.Template).render("playerThinking")).appendTo(e),c=l.children("span");Extend.Suspendable(s);var d=s.delegate(o);return Extend.Subscriber(s,{clock:s.delegate(r),gameStatusChanged:d,currentGameChanged:d,flipBoard:s.delegate(i)},{afterLink:d}),s.onResume(function(e){e&&a&&o({publisher:a})}),s},"undefined"==typeof View&&(View={}),View.PlayingPageTitle=function(){function e(e){n=e;var a=e.publisher;return r.contains(o)&&!a.isOver()?a.getEndOfMainlinePosition().moveRight===o?Handler.pageTitle.setTextWithAnimation(t("Your move")):a.getEndOfMainlinePosition()===a.getStartPosition()?Handler.pageTitle.setTextWithAnimation(t("Game started")):Handler.pageTitle.setTextWithoutAnimation(t("Waiting for opponent")):Handler.pageTitle.reset(),i}var n,i=this,o="",r=["w","b"];return Extend.Subscriber(i,{"movedPositionPointer.endOfMainline":e,gameStatusChanged:e,currentGameChanged:e},{afterLink:e}),i.setUserRole=function(t){return o=t,n&&e(n),i},i},"undefined"==typeof View&&(View={}),View.PositionDetails=function(e,t,n){function i(e,t){switch(e.channel){case"movedPositionPointer.current.jump":a(e,t);break;case"movedPositionPointer.current.previous":r(e,t);break;case"movedPositionPointer.current.next":var n=e.publisher.getCurrentGameKey();!z||I[n]&&!V?r(e,t):o(e,t);break;case"movedPositionPointer.current.endOfLine":case"movedPositionPointer.current.start":o(e,t)}}function o(e,t){var n=e.publisher;k=n;var i=n.getCurrentGameKey(),o=(t||n.getCurrentPosition()).knotId,r=i+"_"+o;return!T.isEventBased()&&jQuery("a."+r).length>0&&T.switchEventBased(!N[i]),z&&l(e,t),E}function r(e,t){var n=e.publisher;k=n;var i=n.getCurrentGameKey(),o=(t||n.getCurrentPosition()).knotId,r=i+"_"+o;return!T.isEventBased()&&jQuery("a."+r).length>0&&T.switchEventBased(N[i]===!1),E}function a(e,t){var n=e.publisher;k=n,T.switchEventBased(N[n.getCurrentGameKey()]===!1),o(e,t)}function s(e,t){var i=e.publisher;k=i;i.getCurrentGameKey();if(i&&void 0!==i.getMeta()&&(fe.find("span").html(i.getTitle()),F.bubble("collapseTitle",i.getTitle()),!W)){for(var o=[],r=i.getMeta(),a=0;a<S.length;a++){var s=S[a].replace("."," "),l=r[S[a]];if(S[a].indexOf(".")>-1){var c=S[a].split(".");l=r;for(var d=0;d<c.length;d++)l=l[c[d]]}"White.Name"==S[a]&&r.White.Elo?l+=" ("+r.White.Elo+")":"Black.Name"==S[a]&&r.Black.Elo&&(l+=" ("+r.Black.Elo+")"),s&&l&&o.push(window.t(s)+": <strong>"+l+"</strong>")}o=o.length?o.join("<br/>"):window.t("Game information not available"),ee.html(o),n.url&&(Z.next(".pgn").length||Z.after(jQuery('<div class="pgn"/>').append(jQuery("<a/>").addClass("cBtnFlexi cBtnGrey").html(window.t("Download PGN")).on("click",function(){config.level().isPremium?(Handler.tracking("pgn","news"),window.location=n.url):(Handler.tracking("pgn","newsConversion"),Dialog.conversionGoPremium("pgnDownload"))}))))}}function l(e,t){var n=e.publisher;V=!1;var i=n.getCurrentGameKey(),o=t||n.getCurrentPosition(),r=o.knotId,a=!1,s=null;if(j[i])for(var l=0;l<j[i].length;l++)if(j[i][l].contains(r)){s=l,a=!0;break}if(I[i]||!a||A[i]&&A[i].contains(s)||!z){if(I[i]){var u=j[i][O][j[i][O].length-1];x.highlightHandler.unHighlightAll();var h,p=o.moveCoords,f=L.checkAnswer(p);f.correctAnswer?(d(!0),h=o.comment||window.t("Correct!"),_.addComment(i,r,h).setEnd(i,r).refresh(),r==u?(_.setEnd(i,r),I[i]=!1,v(i)):(Q=!0,setTimeout(function(){return Q=!1,H?void(H=!1):(n.gotoNextPosition(),void(n.getCurrentPosition().knotId==u?v(i):c(e)))},P))):(d(!1),ne.hide(),ie.hide(),re.show(),h=o.comment||window.t("This is not the best move. Try again!"),_.setEnd(i,r).addComment(i,r,h).refresh())}}else I[i]=!0,g(i,s)}function c(e){var t=e.publisher,n=t.getCurrentGameKey();if(I[n])if(M=t.getCurrentPosition().childrenMoves[0],L=t.getQuestion(),M){var i=t.getCurrentPosition().knotId,o=t.getCurrentPosition().comment;_.setEnd(n,i).addComment(n,i,o).refresh(),V=!0}else v(n)}function d(e){le.removeClass("true false").addClass(e?"true":"false")}function u(){if(I[k.getCurrentGameKey()]&&!Q){var e=M.moveCoords;x.highlightHandler.highlightCellTake(e.y1+""+e.x1,"red")}}function h(){if(I[k.getCurrentGameKey()]&&!Q){var e=M.moveCoords;x.highlightHandler.unHighlightAll(),x.addArrow(e.x1,e.y1,e.x2,e.y2,!0).drawArrow()}}function p(){H=!0;var e=k.getCurrentGameKey();if(j[e]){var t=j[e][O];if(t){for(var n=function(e,t){if(e.knotId==t)return e;for(var i=0;i<e.childrenMoves.length;i++){var o=n(e.childrenMoves[i],t);if(o)return o}},i=n(k.getStartPosition(),t[0]);i&&t.contains(i.knotId);)i.comment&&_.addComment(e,i.knotId,i.comment),i=i.childrenMoves[0];if(t.length>1){var o=n(k.getStartPosition(),t[t.length-2]);o&&(L=o.getQuestion())}var r=t[t.length-1];k.gotoId(r),v(e)}}}function f(){H=!1,A[k.getCurrentGameKey()].removeByValue(O),g(k.getCurrentGameKey(),O)}function g(e,t){if(k&&j[e]){var n=j[e][t];if(n){var i=k.getCurrentGameKey(),o=k.getCurrentPosition().knotId;(e!=i||n[0]!=o)&&k.setCurrentGame(e).gotoId(n[0]),D=_.getSettings("showSideline"),_.setSettings({showSideline:!0}).removeComment(e,n[0]).setStart(e,n[0]).setEnd(e,n[0]).refresh(),B&&B.html(window.t("You will be able to see the rest of the article as soon as the exercise is resolved.")),J.hide(),te.show(),se.show(),oe.hide(),ae.hide(),re.hide(),c({publisher:k}),clearTimeout(G),x.movementHandler.activate(),T.deactivate()}}}function m(e,t){V=!1,I[e]=!1,k&&j[e]&&(te.hide(),J.show(),_.setStart(e).setEnd(e).setSettings({showSideline:D}).refresh(),T.activate(),C())}function v(e){A[e]?A[e].push(O):A[e]=[O],se.hide(),N[e]?(J.show(),T.activate()):ae.show(),clearTimeout(G),G=setTimeout(function(){x.movementHandler.activate(),x.movementHandler.deactivate()},1e3),oe.show(),V=!1}function y(){var e=k.getCurrentGameKey();if(k&&I[e]){var t=k.getCurrentPosition().knotId;re.hide(),ne.show(),ie.show(),k.gotoParentPosition(),_.removeComment(e,t).setEnd(e,k.getCurrentPosition().knotId).refresh(),V=!0}}function w(e){var t=jQuery(".exercise-"+O),n=j[e]&&j[e][O]?j[e][O][0]:null;if(null!==n){_.setEnd(e,n).addComment(e,n,"Start of exercise.").refresh(),t.hide().nextUntil(".widgetcontainer,p:has(.widgetcontainer)").hide().end();var i=t.filter("a").first().show(),o=i.closest("p").show(),r=o.clone(!0).insertBefore(o);R[e]=o.hide(),i=r.find(i.attr("class").replace(/(^| )/g,"."));for(var a=i.get(0);a.nextSibling;)a.parentNode.removeChild(a.nextSibling);var s=jQuery("<a/>").html("Start exercise").on("click",function(){g(e,O)}),l=jQuery("<a/>").html("Skip exercise").on("click",function(){p(),N[e]===!1&&m(e,O)});B=jQuery("<p/>").addClass("exercise-prompt").html("This is where the exercise starts. ").append(s).append(". ").append(l),o.after(B)}}function b(e,t){for(var n=0;n<t.length;n++)for(var i=null,o=0;o<t[n].length;o++){var r=jQuery("a.jump-to-link."+e+"_"+t[n][o]);!i&&r.length&&(i=r),r.addClass("exercise-"+n).closest("p").addClass("exercise-"+n)}}function C(){if(B){var e=k.getCurrentGameKey();R[e]&&(B.prev().show().prev().remove(),R[e]=null),B.remove()}jQuery(".exercise-"+O).show().nextAll().show(),O++,w(e)}var k,F,x,T,_,E=this,S=["Event","Site","Date","Round","White.Name","Black.Name","Result","ECO","Annotator","EventCountry","White.Team","Black.Team"],j={},I={},A={},O=0,M="",P=1e3,B=null,R={},L=null,N={},D=!1,Q=!1,H=!1,G=null,V=!1,U=!0,z=!!n.interactive,W=n.text,$=!!n.hideMeta,q=jQuery(e);0===q.length&&errorHandler.msg("error",new Error("container not found"),!0,{container:q}),Extend.Subscriber(E,{"movedPositionPointer.current":i,move:o,currentGameChanged:s,meta:s},{afterLink:function(e){x.link(e.publisher),T.link(e.publisher),_.link(e.publisher),o(e),s(e);var t=new View.AutoPlay(ce.find(".btnAutoPlay")).link(k);x.movementHandler&&t.link(x.movementHandler),z&&x.movementHandler.setPremove(!1)},afterUnlink:function(e){return k=null,x.unlink(e.publisher),T.unlink(e.publisher),_.unlink(e.publisher),E}}),E.setExercises=function(e,t,n){return j[e]=t,O=0,N[e]=n,z?(x.movementHandler.deactivate(),n?(T.switchEventBased(!1).setRange(e,t[0][0],t[0][t[0].length-1]),k&&k.setCurrentGame(e).gotoId(t[0][0]),I[e]=!0,g(e,0)):(b(e,t),w(e),k&&l({publisher:k}),T.switchEventBased(!0))):k&&l({publisher:k}),pe.find(".tabNav li").removeClass("current").last().addClass("current"),pe.find("#tab-meta").addClass("hide"),pe.find("#tab-notation").removeClass("hide"),E},E.setNoExercises=function(){z&&x.movementHandler.activate()},E.getBubble=function(){return F},E.toggleActive=function(e){T.takeOverEvents(e)},E.toggleTools=function(e){U="undefined"==typeof e?!U:e,K[U?"removeClass":"addClass"]("simple"),F.css("min-width","")};var K=jQuery("<div/>").addClass("chess-bubble").appendTo(q),Y=jQuery("<div/>").addClass("popup-board-board").appendTo(K),J=jQuery("<div/>").addClass("popup-board-cursor").appendTo(K),X=jQuery("<div/>").addClass("popup-notation"),Z=jQuery("<div/>").addClass("popup-meta nativeScroll"),ee=jQuery("<div/>").addClass("nativeScrollInsider").appendTo(Z).html(W||""),te=jQuery("<div/>").addClass("exercise-buttons").appendTo(K),ne=(jQuery("<a/>").addClass("button-blue").html(window.t("Rotate")).appendTo(te).on("click",function(){x.flip()}),jQuery("<a/>").addClass("button-blue").html(window.t("Hint")).appendTo(te).on("click",u)),ie=jQuery("<a/>").addClass("button-blue").html(window.t("Show move")).appendTo(te).on("click",h),oe=(jQuery("<a/>").addClass("button-blue").html(window.t("Solution")).appendTo(te).on("click",p),jQuery("<a/>").addClass("button-blue").html(window.t("Try again")).hide().appendTo(te).on("click",f)),re=jQuery("<a/>").addClass("button-blue").html(window.t("Go back")).hide().appendTo(te).on("click",y),ae=jQuery("<a/>").addClass("button-blue").html(window.t("Continue")).hide().appendTo(te).on("click",function(){m(k.getCurrentGameKey(),O)}),se=te.find("a"),le=jQuery("<div/>").addClass("exercise-status").appendTo(K),ce=jQuery("<b/>").addClass("cTooltipBox position-top onClick burgerMenu").append('<a class="cBtnRound cIcon cIconBurger"></a>').append(jQuery('<span class="cTooltipBoxContainer"/>').append(jQuery("<ul/>").append(jQuery("<li/>").append(jQuery('<a class="flipBoard cIcon cIconFlipBoard" data-pattern-icon="true"><span>'+window.t("Flip board")+"</span></a>").on("click",function(){x.flip()}))).append(jQuery("<li/>").append(jQuery('<a class="playPosition cIcon cIconPosition" data-pattern-icon="true"><span>'+window.t("Play this position")+"</span></a>").on("click",function(){if(k){var e=k.getClockInformation(),t={clock:{white:e.runningUp?0:e.white.timeLeft,black:e.runningUp?0:e.black.timeLeft},increment:e.runningUp?0:e.white.incrementPerMove||e.black.incrementPerMove||0,fen:k.toString()};new Dialog.Engine(t)}}))).append(jQuery("<li/>").append(jQuery('<a class="settings cIcon cIconSettings" data-pattern-icon="true"><span>'+window.t("Settings")+"</span></a>").on("click",function(){(new Dialog.PlayzoneSettings).getContent().modal("show")}))).append(jQuery("<li/>").append(jQuery('<a class="btnAutoPlay cIcon cIconSoundPlay" data-pattern-icon="true"><span>'+window.t("Autoplay")+"</span></a>"))))).insertBefore(J),de=$;if(t){var ue=0;for(var he in t)if(t[he]instanceof Chess.Game&&(ue++,ue>1)){de=!0;break}}var pe=jQuery("<div/>").addClass("tabsWrap popup-tabs tabsStyleRounded").appendTo(K).append($?"":jQuery('<ul class="tabNav"/>').append('<li class="tabIcon iconInfo'+(de?"":" current")+'"><a data-tab-content-id="tab-meta" id="meta">info</a></li>').append("<li"+(de?' class="current"':"")+'><a data-tab-content-id="tab-notation">'+window.t("moves")+"</a></li>")).append(jQuery('<div class="tabContentWrap">').append($?"":jQuery('<div id="tab-meta">').append(jQuery('<div class="tabContentInsider">').append(Z)).addClass(de?"hide":"")).append(jQuery('<div id="tab-notation"'+($?' class="fullheight"':"")+">").append(jQuery('<div class="tabContentInsider">').append(X)).addClass(de?"":"hide"))).wrapTabs({speed:200}),fe=jQuery("<div/>").append("<span/>").addClass("popup-meta-title").appendTo(K);if(t instanceof Object){for(var ge in t)N[ge]=!0;var me,ve=jQuery("<a/>").html(window.t("Select game")).on("click",function(){if(!me){me=jQuery("<ul/>").addClass("chess-bubble-choosegame");for(var e in t){k.hasGame(e)||k.addGame(e,t[e]);var n=jQuery("<a/>").html(t[e].getTitle()).on("click",function(e){return function(){k&&(k.setCurrentGame(e).gotoStart(),me.bubble("hide"),T.switchEventBased(!1))}}(e));me.append(jQuery("<li/>").append(n))}me.bubble({side:"bottom",align:ve,point:"precise",flexible:!0})}"none"!=me.closest(".bubble").css("display")?me.bubble("hide"):me.bubble("show")}).appendTo(fe).before(" ")}return F=K.bubble({side:"bottom",point:"precise",x:q.offset().left,persistent:!0,collapsable:!0}),setTimeout(function(){K.bubble("detach").css("z-index",4).bubble("show").bubble("hide"),q.css({height:F.height()+"px"})},100),x=new View.ChessBoard(Y,!!z),x.resize(Y.width()),T=new View.Cursor(J,t&&t.length>0),_=new View.NotationArea(X,"positionDetails"),F.css("min-width",q.width()+"px"),pe.find(".tabNav a").one("click",function(){setTimeout(function(){jQuery(document).trigger("newhtml")},500)}),E},"undefined"==typeof View&&(View={}),View.ResignButton=function(e){function n(){void 0!==s&&(s.modal("hide",!0),s=void 0)}function i(e){function n(){var e="resign"!==c;l.removeClass("active"),l.off("click.resign"),Handler.tracking("playzone",c),i.emit("abortOrResign",{abort:e})}var i=e.publisher;if(void 0===i)return o;if(!(i instanceof Chess.Game||i instanceof Chess.GameHandler))return o;var a=!!i.getMeta().TournamentUUID;if(!a&&i.getDepth()<3){l.html(t("Abort"));var c="abort"}else l.html(t("Resign")).show(),c="resign";return l.closest(".drawResignButtons").toggleClass("noAbort","abort"===c),i.isOver()?(l.removeClass("active"),l.off("click.resign"),s&&s.modal("hide",!0)):(l.addClass("active"),l.off("click.resign").on("click.resign",function(){s=Dialog.confirmation(t(r[c]),n)})),o}var o=this,r={resign:"Are you sure you want to resign the current game?",abort:"Are you sure you want to abort the current game?"},a=new Handler.Template("playZone");e=jQuery(e),0===e.length&&errorHandler.msg("error",new Error("container not found"),!0,{container:e}),Extend.Subscriber(o,{"movedPositionPointer.current":n,"movedPositionPointer.endOfMainline":i,gameStatusChanged:i,currentGameChanged:i},{afterLink:function(e){i(e)}}),e.html(a.render("resignButton"));var s,l=e.find(".resign");return o},"undefined"==typeof View&&(View={}),View.Score=function(e,t){function n(e){t=e,s="w"===t?"white":"black"}function i(e){"b"===t?n("w"):"w"===t&&n("b"),d(e,e.publisher.getGameStatus())}function o(e){return r(e,e.publisher.getGameStatus()),l}function r(t,n){var i=n.result[s];return.5===i&&(i="&frac12;"),void 0===i?(c.removeClass("withScore"),void e.empty()):(c.addClass("withScore"),void e.html(i))}var a,s,l=this;e=jQuery(e);var c=e.parent();0===e.length&&errorHandler.error(new Error("container not found in View.Score"),{container:e}),Extend.Suspendable(l);var d=l.delegate(r);return Extend.Subscriber(l,{currentGameChanged:l.delegate(o),gameStatusChanged:d,flipBoard:i},{afterLink:o}),l.onResume(function(e){e&&a&&o({publisher:a})}),n(t),l},"undefined"==typeof View&&(View={}),View.SidebarAdvertisementRotation=function(e,t){function n(){jQuery.getJSON("/api/web/AdvertisementAPI/getSidebarAdds",{channel:t,language:config.language(),level:config.level().toString()},function(e){a=e.data.advertisements,a.length&&(a=a.sort(function(){return.5-Math.random()}),i())})}function i(){clearTimeout(o),r.html(a[s].content),o=setTimeout(function(){++s>=a.length&&(s=0),i()},1e3*l)}var o,r=jQuery(e),a=[],s=0,l=30;return r.length||errorHandler.error(new Error("container not found"),{container:r}),n(),this},"undefined"==typeof View&&(View={}),View.Sound=function(e){function t(){["capture","castling","check","move","negative","neutral","positive","start"].forEach(function(e){n(e,{"audio/mp3":e+".mp3","audio/ogg":e+".oga","audio/mp4":e+".m4a"})})}function n(e,t){var n=[];for(var i in t)t.hasOwnProperty(i)&&n.push({type:i,url:assetsBasePath+p+"/"+g+"/"+t[i]});soundManager.destroySound(e),soundManager.createSound({id:e,url:n,autoLoad:!0,autoPlay:!1,volume:window.settings.getNumber("game-sounds-volume")})}function i(e,t){0===t.getStartPosition().countChildrenMoves()&&a("start")}function o(e,t){if("finished"===t.status){var n="neutral";"w"===c&&1===t.result.white||"b"===c&&1===t.result.black?n="positive":("w"===c&&0===t.result.white||"b"===c&&0===t.result.black)&&(n="negative"),a(n)}}function r(e,t){if(!f)return d;var n="move";t.positionFlags.check?n="check":t.hasTakenPiece?n="capture":["O-O","O-O-O"].contains(t.getSan())&&(n="castling"),a(n)}function a(e){u.some(function(e){return window.settings.getBoolean(h+e)})&&soundManager.play(e,{volume:window.settings.getNumber("game-sounds-volume")})}function s(){f=!0}function l(){f=!1}if(e||errorHandler.error("missing context in Sound View"),View.Sound.instance)return View.Sound.instance.addContext(e),View.Sound.instance;var c,d=this,u=[],h="game-sound-category-",p="/sounds",f=window.settings.getBoolean("game-sounds"),g=window.settings.get("game-sounds-theme");if(!g)return errorHandler.msg("error",new Error("no sound theme defined"),!1),d;Extend.Suspendable(d);var m={"sound.on":d.delegate(s),"sound.off":d.delegate(l),"movedPositionPointer.current.next":d.delegate(r),gameStatusChanged:d.delegate(o),startPlayZoneGame:d.delegate(i)};return Extend.Subscriber(d,m),void 0===soundManager&&errorHandler.msg("critical",new Error("Can't find soundManager"),!0),soundManager.defaultOptions={stream:!1},soundManager.setup({url:config.assetDir()+"/images/swf",flashVersion:9,useHTML5Audio:!0,preferFlash:!1,html5Only:!1,debugMode:!1,stream:!1,onready:t}),window.settings.on("settings.game-sounds",function(){f=window.settings.getBoolean("game-sounds")}),window.settings.on("settings.game-sounds-theme",function(e,n){g=n.value||g,t()}),d.setUserRole=function(e){return c=["w","b"].contains(e)?e:void 0,d},d.addContext=function(e){return!e||u.contains(e)?d:(u.push(e),d)},d.addContext(e),View.Sound.instance=d,d},"undefined"==typeof View&&(View={}),View.SpectatorList=function(e){function t(e){s=e.publisher,o()}function n(e,t){if(!c.children("li."+t.uuid).length)if(t.registered){var n=g.render("spectatorLine",t);d.before(n),o()}else h.contains(t.uuid)||(h.push(t.uuid),o())}function i(e,t){c.children("li."+t.uuid).remove(),h.removeByValue(t.uuid),o()}function o(){var e=c.children("li.spectator").length||h.length,t=s&&!s.isOver();p.hide(),f.hide(),c.hide(),t?e?e&&c.show():f.show():p.show(),h.length?(d.show(),c.children("li.spectator").length?u.show():u.hide(),d.children(".count").html(h.length),h.length>1?(d.children(".singular").hide(),d.children(".plural").show()):(d.children(".singular").show(),d.children(".plural").hide())):d.hide()}function r(e,t){c.children("li.spectator").remove(),h=[];for(var i in t)t[i].uuid=i,n(e,t[i])}var a=this;e=jQuery(e);var s,l=e.find(".nativeScrollInsider"),c=l.children("ul"),d=c.children("li.guests"),u=d.children(".connector"),h=[],p=e.find(".emptyGameOver"),f=e.find(".emptyNoSpectators");e.length&&c.length&&d.length&&u.length||errorHandler.msg("error",new Error("container not found"),!0,{container:e}),Extend.Subscriber(a,{spectatorJoin:n,spectatorLeave:i,spectatorUpdate:r,currentGameChanged:t,gameStatusChanged:t},{afterLink:function(e){(e.publisher instanceof Chess.Game||e.publisher instanceof Chess.GameHandler)&&t(e)}});var g=new Handler.Template("playZone").append(new Handler.Template);return a},"undefined"==typeof View&&(View={}),View.ActivityStream=function(e,t,n){function i(e){var i=l?l.find("li").length:0;jQuery.getJSON(h+"list",{type:t,offset:i,language:config.language(),topics:n},function(t){var i=t.data.items;if(!i.length)return void e(!1);i.forEach(function(e){e.content=r(e)}),$.isArray(n)&&(i=i.filter(function(e){return-1!==n.indexOf(e.storyTopicPermalink)}));var o=u.render("list",{items:i});l?l.append(jQuery(o).contents()):(d.empty().append(o),l=d.find(".activityStream")),s(),e(!0)})}function o(e){return"community"==e.topic&&"comment"==e.action&&(e.comment=jQuery(e.comment).find("script").remove().end().text().ellipsis({length:100})),e}function r(e,i){if(e=o(e),!$.isArray(n)||-1!==n.indexOf(e.storyTopicPermalink)){var r=u.render(t+"."+e.action,e);if(!i)return r;var a=u.render("item",Object.merge(e,{content:r}));if(l)l.prepend(jQuery(a));else{var c=u.render("list",{items:[Object.merge(e,{content:r})]});d.empty().append(c),l=d.find(".activityStream")}s()}}function a(e){d.find("#"+e.uuid).remove()}function s(){l.find(".formatTimeAgo").showAge(),l.find(".ofMiniProfile").addMiniprofile()}var l,c=this,d=jQuery(e),u=new Handler.Template("activity").append(new Handler.Template),h="/api/web/activityStreamAPI/";if(!d.length)return void errorHandler.msg("error",new Error("no container given"),!0);var p="channel:"+t+":"+config.language(),f="channel:revoke:"+t+":"+config.language();return Extend.Subscriber(c,{},{afterLink:function(e){e.publisher.subscribe(p).on(p,function(e,t){r(t.content,!0)}),e.publisher.subscribe(f).on(f,function(e,t){a(t.content)})}}),d.lazyload({distance:200,onstart:i}),c},"undefined"==typeof View&&(View={}),View.AdvertisementOverlay=function(e,t){function n(){t.removeOverlay(),f||r()}function i(){var e=[],i=config.level().toString();if("guest"==i&&(i="guests"),g.forEach(function(t,n){if(parseInt(t.active,10)&&parseInt(t["show_"+i],10)){var o=t.nextShow;(!o||o<Date.now())&&e.push(n)}}),e.length>0){var o=e[Math.randomBetween(0,e.length-1)],a=g[o],s=jQuery(p.render("overlay",g[o]));if(s.find(".trigger").on("click",function(e){return Handler.tracking("advertisement","overlayClick",a.title),e.stopPropagation(),!0}),s.on("click",function(){s.find(".trigger").get(0).click()}),!t.attachOverlay(s))return void r();clearTimeout(l),l=setTimeout(n,u),a.nextShow=Date.now()+1e3*a.min_timeout,Handler.tracking("advertisement","overlayShow",a.title),s.find(".close").on("click",function(e){return f=!0,n(),e.stopPropagation(),e.preventDefault(),!1})}else r()}function o(e,t){t=t.content;var n=g.find(function(e){return e.uuid==t.uuid});n?Object.extend(n,t):g.push(t),a||s||f||r()}function r(e){clearTimeout(s),s=setTimeout(i,e&&c||d)}var a,s,l,c=12e4,d=3e5,u=9e4,h=this,p=new Handler.Template("advertisement"),f=!1;t instanceof View.VideoSimple||errorHandler.error(new Error("provided view is not View.Video"),{video:t});var g=[],m="channel:advertisement:overlay:"+config.level()+":"+config.language(),v={};return v[m]=o,Extend.Subscriber(h,v,{afterLink:function(e){e.publisher.subscribe(m)}}),jQuery.getJSON("/api/web/advertisementAPI/getOverlays",{language:config.language(),id:e,level:config.level().toString()}).done(function(e){g=e.data&&e.data&&e.data.advertisements,g&&r(!0)}),h},"undefined"==typeof View&&(View={}),View.ChallengeButton=function(e,t,n,i,o){function r(e,t){function n(t){var n=t.user,i=n.online===!0&&n.canChallenge===!0;i===!0?n.challenge?a(e,n.challenge):s():l()}return config.level().isGuest?(s(),p.on("click.challenge",function(){goToNewHouseChallenge(t.user.name)}),h):(t?n(t):u(n),h)}function a(e,t){playzone2Link||p.html(b.cancelChallenge).removeClass("cBtnInactive").off("click.challenge").on("click.challenge",function(){c(e,t)})}function s(){p.html(b.challenge).removeClass("cBtnInactive").off("click.challenge").on("click.challenge",d)}function l(){p.html(b.challenge).addClass("cBtnInactive").off("click.challenge")}function c(e,t){jQuery.post(m+"/gameCancel",jQuery.extend({challenge:t},v)).done(function(e){r()})}function d(){u(function(e){e.myData.reachedChallengeLimit?config.level().isGuest?Dialog.conversionRegister("challenge"):Dialog.conversionGoPremium("challenge"):goToNewHouseChallenge(e.user.name)})}function u(e){jQuery.getJSON(g+"/getMiniprofile?userUUID="+t).done(function(t){e(t.data)})}i=i||{},o=o!==!1;var h=this,p=jQuery(e),f="channel:online",g="/api/web/UserAPI",m="/api/web/ChallengeAPI";0===p.length&&errorHandler.msg("error",new Error("container not found"),!0,{container:p});var v={csrf:config.csrf()},y={},w=f+":"+t;y[w]=function(e){r(e)};var b={challenge:i.challenge||"Challenge me!",cancelChallenge:i.cancelChallenge||"Cancel challenge"};for(var C in b)b[C]=window.t(b[C]);return o?Extend.Subscriber(h,y,{afterLink:function(e){e.publisher.subscribe(w),r(e,n),e.publisher.on("game_challenge",function(e,n){n.content.toUuid===t&&("sent"===n.content.action&&a(e,n.content.challenge),("cancelself"===n.content.action||"accept"===n.content.action||"cancel"===n.content.action||"decline"===n.content.action)&&s())})},afterUnlink:function(e){e.publisher.off("game_challenge")}}):(h.link=function(){return h},h.unlink=function(){return h},s()),h},"undefined"==typeof View&&(View={}),View.Challenge=function(e,n){function i(e,t){t&&t.content&&("request"===t.content.action?s(t):"cancel"===t.content.action?l(t):"decline"===t.content.action?h(t):"accept"===t.content.action?Handler.singleTab("challenge-"+t.content.challenge,function(){p(t)}):"sent"===t.content.action?f(t):"cancelself"===t.content.action?c(t):"declineself"===t.content.action?d(t):"acceptself"===t.content.action&&u(t))}function o(){E.removeClass("active"),E.find(".sidebarMenuContent").hide()}function r(){return E.find(".sidebarMenuContent").is(":visible")}function a(e,t,n){I=Math.max(0,I+(t||0)),A=Math.max(0,A+(e||0)),O=Math.max(0,O+(n||0)),j.html(O||"")[O?"show":"hide"](),E[I||A?"addClass":"removeClass"]("activeChallenges").attr("data-incoming",I).attr("data-outgoing",A),Handler.pageTitle.updateNotification(n)}function s(e){if(r()){a(0,1,0),e.content.unseen=!0,e.content.userOnline=!0;var t=k(e.content,"itemIncoming");E.find("section ul").prepend(t),E.find(".noChallangesToShow").hide()}else a(0,1,1)}function l(e){a(0,-1,e.content.unseen?-1:0),r()&&(E.find("#challenge-"+e.content.challenge).remove(),E.find("section li").length||E.find(".noChallangesToShow").show())}function c(e){a(-1,0,0),E.find("#challenge-"+e.content.challenge).remove(),E.find("section li").length||E.find(".noChallangesToShow").show()}function d(e){a(0,-1,0),r()&&(E.find("#challenge-"+e.content.challenge).remove(),E.find("section li").length||E.find(".noChallangesToShow").show())}function u(e){a(0,-1,0),r()&&(E.find("#challenge-"+e.content.challenge).remove(),E.find("section li").length||E.find(".noChallangesToShow").show())}function h(e){a(-1,0,0),r()&&(E.find("#challenge-"+e.content.challenge).remove(),E.find("section li").length||E.find(".noChallangesToShow").show())}function p(e){if(a(-A,0,0),e.content.immediate&&1===parseInt(e.content.immediate,10))r()&&o(),Controller.getPlayZone().playNow();else{r()&&E.find("#challenge-"+e.content.challenge+", section li").remove();var n=jQuery(S.render("dialogs.challengeAccepted",{userName:e.content.userName,clock:e.content.clock/6e4,increment:e.content.increment&&e.content.increment/1e3,rated:e.content.rated&&"rated"||"unrated",ratedString:e.content.rated&&t("rated")||t("unrated"),role:e.content.role}));Dialog.confirmation({content:t("{user} accepted your challenge",{"{user}":'<a href="'+e.content.userUrl+'">'+e.content.userName+"</a>"}),comment:n},{label:t("Go to game"),callback:function(){jQuery.post("/api/web/challengeAPI/gameResolve",jQuery.extend({challenge:e.content.challenge},R)).done(Controller.getPlayZone().playNow)}},{label:t("Close")})}}function f(e){var t=1-(e.content.cancelled?e.content.cancelled.length:0);if(a(t,0,0),r()){if(E.find("section ul").prepend(k(e.content,"itemOutgoing")),e.content.cancelled)for(var n=0;n<e.content.cancelled.length;n++)E.find("#challenge-"+e.content.cancelled[n]).remove();E.find(".noChallangesToShow").hide()}}function g(e){jQuery.post("/api/web/challengeAPI/gameAccept",jQuery.extend({challenge:e},R),function(e){0===e.status&&Controller.getPlayZone().playNow()})}function m(e){jQuery.post("/api/web/challengeAPI/gameDecline",jQuery.extend({challenge:e},R),function(t){0===t.status&&(E.find("#challenge-"+e).remove(),E.find("section li").length||E.find(".noChallangesToShow").show(),jQuery(document).trigger("newhtml"))})}function v(e){jQuery.post("/api/web/challengeAPI/gameCancel",jQuery.extend({challenge:e},R),function(e){0===e.status&&(E.find("section li").length||E.find(".noChallangesToShow").show(),jQuery(document).trigger("newhtml"))})}function y(e){return jQuery.post("/api/web/challengeAPI/gameResolve",jQuery.extend({challenge:e},R))}function w(){jQuery.post("/api/challengeAPI/gameCancelAll",R,function(e){0===e.status&&(E.find("section li").remove(),E.find("section li").length||E.find(".noChallangesToShow").show())})}function b(){jQuery.post("/api/challengeAPI/gameDeclineAll",R,function(e){0===e.status&&(E.find("section li").remove(),E.find("section li").length||E.find(".noChallangesToShow").show())})}function C(e){return e.find("li").add(e.filter("li")).each(function(){var e=jQuery(this),t=e.data("challenge");e.find("a.decline").on("click",function(){m(t)}),e.find("a.accept").on("click",function(){jQuery(this).is(".cBtnInactive")||g(t)}),e.find("a.cancel").on("click",function(){v(t)}),new View.Online(e,"1"==e.data("online"),e.data("uuid")).link(notificationHandler)}),e.find("a.ofMiniProfile").addMiniprofile(),e.find("a.cancelAll").add(e.filter("a.cancelAll")).on("click",w),e.find("a.declineAll").add(e.filter("a.declineAll")).on("click",b),e}function k(e,t,n){var i=jQuery.extend({},e);i.custom&&i.custom.clockWhite&&i.custom.clockBlack?i.custom.clockWhite!=i.custom.clockBlack?i.clock=window.t("{white} vs. {black}",{"{white}":F(i.custom.clockWhite),"{black}":F(i.custom.clockBlack)}):i.clock=F(i.custom.clockWhite):i.clock=F(i.clock),
i.increment/=1e3,i.color=window.t("w"===i.color?"white":"b"===i.color?"black":"random"),i.rated=window.t(parseInt(i.rating,10)?"rated":"unrated"),i.userOnline=i.userOnline?1:0;var o=S.render(t,i);return n?o:C(jQuery(o))}function F(e){return window.t(e%6e4>0?"{minutes}m {seconds}s":"{minutes}m",{"{minutes}":Math.floor(e/6e4),"{seconds}":e/1e3%60})}function x(e){for(var t=[],n=0,i=0,o=0;o<e.length;o++){var r=e[o].incoming?"itemIncoming":"itemOutgoing";t.push(k(e[o],r,!0)),e[o].incoming?n++:e[o].outgoing&&i++}a(i-A,n-I,-O);var s=jQuery(S.render("list",{items:t}));return C(s)}function T(){E.find(".section").addClass("loading"),E.find(".noChallangesToShow").hide(),jQuery.post("/api/web/challengeAPI/getGameChallenges",R,function(e){if(0===e.status){E.find("section").removeClass("loading").toggleClass("noscrolling",e.data.challenges.length<=3),E.find("section .nativeScrollInsider").html("").append(x(e.data.challenges)),e.data.playing&&(E.find("section .warning").show(),E.find("a.accept").addClass("cBtnInactive"));var t=E.find("section .nativeScrollInsider .incoming").length>0&&E.find("section .nativeScrollInsider .outgoing").length>0;t?E.find(".challengesFilter").show():E.find(".challengesFilter").hide(),E.find("input:radio").off("change.challenges").on("change.challenges",function(){var e=jQuery(this).data("filter");"all"===e?E.find("section li").show():"outgoing"===e?(E.find("section li.incoming").hide(),E.find("section li.outgoing").show()):(E.find("section li.incoming").show(),E.find("section li.outgoing").hide())}),0===E.find("section li").length?E.find(".noChallangesToShow").show():E.find(".noChallangesToShow").hide(),jQuery(document).trigger("newhtml")}})}var _=this,E=jQuery(e);if(!E.length)return void errorHandler.msg("error",new Error("no container given"),!0);var S=new Handler.Template("challenges").append(new Handler.Template),j=E.find(".notiBox"),I=parseInt(E.data("incoming"),10),A=parseInt(E.data("outgoing"),10),O=parseInt(j.text(),10)||0,M=E.find("> a"),P=jQuery(n),B=P.data("challenge");B&&P.find(".playNowLink").on("click",function(){y(B)});var R={csrf:config.csrf()};return a(0,0,0),Handler.pageTitle.updateNotification(parseInt(j.text(),10)),Extend.Subscriber(_,{game_challenge:i}),M.on("click",T),_},"undefined"==typeof View&&(View={}),View.ConversionSidebar=function(e){function t(e,t){t&&t.content&&void 0!==t.content.html&&i.html(t.content.html)}var n=this,i=jQuery(e);i.length||errorHandler.error(new Error("container not found"),{container:i});var o="channel:conversionSidebar:"+config.level().toString()+":"+config.language(),r={};return r[o]=t,Extend.Subscriber(n,r,{afterLink:function(e){e.publisher.subscribe(o)}}),n},"undefined"==typeof View&&(View={}),View.Flash=function(e){function t(e,t){if(config.user().uuid===t.templateData.user_uuid){var i=jQuery(a.render("types_flashMessage",t.templateData));o.append(i),i.find(".closeFlashMessageBtn").on("click",function(){n(this)}),i.css("margin-top","-"+i.outerHeight()+"px");var s=o.find(".flashMessage").length,l=0;o.find(".flashMessage").each(function(e,t){jQuery(t).css("z-index",s-e),l+=jQuery(t).outerHeight()}),i.transition({"margin-top":"0px"},500),jQuery(".pageContent").stop().animate({"margin-top":r+l+"px"},500)}}function n(e){var t=jQuery(e).parents(".flashMessage");t.transition({"margin-top":"-"+t.outerHeight()+"px"},500,function(){t.remove()});var n=parseInt(jQuery(".pageContent").css("margin-top"));jQuery(".pageContent").transition({"margin-top":n-t.outerHeight()+"px"},500)}var i=this,o=jQuery(e);if(!o.length)return void errorHandler.msg("error",new Error("container for flash messages was not found"),!0);Extend.Subscriber(i,{flash:t});var r=parseInt(jQuery(".pageContent").css("margin-top")),a=new Handler.Template("notifications");return i},"undefined"==typeof View&&(View={}),View.GameSessionList=function(e,t){function n(){d.children("tr").each(function(e,t){var n=jQuery(t);n.find(".ofMiniProfile").addMiniprofile()}),i()}function i(){0===d.children("tr").length?d.append(f):f.remove(),0!==h.length&&h.html(d.children("tr").not("tr.noItem").length)}function o(e,t){x.push(t.content)}function r(){for(;x.length;){var e=x.shift();s(e.gameSessionToken,e.data)}}function a(e){if(!y){var t=jQuery(p.render("gameSessionList.item",{player:{white:{profileUrl:!0,attributes:{title:{code:"GM"},staff:!0,premium:!0,moderator:!0,fraud:!0,cop:!0}}}}));y=t.find(".attributeTitle"),w=t.find(".attributeStaff").get(0).outerHTML,b=t.find(".attributeModerator").get(0).outerHTML,C=t.find(".attributeFraud").get(0).outerHTML,k=t.find(".attributeCop").get(0).outerHTML,F=t.find(".attributePremium").get(0).outerHTML}return e.nick=e.nick.ellipsis({pixels:178,css:{"font-style":"italic","font-size":"13px"},append:(e.attributes.title?y.clone().html(e.attributes.title.code).get(0).outerHTML:"")+(e.attributes.staff?w:"")+(e.attributes.moderator?b:"")+(e.attributes.fraud?C:"")+(e.attributes.cop?k:"")+(e.attributes.premium?F:"")||!1}),e}function s(e,t){if(0===d.children("tr.gameSession_"+e).length){a(t.player.white),a(t.player.black),t.gameTime=t.player.white.base?60*t.player.white.base+40*t.player.white.increment:99999;var n=jQuery(p.render("gameSessionList.item",t));n.find(".ofMiniProfile").addMiniprofile(),u.trigger("chess24:add",n.fadeIn("slow")),i()}}function l(e,t){var n=d.children("tr.gameSession_"+t.content.gameSessionToken);n.length&&(u.trigger("chess24:remove",n),i())}var c=this,d=jQuery(e).children("tbody"),u=d.closest("table"),h=jQuery(t);0===d.length&&errorHandler.msg("error",new Error("View.GameSessionList: container not found"),!0,{container:d});var p=new Handler.Template("lobby").append(new Handler.Template),f=jQuery(p.render("gameSessionList.noItem")),g="channel:gameSession:add",m="channel:gameSession:remove",v={};v[g]=o,v[m]=l;var y,w,b,C,k,F,x=[];return setInterval(r,3e3),Extend.Subscriber(c,v,{afterLink:function(e){e.publisher.subscribe(g),e.publisher.subscribe(m),n()}}),c},"undefined"==typeof View&&(View={}),View.Notifications=function(e){function t(){$.get(g+"getNotificationsNumber").done(function(e){var t=parseInt(e.data.notificationsNumber,10);E.html(Math.max(0,t)),1>t?E.hide():E.show()}).fail(function(){_.removeClass("loading").html(window.t("Messages couldn't be loaded")).show(),C=!1,E.hide()})}function n(){var e=parseInt(E.text(),10);F&&(e=Math.max(0,e-F),Handler.pageTitle.updateNotification(-F),F=0),E.text(e)[e>0?"show":"hide"]()}function i(e,t){if(!C){var i=T.find("li").length;v=f.find(".nativeScroll"),y=v.find(".nativeScrollInsider"),_.html("").addClass("loading").show(),C=!0;var r={offset:e,lang:config.language()};jQuery.get(g+"getNotifications",r,function(e){_.removeClass("loading").hide();var r=!1;if(e.data.notifications.length){var l="",c=!1;r=!0;for(var d=0;d<e.data.notifications.length;d++)l+=o(e.data.notifications[d])||"",c=c||!!e.data.notifications[d].unvisited;T.append(l).expandEmoticons().show(),_.html("").hide(),jQuery(document).trigger("newhtml"),y=v.find(".nativeScrollInsider"),s(),T.find("li").data("unseen",!1),c&&S.show()}else 0===i&&(T.hide().html(""),_.html(window.t("There are no messages for you")).show());t&&t(r),n(),C=!1,b=!0,t||a()}).fail(function(){_.removeClass("loading").html(window.t("Messages couldn't be loaded")).show(),C=!1})}}function o(e,t){if(r(e)){if(k.contains(e.id)){var n=T.find("[data-id="+e.id+"]");n.data("unseen")&&F--,n.remove(),k.removeByValue(e.id)}F+=e.unseen||t?1:0,k.push(e.id);var i=w.render("types_"+e.template,e.data),o=w.render("notification",{unvisited:e.unvisited,id:e.id,frontend:!!e.frontend,body:i,url:e.data.url});return t&&(jQuery(o).expandEmoticons().data("unseen",!!e.unseen).prependTo(T),e.unvisited&&S.show()),o}}function r(e){if("badgeNotification"===e.template)Handler.tracking("badge",e.data.message.en||"Undefined badge"),e.data.message=e.data.message[config.language()],e.data.image=e.data.image[config.language()];else if(["playzoneTournamentToastCancel","playzoneTournamentToastFinish","playzoneTournamentToastInvite"].contains(e.template))e.data.tournamentName="object"==typeof e.data.tournamentName&&e.data.tournamentName[config.language()]||e.data.tournamentName;else if(["commentReplied","commentLiked"].contains(e.template))e.data.users=e.data.users.reverse(),e.data.users.length>3&&(e.data.other=e.data.users.length-2);else if(["broadcast","broadcast:guest","broadcast:registered","broadcast:premium"].contains(e.template)){if(e.data.message&&(e.data.message=e.data.message[config.language()],e.data.url=e.data.url[config.language()],e.data.linkname=e.data.linkname[config.language()]),!e.data.message)return!1;e.template="broadcast"}return!0}function a(){y.lazyload({distance:250,onstart:function(e){i(T.find("li").length,e)}})}function s(){T.find("a.delete").on("click",function(){return jQuery(this).off("click"),c(jQuery(this).closest("li").data("id")),!1}),T.find(".liTime").showAge()}function l(e,t){var i=T.find("li[data-id="+e+"]");if(i.length&&(i.data("unseen")&&F--,i.off().css("padding-bottom",0).animate({height:0},200,function(){i.remove(),0===T.find("li").length&&_.html(window.t("There are no messages for you")).show()})),t){var o=parseInt(E.text(),10);E.html(Math.max(0,o-1)),Handler.pageTitle.updateNotification(-1)}n()}function c(e){var t=jQuery.extend({id:e},x);l(e),jQuery.post(g+"deleteNotification",t)}function d(e,t){var n=jQuery.extend(t,x);jQuery.post(g+"deleteNotificationByReference",n,function(e){if(0===e.status){var t=e.data.id,n=e.data.unseen;l(t,n)}})}function u(e,t){switch(t.content.template){case"messageReceived":if(conversationHandler.isConversationsDisplayed(t.content.data.conversationId,t.content.data.reference_uuid))return void setTimeout(function(){c(t.content.id)},500)}var n=F;if(o(t.content,!0)){_.hide(),T.show();var i=F-n;if(jQuery(document).trigger("newhtml"),v=f.find(".nativeScroll"),y=v.find(".nativeScrollInsider"),s(),h())T.find("li").data("unseen",!1);else if(i){var r=parseInt(E.text(),10)||0;E.text(r+1).show(),Handler.pageTitle.updateNotification(1)}}}function h(){return f.find(".sidebarMenuContent").is(":visible")}var p=this,f=jQuery(e),g="/api/web/NotificationsAPI/";if(!f.length)return void errorHandler.msg("error",new Error("no container given"),!0);var m="channel:broadcast:"+config.level();Extend.Subscriber(p,{toast:u,deleteNotification:d},{afterLink:function(e){e.publisher.subscribe(m).on(m,u)}});var v,y,w=new Handler.Template("notifications"),b=!1,C=!1,k=[],F=0,x={csrf:config.csrf()},T=f.find(".nativeScrollInsider ul").hide(),_=f.find(".nativeScrollInsider .message").hide(),E=f.find(".notiBox");f.find("> a").on("click",function(){b?n():i()});var S=f.find("a.markAllAsRead").on("click",function(){S.is(".disabled")||(S.addClass("disabled"),jQuery.post(g+"allRead",{csrf:config.csrf()}).done(function(){S.removeClass("disabled")}),T.find("li").data("unseen",!1).filter(".unvisited").removeClass("unvisited"),F=0,E.empty().hide(),S.hide())}).hide();return t(),p},"undefined"==typeof View&&(View={}),View.OnlineUserCount=function(e,t){function n(){i(void 0,{count:t})}function i(e,n){n&&n.count?r.html(n.count.toString()):r.html(t)}t=t||0;var o=this,r=jQuery(e);0===r.length&&errorHandler.msg("error",new Error("View.OnlineUserCount: container userOnlineCount not found"),!0,{container:r});var a="channel:online:users:count",s={};return s[a]=i,Extend.Subscriber(o,s,{afterLink:function(e){e.publisher.subscribe(a),n()}}),o},"undefined"==typeof View&&(View={}),View.OnlineUserList=function(e,t){function n(){s.children("tr").each(function(e,t){var n=jQuery(t),i=n.find("td > a.challenges"),o=i.data("uuid"),r=i.data("miniprofile");n.find(".ofMiniProfile").addMiniprofile(),f.challenge[o]=new View.ChallengeButton(i,o,r,g,!1).link(notificationHandler),f.online[o]=new View.Online(n,!0,o).link(notificationHandler)}),i()}function i(e){0===s.children("tr").length?s.append(d):d.remove(),0!==l.length&&l.html(s.children("tr").not("tr.noItem").length)}function o(e,t){var n=t.content.userUUID;if(n!==config.user().uuid&&0===s.children("tr.userOnline_"+n).length){var o=jQuery(c.render("onlineUserList.item",t.content.data)),r=o.find("td > a.challenges");o.find(".ofMiniProfile").addMiniprofile();var a=JSON.betterParse(t.content.data.miniprofile);f.challenge[n]=new View.ChallengeButton(r,n,a,g,!1).link(notificationHandler),f.online[n]=new View.Online(o,!0,n).link(notificationHandler),s.append(o),i()}}function r(e,t){var n=t.content.userUUID,o=s.children("tr.userOnline_"+n);o.remove(),i(),f.challenge[n].unlink(notificationHandler),f.online[n].unlink(notificationHandler),delete f.challenge[n]}var a=this,s=jQuery(e).children("tbody"),l=jQuery(t);0===s.length&&errorHandler.msg("error",new Error("View.OnlineUserList: container userOnlineList not found"),!0,{container:s});var c=new Handler.Template("lobby"),d=jQuery(c.render("onlineUserList.noItem")),u="channel:user:online",h="channel:user:offline",p={};p[u]=o,p[h]=r;var f={challenge:{},online:{}};Extend.Subscriber(a,p,{afterLink:function(e){e.publisher.subscribe(u),e.publisher.subscribe(h),n()}});var g={challenge:"Challenge",cancelChallenge:"Cancel"};return a},"undefined"==typeof View&&(View={}),function(){var e={};View.Online=function(t,n,i){function o(t,n){return"online"===n.content.action?(e[i]=!0,a.removeClass("offline").addClass("online")):"offline"===n.content.action&&(e[i]=!1,a.removeClass("online").addClass("offline")),r}var r=this,a=jQuery(t),s="channel:online";0===a.length&&errorHandler.msg("error",new Error("container not found"),!0,{container:a});var l={},c=s+":"+i;return l[c]=o,e[i]=n||!1,Extend.Subscriber(r,l,{afterLink:function(e){e.publisher.subscribe(c);var t=n?"online":"offline";o(e,{content:{action:t}})}}),r},View.Online.getState=function(t){return e[t]}}(),"undefined"==typeof View&&(View={}),View.RunningGamesCount=function(e){function t(){e.html(l)}function n(){l++,t()}function i(){l>=1&&(l--,t())}var o=this;e=jQuery(e),0===e.length&&errorHandler.msg("error",new Error("View.GameSessionList: container not found"),!0,{container:e});var r="channel:gameSession:add",a="channel:gameSession:remove",s={};s[r]=n,s[a]=i;var l=e.data("count");return Extend.Subscriber(o,s,{afterLink:function(e){e.publisher.subscribe(r),e.publisher.subscribe(a),t()}}),o},"undefined"==typeof View&&(View={}),View.TopActivePlayers=function(e,t){function n(e,t){t.content.data&&o(t.content.data)}function i(e,t){r(),a.on(l[e],n),a.subscribe(l[e]),t&&jQuery.getJSON("/api/web/PlayzoneAPI/topActivePlayers",{type:e}).done(function(e){o(e.data.data)}),r=function(){a.off(l[e],n),a.unsubscribe(l[e])}}function o(t){t&&t.forEach(function(e){["link","streamUrl"].forEach(function(t){e[t]="object"==typeof e[t]?e[t][config.language()]:e[t]})});var n=c.render("topPlayers",{players:t});e.html(n),layout.userMiniprofile(e)}function r(){}var a,s=this,e=jQuery(e),l={bullet:"channel:topPlayers:bullet:update",blitz:"channel:topPlayers:blitz:update",classic:"channel:topPlayers:classic:update"};0===e.length&&errorHandler.msg("error",new Error("View.TopActivePlayers: container not found"),!0,{container:e});var c=new Handler.Template("lobby").append(new Handler.Template);return t.each(function(){var e=jQuery(this),n=e.data("type"),o=e.find("a");o.on("click",function(){t.removeClass("active"),jQuery(this).parent().addClass("active"),i(n,!0)})}),Extend.Subscriber(s,{},{afterLink:function(e){a=e.publisher,i("blitz")}}),s},"undefined"==typeof View&&(View={}),View.TopGame=function(e,t){function n(e,t,n){d[t]&&e.token==d[t].token||(d[t]=Object.copy(e),d[t].type=t,a(d[t].player.white),a(d[t].player.black),l.find("div."+t).html(c.render("topGamesItem",d[t])),l.find("ul.topGamesSwitch ."+t+" a").removeClass("disabled"),l.find(".ofMiniProfile").addMiniprofile(),n||l.is(":visible")||r(t))}function i(e){h.forEach(function(t){var i=u+t;e.subscribe(i).on(i,function(e,i){i.content.data&&n(i.content.data,t)})})}function o(){l.html(c.render("topGames")).hide();var e=l.find("ul.topGamesSwitch");e.find("a").on("click",function(){var t=jQuery(this);if(!t.is(".disabled")){var n=t.closest("li");if(!n.is(".active")){var i=n.attr("class");e.find("li.active").removeClass("active"),n.addClass("active"),l.find("div.bullet, div.blitz, div.classic").hide(),l.find("div."+i).show()}}})}function r(e){l.show(),l.find("div."+e).show(),l.find("li."+e).addClass("active")}function a(e){e.nick=e.nick.ellipsis({pixels:b-20,css:{"font-style":"italic","font-size":"14px"},append:(e.attributes.title?f.clone().html(e.attributes.title).get(0).outerHTML:"")+(e.attributes.staff?m:"")+(e.attributes.moderator?v:"")+(e.attributes.fraud?y:"")+(e.attributes.cop?w:"")+(e.attributes.premium?g:"")||!1})}var s=this,l=jQuery(e);0===l.length&&errorHandler.msg("error",new Error("View.TopGame: container not found"),!0,{container:l});var c=new Handler.Template("lobby").append(new Handler.Template),d={},u="channel:gameSession:topgame:",h=["bullet","blitz","classic"];Extend.Subscriber(s,{},{afterLink:function(e){if(i(e.publisher),o(),t)if(Object.forEach(t,function(e,t){e&&n(e,t,!0)}),t.blitz)var a="blitz";else t.bullet?a="bullet":t.classic&&(a="classic");a?r(a):l.hide()}});var p=jQuery(c.render("topGamesItem",{player:{black:{attributes:{premium:!0,title:{code:"GM"},staff:!0,moderator:!0,fraud:!0,cop:!0}}}})),f=p.find(".attributeTitle"),g=p.find(".attributePremium").get(0).outerHTML,m=p.find(".attributeStaff").get(0).innerHTML,v=p.find(".attributeModerator").get(0).innerHTML,y=p.find(".attributeFraud").get(0).innerHTML,w=p.find(".attributeCop").get(0).innerHTML,b=l.width();return s},"undefined"==typeof View&&(View={}),View.TournamentSchedule=function(e,t){function n(e,t,n){return Object.filter(n,function(n,i){return i>=e&&t>=i})}function i(){return Math.floor(this.clock/6e4)}var o=this;if("object"!=typeof t)return e.addClass("disabled"),o;e=jQuery(e);var r=e.children("ul");r.length||errorHandler.error(new Error("container>ul not found in View.TournamentSchedule"));var a=new Date;a.setTime(a.getTime()-36e5*a.getHours()-6e4*a.getMinutes()-1e3*a.getSeconds()-a.getTime()%1e3),a=a.getTime();var s=new Date(a-1+864e5).getTime(),l=new Handler.Template("playZone"),c=n(a,s,t);if(!Object.getLength(c))return e.addClass("disabled"),o;for(var d=0;24>d;d++){var u=new Date(a).setHours(d),h=new Date(new Date(a).setHours(d+1)-1).getTime(),p=n(u,h,t),f=Object.getLength(p)?Object.find(p,function(){return!0}):null;r.append(l.render("tournaments.dailyTournamentSchedule",{formatedTime:d.toString().lpad("0",2)+":00",activeTournament:f,formatedClock:i}))}return e.show(),o},"undefined"==typeof View&&(View={}),View.UserMoveMode=function(e,t){function n(){for(var e=f.getCurrentPosition(),t=e;t.parentMove&&"local"===t.getSource();)t=t.parentMove;return e!==t&&f.setCurrentPosition(t),s}function i(e){return o(e,e.publisher.getCurrentPosition())}function o(e,t){r(e,{value:t.getSource(),position:t})}function r(t,n){clearTimeout(a),a=setTimeout(function(){"local"===n.value?(1===h&&p++,e.removeClass(l),u=!0,window.settings.set(c,1),0===h&&e.show("slide",d),h=1):u?0!==h&&(e.hide("slide",d),h=0):2!==h&&(e.show("slide",d).addClass(l),h=2)})}var a,s=this,l="introducting",c="game-made-own-move",d={direction:"top"===t?"down":"left"};e=jQuery(e);var u=window.settings.getBoolean(c),h=0,p=0;e.on("click",n),e.length||errorHandler.error("container not found for userMoveMode");var f;return Extend.Subscriber(s,{"movedPositionPointer.current":o,"position.source.current":r,currentGameChanged:i},{afterLink:function(e){f=e.publisher,i(e)}}),s},"undefined"==typeof View&&(View={}),View.VideoExercises=function(e,t,n,i,o,r,a,s){function l(){if(jQuery(".btnEbook").on("click",function(){M.modal("hide"),window.location=jQuery("#linkedEbookUrl").val()}),Extend.Subscriber(x,{triggerExerciseGroup:d,triggerEndOfVideo:b}),M.on("chess24:hide",C),a&&M.find(".buyVideoSeries").on("click",function(){M.modal("hide")}),M.find(".btnIconShareGame a").shareButtons({noLabel:!0,noIcon:!0,facebook:!0,twitter:!0,google:!1,mail:!1,embed:!1}),n.bind("resume",w),jQuery(".learnRestartVideoBtn").on("click",function(){return k(),M.modal("hide"),!0}),!t||0===t.length)return c(),!0;for(var e=[],o=0;o<t.length;o++){for(var r={groupIndex:o,number:o+1,exercises:[]},s=0;s<t[o].length;s++)r.exercises.push({exerciseIndex:s});e.push(r)}var l=P.render("exerciseGroups",{groupsInfo:e});B.html(l),B.find(".exerciseGroupTabButton").on("click",function(){return jQuery(this).hasClass("disabled")?!1:void m(this.getAttribute("data-group-index"))}),F=B.find(".timelineExerciseBtn"),i.after(F)}function c(){O=!0,I.remove()}function d(e,i){if(O)return errorHandler.msg("error",new Error("Exercise group was triggered, but no exercise groups defined"),!1,{data:i}),!1;if(T[i.groupIndex])return!0;A[i.groupIndex]=i.time;var o=B.find(".exerciseGroupTabButton.tabBtn"+i.groupIndex),r=B.find(".exerciseGroupContent.exerciseGroup"+i.groupIndex);_[i.groupIndex]=r,r.removeClass("disabled"),o.removeClass("disabled"),0===Object.keys(T).length&&(m(i.groupIndex),B.find(".initialExerciseGroupsText").remove());var a=t[i.groupIndex],s=u(i.groupIndex,i.time);T[i.groupIndex]=new View.VideoExercises.exerciseGroup(a,r,n,s,o,function(){x.restartExerciseGroup(i.groupIndex)}),i.userIsSeeking||h(i.groupIndex,i.time)}function u(e,t){var n=P.render("exerciseKnobOnVideo"),o=jQuery(n);return E[e]=o,o.css("left",p(t)+"%"),i.append(o),o.css("left",parseInt(o.css("left"))-o.width()/2),o.on("click",function(t){g(e)}),o}function h(e,t){f(),F.on("click",function(){g(e)});var n=jQuery(jQuery(".exerciseKnobOnVideo").get(e)),i=parseInt(n.css("left"))-F.width()/2+parseInt(n.width())/2;F.css("left",i),F.show(),S=setTimeout(function(){f()},j)}function p(e){var t=n.video.duration,i=100*e/t;return i}function f(){F.hide(),F.off("click"),S&&(clearTimeout(S),S=null)}function g(e){m(e),f(),I.trigger("click"),v()}function m(e){y(),_[e].removeClass("hidden"),B.find(".exerciseGroupTabButton.tabBtn"+e).addClass("open")}function v(){n.pause(),jQuery("html, body").animate({scrollTop:i.offset().top-70},1e3,"easeOutCubic")}function y(){for(var e in _)_[e].addClass("hidden"),B.find(".exerciseGroupTabButton").removeClass("open")}function w(){if(a===!0&&jQuery(s).hide(),View.VideoExercises.exerciseGroup.resumedInternally===!0)return delete View.VideoExercises.exerciseGroup.resumedInternally,!1;for(var e in T)T[e].showGroupResults()}function b(){M.modal("show")}function C(){a===!0&&jQuery(s).show()}function k(){if(n.seek(.1),!O){for(var e in T)T[e].start();m(0),I.trigger("click")}}var F,x=this,T={},_={},E={},S=null,j=15e3,I=jQuery(o),A={},O=!1,M=jQuery(r).modal({classes:"customPopup",close:!0,align:jQuery(".contentContainerInsider")}),P=new Handler.Template("videoSeries"),B=jQuery(e);return 0===B.length&&errorHandler.msg("error",new Error("container not found"),!0,{container:B}),x.restartExerciseGroup=function(e){var t;if(0===e)t=0;else{var i=e-1;if(!A.hasOwnProperty(i))return!1;t=A[i]}n.seek(t)},l(),x},View.VideoExercises.exerciseGroup=function(e,t,n,i,o,r){var a,s,l,c="started",d="finished",u="results",h=this,p=e,f={},g={},m=new Handler.Template("videoSeries");if(t instanceof jQuery)var v=t;else{""===t&&errorHandler.msg("error",new Error("no group container given"),!0);var v=jQuery(t)}return 0===v.length&&errorHandler.msg("error",new Error("group container not found"),!0,{container:t}),h.init=function(){v.find(".continueVideo").on("click",function(){h.continueVideo()}),v.find(".restartChapter").on("click",function(){h.restartChapter()}),h.start()},h.start=function(){a=c,l=0,h.showExercise(l),s=!1,i.removeClass("undone"),i.removeClass("done"),o.removeClass("success"),o.removeClass("fail"),o.addClass("enabled"),v.find(".afterExerciseGroupDialog").hide()},h.showExercise=function(e){var t=p[e],n=v.find(".exerciseContent.exercise"+e);f[e]=n,h.showExerciseContainer(e),t.exerciseOrder=e+1+"/"+p.length;var i=PuzzleFactory(n,t);i.on("success",function(t){h.exerciseSucceded(e)}),i.on("failure",function(t){h.exerciseFailed(e)}),i.start(),g[e]=i},h.showExerciseContainer=function(e){h.hideAllExerciseContainers(),f[e].show()},h.hideAllExerciseContainers=function(){v.find(".exerciseContent").hide()},h.exerciseSucceded=function(e){h.showExerciseResult(e,!0)},h.exerciseFailed=function(e){s=!0,h.showExerciseResult(e,!1)},h.showExerciseResult=function(e,t){if(g[e].stop(),f[e].find(".puzzleSubmitBtn").remove(),h.sendExerciseResult(e,t),f[e].find(".styleWrapper").addClass(t===!0?"correct":"incorrect"),e===p.length-1)v.find(".afterExerciseGroupDialogSuccess").hide(),v.find(".afterExerciseGroupDialogError").hide(),s?(v.find(".afterExerciseGroupDialogError").show(),i.addClass("undone"),o.addClass("fail"),o.removeClass("enabled")):(v.find(".afterExerciseGroupDialogSuccess").show(),i.addClass("done"),o.addClass("success"),o.removeClass("enabled")),v.find(".afterExerciseGroupDialog").show(),a=d;else{var n=m.render("nextExerciseBtn"),r=jQuery(n);r.click(function(){l++,h.showExercise(l)}),f[e].find(".puzzleButtonContainer").append(r)}},h.sendExerciseResult=function(e,t){var n={exercise:p[e].id,result:t,answer:g[e].getAnswer(),csrf:config.csrf()};jQuery.ajax({url:jQuery('link[rel="js-exerciseresultapi-setresult"]').attr("href"),data:n,error:function(e,t,i){errorHandler.msg("error",new Error("Exercise result was not saved"),!1,{resultData:n,textStatus:t})},cache:!1,type:"POST"})},h.continueVideo=function(){h.showGroupResults(),h.hideAfterExerciseGroupDialog(),h.scrollTopAndPlay()},h.restartChapter=function(){h.hideAfterExerciseGroupDialog(),"function"==typeof r&&r(),h.scrollTopAndPlay(),h.start()},h.scrollTopAndPlay=function(){var e=!0;jQuery("html, body").animate({scrollTop:0},500,function(){return e!==!0?!0:(e=!1,View.VideoExercises.exerciseGroup.resumedInternally=!0,void(n.paused?n.play():n.trigger("resume")))})},h.hideAfterExerciseGroupDialog=function(){v.find(".afterExerciseGroupDialog").hide()},h.showGroupResults=function(){return a!==d?!1:(a=u,v.find(".puzzleButtonContainer").remove(),void v.find(".exerciseContent").show())},h.init(),h},"undefined"==typeof View&&(View={}),View.Video=function(e,t,n,i,o,r){function a(){O||(O=!0,s())}function s(){N.seek(0),Handler.tracking("video","start");var e=localStorage.getItem(showVideoSeriesInfo.video_series);if(e){var t=hmsToSecondsOnly(e);N.seek(t)}b()}function l(){L.before('<div class="clear" />'),L.addClass("videoControl gameVideoControl");var e=jQuery('<b class="cTooltipBox position-top onClick burgerMenu"/>').append(jQuery('<a class="gameVideoControlIcon cIcon cIconBurger"/>')).append(jQuery('<span class="cTooltipBoxContainer"/>').append(jQuery("<ul/>").append(jQuery("<li/>").append('<a class="flipBoard cIcon cIconFlipBoard" data-pattern-icon="true">'+window.t("flip board")+"</a>")).append(jQuery("<li/>").append('<a class="playPosition cIcon cIconPosition" data-pattern-icon="true">'+window.t("Play this position")+"</a>")).append(jQuery("<li/>").append('<a class="settings cIcon cIconSettings" data-pattern-icon="true">'+window.t("Settings")+"</a>"))));jQuery("<ul/>").append(jQuery("<li/>").append(e)).appendTo(L),layout.tooltipOnClick(e),F=new View.FlipBoard(e.find("a.flipBoard")),e.find("a.settings").on("click",function(){(new Dialog.PlayzoneSettings).getContent().modal("show")}),e.find("a.playPosition").on("click",function(){goToNewHousePlay()});var t=jQuery("<li />").appendTo(L);t.wrap("<ul />"),k=new View.Cursor(t),L.find(".chess-cursor").addClass("cursorView stylePlain"),L.find(".chess-cursor .start").attr("title",window.t("Go to first move")),L.find(".chess-cursor .prev").attr("title",window.t("Go to previous move")),L.find(".chess-cursor .next").attr("title",window.t("Go to next move")),L.find(".chess-cursor .last").attr("title",window.t("Go to last move")),L.find(".iconSettings").attr("title",window.t("Board settings")),L.find(".iconFlipBoard").attr("title",window.t("Flip board"));var n=R.find(".fp-ui");L.append('<ul class="ulPlaySet" />'),L.append('<ul class="ulSoundSet last" />'),E=n.find(".fp-play"),L.find(".ulPlaySet").append(E),E.text("Play/Resume").addClass("gameVideoControlIcon iconPlay"),E.wrap('<li style="padding: 3px 10px 0 0;"></li>');var i=n.find(".fp-timeline");L.find(".ulPlaySet").append(i),i.wrap('<li style="padding: 10px 20px 0;"><div class="timelineContainer"></div></li>');var o=n.find(".fp-time");L.find(".ulPlaySet").append(o),o.wrap("<li />"),o.children(".fp-elapsed").after('<em class="fp-seperator">/</em>');var r=n.find(".fp-volumeslider");return L.find(".ulSoundSet").append(r),r.wrap('<li style="padding: 19px 5px 0 0;" />'),_=n.find(".fp-mute"),L.find(".ulSoundSet").append(_),_.text("Mute").addClass("gameVideoControlIcon "),_.wrap("<li />"),y(),jQuery(".gameVideoControl .fp-timeline .fp-progress:after").css("left","30%"),S}function c(e,t){return e.resultingPosition?e.resultingPosition.contains(t)||e.resultingPosition.push(t):e.resultingPosition=[t],S}function d(e){switch(e.name){case"selectGame":n.setCurrentGame(e.data.gameIndex),C.setCurrentGame(e.data.gameIndex),void 0!==e.data.initialMoveId?u(e.data.initialMoveId,e):T=C.getCurrentPosition();break;case"move":C.moveSep(e.data.move,T,!0,e.data.id,"remote"),n.moveSep(e.data.move,T.knotId,!0,e.data.id,"remote"),T=C.getCurrentPosition(),c(e,T);break;case"gotoId":u(e.data.id,e);break;case"highlightSquare":var t={color:e.data.color,frame:Chess.getSquare(e.data.y,e.data.x)};C.addHighlight(t,void 0,M);break;case"unmark":var i={frame:Chess.getSquare(e.data.y,e.data.x)};C.deleteHighlight(i,void 0,M);break;case"unmarkAll":C.deleteHighlightsByType("frame",void 0,M);break;case"drawArrow":var t={color:e.data.color,line:Chess.translate.canToMove(e.data.lineAsCan)};C.addHighlight(t,void 0,M);break;case"unarrow":var i={line:Chess.translate.canToMove(e.data.lineAsCan)};C.deleteHighlight(i,void 0,M);break;case"unarrowAll":C.deleteHighlightsByType("line",void 0,M);break;case"clearAllHighlights":var o=C.getAllPositions();for(var r in o)C.setHighlights([],o[r],M);B[C.getCurrentGameKey()]=!0;break;case"triggerExerciseGroup":C.emit("triggerExerciseGroup",{groupIndex:e.data.index,time:e.time,userIsSeeking:A})}return x=e.index,I=e.index+1,S}function u(e,t){var i=!C.getPositionByKnotId(e);if(i){for(var o=n.getPositionByKnotId(e),r=[o],a=o;!C.getPositionByKnotId(a.parentMove.knotId);)r.push(a.parentMove),a=a.parentMove;for(;r.length;){var s=r.pop();if(C.move(s.moveCoords,s.parentMove.knotId,!1,s.knotId,"remote"),s.hasGlyphes()&&C.setGlyphes(s.getGlyphes(),s.knotId),s.comment&&C.setComment(s.comment,s.knotId),B[C.getCurrentGameKey()]!==!0){var l=s.getHighlights();l&&C.setHighlights(l,s.knotId,M)}for(var d=C.getPositionByKnotId(s.knotId),u=d.parentMove.childrenMoves,h=u.length-1;h>=0;h--){var p=u[h];p!==d&&p.moveCoords.isNullMove()&&C.deleteMove(p,!0)}if(d.countChildrenMoves()){var f=C.getNextFreeKnotId();C.move(Chess.getMove(0,0,0,0),d,void 0,f,"remote",!0),C.promote(f)}var g=C.getPositionByKnotId(s.knotId);c(t,g);var m=s.parentMove.childrenMoves.indexOf(s),v=g.parentMove.childrenMoves.indexOf(g);v>m&&0===m&&C.promote(g)}}var y=C.getCurrentGameKey();if(void 0===P[y]&&(P[y]=[]),void 0===P[y][e]&&(P[y][e]=e,B[y]!==!0)){var w=n.getHighlights(e);C.setHighlights(w,e,M)}C.gotoId(e),T=C.getCurrentPosition(),c(t,T)}function h(e,t,n,o){if(n.index===x&&o!==!0)return S;for(C.off("move.mainline.add.local",p),C.off("move.sideline.add.local",p),C.off("movedPositionPointer.current",f),n.index<I&&(I=0,P={},B={}),M=!0;n.index>I;)d(i[I]);return M=!1,d(n),C.on("move.mainline.add.local",p),C.on("move.sideline.add.local",p),C.on("movedPositionPointer.current",f),S}function p(e,t){return j=!0,N.playing&&N.pause(),S}function f(e,t){A=!0;for(var n=0;n<i.length;n++)if(("move"===i[n].name||"gotoId"===i[n].name)&&i[n].resultingPosition[0]===t){var o=i[n].time;break}return o&&N.seek(o),A=!1,S}function g(e,t){if(E.removeClass("iconPlay").addClass("iconPause"),Handler.tracking("video","play"),j){j=!1;var n=I-1;I=1/0,h(e,t,i[n],!0)}return S}function m(e,t,n){A=!0;for(var o=0;o<i.length&&!(i[o].time>n);o++)var r=i[o];return r&&h(e,t,r),A=!1,S}function v(){E.removeClass("iconPause").addClass("iconPlay"),Handler.tracking("video","pause")}function y(){N.muted?_.removeClass("iconUnmute").addClass("iconMute"):_.removeClass("iconMute").addClass("iconUnmute");
}function w(){C.emit("triggerEndOfVideo"),Handler.tracking("video","finished")}function b(){setInterval(function(){var e=$(".fp-elapsed").html();localStorage.setItem(showVideoSeriesInfo.video_series,e)},900)}var C,k,F,x,T,_,E,S=this,j=!1,I=0,A=!1,O=!1,M=!1,P={},B={},R=jQuery(e);0===R.length&&errorHandler.msg("error",new Error("container not found"),!0,{container:R});var L=jQuery(t);0===L.length&&(L=void 0),Extend.Subscriber(S,{"move.mainline.add.local":p,"move.sideline.add.local":p,"movedPositionPointer.current":f},{afterLink:function(e){C=e.publisher,k&&k.link(C),F&&F.link(C),T=C.getCurrentPosition()}}),R.flowplayer({playlist:[o],cuepoints:i,fullscreen:!1,embed:!1,poster:r,tooltip:!0}),R.bind("cuepoint",h).bind("seek",m).bind("resume",g).bind("pause",v).bind("mute",y).bind("finish",w).bind("init",a);var N=R.data("flowplayer");return R.find(".fp-timeline").data("api").disableAnimation(),L&&l(),S},$(function(){function e(){$(".voucherPageContent section:not(.voucherForm)").hide(),$(".voucherPageContent section div.response").empty()}$("#voucherValidate").on("submit",function(t){t.preventDefault(),e(),$(".voucherPageContent").addClass("loading"),$.post($(this).attr("action"),$(this).serializeArray()).done(function(e){if("undefined"!=typeof e.data.voucher.discount)return void $(".voucherDiscount").show();if("undefined"!=typeof e.data.voucher.addon)return void $(".voucherAddon").show();var t=e.data.voucher;if("undefined"!=typeof t.membership)return $(".voucherMembership .response").html(t.message),void $(".voucherMembership").show();if("undefined"!=typeof t.special){var n=$(".voucherSpecial .wrapper");return n.find("h4").html(t.title),n.find(".response").html(t.description),void n.parent().show()}$(".voucherVideoSeries .wrapper .videoSeriesThumb").html(t.html),$(".voucherVideoSeries .videoSeriesDesc").html(t.intro),$(".voucherVideoSeries .inline-author").html(t.author),$(".voucherVideoSeries .getItem").attr("href",t.url),$(".voucherVideoSeries").show()}).fail(function(e,t,n){var i=[];e.status>499?i.push(n):i=e.responseJSON.errors.voucher;var o=$(".voucherWrongCode"),r=o.find(".wrapper div");if(0===i.lenght)return r.html("<p>Unknown Error</p>"),void o.show();var a=$("<p>").appendTo(r);i.forEach(function(e){$("<div>").html(e).appendTo(a)}),o.show()}).always(function(){var e=$(".voucherPageContent");e.hasClass("loading")&&e.removeClass("loading")})})}),function(){Controller=Controller||{},Controller.WCC2018Page=Controller.WCC2018Page||{},Controller.WCC2018Page.News=Controller.WCC2018Page.News||{};var e=$("#language").attr("data-language");Controller.WCC2018Page.News.load=function(){var t=new Date;jQuery.get("/api/web/UserAPI/getLatestNews",{lang:e,offset:t.getTimezoneOffset()}).done(function(e){var t=new Handler.Template("wcc2018");e.data.latestNewsInfo.news.splice(0,0,e.data.latestNewsInfo.topNews);var n=t.render("news",{news:e.data.latestNewsInfo.news.slice(0,3)});$("#wcc2018LatestNews").empty().append(n).removeClass("loading")})}()}(),jQuery(function(){var e=".glide";if(0!==$(e).length){var t=".glideSliderWCC18Commentators";$(t).length>0&&new Glide(t,{gap:0,type:"carousel",startAt:0,perView:3,breakpoints:{1240:{perView:2},768:{perView:1}}}).mount();var n=".glideSliderWCC2018Timeline",i=0,o=0;jQuery("li.timeline.active")&&window.innerWidth<1240&&(i=jQuery("li.timeline.active").index(),o="center"),$(n).length>0&&new Glide(n,{gap:2,type:"slider",startAt:i,focusAt:o,perView:20,rewind:!1,bound:!0,breakpoints:{1240:{perView:15},1024:{perView:12},768:{perView:6},480:{perView:4},340:{perView:3}}}).mount()}}),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.Glide=t()}(this,function(){"use strict";function e(e){console.error("[Glide warn]: "+e)}function t(e){return parseInt(e)}function n(e){return parseFloat(e)}function i(e){return"string"==typeof e}function o(e){var t="undefined"==typeof e?"undefined":U(e);return"function"===t||"object"===t&&!!e}function r(e){return"number"==typeof e}function a(e){return"function"==typeof e}function s(e){return"undefined"==typeof e}function l(e){return e.constructor===Array}function c(t,n,i){var o={};for(var r in n)a(n[r])?o[r]=n[r](t,o,i):e("Extension must be a function");for(var s in o)a(o[s].mount)&&o[s].mount();return o}function d(e,t,n){Object.defineProperty(e,t,n)}function u(e){return Object.keys(e).sort().reduce(function(t,n){return t[n]=e[n],t[n],t},{})}function h(e,t){var n=$({},e,t);return t.hasOwnProperty("classes")&&(n.classes=$({},e.classes,t.classes),t.classes.hasOwnProperty("direction")&&(n.classes.direction=$({},e.classes.direction,t.classes.direction))),t.hasOwnProperty("breakpoints")&&(n.breakpoints=$({},e.breakpoints,t.breakpoints)),n}function p(e,n,i){var o={mount:function(){this._o=!1},make:function(t){var o=this;e.disabled||(e.disable(),this.move=t,i.emit("run.before",this.move),this.calculate(),i.emit("run",this.move),n.Transition.after(function(){(o.isOffset("<")||o.isOffset(">"))&&(o._o=!1,i.emit("run.offset",o.move)),i.emit("run.after",o.move),e.enable()}))},calculate:function(){var n=this.move,o=this.length,a=n.steps,s=n.direction,l=r(t(a))&&0!==t(a);switch(s){case">":">"===a?e.index=o:this.isEnd()?((!e.isType("slider")||e.settings.rewind)&&(this._o=!0,e.index=0),i.emit("run.end",n)):l?e.index+=Math.min(o-e.index,-t(a)):e.index++;break;case"<":"<"===a?e.index=0:this.isStart()?((!e.isType("slider")||e.settings.rewind)&&(this._o=!0,e.index=o),i.emit("run.start",n)):l?e.index-=Math.min(e.index,t(a)):e.index--;break;case"=":e.index=a}},isStart:function(){return 0===e.index},isEnd:function(){return e.index===this.length},isOffset:function(e){return this._o&&this.move.direction===e}};return d(o,"move",{get:function(){return this._m},set:function(e){this._m={direction:e.substr(0,1),steps:e.substr(1)?e.substr(1):0}}}),d(o,"length",{get:function(){var i=e.settings,o=n.Html.slides.length;return i.perView>o?0:e.isType("slider")&&"center"!==i.focusAt&&i.bound?o-1-(t(i.perView)-1)+t(i.focusAt):o-1}}),d(o,"offset",{get:function(){return this._o}}),o}function f(){return(new Date).getTime()}function g(e,t,n){var i=void 0,o=void 0,r=void 0,a=void 0,s=0;n||(n={});var l=function(){s=n.leading===!1?0:f(),i=null,a=e.apply(o,r),i||(o=r=null)},c=function(){var c=f();s||n.leading!==!1||(s=c);var d=t-(c-s);return o=this,r=arguments,0>=d||d>t?(i&&(clearTimeout(i),i=null),s=c,a=e.apply(o,r),i||(o=r=null)):i||n.trailing===!1||(i=setTimeout(l,d)),a};return c.cancel=function(){clearTimeout(i),s=0,i=o=r=null},c}function m(e,n,i){var o={apply:function(e){for(var t=0,i=e.length;i>t;t++){var o=e[t].style,r=n.Direction.value;0!==t?o[Z[r][0]]=this.value/2+"px":o[Z[r][0]]="",t!==e.length-1?o[Z[r][1]]=this.value/2+"px":o[Z[r][1]]=""}},remove:function(e){for(var t=0,n=e.length;n>t;t++){var i=e[t].style;i.marginLeft="",i.marginRight=""}}};return d(o,"value",{get:function(){return t(e.settings.gap)}}),d(o,"grow",{get:function(){return o.value*(n.Sizes.length-1)}}),d(o,"reductor",{get:function(){var t=e.settings.perView;return o.value*(t-1)/t}}),i.on(["build.after","update"],g(function(){o.apply(n.Html.wrapper.children)},30)),i.on("destroy",function(){o.remove(n.Html.wrapper.children)}),o}function v(e){if(e&&e.parentNode){for(var t=e.parentNode.firstChild,n=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&n.push(t);return n}return[]}function y(e){return e&&e instanceof window.HTMLElement?!0:!1}function w(t,n){var o={mount:function(){this.root=t.selector,this.track=this.root.querySelector(ee),this.slides=Array.prototype.slice.call(this.wrapper.children).filter(function(e){return!e.classList.contains(t.settings.classes.cloneSlide)})}};return d(o,"root",{get:function(){return o._r},set:function(t){i(t)&&(t=document.querySelector(t)),y(t)?o._r=t:e("Root element must be a existing Html node")}}),d(o,"track",{get:function(){return o._t},set:function(t){y(t)?o._t=t:e("Could not find track element. Please use "+ee+" attribute.")}}),d(o,"wrapper",{get:function(){return o.track.children[0]}}),o}function b(e,n,i){var r={mount:function(){this.value=e.settings.peek}};return d(r,"value",{get:function(){return r._v},set:function(e){o(e)?(e.before=t(e.before),e.after=t(e.after)):e=t(e),r._v=e}}),d(r,"reductor",{get:function(){var t=r.value,n=e.settings.perView;return o(t)?t.before/n+t.after/n:2*t/n}}),i.on(["resize","update"],function(){r.mount()}),r}function C(e,n,i){var o={mount:function(){this._o=0},make:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.offset=t,i.emit("move",{movement:this.value}),n.Transition.after(function(){i.emit("move.after",{movement:e.value})})}};return d(o,"offset",{get:function(){return o._o},set:function(e){o._o=s(e)?0:t(e)}}),d(o,"translate",{get:function(){return n.Sizes.slideWidth*e.index}}),d(o,"value",{get:function(){var e=this.offset,t=this.translate;return n.Direction.is("rtl")?t+e:t-e}}),i.on(["build.before","run"],function(){o.make()}),o}function k(e,t,n){var i={setupSlides:function(){for(var e=t.Html.slides,n=0;n<e.length;n++)e[n].style.width=this.slideWidth+"px"},setupWrapper:function(e){t.Html.wrapper.style.width=this.wrapperSize+"px"},remove:function(){for(var e=t.Html.slides,n=0;n<e.length;n++)e[n].style.width="";t.Html.wrapper.style.width=""}};return d(i,"length",{get:function(){return t.Html.slides.length}}),d(i,"width",{get:function(){return t.Html.root.offsetWidth}}),d(i,"wrapperSize",{get:function(){return i.slideWidth*i.length+t.Gaps.grow+t.Clones.grow}}),d(i,"slideWidth",{get:function(){return i.width/e.settings.perView-t.Peek.reductor-t.Gaps.reductor}}),n.on(["build.before","resize","update"],function(){i.setupSlides(),i.setupWrapper()}),n.on("destroy",function(){i.remove()}),i}function F(e,t,n){var i={mount:function(){n.emit("build.before"),this.typeClass(),this.activeClass(),n.emit("build.after")},typeClass:function(){t.Html.root.classList.add(e.settings.classes[e.settings.type])},activeClass:function(){var n=e.settings.classes,i=t.Html.slides[e.index];i&&(i.classList.add(n.activeSlide),v(i).forEach(function(e){e.classList.remove(n.activeSlide)}))},removeClasses:function(){var n=e.settings.classes;t.Html.root.classList.remove(n[e.settings.type]),t.Html.slides.forEach(function(e){e.classList.remove(n.activeSlide)})}};return n.on(["destroy","update"],function(){i.removeClasses()}),n.on(["resize","update"],function(){i.mount()}),n.on("move.after",function(){i.activeClass()}),i}function x(e,t,n){var i={mount:function(){this.items=[],e.isType("carousel")&&(this.items=this.collect())},collect:function(){for(var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=t.Html.slides,o=e.settings,r=o.perView,a=o.classes,s=i.slice(0,r),l=i.slice(-r),c=0;c<Math.max(1,Math.floor(r/i.length));c++){for(var d=0;d<s.length;d++){var u=s[d].cloneNode(!0);u.classList.add(a.cloneSlide),n.push(u)}for(var h=0;h<l.length;h++){var p=l[h].cloneNode(!0);p.classList.add(a.cloneSlide),n.unshift(p)}}return n},append:function o(){for(var e=this.items,n=t.Html,i=n.wrapper,r=n.slides,a=Math.floor(e.length/2),s=e.slice(0,a).reverse(),o=e.slice(a,e.length),l=0;l<o.length;l++)i.appendChild(o[l]);for(var c=0;c<s.length;c++)i.insertBefore(s[c],r[0]);for(var d=0;d<e.length;d++)e[d].style.width=t.Sizes.slideWidth+"px"},remove:function(){for(var e=this.items,n=0;n<e.length;n++)t.Html.wrapper.removeChild(e[n])}};return d(i,"grow",{get:function(){return(t.Sizes.slideWidth+t.Gaps.value)*i.items.length}}),n.on("update",function(){i.remove(),i.mount(),i.append()}),n.on("build.before",function(){e.isType("carousel")&&i.append()}),n.on("destroy",function(){i.remove()}),i}function T(e,t,n){var i=new te,o={mount:function(){this.bind()},bind:function(){i.on("resize",window,g(function(){n.emit("resize")},e.settings.throttle))},unbind:function(){i.off("resize",window)}};return n.on("destroy",function(){o.unbind(),i.destroy()}),o}function _(t,n,i){var o={mount:function(){this.value=t.settings.direction},resolve:function(e){var t=e.slice(0,1);return this.is("rtl")?e.split(t).join(ie[t]):e},is:function(e){return this.value===e},addClass:function(){n.Html.root.classList.add(t.settings.classes.direction[this.value])},removeClass:function(){n.Html.root.classList.remove(t.settings.classes.direction[this.value])}};return d(o,"value",{get:function(){return o._v},set:function(t){ne.indexOf(t)>-1?o._v=t:e("Direction value must be `ltr` or `rtl`")}}),i.on(["destroy","update"],function(){o.removeClass()}),i.on("update",function(){o.mount()}),i.on(["build.before","update"],function(){o.addClass()}),o}function E(e,t){return{modify:function(e){return t.Direction.is("rtl")?-e:e}}}function S(e,t){return{modify:function(n){return n+t.Gaps.value*e.index}}}function j(e,t){return{modify:function(e){return e+t.Clones.grow/2}}}function I(e,t){return{modify:function(n){if(e.settings.focusAt>=0){var i=t.Peek.value;return o(i)?n-i.before:n-i}return n}}}function A(e,t){return{modify:function(n){var i=t.Gaps.value,o=t.Sizes.width,r=e.settings.focusAt,a=t.Sizes.slideWidth;return"center"===r?n-(o/2-a/2):n-a*r-i*r}}}function O(t,n,i){var o=[S,j,I,A].concat(t._t,[E]);return{mutate:function(r){for(var s=0;s<o.length;s++){var l=o[s];a(l)&&a(l().modify)?r=l(t,n,i).modify(r):e("Transformer should be a function that returns an object with `modify()` method")}return r}}}function M(e,t,n){var i={set:function(n){var i=O(e,t).mutate(n);t.Html.wrapper.style.transform="translate3d("+-1*i+"px, 0px, 0px)"},remove:function(){t.Html.wrapper.style.transform=""}};return n.on("move",function(o){var r=t.Gaps.value,a=t.Sizes.length,s=t.Sizes.slideWidth;return e.isType("carousel")&&t.Run.isOffset("<")?(t.Transition.after(function(){n.emit("translate.jump"),i.set(s*(a-1))}),i.set(-s-r*a)):e.isType("carousel")&&t.Run.isOffset(">")?(t.Transition.after(function(){n.emit("translate.jump"),i.set(0)}),i.set(s*a+r*a)):i.set(o.movement)}),n.on("destroy",function(){i.remove()}),i}function P(e,t,n){var i=!1,o={compose:function(t){var n=e.settings;return i?t+" 0ms "+n.animationTimingFunc:t+" "+this.duration+"ms "+n.animationTimingFunc},set:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"transform";t.Html.wrapper.style.transition=this.compose(e)},remove:function(){t.Html.wrapper.style.transition=""},after:function(e){setTimeout(function(){e()},this.duration)},enable:function(){i=!1,this.set()},disable:function(){i=!0,this.set()}};return d(o,"duration",{get:function(){var n=e.settings;return e.isType("slider")&&t.Run.offset?n.rewindDuration:n.animationDuration}}),n.on("move",function(){o.set()}),n.on(["build.before","resize","translate.jump"],function(){o.disable()}),n.on("run",function(){o.enable()}),n.on("destroy",function(){o.remove()}),o}function B(e,i,o){var r=new te,a=0,s=0,l=0,c=!1,d={mount:function(){this.bindSwipeStart()},start:function(n){if(!c&&!e.disabled){this.disable();var i=this.touches(n);a=null,s=t(i.pageX),l=t(i.pageY),this.bindSwipeMove(),this.bindSwipeEnd(),o.emit("swipe.start")}},move:function(r){if(!e.disabled){var c=e.settings,d=c.touchAngle,u=c.touchRatio,h=c.classes,p=this.touches(r),f=t(p.pageX)-s,g=t(p.pageY)-l,m=Math.abs(f<<2),v=Math.abs(g<<2),y=(m+v)*(m+v),w=v*v;if(a=Math.asin(w/y),i.Move.make(f*n(u)),!(180*a/Math.PI<d))return!1;r.stopPropagation(),i.Html.root.classList.add(h.dragging),o.emit("swipe.move")}},end:function(n){if(!e.disabled){var r=e.settings,l=this.touches(n),c=this.threshold(n),d=l.pageX-s,u=180*a/Math.PI,h=Math.round(d/i.Sizes.slideWidth);this.enable(),d>c&&u<r.touchAngle?(r.perTouch&&(h=Math.min(h,t(r.perTouch))),i.Direction.is("rtl")&&(h=-h),i.Run.make(i.Direction.resolve("<"+h))):-c>d&&u<r.touchAngle?(r.perTouch&&(h=Math.max(h,-t(r.perTouch))),i.Direction.is("rtl")&&(h=-h),i.Run.make(i.Direction.resolve(">"+h))):i.Move.make(),i.Html.root.classList.remove(r.classes.dragging),this.unbindSwipeMove(),this.unbindSwipeEnd(),o.emit("swipe.end")}},bindSwipeStart:function(){var t=this,n=e.settings;n.swipeThreshold&&r.on(oe[0],i.Html.wrapper,function(e){t.start(e)}),n.dragThreshold&&r.on(oe[1],i.Html.wrapper,function(e){t.start(e)})},unbindSwipeStart:function(){r.off(oe[0],i.Html.wrapper),r.off(oe[1],i.Html.wrapper)},bindSwipeMove:function(){var t=this;r.on(re,i.Html.wrapper,g(function(e){t.move(e)},e.settings.throttle))},unbindSwipeMove:function(){r.off(re,i.Html.wrapper)},bindSwipeEnd:function(){var e=this;r.on(ae,i.Html.wrapper,function(t){e.end(t)})},unbindSwipeEnd:function(){r.off(ae,i.Html.wrapper)},touches:function(e){return se.indexOf(e.type)>-1?e:e.touches[0]||e.changedTouches[0]},threshold:function(t){var n=e.settings;return se.indexOf(t.type)>-1?n.dragThreshold:n.swipeThreshold},enable:function(){return c=!1,i.Transition.enable(),this},disable:function(){return c=!0,i.Transition.disable(),this}};return o.on("build.after",function(){i.Html.root.classList.add(e.settings.classes.swipeable)}),o.on("destroy",function(){d.unbindSwipeStart(),d.unbindSwipeMove(),d.unbindSwipeEnd(),r.destroy()}),d}function R(e,t,n){var i=new te,o={mount:function(){this.bind()},bind:function(){i.on("dragstart",t.Html.wrapper,this.dragstart)},unbind:function(){i.off("dragstart",t.Html.wrapper)},dragstart:function(e){e.preventDefault()}};return n.on("destroy",function(){o.unbind(),i.destroy()}),o}function L(e,t,n){var i=new te,o=!1,r=!1,a={mount:function(){this._a=t.Html.wrapper.querySelectorAll("a"),this.bind()},bind:function(){i.on("click",t.Html.wrapper,this.click)},unbind:function(){i.off("click",t.Html.wrapper)},click:function(e){e.stopPropagation(),r&&e.preventDefault()},detach:function(){if(r=!0,!o){for(var e=0;e<this.items.length;e++)this.items[e].draggable=!1,this.items[e].setAttribute("data-href",this.items[e].getAttribute("href")),this.items[e].removeAttribute("href");o=!0}return this},attach:function(){if(r=!1,o){for(var e=0;e<this.items.length;e++)this.items[e].draggable=!0,this.items[e].setAttribute("href",this.items[e].getAttribute("data-href"));o=!1}return this}};return d(a,"items",{get:function(){return a._a}}),n.on("swipe.move",function(){a.detach()}),n.on("swipe.end",function(){t.Transition.after(function(){a.attach()})}),n.on("destroy",function(){a.attach(),a.unbind(),i.destroy()}),a}function N(e,t,n){var i=new te,o={mount:function(){this._n=t.Html.root.querySelectorAll(le),this._c=t.Html.root.querySelectorAll(ce),this.addBindings()},setActive:function(){for(var e=0;e<this._n.length;e++)this.addClass(this._n[e].children)},removeActive:function(){for(var e=0;e<this._n.length;e++)this.removeClass(this._n[e].children)},addClass:function(t){var n=e.settings,i=t[e.index];i.classList.add(n.classes.activeNav),v(i).forEach(function(e){e.classList.remove(n.classes.activeNav)})},removeClass:function(t){t[e.index].classList.remove(e.settings.classes.activeNav)},addBindings:function(){for(var e=0;e<this._c.length;e++)this.bind(this._c[e].children)},removeBindings:function(){for(var e=0;e<this._c.length;e++)this.unbind(this._c[e].children)},bind:function(e){for(var t=0;t<e.length;t++)i.on(["click","touchstart"],e[t],this.click)},unbind:function(e){for(var t=0;t<e.length;t++)i.off(["click","touchstart"],e[t])},click:function(e){e.preventDefault(),t.Run.make(t.Direction.resolve(e.currentTarget.getAttribute("data-glide-dir")))}};return d(o,"items",{get:function(){return o._c}}),n.on(["mount.after","move.after"],function(){o.setActive()}),n.on("destroy",function(){o.removeBindings(),o.removeActive(),i.destroy()}),o}function D(e,t,n){var i=new te,o={mount:function(){e.settings.keyboard&&this.bind()},bind:function(){i.on("keyup",document,this.press)},unbind:function(){i.off("keyup",document)},press:function(e){39===e.keyCode&&t.Run.make(t.Direction.resolve(">")),37===e.keyCode&&t.Run.make(t.Direction.resolve("<"))}};return n.on(["destroy","update"],function(){o.unbind()}),n.on("update",function(){o.mount()}),n.on("destroy",function(){i.destroy()}),o}function Q(e,n,i){var o=new te,r={mount:function(){this.start(),e.settings.hoverpause&&this.bind()},start:function(){var t=this;e.settings.autoplay&&s(this._i)&&(this._i=setInterval(function(){t.stop(),n.Run.make(">"),t.start()},this.time))},stop:function(){this._i=clearInterval(this._i)},bind:function(){var e=this;o.on("mouseover",n.Html.root,function(){e.stop()}),o.on("mouseout",n.Html.root,function(){e.start()})},unbind:function(){o.off(["mouseover","mouseout"],n.Html.root)}};return d(r,"time",{get:function(){var i=n.Html.slides[e.index].getAttribute("data-glide-autoplay");return t(i?i:e.settings.autoplay)}}),i.on(["destroy","update"],function(){r.unbind()}),i.on(["run.before","pause","destroy","swipe.start","update"],function(){r.stop()}),i.on(["run.after","play","swipe.end"],function(){r.start()}),i.on("update",function(){r.mount()}),i.on("destroy",function(){o.destroy()}),r}function H(t){return o(t)?u(t):(e("Breakpoints option must be an object"),{})}function G(e,t,n){var i=new te,o=e.settings,r=H(o.breakpoints),a=$({},o),s={match:function(e){if("undefined"!=typeof window.matchMedia)for(var t in e)if(e.hasOwnProperty(t)&&window.matchMedia("(max-width: "+t+"px)").matches)return e[t];return a}};return $(o,s.match(r)),i.on("resize",window,g(function(){e.settings=h(o,s.match(r))},e.settings.throttle)),n.on("update",function(){r=H(r),a=$({},o)}),n.on("destroy",function(){i.off("resize",window)}),s}var V={type:"slider",startAt:0,perView:1,focusAt:0,gap:10,autoplay:!1,hoverpause:!0,keyboard:!0,bound:!1,swipeThreshold:80,dragThreshold:120,perTouch:!1,touchRatio:.5,touchAngle:45,animationDuration:400,rewind:!0,rewindDuration:800,animationTimingFunc:"cubic-bezier(0.165, 0.840, 0.440, 1.000)",throttle:10,direction:"ltr",peek:0,breakpoints:{},classes:{direction:{ltr:"glide--ltr",rtl:"glide--rtl"},slider:"glide--slider",carousel:"glide--carousel",swipeable:"glide--swipeable",dragging:"glide--dragging",cloneSlide:"glide__slide--clone",activeNav:"glide__bullet--active",activeSlide:"glide__slide--active",disabledArrow:"glide__arrow--disabled"}},U="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},z=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},W=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),$=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},q=function he(e,t,n){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,t);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:he(o,t,n)}if("value"in i)return i.value;var r=i.get;return void 0===r?void 0:r.call(n)},K=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},Y=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},J=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};z(this,e),this.events=t,this.hop=t.hasOwnProperty}return W(e,[{key:"on",value:function(e,t){if(l(e))for(var n=0;n<e.length;n++)this.on(e[n],t);this.hop.call(this.events,e)||(this.events[e]=[]);var i=this.events[e].push(t)-1;return{remove:function(){delete this.events[e][i]}}}},{key:"emit",value:function(e,t){if(l(e))for(var n=0;n<e.length;n++)this.emit(e[n],t);this.hop.call(this.events,e)&&this.events[e].forEach(function(e){e(t||{})})}}]),e}(),X=function(){function n(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};z(this,n),this._c={},this._t=[],this._e=new J,this.disabled=!1,this.selector=e,this.settings=h(V,t),this.index=this.settings.startAt}return W(n,[{key:"mount",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._e.emit("mount.before"),o(t)?this._c=c(this,t,this._e):e("You need to provide a object on `mount()`"),this._e.emit("mount.after"),this}},{key:"mutate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return l(t)?this._t=t:e("You need to provide a array on `mutate()`"),this}},{key:"update",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.settings=h(this.settings,e),e.hasOwnProperty("startAt")&&(this.index=e.startAt),this._e.emit("update"),this}},{key:"go",value:function(e){return this._c.Run.make(e),this}},{key:"move",value:function(e){return this._c.Transition.disable(),this._c.Move.make(e),this}},{key:"destroy",value:function(){return this._e.emit("destroy"),this}},{key:"play",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!1;return e&&(this.settings.autoplay=e),this._e.emit("play"),this}},{key:"pause",value:function(){return this._e.emit("pause"),this}},{key:"disable",value:function(){return this.disabled=!0,this}},{key:"enable",value:function(){return this.disabled=!1,this}},{key:"on",value:function(e,t){return this._e.on(e,t),this}},{key:"isType",value:function(e){return this.settings.type===e}},{key:"settings",get:function(){return this._o},set:function(t){o(t)?this._o=t:e("Options must be an `object` instance.")}},{key:"index",get:function(){return this._i},set:function(e){this._i=t(e)}},{key:"type",get:function(){return this.settings.type}},{key:"disabled",get:function(){return this._d},set:function(e){this._d=!!e}}]),n}(),Z={ltr:["marginLeft","marginRight"],rtl:["marginRight","marginLeft"]},ee='[data-glide-el="track"]',te=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};z(this,e),this.listeners=t}return W(e,[{key:"on",value:function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:!1;i(e)&&(e=[e]);for(var r=0;r<e.length;r++)this.listeners[e[r]]=n,t.addEventListener(e[r],this.listeners[e[r]],o)}},{key:"off",value:function(e,t){i(e)&&(e=[e]);for(var n=0;n<e.length;n++)t.removeEventListener(e[n],this.listeners[e[n]],!1)}},{key:"destroy",value:function(){delete this.listeners}}]),e}(),ne=["ltr","rtl"],ie={">":"<","<":">","=":"="},oe=["touchstart","mousedown"],re=["touchmove","mousemove"],ae=["touchend","touchcancel","mouseup","mouseleave"],se=["mousedown","mousemove","mouseup","mouseleave"],le='[data-glide-el="controls[nav]"]',ce='[data-glide-el^="controls"]',de={Html:w,Translate:M,Transition:P,Direction:_,Peek:b,Sizes:k,Gaps:m,Move:C,Clones:x,Resize:T,Build:F,Run:p,Swipe:B,Images:R,Anchors:L,Controls:N,Keyboard:D,Autoplay:Q,Breakpoints:G},ue=function(e){function t(){return z(this,t),Y(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return K(t,e),W(t,[{key:"mount",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return q(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"mount",this).call(this,$({},de,e))}}]),t}(X);return ue}),jQuery(function(){var e=$("div.gamesSchedule ul"),t=e.find("li"),n=$("div.scheduleEvents");n.find("div.eventsList").each(function(){var e=$(this),t=new Date(1e3*parseInt(e.attr("data-time")));e.attr("data-local-day",t.getDate()+"-"+t.getMonth())}),n.find("div.rawEvents").children().each(function(){var t=$(this),i=t.find(".eventTime"),o=new Date(1e3*parseInt(i.attr("data-time"))),r=o.getDate(),a=o.getHours(),s="am";a>12&&(a-=12,s="pm"),i.find(".timeHour").html(a),i.find(".timeMeridiem").html(s);var l=n.find('div.eventsList[data-local-day="'+r+"-"+o.getMonth()+'"]');l&&l.append(t);var c=e.find('li[data-day="'+l.attr("data-time")+'"]');c&&c.find(".contentHint").append('<span class="'+i.parent().attr("data-type")+'"></span>')}),e.find("li.timeline").each(function(){var e=$(this),t=new Date(1e3*parseInt(e.attr("data-day")));e.find(".gameDay-d").html(t.getDate());var n=$("#language").attr("data-language"),i=new Intl.DateTimeFormat(n,{weekday:"short"});e.find(".gameDay-e").html(i.format(t));var o=e.find(".gameCount"),r=$("#schedule-"+e.attr("data-day")+" .round");e.hasClass("tie")?o.html("Tie break"):r.length?o.html(r.attr("data-game")):(e.addClass("rest"),o.html("Rest day"))}),e.css("display","flex").hide().slideDown(250),t.on("click",function(e){t.removeClass("active");var n=$(this);n.addClass("active");var i=$("#schedule-"+n.attr("data-day"));(0===i.length||0===i.children().length)&&(i=$("#noEvents")),i.is(":visible")||($(".liveBroadcast:visible").fadeOut(100),$(".eventsList:visible").fadeOut(100),setTimeout(function(){i&&i.fadeIn(100)},100))});var i=$(".eventItem.round");i.on("click",function(e){$(".eventsList:visible").fadeOut(100);var t=$(this).attr("data-round"),n=$(this).attr("data-match"),i=$(this).attr("data-game");$.ajax({url:"/api/web/wcc2018API/loadRound",dataType:"json",data:{roundId:t,matchId:n,gameId:i},type:"GET"}).done(function(e){function o(e,t){e.attr("data-round",d.attr("data-round")),e.attr("data-match",d.attr("data-match")),e.attr("data-game",d.attr("data-game"))}function r(e,t){var n=t.attr("data-overrides"),i={};return n?(i=JSON.parse(n).video,e.attr("data-overrides",n)):e.removeAttr("data-overrides"),i}function a(){$("#wcc2018FullBroadcastId a").attr("href",c.filter("#wcc2018FullBroadcastId").find("a").attr("href"))}function s(){$("#scoreCarlsenId").text(d.attr("data-score-carlsen")),u.attr("data-score-carlsen",d.attr("data-score-carlsen")),$("#scoreCaruanaId").text(d.attr("data-score-caruana")),u.attr("data-score-caruana",d.attr("data-score-caruana"))}if(!e||!e.data||!e.data.newBroadcast)return void errorHandler.msg("error",new Error("No information for round of WCC2018"),!1);window.history.pushState("","","/"+config.language()+"/wcc2018/"+t+"/"+n+"/"+i),$("#colorCaruanaId").removeClass("white").removeClass("black").addClass(e.data.newColors.caruana),$("#colorCarlsenId").removeClass("white").removeClass("black").addClass(e.data.newColors.carlsen);var l="carlsen-caruana-world-chess-championship-2018",c=$(e.data.newBroadcast),d=c.find(".headless"),u=$(".liveTournamentContainer");a(),o(u,d),s();var h=r(u,d),p={};p.startWith=l,p.exactList=[l];var f=new Controller.Broadcast(u,{tournamentIds:p,roundId:t,matchId:n,gameId:i,embedded:!0,c24:d.data("c24"),overrides:h,customer:d.data("customer"),boardTheme:d.data("board-theme")});f.showGameWhenReady(l,t,n,i),"undefined"!=typeof u.attr("data-overrides")&&u.attr("data-overrides")?f.overrideVideo(l,h):f.resumeTournamentVideo(l),$(".liveBroadcast").fadeIn(100)}).fail(function(e){errorHandler.msg("error",new Error(e),!1)})})}),"undefined"==typeof Widgets&&(Widgets={}),Widgets.Audio=Widgets.Base().extend({properties:{"float":"none"},create:function(e,t,n){e=this.parent.create(e,t,n);var i=e.find(".sound");if(i.length){var o=jQuery.parseJSON(i.attr("data"));i.soundPlayer({url:o.url})}return e.trigger("resize"),e}}),"undefined"==typeof Widgets&&(Widgets={}),function(e){Widgets.Image?e():setTimeout(e)}(function(){Widgets.Author=Widgets.Image().extend({properties:{"float":"none",width:"auto"},create:function(e,t,n){var i=e.data("widget"),o=e.find("img");return o.attr("src")||jQuery.getJSON("/api/web/contentWidgetAPI/getImageUrl?id="+i.resources[0].reference_id,function(e){o.attr("src",e.data.url)}),e},dialog:function(e,t,n,i,o){e=this.parent.dialog(e,t,n,i,o),e.find("#author-widget-cid").val(n.formData.cid);var r=o.data("widget").resources[0].properties.title;return o&&r&&(e.find("select option[value="+r+"]").attr("selected","selected"),e.find("select").selectBox("destroy").selectBox()),e}})}),"undefined"==typeof Widgets&&(Widgets={}),Widgets.BiographyLink=Widgets.Base().extend(function(){var e;return{properties:{biography_id:null,biography_name:null,text:null},setupInEditor:function(e,t){var n=jQuery.parseJSON(e.attr("data"));e.off("dblclick").on("dblclick",function(){
t.extensions.widgets.editWidget(e)}),e.on("change",function(){var t=e.clone().find("span").remove().end().html().trim();if(n.text!==t){var i=e.data("widget");i.properties.text=t,e.attr("data-widget",jQuery.toJSON(i)),n.text=e.html(),e.attr("data",jQuery.toJSON(n))}})},setupOffEditor:function(e){},dialog:function(e,t,n,i,o){t.extensions.link&&t.extensions.link.formOptions(e,o,"biography-link");var r=e.find("[data-widget-property=text]");r.val()||r.val(o.text()),e.find("[data-auto-suggest]").on("chess24:select",function(){e.find("[data-widget-property=biography_id]").val(this.value),e.find("[data-widget-property=biography_name]").val(e.find("input.suggestField[type=text]").val())});var a=e.find("input[data-widget-property=text]");a.val()||a.val(o.clone().find("span").remove().end().html().trim())},create:function(t,n,i){n&&(e=n,t.addClass("unusual-link"));jQuery.parseJSON(t.attr("data")),t.data("widget");return n?this.setupInEditor(t,n):this.setupOffEditor(t),t}}}()),"undefined"==typeof Widgets&&(Widgets={}),Widgets.Broadcast=Widgets.Base().extend({properties:{"float":"none",type:"",c24:!1,tournamentId:"",roundId:"",matchId:""},create:function(e,t,n){function i(){var e,t=s.getAttribute(o.properties.tournamentId,"currentRound");switch(o.properties.roundId=parseInt(o.properties.roundId,10)||void 0,o.properties.type){case"OpenStandings":e=new View.OpenStandings(r,o.properties.tournamentId);break;case"OpenGames":e=new View.OpenGames(r,o.properties.tournamentId,o.properties.roundId||t,!0);break;case"TeamRoundRobin":e=new View.TeamRoundRobin(r,o.properties.tournamentId,o.properties.roundId||t);break;case"Header":var n=s.getAttribute(o.properties.tournamentId,"video");r.html(a.getTemplates().render("tournament.header",{tournamentId:o.properties.tournamentId,languages:(n||[]).map(function(e){return e.language}).unique()})),e=new View.Header(r,o.properties.tournamentId,o.properties.roundId||t);break;case"MultiBoard":e=new View.MultiBoard(r,o.properties.tournamentId,o.properties.roundId||t,o.properties.matchId||1).setItemsPerPage(6);break;case"StandingsTable":e=new View.StandingsTable(r,o.properties.tournamentId,o.properties.roundId)}e.link&&e.link(s),e.resume&&e.resume()}e=this.parent.create(e,t,n);var o=e.data("widget"),r=e.find(".broadcastWidgetContainer"),a=new Controller.Broadcast(r,{norender:!0}),s=new Controller.BroadcastTournament,l=Handler.socket.getSocket(Handler.socket.types.NOTIFICATION),c=1==o.properties.c24?"model:PlayzoneTournamentRedisAR":"model:webTournamentRedisAR",d=c+":"+o.properties.tournamentId,u={type:c,id:o.properties.tournamentId,rkey:d},h=new Record.TournamentSocketPR(u,l,function(){s.add(h,o.properties.tournamentId),i()});return e},dialog:function(e,t,n,i,o){e=this.parent.dialog(e,t,n,i,o);var r=e.find("select"),a=e.find(".selectRound"),s=e.find(".selectMatch");if(o){var l=o.data("widget");r.find("option[value="+l.properties.type+"]").attr("selected","selected"),r.selectBox("destroy").selectBox()}return r.on("change",function(){var e=r.val();a.toggle(["MultiBoard","OpenGames","TeamRoundRobin","StandingsTable"].contains(e)),s.toggle(["MultiBoard","OpenGames"].contains(e))}).trigger("change"),e}}),"undefined"==typeof Widgets&&(Widgets={}),Widgets.ChessBoard=Widgets.ChessView().extend({properties:{"float":"left",width:"648px",name:"",index:"",fen:"",highlights:""},dialog:function(e,t,n,i,o){e=this.parent.dialog(e,t,n,i,o);var r=this.chessBase;r.init(t.config.chessGames);var a=n.extensions&&n.extensions.contains("widgets(chessboard)");a&&e.find(".cBtn.back").remove();var s,l=e.find("[data-resource-property=reference_id]"),c=e.find("[data-widget-property=index]"),d=e.find("[data-widget-property=fen]"),u=e.find("[data-widget-property=highlights]");l.val()||c.val()||d.val()||d.val(Chess.defaultFen);var h=r.getGames();if(l.find("*").remove().end().append("<option/>"),h)for(var p in h)l.append(jQuery("<option/>").val(p).html(h[p].getTitle()));l.selectBox("destroy").selectBox(),l.find("option").length>1?(c.on("change",function(){c.val()&&(s.gotoId(c.val()),d.val(s.getCurrentPosition().toString(!0)))}),l.on("change",function(){var e=l.val();l.val()?(d.val(""),s.addGame(e,h[e]).setCurrentGame(e)):s.setCurrentGame("position-builder"),c.find("*").remove().end().append("<option/>");var t=r.getGame(this.value);if(t){var n=function(e,t){var n=e.getSan();n=n?("w"==e.moveRight?e.moveCounter-1+"... ":e.moveCounter+". ")+n:window.t("Top"),c.append(jQuery("<option/>").val(e.knotId).html(t+n))},i=function(e,t){n(e[0],t);for(var o=1;o<e.length;o++)n(e[o],t+"&raquo;&nbsp;"),e[o].childrenMoves&&e[o].childrenMoves.length&&i(e[o].childrenMoves,t+"&nbsp;&nbsp;&nbsp;");e[0].childrenMoves&&e[0].childrenMoves.length&&i(e[0].childrenMoves,t)},o=t.getStartPosition();o.childrenMoves&&o.childrenMoves.length?i(o.childrenMoves,""):c.append(jQuery("<option/>").val(0).html("Start")),c.selectBox("destroy").selectBox()}})):e.find(".board-game-move").hide();var f=o?o.data("widget"):null;return e=t.extensions.chess.positionBuilder(e.find(".position-builder"),f&&f.properties.fen?f.properties.fen:void 0,f&&f.properties.highlights?jQuery.parseJSON(f.properties.highlights):void 0),e.on("chess24:change",function(e,t){d.val(t.fen),u.val(jQuery.toJSON(t.highlights)),l.val("").selectBox("destroy").selectBox(),c.find("option").not(":first").remove(),c.selectBox("destroy").selectBox()}),s=e.data("handler"),f&&f.resources&&f.resources[0]&&f.resources[0].reference_id&&(l.find("option[value="+f.resources[0].reference_id+"]").attr("selected","selected").end().trigger("change").selectBox("destroy").selectBox(),f.properties&&c.find("option[value="+f.properties.index+"]").attr("selected","selected").end().trigger("change").selectBox("destroy").selectBox()),e},create:function(e,t,n){e=this.parent.create(e,t,n);var i=e.data("widget"),o=parseInt(i.properties.viewId)||0,r=this.chessBase.getView(o),a=null;if(r&&(a=this.chessBase.getControllersForView(o),this.chessBase.unlinkView(o),delete r),e.find(".chess-board").remove(),r=new View.ChessBoard(e.find(".diagram"),!1),o=this.chessBase.addView(o,r),i.resources[0]&&i.resources[0].reference_id&&i.properties.index)this.chessBase.makeStaticView(o,i.resources[0].reference_id,i.properties.index),e.find(".widget-buttons").remove();else if(i.properties.fen)try{var s=new Chess.Game({fen:i.properties.fen});this.chessBase.unlinkView(o),r.link(s);var l=i.properties.highlights;if("string"==typeof l&&l.length&&(l=jQuery.parseJSON(l)),l)for(var c=0;c<l.length;c++)l[c].square?s.addHighlight({square:Chess.getSquare(l[c].square.y,l[c].square.x),color:l[c].color}):l[c].frame?s.addHighlight({frame:Chess.getSquare(l[c].frame.y,l[c].frame.x),color:l[c].color}):l[c].line&&s.addHighlight({line:Chess.getMove(l[c].line.y1,l[c].line.x1,l[c].line.y2,l[c].line.x2),color:l[c].color})}catch(d){}else if(a){this.chessBase.unlinkView(o);for(var u=!1,c=0;c<a.length;c++)"@static"!=a[c].substr(a[c].length-7)&&(u=!0,this.chessBase.linkView(o,a[c]));u||this.chessBase.linkView(o,"main")}else this.chessBase.linkView(o,"main");this.chessBase.isStaticView(o)&&e.on("click",function(){jQuery("."+i.resources[0].reference_id+"_"+i.properties.index).trigger("click")});var h=function(t,n){var o=e.width();r.resize(o),o=r.getJQueryBoard().width(),e.css({width:o+"px",height:i.properties.name?"auto":o+"px"})};return e.on("resize",h),h(),i.properties.viewId!=o&&(i.properties.viewId=o,e.attr("data-widget",jQuery.toJSON(i))),e}}),"undefined"==typeof Widgets&&(Widgets={}),Widgets.ChessBubble=Widgets.ChessView().extend({properties:{"float":"none",width:"100%",name:"",oneexercise:!1,hidetools:!1,hideinfo:!1,text:""},dialog:function(e,t,n,i,o){return e=this.parent.dialog(e,t,n,i,o)},remove:function(e,t,n){var i=e.data("widget"),o=parseInt(i.properties.viewId)||0,r=jQuery("nothing"),a=jQuery("nothing");if(t.find("a.unusual-link").each(function(){var e=jQuery(this);try{(e.data("widget").properties.views.contains(o)||e.data("widget").properties.views.contains(""+o))&&(a=e.closest("p"),0==r.length&&(r=jQuery(a)))}catch(t){}}),!a.length||!r.length)return!1;var s=jQuery("<div/>").addClass("popupInsider").append(jQuery("<div/>").addClass("dialogContent").html(window.t("Do you want to remove only the viewer or the text too?"))).append(jQuery("<div/>").addClass("dialogFooter"));return s.find(".dialogFooter").append(jQuery("<a/>").addClass("cBtn cBtnGrey").html("The viewer").on("click",function(){s.modal("hide"),e.remove(),t.rescueOrphans()})).append(jQuery("<a/>").addClass("cBtn cBtnGrey").html("Everything").on("click",function(){var n=r.add(r.nextUntil(a)).add(a),i=a.next();if(i.length)for(var o=i.text().trim(),l=["0-1","1-0","1/2-1/2","*"],c=0;c<l.length;c++)if(o==l[c]){n=n.add(i);break}n.remove(),e.remove(),s.modal("hide"),t.rescueOrphans()})).append(jQuery("<a/>").addClass("cBtn cBtnWhite").html("Cancel").on("click",function(){s.modal("hide")})),s.modal({classes:"defaultPopup"}).modal("show"),!0},create:function(e,t,n){function i(e){e.addClass("draggable").on("mousedown.chessbubble",function(t){var n=parseInt(e.css("left"),10),i=parseInt(e.css("top"),10);jQuery(document).on("mousemove.chessbubble",function(o){var r=o.pageX-t.pageX,a=o.pageY-t.pageY;e.css({top:i+a+"px",left:n+r+"px"})}).one("mouseup",function(){jQuery(document).off("mousemove.chessbubble")}),t.stopPropagation(),t.preventDefault()})}function o(e){e.removeClass("draggable").off("mousedown.chessbubble")}function r(i){if("undefined"==typeof i&&(i=l.properties.hidetools),u.toggleTools(i),i)e.css("height","").add(e.find(".chess-bubble, .bubble")).removeClass("compact").css("width",e.parent().width()+"px").trigger("resize");else{var o=e.find(".popup-board-board");e.css("height","").add(e.find(".chess-bubble, .bubble")).addClass("compact").css("width",o.width()+2*parseInt(o.css("left"),10)+"px").trigger("resize")}t&&(l.properties.hidetools=!i,e.attr("data-widget",jQuery.toJSON(l)),e.find(".toggleTools").html(window.t(i?"Hide tools":"Show tools")),i?t.extensions.resizable.reset(e):t.extensions.resizable.index(e,{}),Widgets.Base().create(e,t,n))}e=this.parent.create(e,t,n);var a=this,s=jQuery.parseJSON(e.attr("data")),l=e.data("widget"),c=parseInt(l.properties.viewId)||0;s.oneexercise=!!l.properties.oneexercise,s.exercises=null,s.games=[];for(var d=0;d<l.resources.length;d++)l.resources[d].properties.exercises&&(s.exercises||(s.exercises={}),s.exercises[l.resources[d].reference_id]=l.resources[d].properties.exercises),s.games.push(l.resources[d].reference_id);s.games.length<2&&(s.games=null),e.attr("data",jQuery.toJSON(s));var u=this.chessBase.getView(c),h=null;u&&(e.find(".bubble").remove(),h=this.chessBase.getControllersForView(c),this.chessBase.unlinkView(c),delete u);var p=s.exercises?this.chessBase.createCopyId():void 0,f=null;if(s.games){f={};for(var d=0;d<s.games.length;d++)f[s.games[d]]=this.chessBase.getGame(s.games[d],p)}if(u=new View.PositionDetails(e,f,{interactive:!t,text:l.properties.text,hideMeta:l.properties.hideinfo,url:t?"":Handler.Template.renderString(decodeURIComponent(e.data("url")),{articleId:e.closest(".couch-content").data("cid"),widgetId:l.vid})}),c=this.chessBase.addView(c,u),h){this.chessBase.unlinkView(c);for(var d=0;d<h.length;d++)this.chessBase.linkView(c,h[d])}else f&&this.chessBase.separateView(c,Object.keys(f));if(s.exercises)for(var g in s.exercises)0==s.exercises[g]&&delete s.exercises[g];if(s.exercises&&Object.getLength(s.exercises)){var m=[];for(var g in s.exercises)m.push(g);this.chessBase.separateView(c,m,p);for(var g in s.exercises){var v=this.chessBase.getGame(g,p);if(v){for(var y=v.getStartPosition(),w=[],b=[],d=0;d<s.exercises[g].length;d++)w.push(s.exercises[g][d][0]),b.push(s.exercises[g][d][1]);for(var C=[],k=!1,F=[];y;)b.contains(y.knotId)?(F.push(y.knotId),C.push(F),F=[],k=!1,y=y.childrenMoves[0]):(w.contains(y.knotId)&&(k=!0),k&&F.push(y.knotId),y=y.childrenMoves[0]);F.length&&C.push(F),C.length&&u.setExercises(g,C,!!s.oneexercise)}}}var x=u.getBubble().appendTo(e);if(r(1!=l.properties.hidetools),t){c!=l.properties.viewId&&(l.properties.viewId=c,e.attr("data-widget",jQuery.toJSON(l))),x.css({position:"static"}).trigger("resize",!0);var T=e.find(".widget-buttons");T.find(".toolsToggle").remove(),T.append(jQuery("<a/>").addClass("toggleTools").html(l.properties.hidetools?window.t("Show tools"):window.t("Hide tools")).on("click",function(){r()}))}else{var _=function(){var e=jQuery(document).data("current-bubble");if(e){if(e==u)return;e.toggleActive(!1)}e=u,s.oneexercise||s.games&&s.games.length>1?(e.toggleActive(!0),Widgets.ChessJumpToLink().disable()):Widgets.ChessJumpToLink().enable(),jQuery(document).data("current-bubble",e)},E=jQuery(document).data("current-bubble");E||_(),Widgets.ChessJumpToLink(),x.on("mousedown",_),e.on("chess24:activate",_),e.css("z-index",x.css("z-index")),x.on("collapse expand",function(){O||e.css("height",x.height()+"px")});var S=jQuery(".widgetcontainer"),j=[];S.each(function(){"chess-bubble"==jQuery(this).data("widget").wid&&j.push(jQuery(this))});var I=jQuery(".widgetcontainer-inline"),A=e.hasClass("compact"),O=!1,M=function(t){var n=e.offset(),i=e.width(),o=e.height(),r=jQuery("div:visible,header:visible").filter(function(){var e=jQuery(this),t=e.offset();return!e.is(x)&&!e.is(x.closest(".bubble"))&&"fixed"==e.css("position")&&parseInt(e.css("top"),10)<=n.top+o&&t.left<n.left+i&&t.left+e.width()>n.left}),s=0;r.each(function(){s+=jQuery(this).outerHeight()});var l=null;I.filter(":visible").each(function(){var e=jQuery(this);if(e.attr("data")){var t=jQuery.parseJSON(e.attr("data"));"chess-jump-to-link"==t.wid&&(t.views&&(t.views.contains(c)||t.views.contains(""+c))||(!t.views||!t.views.length)&&a.chessBase.isViewLinked(c,"main"))&&(l=e)}});var d=n.top,u=d+o;if(l&&l.length&&(u=l.offset().top+l.height()),j.length>1)for(var h=0;h<j.length;h++)if(jQuery(j[h]).is(e)&&j.length-1>h){u=Math.min(u,jQuery(j[h+1]).offset().top-10);break}var p=jQuery(document).scrollTop()+s;if(A)"absolute"!=x.css("position")&&x.css({position:"absolute",left:"0",top:"0"});else if(O){var f=jQuery(document).scrollTop(),g=x.offset().top;if("fixed"==x.css("position"))d>=g?x.css({position:"absolute",top:d+"px"}):g+x.height()>=u&&x.css({position:"absolute",top:u-x.height()+"px"});else if("absolute"==x.css("position")){var m=jQuery(window).height();m/3+f>d&&u>2*m/3+f&&(x.css({position:"fixed",top:x.offset().top-f}),e.css("position","static"))}}else"fixed"==x.css("position")?x.offset().top<d?(x.removeClass("fixed").css({position:"absolute",top:d-n.top+"px",left:"0px"}),e.css("position","relative")):p+x.height()>u?(x.removeClass("fixed").css({position:"absolute",top:u-x.height()-n.top+"px",left:"0px"}),e.css("position","relative")):x.css({left:n.left+"px"}):p+x.height()<=u?p>=d?(x.addClass("fixed").css({position:"fixed",top:s+"px",left:n.left+"px"}),e.css("position","static")):parseInt(x.css("top"))>0&&x.css("top","0px"):p>=d&&x.css({top:u-x.height()-n.top+"px"})};x.css({left:"0px",top:"0px"}),jQuery(window).on("scroll resize",M),e.on("chess24:lock chess24:unlock",function(t){A="chess24:lock"==t.type||e.hasClass("compact"),e.find(".bubble-detach, .bubble-collapse, .bubble-expand").css("visibility",A?"hidden":"visible"),M()}),f||jQuery("<a/>").addClass("bubble-detach").on("click",function(){var t=jQuery(this).closest(".bubble");if(O)O=!O,e.css("height",""),o(t.appendTo(e).css({left:0,top:0,position:"absolute"})),r(!0),M();else{r(!1),O=!O,e.css("height",0);var n=t.offset().left+t.width(),a=t.offset().top-jQuery(document).scrollTop();i(t.appendTo("body").css({left:n+"px",top:a+"px",position:"fixed"})),M()}}).appendTo(e.find(".bubble-contents"))}return delete a,e}}),"undefined"==typeof Widgets&&(Widgets={}),Widgets.ChessJumpToLink=Widgets.Chess().extend(function(){var e,t=null,n=null,i={},o=!1,r=function(e){switch(document.activeElement.tagName.toLowerCase()){case"input":case"textarea":return}if(!o){o=!0,setTimeout(function(){o=!1},100);var t=Widgets.Base();switch(e.keyCode){case t.keys.VK_LEFT:jQuery(document).trigger("chess24:previousmove");break;case t.keys.VK_RIGHT:jQuery(document).trigger("chess24:nextmove");break;case t.keys.VK_UP:if(n){n.up();try{e.preventDefault(),e.stopPropagation()}catch(i){e.cancelBubble=!0,e.returnValue=!1}}break;case t.keys.VK_DOWN:if(n){n.down();try{e.preventDefault(),e.stopPropagation()}catch(i){e.cancelBubble=!0,e.returnValue=!1}}break;case t.keys.VK_ESCAPE:n&&(n.remove(),n=null);break;case t.keys.VK_RETURN:n&&(n.select(),n=null)}}},a=function(e,t){return function(){var n=jQuery.parseJSON(jQuery(this).attr("data"));return n.reference==e&&(!t||0>t&&n.index<-t||t>0&&n.index>=t)}},s=function(e,t,n){if(i[e]||i.all)return!1;var o=jQuery("."+e+"_"+t);return o.length?o.trigger("click").length>0:"forward"==n?jQuery("a.jump-to-link").filter(a(e,t)).first().trigger("click").length>0:"back"==n?jQuery(jQuery("a.jump-to-link").toArray().reverse()).filter(a(e,-t)).first().trigger("click").length>0:!1},l=function(e){if(e&&t&&t.length){var n=jQuery.parseJSON(t.attr("data"));n.reference!=e&&(t.removeClass("highlighted"),t=null)}},c=function(e){for(var t=jQuery.parseJSON(e.attr("data")),n=Widgets.Chess().chessBase,i=[],o=0;o<t.views.length;o++)for(var r=n.getControllersForView(t.views[o]),a=0;a<r.length;a++)i.contains(r[a])||i.push(n.getController(r[a]));return i.length||i.push(n.getController("main")),i},d=function(e,o){if(!i[o]&&!i.all)if(l(o),t&&t.length){var r=Widgets.Chess().chessBase,c=jQuery.parseJSON(t.attr("data"));if(o||(o=c.reference,!i[o])){if(n)return n.select(),void(n=null);var d=r.getMoveByKnotId(c.reference,c.index);if(d){var u=[];if(d.children&&d.children.length){if(1==d.children.length){var h=r.getMoveByIndex(c.reference,d.children[0]).knotId;return void s(c.reference,h,"forward")}for(var p=0;p<d.children.length;p++){var f=r.getMoveByIndex(c.reference,d.children[p]);jQuery("."+c.reference+"_"+f.knotId).length&&u.push(f)}}else for(var g=c.index;;){var m=r.getParentMoveByKnotId(c.reference,g);if(!m)break;for(var v=0;v<m.children.length&&r.getMoveByIndex(c.reference,m.children[v]).knotId!=g;v++);if(0!=v){var y=r.getMoveByIndex(c.reference,m.children[0]);if(y.children.length){if(1==y.children.length){var w=r.getMoveByIndex(c.reference,y.children[0]);return void s(c.reference,w.knotId,"forward")}for(var p=0;p<y.children.length;p++){var f=r.getMoveByIndex(c.reference,y.children[p]);jQuery("."+c.reference+"_"+f.knotId).length&&u.push(f)}break}g=m.knotId;break}g=m.knotId}if(1==u.length)s(c.reference,u[0].knotId,"forward");else if(u.length>0){for(var b=[],p=0;p<u.length;p++){var C=u[p].fen.split(" "),k=jQuery("."+c.reference+"_"+u[p].knotId).text();k=k.replace(/^\d+\.+ +/,""),k=C[5]-("w"==C[1]?1:0)+("w"==C[1]?"... ":". ")+k,b.push({id:u[p].knotId,text:k})}n=new popupList(b,function(e){s(o,e,"forward")})}else s(c.reference,parseInt(c.index)+1,"forward")}}}else if(o)jQuery("a.jump-to-link").filter(a(o)).first().trigger("click");else{var F=jQuery("a.jump-to-link:first");if(!F.length)return;if(o=jQuery.parseJSON(F.attr("data")).reference,i[o])return;F.trigger("click")}},u=function(e,o){if(!i[o]&&!i.all&&(n&&(n.remove(),n=null),l(o),t&&t.length)){var r=Widgets.Chess().chessBase,a=jQuery.parseJSON(t.attr("data"));if(o||(o=a.reference,!i[o])){var c=r.getParentMoveByKnotId(a.reference,a.index);c&&c.knotId>0?s(a.reference,c.knotId,"back")||h(e,o):h(e,o)}}},h=function(e,o){if(!i[o]&&!i.all&&(n&&(n.remove(),n=null),l(o),t&&t.length||(t=jQuery("a.jump-to-link").filter(a(o)).first(),t.length))){var r=c(t);t.removeClass("highlighted"),t=null;for(var s=0;s<r.length;s++)r[s].gotoStart()}},p=function(e,o){if(!i[o]&&!i.all&&(n&&(n.remove(),n=null),l(o),t&&t.length||(t=jQuery("a.jump-to-link").filter(a(o)).first(),t.length))){var r=c(t);t.removeClass("highlighted"),t=null;for(var s=0;s<r.length;s++)r[s].gotoEndOfLine()}},f=function(){jQuery(document).off("keydown",r).on("keydown",r).off("chess24:nextmove",d).on("chess24:nextmove",d).off("chess24:previousmove").on("chess24:previousmove",u).off("chess24:firstmove",h).on("chess24:firstmove",h).off("chess24:lastmove",p).on("chess24:lastmove",p).on("chess24:suspendmoves",function(e,t){i[t]=!0}).on("chess24:resumemoves",function(e,t){i[t]=!1})};return jQuery(function(){!jQuery("[contenteditable]").length&&jQuery(".couch-content").length&&f()}),{properties:{index:null,text:null,glyph:null,sideline:null,views:[]},disable:function(){i.all=!0},enable:function(){i.all=!1,f()},getDialogButtons:function(t){var n=this,i={};return i[window.t("Save")]=function(i){var o=jQuery.parseJSON(jQuery(t).attr("data"));o.reference=i.reference,o.index=i["properties[index]"];var r=i["properties[views][]"],a=[];if(o.views&&r)for(var s=0;s<o.views.length;s++)-1==r.indexOf(o.views[s])&&a.push(o.views[s]);else o.views&&(a=o.views);if(r){for(var s=0;s<r.length;s++)-1==o.views.indexOf(r[s])&&n.chessBase.separateView(r[s],[o.reference]);o.views=r}else o.views=[];jQuery(t).attr("data",jQuery.toJSON(o)),a.length&&n.chessBase.checkSeparatedViews(a,e),e.extensions.widgets.save(i,jQuery(t)),e.extensions.dom.setSelection(t,t)},i[window.t("Delete")]=function(i){var i=jQuery.parseJSON(jQuery(t).attr("data")),o=t.parentNode;jQuery(t).replaceWith(jQuery(t).contents()),e.extensions.dom.flatten(o),e.extensions.dom.setCursor(o,0),i.views&&n.chessBase.checkSeparatedViews(i.views,e)},i[window.t("Cancel")]=function(){e.extensions.dom.setCursor(t,0)},i},setupInEditor:function(e,t){var n=jQuery.parseJSON(e.attr("data"));e.off("dblclick").on("dblclick",function(){t.extensions.widgets.editWidget(e)}),e.on("change",function(){var t=e.clone().find("span").remove().end().html().trim();if(n.text!=t){var i=e.data("widget");i.properties.text=t,e.attr("data-widget",jQuery.toJSON(i)),n.text=e.html(),e.attr("data",jQuery.toJSON(n))}})},setupOffEditor:function(e){},setupHighlight:function(e){var n=jQuery.parseJSON(e.attr("data")).reference;e.off("highlight").on("highlight",function(){if((!t||t&&!t.is(e))&&(t&&t.removeClass("highlighted"),t=e,t.addClass("highlighted")),e.is(":visible")&&!(i[n]||i.all||e.closest(".nativeScroll").length||e.closest(".ebookScroll").length)){var o=jQuery(document).scrollTop()+jQuery(window).height()-e.offset().top-e.height(),r=0;jQuery(".widgetcontainer .bubble").each(function(){var e=jQuery(this);"fixed"==e.css("position")&&(r=Math.max(r,e.offset().top+e.height()))}),r=e.offset().top-r,50>o?jQuery("html,body").stop().animate({scrollTop:jQuery(document).scrollTop()+(50-o)},200):15>r&&jQuery("html,body").stop().animate({scrollTop:jQuery(document).scrollTop()-(15-r)},200)}})},dialog:function(e,t,n,i,o){var r=this;t.extensions.link&&t.extensions.link.formOptions(e,o,"chess-jump-to-link"),e.find("a.restore").on("click",function(){if(t.extensions.chess&&o.length>0){var e=o.attr("data");t.extensions.chess.restoreLink(o.get(0)),e&&(e=jQuery.parseJSON(e),e.views&&r.chessBase.checkSeparatedViews(e.views,t))}});var a=this.chessBase;a.init(t.config.chessGames);var s=e.find("[data-resource-property=reference_id]"),l=e.find("[data-widget-property=index]"),c=a.getGames();if(s.find("*").remove().end().append("<option/>"),c)for(var d in c)s.append(jQuery("<option/>").val(d).html(c[d].getMeta().Title));s.selectBox("destroy").selectBox(),s.on("change",function(){l.find("*").remove().end().append("<option/>");var e=a.getGame(this.value);if(e){var t=function(e,t){var n=e.getSan();n=n?("w"==e.moveRight?e.moveCounter-1+"... ":e.moveCounter+". ")+n:window.t("Top"),l.append(jQuery("<option/>").val(e.knotId).html(t+n))},n=function(e,i){t(e[0],i);for(var o=1;o<e.length;o++)t(e[o],i+"&raquo;&nbsp;"),e[o].childrenMoves&&e[o].childrenMoves.length&&n(e[o].childrenMoves,i+"&nbsp;&nbsp;&nbsp;");e[0].childrenMoves&&e[0].childrenMoves.length&&n(e[0].childrenMoves,i)},i=e.getStartPosition();n(i.childrenMoves,""),l.selectBox("destroy").selectBox()}});var u=null;if(o){var h=o.data("widget");h&&(h.resources&&h.resources[0]&&h.resources[0].reference_id&&(s.find("option[value="+h.resources[0].reference_id+"]").attr("selected","selected").end().trigger("change"),h.properties&&l.find("option[value="+h.properties.index+"]").attr("selected","selected")),u=h.properties.views)}var p=e.find(".jump-to-link-views");t.find(t.widgetmask).each(function(){var e=jQuery(this).data("widget");("chess-bubble"==e.wid||"chess-board"==e.wid)&&p.append(jQuery("<div/>").addClass("chess-view").attr("data",e.properties.viewId).append(jQuery('<input type="checkbox"/>').attr("data-widget-property","views[]").val(e.properties.viewId).attr("checked",u&&u.contains(e.properties.viewId))).append(jQuery("<div/>").html(e.properties.name)))}),jQuery(document).trigger("newhtml");var f=e.find("input[data-widget-property=text]");f.val()||f.val(o.clone().find("span").remove().end().html().trim()),jQuery(document).trigger("newhtml")},create:function(t,o,r){o&&(e=o,t.addClass("unusual-link"));var a=jQuery.parseJSON(t.attr("data")),s=t.data("widget");if(a.views=(a.views||[]).concat(s.properties.views),t.attr("data",jQuery.toJSON(a)),t.is(".sideline-0")&&t.removeClass("sideline sideline-0"),a.views){for(var l=0;l<a.views.length;l++)a.views[l]=/^\d$/.test(a.views[l])?parseInt(a.views[l]):a.views[l],this.chessBase.separateView(a.views[l],[a.reference]);t.attr("data",jQuery.toJSON(a))}return t.off("click").on("click",function(){var e=jQuery(this),t=jQuery.parseJSON(e.attr("data"));if(!i[t.reference]){t.index=parseInt(t.index);var r=c(e);!o&&t.views&&t.views.length&&jQuery(".widgetcontainer").filter(function(){return jQuery(this).data("widget").properties.viewId==t.views[0]}).trigger("chess24:activate");for(var a=0;a<r.length;a++)r[a].setCurrentGame(t.reference).gotoId(t.index);n&&(n.remove(),n=null)}}),o?this.setupInEditor(t,o):this.setupOffEditor(t),o||this.setupHighlight(t),t}}}()),"undefined"==typeof Widgets&&(Widgets={}),Widgets.EbookExercise=Widgets.Base().extend({properties:{title:""},create:function(e,t,n){return e=this.parent.create(e,t,n),e.on("click",function(){jQuery(".exercises-from-"+e.data("widget").vid).trigger("chess24:show",!0)}),e}}),"undefined"==typeof Widgets&&(Widgets={}),Widgets.EbookLink=Widgets.Chess().extend(function(){var e;return{properties:{ebook_chapter_id:null,section_id:null,text:null},setupInEditor:function(e,t){var n=jQuery.parseJSON(e.attr("data"));e.off("dblclick").on("dblclick",function(){t.extensions.widgets.editWidget(e)}),e.on("change",function(){var t=e.clone().find("span").remove().end().html().trim();if(n.text!=t){var i=e.data("widget");i.properties.text=t,e.attr("data-widget",jQuery.toJSON(i)),n.text=e.html(),e.attr("data",jQuery.toJSON(n))}})},setupOffEditor:function(e){},dialog:function(e,t,n,i,o){t.extensions.link&&t.extensions.link.formOptions(e,o,"ebook-link");var r,a,s,l;jQuery.getJSON("/api/web/ContentAPI/getEbooks",{language:n.language},function(t){r=t.data.ebooks;var n=e.find("[data-widget-property=text]");n.val()||n.val(o.text());var i=e.find("select:first"),c=e.find("[data-widget-property=ebook_chapter_id]"),d=e.find("[data-widget-property=section_id]");r.forEach(function(e){i.append(jQuery("<option/>").val(e.id).html(e.title))}),i.selectBox("destroy").selectBox();var u=function(){c.find("*").remove(),d.find("*").remove(),jQuery.getJSON("/api/web/ContentAPI/getChapters",{ebookId:i.val()},function(e){s=e.data.chapters,s&&s.forEach(function(e){c.append(jQuery("<option/>").val(e.id).html(e.title))}),c.selectBox("destroy").selectBox(),d.selectBox("destroy").selectBox(),l&&c.selectBox("value",l.properties.ebook_chapter_id),h()})},h=function(){d.find("*").remove(),jQuery.getJSON("/api/web/ContentAPI/getSections",{chapterId:c.val()},function(e){if(a=e.data.sections,a&&a.forEach(function(e){d.append(jQuery("<option/>").val(e.id).data("uuid",e.uuid).html(e.name))}),d.selectBox("destroy").selectBox(),l){d.selectBox("value",l.ebook_chapter_id);var t=p.properties.section_id,n=p.properties.section_uuid;d.find("option").each(function(e){(this.value==t||$(this).data("uuid")==n)&&d.selectBox("value",this.value)})}})};if(i.on("change",u),c.on("change",h),o&&o.length){var p=o.data("widget");p&&"ebook-link"==p.wid?(l=p,jQuery.getJSON("/api/web/ContentAPI/getEbookId",{chapterId:p.properties.ebook_chapter_id},function(e){var t=e.data.ebookId;t&&i.selectBox("value",t),u()})):u()}else u()})},create:function(t,n,i){n&&(e=n,t.addClass("unusual-link"));jQuery.parseJSON(t.attr("data"));return n?this.setupInEditor(t,n):this.setupOffEditor(t),t}}}()),"undefined"==typeof Widgets&&(Widgets={}),Widgets.EbookSection=Widgets.Base().extend({properties:{header:"",title:"",location:"",date:""},getIndex:function(e){var t=e.data("widget");return t?t.properties.idx:void 0},create:function(e,t,n){return e=this.parent.create(e,t,n),e.find(".banner .title").text().trim()||e.find(".banner .locationdate").text().trim()||e.find(".banner").remove(),e.find(".header").text().trim()||e.find(".header").remove(),e}}),"undefined"==typeof Widgets&&(Widgets={}),Widgets.Embed=Widgets.Base().extend({properties:{"float":"none",width:"500px"},create:function(e,t,n){if(e=this.parent.create(e,t,n),t){var i=e.find(".embedded-content"),o=i.outerWidth()-i.width();i.outerHeight()-i.height();e.on("resize",function(){i.css("width",e.width()-o+"px"),i.find(".embed-link").css("width",i.find(".embed-content").width()+"px")})}return e},search:function(e,t){if(e){var n=this,i=jQuery.extend({},t,{url:e});jQuery.ajax({url:"/api/web/CouchContent/embedPreview",dataType:"json",type:"post",data:i}).then(function(t){0==t.status&&(n.container.find(".hint").hide(),n.container.find(".preview .image img").attr("src",t.data.image||"about:blank"),n.container.find(".preview .title").html("").html(t.data.title),n.container.find(".preview .description").html("").html(t.data.description),n.container.find(".preview .url a").html(e.length>50?e.substr(0,47)+"...":e).attr("href",e),n.container.find(".embed").show(),n.container.find("input[data-resource-property=image]").val(t.data.image),n.container.find("input[data-resource-property=title]").val(t.data.title),n.container.find("input[data-resource-property=description]").val(t.data.description),n.container.find("input[data-resource-property=url]").val(e))}).fail(function(e){n.container.find("embed").hide(),n.container.find(".hint").show().html(window.t("Provided URL exposes no meta information"))})}},dialog:function(e,t,n,i,o){var r=this;return this.container=this.parent.dialog(e,t,n,i,o),this.search(this.container.find("input[name=search]").val(),i),this.container.find(".cBtn").on("click",function(){var e=r.container.find("input[name=search]").val();return r.search(e,i),!1}),this.container}}),"undefined"==typeof Widgets&&(Widgets={}),Widgets.ExternalVideo=Widgets.Base().extend({properties:{"float":"none",width:"540px",height:"303px"},create:function(e,t,n){e=this.parent.create(e,t,n);var i=e.width(),o=e.height();e.find("iframe").attr("width",i).attr("height",o);var r=e.data("widget");switch(r.resources[0].properties.server){case"youtube.com":r.resources[0].properties.playlistId?e.find("iframe").attr("src","https://www.youtube.com/embed/videoseries?list="+r.resources[0].properties.playlistId):e.find("iframe").attr("src","https://www.youtube.com/embed/"+r.resources[0].properties.id);break;case"vimeo.com":e.find("iframe").attr("src","https://player.vimeo.com/video/"+r.resources[0].properties.id);break;case"livestream.com":var a=JSON.parse(r.resources[0].properties.id);e.find("iframe").attr("src","https://livestream.com/accounts/"+a.account+"/events/"+a.event+(a.video?"/videos/"+a.video:"")+"/player?width="+i+"&height="+o+"&autoPlay=false&mute=false")}return t&&e.on("resize",function(){e.find("iframe").attr("width",e.width()).attr("height",e.height())}),e},search:function(e){if(e){var t,n,i,o,r;if(t=e.match(/youtube\.com\/watch\?v=([^&$]+)/))n=t[1],i='<iframe width="560" height="315" src="https://www.youtube.com/embed/'+n+'" frameborder="0" allowfullscreen></iframe>',o="youtube.com";else if(t=e.match(/youtube\.com\/playlist\?list=([^&$]+)/))r=t[1],i='<iframe width="560" height="315" src="https://www.youtube.com/embed/videoseries?list='+r+'" frameborder="0" allowfullscreen></iframe>',o="youtube.com";else{if(!(t=e.match(/vimeo\.com\/(\d+)/))){
if(t=e.match(/livestream\.com\/(.+)/)){var a=this;return void jQuery.getJSON("/api/web/ContentWidgetAPI/resolveLivestreamEmbed",{data:t[1]},function(t){t.data&&t.data.account&&t.data.event&&(n={account:t.data.account,event:t.data.event},t.data.video&&(n.video=t.data.video),i='<iframe src="https://livestream.com/accounts/'+n.account+"/events/"+n.event+(n.video?"/videos/"+n.video:"")+'/player?width=560&height=315&autoPlay=false&mute=false" width="560" height="315" frameborder="0" scrolling="no"> </iframe>',o="livestream.com",a.container.find(".preview").html(i),a.container.find("input[data-resource-property=server]").val(o),a.container.find("input[data-resource-property=id]").val(JSON.stringify(n)),a.container.find("input[data-resource-property=url]").val(e))})}return}n=t[1],i='<iframe src="https://player.vimeo.com/video/'+n+'" width="560" height="315" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>',o="vimeo.com"}this.container.find(".preview").html(i),this.container.find("input[data-resource-property=server]").val(o),this.container.find("input[data-resource-property=id]").val(n||""),this.container.find("input[data-resource-property=playlistId]").val(r||""),this.container.find("input[data-resource-property=url]").val(e)}},dialog:function(e,t,n,i,o){var r=this;return this.container=this.parent.dialog(e,t,n,i,o),r.search(this.container.find("input[name=search]").val()),r.container.on("click",".resource-properties .cBtn",function(){return r.search(r.container.find("input[name=search]").val()),!1}),this.container}}),"undefined"==typeof Widgets&&(Widgets={}),Widgets.File=Widgets.Upload().extend({properties:{"float":"left",width:"auto"},create:function(e,t,n){e=this.parent.create(e,t,n);var i=e.data("widget"),o=e.find(".icon img");if(!o.attr("src")){var r=i.resources[0]&&i.resources[0].properties.filename;if(r){var a=r.substr(r.lastIndexOf(".")+1||1/0).toLowerCase();a&&["doc","docx","xls","xlsx","pdf"].contains(a)?o.attr("src",config.assetDir()+"/images/icons/"+a.substr(0,3)+".png"):o.attr("src",config.assetDir()+"/images/icons/default.png")}}return e.data("widget",i),e},dialog:function(e,t,n,i,o){e=this.parent.dialog(e,t,n,i,o),e.find("input[type=file]").on("chess24:done",function(t,n){e.find("[data-resource-property=filename]").val(n.originalFiles[0].name)})}}),"undefined"==typeof Widgets&&(Widgets={}),Widgets.GlossaryLink=Widgets.Base().extend(function(){var e;return{properties:{glossary_id:null,glossary_name:null,text:null},setupInEditor:function(e,t){var n=jQuery.parseJSON(e.attr("data"));e.off("dblclick").on("dblclick",function(){t.extensions.widgets.editWidget(e)}),e.on("change",function(){var t=e.clone().find("span").remove().end().html().trim();if(n.text!=t){var i=e.data("widget");i.properties.text=t,e.attr("data-widget",jQuery.toJSON(i)),n.text=e.html(),e.attr("data",jQuery.toJSON(n))}})},setupOffEditor:function(e){},dialog:function(e,t,n,i,o){t.extensions.link&&t.extensions.link.formOptions(e,o,"glossary-link");var r=e.find("[data-widget-property=text]");r.val()||r.val(o.text()),e.find("[data-auto-suggest]").on("chess24:select",function(){e.find("[data-widget-property=glossary_id]").val(this.value),e.find("[data-widget-property=glossary_name]").val(e.find("input.suggestField[type=text]").val())});var a=e.find("input[data-widget-property=text]");a.val()||a.val(o.clone().find("span").remove().end().html().trim())},create:function(t,n,i){n&&(e=n,t.addClass("unusual-link"));jQuery.parseJSON(t.attr("data")),t.data("widget");return n?this.setupInEditor(t,n):this.setupOffEditor(t),t}}}()),"undefined"==typeof Widgets&&(Widgets={});var initGoogleMaps=function(){"undefined"!=typeof google&&(Widgets.GoogleMaps=Widgets.Base().extend({map:null,marker:null,geocoder:null,container:null,controls:{panControl:!1,zoomControl:!1,mapTypeControl:!1,scaleControl:!1,streetViewControl:!1,overviewMapControl:!1,mapTypeId:google.maps.MapTypeId.ROADMAP},properties:{"float":"none",width:"100%",height:"50%"},createMap:function(e,t,n,i){var o=this;this.container.find("input[type=checkbox]").each(function(){var e=jQuery(this).attr("data");e&&(o.controls[e]=!!this.checked)}),this.map=new google.maps.Map(this.container.find(".map").get(0),jQuery.extend({center:e,zoom:t,scrollwheel:!1},this.controls)),n&&this.map.setMapTypeId(n),this.marker=new google.maps.Marker({position:this.map.getCenter(),map:this.map}),i&&(google.maps.event.clearListeners(this.map,"click"),google.maps.event.clearListeners(this.map,"zoom_changed"),google.maps.event.clearListeners(this.map,"maptypeid_changed"),google.maps.event.addListener(this.map,"click",function(e){o.centerMap(e.latLng),o.findLocation(e.latLng)}),google.maps.event.addListener(this.map,"zoom_changed",function(){o.save()}),google.maps.event.addListener(this.map,"maptypeid_changed",function(){o.container.find("input[data-resource-property=maptypeid]").val(o.map.getMapTypeId())}),o.save(),o.container.find("input[data-resource-property=maptypeid]").val(o.map.getMapTypeId()))},setupFormEvents:function(){var e=this;this.container.find(".cBtn.search").on("click",function(){var t=[];e.container.find("input[type=text]").each(function(){this.value&&t.push(this.value)}),t.length&&e.findAddress(t.join(", "))}),this.container.find("input[type=checkbox], .checkbox").on("click",function(){var t=jQuery(this).is("input")?jQuery(this):jQuery(this).find("input:first"),n=t.attr("data");n&&(e.controls[n]=t.is("[type=checkbox]")?!!t.attr("checked"):!!t.attr("value"),e.createMap(e.map.getCenter(),e.map.getZoom(),e.map.getMapTypeId(),!0),e.saveJson(e.container))})},centerMap:function(e){e||(e=this.marker.getPosition()),this.map.panTo(e),this.marker.setPosition(e),this.save()},save:function(){var e=this.map.getCenter(),t=this.map.getZoom();this.container.find("input[data-resource-property=latitude]").val(e.lat()),this.container.find("input[data-resource-property=longitude]").val(e.lng()),this.container.find("input[data-resource-property=zoom]").val(t),this.saveJson(this.container)},parseComponents:function(e){for(var t={},n=0;n<e.length;n++){var i=e[n].types;i&&(t[i[0]]=e[n].long_name)}return t},updateAddress:function(e){var t=this.parseComponents(e),n=[],i=[];t.route&&n.push(t.route),t.street_number&&n.push(t.street_number),t.locality&&i.push(t.locality),t.postal_code&&i.push(t.postal_code),this.container.find("input[data-resource-property=address]").val(n.join(" ")),this.container.find("input[data-resource-property=city]").val(i.join(" ")),this.container.find("input[data-resource-property=country]").val(t.country||"")},findAddress:function(e){var t=this;this.geocoder.geocode({address:e},function(e,n){n==google.maps.GeocoderStatus.OK&&(t.centerMap(e[0].geometry.location),t.updateAddress(e[0].address_components))})},findLocation:function(e,t){var n=this,i=e instanceof google.maps.LatLng?e:new google.maps.LatLng(e,t);this.geocoder.geocode({latLng:i},function(e,t){t==google.maps.GeocoderStatus.OK&&n.updateAddress(e[0].address_components)})},create:function(e,t,n){this.container=this.parent.create(e,t,n);var i=this;0==e.find("ul li").length&&e.find("ul").remove();var o=e.find(".map"),r=e.data("widget").resources[0].properties;return r&&(this.controls.panControl=0!=r.panControl,this.controls.zoomControl=0!=r.zoomControl,this.controls.mapTypeControl=0!=r.mapTypeControl,this.controls.scaleControl=0!=r.scaleControl,this.controls.streetViewControl=0!=r.streetViewControl,this.controls.overviewMapControl=0!=r.overviewMapControl,this.createMap(new google.maps.LatLng(r.latitude,r.longitude),parseInt(r.zoom),r.maptypeid)),o.css({width:e.width+"px",height:e.height()-e.find("ul").outerHeight()+"px"}),google.maps.event.trigger(i.map,"resize"),i.centerMap(),t&&e.on("resize",function(){o.css({width:e.width+"px",height:e.height()-e.find("ul").outerHeight()+"px"}),google.maps.event.trigger(i.map,"resize"),i.centerMap()}),this.container},dialog:function(e,t,n,i,o){var r=this;if(e){this.container=this.parent.dialog(e,t,n,i,o);var a=e.find("input[data-resource-property=latitude]").val(),s=e.find("input[data-resource-property=longitude]").val(),l=e.find("input[data-resource-property=zoom]").val()||8,c=e.find("input[data-resource-property=maptypeid]").val();if(a&&s||(a=43.945372,s=12.457672,"undefined"!=typeof navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(e){var t=new google.maps.LatLng(e.coords.latitude,e.coords.longitude);r.centerMap(t),r.findLocation(t)})),o&&o.length){var d,u=o.data("widget").resources[0].properties,h=[];for(d in this.controls)h.push(d);h.push("showAddress");for(var p=0;p<h.length;p++)d=h[p],e.find("input[data-resource-property="+d+"]").val(0!=u[d]?1:0).parent()[0!=u[d]?"addClass":"removeClass"]("checked")}return this.createMap(new google.maps.LatLng(a,s),parseInt(l),c,t),this.geocoder=new google.maps.Geocoder,this.setupFormEvents(),this.container}}}))};!function(){return"undefined"!=typeof google&&google.maps?function(e){e()}:jQuery}()(initGoogleMaps),"undefined"==typeof Widgets&&(Widgets={}),Widgets.Html=Widgets.Base().extend({properties:{"float":"none",width:"540px",height:"auto",plain:0},create:function(e,t,n){return e=this.parent.create(e,t,n),e.find("iframe").attr("width",e.width()).attr("height",e.height()),t&&e.on("resize",function(){e.find("iframe").attr("width",e.width()).attr("height",e.height())}),e},dialog:function(e,t,n,i,o){return this.container=this.parent.dialog(e,t,n,i,o),this.container.find("input[type=text]").on("change",function(){var e=jQuery(this),t=e.val();"%"!=t.substr(t.length-1,1)&&("height"!=e.data("widget-property")||"auto"!=t)&&(t=parseInt(e.val(),10),e.val(t?t+"px":""))}),this.container.find("textarea").on("change",function(){var e=jQuery(this);e.val(e.val().replace(/connect.facebook.net\/([^\/]+)\/sdk.js/i,"connect.facebook.net/$1/all.js"))}),this.container}}),"undefined"==typeof Widgets&&(Widgets={}),Widgets.Image=Widgets.Upload().extend({properties:{"float":"left",width:"auto"},create:function(e,t,n){function i(){if("auto"==o.properties.width){var n=e.outerWidth()-e.width();r.css({"max-width":e.parent().width()-n+"px",width:"auto"}),e.css("width",r.width()+"px"),t||r.on("load",function(){e.css("width",r.width()+"px").trigger("resize")})}else r.css("width",e.width()+"px").on("load",function(){e.trigger("resize")});t&&(e.on("resize",function(){r.css("width",e.width()+"px"),e.css("height","auto")}),r.off("load").one("load",function(){var t=o.properties.width;if("auto"==t){e.css("width","auto");var n=Math.min(r.width(),e.width());0==n?(r.css("width","auto"),e.css("width",r.width()+"px")):(e.css("width",n+"px"),r.css("width",n+"px").css("max-width",""))}e.trigger("resize"),"auto"==t&&(o.properties.width="auto",e.attr("data-widget",jQuery.toJSON(o)))}))}e=this.parent.create(e,t,n),""==e.find(".info").text().trim()&&e.find(".info").remove();var o=e.data("widget"),r=e.find("img");return r.attr("src")?i():jQuery.getJSON("/api/web/contentWidgetAPI/getImageUrl?id="+o.resources[0].reference_id,function(e){r.attr("src",e.data.url),i()}),e},dialog:function(e,t,n,i,o){e=this.parent.dialog(e,t,n,i,o),e.find("#image-widget-cid").val(n.formData.cid);var r=e.find(".hint-area"),a=e.find(".preview-area"),s=e.find(".edit-area");e.find("input[type=file]").on("chess24:add",function(e,t){r.add(a).add(s).hide(),l.hide()}).on("chess24:done",function(e,t){t?(a.find("img").attr("src",t.result.data.reference_url),a.find(".label").html(t.result.data.filename)):a.find(".label").html(window.t("Uploaded image")),a.add(s).show(),s.find(".editor-toolbar").css("width","auto"),s.css("height",a.innerHeight()+"px"),a.find("img").on("load",function(){s.css("height",a.innerHeight()+"px")}),l.show()}),t.toggleToolDialogButtons(!1);var l=e.find(".buttons a.submit");if(l.on("click",function(){t.extensions.widgets.save()}),e.find(".editor").editor({input:e.find("input[data-resource-property=caption]"),extensions:["wrapper","link","align","clear","history"],toolbar:["bold","link","alignleft","aligncenter","alignright"],extraClass:"white",height:70,banner:window.t("Comment:")}),o&&o.is(t.widgetmask)){var c=e.find(".resource-upload-preview img"),d=o.data("widget");c.attr("src")||jQuery.getJSON("/api/web/contentWidgetAPI/getImageUrl?id="+d.resources[0].reference_id,function(e){c.attr("src",e.data.url)}),e.find("input[type=file]").trigger("chess24:done")}else l.hide();return e}}),"undefined"==typeof Widgets&&(Widgets={}),Widgets.SimpleChessBoard=Widgets.ChessView().extend({properties:{fen:"",highlights:""},dialog:function(e,t,n,i,o){e=this.parent.dialog(e,t,n,i,o),this.chessBase.init(t.config.chessGames);var r=e.find("[data-widget-property=fen]"),a=e.find("[data-widget-property=highlights]");return r.val()||r.val(Chess.defaultFen),t.extensions.chess.positionBuilder(e.find(".position-builder"),r.val(),a.val()).on("chess24:change",function(e,t){r.val(t.fen),a.val(t.highlights?jQuery.toJSON(t.highlights):"")}),e},create:function(e,t,n){e=this.parent.create(e,t,n),t?e.prependTo(t).attr("draggable",!1):e.prependTo(e.closest(".couch-content"));var i=e.data("widget"),o=parseInt(i.properties.viewId,10)||0,r=this.chessBase.getView(o);if(r&&(this.chessBase.unlinkView(o),r=void 0),e.find(".chess-board").remove(),r=new View.ChessBoard(e,!1),o=this.chessBase.addView(o,r),parseInt(o,10)!==parseInt(i.properties.viewId,10)&&(i.properties.viewId=o,e.attr("data-widget",jQuery.toJSON(i))),i.properties.fen)try{var a=new Chess.Game({fen:i.properties.fen});this.chessBase.unlinkView(o),r.link(a);var s=i.properties.highlights;if("string"==typeof s&&s.length&&(s=jQuery.parseJSON(s)),s)for(var l=0;l<s.length;l++)s[l].square?a.addHighlight({square:Chess.getSquare(s[l].square.y,s[l].square.x),color:s[l].color}):s[l].frame?a.addHighlight({frame:Chess.getSquare(s[l].frame.y,s[l].frame.x),color:s[l].color}):s[l].line&&a.addHighlight({line:Chess.getMove(s[l].line.y1,s[l].line.x1,s[l].line.y2,s[l].line.x2),color:s[l].color})}catch(c){}return e}}),"undefined"==typeof Widgets&&(Widgets={}),Widgets.Slideshow=Widgets.Upload().extend({multiple:!0,properties:{width:"",height:"60%","float":"none"},create:function(e,t,n){e=this.parent.create(e,t,n);var i=e.find("ul"),o=0,r=e.data("widget");i.find("img").each(function(e){var t=jQuery(this);t.attr("src")||(o++,jQuery.getJSON("/api/web/contentWidgetAPI/getImageUrl?id="+r.resources[e].reference_id,function(e){o--,t.attr("src",e.data.url)}))});var a=setInterval(function(){0===o&&(i.slideshow({height:e.height(),stage:Math.round(.74*e.height())}),clearTimeout(a))},10);if(t){var s=function(){i.slideshow("adjust",e.width(),e.height())};e.on("resize",s),s()}},slideshow:function(e,t,n){var i=function(){var t=[],i=0;e.find("li").each(function(){var e=jQuery(this);t.push(e.attr("data-resource-id")),e.attr("data-resource-id",i).data("resource-id",i++)}),n.extensions.widgets.reorderResources(t)};e.slideshow({height:414,stage:305,reorder:".move-button",onreorder:i}).slideshow("adjust",t)},dialog:function(e,t,n,i,o){e=this.parent.dialog(e,t,n,i,o);var r=t.extensions.widgets.widgetdata;if(r&&r.resources)for(var a=0;a<r.resources.length;a++)r.resources[a].properties&&r.resources[a].properties.url&&delete r.resources[a].properties.url;var s=this,l=e.find(".resources-previews"),c=e.find(".resource-properties[data-key=image]"),d=e.find(".hint-area"),u=e.find(".preview-area"),h=e.find(".edit-area"),p=e.find(".buttons a.save-button"),f=e.find(".buttons a.submit"),g=e.find("a.cancel").hide(),m=function(){c.hide(),l.show(),h.hide(),u.hide(),d.show(),p.hide(),g.show(),e.find(".editor").html(""),s.slideshow(l.find("ul"),l.show().width(),t)},v=function(){e.find(".fileupload").nextAll(".fileUploadProgress").remove()},y=0,w=0;if(e.find("input[type=file]").on("chess24:add",function(e,t){d.add(u).add(h).hide(),y++,w=y}).on("chess24:done",function(e,n){return y--,u.find("img").attr("src",n.result.data.reference_url),u.find("label").html(n.result.data.filename),h.find("[data-resource-property=reference_id]").val(n.result.data.reference_id),p.off("click",m),w>1?(p.trigger("click"),void(y>0?(l.hide(),c.show()):s.slideshow(l.find("ul"),l.show().width(),t))):(0==y&&(v(),w=0),d.hide(),u.add(h).show(),h.find(".editor-toolbar").css("width","auto"),h.css("height",u.innerHeight()+"px"),u.find("img").on("load",function(){h.css("height",u.innerHeight()+"px")}),n&&u.find(".label").html(n.files[0].name),p.show(),void p.on("click",m))}).on("chess24:error",function(e){y--}),t.toggleToolDialogButtons(!1),f.on("click",function(){t.extensions.widgets.save()}),g.on("click",function(){h.hide(),u.hide(),d.show(),l.show(),l.find("ul.resources-previews-list").slideshow("adjust"),c.hide(),p.hide()}),l.find(".slideshow li").on("click",function(){l.find(".slideshow-stage input").remove()}),e.on("click",".edit-button",function(){v(),s.multiple=!1,h.add(u).show(),d.hide(),p.show(),u.find("img").attr("src",jQuery(this).closest(".resources-preview-item").find("img").attr("src")),u.find(".label").html(window.t("Uploaded image")),h.find(".editor-toolbar").css("width","auto"),h.css("height",u.innerHeight()+"px"),u.find("img").on("load",function(){h.css("height",u.innerHeight()+"px")}),p.html(window.t("Update image"))}),e.on("click",".add-button",function(){v(),s.multiple=!0,h.add(u).hide(),d.show(),p.html(window.t("Insert image")),e.find(".editor").html("<p/>")}),e.on("click",".delete-button",function(){var e=0;l.find("ul li").each(function(){jQuery(this).attr("data-resource-id",e).data("resource-id",e++)})}),e.on("update",function(){var e=l.find("ul img"),t=e.length;e.each(function(){var e=jQuery(this);return e.attr("src")?void t--:void jQuery.getJSON("/api/web/contentWidgetAPI/getImageUrl?id="+e.data("reference-id"),function(n){t--,e.attr("src",n.data.url)})}),function n(){return t>0?void setTimeout(n,50):void l.find("ul").slideshow("adjust",l.width())}()}),h.find(".editor").html("").editor({input:h.find("input[data-resource-property=caption]"),extensions:["wrapper","link","align","clear","history"],toolbar:["bold","link","alignleft","aligncenter","alignright"],extraClass:"white",height:70,banner:window.t("Comment:")}),o&&o.is(t.widgetmask)){l.show();var b=0,C=o.data("widget");l.find("ul img").each(function(e){var t=jQuery(this);b++,jQuery.getJSON("/api/web/contentWidgetAPI/getImageUrl?id="+C.resources[e].reference_id,function(e){b--,t.attr("src",e.data.url)})});var k=setInterval(function(){0===b&&(s.slideshow(l.find("ul"),l.width(),t),clearTimeout(k))},10);h.hide(),u.hide(),d.show(),c.hide(),g.show()}else l.hide(),c.show();return p.hide(),e}}),"undefined"==typeof Widgets&&(Widgets={}),Widgets.Table=function(){return Widgets.Base().extend({properties:{"float":"none",width:"100%"},clearTdEllipsis:function(e){e.find("div.td-ellipsis").each(function(){jQuery(this).parent().data("restore-text",jQuery(this).html()).end().replaceWith(jQuery("<div/>").css("height",jQuery(this).height()+"px").css("background","#e8e8e8").html("&nbsp;"))})},setupTdEllipsis:function(e){e.find("tr:first").get(0);e.find("td,th").each(function(){var e=jQuery(this);if(e.html()){var t=e.data("restore-text");t||(t=e.html());var n=jQuery("<div/>").addClass("td-ellipsis").appendTo(e.html(""));n.css("width",n.width()+"px").append(t)}}),e.find(".cover").css({width:e.css("width"),height:e.css("height")})},create:function(e,t,n){e=this.parent.create(e,t,n);var i=e.data("widget").resources[0].properties.data;if((t||0==e.find("table").length)&&i){for(var o,r=jQuery("<table/>").addClass("table").attr("cellspacing","0").attr("cellpadding","0"),a=1,s=0;s<i.length;s++){o=jQuery("<tr/>").addClass(a?"odd":"even").appendTo(r);for(var l=0;l<i[s].cells.length;l++){var c=i[s].cells[l],d=jQuery("<"+(i[s].header?"th":"td")+"/>").css("width",c.params.width+"%").appendTo(o),u=c.params.link?'<a href="'+c.params.link+'">'+c.text+"</a>":c.text;c.params.center&&d.css("text-align","center"),c.params.bold&&d.css("font-weight","bold"),c.params.colspan&&d.attr("colspan",c.params.colspan),c.params.flag&&(u='<span class="flag flag-'+c.params.flag+'"></span>'),c.params.empty&&(d.addClass("empty"),u="&nbsp;"),l==i[s].cells.length-1&&d.addClass("last"),u=u.replace(/%26/g,"&").replace(/%3E/g,">").replace(/%3C/g,"<"),d.html(u)}a=1-a}r.appendTo(e.html(""))}if(e.find("table").css({width:e.width()+"px","float":e.css("float")}),t){var h=this;e.on("resize",function(t,n){h.clearTdEllipsis(e);var i=e.find("table").css({width:e.width()+"px","float":e.css("float")});i.width()>e.width()&&e.css("width",i.width()+"px").trigger("resize",n),n||h.setupTdEllipsis(e)}),this.setupTdEllipsis(e)}return e},dialog:function(e,t,n,i,o){e=this.parent.dialog(e,t,n,i,o),o&&o.is(t.widgetmask)&&e.find("a.back,h3").remove();var r=o&&o.length?jQuery.toJSON(o.data("widget").resources[0].properties.data):"",a=e.find(".resource-properties[data-key=table]");return a.length?a.on("show",function(){var e=jQuery(this).find("input[data-resource-property=data]").val(r);jQuery(this).find(".table-builder,.widget-table-builder").tableBuilder(t,n,e)}):e.find(".widget-table-builder").tableBuilder(t,n,e.find("input[data-resource-property=data]").val(r)),e}})}(),"undefined"==typeof Widgets&&(Widgets={}),function(){return"undefined"!=typeof google&&google.maps?function(e){e()}:jQuery}()(function(){"undefined"!=typeof google&&(Widgets.Tournament=Widgets.GoogleMaps().extend({controls:{panControl:!1,zoomControl:!0,mapTypeControl:!0,scaleControl:!1,streetViewControl:!0,overviewMapControl:!1,mapTypeId:google.maps.MapTypeId.ROADMAP},properties:{"float":"none",height:"60%"},create:function(e,t,n){this.container=this.parent.create(e,t,n);var i=this,o=e.find(".map"),r=e.find(".info"),a=e.data("widget").resources[0].properties;a&&this.createMap(new google.maps.LatLng(a.latitude,a.longitude),parseInt(a.zoom),a.maptypeid,t),o.add(r).css({width:Math.floor(e.width()/2)+"px",height:e.height()+"px"}),google.maps.event.trigger(i.map,"resize"),i.centerMap();var s=e.find(".players");if(t){e.on("resize",function(){o.add(r).css({width:Math.floor(e.width()/2)+"px",height:e.height()+"px"}),google.maps.event.trigger(i.map,"resize"),i.centerMap();var t=e.height()/e.width()*100,n=e.data("widget");n.properties.height=t+"%",e.attr("data-widget",jQuery.toJSON(n))});var l=s.next("li");if(0==l.html().trim().length){var c=e.data("widget"),d=c.resources[0].properties.players;if(d)for(var u=c.resources[0].properties.players_meta,h=c.resources[0].properties.players_label,p=0;p<d.length;p++)l.append(("1"==u[p]?'<a href="">'+h[p]+"</a>":d[p])+(p<d.length-1?", ":""));else s.add(s.next("li")).hide()}}else 0==s.next("li").html().trim().length&&s.add(s.next("li")).hide();return this.container},dialog:function(e,t,n,i,o){var r=this;e=this.parent.dialog(e,t,n,i,o),e.find("input[data-resource-property=location]").on("change",function(){r.findAddress(this.value)}),e.find("input[type=text],textarea").on("change",function(){r.saveJson(e)});var a=e.find("[data-auto-suggest]");if(a.on("chess24:select",function(){a.nextAll("input[type=hidden]").add(a.parent(".flexiInputWrapper").nextAll("input[type=hidden]")).remove(),a.find("input[type=hidden]").each(function(){var e=jQuery(this).clone().insertAfter(a);e.attr("data-resource-property",e.attr("name"))})}),!a.data("value")&&o&&o.length){var s=[],l=o.data("widget");if(l){var c=l.resources[0].properties.players;if(c)for(var d=l.resources[0].properties.players_meta,u=l.resources[0].properties.players_label,h=0;h<c.length;h++)s.push({name:u[h],value:"1"==d[h]?c[h]:void 0});a.data("value",s)}}return r.save(),e}}))}),"undefined"==typeof Widgets&&(Widgets={}),Widgets.Twitter=Widgets.Base().extend({properties:{"float":"none",width:"500px"},tweetUrl:null,html:function(e){return new Handler.Template("widgets").render("widget-twitter-content-twitter",{properties:{url:e}})},create:function(e,t,n){e=this.parent.create(e,t,n);var i=e.data("widget").resources[0].properties;if(t){e.find("iframe").length&&e.find("iframe").remove().end().prepend(this.html(i.url)),e.find("blockquote").after('<script src="//platform.twitter.com/widgets.js" charset="utf-8"></script>');var o=setInterval(function(){e.find(".twitter-tweet-rendered").length>0&&(e.trigger("resize",!0),clearTimeout(o))},500);e.on("chess24:dragend",function(){if(e.find("iframe").length&&i.url){e.css("min-height",e.height()+"px"),e.find("iframe").remove(),e.prepend(this.html(i.url));var t=setInterval(function(){e.find(".twitter-tweet-rendered").length>0&&(e.css("min-height",""),clearTimeout(t))},500)}})}return e},search:function(e){e&&(this.container.find(".preview").html(this.html(e)),this.container.find("input[data-resource-property=url]").val(e))},dialog:function(e,t,n,i,o){var r=this;return this.container=this.parent.dialog(e,t,n,i,o),this.container.on("click",".form a",function(){return r.search(r.container.find("input[name=search]").val()),!1}),this.search(this.container.find("input[name=search]").val()),this.container}});